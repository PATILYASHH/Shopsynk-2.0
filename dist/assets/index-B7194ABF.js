import{r as l,a as Je,N as Ie,u as te,b as Ve,R as Ye,L as Le,d as Ze,B as Xe,e as Ee,f as U}from"./vendor-DsmcgGc9.js";import{c as Qe}from"./supabase-6T48ApRq.js";import{X as ae,D as xe,R as H,M as es,U as ue,L as ss,H as ts,a as V,b as M,F as rs,c as Fe,d as ne,e as ke,E as Ce,f as me,A as $e,P as he,g as ee,T as Ne,h as De,i as Pe,S as Ue,j as Re,k as qe,l as Me,m as ze,n as as,C as ve,o as _e,p as se,q as ns,r as ls,s as is,t as Oe,u as cs,v as Be,w as ce,x as os,y as oe,z as de,B as ds,G as us,I as ms,J as Ae,K as Se,N as xs,O as hs}from"./ui-D-Tr8dPx.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))r(c);new MutationObserver(c=>{for(const o of c)if(o.type==="childList")for(const h of o.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&r(h)}).observe(document,{childList:!0,subtree:!0});function n(c){const o={};return c.integrity&&(o.integrity=c.integrity),c.referrerPolicy&&(o.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?o.credentials="include":c.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(c){if(c.ep)return;c.ep=!0;const o=n(c);fetch(c.href,o)}})();var Ge={exports:{}},pe={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ps=l,gs=Symbol.for("react.element"),bs=Symbol.for("react.fragment"),fs=Object.prototype.hasOwnProperty,ys=ps.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,js={key:!0,ref:!0,__self:!0,__source:!0};function Ke(t,s,n){var r,c={},o=null,h=null;n!==void 0&&(o=""+n),s.key!==void 0&&(o=""+s.key),s.ref!==void 0&&(h=s.ref);for(r in s)fs.call(s,r)&&!js.hasOwnProperty(r)&&(c[r]=s[r]);if(t&&t.defaultProps)for(r in s=t.defaultProps,s)c[r]===void 0&&(c[r]=s[r]);return{$$typeof:gs,type:t,key:o,ref:h,props:c,_owner:ys.current}}pe.Fragment=bs;pe.jsx=Ke;pe.jsxs=Ke;Ge.exports=pe;var e=Ge.exports,We,Te=Je;We=Te.createRoot,Te.hydrateRoot;const ws="https://gxgiqmmlvdgrzvbgmgfp.supabase.co",Ns="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd4Z2lxbW1sdmRncnp2YmdtZ2ZwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYwOTA4OTEsImV4cCI6MjA3MTY2Njg5MX0.VzO5yGWCFpN6ZU7d76tK9ADFPNwukuQ96RD3iILpAg0",f=Qe(ws,Ns),He=l.createContext(void 0),R=()=>{const t=l.useContext(He);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},vs=({children:t})=>{const[s,n]=l.useState(null),[r,c]=l.useState(!0);l.useEffect(()=>{f.auth.getUser().then(({data:{user:g}})=>{n(g),c(!1)});const{data:{subscription:m}}=f.auth.onAuthStateChange((g,v)=>{n((v==null?void 0:v.user)??null),c(!1)});return()=>m.unsubscribe()},[]);const N={user:s,loading:r,signUp:async(m,g)=>{const{data:v,error:b}=await f.auth.signUp({email:m,password:g});return{data:v,error:b}},signIn:async(m,g)=>{const{data:v,error:b}=await f.auth.signInWithPassword({email:m,password:g});return{data:v,error:b}},signOut:async()=>{const{error:m}=await f.auth.signOut();if(m)throw m}};return e.jsx(He.Provider,{value:N,children:t})},_s=({children:t})=>{const{user:s,loading:n}=R();return n?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):s?e.jsx(e.Fragment,{children:t}):e.jsx(Ie,{to:"/login",replace:!0})},Ss=()=>{const[t,s]=l.useState(null),[n,r]=l.useState(!1),[c,o]=l.useState(!1),[h,_]=l.useState(!1);l.useEffect(()=>{const g=/iPad|iPhone|iPod/.test(navigator.userAgent);o(g);const v=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://");_(v);const b=y=>{y.preventDefault(),s(y),r(!0)};return window.addEventListener("beforeinstallprompt",b),()=>{window.removeEventListener("beforeinstallprompt",b)}},[]);const N=async()=>{if(!t)return;t.prompt();const{outcome:g}=await t.userChoice;console.log(g==="accepted"?"User accepted the install prompt":"User dismissed the install prompt"),s(null),r(!1)},m=()=>{r(!1),sessionStorage.setItem("installPromptDismissed","true")};return h||sessionStorage.getItem("installPromptDismissed")==="true"?null:c&&!h?e.jsx("div",{className:"fixed bottom-4 left-4 right-4 z-50 bg-blue-600 text-white p-4 rounded-lg shadow-lg border border-blue-500",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-sm",children:"Install Shopsynk"}),e.jsxs("p",{className:"text-xs mt-1 opacity-90",children:["Install this app on your iPhone: tap ",e.jsx("span",{className:"font-bold",children:"Share"})," and then ",e.jsx("span",{className:"font-bold",children:"Add to Home Screen"})]})]}),e.jsx("button",{onClick:m,className:"ml-2 p-1 hover:bg-blue-700 rounded",children:e.jsx(ae,{className:"h-4 w-4"})})]})}):n&&t?e.jsx("div",{className:"fixed bottom-4 left-4 right-4 z-50 bg-gradient-to-r from-blue-600 to-purple-600 text-white p-4 rounded-lg shadow-lg border border-blue-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsx(xe,{className:"h-5 w-5 mr-3 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-sm",children:"Install Shopsynk App"}),e.jsx("p",{className:"text-xs mt-1 opacity-90",children:"Get the full app experience with offline access and notifications"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx("button",{onClick:N,className:"bg-white text-blue-600 px-3 py-1 rounded text-xs font-medium hover:bg-gray-100 transition-colors",children:"Install"}),e.jsx("button",{onClick:m,className:"p-1 hover:bg-blue-700 rounded",children:e.jsx(ae,{className:"h-4 w-4"})})]})]})}):null},ks=()=>{const[t,s]=l.useState(!1),[n,r]=l.useState(null);l.useEffect(()=>{"serviceWorker"in navigator&&(navigator.serviceWorker.ready.then(h=>{h.waiting&&(r(h.waiting),s(!0)),h.addEventListener("updatefound",()=>{const _=h.installing;_&&_.addEventListener("statechange",()=>{_.state==="installed"&&navigator.serviceWorker.controller&&(r(_),s(!0))})})}),navigator.serviceWorker.addEventListener("controllerchange",()=>{window.location.reload()}))},[]);const c=()=>{n&&(n.postMessage({type:"SKIP_WAITING"}),s(!1))},o=()=>{s(!1)};return t?e.jsx("div",{className:"fixed top-4 left-4 right-4 z-50 bg-green-600 text-white p-4 rounded-lg shadow-lg border border-green-500",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center flex-1",children:[e.jsx(H,{className:"h-5 w-5 mr-3 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-sm",children:"App Update Available"}),e.jsx("p",{className:"text-xs mt-1 opacity-90",children:"A new version of Shopsynk is ready to install"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[e.jsx("button",{onClick:c,className:"bg-white text-green-600 px-3 py-1 rounded text-xs font-medium hover:bg-gray-100 transition-colors",children:"Update"}),e.jsx("button",{onClick:o,className:"p-1 hover:bg-green-700 rounded",children:e.jsx(ae,{className:"h-4 w-4"})})]})]})}):null},Cs=({children:t})=>{const{user:s,signOut:n}=R(),r=te(),c=Ve(),[o,h]=Ye.useState(!1),_=async()=>{try{await n(),r("/login")}catch(g){console.error("Error signing out:",g)}},N=[{name:"Dashboard",path:"/",icon:ts},{name:"Suppliers",path:"/suppliers",icon:V},{name:"Transactions",path:"/transactions",icon:M},{name:"Reports",path:"/reports",icon:rs},{name:"Data Storage",path:"/data-storage",icon:Fe}],m=g=>g==="/"?c.pathname==="/":c.pathname.startsWith(g);return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"lg:hidden fixed top-4 left-4 z-50",children:e.jsx("button",{onClick:()=>h(!o),className:"bg-white p-2 rounded-lg shadow-md border border-gray-200 hover:bg-gray-50 transition-colors",children:o?e.jsx(ae,{className:"h-6 w-6"}):e.jsx(es,{className:"h-6 w-6"})})}),e.jsx("div",{className:`fixed inset-y-0 left-0 z-40 w-64 bg-white shadow-lg border-r border-gray-200 transform transition-transform duration-200 ease-in-out lg:translate-x-0 ${o?"translate-x-0":"-translate-x-full"}`,children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsx("div",{className:"flex items-center justify-center h-16 bg-blue-600 text-white",children:e.jsx("h1",{className:"text-xl font-bold",children:"Shopsynk"})}),e.jsx("nav",{className:"flex-1 px-4 py-6 space-y-2",children:N.map(g=>{const v=g.icon;return e.jsxs("button",{onClick:()=>{r(g.path),h(!1)},className:`w-full flex items-center px-4 py-3 text-left rounded-lg transition-colors ${m(g.path)?"bg-blue-50 text-blue-700 border border-blue-200":"text-gray-700 hover:bg-gray-50 hover:text-gray-900"}`,children:[e.jsx(v,{className:"h-5 w-5 mr-3"}),g.name]},g.name)})}),e.jsxs("div",{className:"p-4 border-t border-gray-200",children:[e.jsx("button",{onClick:()=>r("/profile"),className:"w-full flex items-center justify-between p-3 rounded-lg hover:bg-gray-50 transition-colors mb-3",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:e.jsx(ue,{className:"h-4 w-4 text-blue-600"})}),e.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:"Profile Settings"}),e.jsx("p",{className:"text-xs text-gray-500 truncate",children:s==null?void 0:s.email})]})]})}),e.jsxs("button",{onClick:_,className:"w-full flex items-center justify-center p-3 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[e.jsx(ss,{className:"h-4 w-4 mr-2"}),"Sign Out"]})]})]})}),e.jsx("div",{className:"lg:pl-64",children:e.jsx("main",{className:"p-6 lg:p-8",children:t})}),o&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-30 lg:hidden",onClick:()=>h(!1)}),e.jsx(Ss,{}),e.jsx(ks,{})]})},Ds=()=>{const[t,s]=l.useState(""),[n,r]=l.useState(""),[c,o]=l.useState(!1),[h,_]=l.useState(!1),[N,m]=l.useState(""),{signIn:g}=R(),v=te(),b=async y=>{y.preventDefault(),_(!0),m("");try{const{error:w}=await g(t,n);if(w)throw w;v("/")}catch(w){m(w.message)}finally{_(!1)}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:e.jsx("div",{className:"max-w-md w-full",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-600 rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"text-2xl font-bold text-white",children:"DT"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Welcome Back"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Sign in to manage your supplier dues"})]}),N&&e.jsx("div",{className:"mb-4 p-3 rounded-lg bg-red-50 border border-red-200 text-red-600 text-sm",children:N}),e.jsxs("form",{onSubmit:b,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(ne,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"email",value:t,onChange:y=>s(y.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Enter your email",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(ke,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:c?"text":"password",value:n,onChange:y=>r(y.target.value),className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Enter your password",required:!0}),e.jsx("button",{type:"button",onClick:()=>o(!c),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:c?e.jsx(Ce,{className:"h-5 w-5"}):e.jsx(me,{className:"h-5 w-5"})})]})]}),e.jsx("button",{type:"submit",disabled:h,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:h?e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:["Sign In",e.jsx($e,{className:"ml-2 h-4 w-4"})]})})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-gray-600",children:["Don't have an account?"," ",e.jsx(Le,{to:"/register",className:"text-blue-600 hover:text-blue-700 font-medium",children:"Create one"})]})})]})})})},Ps=()=>{const[t,s]=l.useState(""),[n,r]=l.useState(""),[c,o]=l.useState(""),[h,_]=l.useState(!1),[N,m]=l.useState(!1),[g,v]=l.useState(!1),[b,y]=l.useState(""),[w,j]=l.useState(""),{signUp:B}=R(),E=te(),T=async u=>{if(u.preventDefault(),v(!0),y(""),j(""),n!==c){y("Passwords do not match"),v(!1);return}try{const{error:d}=await B(t,n);if(d)throw d;j("Account created successfully! You can now sign in."),setTimeout(()=>E("/login"),2e3)}catch(d){y(d.message)}finally{v(!1)}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:e.jsx("div",{className:"max-w-md w-full",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-600 rounded-2xl flex items-center justify-center mx-auto mb-4",children:e.jsx("span",{className:"text-2xl font-bold text-white",children:"DT"})}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Create Account"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Start managing your supplier dues today"})]}),b&&e.jsx("div",{className:"mb-4 p-3 rounded-lg bg-red-50 border border-red-200 text-red-600 text-sm",children:b}),w&&e.jsx("div",{className:"mb-4 p-3 rounded-lg bg-green-50 border border-green-200 text-green-600 text-sm",children:w}),e.jsxs("form",{onSubmit:T,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),e.jsxs("div",{className:"relative",children:[e.jsx(ne,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"email",value:t,onChange:u=>s(u.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Enter your email",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(ke,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:h?"text":"password",value:n,onChange:u=>r(u.target.value),className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Create a password",required:!0,minLength:6}),e.jsx("button",{type:"button",onClick:()=>_(!h),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:h?e.jsx(Ce,{className:"h-5 w-5"}):e.jsx(me,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(ke,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:N?"text":"password",value:c,onChange:u=>o(u.target.value),className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Confirm your password",required:!0,minLength:6}),e.jsx("button",{type:"button",onClick:()=>m(!N),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:N?e.jsx(Ce,{className:"h-5 w-5"}):e.jsx(me,{className:"h-5 w-5"})})]})]}),e.jsx("button",{type:"submit",disabled:g,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:g?e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):e.jsxs(e.Fragment,{children:["Create Account",e.jsx($e,{className:"ml-2 h-4 w-4"})]})})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-gray-600",children:["Already have an account?"," ",e.jsx(Le,{to:"/login",className:"text-blue-600 hover:text-blue-700 font-medium",children:"Sign in"})]})})]})})})},Es=()=>{const{user:t}=R(),s=te(),[n,r]=l.useState({totalDues:0,totalSuppliers:0,totalTransactions:0,pendingPayments:0,recentTransactions:[],upcomingDues:[]}),[c,o]=l.useState(!0);l.useEffect(()=>{h()},[t]);const h=async()=>{if(t)try{const{count:m}=await f.from("suppliers").select("*",{count:"exact",head:!0}).eq("user_id",t.id),{count:g}=await f.from("transactions").select("*",{count:"exact",head:!0}).eq("user_id",t.id),{data:v}=await f.from("transactions").select("*").eq("user_id",t.id),b=new Map;v==null||v.forEach(u=>{const d=u.supplier_id;b.has(d)||b.set(d,0),u.type==="new_purchase"?b.set(d,b.get(d)+parseFloat(u.amount)):(u.type==="pay_due"||u.type==="settle_bill")&&b.set(d,b.get(d)-parseFloat(u.amount))});let y=0,w=0;b.forEach(u=>{u>.01&&(y+=u,w++)});const{data:j}=await f.from("transactions").select(`
          *,
          supplier:suppliers(name),
          owner:business_owners(owner_name)
        `).eq("user_id",t.id).order("created_at",{ascending:!1}).limit(5),{data:B}=await f.from("transactions").select(`
          *,
          supplier:suppliers(name),
          owner:business_owners(owner_name)
        `).eq("user_id",t.id).order("created_at",{ascending:!1}),E=new Map;B==null||B.forEach(u=>{var S;const d=u.supplier_id,a=(S=u.supplier)==null?void 0:S.name;E.has(d)||E.set(d,{supplier_id:d,supplier_name:a,balance:0,lastTransaction:u,dueDate:null});const p=E.get(d);u.type==="new_purchase"?(p.balance+=parseFloat(u.amount),u.due_date&&(!p.dueDate||u.due_date<p.dueDate)&&(p.dueDate=u.due_date)):(u.type==="pay_due"||u.type==="settle_bill")&&(p.balance-=parseFloat(u.amount))});const T=Array.from(E.values()).filter(u=>u.balance>.01).map(u=>({id:`outstanding-${u.supplier_id}`,supplier_id:u.supplier_id,supplier:{name:u.supplier_name},amount:u.balance.toFixed(2),description:"Outstanding balance",due_date:u.dueDate,type:"outstanding"})).sort((u,d)=>u.due_date&&!d.due_date?-1:!u.due_date&&d.due_date?1:u.due_date&&d.due_date&&u.due_date!==d.due_date?u.due_date.localeCompare(d.due_date):parseFloat(d.amount)-parseFloat(u.amount)).slice(0,10);r({totalDues:Math.max(0,y),totalSuppliers:m||0,totalTransactions:g||0,pendingPayments:w,recentTransactions:j||[],upcomingDues:T||[]})}catch(m){console.error("Error fetching dashboard data:",m)}finally{o(!1)}},_=m=>{switch(m){case"new_purchase":return e.jsx(Pe,{className:"h-4 w-4 text-red-500"});case"pay_due":case"settle_bill":return e.jsx(De,{className:"h-4 w-4 text-green-500"});default:return e.jsx(M,{className:"h-4 w-4 text-gray-500"})}},N=m=>{switch(m){case"new_purchase":return"Purchase";case"pay_due":return"Payment";case"settle_bill":return"Settlement";default:return m}};return c?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Dashboard"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Your business overview"})]}),e.jsxs("button",{onClick:()=>s("/transactions"),className:"bg-blue-600 text-white px-4 py-2.5 rounded-lg font-medium flex items-center justify-center hover:bg-blue-700 w-full sm:w-auto",children:[e.jsx(he,{className:"h-4 w-4 mr-2"}),"Add Transaction"]})]}),e.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[e.jsx("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:e.jsxs("div",{className:"text-center",children:[e.jsx(ee,{className:"h-6 w-6 text-red-500 mx-auto mb-2"}),e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Outstanding"}),e.jsxs("p",{className:"text-lg font-bold text-red-600",children:["₹",Math.round(n.totalDues).toLocaleString()]})]})}),e.jsx("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:e.jsxs("div",{className:"text-center",children:[e.jsx(V,{className:"h-6 w-6 text-blue-500 mx-auto mb-2"}),e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Suppliers"}),e.jsx("p",{className:"text-lg font-bold text-blue-600",children:n.totalSuppliers})]})}),e.jsx("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:e.jsxs("div",{className:"text-center",children:[e.jsx(M,{className:"h-6 w-6 text-green-500 mx-auto mb-2"}),e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Transactions"}),e.jsx("p",{className:"text-lg font-bold text-green-600",children:n.totalTransactions})]})}),e.jsx("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ne,{className:"h-6 w-6 text-orange-500 mx-auto mb-2"}),e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Pending"}),e.jsx("p",{className:"text-lg font-bold text-orange-600",children:n.pendingPayments})]})})]}),e.jsxs("div",{className:"space-y-4 lg:grid lg:grid-cols-2 lg:gap-6 lg:space-y-0",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Recent Activity"}),e.jsx("button",{onClick:()=>s("/transactions"),className:"text-blue-600 text-sm font-medium",children:"View All"})]}),e.jsx("div",{className:"space-y-3",children:n.recentTransactions.length>0?n.recentTransactions.slice(0,4).map(m=>{var g;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[_(m.type),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-gray-900 truncate",children:(g=m.supplier)==null?void 0:g.name}),e.jsx("p",{className:"text-sm text-gray-500",children:N(m.type)})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:`font-medium ${m.type==="new_purchase"?"text-red-600":"text-green-600"}`,children:[m.type==="new_purchase"?"+":"-","₹",Math.round(parseFloat(m.amount)).toLocaleString()]})})]},m.id)}):e.jsx("p",{className:"text-gray-500 text-center py-6 text-sm",children:"No transactions yet"})})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Payments Due"}),e.jsx(Ne,{className:"h-5 w-5 text-orange-400"})]}),e.jsx("div",{className:"space-y-3",children:n.upcomingDues.length>0?n.upcomingDues.slice(0,4).map(m=>{var g;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-orange-50 rounded-lg border border-orange-100",onClick:()=>s(`/suppliers/${m.supplier_id}`),children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-gray-900 truncate",children:(g=m.supplier)==null?void 0:g.name}),e.jsx("p",{className:"text-sm text-gray-500",children:"Outstanding balance"})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"font-medium text-red-600",children:["₹",Math.round(parseFloat(m.amount)).toLocaleString()]})})]},m.id)}):e.jsxs("div",{className:"text-center py-6",children:[e.jsx(Ne,{className:"h-8 w-8 text-green-500 mx-auto mb-2 opacity-50"}),e.jsx("p",{className:"text-green-600 text-sm font-medium",children:"All payments up to date!"})]})})]})]})]})},Os=()=>{const{user:t}=R(),s=te(),[n,r]=l.useState([]),[c,o]=l.useState(!0),[h,_]=l.useState(""),[N,m]=l.useState(!1),[g,v]=l.useState(null),[b,y]=l.useState({name:"",contact_person:"",phone:"",email:"",address:""});l.useEffect(()=>{w()},[t]);const w=async()=>{if(t)try{const{data:d,error:a}=await f.from("suppliers").select("*").eq("user_id",t.id).order("name");if(a)throw a;r(d||[])}catch(d){console.error("Error fetching suppliers:",d)}finally{o(!1)}},j=async d=>{if(d.preventDefault(),!!t)try{if(g){const{error:a}=await f.from("suppliers").update(b).eq("id",g.id).eq("user_id",t.id);if(a)throw a}else{const{error:a}=await f.from("suppliers").insert([{...b,user_id:t.id}]);if(a)throw a}await w(),T()}catch(a){console.error("Error saving supplier:",a)}},B=d=>{v(d),y({name:d.name,contact_person:d.contact_person||"",phone:d.phone||"",email:d.email||"",address:d.address||""}),m(!0)},E=async d=>{if(confirm("Are you sure you want to delete this supplier?"))try{const{error:a}=await f.from("suppliers").delete().eq("id",d).eq("user_id",t.id);if(a)throw a;await w()}catch(a){console.error("Error deleting supplier:",a)}},T=()=>{y({name:"",contact_person:"",phone:"",email:"",address:""}),v(null),m(!1)},u=n.filter(d=>d.name.toLowerCase().includes(h.toLowerCase())||d.contact_person&&d.contact_person.toLowerCase().includes(h.toLowerCase()));return c?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Suppliers"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Manage your supplier relationships"})]}),e.jsxs("button",{onClick:()=>m(!0),className:"bg-blue-600 text-white px-4 py-2.5 rounded-lg font-medium flex items-center justify-center hover:bg-blue-700 w-full sm:w-auto",children:[e.jsx(he,{className:"h-4 w-4 mr-2"}),"Add Supplier"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Ue,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search suppliers...",value:h,onChange:d=>_(d.target.value),className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsx("div",{className:"space-y-4",children:u.map(d=>e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-medium text-gray-900 text-lg mb-2",children:d.name}),e.jsxs("div",{className:"space-y-1",children:[d.contact_person&&e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(V,{className:"h-4 w-4 mr-2 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:d.contact_person})]}),d.phone&&e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(Re,{className:"h-4 w-4 mr-2 flex-shrink-0"}),e.jsx("a",{href:`tel:${d.phone}`,className:"text-blue-600 hover:underline",children:d.phone})]}),d.email&&e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(ne,{className:"h-4 w-4 mr-2 flex-shrink-0"}),e.jsx("a",{href:`mailto:${d.email}`,className:"text-blue-600 hover:underline truncate",children:d.email})]}),d.address&&e.jsxs("div",{className:"flex items-start text-sm text-gray-600",children:[e.jsx(qe,{className:"h-4 w-4 mr-2 flex-shrink-0 mt-0.5"}),e.jsx("span",{className:"line-clamp-2",children:d.address})]})]})]}),e.jsxs("div",{className:"flex space-x-2 ml-4",children:[e.jsx("button",{onClick:()=>s(`/suppliers/${d.id}`),className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg",title:"View details",children:e.jsx(me,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>B(d),className:"p-2 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded-lg",title:"Edit",children:e.jsx(Me,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>E(d.id),className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg",title:"Delete",children:e.jsx(ze,{className:"h-4 w-4"})})]})]})},d.id))}),u.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(V,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:h?"No suppliers found":"No suppliers yet"}),e.jsx("p",{className:"text-gray-600 mb-6",children:h?"Try adjusting your search terms.":"Start by adding your first supplier to begin tracking dues."}),!h&&e.jsx("button",{onClick:()=>m(!0),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Add Supplier"})]}),N&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:g?"Edit Supplier":"Add New Supplier"}),e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company Name *"}),e.jsx("input",{type:"text",required:!0,value:b.name,onChange:d=>y({...b,name:d.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter company name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Person"}),e.jsx("input",{type:"text",value:b.contact_person,onChange:d=>y({...b,contact_person:d.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter contact person name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),e.jsx("input",{type:"tel",value:b.phone,onChange:d=>y({...b,phone:d.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter phone number"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email Address"}),e.jsx("input",{type:"email",value:b.email,onChange:d=>y({...b,email:d.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter email address"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),e.jsx("textarea",{value:b.address,onChange:d=>y({...b,address:d.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter address"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:T,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsxs("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[g?"Update":"Create"," Supplier"]})]})]})]})})]})};class J{static getInstance(){return J.instance||(J.instance=new J),J.instance}async getBusinessOwners(s){try{const{data:n,error:r}=await f.from("business_owners").select("*").eq("user_id",s).eq("is_active",!0).order("is_primary",{ascending:!1}).order("created_at",{ascending:!0});if(r)throw r;return n||[]}catch(n){return console.error("Error fetching business owners:",n),[]}}async getPrimaryOwner(s){try{const{data:n,error:r}=await f.from("business_owners").select("*").eq("user_id",s).eq("is_primary",!0).eq("is_active",!0).single();if(r&&r.code!=="PGRST116")throw r;return n||null}catch(n){return console.error("Error fetching primary owner:",n),null}}async createBusinessOwner(s,n){try{const{data:r,error:c}=await f.from("business_owners").insert([{user_id:s,owner_name:n.owner_name,role:n.role||"Owner",is_primary:!1,is_active:!0}]).select().single();if(c)throw c;return{success:!0,data:r}}catch(r){return console.error("Error creating business owner:",r),{success:!1,error:r.message||"Failed to create business owner"}}}async updateBusinessOwner(s,n){try{const{data:r,error:c}=await f.from("business_owners").update({owner_name:n.owner_name,role:n.role,updated_at:new Date().toISOString()}).eq("id",s).select().single();if(c)throw c;return{success:!0,data:r}}catch(r){return console.error("Error updating business owner:",r),{success:!1,error:r.message||"Failed to update business owner"}}}async deactivateBusinessOwner(s){try{const{data:n,error:r}=await f.from("business_owners").select("is_primary").eq("id",s).single();if(r)throw r;if(n.is_primary)return{success:!1,error:"Cannot deactivate the primary owner"};const{error:c}=await f.from("business_owners").update({is_active:!1,updated_at:new Date().toISOString()}).eq("id",s);if(c)throw c;return{success:!0}}catch(n){return console.error("Error deactivating business owner:",n),{success:!1,error:n.message||"Failed to deactivate business owner"}}}async getOwnerStats(s){try{const{data:n,error:r}=await f.from("owner_transaction_stats").select("*").eq("user_id",s);if(r)throw r;return n||[]}catch(n){return console.error("Error fetching owner stats:",n),[]}}async ensurePrimaryOwner(s,n,r){try{const c=await this.getPrimaryOwner(s);if(c)return c;const o=await this.createBusinessOwner(s,{owner_name:r||n.split("@")[0],role:"Primary Owner",is_primary:!0});return o.success?o.data:null}catch(c){return console.error("Error ensuring primary owner:",c),null}}async updateTransactionOwner(s,n){try{const{error:r}=await f.from("transactions").update({owner_id:n}).eq("id",s);if(r)throw r;return{success:!0}}catch(r){return console.error("Error updating transaction owner:",r),{success:!1,error:r.message||"Failed to update transaction owner"}}}async updateSupplierOwner(s,n){try{const{error:r}=await f.from("suppliers").update({added_by_owner_id:n}).eq("id",s);if(r)throw r;return{success:!0}}catch(r){return console.error("Error updating supplier owner:",r),{success:!1,error:r.message||"Failed to update supplier owner"}}}}const Bs=()=>{const{id:t}=Ze(),{user:s}=R(),n=te(),[r,c]=l.useState(null),[o,h]=l.useState([]),[_,N]=l.useState([]),[m,g]=l.useState(!0),[v,b]=l.useState(!1),[y,w]=l.useState(!1),[j,B]=l.useState(""),[E,T]=l.useState(""),[u,d]=l.useState(""),[a,p]=l.useState(""),[S,k]=l.useState(""),[P,D]=l.useState(""),[L,O]=l.useState(""),[F,z]=l.useState(0),[A,X]=l.useState({totalPurchases:0,totalPaid:0,totalDue:0,transactionCount:0});l.useEffect(()=>{t&&re()},[t,s]);const re=async()=>{if(!(!s||!t))try{const{data:x,error:I}=await f.from("suppliers").select("*").eq("id",t).eq("user_id",s.id).single();if(I)throw I;const{data:G,error:ie}=await f.from("transactions").select(`
          *,
          owner:business_owners(owner_name)
        `).eq("supplier_id",t).eq("user_id",s.id).order("created_at",{ascending:!1});if(ie)throw ie;const Q=await J.getInstance().getBusinessOwners(s.id);c(x),h(G||[]),N(Q||[]);let i=0,C=0,q=0;G==null||G.forEach(K=>{const $=parseFloat(K.amount.toString());K.type==="new_purchase"?(i+=$,K.is_paid||(q+=$)):(K.type==="pay_due"||K.type==="settle_bill")&&(C+=$,q-=$)}),z(Math.max(0,q)),X({totalPurchases:i,totalPaid:C,totalDue:Math.max(0,q),transactionCount:(G==null?void 0:G.length)||0})}catch(x){console.error("Error fetching supplier data:",x)}finally{g(!1)}},ge=async x=>{if(x.preventDefault(),!(!s||!t||!j))try{const{error:I}=await f.from("transactions").insert([{user_id:s.id,supplier_id:t,type:"pay_due",amount:parseFloat(j),description:L||"Payment made",is_paid:!0,owner_id:E||null}]);if(I)throw I;await re(),b(!1),B(""),T(""),O("")}catch(I){console.error("Error processing payment:",I)}},be=async x=>{if(x.preventDefault(),!(!s||!t||!u))try{const{error:I}=await f.from("transactions").insert([{user_id:s.id,supplier_id:t,type:"new_purchase",amount:parseFloat(u),description:S||"New purchase",due_date:P||null,is_paid:!1,owner_id:a||null}]);if(I)throw I;await re(),w(!1),d(""),p(""),k(""),D("")}catch(I){console.error("Error adding purchase:",I)}},W=x=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(x),le=x=>new Date(x).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"}),fe=x=>{switch(x){case"new_purchase":return e.jsx(Pe,{className:"h-5 w-5 text-red-500"});case"pay_due":case"settle_bill":return e.jsx(De,{className:"h-5 w-5 text-green-500"});default:return e.jsx(M,{className:"h-5 w-5 text-gray-500"})}},ye=x=>{switch(x){case"new_purchase":return"Purchase";case"pay_due":return"Payment";case"settle_bill":return"Settlement";default:return x}},je=x=>{switch(x){case"new_purchase":return"text-red-600";case"pay_due":case"settle_bill":return"text-green-600";default:return"text-gray-600"}};return m?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):r?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>n("/suppliers"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(as,{className:"h-5 w-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:r.name}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Supplier Details & Transaction History"})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{onClick:()=>b(!0),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center",children:[e.jsx(ve,{className:"h-4 w-4 mr-2"}),"Pay Due"]}),e.jsxs("button",{onClick:()=>w(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center",children:[e.jsx(_e,{className:"h-4 w-4 mr-2"}),"New Purchase"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Purchases"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:W(A.totalPurchases)})]}),e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:e.jsx(_e,{className:"h-6 w-6 text-blue-600"})})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Paid"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:W(A.totalPaid)})]}),e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:e.jsx(ve,{className:"h-6 w-6 text-green-600"})})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Outstanding Due"}),e.jsx("p",{className:`text-2xl font-bold ${A.totalDue>0?"text-red-600":"text-gray-400"}`,children:W(A.totalDue)})]}),e.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center ${A.totalDue>0?"bg-red-100":"bg-gray-100"}`,children:e.jsx(ee,{className:`h-6 w-6 ${A.totalDue>0?"text-red-600":"text-gray-400"}`})})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Transactions"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:A.transactionCount})]}),e.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-xl flex items-center justify-center",children:e.jsx(M,{className:"h-6 w-6 text-gray-600"})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:e.jsx(ue,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:r.name}),r.contact_person&&e.jsx("p",{className:"text-gray-600",children:r.contact_person})]})]}),e.jsxs("div",{className:"space-y-4",children:[r.phone&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Re,{className:"h-5 w-5 text-gray-400"}),e.jsx("span",{className:"text-gray-700",children:r.phone})]}),r.email&&e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ne,{className:"h-5 w-5 text-gray-400"}),e.jsx("span",{className:"text-gray-700",children:r.email})]}),r.address&&e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(qe,{className:"h-5 w-5 text-gray-400 mt-0.5"}),e.jsx("span",{className:"text-gray-700",children:r.address})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Payment Status"}),e.jsx(ee,{className:"h-5 w-5 text-gray-400"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Payment Rate"}),e.jsx("span",{className:"text-sm font-medium",children:A.totalPurchases>0?`${Math.round(A.totalPaid/A.totalPurchases*100)}%`:"0%"})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:A.totalPurchases>0?`${Math.min(A.totalPaid/A.totalPurchases*100,100)}%`:"0%"}})}),e.jsxs("div",{className:"text-center pt-2",children:[e.jsx("p",{className:`text-2xl font-bold ${A.totalDue>0?"text-red-600":"text-green-600"}`,children:A.totalDue>0?W(A.totalDue):"All Clear!"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:A.totalDue>0?"Outstanding Balance":"No pending dues"})]})]})]})]}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsx("div",{className:"p-6 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Transaction History"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:()=>b(!0),className:"bg-green-600 text-white px-3 py-1.5 rounded-md text-sm hover:bg-green-700 transition-colors flex items-center",children:[e.jsx(ve,{className:"h-4 w-4 mr-1"}),"Pay Due"]}),e.jsxs("button",{onClick:()=>w(!0),className:"bg-blue-600 text-white px-3 py-1.5 rounded-md text-sm hover:bg-blue-700 transition-colors flex items-center",children:[e.jsx(_e,{className:"h-4 w-4 mr-1"}),"New Purchase"]})]})]})}),e.jsx("div",{className:"p-6",children:o.length>0?e.jsx("div",{className:"space-y-4",children:o.map(x=>{var I;return e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[fe(x.type),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-medium text-gray-900",children:ye(x.type)}),!x.is_paid&&x.type==="new_purchase"&&e.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-red-100 text-red-700 rounded-full",children:"Unpaid"})]}),e.jsx("p",{className:"text-gray-600 text-sm",children:x.description}),((I=x.owner)==null?void 0:I.owner_name)&&e.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:[x.type==="new_purchase"?"Purchased by: ":"Paid by: ",x.owner.owner_name]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1 text-xs text-gray-500",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(se,{className:"h-3 w-3 mr-1"}),le(x.created_at)]}),x.due_date&&e.jsxs("span",{children:["Due: ",le(x.due_date)]})]})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:`text-lg font-semibold ${je(x.type)}`,children:[x.type==="new_purchase"?"+":"-",W(parseFloat(x.amount.toString()))]})})]})},x.id)})}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(M,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No transactions yet with this supplier"})]})})]})})]}),v&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:["Pay Due to ",r.name]}),e.jsxs("form",{onSubmit:ge,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Amount *"}),e.jsxs("div",{className:"relative",children:[e.jsx(ee,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"number",step:"0.01",required:!0,value:j,onChange:x=>B(x.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Enter payment amount"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:L,onChange:x=>O(x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Payment description (optional)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Made By"}),e.jsxs("select",{value:E,onChange:x=>T(x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",children:[e.jsx("option",{value:"",children:"Select who made this payment"}),_.map(x=>e.jsxs("option",{value:x.id,children:[x.owner_name," ",x.is_primary&&"(Primary)"," - ",x.role]},x.id))]})]}),e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:e.jsxs("p",{className:"text-sm text-green-700",children:["Current outstanding: ",e.jsx("span",{className:"font-medium",children:W(F)})]})}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>b(!1),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Process Payment"})]})]})]})}),y&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:["New Purchase from ",r.name]}),e.jsxs("form",{onSubmit:be,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Purchase Amount *"}),e.jsxs("div",{className:"relative",children:[e.jsx(ee,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"number",step:"0.01",required:!0,value:u,onChange:x=>d(x.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter purchase amount"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("input",{type:"text",value:S,onChange:x=>k(x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Purchase description (optional)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Purchase Made By"}),e.jsxs("select",{value:a,onChange:x=>p(x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Select who made this purchase"}),_.map(x=>e.jsxs("option",{value:x.id,children:[x.owner_name," ",x.is_primary&&"(Primary)"," - ",x.role]},x.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Due Date"}),e.jsx("input",{type:"date",value:P,onChange:x=>D(x.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:()=>w(!1),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Add Purchase"})]})]})]})})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Supplier not found"}),e.jsx("button",{onClick:()=>n("/suppliers"),className:"text-blue-600 hover:text-blue-700",children:"Back to Suppliers"})]})},As=({isOpen:t,onClose:s,onSubmit:n,suppliers:r,businessOwners:c})=>{const[o,h]=l.useState({supplier_id:"",type:"new_purchase",amount:"",description:"",owner_id:""}),_=N=>{N.preventDefault(),n(o),h({supplier_id:"",type:"new_purchase",amount:"",description:"",owner_id:""})};return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-end sm:items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-t-xl sm:rounded-xl w-full sm:max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Add Transaction"}),e.jsx("button",{onClick:s,className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx(ae,{className:"h-5 w-5"})})]}),e.jsxs("form",{onSubmit:_,className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Transaction Type"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>h({...o,type:"new_purchase"}),className:`p-3 border rounded-lg text-center ${o.type==="new_purchase"?"border-red-500 bg-red-50 text-red-700":"border-gray-300 hover:bg-gray-50"}`,children:[e.jsx(he,{className:"h-4 w-4 mx-auto mb-1"}),e.jsx("span",{className:"text-sm",children:"Purchase"})]}),e.jsxs("button",{type:"button",onClick:()=>h({...o,type:"pay_due"}),className:`p-3 border rounded-lg text-center ${o.type==="pay_due"?"border-green-500 bg-green-50 text-green-700":"border-gray-300 hover:bg-gray-50"}`,children:[e.jsx(ee,{className:"h-4 w-4 mx-auto mb-1"}),e.jsx("span",{className:"text-sm",children:"Payment"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supplier"}),e.jsxs("select",{value:o.supplier_id,onChange:N=>h({...o,supplier_id:N.target.value}),required:!0,className:"w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Select Supplier"}),r.map(N=>e.jsx("option",{value:N.id,children:N.name},N.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount (₹)"}),e.jsx("input",{type:"number",value:o.amount,onChange:N=>h({...o,amount:N.target.value}),required:!0,min:"0",step:"0.01",placeholder:"Enter amount",className:"w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:o.type==="new_purchase"?"Purchased by":"Paid by"}),e.jsxs("select",{value:o.owner_id,onChange:N=>h({...o,owner_id:N.target.value}),className:"w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Select person"}),c.map(N=>e.jsx("option",{value:N.id,children:N.owner_name},N.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description (Optional)"}),e.jsx("input",{type:"text",value:o.description,onChange:N=>h({...o,description:N.target.value}),placeholder:"Add description...",className:"w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{className:"flex space-x-3 pt-2",children:[e.jsx("button",{type:"button",onClick:s,className:"flex-1 px-4 py-2.5 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Cancel"}),e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Add Transaction"})]})]})]})}):null},Ts=()=>{const{user:t}=R(),[s,n]=l.useState([]),[r,c]=l.useState([]),[o,h]=l.useState([]),[_,N]=l.useState(!0),[m,g]=l.useState(""),[v,b]=l.useState("all"),[y,w]=l.useState(!1);l.useEffect(()=>{j()},[t]);const j=async()=>{if(t)try{const{data:a,error:p}=await f.from("transactions").select(`
          *,
          supplier:suppliers(name),
          owner:business_owners(owner_name)
        `).eq("user_id",t.id).order("created_at",{ascending:!1});if(p)throw p;const{data:S,error:k}=await f.from("suppliers").select("*").eq("user_id",t.id).order("name");if(k)throw k;const D=await J.getInstance().getBusinessOwners(t.id);n(a||[]),c(S||[]),h(D||[])}catch(a){console.error("Error fetching data:",a)}finally{N(!1)}},B=async a=>{if(t)try{const{error:p}=await f.from("transactions").insert([{...a,user_id:t.id,amount:parseFloat(a.amount)}]);if(p)throw p;await j(),w(!1)}catch(p){console.error("Error adding transaction:",p)}},E=s.filter(a=>{var k,P,D,L,O;const p=((k=a.description)==null?void 0:k.toLowerCase().includes(m.toLowerCase()))||((D=(P=a.supplier)==null?void 0:P.name)==null?void 0:D.toLowerCase().includes(m.toLowerCase()))||((O=(L=a.owner)==null?void 0:L.owner_name)==null?void 0:O.toLowerCase().includes(m.toLowerCase())),S=v==="all"||a.type===v;return p&&S}),T=a=>{switch(a){case"new_purchase":return e.jsx(Pe,{className:"h-4 w-4 text-red-500"});case"pay_due":case"settle_bill":return e.jsx(De,{className:"h-4 w-4 text-green-500"});default:return e.jsx(M,{className:"h-4 w-4 text-gray-500"})}},u=a=>{switch(a){case"new_purchase":return"Purchase";case"pay_due":return"Payment";case"settle_bill":return"Settlement";default:return a}},d=a=>new Date(a).toLocaleDateString("en-IN",{month:"short",day:"numeric",year:"numeric"});return _?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Transactions"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Track all your business transactions"})]}),e.jsxs("button",{onClick:()=>w(!0),className:"bg-blue-600 text-white px-4 py-2.5 rounded-lg font-medium flex items-center justify-center hover:bg-blue-700 w-full sm:w-auto",children:[e.jsx(he,{className:"h-4 w-4 mr-2"}),"Add Transaction"]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(Ue,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search transactions...",value:m,onChange:a=>g(a.target.value),className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(ns,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsxs("select",{value:v,onChange:a=>b(a.target.value),className:"pl-10 pr-8 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 appearance-none bg-white",children:[e.jsx("option",{value:"all",children:"All Types"}),e.jsx("option",{value:"new_purchase",children:"Purchases"}),e.jsx("option",{value:"pay_due",children:"Payments"})]})]})]}),e.jsx("div",{className:"space-y-3",children:E.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(M,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 text-lg",children:"No transactions found"}),e.jsx("p",{className:"text-gray-400 text-sm",children:m?"Try adjusting your search":"Add your first transaction to get started"})]}):E.map(a=>{var p,S;return e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{className:"flex items-start space-x-3 flex-1 min-w-0",children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:T(a.type)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("h3",{className:"font-medium text-gray-900 truncate",children:(p=a.supplier)==null?void 0:p.name}),e.jsxs("p",{className:`font-semibold text-lg ${a.type==="new_purchase"?"text-red-600":"text-green-600"}`,children:[a.type==="new_purchase"?"+":"-","₹",Math.round(a.amount).toLocaleString()]})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:u(a.type)}),a.description&&e.jsx("p",{className:"text-sm text-gray-500 mb-2 line-clamp-2",children:a.description}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(se,{className:"h-3 w-3 mr-1"}),d(a.created_at)]}),((S=a.owner)==null?void 0:S.owner_name)&&e.jsxs("span",{className:"text-blue-600 font-medium",children:["by ",a.owner.owner_name]})]})]})]})})},a.id)})}),e.jsx(As,{isOpen:y,onClose:()=>w(!1),onSubmit:B,suppliers:r,businessOwners:o})]})},Is=()=>{const{user:t}=R(),[s,n]=l.useState({totalPurchases:0,totalPayments:0,netOutstanding:0,supplierBreakdown:[]}),[r,c]=l.useState([]),[o,h]=l.useState(!0),[_,N]=l.useState(""),[m,g]=l.useState("");l.useEffect(()=>{const j=new Date,B=new Date(j);B.setDate(j.getDate()-30),N(B.toISOString().split("T")[0]),g(j.toISOString().split("T")[0])},[]),l.useEffect(()=>{_&&m&&v()},[t,_,m]);const v=async()=>{if(t)try{h(!0);const{data:j,error:B}=await f.from("transactions").select(`
          *,
          supplier:suppliers(name)
        `).eq("user_id",t.id).gte("created_at",_).lte("created_at",m+"T23:59:59").order("created_at",{ascending:!1});if(B)throw B;c(j||[]);const E=new Map;let T=0,u=0;j==null||j.forEach(p=>{var D;const S=((D=p.supplier)==null?void 0:D.name)||"Unknown",k=parseFloat(p.amount.toString());E.has(S)||E.set(S,{supplier:S,purchases:0,payments:0,outstanding:0});const P=E.get(S);p.type==="new_purchase"?(P.purchases+=k,T+=k,p.is_paid||(P.outstanding+=k)):(p.type==="pay_due"||p.type==="settle_bill")&&(P.payments+=k,u+=k,P.outstanding-=k),E.set(S,P)});const d=Array.from(E.values()).sort((p,S)=>S.outstanding-p.outstanding),a=d.reduce((p,S)=>p+S.outstanding,0);n({totalPurchases:T,totalPayments:u,netOutstanding:Math.max(0,a),supplierBreakdown:d})}catch(j){console.error("Error fetching report data:",j)}finally{h(!1)}},b=()=>{const j=["Date","Supplier","Type","Description","Amount","Status","Due Date"],B=r.map(a=>{var p;return[new Date(a.created_at).toLocaleDateString("en-IN"),((p=a.supplier)==null?void 0:p.name)||"Unknown",y(a.type),a.description,parseFloat(a.amount.toString()),a.is_paid?"Paid":"Unpaid",a.due_date?new Date(a.due_date).toLocaleDateString("en-IN"):""]}),E=[j.join(","),...B.map(a=>a.map(p=>`"${p}"`).join(","))].join(`
`),T=new Blob([E],{type:"text/csv;charset=utf-8;"}),u=document.createElement("a"),d=URL.createObjectURL(T);u.setAttribute("href",d),u.setAttribute("download",`transactions-report-${_}-to-${m}.csv`),u.style.visibility="hidden",document.body.appendChild(u),u.click(),document.body.removeChild(u)},y=j=>{switch(j){case"new_purchase":return"New Purchase";case"pay_due":return"Payment";case"settle_bill":return"Settlement";default:return j}},w=j=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(j);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Reports"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Analyze your supplier transactions and dues"})]}),e.jsxs("button",{onClick:b,disabled:r.length===0,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),"Export CSV"]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 items-end",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"From Date"}),e.jsx("input",{type:"date",value:_,onChange:j=>N(j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"To Date"}),e.jsx("input",{type:"date",value:m,onChange:j=>g(j.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[e.jsx(se,{className:"h-4 w-4 mr-2"}),r.length," transactions found"]})]})}),o?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Purchases"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:w(s.totalPurchases)})]}),e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-xl flex items-center justify-center",children:e.jsx(ls,{className:"h-6 w-6 text-red-600"})})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Payments"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:w(s.totalPayments)})]}),e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:e.jsx(is,{className:"h-6 w-6 text-green-600"})})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Net Outstanding"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:w(s.netOutstanding)})]}),e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:e.jsx(Oe,{className:"h-6 w-6 text-blue-600"})})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Supplier Breakdown"}),e.jsx(cs,{className:"h-5 w-5 text-gray-400"})]}),s.supplierBreakdown.length>0?e.jsx("div",{className:"space-y-4",children:s.supplierBreakdown.map((j,B)=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:j.supplier}),e.jsxs("span",{className:"text-sm font-medium text-blue-600",children:["Outstanding: ",w(j.outstanding)]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Total Purchases"}),e.jsx("p",{className:"font-medium text-red-600",children:w(j.purchases)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Total Payments"}),e.jsx("p",{className:"font-medium text-green-600",children:w(j.payments)})]})]})]},B))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Oe,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No data available for the selected period"})]})]})]})]})};class Y{constructor(){this.isAuthenticated=!1,this.userEmail=""}static getInstance(){return Y.instance||(Y.instance=new Y),Y.instance}async initializeGoogleDrive(){console.log("Initializing Google Drive API...")}async authenticate(){try{return new Promise(s=>{setTimeout(()=>{this.isAuthenticated=!0,this.userEmail="user@gmail.com",s({success:!0,userEmail:this.userEmail})},2e3)})}catch(s){return console.error("Google Drive authentication failed:",s),{success:!1,userEmail:""}}}isConnected(){return this.isAuthenticated}getConnectedEmail(){return this.userEmail}async createBackup(s){try{return console.log("Creating backup on Google Drive...",s),new Promise(n=>{setTimeout(()=>{n({success:!0,fileId:`shopsynk-backup-${Date.now()}`})},3e3)})}catch(n){return console.error("Backup creation failed:",n),{success:!1}}}async scheduleAutoBackup(s){console.log("Auto backup scheduled for midnight daily");const n=new Date,r=new Date;r.setHours(24,0,0,0);const c=r.getTime()-n.getTime();setTimeout(()=>{s(),setInterval(s,24*60*60*1e3)},c)}disconnect(){this.isAuthenticated=!1,this.userEmail=""}}class Z{constructor(){this.googleDriveService=Y.getInstance()}static getInstance(){return Z.instance||(Z.instance=new Z),Z.instance}async exportUserData(s,n){try{const{data:r,error:c}=await f.from("suppliers").select("*").eq("user_id",s);if(c)throw c;const{data:o,error:h}=await f.from("transactions").select(`
          *,
          supplier:suppliers(name, contact_person, phone, email)
        `).eq("user_id",s);if(h)throw h;return{suppliers:r||[],transactions:o||[],exportDate:new Date().toISOString(),userEmail:n}}catch(r){return console.error("Error exporting user data:",r),null}}async createBackup(s,n){try{if(!this.googleDriveService.isConnected())return{success:!1,message:"Google Drive not connected. Please connect first."};const r=await this.exportUserData(s,n);if(!r)return{success:!1,message:"Failed to export user data."};const c=await this.googleDriveService.createBackup(r);return c.success?(await this.recordBackup(s,c.fileId||"",r),{success:!0,message:"Backup created successfully on Google Drive!"}):{success:!1,message:"Failed to upload backup to Google Drive."}}catch(r){return console.error("Backup creation error:",r),{success:!1,message:"An error occurred during backup creation."}}}async recordBackup(s,n,r){try{await f.from("user_backups").insert([{user_id:s,backup_date:new Date().toISOString(),google_drive_file_id:n,suppliers_count:r.suppliers.length,transactions_count:r.transactions.length,backup_size:JSON.stringify(r).length,status:"completed"}])}catch(c){console.error("Error recording backup:",c)}}async setupAutoBackup(s,n){const r=async()=>{console.log("Running automatic backup...");const c=await this.createBackup(s,n);console.log("Auto backup result:",c.message),await this.sendBackupNotification(n,c.success)};await this.googleDriveService.scheduleAutoBackup(r)}async sendBackupNotification(s,n){console.log(`Backup notification sent to ${s}: ${n?"Success":"Failed"}`)}async getBackupHistory(s){try{const{data:n,error:r}=await f.from("user_backups").select("*").eq("user_id",s).order("backup_date",{ascending:!1}).limit(10);if(r)throw r;return n||[]}catch(n){return console.error("Error fetching backup history:",n),[]}}downloadBackupFile(s){const n=JSON.stringify(s,null,2),r=new Blob([n],{type:"application/json"}),c=URL.createObjectURL(r),o=document.createElement("a");o.href=c,o.download=`shopsynk-backup-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(c)}}const Ls=()=>{const{user:t}=R(),[s,n]=l.useState(null),[r,c]=l.useState(!0),[o,h]=l.useState("pdf"),[_,N]=l.useState(!1),[m,g]=l.useState(!1),[v,b]=l.useState("");l.useEffect(()=>{y()},[t]);const y=async()=>{if(t)try{c(!0);const{count:a}=await f.from("transactions").select("*",{count:"exact",head:!0}).eq("user_id",t.id),{count:p}=await f.from("suppliers").select("*",{count:"exact",head:!0}).eq("user_id",t.id),{count:S}=await f.from("business_owners").select("*",{count:"exact",head:!0}).eq("user_id",t.id),{data:k}=await f.from("user_backups").select("created_at").eq("user_id",t.id).order("created_at",{ascending:!1}).limit(1).single(),P=.5,D=.3,L=.2,O=.1,F=(a||0)*P,z=(p||0)*D,A=(S||0)*L,X=F+z+A+O;n({totalTransactions:a||0,totalSuppliers:p||0,totalOwners:S||0,estimatedSizeKB:X,lastBackup:(k==null?void 0:k.created_at)||null,dataBreakdown:{transactions:{count:a||0,sizeKB:F},suppliers:{count:p||0,sizeKB:z},owners:{count:S||0,sizeKB:A},settings:{count:1,sizeKB:O}}})}catch(a){console.error("Error fetching storage stats:",a)}finally{c(!1)}},w=async a=>{if(t)try{N(!0);const[p,S,k]=await Promise.all([f.from("transactions").select("*, supplier:suppliers(name), owner:business_owners(owner_name)").eq("user_id",t.id).order("created_at",{ascending:!1}),f.from("suppliers").select("*").eq("user_id",t.id).order("name"),f.from("business_owners").select("*").eq("user_id",t.id).order("owner_name")]),P={exportDate:new Date().toISOString(),user:{id:t.id,email:t.email},summary:s,data:{transactions:p.data||[],suppliers:S.data||[],businessOwners:k.data||[]}};a==="json"?j(P):a==="csv"?B(P):a==="pdf"&&E(P)}catch(p){console.error("Error downloading data:",p),alert("Error downloading data. Please try again.")}finally{N(!1)}},j=a=>{const p=new Blob([JSON.stringify(a,null,2)],{type:"application/json"}),S=URL.createObjectURL(p),k=document.createElement("a");k.href=S,k.download=`shopsynk-data-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(k),k.click(),document.body.removeChild(k),URL.revokeObjectURL(S)},B=a=>{let p="Type,Supplier,Amount,Description,Date,Due Date,Status,Handled By\\n";a.data.transactions.forEach(D=>{var L,O;p+=`${D.type},"${((L=D.supplier)==null?void 0:L.name)||"Unknown"}",${D.amount},"${D.description}",${D.created_at},${D.due_date||""},${D.is_paid?"Paid":"Unpaid"},"${((O=D.owner)==null?void 0:O.owner_name)||"Unknown"}"\\n`});const S=new Blob([p],{type:"text/csv"}),k=URL.createObjectURL(S),P=document.createElement("a");P.href=k,P.download=`shopsynk-transactions-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(P),P.click(),document.body.removeChild(P),URL.revokeObjectURL(k)},E=a=>{const p=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Shopsynk Data Export</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 20px; }
          h1, h2 { color: #2563eb; }
          table { width: 100%; border-collapse: collapse; margin: 20px 0; }
          th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
          th { background-color: #f8f9fa; }
          .summary { background-color: #f0f9ff; padding: 15px; border-radius: 5px; margin: 20px 0; }
        </style>
      </head>
      <body>
        <h1>Shopsynk Data Export</h1>
        <p><strong>Export Date:</strong> ${new Date().toLocaleDateString()}</p>
        <p><strong>User:</strong> ${(t==null?void 0:t.email)||"Unknown"}</p>
        
        <div class="summary">
          <h2>Summary</h2>
          <p><strong>Total Transactions:</strong> ${s==null?void 0:s.totalTransactions}</p>
          <p><strong>Total Suppliers:</strong> ${s==null?void 0:s.totalSuppliers}</p>
          <p><strong>Total Owners:</strong> ${s==null?void 0:s.totalOwners}</p>
          <p><strong>Estimated Size:</strong> ${((s==null?void 0:s.estimatedSizeKB)||0).toFixed(2)} KB</p>
        </div>

        <h2>Recent Transactions</h2>
        <table>
          <tr>
            <th>Date</th>
            <th>Type</th>
            <th>Supplier</th>
            <th>Amount</th>
            <th>Status</th>
            <th>Handled By</th>
          </tr>
          ${a.data.transactions.slice(0,50).map(D=>{var L,O;return`
            <tr>
              <td>${new Date(D.created_at).toLocaleDateString()}</td>
              <td>${D.type}</td>
              <td>${((L=D.supplier)==null?void 0:L.name)||"Unknown"}</td>
              <td>₹${D.amount}</td>
              <td>${D.is_paid?"Paid":"Unpaid"}</td>
              <td>${((O=D.owner)==null?void 0:O.owner_name)||"Unknown"}</td>
            </tr>
          `}).join("")}
        </table>
      </body>
      </html>
    `,S=new Blob([p],{type:"text/html"}),k=URL.createObjectURL(S),P=document.createElement("a");P.href=k,P.download=`shopsynk-report-${new Date().toISOString().split("T")[0]}.html`,document.body.appendChild(P),P.click(),document.body.removeChild(P),URL.revokeObjectURL(k)},T=async()=>{if(t)try{g(!0),b("Preparing backup...");const a=Z.getInstance();b("Creating backup..."),await a.createBackup(t.id,t.email||"unknown@email.com"),b("Backup completed successfully!"),setTimeout(()=>b(""),3e3),await y()}catch(a){console.error("Error creating manual backup:",a),b("Backup failed. Please try again."),setTimeout(()=>b(""),3e3)}finally{g(!1)}},u=a=>a<1?`${(a*1024).toFixed(0)} bytes`:a<1024?`${a.toFixed(2)} KB`:`${(a/1024).toFixed(2)} MB`,d=a=>a?new Date(a).toLocaleString():"Never";return r?e.jsxs("div",{className:"flex items-center justify-center h-64",children:[e.jsx(H,{className:"h-8 w-8 animate-spin text-blue-500"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Loading storage information..."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Data Storage & Export"}),e.jsxs("button",{onClick:y,className:"flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:[e.jsx(H,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Fe,{className:"h-8 w-8 text-blue-500"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Storage"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:u((s==null?void 0:s.estimatedSizeKB)||0)})]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(M,{className:"h-8 w-8 text-green-500"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Transactions"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s==null?void 0:s.totalTransactions})]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Be,{className:"h-8 w-8 text-purple-500"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Suppliers"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s==null?void 0:s.totalSuppliers})]})]})}),e.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(V,{className:"h-8 w-8 text-orange-500"}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Business Owners"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s==null?void 0:s.totalOwners})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Storage Breakdown"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(M,{className:"h-5 w-5 text-green-500 mr-3"}),e.jsx("span",{className:"font-medium",children:"Transactions Data"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-medium",children:[s==null?void 0:s.dataBreakdown.transactions.count," records"]}),e.jsx("p",{className:"text-sm text-gray-500",children:u((s==null?void 0:s.dataBreakdown.transactions.sizeKB)||0)})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Be,{className:"h-5 w-5 text-purple-500 mr-3"}),e.jsx("span",{className:"font-medium",children:"Suppliers Data"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-medium",children:[s==null?void 0:s.dataBreakdown.suppliers.count," records"]}),e.jsx("p",{className:"text-sm text-gray-500",children:u((s==null?void 0:s.dataBreakdown.suppliers.sizeKB)||0)})]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(V,{className:"h-5 w-5 text-orange-500 mr-3"}),e.jsx("span",{className:"font-medium",children:"Business Owners"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-medium",children:[s==null?void 0:s.dataBreakdown.owners.count," records"]}),e.jsx("p",{className:"text-sm text-gray-500",children:u((s==null?void 0:s.dataBreakdown.owners.sizeKB)||0)})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Export Data"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Export Format"}),e.jsxs("select",{value:o,onChange:a=>h(a.target.value),className:"w-full md:w-64 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"pdf",children:"PDF Report"}),e.jsx("option",{value:"csv",children:"CSV (Spreadsheet)"}),e.jsx("option",{value:"json",children:"JSON (Raw Data)"})]})]}),e.jsx("div",{className:"flex flex-wrap gap-3",children:e.jsxs("button",{onClick:()=>w(o),disabled:_,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[_?e.jsx(H,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(xe,{className:"h-4 w-4 mr-2"}),_?"Preparing...":`Download ${o.toUpperCase()}`]})}),e.jsxs("div",{className:"text-sm text-gray-500",children:[e.jsx("p",{children:"• PDF: Formatted report with summary and recent transactions"}),e.jsx("p",{children:"• CSV: Spreadsheet format for analysis and import"}),e.jsx("p",{children:"• JSON: Complete raw data for technical use"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Backup Management"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ce,{className:"h-6 w-6 text-blue-500 mr-3"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-900",children:"Last Backup"}),e.jsx("p",{className:"text-sm text-blue-700",children:d((s==null?void 0:s.lastBackup)||null)})]})]}),e.jsxs("button",{onClick:T,disabled:m,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[m?e.jsx(H,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(os,{className:"h-4 w-4 mr-2"}),m?"Creating Backup...":"Create Backup Now"]})]}),v&&e.jsxs("div",{className:`flex items-center p-3 rounded-lg ${v.includes("failed")?"bg-red-50 border border-red-200 text-red-700":v.includes("success")?"bg-green-50 border border-green-200 text-green-700":"bg-yellow-50 border border-yellow-200 text-yellow-700"}`,children:[v.includes("failed")?e.jsx(oe,{className:"h-5 w-5 mr-2"}):v.includes("success")?e.jsx(de,{className:"h-5 w-5 mr-2"}):e.jsx(H,{className:"h-5 w-5 mr-2 animate-spin"}),v]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[e.jsx("p",{children:"• Automatic backups run daily when configured"}),e.jsx("p",{children:"• Manual backups are stored in your connected Google Drive"}),e.jsx("p",{children:"• Configure automatic backups in your Profile settings"})]})]})]})]})},Fs=()=>{const{user:t}=R(),[s,n]=l.useState({suppliersCount:0,transactionsCount:0,totalOutstanding:0,lastLogin:""}),[r,c]=l.useState(!0),[o,h]=l.useState({isConnected:!1,userEmail:"",lastBackup:"",autoBackupEnabled:!0}),[_,N]=l.useState([]),[m,g]=l.useState(!1),[v,b]=l.useState(!1),[y,w]=l.useState(""),j=Z.getInstance(),B=Y.getInstance(),E=J.getInstance(),[T,u]=l.useState([]),[d,a]=l.useState([]),[p,S]=l.useState(!1),[k,P]=l.useState(null),[D,L]=l.useState({owner_name:"",role:"Owner"}),[O,F]=l.useState("");l.useEffect(()=>{ie(),A(),X(),z()},[t]);const z=async()=>{var i;if(t)try{await E.ensurePrimaryOwner(t.id,t.email,(i=t.user_metadata)==null?void 0:i.full_name);const C=await E.getBusinessOwners(t.id);u(C);const q=await E.getOwnerStats(t.id);a(q)}catch(C){console.error("Error loading business owners:",C),F("Error loading business owners.")}},A=async()=>{if(t)try{const{data:i,error:C}=await f.from("user_settings").select("*").eq("user_id",t.id).single();if(C&&C.code!=="PGRST116")throw C;i&&h({isConnected:i.google_drive_connected||!1,userEmail:i.google_drive_email||"",lastBackup:i.last_backup_date||"",autoBackupEnabled:i.auto_backup_enabled||!0})}catch(i){console.error("Error loading Google Drive settings:",i)}},X=async()=>{if(t)try{const i=await j.getBackupHistory(t.id);N(i)}catch(i){console.error("Error loading backup history:",i)}},re=async()=>{g(!0),w("");try{const i=await B.authenticate();i.success?(await f.from("user_settings").upsert({user_id:t==null?void 0:t.id,google_drive_connected:!0,google_drive_email:i.userEmail,updated_at:new Date().toISOString()}),h(C=>({...C,isConnected:!0,userEmail:i.userEmail})),w("Successfully connected to Google Drive!"),await j.setupAutoBackup(t.id,t.email)):w("Failed to connect to Google Drive. Please try again.")}catch(i){console.error("Google Drive connection error:",i),w("An error occurred while connecting to Google Drive.")}finally{g(!1)}},ge=async()=>{try{B.disconnect(),await f.from("user_settings").upsert({user_id:t==null?void 0:t.id,google_drive_connected:!1,google_drive_email:null,updated_at:new Date().toISOString()}),h(i=>({...i,isConnected:!1,userEmail:""})),w("Disconnected from Google Drive.")}catch(i){console.error("Error disconnecting Google Drive:",i),w("Error disconnecting from Google Drive.")}},be=async()=>{if(t){b(!0),w("");try{const i=await j.createBackup(t.id,t.email);w(i.message),i.success&&(await X(),await A())}catch(i){console.error("Manual backup error:",i),w("An error occurred during backup.")}finally{b(!1)}}},W=async()=>{if(t)try{const i=await j.exportUserData(t.id,t.email);i?(j.downloadBackupFile(i),w("Backup file downloaded successfully!")):w("Failed to create backup file.")}catch(i){console.error("Download backup error:",i),w("Error creating backup file.")}},le=async()=>{if(t)try{const i=!o.autoBackupEnabled;await f.from("user_settings").upsert({user_id:t.id,auto_backup_enabled:i,updated_at:new Date().toISOString()}),h(C=>({...C,autoBackupEnabled:i})),w(`Auto backup ${i?"enabled":"disabled"}.`)}catch(i){console.error("Error toggling auto backup:",i),w("Error updating auto backup setting.")}},fe=async i=>{if(i.preventDefault(),!!t)try{const C=await E.createBusinessOwner(t.id,D);C.success?(F("Owner added successfully!"),await z(),I()):F(`Error: ${C.error}`)}catch(C){console.error("Error adding owner:",C),F("An error occurred while adding the owner.")}},ye=i=>{P(i),L({owner_name:i.owner_name,role:i.role}),S(!0)},je=async i=>{if(i.preventDefault(),!!k)try{const C=await E.updateBusinessOwner(k.id,D);C.success?(F("Owner updated successfully!"),await z(),I()):F(`Error: ${C.error}`)}catch(C){console.error("Error updating owner:",C),F("An error occurred while updating the owner.")}},x=async i=>{if(confirm("Are you sure you want to remove this owner? This action cannot be undone."))try{const C=await E.deactivateBusinessOwner(i);C.success?(F("Owner removed successfully."),await z()):F(`Error: ${C.error}`)}catch(C){console.error("Error removing owner:",C),F("An error occurred while removing the owner.")}},I=()=>{L({owner_name:"",role:"Owner"}),P(null),S(!1)},G=i=>d.find(C=>C.owner_id===i)||{total_transactions:0,total_purchases:0,total_payments:0,total_purchase_amount:0,total_payment_amount:0},ie=async()=>{if(t)try{const{count:i}=await f.from("suppliers").select("*",{count:"exact",head:!0}).eq("user_id",t.id),{count:C}=await f.from("transactions").select("*",{count:"exact",head:!0}).eq("user_id",t.id),{data:q}=await f.from("transactions").select("type, amount, is_paid").eq("user_id",t.id);let K=0;q==null||q.forEach($=>{$.type==="new_purchase"&&!$.is_paid?K+=parseFloat($.amount.toString()):($.type==="pay_due"||$.type==="settle_bill")&&(K-=parseFloat($.amount.toString()))}),n({suppliersCount:i||0,transactionsCount:C||0,totalOutstanding:Math.max(0,K),lastLogin:t.last_sign_in_at||t.created_at||""})}catch(i){console.error("Error fetching user stats:",i)}finally{c(!1)}},we=i=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(i),Q=i=>new Date(i).toLocaleDateString("en-IN",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return r?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Profile"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your account settings and view activity"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Account Information"}),e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:e.jsx(ue,{className:"h-6 w-6 text-blue-600"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx(ne,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Email Address"}),e.jsx("p",{className:"font-medium text-gray-900",children:t==null?void 0:t.email})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx(ds,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Account Status"}),e.jsx("p",{className:"font-medium text-green-600",children:"Active"})]})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx(se,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Account Created"}),e.jsx("p",{className:"font-medium text-gray-900",children:t!=null&&t.created_at?Q(t.created_at):"N/A"})]})]}),s.lastLogin&&e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx(se,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Last Sign In"}),e.jsx("p",{className:"font-medium text-gray-900",children:Q(s.lastLogin)})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Activity Summary"}),e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:e.jsx(ce,{className:"h-6 w-6 text-green-600"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"Total Suppliers"}),e.jsx("p",{className:"text-2xl font-bold text-blue-700",children:s.suppliersCount})]})}),e.jsx("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-green-600 font-medium",children:"Total Transactions"}),e.jsx("p",{className:"text-2xl font-bold text-green-700",children:s.transactionsCount})]})}),e.jsx("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-lg",children:e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-red-600 font-medium",children:"Outstanding Amount"}),e.jsx("p",{className:"text-2xl font-bold text-red-700",children:we(s.totalOutstanding)})]})})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center",children:e.jsx(V,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Business Owners"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage owners and track their activities"})]})]}),e.jsxs("button",{onClick:()=>S(!0),className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors flex items-center",children:[e.jsx(us,{className:"h-4 w-4 mr-2"}),"Add Owner"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:T.map(i=>{const C=G(i.id);return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:i.is_primary?e.jsx(ms,{className:"h-5 w-5 text-yellow-500"}):e.jsx(ue,{className:"h-5 w-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:i.owner_name}),e.jsx("p",{className:"text-sm text-gray-600",children:i.role}),i.is_primary&&e.jsx("span",{className:"text-xs bg-yellow-100 text-yellow-700 px-2 py-1 rounded-full",children:"Primary"})]})]}),!i.is_primary&&e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{onClick:()=>ye(i),className:"p-1 text-gray-400 hover:text-blue-600 rounded",title:"Edit owner",children:e.jsx(Me,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>x(i.id),className:"p-1 text-gray-400 hover:text-red-600 rounded",title:"Remove owner",children:e.jsx(ze,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"mt-4 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-blue-600 font-medium",children:C.total_purchases}),e.jsx("p",{className:"text-gray-500",children:"Purchases"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-green-600 font-medium",children:C.total_payments}),e.jsx("p",{className:"text-gray-500",children:"Payments"})]}),e.jsxs("div",{className:"col-span-2 text-center",children:[e.jsx("p",{className:"text-purple-600 font-medium",children:we(C.total_purchase_amount-C.total_payment_amount)}),e.jsx("p",{className:"text-gray-500",children:"Net Activity"})]})]})})]},i.id)})}),T.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(V,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No business owners found"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Add owners to track who handles transactions"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Google Drive Backup"}),e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:e.jsx(Ae,{className:"h-6 w-6 text-blue-600"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[o.isConnected?e.jsx(de,{className:"h-5 w-5 text-green-500"}):e.jsx(Se,{className:"h-5 w-5 text-red-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Connection Status"}),e.jsx("p",{className:`font-medium ${o.isConnected?"text-green-600":"text-red-600"}`,children:o.isConnected?"Connected":"Not Connected"}),o.isConnected&&o.userEmail&&e.jsx("p",{className:"text-xs text-gray-500",children:o.userEmail})]})]}),o.isConnected&&e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(xs,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Auto Backup"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Daily at midnight"})]})]}),e.jsx("button",{onClick:le,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${o.autoBackupEnabled?"bg-blue-600":"bg-gray-200"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${o.autoBackupEnabled?"translate-x-6":"translate-x-1"}`})})]}),o.lastBackup&&e.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[e.jsx(se,{className:"h-5 w-5 text-gray-400"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Last Backup"}),e.jsx("p",{className:"font-medium text-gray-900",children:Q(o.lastBackup)})]})]}),e.jsx("div",{className:"flex space-x-3",children:o.isConnected?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:be,disabled:v,className:"flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors disabled:bg-green-400 flex items-center justify-center",children:v?e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"h-4 w-4 mr-2 animate-spin"}),"Backing up..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ce,{className:"h-4 w-4 mr-2"}),"Backup Now"]})}),e.jsx("button",{onClick:ge,className:"px-4 py-2 border border-red-300 text-red-600 rounded-lg hover:bg-red-50 transition-colors",children:"Disconnect"})]}):e.jsx("button",{onClick:re,disabled:m,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors disabled:bg-blue-400 flex items-center justify-center",children:m?e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"h-4 w-4 mr-2 animate-spin"}),"Connecting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ae,{className:"h-4 w-4 mr-2"}),"Connect Google Drive"]})})}),e.jsxs("button",{onClick:W,className:"w-full bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 transition-colors flex items-center justify-center",children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),"Download Local Backup"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Backup History"}),e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:e.jsx(hs,{className:"h-6 w-6 text-green-600"})})]}),e.jsx("div",{className:"space-y-3",children:_.length>0?_.slice(0,5).map(i=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${i.status==="completed"?"bg-green-500":i.status==="failed"?"bg-red-500":"bg-yellow-500"}`}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:Q(i.backup_date)}),e.jsxs("p",{className:"text-xs text-gray-500",children:[i.suppliers_count," suppliers, ",i.transactions_count," transactions"]})]})]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${i.status==="completed"?"bg-green-100 text-green-700":i.status==="failed"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:i.status})]},i.id)):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ce,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No backups yet"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Connect Google Drive to start automatic backups"})]})})]})]}),y&&e.jsx("div",{className:`border rounded-lg p-4 ${y.includes("Success")||y.includes("successfully")?"bg-green-50 border-green-200":y.includes("Error")||y.includes("Failed")?"bg-red-50 border-red-200":"bg-blue-50 border-blue-200"}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[y.includes("Success")||y.includes("successfully")?e.jsx(de,{className:"h-5 w-5 text-green-600 mt-0.5"}):y.includes("Error")||y.includes("Failed")?e.jsx(Se,{className:"h-5 w-5 text-red-600 mt-0.5"}):e.jsx(oe,{className:"h-5 w-5 text-blue-600 mt-0.5"}),e.jsx("div",{children:e.jsx("p",{className:`text-sm font-medium ${y.includes("Success")||y.includes("successfully")?"text-green-800":y.includes("Error")||y.includes("Failed")?"text-red-800":"text-blue-800"}`,children:y})})]})}),O&&e.jsx("div",{className:`border rounded-lg p-4 ${O.includes("Success")||O.includes("successfully")?"bg-green-50 border-green-200":O.includes("Error")||O.includes("Failed")?"bg-red-50 border-red-200":"bg-blue-50 border-blue-200"}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[O.includes("Success")||O.includes("successfully")?e.jsx(de,{className:"h-5 w-5 text-green-600 mt-0.5"}):O.includes("Error")||O.includes("Failed")?e.jsx(Se,{className:"h-5 w-5 text-red-600 mt-0.5"}):e.jsx(oe,{className:"h-5 w-5 text-blue-600 mt-0.5"}),e.jsx("div",{children:e.jsx("p",{className:`text-sm font-medium ${O.includes("Success")||O.includes("successfully")?"text-green-800":O.includes("Error")||O.includes("Failed")?"text-red-800":"text-blue-800"}`,children:O})})]})}),p&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:k?"Edit Owner":"Add New Owner"}),e.jsxs("form",{onSubmit:k?je:fe,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Owner Name *"}),e.jsx("input",{type:"text",required:!0,value:D.owner_name,onChange:i=>L({...D,owner_name:i.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",placeholder:"Enter owner's full name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role/Title"}),e.jsx("input",{type:"text",value:D.role,onChange:i=>L({...D,role:i.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",placeholder:"e.g., Owner, Partner, Manager"})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:I,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:k?"Update Owner":"Add Owner"})]})]})]})}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(oe,{className:"h-5 w-5 text-yellow-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Security Notice"}),e.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:"Your data is securely stored and encrypted. Always sign out when using shared devices. If you notice any unusual activity, please contact support immediately."})]})]})})]})};function $s(){return e.jsx(vs,{children:e.jsx(Xe,{children:e.jsx("div",{className:"App",children:e.jsxs(Ee,{children:[e.jsx(U,{path:"/login",element:e.jsx(Ds,{})}),e.jsx(U,{path:"/register",element:e.jsx(Ps,{})}),e.jsx(U,{path:"/*",element:e.jsx(_s,{children:e.jsx(Cs,{children:e.jsxs(Ee,{children:[e.jsx(U,{path:"/",element:e.jsx(Es,{})}),e.jsx(U,{path:"/suppliers",element:e.jsx(Os,{})}),e.jsx(U,{path:"/suppliers/:id",element:e.jsx(Bs,{})}),e.jsx(U,{path:"/transactions",element:e.jsx(Ts,{})}),e.jsx(U,{path:"/reports",element:e.jsx(Is,{})}),e.jsx(U,{path:"/data-storage",element:e.jsx(Ls,{})}),e.jsx(U,{path:"/profile",element:e.jsx(Fs,{})}),e.jsx(U,{path:"*",element:e.jsx(Ie,{to:"/",replace:!0})})]})})})})]})})})})}We(document.getElementById("root")).render(e.jsx(l.StrictMode,{children:e.jsx($s,{})}));
