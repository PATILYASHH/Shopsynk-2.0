const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.es-2Eur94l8.js","assets/vendor-Dl7uvwRy.js","assets/supabase-BEcQKNCL.js","assets/ui-CHHZbLQH.js"])))=>i.map(i=>d[i]);
var o8=Object.defineProperty;var l8=(e,t,r)=>t in e?o8(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var rr=(e,t,r)=>l8(e,typeof t!="symbol"?t+"":t,r);import{r as U,a as Y_,N as X_,u as Fo,b as Wg,R as c8,L as Z_,d as J_,e as Do,f as u8,B as f8,h as ay,i as va}from"./vendor-Dl7uvwRy.js";import{c as h8,_ as ym}from"./supabase-BEcQKNCL.js";import{X as jo,D as Mc,R as Ss,B as k1,C as d8,T as Sl,S as iy,U as Sn,L as sy,P as li,a as p8,b as C1,H as Q_,c as Es,d as O1,F as Nf,e as ff,f as zu,g as wa,h as Un,E as nf,M as Al,i as L1,j as F1,k as D1,A as Zf,l as bm,m as Sf,n as Af,o as Hg,p as gl,q as Rc,r as _o,s as oy,t as vc,u as xl,v as m8,w as e4,x as g8,y as x8,z as I1,G as ly,I as Nc,J as cy,K as uy,N as Sc,O as v8,Q as No,V as ba,W as t4,Y as r4,Z as hf,_ as ol,$ as Oh,a0 as n4,a1 as a4,a2 as y8,a3 as b8,a4 as pc,a5 as i4,a6 as Gg,a7 as w8,a8 as _8,a9 as N8,aa as fy,ab as wm}from"./ui-CHHZbLQH.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var s4={exports:{}},Fd={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var S8=U,A8=Symbol.for("react.element"),E8=Symbol.for("react.fragment"),T8=Object.prototype.hasOwnProperty,j8=S8.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,P8={key:!0,ref:!0,__self:!0,__source:!0};function o4(e,t,r){var n,a={},i=null,s=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(s=t.ref);for(n in t)T8.call(t,n)&&!P8.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:A8,type:e,key:i,ref:s,props:a,_owner:j8.current}}Fd.Fragment=E8;Fd.jsx=o4;Fd.jsxs=o4;s4.exports=Fd;var u=s4.exports,l4,hy=Y_;l4=hy.createRoot,hy.hydrateRoot;const k8="https://gxgiqmmlvdgrzvbgmgfp.supabase.co",C8="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd4Z2lxbW1sdmRncnp2YmdtZ2ZwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYwOTA4OTEsImV4cCI6MjA3MTY2Njg5MX0.VzO5yGWCFpN6ZU7d76tK9ADFPNwukuQ96RD3iILpAg0",Ye=h8(k8,C8),c4=U.createContext(void 0),ha=()=>{const e=U.useContext(c4);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e},O8=({children:e})=>{const[t,r]=U.useState(null),[n,a]=U.useState(!0);U.useEffect(()=>{Ye.auth.getUser().then(({data:{user:f}})=>{r(f),a(!1)});const{data:{subscription:c}}=Ye.auth.onAuthStateChange((f,h)=>{r((h==null?void 0:h.user)??null),a(!1)});return()=>c.unsubscribe()},[]);const l={user:t,loading:n,signUp:async(c,f)=>{const{data:h,error:p}=await Ye.auth.signUp({email:c,password:f});return{data:h,error:p}},signIn:async(c,f)=>{const{data:h,error:p}=await Ye.auth.signInWithPassword({email:c,password:f});return{data:h,error:p}},signOut:async()=>{const{error:c}=await Ye.auth.signOut();if(c)throw c}};return u.jsx(c4.Provider,{value:l,children:e})};class Ac{static async cleanupOldNotifications(){try{const t=new Date;t.setDate(t.getDate()-7);const{error:r}=await Ye.from("notifications").delete().lt("created_at",t.toISOString());if(r)throw r;console.log("‚úÖ Old notifications cleaned up successfully")}catch(t){console.error("‚ùå Error cleaning up old notifications:",t)}}static async cleanupReadNotifications(){try{const t=new Date;t.setDate(t.getDate()-3);const{error:r}=await Ye.from("notifications").delete().eq("read",!0).lt("created_at",t.toISOString());if(r)throw r;console.log("‚úÖ Read notifications cleaned up successfully")}catch(t){console.error("‚ùå Error cleaning up read notifications:",t)}}static async limitNotificationsPerUser(t,r=50){try{const{data:n,error:a}=await Ye.from("notifications").select("id, created_at").eq("user_id",t).order("created_at",{ascending:!1});if(a)throw a;if(!n||n.length<=r)return;const s=n.slice(r).map(l=>l.id),{error:o}=await Ye.from("notifications").delete().in("id",s);if(o)throw o;console.log(`‚úÖ Kept latest ${r} notifications, removed ${s.length} old ones`)}catch(n){console.error("‚ùå Error limiting notifications per user:",n)}}static async limitAllUsersNotifications(){try{const{data:t,error:r}=await Ye.from("notifications").select("user_id");if(r)throw r;if(!t)return;const n=[...new Set(t.map(a=>a.user_id))];for(const a of n)typeof a=="string"&&await this.limitNotificationsPerUser(a,100)}catch(t){console.error("‚ùå Error limiting notifications for all users:",t)}}static async performFullCleanup(){console.log("üßπ Starting notification database cleanup..."),await this.cleanupOldNotifications(),await this.cleanupReadNotifications(),await this.limitAllUsersNotifications(),console.log("‚úÖ Full notification cleanup completed")}static async deleteReadNotification(t){try{setTimeout(async()=>{const{error:r}=await Ye.from("notifications").delete().eq("id",t).eq("read",!0);r?console.error("Error auto-deleting read notification:",r):console.log("‚úÖ Auto-deleted read notification")},5e3)}catch(r){console.error("Error in auto-delete process:",r)}}static async getNotificationStats(){try{const{count:t,error:r}=await Ye.from("notifications").select("*",{count:"exact",head:!0});if(r)throw r;const{count:n,error:a}=await Ye.from("notifications").select("*",{count:"exact",head:!0}).eq("read",!0);if(a)throw a;const{count:i,error:s}=await Ye.from("notifications").select("*",{count:"exact",head:!0}).eq("read",!1);if(s)throw s;const o=t||0,l=n||0,c=i||0,f=o>0?Math.round(l/o*100):0;return{total:o,read:l,unread:c,readPercentage:f}}catch(t){return console.error("Error getting notification stats:",t),{total:0,read:0,unread:0,readPercentage:0}}}}class yc{constructor(){this.registration=null}static getInstance(){return yc.instance||(yc.instance=new yc),yc.instance}async initialize(){try{return!("serviceWorker"in navigator)||!("PushManager"in window)?(console.warn("Push notifications are not supported in this browser"),!1):(this.registration=await navigator.serviceWorker.register("/sw.js"),console.log("Service Worker registered successfully"),await navigator.serviceWorker.ready,!0)}catch(t){return console.error("Failed to initialize push notifications:",t),!1}}async requestPermission(){if(!("Notification"in window))return console.warn("This browser does not support notifications"),!1;let t=Notification.permission;return t==="default"&&(t=await Notification.requestPermission()),t==="granted"?(console.log("Notification permission granted"),!0):(console.warn("Notification permission denied"),!1)}async subscribe(t){try{if(this.registration||await this.initialize(),!this.registration)throw new Error("Service worker registration failed");const r=await this.registration.pushManager.getSubscription();if(r)return await this.saveSubscription(r,t),!0;const n=await this.registration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:this.urlBase64ToUint8Array("BEl62iUYgUivxIkv69yViEuiBIa40HI80YS_qZfKsRBF2uMi85KZJw-q9_-k9Q_nM8F1jQk2dGvQQQ6VDNt-3hc")});return await this.saveSubscription(n,t),console.log("Push notification subscription successful"),!0}catch(r){return console.error("Failed to subscribe to push notifications:",r),!1}}async unsubscribe(t){try{if(!this.registration)return!1;const r=await this.registration.pushManager.getSubscription();return r?(await r.unsubscribe(),await this.removeSubscription(t),console.log("Push notification unsubscribed successfully"),!0):!1}catch(r){return console.error("Failed to unsubscribe from push notifications:",r),!1}}async saveSubscription(t,r){const n=t.getKey?{p256dh:this.arrayBufferToBase64(t.getKey("p256dh")),auth:this.arrayBufferToBase64(t.getKey("auth"))}:{p256dh:"",auth:""},a={user_id:r,endpoint:t.endpoint,p256dh:n.p256dh,auth:n.auth,user_agent:navigator.userAgent},{error:i}=await Ye.from("push_subscriptions").upsert(a,{onConflict:"user_id"});if(i)throw new Error(`Failed to save push subscription: ${i.message}`)}async removeSubscription(t){const{error:r}=await Ye.from("push_subscriptions").delete().eq("user_id",t);r&&console.error("Failed to remove push subscription:",r)}async isSubscribed(){try{return this.registration?await this.registration.pushManager.getSubscription()!==null:!1}catch(t){return console.error("Failed to check subscription status:",t),!1}}async getSubscriptionStatus(){const t="serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window,r=t?Notification.permission:"denied",n=t?await this.isSubscribed():!1;return{supported:t,permission:r,subscribed:n}}urlBase64ToUint8Array(t){const r="=".repeat((4-t.length%4)%4),n=(t+r).replace(/-/g,"+").replace(/_/g,"/"),a=window.atob(n),i=new Uint8Array(a.length);for(let s=0;s<a.length;++s)i[s]=a.charCodeAt(s);return i}arrayBufferToBase64(t){if(!t)return"";const r=new Uint8Array(t);let n="";for(let a=0;a<r.byteLength;a++)n+=String.fromCharCode(r[a]);return window.btoa(n)}}const mo=yc.getInstance(),u4=U.createContext(void 0),L8=()=>{const e=U.useContext(u4);if(!e)throw new Error("useNotifications must be used within a NotificationProvider");return e},F8=({children:e})=>{const[t,r]=U.useState([]),{user:n}=ha(),a=t.filter(x=>!x.read).length;U.useEffect(()=>{if(!(n!=null&&n.id))return;s(),o(),i(),Ac.limitNotificationsPerUser(n.id,50);const x=setInterval(()=>{Ac.limitNotificationsPerUser(n.id,50)},30*60*1e3);return()=>{clearInterval(x)}},[n==null?void 0:n.id]);const i=async()=>{if(n!=null&&n.id)try{if(!await mo.initialize()){console.warn("Push notifications not supported or failed to initialize");return}if(!await mo.requestPermission()){console.warn("Push notification permission denied");return}await mo.subscribe(n.id)?console.log("Push notifications enabled successfully"):console.warn("Failed to subscribe to push notifications"),"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",b=>{var T;if(((T=b.data)==null?void 0:T.type)==="MARK_NOTIFICATION_READ"){const S=b.data.notificationId;c(S)}})}catch(x){console.error("Push notification initialization failed:",x)}},s=async()=>{if(n!=null&&n.id)try{const{data:x,error:g}=await Ye.from("notifications").select("*").eq("user_id",n.id).order("created_at",{ascending:!1}).limit(50);if(g)throw g;const y=x.map(b=>({id:b.id,userId:b.user_id,type:b.type,title:b.title,message:b.message,data:b.data,read:b.read,createdAt:b.created_at,updatedAt:b.updated_at}));r(y)}catch(x){console.error("Error loading notifications:",x)}},o=()=>{if(!(n!=null&&n.id))return;const x=Ye.channel("notifications").on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`user_id=eq.${n.id}`},g=>{const y={id:g.new.id,userId:g.new.user_id,type:g.new.type,title:g.new.title,message:g.new.message,data:g.new.data,read:g.new.read,createdAt:g.new.created_at,updatedAt:g.new.updated_at};r(b=>[y,...b]),"Notification"in window&&window.Notification.permission==="granted"&&new window.Notification(y.title,{body:y.message,icon:"/pwa opning/SHOP.png",tag:y.id})}).subscribe();return()=>{x.unsubscribe()}},l=async x=>{if(n!=null&&n.id)try{const{data:g,error:y}=await Ye.from("notifications").insert({user_id:n.id,type:x.type,title:x.title,message:x.message,data:x.data,read:!1}).select().single();if(y)throw y;const b={id:g.id,userId:g.user_id,type:g.type,title:g.title,message:g.message,data:g.data,read:g.read,createdAt:g.created_at,updatedAt:g.updated_at};r(T=>[b,...T])}catch(g){console.error("Error adding notification:",g)}},c=async x=>{try{const{error:g}=await Ye.from("notifications").update({read:!0,updated_at:new Date().toISOString()}).eq("id",x);if(g)throw g;r(y=>y.map(b=>b.id===x?{...b,read:!0}:b)),Ac.deleteReadNotification(x)}catch(g){console.error("Error marking notification as read:",g)}},d={notifications:t,unreadCount:a,addNotification:l,markAsRead:c,markAllAsRead:async()=>{if(n!=null&&n.id)try{const{error:x}=await Ye.from("notifications").update({read:!0,updated_at:new Date().toISOString()}).eq("user_id",n.id).eq("read",!1);if(x)throw x;r(g=>g.map(y=>({...y,read:!0})))}catch(x){console.error("Error marking all notifications as read:",x)}},clearNotification:async x=>{try{const{error:g}=await Ye.from("notifications").delete().eq("id",x);if(g)throw g;r(y=>y.filter(b=>b.id!==x))}catch(g){console.error("Error clearing notification:",g)}},clearAllNotifications:async()=>{if(n!=null&&n.id)try{const{error:x}=await Ye.from("notifications").delete().eq("user_id",n.id);if(x)throw x;r([])}catch(x){console.error("Error clearing all notifications:",x)}}};return u.jsx(u4.Provider,{value:d,children:e})};class M1{static async sendNotificationToAccountOwners(t,r){var n;try{const{data:a,error:i}=await Ye.from("profiles").select("id").neq("id",t);if(i)throw i;if(!a||a.length===0)return;const s=a.map(f=>({user_id:f.id,type:r.type,title:r.title,message:r.message,data:r.data,read:!1,created_at:new Date().toISOString(),updated_at:new Date().toISOString()})),{data:o,error:l}=await Ye.from("notifications").insert(s).select("id");if(l)throw l;console.log(`Notifications sent to ${a.length} users`);const c=a.map(f=>f.id);try{await this.sendPushNotification({title:r.title,body:r.message,userIds:c,url:this.getNotificationUrl(r.type,r.data),tag:r.type,notificationId:(n=o==null?void 0:o[0])==null?void 0:n.id})}catch(f){console.warn("Push notification failed:",f)}}catch(a){console.error("Error sending notifications:",a)}}static async notifyTransactionCreated(t,r,n,a,i,s){await this.sendNotificationToAccountOwners(t,{type:"transaction_created",title:"New Transaction Added",message:`${r} purchased ‚Çπ${n.toLocaleString()} supplies from ${a}`,data:{transactionId:i,supplierId:s,amount:n,supplierName:a,userAction:"created",userName:r}})}static async notifyTransactionUpdated(t,r,n,a,i,s){await this.sendNotificationToAccountOwners(t,{type:"transaction_updated",title:"Transaction Updated",message:`${r} updated transaction with ${a} (‚Çπ${n.toLocaleString()})`,data:{transactionId:i,supplierId:s,amount:n,supplierName:a,userAction:"updated",userName:r}})}static async notifyTransactionDeleted(t,r,n,a,i){await this.sendNotificationToAccountOwners(t,{type:"transaction_deleted",title:"Transaction Deleted",message:`${r} deleted transaction with ${a} (‚Çπ${n.toLocaleString()})`,data:{supplierId:i,amount:n,supplierName:a,userAction:"deleted",userName:r}})}static async notifyPaymentMade(t,r,n,a,i){await this.sendNotificationToAccountOwners(t,{type:"payment_made",title:"Payment Made",message:`${r} made payment of ‚Çπ${n.toLocaleString()} to ${a}`,data:{supplierId:i,amount:n,supplierName:a,userAction:"payment",userName:r}})}static async notifySupplierAdded(t,r,n,a){await this.sendNotificationToAccountOwners(t,{type:"supplier_added",title:"New Supplier Added",message:`${r} added new supplier: ${n}`,data:{supplierId:a,supplierName:n,userAction:"added",userName:r}})}static async requestNotificationPermission(){return"Notification"in window&&window.Notification.permission==="default"?await window.Notification.requestPermission()==="granted":window.Notification.permission==="granted"}static async sendPushNotification(t){try{const{data:r,error:n}=await Ye.functions.invoke("send-push-notification",{body:t});if(n)throw console.error("Push notification error:",n),n;return console.log("Push notification result:",r),r}catch(r){throw console.error("Failed to send push notification:",r),r}}static getNotificationUrl(t,r){switch(t){case"transaction_created":case"transaction_updated":return r!=null&&r.supplierId?`/suppliers/${r.supplierId}`:"/transactions";case"payment_made":return r!=null&&r.supplierId?`/suppliers/${r.supplierId}`:"/suppliers";case"supplier_added":return r!=null&&r.supplierId?`/suppliers/${r.supplierId}`:"/suppliers";default:return"/dashboard"}}}const D8=({children:e})=>{const{user:t,loading:r}=ha();return r?u.jsx("div",{className:"min-h-screen flex items-center justify-center",children:u.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):t?u.jsx(u.Fragment,{children:e}):u.jsx(X_,{to:"/login",replace:!0})},I8="1.3.2",f4="Mobile Logout Enhancement",Bc=()=>`v${I8}`,M8=()=>{const[e,t]=U.useState(null),[r,n]=U.useState(!1),[a,i]=U.useState(!1),[s,o]=U.useState(!1);U.useEffect(()=>{const f=/iPad|iPhone|iPod/.test(navigator.userAgent);i(f);const h=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://");o(h);const p=d=>{d.preventDefault(),t(d),n(!0)};return window.addEventListener("beforeinstallprompt",p),()=>{window.removeEventListener("beforeinstallprompt",p)}},[]);const l=async()=>{if(!e)return;e.prompt();const{outcome:f}=await e.userChoice;console.log(f==="accepted"?"User accepted the install prompt":"User dismissed the install prompt"),t(null),n(!1)},c=()=>{n(!1),sessionStorage.setItem("installPromptDismissed","true")};return s||sessionStorage.getItem("installPromptDismissed")==="true"?null:a&&!s?u.jsx("div",{className:"fixed bottom-4 left-4 right-4 z-50 bg-blue-600 text-white p-4 rounded-lg shadow-lg border border-blue-500",children:u.jsxs("div",{className:"flex items-start justify-between",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("h3",{className:"font-semibold text-sm",children:"Install Shopsynk"}),u.jsxs("p",{className:"text-xs mt-1 opacity-90",children:["Install this app on your iPhone: tap ",u.jsx("span",{className:"font-bold",children:"Share"})," and then ",u.jsx("span",{className:"font-bold",children:"Add to Home Screen"})]})]}),u.jsx("button",{onClick:c,className:"ml-2 p-1 hover:bg-blue-700 rounded",children:u.jsx(jo,{className:"h-4 w-4"})})]})}):r&&e?u.jsx("div",{className:"fixed bottom-4 left-4 right-4 z-50 bg-gradient-to-r from-blue-600 to-purple-600 text-white p-4 rounded-lg shadow-lg border border-blue-500",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center flex-1",children:[u.jsx(Mc,{className:"h-5 w-5 mr-3 flex-shrink-0"}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold text-sm",children:"Install Shopsynk App"}),u.jsx("p",{className:"text-xs mt-1 opacity-90",children:"Get the full app experience with offline access and notifications"})]})]}),u.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[u.jsx("button",{onClick:l,className:"bg-white text-blue-600 px-3 py-1 rounded text-xs font-medium hover:bg-gray-100 transition-colors",children:"Install"}),u.jsx("button",{onClick:c,className:"p-1 hover:bg-blue-700 rounded",children:u.jsx(jo,{className:"h-4 w-4"})})]})]})}):null},R8=()=>{const[e,t]=U.useState(!1),[r,n]=U.useState(null);U.useEffect(()=>{"serviceWorker"in navigator&&(navigator.serviceWorker.ready.then(s=>{s.waiting&&(n(s.waiting),t(!0)),s.addEventListener("updatefound",()=>{const o=s.installing;o&&o.addEventListener("statechange",()=>{o.state==="installed"&&navigator.serviceWorker.controller&&(n(o),t(!0))})})}),navigator.serviceWorker.addEventListener("controllerchange",()=>{window.location.reload()}))},[]);const a=()=>{r&&(r.postMessage({type:"SKIP_WAITING"}),t(!1))},i=()=>{t(!1)};return e?u.jsx("div",{className:"fixed top-4 left-4 right-4 z-50 bg-green-600 text-white p-4 rounded-lg shadow-lg border border-green-500",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center flex-1",children:[u.jsx(Ss,{className:"h-5 w-5 mr-3 flex-shrink-0"}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold text-sm",children:"App Update Available"}),u.jsx("p",{className:"text-xs mt-1 opacity-90",children:"A new version of Shopsynk is ready to install"})]})]}),u.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[u.jsx("button",{onClick:a,className:"bg-white text-green-600 px-3 py-1 rounded text-xs font-medium hover:bg-gray-100 transition-colors",children:"Update"}),u.jsx("button",{onClick:i,className:"p-1 hover:bg-green-700 rounded",children:u.jsx(jo,{className:"h-4 w-4"})})]})]})}):null},H0=43200,dy=1440,py=Symbol.for("constructDateFrom");function Vg(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&py in e?e[py](t):e instanceof Date?new e.constructor(t):new Date(t)}function Po(e,t){return Vg(e,e)}let B8={};function U8(){return B8}function my(e){const t=Po(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function Kg(e,...t){const r=Vg.bind(null,e||t.find(n=>typeof n=="object"));return t.map(r)}function Nh(e,t){const r=+Po(e)-+Po(t);return r<0?-1:r>0?1:r}function $8(e){return Vg(e,Date.now())}function z8(e,t,r){const[n,a]=Kg(r==null?void 0:r.in,e,t),i=n.getFullYear()-a.getFullYear(),s=n.getMonth()-a.getMonth();return i*12+s}function q8(e){return t=>{const n=(e?Math[e]:Math.trunc)(t);return n===0?0:n}}function W8(e,t){return+Po(e)-+Po(t)}function H8(e,t){const r=Po(e);return r.setHours(23,59,59,999),r}function G8(e,t){const r=Po(e),n=r.getMonth();return r.setFullYear(r.getFullYear(),n+1,0),r.setHours(23,59,59,999),r}function V8(e,t){const r=Po(e);return+H8(r)==+G8(r)}function K8(e,t,r){const[n,a,i]=Kg(r==null?void 0:r.in,e,e,t),s=Nh(a,i),o=Math.abs(z8(a,i));if(o<1)return 0;a.getMonth()===1&&a.getDate()>27&&a.setDate(30),a.setMonth(a.getMonth()-s*o);let l=Nh(a,i)===-s;V8(n)&&o===1&&Nh(n,i)===1&&(l=!1);const c=s*(o-+l);return c===0?0:c}function Y8(e,t,r){const n=W8(e,t)/1e3;return q8(r==null?void 0:r.roundingMethod)(n)}const X8={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Z8=(e,t,r)=>{let n;const a=X8[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function _m(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const J8={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Q8={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},ej={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},tj={date:_m({formats:J8,defaultWidth:"full"}),time:_m({formats:Q8,defaultWidth:"full"}),dateTime:_m({formats:ej,defaultWidth:"full"})},rj={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},nj=(e,t,r,n)=>rj[e];function qu(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const s=e.defaultFormattingWidth||e.defaultWidth,o=r!=null&&r.width?String(r.width):s;a=e.formattingValues[o]||e.formattingValues[s]}else{const s=e.defaultWidth,o=r!=null&&r.width?String(r.width):e.defaultWidth;a=e.values[o]||e.values[s]}const i=e.argumentCallback?e.argumentCallback(t):t;return a[i]}}const aj={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},ij={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},sj={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},oj={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},lj={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},cj={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},uj=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},fj={ordinalNumber:uj,era:qu({values:aj,defaultWidth:"wide"}),quarter:qu({values:ij,defaultWidth:"wide",argumentCallback:e=>e-1}),month:qu({values:sj,defaultWidth:"wide"}),day:qu({values:oj,defaultWidth:"wide"}),dayPeriod:qu({values:lj,defaultWidth:"wide",formattingValues:cj,defaultFormattingWidth:"wide"})};function Wu(e){return(t,r={})=>{const n=r.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],i=t.match(a);if(!i)return null;const s=i[0],o=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?dj(o,h=>h.test(s)):hj(o,h=>h.test(s));let c;c=e.valueCallback?e.valueCallback(l):l,c=r.valueCallback?r.valueCallback(c):c;const f=t.slice(s.length);return{value:c,rest:f}}}function hj(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function dj(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function pj(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const a=n[0],i=t.match(e.parsePattern);if(!i)return null;let s=e.valueCallback?e.valueCallback(i[0]):i[0];s=r.valueCallback?r.valueCallback(s):s;const o=t.slice(a.length);return{value:s,rest:o}}}const mj=/^(\d+)(th|st|nd|rd)?/i,gj=/\d+/i,xj={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},vj={any:[/^b/i,/^(a|c)/i]},yj={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},bj={any:[/1/i,/2/i,/3/i,/4/i]},wj={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},_j={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Nj={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Sj={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Aj={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Ej={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Tj={ordinalNumber:pj({matchPattern:mj,parsePattern:gj,valueCallback:e=>parseInt(e,10)}),era:Wu({matchPatterns:xj,defaultMatchWidth:"wide",parsePatterns:vj,defaultParseWidth:"any"}),quarter:Wu({matchPatterns:yj,defaultMatchWidth:"wide",parsePatterns:bj,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Wu({matchPatterns:wj,defaultMatchWidth:"wide",parsePatterns:_j,defaultParseWidth:"any"}),day:Wu({matchPatterns:Nj,defaultMatchWidth:"wide",parsePatterns:Sj,defaultParseWidth:"any"}),dayPeriod:Wu({matchPatterns:Aj,defaultMatchWidth:"any",parsePatterns:Ej,defaultParseWidth:"any"})},jj={code:"en-US",formatDistance:Z8,formatLong:tj,formatRelative:nj,localize:fj,match:Tj,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Pj(e,t,r){const n=U8(),a=(r==null?void 0:r.locale)??n.locale??jj,i=2520,s=Nh(e,t);if(isNaN(s))throw new RangeError("Invalid time value");const o=Object.assign({},r,{addSuffix:r==null?void 0:r.addSuffix,comparison:s}),[l,c]=Kg(r==null?void 0:r.in,...s>0?[t,e]:[e,t]),f=Y8(c,l),h=(my(c)-my(l))/1e3,p=Math.round((f-h)/60);let d;if(p<2)return r!=null&&r.includeSeconds?f<5?a.formatDistance("lessThanXSeconds",5,o):f<10?a.formatDistance("lessThanXSeconds",10,o):f<20?a.formatDistance("lessThanXSeconds",20,o):f<40?a.formatDistance("halfAMinute",0,o):f<60?a.formatDistance("lessThanXMinutes",1,o):a.formatDistance("xMinutes",1,o):p===0?a.formatDistance("lessThanXMinutes",1,o):a.formatDistance("xMinutes",p,o);if(p<45)return a.formatDistance("xMinutes",p,o);if(p<90)return a.formatDistance("aboutXHours",1,o);if(p<dy){const x=Math.round(p/60);return a.formatDistance("aboutXHours",x,o)}else{if(p<i)return a.formatDistance("xDays",1,o);if(p<H0){const x=Math.round(p/dy);return a.formatDistance("xDays",x,o)}else if(p<H0*2)return d=Math.round(p/H0),a.formatDistance("aboutXMonths",d,o)}if(d=K8(c,l),d<12){const x=Math.round(p/H0);return a.formatDistance("xMonths",x,o)}else{const x=d%12,g=Math.trunc(d/12);return x<3?a.formatDistance("aboutXYears",g,o):x<9?a.formatDistance("overXYears",g,o):a.formatDistance("almostXYears",g+1,o)}}function kj(e,t){return Pj(e,$8(e),t)}const gy=()=>{const[e,t]=U.useState(!1),{notifications:r,unreadCount:n,markAsRead:a,markAllAsRead:i,clearNotification:s,clearAllNotifications:o}=L8(),l=h=>{var p,d;h.read||a(h.id),(p=h.data)!=null&&p.transactionId||(d=h.data)!=null&&d.supplierId},c=h=>{switch(h){case"transaction_created":return"üí∞";case"transaction_updated":return"‚úèÔ∏è";case"transaction_deleted":return"üóëÔ∏è";case"supplier_added":return"üè™";case"payment_made":return"üí≥";default:return"üì¢"}},f=h=>{try{return kj(new Date(h),{addSuffix:!0})}catch{return"Recently"}};return u.jsxs("div",{className:"relative",children:[u.jsxs("button",{onClick:()=>t(!e),className:"relative p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-full transition-colors",children:[u.jsx(k1,{className:"w-6 h-6"}),n>0&&u.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center font-bold",children:n>99?"99+":n})]}),e&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>t(!1)}),u.jsxs("div",{className:"absolute right-0 top-full mt-2 w-80 bg-white rounded-lg shadow-xl border border-gray-200 z-20 max-h-96 overflow-hidden",children:[u.jsx("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Notifications",n>0&&u.jsxs("span",{className:"ml-2 text-sm bg-red-100 text-red-600 px-2 py-1 rounded-full",children:[n," new"]})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[n>0&&u.jsx("button",{onClick:i,className:"text-sm text-blue-600 hover:text-blue-800 flex items-center",title:"Mark all as read",children:u.jsx(d8,{className:"w-4 h-4"})}),u.jsx("button",{onClick:()=>t(!1),className:"text-gray-400 hover:text-gray-600",children:u.jsx(jo,{className:"w-4 h-4"})})]})]})}),u.jsx("div",{className:"max-h-64 overflow-y-auto",children:r.length===0?u.jsxs("div",{className:"p-8 text-center text-gray-500",children:[u.jsx(k1,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),u.jsx("p",{className:"text-sm",children:"No notifications yet"})]}):r.map(h=>u.jsx("div",{className:`p-4 border-b border-gray-100 cursor-pointer hover:bg-gray-50 transition-colors ${h.read?"":"bg-blue-50 border-l-4 border-l-blue-500"}`,onClick:()=>l(h),children:u.jsxs("div",{className:"flex items-start space-x-3",children:[u.jsx("div",{className:"text-2xl flex-shrink-0",children:c(h.type)}),u.jsx("div",{className:"flex-1 min-w-0",children:u.jsxs("div",{className:"flex items-start justify-between",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("p",{className:`text-sm font-medium ${h.read?"text-gray-700":"text-gray-900"}`,children:h.title}),u.jsx("p",{className:`text-sm mt-1 ${h.read?"text-gray-500":"text-gray-700"}`,children:h.message}),u.jsx("p",{className:"text-xs text-gray-400 mt-2",children:f(h.createdAt)})]}),u.jsx("button",{onClick:p=>{p.stopPropagation(),s(h.id)},className:"text-gray-400 hover:text-gray-600 ml-2 flex-shrink-0",title:"Remove notification",children:u.jsx(jo,{className:"w-4 h-4"})})]})})]})},h.id))}),r.length>0&&u.jsx("div",{className:"p-3 border-t border-gray-200 bg-gray-50",children:u.jsxs("button",{onClick:o,className:"w-full text-center text-sm text-red-600 hover:text-red-800 flex items-center justify-center space-x-1",children:[u.jsx(Sl,{className:"w-4 h-4"}),u.jsx("span",{children:"Clear all notifications"})]})})]})]})]})},Cj=({children:e})=>{const{user:t,signOut:r}=ha(),n=Fo(),a=Wg(),[i,s]=U.useState(!1),[o,l]=U.useState(!1),[c,f]=U.useState(!1),h=async()=>{try{await r(),n("/login")}catch(j){console.error("Error signing out:",j)}},p=a.pathname==="/suppliers",d=a.pathname.startsWith("/suppliers/")&&a.pathname!=="/suppliers",x=a.pathname==="/persons",g=a.pathname.startsWith("/persons/")&&a.pathname!=="/persons",y=()=>{p?n("/suppliers?add=true"):d&&s(!0)},b=()=>{s(!1);const j=new CustomEvent("openPurchaseModal");window.dispatchEvent(j)},T=()=>{s(!1);const j=new CustomEvent("openPaymentModal");window.dispatchEvent(j)},S=()=>{f(!1);const j=new CustomEvent("openPurchaseModal");window.dispatchEvent(j)},k=()=>{f(!1);const j=new CustomEvent("openPaymentModal");window.dispatchEvent(j)},A=[{name:"Dashboard",path:"/",icon:zu},{name:"Suppliers",path:"/suppliers",icon:wa},{name:"Persons",path:"/persons",icon:Sn},{name:"Transactions",path:"/transactions",icon:Un},{name:"Reports",path:"/reports",icon:Nf},{name:"Data Storage",path:"/data-storage",icon:O1},{name:"Documentation",path:"/documentation",icon:ff}],M=[{name:"Dashboard",path:"/",icon:zu},{name:"Transactions",path:"/transactions",icon:Un},{name:"Suppliers",path:"/suppliers",icon:wa},{name:"Persons",path:"/persons",icon:Sn},{name:"More",path:"#",icon:nf}],O=j=>j==="/"?a.pathname==="/":a.pathname.startsWith(j);let I=[...M];return p||d?I=[{name:"Dashboard",path:"/",icon:zu},{name:"Transactions",path:"/transactions",icon:Un},{name:"Add Supplier",path:"#",icon:li},{name:"Persons",path:"/persons",icon:Sn},{name:"More",path:"#",icon:nf}]:x?I=[{name:"Dashboard",path:"/",icon:zu},{name:"Transactions",path:"/transactions",icon:Un},{name:"Add Person",path:"#",icon:li},{name:"Suppliers",path:"/suppliers",icon:wa},{name:"More",path:"#",icon:nf}]:g&&(I=[{name:"Dashboard",path:"/",icon:zu},{name:"Transactions",path:"/transactions",icon:Un},{name:"Add Transaction",path:"#",icon:li},{name:"Suppliers",path:"/suppliers",icon:wa},{name:"More",path:"#",icon:nf}]),c8.useEffect(()=>{const j=W=>{o&&(W.target.closest("[data-more-menu]")||l(!1))};if(o)return document.addEventListener("mousedown",j),()=>document.removeEventListener("mousedown",j)},[o]),u.jsxs("div",{className:"min-h-screen bg-gray-50",children:[u.jsx("div",{className:"hidden lg:block fixed inset-y-0 left-0 z-40 w-64 bg-white shadow-lg border-r border-gray-200",children:u.jsxs("div",{className:"flex flex-col h-full",children:[u.jsxs("div",{className:"flex flex-col items-center justify-center h-16 bg-blue-600 text-white",children:[u.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[u.jsx(iy,{className:"h-8 w-8 text-white"}),u.jsx("h1",{className:"text-xl font-bold",children:"Shopsynk"})]}),u.jsx("p",{className:"text-xs text-blue-200",children:Bc()})]}),u.jsx("nav",{className:"flex-1 px-4 py-6 space-y-2",children:A.map(j=>{const W=j.icon;return u.jsxs("button",{onClick:()=>n(j.path),className:`w-full flex items-center px-4 py-3 text-left rounded-lg transition-colors ${O(j.path)?"bg-blue-50 text-blue-700 border border-blue-200":"text-gray-700 hover:bg-gray-50 hover:text-gray-900"}`,children:[u.jsx(W,{className:"h-5 w-5 mr-3"}),j.name]},j.name)})}),u.jsxs("div",{className:"p-4 border-t border-gray-200",children:[u.jsx("button",{onClick:()=>n("/profile"),className:"w-full flex items-center justify-between p-3 rounded-lg hover:bg-gray-50 transition-colors mb-3",children:u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:u.jsx(Sn,{className:"h-4 w-4 text-blue-600"})}),u.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[u.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:"Profile Settings"}),u.jsx("p",{className:"text-xs text-gray-500 truncate",children:t==null?void 0:t.email})]})]})}),u.jsxs("button",{onClick:h,className:"w-full flex items-center justify-center p-3 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[u.jsx(sy,{className:"h-4 w-4 mr-2"}),"Sign Out"]})]})]})}),u.jsx("div",{className:"lg:hidden fixed bottom-0 left-0 right-0 z-50 bg-white border-t border-gray-200 shadow-lg safe-area-pb",children:u.jsx("div",{className:"flex items-center justify-around px-1 py-3",children:I.map(j=>{const W=O(j.path);if(j.name==="More")return u.jsx("button",{onClick:()=>l(!o),className:`flex items-center justify-center p-3 rounded-xl transition-all duration-200 min-w-0 flex-1 mx-1 ${o?"text-blue-600 bg-blue-50 transform scale-110":"text-gray-500 hover:text-gray-700 hover:bg-gray-50 active:scale-95"}`,title:j.name,children:u.jsx("i",{className:`bi bi-grid-1x2 ${o?"text-blue-600":"text-gray-500"}`,style:{fontSize:"1.5rem"}})},j.name);if(j.name==="Add Transaction")return u.jsx("button",{onClick:()=>f(!c),className:"flex items-center justify-center p-3 rounded-xl transition-all duration-200 min-w-0 flex-1 mx-1 bg-blue-600 text-white transform scale-110",title:"Add Transaction",children:u.jsx(li,{className:"h-6 w-6 text-white"})},j.name);if(j.name==="Add Supplier")return u.jsx("button",{onClick:y,className:"flex items-center justify-center p-3 rounded-xl transition-all duration-200 min-w-0 flex-1 mx-1 bg-blue-600 text-white transform scale-110",title:"Add Supplier",children:u.jsx(li,{className:"h-6 w-6 text-white"})},j.name);if(j.name==="Add Person")return u.jsx("button",{onClick:()=>n("/persons?add=true"),className:"flex items-center justify-center p-3 rounded-xl transition-all duration-200 min-w-0 flex-1 mx-1 bg-blue-600 text-white transform scale-110",title:"Add Person",children:u.jsx(li,{className:"h-6 w-6 text-white"})},j.name);if(j.path==="/suppliers"&&(p||d))return u.jsx("button",{onClick:y,className:"flex items-center justify-center p-3 rounded-xl transition-all duration-200 min-w-0 flex-1 mx-1 bg-blue-600 text-white transform scale-110",title:p?"Add Supplier":"Quick Actions",children:u.jsx(li,{className:"h-6 w-6 text-white"})},j.name);const E=j.icon;return u.jsx("button",{onClick:()=>n(j.path),className:`flex items-center justify-center p-3 rounded-xl transition-all duration-200 min-w-0 flex-1 mx-1 ${W?"text-blue-600 bg-blue-50 transform scale-110":"text-gray-500 hover:text-gray-700 hover:bg-gray-50 active:scale-95"}`,title:j.name,children:u.jsx(E,{className:`h-6 w-6 ${W?"text-blue-600":"text-gray-500"}`})},j.name)})})}),i&&d&&u.jsx("div",{className:"lg:hidden fixed inset-0 bg-black bg-opacity-50 z-[60] flex items-end justify-center",children:u.jsxs("div",{className:"bg-white rounded-t-2xl w-full p-6 animate-slide-up",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Quick Actions"}),u.jsx("button",{onClick:()=>s(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:u.jsx(jo,{className:"h-5 w-5 text-gray-500"})})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("button",{onClick:b,className:"flex flex-col items-center p-6 bg-red-50 border border-red-200 rounded-xl hover:bg-red-100 transition-colors",children:[u.jsx("div",{className:"w-12 h-12 bg-red-500 rounded-full flex items-center justify-center mb-3",children:u.jsx(p8,{className:"h-6 w-6 text-white"})}),u.jsx("span",{className:"text-red-700 font-medium",children:"Add Purchase"}),u.jsx("span",{className:"text-red-600 text-sm mt-1",children:"Record new purchase"})]}),u.jsxs("button",{onClick:T,className:"flex flex-col items-center p-6 bg-green-50 border border-green-200 rounded-xl hover:bg-green-100 transition-colors",children:[u.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-full flex items-center justify-center mb-3",children:u.jsx(C1,{className:"h-6 w-6 text-white"})}),u.jsx("span",{className:"text-green-700 font-medium",children:"Pay Due"}),u.jsx("span",{className:"text-green-600 text-sm mt-1",children:"Make payment"})]})]})]})}),c&&u.jsx("div",{className:"lg:hidden fixed inset-0 bg-black bg-opacity-50 z-[60] flex items-end justify-center",children:u.jsxs("div",{className:"bg-white rounded-t-2xl w-full p-6 animate-slide-up",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Add Transaction"}),u.jsx("button",{onClick:()=>f(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:u.jsx(jo,{className:"h-5 w-5 text-gray-500"})})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[u.jsxs("button",{onClick:S,className:"flex flex-col items-center p-6 bg-red-50 border border-red-200 rounded-xl hover:bg-red-100 transition-colors",children:[u.jsx("div",{className:"w-12 h-12 bg-red-500 rounded-full flex items-center justify-center mb-3",children:u.jsx(Q_,{className:"h-6 w-6 text-white"})}),u.jsx("span",{className:"text-red-700 font-medium",children:"Gives"}),u.jsx("span",{className:"text-red-600 text-sm mt-1",children:"Record loan given"})]}),u.jsxs("button",{onClick:k,className:"flex flex-col items-center p-6 bg-green-50 border border-green-200 rounded-xl hover:bg-green-100 transition-colors",children:[u.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-full flex items-center justify-center mb-3",children:u.jsx(Es,{className:"h-6 w-6 text-white"})}),u.jsx("span",{className:"text-green-700 font-medium",children:"Takes"}),u.jsx("span",{className:"text-green-600 text-sm mt-1",children:"Record payment received"})]})]})]})}),o&&u.jsx("div",{"data-more-menu":!0,className:"lg:hidden fixed bottom-16 right-4 bg-white border border-gray-200 rounded-xl shadow-lg z-[60] min-w-48 animate-fade-in",children:u.jsxs("div",{className:"py-2",children:[u.jsxs("button",{onClick:()=>{n("/profile"),l(!1)},className:"w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-gray-50 flex items-center transition-colors",children:[u.jsx(Sn,{className:"h-4 w-4 mr-3 text-gray-500"}),"Profile"]}),u.jsxs("button",{onClick:()=>{n("/data-storage"),l(!1)},className:"w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-gray-50 flex items-center transition-colors",children:[u.jsx(O1,{className:"h-4 w-4 mr-3 text-gray-500"}),"Data Storage"]}),u.jsxs("button",{onClick:()=>{n("/reports"),l(!1)},className:"w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-gray-50 flex items-center transition-colors",children:[u.jsx(Nf,{className:"h-4 w-4 mr-3 text-gray-500"}),"Reports"]}),u.jsxs("button",{onClick:()=>{n("/documentation"),l(!1)},className:"w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-gray-50 flex items-center transition-colors",children:[u.jsx(ff,{className:"h-4 w-4 mr-3 text-gray-500"}),"Documentation"]}),u.jsx("div",{className:"border-t border-gray-200 my-1"}),u.jsxs("button",{onClick:()=>{h(),l(!1)},className:"w-full text-left px-4 py-3 text-sm text-red-600 hover:bg-red-50 flex items-center transition-colors",children:[u.jsx(sy,{className:"h-4 w-4 mr-3 text-red-500"}),"Sign Out"]})]})}),u.jsx("div",{className:"lg:hidden bg-white border-b border-gray-200 px-4 py-3 sticky top-0 z-40",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(iy,{className:"h-6 w-6 text-blue-600"}),u.jsx("h1",{className:"text-lg font-bold text-blue-600",children:"Shopsynk"}),u.jsx("span",{className:"ml-2 text-xs text-gray-500",children:Bc()})]}),u.jsxs("div",{className:"flex items-center space-x-1",children:[u.jsx(gy,{}),u.jsx("button",{onClick:()=>n("/profile"),className:`p-2 rounded-lg transition-colors ${O("/profile")?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-100"}`,title:"Profile",children:u.jsx(Sn,{className:"h-5 w-5"})})]})]})}),u.jsxs("div",{className:"lg:pl-64",children:[u.jsx("div",{className:"hidden lg:block bg-white border-b border-gray-200 px-6 py-4 lg:px-8",children:u.jsx("div",{className:"flex items-center justify-end",children:u.jsx(gy,{})})}),u.jsx("main",{className:"p-4 lg:p-8 pb-20 lg:pb-8 pt-4 lg:pt-0",children:e})]}),u.jsx(M8,{}),u.jsx(R8,{})]})},Oj=({onComplete:e})=>{const[t,r]=U.useState(!0);return U.useEffect(()=>{const n=setTimeout(()=>{r(!1),setTimeout(e,300)},2500);return()=>clearTimeout(n)},[e]),t?u.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-yellow-100 to-orange-200 flex items-center justify-center z-50 transition-opacity duration-300",children:u.jsxs("div",{className:"text-center animate-bounce-slow",children:[u.jsx("img",{src:"/pwa opning/SHOP.png",alt:"Shopsynk",className:"w-48 h-48 mx-auto mb-6 drop-shadow-lg object-contain",onError:n=>{var i;n.currentTarget.style.display="none";const a=document.createElement("div");a.className="w-48 h-48 mx-auto mb-6 bg-orange-400 rounded-3xl flex items-center justify-center text-white text-6xl font-bold shadow-lg",a.textContent="S",(i=n.currentTarget.parentNode)==null||i.insertBefore(a,n.currentTarget)}}),u.jsx("div",{className:"text-2xl font-bold text-orange-600 mb-2 animate-pulse",children:"Shopsynk"}),u.jsx("div",{className:"text-orange-500 animate-fade-in-delayed",children:"Supplier Management"}),u.jsxs("div",{className:"mt-8 flex justify-center space-x-1",children:[u.jsx("div",{className:"w-2 h-2 bg-orange-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),u.jsx("div",{className:"w-2 h-2 bg-orange-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),u.jsx("div",{className:"w-2 h-2 bg-orange-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})]})}):u.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-yellow-100 to-orange-200 flex items-center justify-center z-50 opacity-0 transition-opacity duration-300 pointer-events-none",children:u.jsxs("div",{className:"text-center animate-fade-out",children:[u.jsx("img",{src:"/pwa opning/SHOP.png",alt:"Shopsynk",className:"w-48 h-48 mx-auto mb-6 animate-pulse object-contain",onError:n=>{n.currentTarget.style.display="none"}}),u.jsx("div",{className:"text-2xl font-bold text-orange-600 mb-2",children:"Shopsynk"}),u.jsx("div",{className:"text-orange-500",children:"Supplier Management"})]})})},Lj=()=>{const[e,t]=U.useState(!1),[r,n]=U.useState(!1);U.useEffect(()=>{const s=localStorage.getItem("icon-update-v1-seen"),o=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0;if(!s&&o){const l=setTimeout(()=>{t(!0)},3e3);return()=>clearTimeout(l)}},[]);const a=()=>{n(!0),t(!1),localStorage.setItem("icon-update-v1-seen","true")},i=()=>{a(),alert(`To see our new logo:
1. Remove Shopsynk from your home screen
2. Visit shopsynk.netlify.app in your browser
3. Add to Home Screen again
4. Enjoy the updated branding!`)};return!e||r?null:u.jsx("div",{className:"fixed top-4 right-4 bg-gradient-to-r from-blue-500 to-purple-600 text-white p-4 rounded-lg shadow-xl z-50 max-w-sm",children:u.jsxs("div",{className:"flex items-start space-x-3",children:[u.jsx("div",{className:"bg-white/20 rounded-full p-2",children:u.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),u.jsxs("div",{className:"flex-1",children:[u.jsx("h4",{className:"font-semibold text-sm",children:"üéâ New Logo Available!"}),u.jsx("p",{className:"text-xs mt-1 opacity-90",children:"We've updated our branding! Reinstall the app to see our new logo on your home screen."}),u.jsxs("div",{className:"flex space-x-2 mt-3",children:[u.jsx("button",{onClick:i,className:"bg-white/20 text-xs px-3 py-1 rounded-full hover:bg-white/30 transition-colors",children:"How to Update"}),u.jsx("button",{onClick:a,className:"text-xs px-3 py-1 rounded-full hover:bg-white/10 transition-colors",children:"Later"})]})]}),u.jsx("button",{onClick:a,className:"text-white/70 hover:text-white transition-colors",children:u.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:u.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})},Fj=()=>{const[e,t]=U.useState(""),[r,n]=U.useState(""),[a,i]=U.useState(!1),[s,o]=U.useState(!1),[l,c]=U.useState(""),{signIn:f}=ha(),h=Fo(),p=async d=>{d.preventDefault(),o(!0),c("");try{const{error:x}=await f(e,r);if(x)throw x;h("/")}catch(x){c(x.message)}finally{o(!1)}};return u.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:u.jsx("div",{className:"max-w-md w-full",children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[u.jsxs("div",{className:"text-center mb-8",children:[u.jsx("div",{className:"w-16 h-16 rounded-2xl flex items-center justify-center mx-auto mb-4",children:u.jsx("img",{src:"/pwa opning/shopsynk.png",alt:"Shopsynk Logo",className:"w-16 h-16 object-contain"})}),u.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Welcome Back"}),u.jsx("p",{className:"text-gray-600 mt-2",children:"Sign in to manage your supplier dues"})]}),l&&u.jsx("div",{className:"mb-4 p-3 rounded-lg bg-red-50 border border-red-200 text-red-600 text-sm",children:l}),u.jsxs("form",{onSubmit:p,className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),u.jsxs("div",{className:"relative",children:[u.jsx(Al,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"email",value:e,onChange:d=>t(d.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Enter your email",required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),u.jsxs("div",{className:"relative",children:[u.jsx(L1,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:a?"text":"password",value:r,onChange:d=>n(d.target.value),className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Enter your password",required:!0}),u.jsx("button",{type:"button",onClick:()=>i(!a),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:a?u.jsx(F1,{className:"h-5 w-5"}):u.jsx(D1,{className:"h-5 w-5"})})]})]}),u.jsx("button",{type:"submit",disabled:s,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:s?u.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):u.jsxs(u.Fragment,{children:["Sign In",u.jsx(Zf,{className:"ml-2 h-4 w-4"})]})})]}),u.jsx("div",{className:"mt-6 text-center",children:u.jsxs("p",{className:"text-gray-600",children:["Don't have an account?"," ",u.jsx(Z_,{to:"/register",className:"text-blue-600 hover:text-blue-700 font-medium",children:"Create one"})]})})]})})})},Dj=()=>{const[e,t]=U.useState(""),[r,n]=U.useState(""),[a,i]=U.useState(""),[s,o]=U.useState(!1),[l,c]=U.useState(!1),[f,h]=U.useState(!1),[p,d]=U.useState(""),[x,g]=U.useState(""),{signUp:y}=ha(),b=Fo(),T=async S=>{if(S.preventDefault(),h(!0),d(""),g(""),r!==a){d("Passwords do not match"),h(!1);return}try{const{error:k}=await y(e,r);if(k)throw k;g("Account created successfully! You can now sign in."),setTimeout(()=>b("/login"),2e3)}catch(k){d(k.message)}finally{h(!1)}};return u.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:u.jsx("div",{className:"max-w-md w-full",children:u.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[u.jsxs("div",{className:"text-center mb-8",children:[u.jsx("div",{className:"w-16 h-16 bg-blue-600 rounded-2xl flex items-center justify-center mx-auto mb-4",children:u.jsx("span",{className:"text-2xl font-bold text-white",children:"DT"})}),u.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Create Account"}),u.jsx("p",{className:"text-gray-600 mt-2",children:"Start managing your supplier dues today"})]}),p&&u.jsx("div",{className:"mb-4 p-3 rounded-lg bg-red-50 border border-red-200 text-red-600 text-sm",children:p}),x&&u.jsx("div",{className:"mb-4 p-3 rounded-lg bg-green-50 border border-green-200 text-green-600 text-sm",children:x}),u.jsxs("form",{onSubmit:T,className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),u.jsxs("div",{className:"relative",children:[u.jsx(Al,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"email",value:e,onChange:S=>t(S.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Enter your email",required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),u.jsxs("div",{className:"relative",children:[u.jsx(L1,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:s?"text":"password",value:r,onChange:S=>n(S.target.value),className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Create a password",required:!0,minLength:6}),u.jsx("button",{type:"button",onClick:()=>o(!s),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:s?u.jsx(F1,{className:"h-5 w-5"}):u.jsx(D1,{className:"h-5 w-5"})})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password"}),u.jsxs("div",{className:"relative",children:[u.jsx(L1,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:l?"text":"password",value:a,onChange:S=>i(S.target.value),className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Confirm your password",required:!0,minLength:6}),u.jsx("button",{type:"button",onClick:()=>c(!l),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:l?u.jsx(F1,{className:"h-5 w-5"}):u.jsx(D1,{className:"h-5 w-5"})})]})]}),u.jsx("button",{type:"submit",disabled:f,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:f?u.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):u.jsxs(u.Fragment,{children:["Create Account",u.jsx(Zf,{className:"ml-2 h-4 w-4"})]})})]}),u.jsx("div",{className:"mt-6 text-center",children:u.jsxs("p",{className:"text-gray-600",children:["Already have an account?"," ",u.jsx(Z_,{to:"/login",className:"text-blue-600 hover:text-blue-700 font-medium",children:"Sign in"})]})})]})})})},Ij=()=>{const{user:e}=ha(),t=Fo(),[r,n]=U.useState({totalDues:0,totalSuppliers:0,totalTransactions:0,pendingPayments:0,recentTransactions:[],upcomingDues:[]}),[a,i]=U.useState(!0);U.useEffect(()=>{s()},[e]);const s=async()=>{if(e)try{const{count:c}=await Ye.from("suppliers").select("*",{count:"exact",head:!0}).eq("user_id",e.id),{count:f}=await Ye.from("transactions").select("*",{count:"exact",head:!0}).eq("user_id",e.id),{data:h}=await Ye.from("transactions").select("*").eq("user_id",e.id),p=new Map;h==null||h.forEach(S=>{const k=S.supplier_id;p.has(k)||p.set(k,0),S.type==="new_purchase"?p.set(k,p.get(k)+parseFloat(S.amount)):(S.type==="pay_due"||S.type==="settle_bill")&&p.set(k,p.get(k)-parseFloat(S.amount))});let d=0,x=0;p.forEach(S=>{S>.01&&(d+=S,x++)});const{data:g}=await Ye.from("transactions").select(`
          *,
          supplier:suppliers(name),
          owner:business_owners(owner_name)
        `).eq("user_id",e.id).order("created_at",{ascending:!1}).limit(5),{data:y}=await Ye.from("transactions").select(`
          *,
          supplier:suppliers(name),
          owner:business_owners(owner_name)
        `).eq("user_id",e.id).order("created_at",{ascending:!1}),b=new Map;y==null||y.forEach(S=>{var O;const k=S.supplier_id,A=(O=S.supplier)==null?void 0:O.name;b.has(k)||b.set(k,{supplier_id:k,supplier_name:A,balance:0,lastTransaction:S,dueDate:null});const M=b.get(k);S.type==="new_purchase"?(M.balance+=parseFloat(S.amount),S.due_date&&(!M.dueDate||S.due_date<M.dueDate)&&(M.dueDate=S.due_date)):(S.type==="pay_due"||S.type==="settle_bill")&&(M.balance-=parseFloat(S.amount))});const T=Array.from(b.values()).filter(S=>S.balance>.01).map(S=>({id:`outstanding-${S.supplier_id}`,supplier_id:S.supplier_id,supplier:{name:S.supplier_name},amount:S.balance.toFixed(2),description:"Outstanding balance",due_date:S.dueDate,type:"outstanding"})).sort((S,k)=>S.due_date&&!k.due_date?-1:!S.due_date&&k.due_date?1:S.due_date&&k.due_date&&S.due_date!==k.due_date?S.due_date.localeCompare(k.due_date):parseFloat(k.amount)-parseFloat(S.amount)).slice(0,10);n({totalDues:Math.max(0,d),totalSuppliers:c||0,totalTransactions:f||0,pendingPayments:x,recentTransactions:g||[],upcomingDues:T||[]})}catch(c){console.error("Error fetching dashboard data:",c)}finally{i(!1)}},o=c=>{switch(c){case"new_purchase":return u.jsx(Af,{className:"h-4 w-4 text-red-500"});case"pay_due":case"settle_bill":return u.jsx(Sf,{className:"h-4 w-4 text-green-500"});default:return u.jsx(Un,{className:"h-4 w-4 text-gray-500"})}},l=c=>{switch(c){case"new_purchase":return"Purchase";case"pay_due":return"Payment";case"settle_bill":return"Settlement";default:return c}};return a?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):u.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[u.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Dashboard"}),u.jsx("p",{className:"text-gray-600 text-sm",children:"Your business overview"})]})}),u.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[u.jsx("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:u.jsxs("div",{className:"text-center",children:[u.jsx(Es,{className:"h-6 w-6 text-red-500 mx-auto mb-2"}),u.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Outstanding"}),u.jsxs("p",{className:"text-lg font-bold text-red-600",children:["‚Çπ",Math.round(r.totalDues).toLocaleString()]})]})}),u.jsx("button",{onClick:()=>t("/suppliers"),className:"bg-white rounded-lg p-4 border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-colors w-full",children:u.jsxs("div",{className:"text-center",children:[u.jsx(wa,{className:"h-6 w-6 text-blue-500 mx-auto mb-2"}),u.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Suppliers"}),u.jsx("p",{className:"text-lg font-bold text-blue-600",children:r.totalSuppliers})]})}),u.jsx("button",{onClick:()=>t("/transactions"),className:"bg-white rounded-lg p-4 border border-gray-200 hover:border-green-300 hover:bg-green-50 transition-colors w-full",children:u.jsxs("div",{className:"text-center",children:[u.jsx(Un,{className:"h-6 w-6 text-green-500 mx-auto mb-2"}),u.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Transactions"}),u.jsx("p",{className:"text-lg font-bold text-green-600",children:r.totalTransactions})]})}),u.jsx("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:u.jsxs("div",{className:"text-center",children:[u.jsx(bm,{className:"h-6 w-6 text-orange-500 mx-auto mb-2"}),u.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Pending"}),u.jsx("p",{className:"text-lg font-bold text-orange-600",children:r.pendingPayments})]})})]}),u.jsxs("div",{className:"space-y-4 lg:grid lg:grid-cols-2 lg:gap-6 lg:space-y-0",children:[u.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[u.jsxs("div",{className:"flex items-center justify-between mb-3",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Recent Activity"}),u.jsx("button",{onClick:()=>t("/transactions"),className:"text-blue-600 text-sm font-medium",children:"View All"})]}),u.jsx("div",{className:"space-y-3",children:r.recentTransactions.length>0?r.recentTransactions.slice(0,4).map(c=>{var f;return u.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[u.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[o(c.type),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"font-medium text-gray-900 truncate",children:(f=c.supplier)==null?void 0:f.name}),u.jsx("p",{className:"text-sm text-gray-500",children:l(c.type)})]})]}),u.jsx("div",{className:"text-right",children:u.jsxs("p",{className:`font-medium ${c.type==="new_purchase"?"text-red-600":"text-green-600"}`,children:[c.type==="new_purchase"?"+":"-","‚Çπ",Math.round(parseFloat(c.amount)).toLocaleString()]})})]},c.id)}):u.jsx("p",{className:"text-gray-500 text-center py-6 text-sm",children:"No transactions yet"})})]}),u.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[u.jsxs("div",{className:"flex items-center justify-between mb-3",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Payments Due"}),u.jsx(bm,{className:"h-5 w-5 text-orange-400"})]}),u.jsx("div",{className:"space-y-3",children:r.upcomingDues.length>0?r.upcomingDues.slice(0,4).map(c=>{var f;return u.jsxs("div",{className:"flex items-center justify-between p-3 bg-orange-50 rounded-lg border border-orange-100",onClick:()=>t(`/suppliers/${c.supplier_id}`),children:[u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("p",{className:"font-medium text-gray-900 truncate",children:(f=c.supplier)==null?void 0:f.name}),u.jsx("p",{className:"text-sm text-gray-500",children:"Outstanding balance"})]}),u.jsx("div",{className:"text-right",children:u.jsxs("p",{className:"font-medium text-red-600",children:["‚Çπ",Math.round(parseFloat(c.amount)).toLocaleString()]})})]},c.id)}):u.jsxs("div",{className:"text-center py-6",children:[u.jsx(bm,{className:"h-8 w-8 text-green-500 mx-auto mb-2 opacity-50"}),u.jsx("p",{className:"text-green-600 text-sm font-medium",children:"All payments up to date!"})]})})]})]})]})},Mj=()=>{const{user:e}=ha(),t=Fo(),r=Wg(),[n,a]=U.useState([]),[i,s]=U.useState(!0),[o,l]=U.useState(""),[c,f]=U.useState("dues_desc"),[h,p]=U.useState("all"),[d,x]=U.useState(!1),[g,y]=U.useState({name:"",contact_person:"",phone:"",email:"",address:""});U.useEffect(()=>{b()},[e]),U.useEffect(()=>{new URLSearchParams(r.search).get("add")==="true"&&(x(!0),t("/suppliers",{replace:!0}))},[r.search,t]);const b=async()=>{if(e)try{const{data:A,error:M}=await Ye.from("suppliers").select("*").eq("user_id",e.id);if(M)throw M;const{data:O,error:I}=await Ye.from("transactions").select("*").eq("user_id",e.id);if(I)throw I;const j=new Map;O==null||O.forEach(E=>{const C=E.supplier_id;j.has(C)||j.set(C,0),E.type==="new_purchase"?j.set(C,j.get(C)+parseFloat(E.amount)):(E.type==="pay_due"||E.type==="settle_bill")&&j.set(C,j.get(C)-parseFloat(E.amount))});const W=(A||[]).map(E=>({...E,dueAmount:Math.max(0,j.get(E.id)||0)}));a(W)}catch(A){console.error("Error fetching suppliers:",A)}finally{s(!1)}},T=async A=>{if(A.preventDefault(),!!e)try{const{error:M}=await Ye.from("suppliers").insert([{...g,user_id:e.id}]);if(M)throw M;await b(),S()}catch(M){console.error("Error adding supplier:",M)}},S=()=>{y({name:"",contact_person:"",phone:"",email:"",address:""}),x(!1)},k=n.filter(A=>{var I,j,W;const M=A.name.toLowerCase().includes(o.toLowerCase())||((I=A.contact_person)==null?void 0:I.toLowerCase().includes(o.toLowerCase()))||((j=A.phone)==null?void 0:j.includes(o))||((W=A.email)==null?void 0:W.toLowerCase().includes(o.toLowerCase())),O=h==="all"||h==="with_dues"&&A.dueAmount>0||h==="no_dues"&&A.dueAmount===0||h==="high_dues"&&A.dueAmount>1e4||h==="medium_dues"&&A.dueAmount>1e3&&A.dueAmount<=1e4||h==="low_dues"&&A.dueAmount>0&&A.dueAmount<=1e3;return M&&O}).sort((A,M)=>{switch(c){case"dues_desc":return M.dueAmount-A.dueAmount;case"dues_asc":return A.dueAmount-M.dueAmount;case"name_asc":return A.name.localeCompare(M.name);case"name_desc":return M.name.localeCompare(A.name);default:return M.dueAmount-A.dueAmount}});return i?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):u.jsxs("div",{className:"min-h-screen bg-gray-50 p-4 sm:p-6 max-w-7xl mx-auto",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 mb-4 sm:mb-6",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[u.jsxs("div",{className:"text-center sm:text-left",children:[u.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-1",children:"Suppliers"}),u.jsx("p",{className:"text-gray-600 text-sm sm:text-base",children:"Manage your business relationships"})]}),u.jsx("div",{className:"hidden sm:flex items-center",children:u.jsxs("button",{onClick:()=>x(!0),className:"flex items-center justify-center bg-gradient-to-r from-blue-500 to-blue-600 text-white px-5 py-3 rounded-xl hover:from-blue-600 hover:to-blue-700 font-semibold shadow-md transition-all duration-200",children:[u.jsx(li,{className:"h-5 w-5 mr-2"}),"Add New Supplier"]})})]}),u.jsx("div",{className:"mt-6",children:u.jsxs("div",{className:"relative",children:[u.jsx(Hg,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"text",placeholder:"Search by name, contact, phone, or email...",value:o,onChange:A=>l(A.target.value),className:"w-full pl-12 pr-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-base"})]})}),u.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row gap-3",children:[u.jsx("div",{className:"flex-1",children:u.jsxs("select",{value:h,onChange:A=>p(A.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white text-base",children:[u.jsx("option",{value:"all",children:"üè¢ All Suppliers"}),u.jsx("option",{value:"with_dues",children:"üí∞ With Dues"}),u.jsx("option",{value:"no_dues",children:"‚úÖ No Dues"}),u.jsxs("option",{value:"high_dues",children:["üî• High Dues (",">","‚Çπ10K)"]}),u.jsx("option",{value:"medium_dues",children:"‚ö†Ô∏è Medium Dues (‚Çπ1K-‚Çπ10K)"}),u.jsxs("option",{value:"low_dues",children:["üìä Low Dues (","<","‚Çπ1K)"]})]})}),u.jsx("div",{className:"flex-1",children:u.jsxs("select",{value:c,onChange:A=>f(A.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white text-base",children:[u.jsx("option",{value:"dues_desc",children:"üìà Highest Dues First"}),u.jsx("option",{value:"dues_asc",children:"üìâ Lowest Dues First"}),u.jsx("option",{value:"name_asc",children:"üî§ Name A to Z"}),u.jsx("option",{value:"name_desc",children:"üî§ Name Z to A"})]})})]}),u.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 mt-6",children:[u.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 p-4 rounded-xl text-center",children:[u.jsx("p",{className:"text-2xl font-bold text-blue-600",children:n.length}),u.jsx("p",{className:"text-xs font-medium text-blue-700",children:"Total Suppliers"})]}),u.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-red-100 p-4 rounded-xl text-center",children:[u.jsx("p",{className:"text-2xl font-bold text-red-600",children:n.filter(A=>A.dueAmount>0).length}),u.jsx("p",{className:"text-xs font-medium text-red-700",children:"With Dues"})]}),u.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 p-4 rounded-xl text-center",children:[u.jsx("p",{className:"text-2xl font-bold text-green-600",children:n.filter(A=>A.dueAmount===0).length}),u.jsx("p",{className:"text-xs font-medium text-green-700",children:"All Clear"})]}),u.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 p-4 rounded-xl text-center",children:[u.jsxs("p",{className:"text-lg font-bold text-purple-600",children:["‚Çπ",Math.round(n.reduce((A,M)=>A+M.dueAmount,0)).toLocaleString()]}),u.jsx("p",{className:"text-xs font-medium text-purple-700",children:"Total Dues"})]})]})]}),u.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:k.length===0?u.jsxs("div",{className:"col-span-full text-center py-16 bg-white rounded-xl shadow-sm",children:[u.jsx("div",{className:"w-20 h-20 mx-auto mb-6 bg-gray-100 rounded-full flex items-center justify-center",children:u.jsx(wa,{className:"h-10 w-10 text-gray-400"})}),u.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No suppliers found"}),u.jsx("p",{className:"text-gray-500 mb-6",children:o?"Try adjusting your search or filters":"Use the + button below to add your first supplier"})]}):k.map(A=>u.jsxs("div",{onClick:()=>t(`/suppliers/${A.id}`),className:"bg-white rounded-xl border border-gray-200 p-5 hover:border-blue-300 hover:shadow-lg transition-all duration-200 cursor-pointer group transform hover:scale-105",children:[u.jsxs("div",{className:"flex items-start justify-between mb-4",children:[u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("h3",{className:"font-semibold text-gray-900 text-lg truncate group-hover:text-blue-600 transition-colors",children:A.name}),A.contact_person&&u.jsx("p",{className:"text-sm text-gray-600 truncate mt-1",children:A.contact_person})]}),u.jsxs("div",{className:"ml-4 text-right",children:[u.jsxs("div",{className:`px-3 py-1 rounded-full text-sm font-bold ${A.dueAmount>0?A.dueAmount>1e4?"bg-red-100 text-red-700":A.dueAmount>1e3?"bg-yellow-100 text-yellow-700":"bg-orange-100 text-orange-700":"bg-green-100 text-green-700"}`,children:["‚Çπ",Math.round(A.dueAmount).toLocaleString()]}),u.jsx("p",{className:"text-xs text-gray-500 mt-1",children:A.dueAmount>0?"Due Amount":"All Clear"})]})]}),u.jsxs("div",{className:"flex space-x-2",children:[A.phone&&u.jsx("div",{className:"flex items-center text-sm text-gray-600",children:u.jsx("div",{className:"w-8 h-8 bg-blue-50 rounded-lg flex items-center justify-center",children:u.jsx(gl,{className:"h-4 w-4 text-blue-500"})})}),A.email&&u.jsx("div",{className:"flex items-center text-sm text-gray-600",children:u.jsx("div",{className:"w-8 h-8 bg-green-50 rounded-lg flex items-center justify-center",children:u.jsx(Al,{className:"h-4 w-4 text-green-500"})})}),A.address&&u.jsx("div",{className:"flex items-center text-sm text-gray-600",children:u.jsx("div",{className:"w-8 h-8 bg-purple-50 rounded-lg flex items-center justify-center",children:u.jsx(Rc,{className:"h-4 w-4 text-purple-500"})})})]}),u.jsx("div",{className:"mt-4 pt-3 border-t border-gray-100",children:u.jsx("p",{className:"text-xs text-gray-400 text-center group-hover:text-blue-400 transition-colors",children:"Tap to view details & manage"})})]},A.id))}),u.jsx("button",{onClick:()=>x(!0),className:"fixed bottom-6 right-6 sm:hidden w-14 h-14 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-full shadow-2xl hover:from-blue-600 hover:to-blue-700 flex items-center justify-center z-40 transform hover:scale-110 transition-all duration-200",style:{boxShadow:"0 10px 25px rgba(59, 130, 246, 0.5)"},children:u.jsx(li,{className:"h-6 w-6"})}),d&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-50 flex items-end sm:items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-lg max-h-[95vh] sm:max-h-[90vh] overflow-y-auto shadow-2xl",children:[u.jsx("div",{className:"sticky top-0 bg-white rounded-t-2xl sm:rounded-t-2xl z-10",children:u.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Add New Supplier"}),u.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Fill in the supplier details"})]}),u.jsx("button",{onClick:S,className:"w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center transition-colors",children:u.jsx("span",{className:"text-xl text-gray-500",children:"√ó"})})]})}),u.jsxs("form",{onSubmit:T,className:"p-6 space-y-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Supplier Name *"}),u.jsx("input",{type:"text",value:g.name,onChange:A=>y({...g,name:A.target.value}),required:!0,className:"w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-base transition-colors",placeholder:"Enter supplier or company name"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Contact Person"}),u.jsxs("div",{className:"relative",children:[u.jsx(wa,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"text",value:g.contact_person,onChange:A=>y({...g,contact_person:A.target.value}),className:"w-full pl-12 pr-4 py-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-base",placeholder:"Primary contact person"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Phone Number"}),u.jsxs("div",{className:"relative",children:[u.jsx(gl,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"tel",value:g.phone,onChange:A=>y({...g,phone:A.target.value}),className:"w-full pl-12 pr-4 py-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-base",placeholder:"Mobile or landline number"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Email Address"}),u.jsxs("div",{className:"relative",children:[u.jsx(Al,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"email",value:g.email,onChange:A=>y({...g,email:A.target.value}),className:"w-full pl-12 pr-4 py-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-base",placeholder:"contact@supplier.com"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Business Address"}),u.jsxs("div",{className:"relative",children:[u.jsx(Rc,{className:"absolute left-4 top-4 h-5 w-5 text-gray-400"}),u.jsx("textarea",{value:g.address,onChange:A=>y({...g,address:A.target.value}),rows:4,className:"w-full pl-12 pr-4 py-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-base resize-none",placeholder:"Complete business address including city and state"})]})]}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-4",children:[u.jsx("button",{type:"button",onClick:S,className:"order-2 sm:order-1 flex-1 px-6 py-4 text-gray-700 bg-gray-100 rounded-xl hover:bg-gray-200 font-medium transition-colors",children:"Cancel"}),u.jsx("button",{type:"submit",className:"order-1 sm:order-2 flex-1 px-6 py-4 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl hover:from-blue-600 hover:to-blue-700 font-medium shadow-lg transition-all duration-200",children:"Add Supplier"})]})]})]})})]})};class Ts{static getInstance(){return Ts.instance||(Ts.instance=new Ts),Ts.instance}async getBusinessOwners(t){try{const{data:r,error:n}=await Ye.from("business_owners").select("*").eq("user_id",t).eq("is_active",!0).order("is_primary",{ascending:!1}).order("created_at",{ascending:!0});if(n)throw n;return r||[]}catch(r){return console.error("Error fetching business owners:",r),[]}}async getPrimaryOwner(t){try{const{data:r,error:n}=await Ye.from("business_owners").select("*").eq("user_id",t).eq("is_primary",!0).eq("is_active",!0).single();if(n&&n.code!=="PGRST116")throw n;return r||null}catch(r){return console.error("Error fetching primary owner:",r),null}}async createBusinessOwner(t,r){try{const{data:n,error:a}=await Ye.from("business_owners").insert([{user_id:t,owner_name:r.owner_name,role:r.role||"Owner",is_primary:!1,is_active:!0}]).select().single();if(a)throw a;return{success:!0,data:n}}catch(n){return console.error("Error creating business owner:",n),{success:!1,error:n.message||"Failed to create business owner"}}}async updateBusinessOwner(t,r){try{const{data:n,error:a}=await Ye.from("business_owners").update({owner_name:r.owner_name,role:r.role,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(a)throw a;return{success:!0,data:n}}catch(n){return console.error("Error updating business owner:",n),{success:!1,error:n.message||"Failed to update business owner"}}}async deactivateBusinessOwner(t){try{const{data:r,error:n}=await Ye.from("business_owners").select("is_primary").eq("id",t).single();if(n)throw n;if(r.is_primary)return{success:!1,error:"Cannot deactivate the primary owner"};const{error:a}=await Ye.from("business_owners").update({is_active:!1,updated_at:new Date().toISOString()}).eq("id",t);if(a)throw a;return{success:!0}}catch(r){return console.error("Error deactivating business owner:",r),{success:!1,error:r.message||"Failed to deactivate business owner"}}}async getOwnerStats(t){try{const{data:r,error:n}=await Ye.from("owner_transaction_stats").select("*").eq("user_id",t);if(n)throw n;return r||[]}catch(r){return console.error("Error fetching owner stats:",r),[]}}async ensurePrimaryOwner(t,r,n){try{const a=await this.getPrimaryOwner(t);if(a)return a;const i=await this.createBusinessOwner(t,{owner_name:n||r.split("@")[0],role:"Primary Owner",is_primary:!0});return i.success?i.data:null}catch(a){return console.error("Error ensuring primary owner:",a),null}}async updateTransactionOwner(t,r){try{const{error:n}=await Ye.from("transactions").update({owner_id:r}).eq("id",t);if(n)throw n;return{success:!0}}catch(n){return console.error("Error updating transaction owner:",n),{success:!1,error:n.message||"Failed to update transaction owner"}}}async updateSupplierOwner(t,r){try{const{error:n}=await Ye.from("suppliers").update({added_by_owner_id:r}).eq("id",t);if(n)throw n;return{success:!0}}catch(n){return console.error("Error updating supplier owner:",n),{success:!1,error:n.message||"Failed to update supplier owner"}}}}const Rj=()=>{const{id:e}=J_(),{user:t}=ha(),r=Fo(),[n,a]=U.useState(null),[i,s]=U.useState([]),[o,l]=U.useState([]),[c,f]=U.useState(!0),[h,p]=U.useState(!1),[d,x]=U.useState(!1),[g,y]=U.useState(!1),[b,T]=U.useState(""),[S,k]=U.useState(""),[A,M]=U.useState(""),[O,I]=U.useState(""),[j,W]=U.useState(""),[E,C]=U.useState(""),[G,Z]=U.useState(""),[he,oe]=U.useState(0),[me,pe]=U.useState(!1),[ge,Le]=U.useState({name:"",contact_person:"",phone:"",email:"",address:""}),[Se,N]=U.useState({totalPurchases:0,totalPaid:0,totalDue:0,transactionCount:0}),[D,L]=U.useState(!1),[F,K]=U.useState({show:!1,x:0,y:0,transaction:null}),[ce,xe]=U.useState(!1),[ee,fe]=U.useState(null),[le,ue]=U.useState(""),[$e,ye]=U.useState(""),Q=Pe=>{localStorage.setItem("shopsynk_last_selected_owner",Pe)},nt=()=>localStorage.getItem("shopsynk_last_selected_owner")||"";U.useEffect(()=>{e&&Re()},[e,t]),U.useEffect(()=>{const Pe=()=>{F.show&&Fe()};if(F.show)return document.addEventListener("mousedown",Pe),()=>{document.removeEventListener("mousedown",Pe)}},[F.show]),U.useEffect(()=>{const Pe=()=>{y(!0)},tt=()=>{x(!0)};return window.addEventListener("openPurchaseModal",Pe),window.addEventListener("openPaymentModal",tt),()=>{window.removeEventListener("openPurchaseModal",Pe),window.removeEventListener("openPaymentModal",tt)}},[]);const Re=async()=>{if(!(!t||!e))try{const{data:Pe,error:tt}=await Ye.from("suppliers").select("*").eq("id",e).eq("user_id",t.id).single();if(tt)throw tt;const{data:bt,error:Xt}=await Ye.from("transactions").select(`
          *,
          owner:business_owners(owner_name)
        `).eq("supplier_id",e).eq("user_id",t.id).order("created_at",{ascending:!1});if(Xt)throw Xt;const Wt=await Ts.getInstance().getBusinessOwners(t.id);a(Pe),s(bt||[]),l(Wt||[]);const _t=nt();_t&&Wt&&Wt.some(un=>un.id===_t)&&(k(_t),I(_t));let Ut=0,ir=0,Dr=0;bt==null||bt.forEach(un=>{const kn=parseFloat(un.amount.toString());un.type==="new_purchase"?(Ut+=kn,un.is_paid||(Dr+=kn)):(un.type==="pay_due"||un.type==="settle_bill")&&(ir+=kn,Dr-=kn)}),oe(Math.max(0,Dr)),N({totalPurchases:Ut,totalPaid:ir,totalDue:Math.max(0,Dr),transactionCount:(bt==null?void 0:bt.length)||0})}catch(Pe){console.error("Error fetching supplier data:",Pe)}finally{f(!1)}},ot=async Pe=>{if(Pe.preventDefault(),!(!t||!e||!b||!S||h)){p(!0);try{Q(S);const{error:tt}=await Ye.from("transactions").insert([{user_id:t.id,supplier_id:e,type:"pay_due",amount:parseFloat(b),description:G||"Payment made",is_paid:!0,owner_id:S}]);if(tt)throw tt;await Re(),x(!1),T(""),Z("")}catch(tt){console.error("Error processing payment:",tt)}finally{p(!1)}}},ze=async Pe=>{if(Pe.preventDefault(),!(!t||!e||!A||!O||h)){p(!0);try{Q(O);const{error:tt}=await Ye.from("transactions").insert([{user_id:t.id,supplier_id:e,type:"new_purchase",amount:parseFloat(A),description:j||"New purchase",due_date:E||null,is_paid:!1,owner_id:O}]);if(tt)throw tt;await Re(),y(!1),M(""),W(""),C("")}catch(tt){console.error("Error adding purchase:",tt)}finally{p(!1)}}},lt=async Pe=>{if(Pe.preventDefault(),!(!t||!e))try{const{error:tt}=await Ye.from("suppliers").update(ge).eq("id",e).eq("user_id",t.id);if(tt)throw tt;await Re(),pe(!1)}catch(tt){console.error("Error updating supplier:",tt)}},Qe=async()=>{if(!(!t||!e||!window.confirm(`Are you sure you want to delete ${n==null?void 0:n.name}? This will also delete all associated transactions. This action cannot be undone.`)))try{await Ye.from("transactions").delete().eq("supplier_id",e).eq("user_id",t.id);const{error:tt}=await Ye.from("suppliers").delete().eq("id",e).eq("user_id",t.id);if(tt)throw tt;r("/suppliers")}catch(tt){console.error("Error deleting supplier:",tt)}},Tt=()=>{n&&(Le({name:n.name,contact_person:n.contact_person||"",phone:n.phone||"",email:n.email||"",address:n.address||""}),pe(!0))},ft=(Pe,tt)=>{Pe.preventDefault(),K({show:!0,x:Pe.clientX,y:Pe.clientY,transaction:tt})},Ot=Pe=>{K({show:!0,x:window.innerWidth/2,y:window.innerHeight/2,transaction:Pe})},Fe=()=>{K({show:!1,x:0,y:0,transaction:null})},Xe=()=>{F.transaction&&(fe(F.transaction),ue(F.transaction.amount.toString()),ye(F.transaction.description||""),xe(!0),Fe())},At=async()=>{if(!F.transaction||!t)return;if(!window.confirm("Are you sure you want to delete this transaction? This action cannot be undone.")){Fe();return}try{const{error:tt}=await Ye.from("transactions").delete().eq("id",F.transaction.id).eq("user_id",t.id);if(tt)throw tt;await Re(),Fe()}catch(tt){console.error("Error deleting transaction:",tt)}},xt=(Pe,tt=500)=>{const[bt,Xt]=U.useState(!1),wr=U.useRef(),Wt=U.useRef(),_t=U.useCallback(ir=>{ir.type==="mousedown"&&ir.button!==0||(wr.current=setTimeout(()=>{Pe(),Xt(!0)},tt),Wt.current=ir.target)},[Pe,tt]),Ut=U.useCallback(ir=>{wr.current&&clearTimeout(wr.current),bt&&(ir.preventDefault(),ir.stopPropagation()),Xt(!1)},[bt]);return{onMouseDown:ir=>_t(ir),onTouchStart:ir=>_t(ir),onMouseUp:ir=>Ut(ir),onTouchEnd:ir=>Ut(ir),onMouseLeave:ir=>Ut(ir)}},st=async Pe=>{if(Pe.preventDefault(),!(!ee||!t||!le))try{const{error:tt}=await Ye.from("transactions").update({amount:parseFloat(le),description:$e||null}).eq("id",ee.id).eq("user_id",t.id);if(tt)throw tt;await Re(),xe(!1),fe(null),ue(""),ye("")}catch(tt){console.error("Error updating transaction:",tt)}},pt=Pe=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(Pe),ht=Pe=>new Date(Pe).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"}),Qt=Pe=>{switch(Pe){case"new_purchase":return u.jsx(Af,{className:"h-5 w-5 text-red-500"});case"pay_due":case"settle_bill":return u.jsx(Sf,{className:"h-5 w-5 text-green-500"});default:return u.jsx(Un,{className:"h-5 w-5 text-gray-500"})}},$t=Pe=>{switch(Pe){case"new_purchase":return"Purchase";case"pay_due":return"Payment";case"settle_bill":return"Settlement";default:return Pe}},mt=Pe=>{switch(Pe){case"new_purchase":return"text-red-600";case"pay_due":case"settle_bill":return"text-green-600";default:return"text-gray-600"}},jt=()=>{n!=null&&n.phone&&(window.location.href=`tel:${n.phone}`)};if(c)return u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});if(!n)return u.jsxs("div",{className:"text-center py-12",children:[u.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Supplier not found"}),u.jsx("button",{onClick:()=>r("/suppliers"),className:"text-blue-600 hover:text-blue-700",children:"Back to Suppliers"})]});const er=({transaction:Pe})=>{var bt;const tt=xt(()=>Ot(Pe));return u.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors cursor-pointer select-none",onContextMenu:Xt=>ft(Xt,Pe),...tt,children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[Qt(Pe.type),u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("span",{className:"font-medium text-gray-900",children:$t(Pe.type)}),!Pe.is_paid&&Pe.type==="new_purchase"&&u.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-red-100 text-red-700 rounded-full",children:"Unpaid"})]}),u.jsx("p",{className:"text-gray-600 text-sm",children:Pe.description}),((bt=Pe.owner)==null?void 0:bt.owner_name)&&u.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:[Pe.type==="new_purchase"?"Purchased by: ":"Paid by: ",Pe.owner.owner_name]}),u.jsxs("div",{className:"flex items-center space-x-4 mt-1 text-xs text-gray-500",children:[u.jsxs("span",{className:"flex items-center",children:[u.jsx(xl,{className:"h-3 w-3 mr-1"}),ht(Pe.created_at)]}),Pe.due_date&&u.jsxs("span",{children:["Due: ",ht(Pe.due_date)]})]})]})]}),u.jsx("div",{className:"text-right",children:u.jsxs("p",{className:`text-lg font-semibold ${mt(Pe.type)}`,children:[Pe.type==="new_purchase"?"+":"-",pt(parseFloat(Pe.amount.toString()))]})})]})},Pe.id)};return u.jsxs("div",{className:"min-h-screen bg-gray-50",children:[u.jsx("div",{className:"bg-white shadow-sm sticky top-0 z-30",children:u.jsxs("div",{className:"flex items-center px-4 py-3",children:[u.jsx("button",{onClick:()=>r("/suppliers"),className:"p-2 hover:bg-gray-100 rounded-full transition-colors mr-2",children:u.jsx(_o,{className:"h-5 w-5 text-gray-600"})}),u.jsxs("button",{onClick:()=>L(!0),className:"flex items-center space-x-3 flex-1 text-left hover:bg-gray-50 p-2 rounded-lg transition-colors",children:[u.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white font-semibold",children:n.name.charAt(0).toUpperCase()}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("h1",{className:"text-lg font-semibold text-gray-900 truncate",children:n.name}),u.jsx("p",{className:"text-sm text-gray-500 truncate",children:n.contact_person?`Contact: ${n.contact_person}`:"Business Supplier"})]})]}),u.jsx("button",{onClick:n.phone?jt:void 0,className:`p-3 rounded-full transition-colors ${n.phone?"hover:bg-green-100 text-green-600 cursor-pointer":"text-gray-300 cursor-not-allowed"}`,disabled:!n.phone,title:n.phone?`Call ${n.phone}`:"No phone number available",children:u.jsx(gl,{className:"h-5 w-5"})})]})}),D&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[60] flex items-center justify-center p-4",children:u.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md max-h-[90vh] overflow-hidden",children:[u.jsxs("div",{className:"bg-blue-500 text-white p-6 text-center",children:[u.jsx("div",{className:"w-24 h-24 bg-white bg-opacity-20 rounded-full flex items-center justify-center text-3xl font-bold mx-auto mb-3",children:n.name.charAt(0).toUpperCase()}),u.jsx("h2",{className:"text-xl font-semibold",children:n.name}),n.contact_person&&u.jsx("p",{className:"text-blue-100 text-sm mt-1",children:n.contact_person})]}),u.jsxs("div",{className:"p-4 space-y-4",children:[n.phone&&u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:u.jsx(gl,{className:"h-5 w-5 text-green-600"})}),u.jsxs("div",{className:"flex-1",children:[u.jsx("p",{className:"font-medium text-gray-900",children:n.phone}),u.jsx("p",{className:"text-sm text-gray-500",children:"Mobile"})]}),u.jsx("button",{onClick:jt,className:"bg-green-500 text-white px-4 py-2 rounded-full hover:bg-green-600 transition-colors",children:"Call"})]}),n.email&&u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:u.jsx(Al,{className:"h-5 w-5 text-blue-600"})}),u.jsxs("div",{className:"flex-1",children:[u.jsx("p",{className:"font-medium text-gray-900",children:n.email}),u.jsx("p",{className:"text-sm text-gray-500",children:"Email"})]})]}),n.address&&u.jsxs("div",{className:"flex items-start space-x-4",children:[u.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:u.jsx(Rc,{className:"h-5 w-5 text-purple-600"})}),u.jsxs("div",{className:"flex-1",children:[u.jsx("p",{className:"font-medium text-gray-900",children:n.address}),u.jsx("p",{className:"text-sm text-gray-500",children:"Address"})]})]}),u.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[u.jsx("p",{className:"text-sm text-gray-600",children:"Outstanding Amount"}),u.jsx("p",{className:`text-2xl font-bold ${Se.totalDue>0?"text-red-600":"text-green-600"}`,children:pt(Se.totalDue)})]})]}),u.jsxs("div",{className:"p-4 border-t border-gray-200 space-y-3",children:[u.jsxs("div",{className:"flex space-x-3",children:[u.jsxs("button",{onClick:()=>{L(!1),Tt()},className:"flex-1 bg-blue-500 text-white py-3 rounded-lg hover:bg-blue-600 transition-colors flex items-center justify-center",children:[u.jsx(Sn,{className:"h-4 w-4 mr-2"}),"Edit Profile"]}),u.jsxs("button",{onClick:()=>{L(!1),Qe()},className:"flex-1 bg-red-500 text-white py-3 rounded-lg hover:bg-red-600 transition-colors flex items-center justify-center",children:[u.jsx(Sl,{className:"h-4 w-4 mr-2"}),"Delete Profile"]})]}),u.jsx("button",{onClick:()=>L(!1),className:"w-full bg-gray-100 text-gray-700 py-3 rounded-lg hover:bg-gray-200 transition-colors",children:"Close"})]})]})}),u.jsxs("div",{className:"max-w-4xl mx-auto p-4 space-y-6",children:[u.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6",children:u.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center sm:justify-between gap-4 w-full",children:[u.jsxs("div",{className:"text-center sm:text-left",children:[u.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Outstanding Amount"}),u.jsx("p",{className:`text-4xl font-bold ${Se.totalDue>0?"text-red-600":"text-green-600"}`,children:pt(Se.totalDue)})]}),u.jsxs("div",{className:"hidden sm:flex items-center space-x-3",children:[u.jsxs("button",{onClick:()=>y(!0),className:"flex items-center justify-center bg-red-500 text-white px-5 py-3 rounded-xl hover:bg-red-600 font-semibold shadow-md transition-all",children:[u.jsx(oy,{className:"h-5 w-5 mr-2"}),"Add Purchase"]}),u.jsxs("button",{onClick:()=>x(!0),className:"flex items-center justify-center bg-green-500 text-white px-5 py-3 rounded-xl hover:bg-green-600 font-semibold shadow-md transition-all",children:[u.jsx(C1,{className:"h-5 w-5 mr-2"}),"Pay Due"]})]})]})}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[u.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:u.jsx(C1,{className:"h-6 w-6 text-green-600"})}),u.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Total Paid"}),u.jsx("p",{className:"text-2xl font-bold text-green-600",children:pt(Se.totalPaid)})]})}),u.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:u.jsx(oy,{className:"h-6 w-6 text-blue-600"})}),u.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Total Purchases"}),u.jsx("p",{className:"text-2xl font-bold text-blue-600",children:pt(Se.totalPurchases)})]})}),u.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:u.jsxs("div",{className:"text-center",children:[u.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:u.jsx(Un,{className:"h-6 w-6 text-gray-600"})}),u.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Total Transactions"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Se.transactionCount})]})})]}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[u.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[u.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[u.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:u.jsx(Sn,{className:"h-6 w-6 text-blue-600"})}),u.jsxs("div",{children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:n.name}),n.contact_person&&u.jsx("p",{className:"text-gray-600",children:n.contact_person})]})]}),u.jsxs("div",{className:"space-y-4",children:[n.phone&&u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx(gl,{className:"h-5 w-5 text-gray-400"}),u.jsx("span",{className:"text-gray-700",children:n.phone})]}),n.email&&u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx(Al,{className:"h-5 w-5 text-gray-400"}),u.jsx("span",{className:"text-gray-700",children:n.email})]}),n.address&&u.jsxs("div",{className:"flex items-start space-x-3",children:[u.jsx(Rc,{className:"h-5 w-5 text-gray-400 mt-0.5"}),u.jsx("span",{className:"text-gray-700",children:n.address})]})]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Payment Status"}),u.jsx(Es,{className:"h-5 w-5 text-gray-400"})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("span",{className:"text-sm text-gray-600",children:"Payment Rate"}),u.jsx("span",{className:"text-sm font-medium",children:Se.totalPurchases>0?`${Math.round(Se.totalPaid/Se.totalPurchases*100)}%`:"0%"})]}),u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:u.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:Se.totalPurchases>0?`${Math.min(Se.totalPaid/Se.totalPurchases*100,100)}%`:"0%"}})}),u.jsxs("div",{className:"text-center pt-2",children:[u.jsx("p",{className:`text-2xl font-bold ${Se.totalDue>0?"text-red-600":"text-green-600"}`,children:Se.totalDue>0?pt(Se.totalDue):"All Clear!"}),u.jsx("p",{className:"text-sm text-gray-600 mt-1",children:Se.totalDue>0?"Outstanding Balance":"No pending dues"})]})]})]})]}),u.jsx("div",{className:"lg:col-span-2",children:u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[u.jsx("div",{className:"p-6 border-b border-gray-200",children:u.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Transaction History"})}),u.jsx("div",{className:"p-6",children:i.length>0?u.jsx("div",{className:"space-y-4",children:i.map(Pe=>u.jsx(er,{transaction:Pe},Pe.id))}):u.jsxs("div",{className:"text-center py-8",children:[u.jsx(Un,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),u.jsx("p",{className:"text-gray-500",children:"No transactions yet with this supplier"})]})})]})})]}),d&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[60]",children:u.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[u.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:["Pay Due to ",n.name]}),u.jsxs("form",{onSubmit:ot,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Amount *"}),u.jsxs("div",{className:"relative",children:[u.jsx(Es,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"number",step:"0.01",required:!0,value:b,onChange:Pe=>T(Pe.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Enter payment amount"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),u.jsx("input",{type:"text",value:G,onChange:Pe=>Z(Pe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Payment description (optional)"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Made By *"}),u.jsxs("select",{value:S,onChange:Pe=>k(Pe.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",children:[u.jsx("option",{value:"",children:"Select who made this payment"}),o.map(Pe=>u.jsxs("option",{value:Pe.id,children:[Pe.owner_name," ",Pe.is_primary&&"(Primary)"," - ",Pe.role]},Pe.id))]})]}),u.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:u.jsxs("p",{className:"text-sm text-green-700",children:["Current outstanding: ",u.jsx("span",{className:"font-medium",children:pt(he)})]})}),u.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[u.jsx("button",{type:"button",onClick:()=>x(!1),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),u.jsx("button",{type:"submit",disabled:h,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:bg-green-400",children:h?"Processing...":"Process Payment"})]})]})]})}),g&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[60]",children:u.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[u.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:["New Purchase from ",n.name]}),u.jsxs("form",{onSubmit:ze,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Purchase Amount *"}),u.jsxs("div",{className:"relative",children:[u.jsx(Es,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"number",step:"0.01",required:!0,value:A,onChange:Pe=>M(Pe.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter purchase amount"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),u.jsx("input",{type:"text",value:j,onChange:Pe=>W(Pe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Purchase description (optional)"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Purchase Made By *"}),u.jsxs("select",{value:O,onChange:Pe=>I(Pe.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[u.jsx("option",{value:"",children:"Select who made this purchase"}),o.map(Pe=>u.jsxs("option",{value:Pe.id,children:[Pe.owner_name," ",Pe.is_primary&&"(Primary)"," - ",Pe.role]},Pe.id))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Due Date"}),u.jsx("input",{type:"date",value:E,onChange:Pe=>C(Pe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[u.jsx("button",{type:"button",onClick:()=>y(!1),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),u.jsx("button",{type:"submit",disabled:h,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-blue-400",children:h?"Adding...":"Add Purchase"})]})]})]})}),me&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[60] flex items-end sm:items-center justify-center p-4",children:u.jsxs("div",{className:"bg-white rounded-t-xl sm:rounded-xl w-full sm:max-w-md max-h-[90vh] overflow-y-auto",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Edit Supplier"}),u.jsx("button",{onClick:()=>pe(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:"√ó"})]}),u.jsxs("form",{onSubmit:lt,className:"p-4 space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supplier Name *"}),u.jsx("input",{type:"text",value:ge.name,onChange:Pe=>Le({...ge,name:Pe.target.value}),required:!0,className:"w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Person"}),u.jsx("input",{type:"text",value:ge.contact_person,onChange:Pe=>Le({...ge,contact_person:Pe.target.value}),className:"w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),u.jsx("input",{type:"tel",value:ge.phone,onChange:Pe=>Le({...ge,phone:Pe.target.value}),className:"w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),u.jsx("input",{type:"email",value:ge.email,onChange:Pe=>Le({...ge,email:Pe.target.value}),className:"w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),u.jsx("textarea",{value:ge.address,onChange:Pe=>Le({...ge,address:Pe.target.value}),rows:3,className:"w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("div",{className:"flex space-x-3 pt-2",children:[u.jsx("button",{type:"button",onClick:()=>pe(!1),className:"flex-1 px-4 py-2.5 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Cancel"}),u.jsx("button",{type:"submit",className:"flex-1 px-4 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Update Supplier"})]})]})]})}),F.show&&u.jsxs("div",{className:"fixed z-[70] bg-white rounded-lg shadow-lg border border-gray-200 py-2 min-w-32",style:{left:Math.min(F.x,window.innerWidth-160),top:Math.min(F.y,window.innerHeight-100)},children:[u.jsxs("button",{onClick:Xe,className:"w-full text-left px-4 py-2 hover:bg-gray-50 flex items-center text-gray-700",children:[u.jsx(vc,{className:"h-4 w-4 mr-3 text-blue-600"}),"Edit Transaction"]}),u.jsxs("button",{onClick:At,className:"w-full text-left px-4 py-2 hover:bg-gray-50 flex items-center text-gray-700",children:[u.jsx(Sl,{className:"h-4 w-4 mr-3 text-red-600"}),"Delete Transaction"]})]}),ce&&ee&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[60]",children:u.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Edit Transaction"}),u.jsxs("form",{onSubmit:st,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount *"}),u.jsxs("div",{className:"relative",children:[u.jsx(Es,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"number",step:"0.01",required:!0,value:le,onChange:Pe=>ue(Pe.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter amount"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),u.jsx("input",{type:"text",value:$e,onChange:Pe=>ye(Pe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Transaction description"})]}),u.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[u.jsxs("p",{className:"text-sm text-blue-700",children:["Type: ",u.jsx("span",{className:"font-medium",children:$t(ee.type)})]}),u.jsxs("p",{className:"text-sm text-blue-700",children:["Date: ",u.jsx("span",{className:"font-medium",children:ht(ee.created_at)})]})]}),u.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[u.jsx("button",{type:"button",onClick:()=>xe(!1),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Update Transaction"})]})]})]})})]})]})},Bj=()=>{const{user:e}=ha(),t=Fo(),r=Wg(),[n,a]=U.useState([]),[i,s]=U.useState(!0),[o,l]=U.useState(""),[c,f]=U.useState("loans_desc"),[h,p]=U.useState("all"),[d,x]=U.useState(!1),[g,y]=U.useState({name:"",company:"",phone:"",address:""});U.useEffect(()=>{b()},[e]),U.useEffect(()=>{new URLSearchParams(r.search).get("add")==="true"&&(x(!0),t("/persons",{replace:!0}))},[r.search,t]);const b=async()=>{if(e)try{const{data:A,error:M}=await Ye.from("persons").select("*").eq("user_id",e.id);if(M)throw M;const{data:O,error:I}=await Ye.from("loan_transactions").select("*").eq("user_id",e.id);if(I)throw I;const j=new Map;O==null||O.forEach(E=>{const C=E.person_id;j.has(C)||j.set(C,0),E.type==="Gives"?j.set(C,j.get(C)+parseFloat(E.amount)):E.type==="Takes"&&j.set(C,j.get(C)-parseFloat(E.amount))});const W=(A||[]).map(E=>({...E,loanAmount:j.get(E.id)||0}));a(W)}catch(A){console.error("Error fetching persons:",A)}finally{s(!1)}},T=async A=>{if(A.preventDefault(),!!e)try{const{error:M}=await Ye.from("persons").insert([{...g,user_id:e.id}]);if(M)throw M;await b(),S()}catch(M){console.error("Error adding person:",M)}},S=()=>{y({name:"",company:"",phone:"",address:""}),x(!1)},k=n.filter(A=>{var I,j,W;const M=A.name.toLowerCase().includes(o.toLowerCase())||((I=A.company)==null?void 0:I.toLowerCase().includes(o.toLowerCase()))||((j=A.phone)==null?void 0:j.includes(o))||((W=A.address)==null?void 0:W.toLowerCase().includes(o.toLowerCase())),O=h==="all"||h==="gives_outstanding"&&A.loanAmount>0||h==="takes_outstanding"&&A.loanAmount<0||h==="settled"&&A.loanAmount===0||h==="high_amount"&&Math.abs(A.loanAmount)>1e4||h==="medium_amount"&&Math.abs(A.loanAmount)>1e3&&Math.abs(A.loanAmount)<=1e4||h==="low_amount"&&Math.abs(A.loanAmount)>0&&Math.abs(A.loanAmount)<=1e3;return M&&O}).sort((A,M)=>{switch(c){case"loans_desc":return M.loanAmount-A.loanAmount;case"loans_asc":return A.loanAmount-M.loanAmount;case"name_asc":return A.name.localeCompare(M.name);case"name_desc":return M.name.localeCompare(A.name);default:return M.loanAmount-A.loanAmount}});return i?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):u.jsxs("div",{className:"min-h-screen bg-gray-50 p-4 sm:p-6 max-w-7xl mx-auto",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 mb-4 sm:mb-6",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[u.jsxs("div",{className:"text-center sm:text-left",children:[u.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-1",children:"Persons"}),u.jsx("p",{className:"text-gray-600 text-sm sm:text-base",children:"Manage your loan relationships"})]}),u.jsx("div",{className:"hidden sm:flex items-center",children:u.jsxs("button",{onClick:()=>x(!0),className:"flex items-center justify-center bg-gradient-to-r from-green-500 to-green-600 text-white px-5 py-3 rounded-xl hover:from-green-600 hover:to-green-700 font-semibold shadow-md transition-all duration-200",children:[u.jsx(li,{className:"h-5 w-5 mr-2"}),"Add New Person"]})})]}),u.jsx("div",{className:"mt-6",children:u.jsxs("div",{className:"relative",children:[u.jsx(Hg,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"text",placeholder:"Search by name, company, phone, or address...",value:o,onChange:A=>l(A.target.value),className:"w-full pl-12 pr-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-gray-50 text-base"})]})}),u.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row gap-3",children:[u.jsx("div",{className:"flex-1",children:u.jsxs("select",{value:h,onChange:A=>p(A.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-white text-base",children:[u.jsx("option",{value:"all",children:"üè¢ All Persons"}),u.jsx("option",{value:"gives_outstanding",children:"ÔøΩ Gives Outstanding"}),u.jsx("option",{value:"takes_outstanding",children:"ÔøΩ Takes Outstanding"}),u.jsx("option",{value:"settled",children:"‚úÖ All Settled"}),u.jsxs("option",{value:"high_amount",children:["üî• High Amount (",">","‚Çπ10K)"]}),u.jsx("option",{value:"medium_amount",children:"‚ö†Ô∏è Medium Amount (‚Çπ1K-‚Çπ10K)"}),u.jsxs("option",{value:"low_amount",children:["üìä Low Amount (","<","‚Çπ1K)"]})]})}),u.jsx("div",{className:"flex-1",children:u.jsxs("select",{value:c,onChange:A=>f(A.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-white text-base",children:[u.jsx("option",{value:"loans_desc",children:"üìà Highest Amount First"}),u.jsx("option",{value:"loans_asc",children:"üìâ Lowest Amount First"}),u.jsx("option",{value:"name_asc",children:"üî§ Name A to Z"}),u.jsx("option",{value:"name_desc",children:"üî§ Name Z to A"})]})})]}),u.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 mt-6",children:[u.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 p-4 rounded-xl text-center",children:[u.jsx("p",{className:"text-2xl font-bold text-green-600",children:n.length}),u.jsx("p",{className:"text-xs font-medium text-green-700",children:"Total Persons"})]}),u.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 p-4 rounded-xl text-center",children:[u.jsx("p",{className:"text-2xl font-bold text-blue-600",children:n.filter(A=>A.loanAmount>0).length}),u.jsx("p",{className:"text-xs font-medium text-blue-700",children:"Gives Outstanding"})]}),u.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 p-4 rounded-xl text-center",children:[u.jsx("p",{className:"text-2xl font-bold text-green-600",children:n.filter(A=>A.loanAmount<0).length}),u.jsx("p",{className:"text-xs font-medium text-green-700",children:"Takes Outstanding"})]}),u.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 p-4 rounded-xl text-center",children:[u.jsxs("p",{className:"text-lg font-bold text-purple-600",children:["‚Çπ",Math.round(n.reduce((A,M)=>A+Math.abs(M.loanAmount),0)).toLocaleString()]}),u.jsx("p",{className:"text-xs font-medium text-purple-700",children:"Total Amount"})]})]})]}),u.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:k.length===0?u.jsxs("div",{className:"col-span-full text-center py-16 bg-white rounded-xl shadow-sm",children:[u.jsx("div",{className:"w-20 h-20 mx-auto mb-6 bg-gray-100 rounded-full flex items-center justify-center",children:u.jsx(wa,{className:"h-10 w-10 text-gray-400"})}),u.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No persons found"}),u.jsx("p",{className:"text-gray-500 mb-6",children:o?"Try adjusting your search or filters":"Use the + button below to add your first person"})]}):k.map(A=>u.jsxs("div",{onClick:()=>t(`/persons/${A.id}`),className:"bg-white rounded-xl border border-gray-200 p-5 hover:border-green-300 hover:shadow-lg transition-all duration-200 cursor-pointer group transform hover:scale-105",children:[u.jsxs("div",{className:"flex items-start justify-between mb-4",children:[u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsx("h3",{className:"font-semibold text-gray-900 text-lg truncate group-hover:text-green-600 transition-colors",children:A.name}),A.company&&u.jsx("p",{className:"text-sm text-gray-600 truncate mt-1",children:A.company})]}),u.jsxs("div",{className:"ml-4 text-right",children:[u.jsxs("div",{className:`px-3 py-1 rounded-full text-sm font-bold ${A.loanAmount>0?A.loanAmount>1e4?"bg-red-100 text-red-700":A.loanAmount>1e3?"bg-yellow-100 text-yellow-700":"bg-orange-100 text-orange-700":A.loanAmount<0?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:["‚Çπ",Math.round(Math.abs(A.loanAmount)).toLocaleString()]}),u.jsx("p",{className:"text-xs text-gray-500 mt-1",children:A.loanAmount>0?"Gives Outstanding":A.loanAmount<0?"Takes Outstanding":"All Settled"})]})]}),u.jsxs("div",{className:"flex space-x-2",children:[A.phone&&u.jsx("div",{className:"flex items-center text-sm text-gray-600",children:u.jsx("div",{className:"w-8 h-8 bg-blue-50 rounded-lg flex items-center justify-center",children:u.jsx(gl,{className:"h-4 w-4 text-blue-500"})})}),A.address&&u.jsx("div",{className:"flex items-center text-sm text-gray-600",children:u.jsx("div",{className:"w-8 h-8 bg-purple-50 rounded-lg flex items-center justify-center",children:u.jsx(Rc,{className:"h-4 w-4 text-purple-500"})})})]}),u.jsx("div",{className:"mt-4 pt-3 border-t border-gray-100",children:u.jsx("p",{className:"text-xs text-gray-400 text-center group-hover:text-green-400 transition-colors",children:"Tap to view details & manage"})})]},A.id))}),u.jsx("button",{onClick:()=>x(!0),className:"fixed bottom-6 right-6 sm:hidden w-14 h-14 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-full shadow-2xl hover:from-green-600 hover:to-green-700 flex items-center justify-center z-40 transform hover:scale-110 transition-all duration-200",style:{boxShadow:"0 10px 25px rgba(34, 197, 94, 0.5)"},children:u.jsx(li,{className:"h-6 w-6"})}),d&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-50 flex items-end sm:items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-lg max-h-[95vh] sm:max-h-[90vh] overflow-y-auto shadow-2xl",children:[u.jsx("div",{className:"sticky top-0 bg-white rounded-t-2xl sm:rounded-t-2xl z-10",children:u.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Add New Person"}),u.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Fill in the person details"})]}),u.jsx("button",{onClick:S,className:"w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center transition-colors",children:u.jsx("span",{className:"text-xl text-gray-500",children:"√ó"})})]})}),u.jsxs("form",{onSubmit:T,className:"p-6 space-y-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Person Name *"}),u.jsx("input",{type:"text",value:g.name,onChange:A=>y({...g,name:A.target.value}),required:!0,className:"w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-gray-50 text-base transition-colors",placeholder:"Enter person's full name"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Company"}),u.jsx("input",{type:"text",value:g.company,onChange:A=>y({...g,company:A.target.value}),className:"w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-gray-50 text-base transition-colors",placeholder:"Enter company name (optional)"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Phone Number"}),u.jsx("input",{type:"tel",value:g.phone,onChange:A=>y({...g,phone:A.target.value}),className:"w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-gray-50 text-base transition-colors",placeholder:"Enter phone number"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Address"}),u.jsx("textarea",{value:g.address,onChange:A=>y({...g,address:A.target.value}),rows:3,className:"w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-gray-50 text-base transition-colors resize-none",placeholder:"Enter address"})]}),u.jsxs("div",{className:"flex gap-3 pt-4",children:[u.jsx("button",{type:"button",onClick:S,className:"flex-1 py-3 px-4 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors font-semibold",children:"Cancel"}),u.jsx("button",{type:"submit",className:"flex-1 py-3 px-4 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-xl hover:from-green-600 hover:to-green-700 font-semibold transition-all duration-200",children:"Add Person"})]})]})]})})]})},Uj=()=>{const{id:e}=J_(),{user:t}=ha(),r=Fo(),[n,a]=U.useState(null),[i,s]=U.useState([]),[o,l]=U.useState([]),[c,f]=U.useState(!0),[h,p]=U.useState(!1),[d,x]=U.useState(!1),[g,y]=U.useState(!1),[b,T]=U.useState(""),[S,k]=U.useState(""),[A,M]=U.useState(""),[O,I]=U.useState(""),[j,W]=U.useState(""),[E,C]=U.useState(""),[G,Z]=U.useState(""),[he,oe]=U.useState(0),[me,pe]=U.useState(!1),[ge,Le]=U.useState({name:"",company:"",phone:"",address:""}),[Se,N]=U.useState({totalLoansGiven:0,totalPaymentsReceived:0,totalOutstanding:0,transactionCount:0}),[D,L]=U.useState({show:!1,x:0,y:0,transaction:null}),[F,K]=U.useState(!1),[ce,xe]=U.useState(null),[ee,fe]=U.useState(""),[le,ue]=U.useState(""),$e=Fe=>{localStorage.setItem("shopsynk_last_selected_owner",Fe)},ye=()=>localStorage.getItem("shopsynk_last_selected_owner")||"";U.useEffect(()=>{e&&Q()},[e,t]),U.useEffect(()=>{const Fe=()=>{D.show&&ft()};if(D.show)return document.addEventListener("mousedown",Fe),()=>{document.removeEventListener("mousedown",Fe)}},[D.show]),U.useEffect(()=>{const Fe=()=>x(!0),Xe=()=>y(!0);return window.addEventListener("openPurchaseModal",Fe),window.addEventListener("openPaymentModal",Xe),()=>{window.removeEventListener("openPurchaseModal",Fe),window.removeEventListener("openPaymentModal",Xe)}},[]);const Q=U.useCallback(async()=>{if(!(!t||!e))try{f(!0);const{data:Fe,error:Xe}=await Ye.from("persons").select("*").eq("id",e).eq("user_id",t.id).single();if(Xe)throw Xe;a(Fe);const{data:At,error:xt}=await Ye.from("loan_transactions").select(`
          *,
          owner:owner_id (
            owner_name
          )
        `).eq("person_id",e).eq("user_id",t.id).order("created_at",{ascending:!1});if(xt)throw xt;s(At||[]);const st=await Ts.getInstance().getBusinessOwners(t.id);console.log("Fetched business owners:",st),l(st);const pt=ye();pt&&st.find(ht=>ht.id===pt)?(k(pt),I(pt)):st.length>0&&(k(st[0].id),I(st[0].id)),nt(At||[])}catch(Fe){console.error("Error fetching person data:",Fe)}finally{f(!1)}},[e,t]),nt=Fe=>{let Xe=0,At=0,xt=0;Fe.forEach(st=>{st.type==="Gives"?(Xe+=parseFloat(st.amount.toString()),At+=parseFloat(st.amount.toString())):st.type==="Takes"&&(Xe-=parseFloat(st.amount.toString()),xt+=parseFloat(st.amount.toString()))}),oe(Xe),N({totalLoansGiven:At,totalPaymentsReceived:xt,totalOutstanding:Math.abs(Xe),transactionCount:Fe.length})},Re=async Fe=>{if(Fe.preventDefault(),console.log("User:",t),console.log("Person:",n),console.log("Loan Amount:",b),console.log("Loan Owner ID:",S),console.log("Business Owners:",o),!t||!n||!b||!S){alert("Please fill in all required fields");return}const Xe=parseFloat(b);if(isNaN(Xe)||Xe<=0){alert("Please enter a valid amount greater than 0");return}p(!0);try{const At={user_id:t.id,person_id:n.id,owner_id:S,type:"Gives",amount:Xe,description:j||"Gives",due_date:G||null};console.log("Inserting transaction:",At);const{error:xt}=await Ye.from("loan_transactions").insert([At]);if(xt)throw console.error("Supabase error:",xt),xt;console.log("Transaction inserted successfully"),T(""),W(""),Z(""),x(!1),await Q()}catch(At){console.error("Error giving loan:",At),alert("Error creating transaction: "+At.message)}finally{p(!1)}},ot=async Fe=>{if(Fe.preventDefault(),!t||!n||!A||!O){alert("Please fill in all required fields");return}const Xe=parseFloat(A);if(isNaN(Xe)||Xe<=0){alert("Please enter a valid amount greater than 0");return}p(!0);try{const{error:At}=await Ye.from("loan_transactions").insert([{user_id:t.id,person_id:n.id,owner_id:O,type:"Takes",amount:Xe,description:E||"Takes"}]);if(At)throw At;M(""),C(""),y(!1),await Q()}catch(At){console.error("Error receiving payment:",At),alert("Error creating transaction: "+At.message)}finally{p(!1)}},ze=async Fe=>{if(Fe.preventDefault(),!!n)try{const{error:Xe}=await Ye.from("persons").update({name:ge.name,company:ge.company,phone:ge.phone,address:ge.address}).eq("id",n.id);if(Xe)throw Xe;pe(!1),await Q()}catch(Xe){console.error("Error updating person:",Xe)}},lt=async Fe=>{if(confirm("Are you sure you want to delete this transaction?"))try{const{error:Xe}=await Ye.from("loan_transactions").delete().eq("id",Fe);if(Xe)throw Xe;await Q(),ft()}catch(Xe){console.error("Error deleting transaction:",Xe)}},Qe=async Fe=>{if(Fe.preventDefault(),!!ce)try{const{error:Xe}=await Ye.from("loan_transactions").update({amount:parseFloat(ee),description:le}).eq("id",ce.id);if(Xe)throw Xe;K(!1),xe(null),await Q()}catch(Xe){console.error("Error updating transaction:",Xe)}},Tt=(Fe,Xe)=>{Fe.preventDefault(),L({show:!0,x:Fe.clientX,y:Fe.clientY,transaction:Xe})},ft=()=>{L({show:!1,x:0,y:0,transaction:null})},Ot=()=>{D.transaction&&(xe(D.transaction),fe(D.transaction.amount.toString()),ue(D.transaction.description||""),K(!0),ft())};return c?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})}):n?u.jsxs("div",{className:"min-h-screen bg-gray-50",children:[u.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200",children:u.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between py-4 sm:h-16 gap-4",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("button",{onClick:()=>r("/persons"),className:"flex items-center text-gray-600 hover:text-gray-900 transition-colors",children:[u.jsx(_o,{className:"h-5 w-5 mr-2"}),u.jsx("span",{className:"hidden sm:inline",children:"Back to Persons"})]}),u.jsx("div",{className:"h-6 w-px bg-gray-300 hidden sm:block"}),u.jsxs("div",{children:[u.jsx("h1",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:n.name}),n.company&&u.jsx("p",{className:"text-sm text-gray-600",children:n.company})]})]}),u.jsx("div",{className:"flex items-center space-x-2 sm:space-x-3 flex-wrap",children:u.jsxs("button",{onClick:()=>{Le({name:n.name,company:n.company||"",phone:n.phone||"",address:n.address||""}),pe(!0)},className:"flex items-center px-3 sm:px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[u.jsx(vc,{className:"h-4 w-4 mr-1 sm:mr-2"}),u.jsx("span",{className:"hidden sm:inline",children:"Edit"})]})})]})})}),u.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[u.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[u.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[u.jsx(Sn,{className:"h-5 w-5 mr-2 text-green-600"}),"Person Information"]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center text-sm",children:[u.jsx(Sn,{className:"h-4 w-4 text-gray-400 mr-3 flex-shrink-0"}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900",children:n.name}),u.jsx("p",{className:"text-gray-500",children:"Full Name"})]})]}),n.company&&u.jsxs("div",{className:"flex items-center text-sm",children:[u.jsx(m8,{className:"h-4 w-4 text-gray-400 mr-3 flex-shrink-0"}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900",children:n.company}),u.jsx("p",{className:"text-gray-500",children:"Company"})]})]}),n.phone&&u.jsxs("div",{className:"flex items-center text-sm",children:[u.jsx("div",{className:"w-8 h-8 bg-blue-50 rounded-lg flex items-center justify-center mr-3",children:u.jsx(gl,{className:"h-4 w-4 text-blue-500"})}),u.jsx("div",{children:u.jsx("p",{className:"text-gray-500",children:"Phone"})})]}),n.address&&u.jsxs("div",{className:"flex items-center text-sm",children:[u.jsx("div",{className:"w-8 h-8 bg-purple-50 rounded-lg flex items-center justify-center mr-3",children:u.jsx(Rc,{className:"h-4 w-4 text-purple-500"})}),u.jsx("div",{children:u.jsx("p",{className:"text-gray-500",children:"Address"})})]})]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[u.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-6 flex items-center",children:[u.jsx(Es,{className:"h-5 w-5 mr-2 text-green-600"}),"Loan Summary"]}),u.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100 rounded-xl p-6 mb-6 border border-gray-200",children:u.jsxs("div",{className:"text-center",children:[u.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Outstanding Amount"}),u.jsx("div",{className:"flex items-center justify-center mb-2",children:u.jsxs("div",{className:`px-6 py-3 rounded-full text-lg font-bold ${he>0?he>1e4?"bg-red-100 text-red-700":he>1e3?"bg-yellow-100 text-yellow-700":"bg-orange-100 text-orange-700":he<0?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:["‚Çπ",Math.abs(he).toLocaleString()]})}),u.jsx("p",{className:"text-sm text-gray-600 font-medium",children:he>0?"Gives Outstanding":he<0?"Takes Outstanding":"All Settled"}),u.jsx("p",{className:"text-xs text-gray-500 mt-1",children:he>0?"Person owes you this amount":he<0?"You owe the person this amount":"No outstanding balance"})]})}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("span",{className:"text-sm text-gray-600",children:"Total Gives"}),u.jsxs("span",{className:"font-semibold text-red-600",children:["‚Çπ",Se.totalLoansGiven.toLocaleString()]})]}),u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("span",{className:"text-sm text-gray-600",children:"Total Takes"}),u.jsxs("span",{className:"font-semibold text-green-600",children:["‚Çπ",Se.totalPaymentsReceived.toLocaleString()]})]}),u.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-500 pt-2 border-t border-gray-200",children:[u.jsx("span",{children:"Total Transactions"}),u.jsx("span",{children:Se.transactionCount})]})]})]})]}),u.jsx("div",{className:"lg:col-span-2",children:u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[u.jsx("div",{className:"p-6 border-b border-gray-200",children:u.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[u.jsx(Un,{className:"h-5 w-5 mr-2 text-green-600"}),"Transaction History"]})}),u.jsx("div",{className:"divide-y divide-gray-200",children:i.length===0?u.jsxs("div",{className:"p-8 text-center",children:[u.jsx(Un,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),u.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"No transactions yet"}),u.jsx("p",{className:"text-sm text-gray-500",children:"Start by giving a loan or recording a payment."})]}):i.map(Fe=>u.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors cursor-pointer",onContextMenu:Xe=>Tt(Xe,Fe),children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${Fe.type==="Gives"?"bg-green-100 text-green-600":"bg-blue-100 text-blue-600"}`,children:Fe.type==="Gives"?u.jsx(Af,{className:"h-5 w-5"}):u.jsx(Sf,{className:"h-5 w-5"})}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-gray-900",children:Fe.type==="Gives"?"Gives":"Takes"}),u.jsx("p",{className:"text-sm text-gray-600",children:Fe.description}),u.jsxs("div",{className:"flex items-center space-x-4 mt-1",children:[u.jsxs("p",{className:"text-xs text-gray-500 flex items-center",children:[u.jsx(xl,{className:"h-3 w-3 mr-1"}),new Date(Fe.created_at).toLocaleDateString()]}),Fe.owner&&u.jsxs("p",{className:"text-xs text-gray-500 flex items-center",children:[u.jsx(Sn,{className:"h-3 w-3 mr-1"}),Fe.owner.owner_name]})]})]})]}),u.jsx("div",{className:"text-right",children:u.jsxs("p",{className:`font-semibold ${Fe.type==="Gives"?"text-green-600":"text-blue-600"}`,children:[Fe.type==="Gives"?"+":"-","‚Çπ",Fe.amount.toLocaleString()]})})]})},Fe.id))})]})})]})}),D.show&&u.jsxs("div",{className:"fixed z-50 bg-white border border-gray-200 rounded-lg shadow-lg py-2 min-w-48",style:{left:D.x,top:D.y},children:[u.jsxs("button",{onClick:Ot,className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center",children:[u.jsx(vc,{className:"h-4 w-4 mr-2"}),"Edit Transaction"]}),u.jsxs("button",{onClick:()=>lt(D.transaction.id),className:"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 flex items-center",children:[u.jsx(Sl,{className:"h-4 w-4 mr-2"}),"Delete Transaction"]})]}),d&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:u.jsx("div",{className:"bg-white rounded-xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:u.jsxs("div",{className:"p-6",children:[u.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[u.jsx(Q_,{className:"h-5 w-5 mr-2 text-green-600"}),"Gives"]}),u.jsxs("form",{onSubmit:Re,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Amount *"}),u.jsx("input",{type:"number",step:"0.01",value:b,onChange:Fe=>T(Fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Enter loan amount",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Business Owner *"}),u.jsx("select",{value:S,onChange:Fe=>{k(Fe.target.value),$e(Fe.target.value)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",required:!0,children:o.map(Fe=>u.jsx("option",{value:Fe.id,children:Fe.owner_name},Fe.id))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),u.jsx("input",{type:"text",value:j,onChange:Fe=>W(Fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Loan description (optional)"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Due Date"}),u.jsx("input",{type:"date",value:G,onChange:Fe=>Z(Fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})]}),u.jsxs("div",{className:"flex space-x-3 pt-4",children:[u.jsx("button",{type:"button",onClick:()=>x(!1),className:"flex-1 py-2 px-4 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),u.jsx("button",{type:"submit",disabled:h,className:"flex-1 py-2 px-4 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg hover:from-green-600 hover:to-green-700 disabled:opacity-50 transition-colors",children:h?"Processing...":"Gives"})]})]})]})})}),g&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:u.jsx("div",{className:"bg-white rounded-xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:u.jsxs("div",{className:"p-6",children:[u.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[u.jsx(Es,{className:"h-5 w-5 mr-2 text-blue-600"}),"Takes"]}),u.jsxs("form",{onSubmit:ot,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Amount *"}),u.jsx("input",{type:"number",step:"0.01",value:A,onChange:Fe=>M(Fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter payment amount",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Business Owner *"}),u.jsx("select",{value:O,onChange:Fe=>{I(Fe.target.value),$e(Fe.target.value)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:o.map(Fe=>u.jsx("option",{value:Fe.id,children:Fe.owner_name},Fe.id))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),u.jsx("input",{type:"text",value:E,onChange:Fe=>C(Fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Payment description (optional)"})]}),u.jsxs("div",{className:"flex space-x-3 pt-4",children:[u.jsx("button",{type:"button",onClick:()=>y(!1),className:"flex-1 py-2 px-4 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),u.jsx("button",{type:"submit",disabled:h,className:"flex-1 py-2 px-4 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg hover:from-blue-600 hover:to-blue-700 disabled:opacity-50 transition-colors",children:h?"Processing...":"Takes"})]})]})]})})}),me&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:u.jsx("div",{className:"bg-white rounded-xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:u.jsxs("div",{className:"p-6",children:[u.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[u.jsx(vc,{className:"h-5 w-5 mr-2 text-green-600"}),"Edit Person"]}),u.jsxs("form",{onSubmit:ze,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Name *"}),u.jsx("input",{type:"text",value:ge.name,onChange:Fe=>Le({...ge,name:Fe.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company"}),u.jsx("input",{type:"text",value:ge.company,onChange:Fe=>Le({...ge,company:Fe.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone"}),u.jsx("input",{type:"tel",value:ge.phone,onChange:Fe=>Le({...ge,phone:Fe.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),u.jsx("textarea",{value:ge.address,onChange:Fe=>Le({...ge,address:Fe.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 resize-none"})]}),u.jsxs("div",{className:"flex space-x-3 pt-4",children:[u.jsx("button",{type:"button",onClick:()=>pe(!1),className:"flex-1 py-2 px-4 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),u.jsx("button",{type:"submit",className:"flex-1 py-2 px-4 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg hover:from-green-600 hover:to-green-700 transition-colors",children:"Update"})]})]})]})})}),F&&ce&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:u.jsx("div",{className:"bg-white rounded-xl max-w-md w-full",children:u.jsxs("div",{className:"p-6",children:[u.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[u.jsx(vc,{className:"h-5 w-5 mr-2 text-green-600"}),"Edit Transaction"]}),u.jsxs("form",{onSubmit:Qe,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Amount *"}),u.jsx("input",{type:"number",step:"0.01",value:ee,onChange:Fe=>fe(Fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),u.jsx("input",{type:"text",value:le,onChange:Fe=>ue(Fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})]}),u.jsxs("div",{className:"flex space-x-3 pt-4",children:[u.jsx("button",{type:"button",onClick:()=>{K(!1),xe(null)},className:"flex-1 py-2 px-4 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),u.jsx("button",{type:"submit",className:"flex-1 py-2 px-4 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg hover:from-green-600 hover:to-green-700 transition-colors",children:"Update"})]})]})]})})})]}):u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsxs("div",{className:"text-center",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Person not found"}),u.jsx("button",{onClick:()=>r("/persons"),className:"text-green-600 hover:text-green-700",children:"Back to Persons"})]})})},$j=({isOpen:e,onClose:t,onSubmit:r,suppliers:n,businessOwners:a,editingTransaction:i})=>{const[s,o]=U.useState({supplier_id:"",type:"new_purchase",amount:"",description:"",owner_id:""});U.useEffect(()=>{o(i?{supplier_id:i.supplier_id||"",type:i.type,amount:i.amount.toString(),description:i.description||"",owner_id:i.owner_id||""}:{supplier_id:"",type:"new_purchase",amount:"",description:"",owner_id:""})},[i,e]);const l=c=>{c.preventDefault(),r(s),i||o({supplier_id:"",type:"new_purchase",amount:"",description:"",owner_id:""})};return e?u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[60] flex items-end sm:items-center justify-center p-4",children:u.jsxs("div",{className:"bg-white rounded-t-xl sm:rounded-xl w-full sm:max-w-md max-h-[90vh] overflow-y-auto",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:i?"Edit Transaction":"Add Transaction"}),u.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg",children:u.jsx(jo,{className:"h-5 w-5"})})]}),u.jsxs("form",{onSubmit:l,className:"p-4 space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Transaction Type"}),u.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[u.jsxs("button",{type:"button",onClick:()=>o({...s,type:"new_purchase"}),className:`p-3 border rounded-lg text-center ${s.type==="new_purchase"?"border-red-500 bg-red-50 text-red-700":"border-gray-300 hover:bg-gray-50"}`,children:[u.jsx(li,{className:"h-4 w-4 mx-auto mb-1"}),u.jsx("span",{className:"text-sm",children:"Purchase"})]}),u.jsxs("button",{type:"button",onClick:()=>o({...s,type:"pay_due"}),className:`p-3 border rounded-lg text-center ${s.type==="pay_due"?"border-green-500 bg-green-50 text-green-700":"border-gray-300 hover:bg-gray-50"}`,children:[u.jsx(Es,{className:"h-4 w-4 mx-auto mb-1"}),u.jsx("span",{className:"text-sm",children:"Payment"})]})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supplier"}),u.jsxs("select",{value:s.supplier_id,onChange:c=>o({...s,supplier_id:c.target.value}),required:!0,className:"w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[u.jsx("option",{value:"",children:"Select Supplier"}),n.map(c=>u.jsx("option",{value:c.id,children:c.name},c.id))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount (‚Çπ)"}),u.jsx("input",{type:"number",value:s.amount,onChange:c=>o({...s,amount:c.target.value}),required:!0,min:"0",step:"0.01",placeholder:"Enter amount",className:"w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s.type==="new_purchase"?"Purchased by":"Paid by"}),u.jsxs("select",{value:s.owner_id,onChange:c=>o({...s,owner_id:c.target.value}),className:"w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[u.jsx("option",{value:"",children:"Select person"}),a.map(c=>u.jsx("option",{value:c.id,children:c.owner_name},c.id))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description (Optional)"}),u.jsx("input",{type:"text",value:s.description,onChange:c=>o({...s,description:c.target.value}),placeholder:"Add description...",className:"w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("div",{className:"flex space-x-3 pt-2",children:[u.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-2.5 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Cancel"}),u.jsx("button",{type:"submit",className:"flex-1 px-4 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:i?"Update Transaction":"Add Transaction"})]})]})]})}):null},zj=()=>{const{user:e}=ha(),[t,r]=U.useState([]),[n,a]=U.useState([]),[i,s]=U.useState([]),[o,l]=U.useState([]),[c,f]=U.useState(!0),[h,p]=U.useState(""),[d,x]=U.useState("all"),[g,y]=U.useState("suppliers"),[b,T]=U.useState(!1),[S,k]=U.useState(null),[A,M]=U.useState(null);U.useEffect(()=>{O()},[e]),U.useEffect(()=>{const oe=me=>{A&&!me.target.closest(".dropdown-menu")&&M(null)};return document.addEventListener("mousedown",oe),()=>document.removeEventListener("mousedown",oe)},[A]);const O=async()=>{if(e)try{const{data:oe,error:me}=await Ye.from("transactions").select(`
          *,
          supplier:suppliers(name),
          owner:business_owners(owner_name)
        `).eq("user_id",e.id).order("created_at",{ascending:!1});if(me)throw me;const{data:pe,error:ge}=await Ye.from("loan_transactions").select(`
          *,
          person:persons(name),
          owner:business_owners(owner_name)
        `).eq("user_id",e.id).order("created_at",{ascending:!1});if(ge)throw ge;const{data:Le,error:Se}=await Ye.from("suppliers").select("*").eq("user_id",e.id).order("name");if(Se)throw Se;const D=await Ts.getInstance().getBusinessOwners(e.id);r(oe||[]),a(pe||[]),s(Le||[]),l(D||[])}catch(oe){console.error("Error fetching data:",oe)}finally{f(!1)}},I=async oe=>{if(e)try{if(S){const{error:me}=await Ye.from("transactions").update({amount:parseFloat(oe.amount),description:oe.description,type:oe.type,supplier_id:oe.supplier_id,owner_id:oe.owner_id}).eq("id",S.id);if(me)throw me;k(null)}else{const{data:me,error:pe}=await Ye.from("transactions").insert([{...oe,user_id:e.id,amount:parseFloat(oe.amount)}]).select(`
            *,
            supplier:suppliers(name),
            owner:business_owners(owner_name)
          `).single();if(pe)throw pe;const ge=i.find(Se=>Se.id===oe.supplier_id),Le=o.find(Se=>Se.id===oe.owner_id);if(ge&&Le&&e.email){const Se=parseFloat(oe.amount);oe.type==="new_purchase"?await M1.notifyTransactionCreated(e.id,Le.owner_name,Se,ge.name,me.id,ge.id):oe.type==="pay_due"&&await M1.notifyPaymentMade(e.id,Le.owner_name,Se,ge.name,ge.id)}}await O(),T(!1)}catch(me){console.error("Error saving transaction:",me)}},j=oe=>{k(oe),T(!0),M(null)},W=async oe=>{if(confirm("Are you sure you want to delete this transaction?"))try{const{error:me}=await Ye.from("transactions").delete().eq("id",oe);if(me)throw me;await O(),M(null)}catch(me){console.error("Error deleting transaction:",me)}},C=[...t.map(oe=>({...oe,transactionType:"supplier"})),...n.map(oe=>({...oe,transactionType:"person"}))].filter(oe=>{var Le,Se,N,D,L,F,K;const me=((Le=oe.description)==null?void 0:Le.toLowerCase().includes(h.toLowerCase()))||oe.transactionType==="supplier"&&((N=(Se=oe.supplier)==null?void 0:Se.name)==null?void 0:N.toLowerCase().includes(h.toLowerCase()))||oe.transactionType==="person"&&((L=(D=oe.person)==null?void 0:D.name)==null?void 0:L.toLowerCase().includes(h.toLowerCase()))||((K=(F=oe.owner)==null?void 0:F.owner_name)==null?void 0:K.toLowerCase().includes(h.toLowerCase())),pe=oe.transactionType===g.slice(0,-1),ge=d==="all"||oe.type===d;return me&&pe&&ge}).sort((oe,me)=>new Date(me.created_at).getTime()-new Date(oe.created_at).getTime()),G=(oe,me)=>{if(me==="person")switch(oe){case"Gives":return u.jsx(Af,{className:"h-4 w-4 text-red-500"});case"Takes":return u.jsx(Sf,{className:"h-4 w-4 text-green-500"});default:return u.jsx(Un,{className:"h-4 w-4 text-gray-500"})}else switch(oe){case"new_purchase":return u.jsx(Af,{className:"h-4 w-4 text-red-500"});case"pay_due":case"settle_bill":return u.jsx(Sf,{className:"h-4 w-4 text-green-500"});default:return u.jsx(Un,{className:"h-4 w-4 text-gray-500"})}},Z=(oe,me)=>{if(me==="person")switch(oe){case"Gives":return"Gives";case"Takes":return"Takes";default:return oe}else switch(oe){case"new_purchase":return"Purchase";case"pay_due":return"Payment";case"settle_bill":return"Settlement";default:return oe}},he=oe=>new Date(oe).toLocaleDateString("en-IN",{month:"short",day:"numeric",year:"numeric"});return c?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):u.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[u.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Transactions"}),u.jsx("p",{className:"text-gray-600 text-sm",children:"Track all your business transactions"})]})}),u.jsx("div",{className:"border-b border-gray-200 mb-6",children:u.jsxs("nav",{className:"-mb-px flex space-x-8",children:[u.jsxs("button",{onClick:()=>y("suppliers"),className:`py-2 px-1 border-b-2 font-medium text-sm ${g==="suppliers"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[u.jsx(wa,{className:"h-4 w-4 inline mr-2"}),"Suppliers"]}),u.jsxs("button",{onClick:()=>y("persons"),className:`py-2 px-1 border-b-2 font-medium text-sm ${g==="persons"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[u.jsx(Sn,{className:"h-4 w-4 inline mr-2"}),"Persons"]})]})}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[u.jsxs("div",{className:"relative flex-1",children:[u.jsx(Hg,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),u.jsx("input",{type:"text",placeholder:"Search transactions...",value:h,onChange:oe=>p(oe.target.value),className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("div",{className:"relative",children:[u.jsx(e4,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),u.jsxs("select",{value:d,onChange:oe=>x(oe.target.value),className:"pl-10 pr-8 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 appearance-none bg-white",children:[u.jsx("option",{value:"all",children:"All Types"}),g==="suppliers"?u.jsxs(u.Fragment,{children:[u.jsx("option",{value:"new_purchase",children:"Purchases"}),u.jsx("option",{value:"pay_due",children:"Payments"})]}):u.jsxs(u.Fragment,{children:[u.jsx("option",{value:"Gives",children:"Gives"}),u.jsx("option",{value:"Takes",children:"Takes"})]})]})]})]}),u.jsx("div",{className:"space-y-3",children:C.length===0?u.jsxs("div",{className:"text-center py-12",children:[u.jsx(Un,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),u.jsx("p",{className:"text-gray-500 text-lg",children:"No transactions found"}),u.jsx("p",{className:"text-gray-400 text-sm",children:h?"Try adjusting your search":"Add your first transaction to get started"})]}):C.map(oe=>{var me,pe,ge;return u.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:u.jsxs("div",{className:"flex items-start justify-between",children:[u.jsxs("div",{className:"flex items-start space-x-3 flex-1 min-w-0",children:[u.jsx("div",{className:"flex-shrink-0 mt-1",children:G(oe.type,oe.transactionType)}),u.jsxs("div",{className:"flex-1 min-w-0",children:[u.jsxs("div",{className:"flex items-center justify-between mb-1",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("h3",{className:"font-medium text-gray-900 truncate",children:oe.transactionType==="supplier"?(me=oe.supplier)==null?void 0:me.name:(pe=oe.person)==null?void 0:pe.name}),u.jsx("span",{className:`px-2 py-1 text-xs rounded-full font-medium ${oe.transactionType==="supplier"?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:oe.transactionType==="supplier"?"Supplier":"Person"})]}),u.jsxs("p",{className:`font-semibold text-lg ${oe.transactionType==="supplier"&&oe.type==="new_purchase"||oe.transactionType==="person"&&oe.type==="Gives"?"text-red-600":"text-green-600"}`,children:[oe.transactionType==="supplier"&&oe.type==="new_purchase"||oe.transactionType==="person"&&oe.type==="Gives"?"+":"-","‚Çπ",Math.round(oe.amount).toLocaleString()]})]}),u.jsx("p",{className:"text-sm text-gray-600 mb-1",children:Z(oe.type,oe.transactionType)}),oe.description&&u.jsx("p",{className:"text-sm text-gray-500 mb-2 line-clamp-2",children:oe.description}),u.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(xl,{className:"h-3 w-3 mr-1"}),he(oe.created_at)]}),((ge=oe.owner)==null?void 0:ge.owner_name)&&u.jsxs("span",{className:"text-blue-600 font-medium",children:["by ",oe.owner.owner_name]})]})]})]}),oe.transactionType==="supplier"&&u.jsxs("div",{className:"relative ml-3",children:[u.jsx("button",{onClick:()=>M(A===oe.id?null:oe.id),className:"p-1 hover:bg-gray-100 rounded-full transition-colors",children:u.jsx(nf,{className:"h-4 w-4 text-gray-500"})}),A===oe.id&&u.jsxs("div",{className:"dropdown-menu absolute right-0 top-8 w-36 bg-white border border-gray-200 rounded-lg shadow-lg z-10",children:[u.jsxs("button",{onClick:()=>j(oe),className:"w-full px-3 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center rounded-t-lg",children:[u.jsx(g8,{className:"h-4 w-4 mr-2"}),"Edit"]}),u.jsxs("button",{onClick:()=>W(oe.id),className:"w-full px-3 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center rounded-b-lg",children:[u.jsx(Sl,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]})},oe.id)})}),u.jsx($j,{isOpen:b,onClose:()=>{T(!1),k(null)},onSubmit:I,suppliers:i,businessOwners:o,editingTransaction:S})]})};function h4(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=h4(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function jn(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=h4(e))&&(n&&(n+=" "),n+=t);return n}var Dd={},d4={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(d4);var Yg={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(Yg);var Xg={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var n;return typeof r=="string"||typeof r=="symbol"?r:Object.is((n=r==null?void 0:r.valueOf)==null?void 0:n.call(r),-0)?"-0":String(r)}e.toKey=t})(Xg);var Id={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){const n=[],a=r.length;if(a===0)return n;let i=0,s="",o="",l=!1;for(r.charCodeAt(0)===46&&(n.push(""),i++);i<a;){const c=r[i];o?c==="\\"&&i+1<a?(i++,s+=r[i]):c===o?o="":s+=c:l?c==='"'||c==="'"?o=c:c==="]"?(l=!1,n.push(s),s=""):s+=c:c==="["?(l=!0,s&&(n.push(s),s="")):c==="."?s&&(n.push(s),s=""):s+=c,i++}return s&&n.push(s),n}e.toPath=t})(Id);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=d4,r=Yg,n=Xg,a=Id;function i(o,l,c){if(o==null)return c;switch(typeof l){case"string":{if(t.isUnsafeProperty(l))return c;const f=o[l];return f===void 0?r.isDeepKey(l)?i(o,a.toPath(l),c):c:f}case"number":case"symbol":{typeof l=="number"&&(l=n.toKey(l));const f=o[l];return f===void 0?c:f}default:{if(Array.isArray(l))return s(o,l,c);if(Object.is(l==null?void 0:l.valueOf(),-0)?l="-0":l=String(l),t.isUnsafeProperty(l))return c;const f=o[l];return f===void 0?c:f}}}function s(o,l,c){if(l.length===0)return c;let f=o;for(let h=0;h<l.length;h++){if(f==null||t.isUnsafeProperty(l[h]))return c;f=f[l[h]]}return f===void 0?c:f}e.get=i})(Dd);var qj=Dd.get;const Uc=Do(qj);var p4={exports:{}},br={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zg=Symbol.for("react.transitional.element"),Jg=Symbol.for("react.portal"),Md=Symbol.for("react.fragment"),Rd=Symbol.for("react.strict_mode"),Bd=Symbol.for("react.profiler"),Ud=Symbol.for("react.consumer"),$d=Symbol.for("react.context"),zd=Symbol.for("react.forward_ref"),qd=Symbol.for("react.suspense"),Wd=Symbol.for("react.suspense_list"),Hd=Symbol.for("react.memo"),Gd=Symbol.for("react.lazy"),Wj=Symbol.for("react.view_transition"),Hj=Symbol.for("react.client.reference");function mi(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case Zg:switch(e=e.type,e){case Md:case Bd:case Rd:case qd:case Wd:case Wj:return e;default:switch(e=e&&e.$$typeof,e){case $d:case zd:case Gd:case Hd:return e;case Ud:return e;default:return t}}case Jg:return t}}}br.ContextConsumer=Ud;br.ContextProvider=$d;br.Element=Zg;br.ForwardRef=zd;br.Fragment=Md;br.Lazy=Gd;br.Memo=Hd;br.Portal=Jg;br.Profiler=Bd;br.StrictMode=Rd;br.Suspense=qd;br.SuspenseList=Wd;br.isContextConsumer=function(e){return mi(e)===Ud};br.isContextProvider=function(e){return mi(e)===$d};br.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===Zg};br.isForwardRef=function(e){return mi(e)===zd};br.isFragment=function(e){return mi(e)===Md};br.isLazy=function(e){return mi(e)===Gd};br.isMemo=function(e){return mi(e)===Hd};br.isPortal=function(e){return mi(e)===Jg};br.isProfiler=function(e){return mi(e)===Bd};br.isStrictMode=function(e){return mi(e)===Rd};br.isSuspense=function(e){return mi(e)===qd};br.isSuspenseList=function(e){return mi(e)===Wd};br.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Md||e===Bd||e===Rd||e===qd||e===Wd||typeof e=="object"&&e!==null&&(e.$$typeof===Gd||e.$$typeof===Hd||e.$$typeof===$d||e.$$typeof===Ud||e.$$typeof===zd||e.$$typeof===Hj||e.getModuleId!==void 0)};br.typeOf=mi;p4.exports=br;var Gj=p4.exports,Wa=e=>e===0?0:e>0?1:-1,Fi=e=>typeof e=="number"&&e!=+e,af=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,Vt=e=>(typeof e=="number"||e instanceof Number)&&!Fi(e),Ds=e=>Vt(e)||typeof e=="string",Vj=0,Lh=e=>{var t=++Vj;return"".concat(e||"").concat(t)},rs=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Vt(t)&&typeof t!="string")return n;var i;if(af(t)){if(r==null)return n;var s=t.indexOf("%");i=r*parseFloat(t.slice(0,s))/100}else i=+t;return Fi(i)&&(i=n),a&&r!=null&&i>r&&(i=r),i},m4=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[e[n]])r[e[n]]=!0;else return!0;return!1},xy=(e,t)=>Vt(e)&&Vt(t)?r=>e+r*(t-e):()=>t;function Kj(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):Uc(n,t))===r)}var El=e=>e===null||typeof e>"u",Jf=e=>El(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),Yj=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function Qg(e){if(typeof e!="string")return!1;var t=Yj;return t.includes(e)}var Xj=["viewBox","children"],vy=["points","pathLength"],Nm={svg:Xj,polygon:vy,polyline:vy},Zj=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(U.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(a=>{Qg(a)&&(n[a]=i=>r[a](r,i))}),n},Jj=(e,t,r)=>n=>(e(t,r,n),null),Qj=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(a=>{var i=e[a];Qg(a)&&typeof i=="function"&&(n||(n={}),n[a]=Jj(i,t,r))}),n},eP=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function g4(e){if(typeof e!="string")return!1;var t=eP;return t.includes(e)}function Vd(e){var t=Object.entries(e).filter(r=>{var[n]=r;return g4(n)});return Object.fromEntries(t)}var yy=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",by=null,Sm=null,x4=e=>{if(e===by&&Array.isArray(Sm))return Sm;var t=[];return U.Children.forEach(e,r=>{El(r)||(Gj.isFragment(r)?t=t.concat(x4(r.props.children)):t.push(r))}),Sm=t,by=e,t};function v4(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(a=>yy(a)):n=[yy(t)],x4(e).forEach(a=>{var i=Uc(a,"type.displayName")||Uc(a,"type.name");n.indexOf(i)!==-1&&r.push(a)}),r}var tP=(e,t,r,n)=>{var a;if(typeof t=="symbol"||typeof t=="number")return!0;var i=(a=n&&(Nm==null?void 0:Nm[n]))!==null&&a!==void 0?a:[],s=t.startsWith("data-"),o=typeof e!="function"&&(!!n&&i.includes(t)||g4(t)),l=!!r&&Qg(t);return s||o||l},Ka=(e,t,r)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(U.isValidElement(e)&&(n=e.props),typeof n!="object"&&typeof n!="function")return null;var a={};return Object.keys(n).forEach(i=>{var s;tP((s=n)===null||s===void 0?void 0:s[i],i,t,r)&&(a[i]=n[i])}),a},rP=["children","width","height","viewBox","className","style","title","desc"];function R1(){return R1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},R1.apply(null,arguments)}function nP(e,t){if(e==null)return{};var r,n,a=aP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function aP(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var y4=U.forwardRef((e,t)=>{var{children:r,width:n,height:a,viewBox:i,className:s,style:o,title:l,desc:c}=e,f=nP(e,rP),h=i||{width:n,height:a,x:0,y:0},p=jn("recharts-surface",s);return U.createElement("svg",R1({},Ka(f,!0,"svg"),{className:p,width:n,height:a,style:o,viewBox:"".concat(h.x," ").concat(h.y," ").concat(h.width," ").concat(h.height),ref:t}),U.createElement("title",null,l),U.createElement("desc",null,c),r)}),iP=["children","className"];function B1(){return B1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},B1.apply(null,arguments)}function sP(e,t){if(e==null)return{};var r,n,a=oP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function oP(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var $c=U.forwardRef((e,t)=>{var{children:r,className:n}=e,a=sP(e,iP),i=jn("recharts-layer",n);return U.createElement("g",B1({className:i},Ka(a,!0),{ref:t}),r)}),lP=U.createContext(null);function Ar(e){return function(){return e}}const b4=Math.cos,Fh=Math.sin,Mi=Math.sqrt,Dh=Math.PI,Kd=2*Dh,U1=Math.PI,$1=2*U1,el=1e-6,cP=$1-el;function w4(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function uP(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return w4;const r=10**t;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class fP{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?w4:uP(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,s){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+s}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let s=this._x1,o=this._y1,l=n-t,c=a-r,f=s-t,h=o-r,p=f*f+h*h;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(p>el)if(!(Math.abs(h*l-c*f)>el)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let d=n-s,x=a-o,g=l*l+c*c,y=d*d+x*x,b=Math.sqrt(g),T=Math.sqrt(p),S=i*Math.tan((U1-Math.acos((g+p-y)/(2*b*T)))/2),k=S/T,A=S/b;Math.abs(k-1)>el&&this._append`L${t+k*f},${r+k*h}`,this._append`A${i},${i},0,0,${+(h*d>f*x)},${this._x1=t+A*l},${this._y1=r+A*c}`}}arc(t,r,n,a,i,s){if(t=+t,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(a),l=n*Math.sin(a),c=t+o,f=r+l,h=1^s,p=s?a-i:i-a;this._x1===null?this._append`M${c},${f}`:(Math.abs(this._x1-c)>el||Math.abs(this._y1-f)>el)&&this._append`L${c},${f}`,n&&(p<0&&(p=p%$1+$1),p>cP?this._append`A${n},${n},0,1,${h},${t-o},${r-l}A${n},${n},0,1,${h},${this._x1=c},${this._y1=f}`:p>el&&this._append`A${n},${n},0,${+(p>=U1)},${h},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function ex(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new fP(t)}function tx(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function _4(e){this._context=e}_4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Yd(e){return new _4(e)}function N4(e){return e[0]}function S4(e){return e[1]}function A4(e,t){var r=Ar(!0),n=null,a=Yd,i=null,s=ex(o);e=typeof e=="function"?e:e===void 0?N4:Ar(e),t=typeof t=="function"?t:t===void 0?S4:Ar(t);function o(l){var c,f=(l=tx(l)).length,h,p=!1,d;for(n==null&&(i=a(d=s())),c=0;c<=f;++c)!(c<f&&r(h=l[c],c,l))===p&&((p=!p)?i.lineStart():i.lineEnd()),p&&i.point(+e(h,c,l),+t(h,c,l));if(d)return i=null,d+""||null}return o.x=function(l){return arguments.length?(e=typeof l=="function"?l:Ar(+l),o):e},o.y=function(l){return arguments.length?(t=typeof l=="function"?l:Ar(+l),o):t},o.defined=function(l){return arguments.length?(r=typeof l=="function"?l:Ar(!!l),o):r},o.curve=function(l){return arguments.length?(a=l,n!=null&&(i=a(n)),o):a},o.context=function(l){return arguments.length?(l==null?n=i=null:i=a(n=l),o):n},o}function G0(e,t,r){var n=null,a=Ar(!0),i=null,s=Yd,o=null,l=ex(c);e=typeof e=="function"?e:e===void 0?N4:Ar(+e),t=typeof t=="function"?t:Ar(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?S4:Ar(+r);function c(h){var p,d,x,g=(h=tx(h)).length,y,b=!1,T,S=new Array(g),k=new Array(g);for(i==null&&(o=s(T=l())),p=0;p<=g;++p){if(!(p<g&&a(y=h[p],p,h))===b)if(b=!b)d=p,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),x=p-1;x>=d;--x)o.point(S[x],k[x]);o.lineEnd(),o.areaEnd()}b&&(S[p]=+e(y,p,h),k[p]=+t(y,p,h),o.point(n?+n(y,p,h):S[p],r?+r(y,p,h):k[p]))}if(T)return o=null,T+""||null}function f(){return A4().defined(a).curve(s).context(i)}return c.x=function(h){return arguments.length?(e=typeof h=="function"?h:Ar(+h),n=null,c):e},c.x0=function(h){return arguments.length?(e=typeof h=="function"?h:Ar(+h),c):e},c.x1=function(h){return arguments.length?(n=h==null?null:typeof h=="function"?h:Ar(+h),c):n},c.y=function(h){return arguments.length?(t=typeof h=="function"?h:Ar(+h),r=null,c):t},c.y0=function(h){return arguments.length?(t=typeof h=="function"?h:Ar(+h),c):t},c.y1=function(h){return arguments.length?(r=h==null?null:typeof h=="function"?h:Ar(+h),c):r},c.lineX0=c.lineY0=function(){return f().x(e).y(t)},c.lineY1=function(){return f().x(e).y(r)},c.lineX1=function(){return f().x(n).y(t)},c.defined=function(h){return arguments.length?(a=typeof h=="function"?h:Ar(!!h),c):a},c.curve=function(h){return arguments.length?(s=h,i!=null&&(o=s(i)),c):s},c.context=function(h){return arguments.length?(h==null?i=o=null:o=s(i=h),c):i},c}class E4{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function hP(e){return new E4(e,!0)}function dP(e){return new E4(e,!1)}const rx={draw(e,t){const r=Mi(t/Dh);e.moveTo(r,0),e.arc(0,0,r,0,Kd)}},pP={draw(e,t){const r=Mi(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},T4=Mi(1/3),mP=T4*2,gP={draw(e,t){const r=Mi(t/mP),n=r*T4;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},xP={draw(e,t){const r=Mi(t),n=-r/2;e.rect(n,n,r,r)}},vP=.8908130915292852,j4=Fh(Dh/10)/Fh(7*Dh/10),yP=Fh(Kd/10)*j4,bP=-b4(Kd/10)*j4,wP={draw(e,t){const r=Mi(t*vP),n=yP*r,a=bP*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const s=Kd*i/5,o=b4(s),l=Fh(s);e.lineTo(l*r,-o*r),e.lineTo(o*n-l*a,l*n+o*a)}e.closePath()}},Am=Mi(3),_P={draw(e,t){const r=-Mi(t/(Am*3));e.moveTo(0,r*2),e.lineTo(-Am*r,-r),e.lineTo(Am*r,-r),e.closePath()}},ni=-.5,ai=Mi(3)/2,z1=1/Mi(12),NP=(z1/2+1)*3,SP={draw(e,t){const r=Mi(t/NP),n=r/2,a=r*z1,i=n,s=r*z1+r,o=-i,l=s;e.moveTo(n,a),e.lineTo(i,s),e.lineTo(o,l),e.lineTo(ni*n-ai*a,ai*n+ni*a),e.lineTo(ni*i-ai*s,ai*i+ni*s),e.lineTo(ni*o-ai*l,ai*o+ni*l),e.lineTo(ni*n+ai*a,ni*a-ai*n),e.lineTo(ni*i+ai*s,ni*s-ai*i),e.lineTo(ni*o+ai*l,ni*l-ai*o),e.closePath()}};function AP(e,t){let r=null,n=ex(a);e=typeof e=="function"?e:Ar(e||rx),t=typeof t=="function"?t:Ar(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:Ar(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:Ar(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function Ih(){}function Mh(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function P4(e){this._context=e}P4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Mh(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Mh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function EP(e){return new P4(e)}function k4(e){this._context=e}k4.prototype={areaStart:Ih,areaEnd:Ih,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Mh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function TP(e){return new k4(e)}function C4(e){this._context=e}C4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:Mh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function jP(e){return new C4(e)}function O4(e){this._context=e}O4.prototype={areaStart:Ih,areaEnd:Ih,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function PP(e){return new O4(e)}function wy(e){return e<0?-1:1}function _y(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),s=(r-e._y1)/(a||n<0&&-0),o=(i*a+s*n)/(n+a);return(wy(i)+wy(s))*Math.min(Math.abs(i),Math.abs(s),.5*Math.abs(o))||0}function Ny(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Em(e,t,r){var n=e._x0,a=e._y0,i=e._x1,s=e._y1,o=(i-n)/3;e._context.bezierCurveTo(n+o,a+o*t,i-o,s-o*r,i,s)}function Rh(e){this._context=e}Rh.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Em(this,this._t0,Ny(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Em(this,Ny(this,r=_y(this,e,t)),r);break;default:Em(this,this._t0,r=_y(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function L4(e){this._context=new F4(e)}(L4.prototype=Object.create(Rh.prototype)).point=function(e,t){Rh.prototype.point.call(this,t,e)};function F4(e){this._context=e}F4.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function kP(e){return new Rh(e)}function CP(e){return new L4(e)}function D4(e){this._context=e}D4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=Sy(e),a=Sy(t),i=0,s=1;s<r;++i,++s)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[s],t[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function Sy(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),s=new Array(r);for(a[0]=0,i[0]=2,s[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,s[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,s[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,s[t]-=n*s[t-1];for(a[r-1]=s[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(s[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function OP(e){return new D4(e)}function Xd(e,t){this._context=e,this._t=t}Xd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function LP(e){return new Xd(e,.5)}function FP(e){return new Xd(e,0)}function DP(e){return new Xd(e,1)}function zc(e,t){if((s=e.length)>1)for(var r=1,n,a,i=e[t[0]],s,o=i.length;r<s;++r)for(a=i,i=e[t[r]],n=0;n<o;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function q1(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function IP(e,t){return e[t]}function MP(e){const t=[];return t.key=e,t}function RP(){var e=Ar([]),t=q1,r=zc,n=IP;function a(i){var s=Array.from(e.apply(this,arguments),MP),o,l=s.length,c=-1,f;for(const h of i)for(o=0,++c;o<l;++o)(s[o][c]=[0,+n(h,s[o].key,c,i)]).data=h;for(o=0,f=tx(t(s));o<l;++o)s[f[o]].index=o;return r(s,f),s}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:Ar(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:Ar(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?q1:typeof i=="function"?i:Ar(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??zc,a):r},a}function BP(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,s;a<i;++a){for(s=r=0;r<n;++r)s+=e[r][a][1]||0;if(s)for(r=0;r<n;++r)e[r][a][1]/=s}zc(e,t)}}function UP(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var s=0,o=0;s<a;++s)o+=e[s][r][1]||0;n[r][1]+=n[r][0]=-o/2}zc(e,t)}}function $P(e,t){if(!(!((s=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,s;n<i;++n){for(var o=0,l=0,c=0;o<s;++o){for(var f=e[t[o]],h=f[n][1]||0,p=f[n-1][1]||0,d=(h-p)/2,x=0;x<o;++x){var g=e[t[x]],y=g[n][1]||0,b=g[n-1][1]||0;d+=y-b}l+=h,c+=d*h}a[n-1][1]+=a[n-1][0]=r,l&&(r-=c/l)}a[n-1][1]+=a[n-1][0]=r,zc(e,t)}}var zP=["type","size","sizeType"];function W1(){return W1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},W1.apply(null,arguments)}function Ay(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ey(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ay(Object(r),!0).forEach(function(n){qP(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ay(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qP(e,t,r){return(t=WP(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WP(e){var t=HP(e,"string");return typeof t=="symbol"?t:t+""}function HP(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function GP(e,t){if(e==null)return{};var r,n,a=VP(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function VP(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var I4={symbolCircle:rx,symbolCross:pP,symbolDiamond:gP,symbolSquare:xP,symbolStar:wP,symbolTriangle:_P,symbolWye:SP},KP=Math.PI/180,YP=e=>{var t="symbol".concat(Jf(e));return I4[t]||rx},XP=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*KP;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},ZP=(e,t)=>{I4["symbol".concat(Jf(e))]=t},M4=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,a=GP(e,zP),i=Ey(Ey({},a),{},{type:t,size:r,sizeType:n}),s=()=>{var h=YP(t),p=AP().type(h).size(XP(r,n,t));return p()},{className:o,cx:l,cy:c}=i,f=Ka(i,!0);return l===+l&&c===+c&&r===+r?U.createElement("path",W1({},f,{className:jn("recharts-symbols",o),transform:"translate(".concat(l,", ").concat(c,")"),d:s()})):null};M4.registerSymbol=ZP;var R4={},B4={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const a=new Map;for(let i=0;i<r.length;i++){const s=r[i],o=n(s);a.has(o)||a.set(o,s)}return Array.from(a.values())}e.uniqBy=t})(B4);var nx={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(nx);var U4={},ax={},$4={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})($4);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=$4;function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r})(ax);var z4={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(z4);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ax,r=z4;function n(a){return r.isObjectLike(a)&&t.isArrayLike(a)}e.isArrayLikeObject=n})(U4);var q4={},W4={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Dd;function r(n){return function(a){return t.get(a,n)}}e.property=r})(W4);var H4={},Tm={},jm={},ix={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(ix);var sx={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(sx);var Zd={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.eq=t})(Zd);var Ty;function JP(){return Ty||(Ty=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ox(),r=ix,n=sx,a=Zd;function i(h,p,d){return typeof d!="function"?t.isMatch(h,p):s(h,p,function x(g,y,b,T,S,k){const A=d(g,y,b,T,S,k);return A!==void 0?!!A:s(g,y,x,k)},new Map)}function s(h,p,d,x){if(p===h)return!0;switch(typeof p){case"object":return o(h,p,d,x);case"function":return Object.keys(p).length>0?s(h,{...p},d,x):a.eq(h,p);default:return r.isObject(h)?typeof p=="string"?p==="":!0:a.eq(h,p)}}function o(h,p,d,x){if(p==null)return!0;if(Array.isArray(p))return c(h,p,d,x);if(p instanceof Map)return l(h,p,d,x);if(p instanceof Set)return f(h,p,d,x);const g=Object.keys(p);if(h==null)return g.length===0;if(g.length===0)return!0;if(x&&x.has(p))return x.get(p)===h;x&&x.set(p,h);try{for(let y=0;y<g.length;y++){const b=g[y];if(!n.isPrimitive(h)&&!(b in h)||p[b]===void 0&&h[b]!==void 0||p[b]===null&&h[b]!==null||!d(h[b],p[b],b,h,p,x))return!1}return!0}finally{x&&x.delete(p)}}function l(h,p,d,x){if(p.size===0)return!0;if(!(h instanceof Map))return!1;for(const[g,y]of p.entries()){const b=h.get(g);if(d(b,y,g,h,p,x)===!1)return!1}return!0}function c(h,p,d,x){if(p.length===0)return!0;if(!Array.isArray(h))return!1;const g=new Set;for(let y=0;y<p.length;y++){const b=p[y];let T=!1;for(let S=0;S<h.length;S++){if(g.has(S))continue;const k=h[S];let A=!1;if(d(k,b,y,h,p,x)&&(A=!0),A){g.add(S),T=!0;break}}if(!T)return!1}return!0}function f(h,p,d,x){return p.size===0?!0:h instanceof Set?c([...h],[...p],d,x):!1}e.isMatchWith=i,e.isSetMatch=f}(jm)),jm}var jy;function ox(){return jy||(jy=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=JP();function r(n,a){return t.isMatchWith(n,a,()=>{})}e.isMatch=r}(Tm)),Tm}var G4={},lx={},cx={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t})(cx);var Jd={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(Jd);var Qd={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",a="[object Boolean]",i="[object Arguments]",s="[object Symbol]",o="[object Date]",l="[object Map]",c="[object Set]",f="[object Array]",h="[object Function]",p="[object ArrayBuffer]",d="[object Object]",x="[object Error]",g="[object DataView]",y="[object Uint8Array]",b="[object Uint8ClampedArray]",T="[object Uint16Array]",S="[object Uint32Array]",k="[object BigUint64Array]",A="[object Int8Array]",M="[object Int16Array]",O="[object Int32Array]",I="[object BigInt64Array]",j="[object Float32Array]",W="[object Float64Array]";e.argumentsTag=i,e.arrayBufferTag=p,e.arrayTag=f,e.bigInt64ArrayTag=I,e.bigUint64ArrayTag=k,e.booleanTag=a,e.dataViewTag=g,e.dateTag=o,e.errorTag=x,e.float32ArrayTag=j,e.float64ArrayTag=W,e.functionTag=h,e.int16ArrayTag=M,e.int32ArrayTag=O,e.int8ArrayTag=A,e.mapTag=l,e.numberTag=n,e.objectTag=d,e.regexpTag=t,e.setTag=c,e.stringTag=r,e.symbolTag=s,e.uint16ArrayTag=T,e.uint32ArrayTag=S,e.uint8ArrayTag=y,e.uint8ClampedArrayTag=b})(Qd);var V4={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(V4);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=cx,r=Jd,n=Qd,a=sx,i=V4;function s(f,h){return o(f,void 0,f,new Map,h)}function o(f,h,p,d=new Map,x=void 0){const g=x==null?void 0:x(f,h,p,d);if(g!==void 0)return g;if(a.isPrimitive(f))return f;if(d.has(f))return d.get(f);if(Array.isArray(f)){const y=new Array(f.length);d.set(f,y);for(let b=0;b<f.length;b++)y[b]=o(f[b],b,p,d,x);return Object.hasOwn(f,"index")&&(y.index=f.index),Object.hasOwn(f,"input")&&(y.input=f.input),y}if(f instanceof Date)return new Date(f.getTime());if(f instanceof RegExp){const y=new RegExp(f.source,f.flags);return y.lastIndex=f.lastIndex,y}if(f instanceof Map){const y=new Map;d.set(f,y);for(const[b,T]of f)y.set(b,o(T,b,p,d,x));return y}if(f instanceof Set){const y=new Set;d.set(f,y);for(const b of f)y.add(o(b,void 0,p,d,x));return y}if(typeof Buffer<"u"&&Buffer.isBuffer(f))return f.subarray();if(i.isTypedArray(f)){const y=new(Object.getPrototypeOf(f)).constructor(f.length);d.set(f,y);for(let b=0;b<f.length;b++)y[b]=o(f[b],b,p,d,x);return y}if(f instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&f instanceof SharedArrayBuffer)return f.slice(0);if(f instanceof DataView){const y=new DataView(f.buffer.slice(0),f.byteOffset,f.byteLength);return d.set(f,y),l(y,f,p,d,x),y}if(typeof File<"u"&&f instanceof File){const y=new File([f],f.name,{type:f.type});return d.set(f,y),l(y,f,p,d,x),y}if(f instanceof Blob){const y=new Blob([f],{type:f.type});return d.set(f,y),l(y,f,p,d,x),y}if(f instanceof Error){const y=new f.constructor;return d.set(f,y),y.message=f.message,y.name=f.name,y.stack=f.stack,y.cause=f.cause,l(y,f,p,d,x),y}if(typeof f=="object"&&c(f)){const y=Object.create(Object.getPrototypeOf(f));return d.set(f,y),l(y,f,p,d,x),y}return f}function l(f,h,p=f,d,x){const g=[...Object.keys(h),...t.getSymbols(h)];for(let y=0;y<g.length;y++){const b=g[y],T=Object.getOwnPropertyDescriptor(f,b);(T==null||T.writable)&&(f[b]=o(h[b],b,p,d,x))}}function c(f){switch(r.getTag(f)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=s,e.cloneDeepWithImpl=o,e.copyProperties=l})(lx);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=lx;function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r})(G4);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ox(),r=G4;function n(a){return a=r.cloneDeep(a),i=>t.isMatch(i,a)}e.matches=n})(H4);var K4={},Y4={},X4={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=lx,r=Qd;function n(a,i){return t.cloneDeepWith(a,(s,o,l,c)=>{const f=i==null?void 0:i(s,o,l,c);if(f!==void 0)return f;if(typeof a=="object")switch(Object.prototype.toString.call(a)){case r.numberTag:case r.stringTag:case r.booleanTag:{const h=new a.constructor(a==null?void 0:a.valueOf());return t.copyProperties(h,a),h}case r.argumentsTag:{const h={};return t.copyProperties(h,a),h.length=a.length,h[Symbol.iterator]=a[Symbol.iterator],h}default:return}})}e.cloneDeepWith=n})(X4);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=X4;function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r})(Y4);var Z4={},ux={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,a=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<a;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r})(ux);var J4={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Jd;function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r})(J4);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Yg,r=ux,n=J4,a=Id;function i(s,o){let l;if(Array.isArray(o)?l=o:typeof o=="string"&&t.isDeepKey(o)&&(s==null?void 0:s[o])==null?l=a.toPath(o):l=[o],l.length===0)return!1;let c=s;for(let f=0;f<l.length;f++){const h=l[f];if((c==null||!Object.hasOwn(c,h))&&!((Array.isArray(c)||n.isArguments(c))&&r.isIndex(h)&&h<c.length))return!1;c=c[h]}return!0}e.has=i})(Z4);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ox(),r=Xg,n=Y4,a=Dd,i=Z4;function s(o,l){switch(typeof o){case"object":{Object.is(o==null?void 0:o.valueOf(),-0)&&(o="-0");break}case"number":{o=r.toKey(o);break}}return l=n.cloneDeep(l),function(c){const f=a.get(c,o);return f===void 0?i.has(c,o):l===void 0?f===void 0:t.isMatch(f,l)}}e.matchesProperty=s})(K4);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=nx,r=W4,n=H4,a=K4;function i(s){if(s==null)return t.identity;switch(typeof s){case"function":return s;case"object":return Array.isArray(s)&&s.length===2?a.matchesProperty(s[0],s[1]):n.matches(s);case"string":case"symbol":case"number":return r.property(s)}}e.iteratee=i})(q4);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=B4,r=nx,n=U4,a=q4;function i(s,o=r.identity){return n.isArrayLikeObject(s)?t.uniqBy(Array.from(s),a.iteratee(o)):[]}e.uniqBy=i})(R4);var QP=R4.uniqBy;const Py=Do(QP);function ek(e,t,r){return t===!0?Py(e,r):typeof t=="function"?Py(e,t):e}var Q4={exports:{}},e3={},t3={exports:{}},r3={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qc=U;function tk(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var rk=typeof Object.is=="function"?Object.is:tk,nk=qc.useState,ak=qc.useEffect,ik=qc.useLayoutEffect,sk=qc.useDebugValue;function ok(e,t){var r=t(),n=nk({inst:{value:r,getSnapshot:t}}),a=n[0].inst,i=n[1];return ik(function(){a.value=r,a.getSnapshot=t,Pm(a)&&i({inst:a})},[e,r,t]),ak(function(){return Pm(a)&&i({inst:a}),e(function(){Pm(a)&&i({inst:a})})},[e]),sk(r),r}function Pm(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!rk(e,r)}catch{return!0}}function lk(e,t){return t()}var ck=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?lk:ok;r3.useSyncExternalStore=qc.useSyncExternalStore!==void 0?qc.useSyncExternalStore:ck;t3.exports=r3;var uk=t3.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ep=U,fk=uk;function hk(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var dk=typeof Object.is=="function"?Object.is:hk,pk=fk.useSyncExternalStore,mk=ep.useRef,gk=ep.useEffect,xk=ep.useMemo,vk=ep.useDebugValue;e3.useSyncExternalStoreWithSelector=function(e,t,r,n,a){var i=mk(null);if(i.current===null){var s={hasValue:!1,value:null};i.current=s}else s=i.current;i=xk(function(){function l(d){if(!c){if(c=!0,f=d,d=n(d),a!==void 0&&s.hasValue){var x=s.value;if(a(x,d))return h=x}return h=d}if(x=h,dk(f,d))return x;var g=n(d);return a!==void 0&&a(x,g)?(f=d,x):(f=d,h=g)}var c=!1,f,h,p=r===void 0?null:r;return[function(){return l(t())},p===null?void 0:function(){return l(p())}]},[t,r,n,a]);var o=pk(e,i[0],i[1]);return gk(function(){s.hasValue=!0,s.value=o},[o]),vk(o),o};Q4.exports=e3;var yk=Q4.exports,fx=U.createContext(null),bk=e=>e,ta=()=>{var e=U.useContext(fx);return e?e.store.dispatch:bk},Sh=()=>{},wk=()=>Sh,_k=(e,t)=>e===t;function qt(e){var t=U.useContext(fx);return yk.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:wk,t?t.store.getState:Sh,t?t.store.getState:Sh,t?e:Sh,_k)}function Nk(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function Sk(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function Ak(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var ky=e=>Array.isArray(e)?e:[e];function Ek(e){const t=Array.isArray(e[0])?e[0]:e;return Ak(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function Tk(e,t){const r=[],{length:n}=e;for(let a=0;a<n;a++)r.push(e[a].apply(null,t));return r}var jk=class{constructor(e){this.value=e}deref(){return this.value}},Pk=typeof WeakRef<"u"?WeakRef:jk,kk=0,Cy=1;function V0(){return{s:kk,v:void 0,o:null,p:null}}function n3(e,t={}){let r=V0();const{resultEqualityCheck:n}=t;let a,i=0;function s(){var h;let o=r;const{length:l}=arguments;for(let p=0,d=l;p<d;p++){const x=arguments[p];if(typeof x=="function"||typeof x=="object"&&x!==null){let g=o.o;g===null&&(o.o=g=new WeakMap);const y=g.get(x);y===void 0?(o=V0(),g.set(x,o)):o=y}else{let g=o.p;g===null&&(o.p=g=new Map);const y=g.get(x);y===void 0?(o=V0(),g.set(x,o)):o=y}}const c=o;let f;if(o.s===Cy)f=o.v;else if(f=e.apply(null,arguments),i++,n){const p=((h=a==null?void 0:a.deref)==null?void 0:h.call(a))??a;p!=null&&n(p,f)&&(f=p,i!==0&&i--),a=typeof f=="object"&&f!==null||typeof f=="function"?new Pk(f):f}return c.s=Cy,c.v=f,f}return s.clearCache=()=>{r=V0(),s.resetResultsCount()},s.resultsCount=()=>i,s.resetResultsCount=()=>{i=0},s}function Ck(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...a)=>{let i=0,s=0,o,l={},c=a.pop();typeof c=="object"&&(l=c,c=a.pop()),Nk(c,`createSelector expects an output function after the inputs, but received: [${typeof c}]`);const f={...r,...l},{memoize:h,memoizeOptions:p=[],argsMemoize:d=n3,argsMemoizeOptions:x=[],devModeChecks:g={}}=f,y=ky(p),b=ky(x),T=Ek(a),S=h(function(){return i++,c.apply(null,arguments)},...y),k=d(function(){s++;const M=Tk(T,arguments);return o=S.apply(null,M),o},...b);return Object.assign(k,{resultFunc:c,memoizedResultFunc:S,dependencies:T,dependencyRecomputations:()=>s,resetDependencyRecomputations:()=>{s=0},lastResult:()=>o,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:h,argsMemoize:d})};return Object.assign(n,{withTypes:()=>n}),n}var Ce=Ck(n3),Ok=Object.assign((e,t=Ce)=>{Sk(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(i=>e[i]);return t(n,(...i)=>i.reduce((s,o,l)=>(s[r[l]]=o,s),{}))},{withTypes:()=>Ok}),a3={},i3={},s3={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,a,i)=>{if(n!==a){const s=t(n),o=t(a);if(s===o&&s===0){if(n<a)return i==="desc"?1:-1;if(n>a)return i==="desc"?-1:1}return i==="desc"?o-s:s-o}return 0};e.compareValues=r})(s3);var o3={},hx={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(hx);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=hx,r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(i,s){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||t.isSymbol(i)?!0:typeof i=="string"&&(n.test(i)||!r.test(i))||s!=null&&Object.hasOwn(s,i)}e.isKey=a})(o3);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=s3,r=o3,n=Id;function a(i,s,o,l){if(i==null)return[];o=l?void 0:o,Array.isArray(i)||(i=Object.values(i)),Array.isArray(s)||(s=s==null?[null]:[s]),s.length===0&&(s=[null]),Array.isArray(o)||(o=o==null?[]:[o]),o=o.map(d=>String(d));const c=(d,x)=>{let g=d;for(let y=0;y<x.length&&g!=null;++y)g=g[x[y]];return g},f=(d,x)=>x==null||d==null?x:typeof d=="object"&&"key"in d?Object.hasOwn(x,d.key)?x[d.key]:c(x,d.path):typeof d=="function"?d(x):Array.isArray(d)?c(x,d):typeof x=="object"?x[d]:x,h=s.map(d=>(Array.isArray(d)&&d.length===1&&(d=d[0]),d==null||typeof d=="function"||Array.isArray(d)||r.isKey(d)?d:{key:d,path:n.toPath(d)}));return i.map(d=>({original:d,criteria:h.map(x=>f(x,d))})).slice().sort((d,x)=>{for(let g=0;g<h.length;g++){const y=t.compareValues(d.criteria[g],x.criteria[g],o[g]);if(y!==0)return y}return 0}).map(d=>d.original)}e.orderBy=a})(i3);var l3={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const a=[],i=Math.floor(n),s=(o,l)=>{for(let c=0;c<o.length;c++){const f=o[c];Array.isArray(f)&&l<i?s(f,l+1):a.push(f)}};return s(r,0),a}e.flatten=t})(l3);var dx={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=ux,r=ax,n=ix,a=Zd;function i(s,o,l){return n.isObject(l)&&(typeof o=="number"&&r.isArrayLike(l)&&t.isIndex(o)&&o<l.length||typeof o=="string"&&o in l)?a.eq(l[o],s):!1}e.isIterateeCall=i})(dx);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=i3,r=l3,n=dx;function a(i,...s){const o=s.length;return o>1&&n.isIterateeCall(i,s[0],s[1])?s=[]:o>2&&n.isIterateeCall(s[0],s[1],s[2])&&(s=[s[0]]),t.orderBy(i,r.flatten(s),["asc"])}e.sortBy=a})(a3);var Lk=a3.sortBy;const tp=Do(Lk);var c3=e=>e.legend.settings,Fk=e=>e.legend.size,Dk=e=>e.legend.payload;Ce([Dk,c3],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?tp(n,r):n});var K0=1;function Ik(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=U.useState({height:0,left:0,top:0,width:0}),n=U.useCallback(a=>{if(a!=null){var i=a.getBoundingClientRect(),s={height:i.height,left:i.left,top:i.top,width:i.width};(Math.abs(s.height-t.height)>K0||Math.abs(s.left-t.left)>K0||Math.abs(s.top-t.top)>K0||Math.abs(s.width-t.width)>K0)&&r({height:s.height,left:s.left,top:s.top,width:s.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function In(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Mk=typeof Symbol=="function"&&Symbol.observable||"@@observable",Oy=Mk,km=()=>Math.random().toString(36).substring(7).split("").join("."),Rk={INIT:`@@redux/INIT${km()}`,REPLACE:`@@redux/REPLACE${km()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${km()}`},Bh=Rk;function px(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function u3(e,t,r){if(typeof e!="function")throw new Error(In(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(In(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(In(1));return r(u3)(e,t)}let n=e,a=t,i=new Map,s=i,o=0,l=!1;function c(){s===i&&(s=new Map,i.forEach((y,b)=>{s.set(b,y)}))}function f(){if(l)throw new Error(In(3));return a}function h(y){if(typeof y!="function")throw new Error(In(4));if(l)throw new Error(In(5));let b=!0;c();const T=o++;return s.set(T,y),function(){if(b){if(l)throw new Error(In(6));b=!1,c(),s.delete(T),i=null}}}function p(y){if(!px(y))throw new Error(In(7));if(typeof y.type>"u")throw new Error(In(8));if(typeof y.type!="string")throw new Error(In(17));if(l)throw new Error(In(9));try{l=!0,a=n(a,y)}finally{l=!1}return(i=s).forEach(T=>{T()}),y}function d(y){if(typeof y!="function")throw new Error(In(10));n=y,p({type:Bh.REPLACE})}function x(){const y=h;return{subscribe(b){if(typeof b!="object"||b===null)throw new Error(In(11));function T(){const k=b;k.next&&k.next(f())}return T(),{unsubscribe:y(T)}},[Oy](){return this}}}return p({type:Bh.INIT}),{dispatch:p,subscribe:h,getState:f,replaceReducer:d,[Oy]:x}}function Bk(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:Bh.INIT})>"u")throw new Error(In(12));if(typeof r(void 0,{type:Bh.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(In(13))})}function f3(e){const t=Object.keys(e),r={};for(let i=0;i<t.length;i++){const s=t[i];typeof e[s]=="function"&&(r[s]=e[s])}const n=Object.keys(r);let a;try{Bk(r)}catch(i){a=i}return function(s={},o){if(a)throw a;let l=!1;const c={};for(let f=0;f<n.length;f++){const h=n[f],p=r[h],d=s[h],x=p(d,o);if(typeof x>"u")throw o&&o.type,new Error(In(14));c[h]=x,l=l||x!==d}return l=l||n.length!==Object.keys(s).length,l?c:s}}function Uh(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function Uk(...e){return t=>(r,n)=>{const a=t(r,n);let i=()=>{throw new Error(In(15))};const s={getState:a.getState,dispatch:(l,...c)=>i(l,...c)},o=e.map(l=>l(s));return i=Uh(...o)(a.dispatch),{...a,dispatch:i}}}function h3(e){return px(e)&&"type"in e&&typeof e.type=="string"}var d3=Symbol.for("immer-nothing"),Ly=Symbol.for("immer-draftable"),Ya=Symbol.for("immer-state");function Pi(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Wc=Object.getPrototypeOf;function Tl(e){return!!e&&!!e[Ya]}function Is(e){var t;return e?p3(e)||Array.isArray(e)||!!e[Ly]||!!((t=e.constructor)!=null&&t[Ly])||np(e)||ap(e):!1}var $k=Object.prototype.constructor.toString();function p3(e){if(!e||typeof e!="object")return!1;const t=Wc(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===$k}function $h(e,t){rp(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function rp(e){const t=e[Ya];return t?t.type_:Array.isArray(e)?1:np(e)?2:ap(e)?3:0}function H1(e,t){return rp(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function m3(e,t,r){const n=rp(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function zk(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function np(e){return e instanceof Map}function ap(e){return e instanceof Set}function tl(e){return e.copy_||e.base_}function G1(e,t){if(np(e))return new Map(e);if(ap(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=p3(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[Ya];let a=Reflect.ownKeys(n);for(let i=0;i<a.length;i++){const s=a[i],o=n[s];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(n[s]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[s]})}return Object.create(Wc(e),n)}else{const n=Wc(e);if(n!==null&&r)return{...e};const a=Object.create(n);return Object.assign(a,e)}}function mx(e,t=!1){return ip(e)||Tl(e)||!Is(e)||(rp(e)>1&&(e.set=e.add=e.clear=e.delete=qk),Object.freeze(e),t&&Object.entries(e).forEach(([r,n])=>mx(n,!0))),e}function qk(){Pi(2)}function ip(e){return Object.isFrozen(e)}var Wk={};function jl(e){const t=Wk[e];return t||Pi(0,e),t}var Ef;function g3(){return Ef}function Hk(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Fy(e,t){t&&(jl("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function V1(e){K1(e),e.drafts_.forEach(Gk),e.drafts_=null}function K1(e){e===Ef&&(Ef=e.parent_)}function Dy(e){return Ef=Hk(Ef,e)}function Gk(e){const t=e[Ya];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function Iy(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[Ya].modified_&&(V1(t),Pi(4)),Is(e)&&(e=zh(t,e),t.parent_||qh(t,e)),t.patches_&&jl("Patches").generateReplacementPatches_(r[Ya].base_,e,t.patches_,t.inversePatches_)):e=zh(t,r,[]),V1(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==d3?e:void 0}function zh(e,t,r){if(ip(t))return t;const n=t[Ya];if(!n)return $h(t,(a,i)=>My(e,n,t,a,i,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return qh(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const a=n.copy_;let i=a,s=!1;n.type_===3&&(i=new Set(a),a.clear(),s=!0),$h(i,(o,l)=>My(e,n,a,o,l,r,s)),qh(e,a,!1),r&&e.patches_&&jl("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function My(e,t,r,n,a,i,s){if(Tl(a)){const o=i&&t&&t.type_!==3&&!H1(t.assigned_,n)?i.concat(n):void 0,l=zh(e,a,o);if(m3(r,n,l),Tl(l))e.canAutoFreeze_=!1;else return}else s&&r.add(a);if(Is(a)&&!ip(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;zh(e,a),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&qh(e,a)}}function qh(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&mx(t,r)}function Vk(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:g3(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,i=gx;r&&(a=[n],i=Tf);const{revoke:s,proxy:o}=Proxy.revocable(a,i);return n.draft_=o,n.revoke_=s,o}var gx={get(e,t){if(t===Ya)return e;const r=tl(e);if(!H1(r,t))return Kk(e,r,t);const n=r[t];return e.finalized_||!Is(n)?n:n===Cm(e.base_,t)?(Om(e),e.copy_[t]=X1(n,e)):n},has(e,t){return t in tl(e)},ownKeys(e){return Reflect.ownKeys(tl(e))},set(e,t,r){const n=x3(tl(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=Cm(tl(e),t),i=a==null?void 0:a[Ya];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(zk(r,a)&&(r!==void 0||H1(e.base_,t)))return!0;Om(e),Y1(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return Cm(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Om(e),Y1(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=tl(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){Pi(11)},getPrototypeOf(e){return Wc(e.base_)},setPrototypeOf(){Pi(12)}},Tf={};$h(gx,(e,t)=>{Tf[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Tf.deleteProperty=function(e,t){return Tf.set.call(this,e,t,void 0)};Tf.set=function(e,t,r){return gx.set.call(this,e[0],t,r,e[0])};function Cm(e,t){const r=e[Ya];return(r?tl(r):e)[t]}function Kk(e,t,r){var a;const n=x3(t,r);return n?"value"in n?n.value:(a=n.get)==null?void 0:a.call(e.draft_):void 0}function x3(e,t){if(!(t in e))return;let r=Wc(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Wc(r)}}function Y1(e){e.modified_||(e.modified_=!0,e.parent_&&Y1(e.parent_))}function Om(e){e.copy_||(e.copy_=G1(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var Yk=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const i=r;r=t;const s=this;return function(l=i,...c){return s.produce(l,f=>r.call(this,f,...c))}}typeof r!="function"&&Pi(6),n!==void 0&&typeof n!="function"&&Pi(7);let a;if(Is(t)){const i=Dy(this),s=X1(t,void 0);let o=!0;try{a=r(s),o=!1}finally{o?V1(i):K1(i)}return Fy(i,n),Iy(a,i)}else if(!t||typeof t!="object"){if(a=r(t),a===void 0&&(a=t),a===d3&&(a=void 0),this.autoFreeze_&&mx(a,!0),n){const i=[],s=[];jl("Patches").generateReplacementPatches_(t,a,i,s),n(i,s)}return a}else Pi(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(s,...o)=>this.produceWithPatches(s,l=>t(l,...o));let n,a;return[this.produce(t,r,(s,o)=>{n=s,a=o}),n,a]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Is(e)||Pi(8),Tl(e)&&(e=ks(e));const t=Dy(this),r=X1(e,void 0);return r[Ya].isManual_=!0,K1(t),r}finishDraft(e,t){const r=e&&e[Ya];(!r||!r.isManual_)&&Pi(9);const{scope_:n}=r;return Fy(n,t),Iy(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const a=t[r];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}r>-1&&(t=t.slice(r+1));const n=jl("Patches").applyPatches_;return Tl(e)?n(e,t):this.produce(e,a=>n(a,t))}};function X1(e,t){const r=np(e)?jl("MapSet").proxyMap_(e,t):ap(e)?jl("MapSet").proxySet_(e,t):Vk(e,t);return(t?t.scope_:g3()).drafts_.push(r),r}function ks(e){return Tl(e)||Pi(10,e),v3(e)}function v3(e){if(!Is(e)||ip(e))return e;const t=e[Ya];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=G1(e,t.scope_.immer_.useStrictShallowCopy_)}else r=G1(e,!0);return $h(r,(n,a)=>{m3(r,n,v3(a))}),t&&(t.finalized_=!1),r}var Xa=new Yk,y3=Xa.produce;Xa.produceWithPatches.bind(Xa);Xa.setAutoFreeze.bind(Xa);Xa.setUseStrictShallowCopy.bind(Xa);Xa.applyPatches.bind(Xa);Xa.createDraft.bind(Xa);Xa.finishDraft.bind(Xa);function b3(e){return({dispatch:r,getState:n})=>a=>i=>typeof i=="function"?i(r,n,e):a(i)}var Xk=b3(),Zk=b3,Jk=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Uh:Uh.apply(null,arguments)};function hi(e,t){function r(...n){if(t){let a=t(...n);if(!a)throw new Error(Va(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>h3(n)&&n.type===e,r}var w3=class sf extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,sf.prototype)}static get[Symbol.species](){return sf}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new sf(...t[0].concat(this)):new sf(...t.concat(this))}};function Ry(e){return Is(e)?y3(e,()=>{}):e}function Y0(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function Qk(e){return typeof e=="boolean"}var eC=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:i=!0}=t??{};let s=new w3;return r&&(Qk(r)?s.push(Xk):s.push(Zk(r.extraArgument))),s},tC="RTK_autoBatch",By=e=>t=>{setTimeout(t,e)},rC=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let a=!0,i=!1,s=!1;const o=new Set,l=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:By(10):e.type==="callback"?e.queueNotification:By(e.timeout),c=()=>{s=!1,i&&(i=!1,o.forEach(f=>f()))};return Object.assign({},n,{subscribe(f){const h=()=>a&&f(),p=n.subscribe(h);return o.add(f),()=>{p(),o.delete(f)}},dispatch(f){var h;try{return a=!((h=f==null?void 0:f.meta)!=null&&h[tC]),i=!a,i&&(s||(s=!0,l(c))),n.dispatch(f)}finally{a=!0}}})},nC=e=>function(r){const{autoBatch:n=!0}=r??{};let a=new w3(e);return n&&a.push(rC(typeof n=="object"?n:void 0)),a};function aC(e){const t=eC(),{reducer:r=void 0,middleware:n,devTools:a=!0,duplicateMiddlewareCheck:i=!0,preloadedState:s=void 0,enhancers:o=void 0}=e||{};let l;if(typeof r=="function")l=r;else if(px(r))l=f3(r);else throw new Error(Va(1));let c;typeof n=="function"?c=n(t):c=t();let f=Uh;a&&(f=Jk({trace:!1,...typeof a=="object"&&a}));const h=Uk(...c),p=nC(h);let d=typeof o=="function"?o(p):p();const x=f(...d);return u3(l,s,x)}function _3(e){const t={},r=[];let n;const a={addCase(i,s){const o=typeof i=="string"?i:i.type;if(!o)throw new Error(Va(28));if(o in t)throw new Error(Va(29));return t[o]=s,a},addMatcher(i,s){return r.push({matcher:i,reducer:s}),a},addDefaultCase(i){return n=i,a}};return e(a),[t,r,n]}function iC(e){return typeof e=="function"}function sC(e,t){let[r,n,a]=_3(t),i;if(iC(e))i=()=>Ry(e());else{const o=Ry(e);i=()=>o}function s(o=i(),l){let c=[r[l.type],...n.filter(({matcher:f})=>f(l)).map(({reducer:f})=>f)];return c.filter(f=>!!f).length===0&&(c=[a]),c.reduce((f,h)=>{if(h)if(Tl(f)){const d=h(f,l);return d===void 0?f:d}else{if(Is(f))return y3(f,p=>h(p,l));{const p=h(f,l);if(p===void 0){if(f===null)return f;throw Error("A case reducer on a non-draftable value must not return undefined")}return p}}return f},o)}return s.getInitialState=i,s}var oC="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",lC=(e=21)=>{let t="",r=e;for(;r--;)t+=oC[Math.random()*64|0];return t},cC=Symbol.for("rtk-slice-createasyncthunk");function uC(e,t){return`${e}/${t}`}function fC({creators:e}={}){var r;const t=(r=e==null?void 0:e.asyncThunk)==null?void 0:r[cC];return function(a){const{name:i,reducerPath:s=i}=a;if(!i)throw new Error(Va(11));typeof process<"u";const o=(typeof a.reducers=="function"?a.reducers(dC()):a.reducers)||{},l=Object.keys(o),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},f={addCase(k,A){const M=typeof k=="string"?k:k.type;if(!M)throw new Error(Va(12));if(M in c.sliceCaseReducersByType)throw new Error(Va(13));return c.sliceCaseReducersByType[M]=A,f},addMatcher(k,A){return c.sliceMatchers.push({matcher:k,reducer:A}),f},exposeAction(k,A){return c.actionCreators[k]=A,f},exposeCaseReducer(k,A){return c.sliceCaseReducersByName[k]=A,f}};l.forEach(k=>{const A=o[k],M={reducerName:k,type:uC(i,k),createNotation:typeof a.reducers=="function"};mC(A)?xC(M,A,f,t):pC(M,A,f)});function h(){const[k={},A=[],M=void 0]=typeof a.extraReducers=="function"?_3(a.extraReducers):[a.extraReducers],O={...k,...c.sliceCaseReducersByType};return sC(a.initialState,I=>{for(let j in O)I.addCase(j,O[j]);for(let j of c.sliceMatchers)I.addMatcher(j.matcher,j.reducer);for(let j of A)I.addMatcher(j.matcher,j.reducer);M&&I.addDefaultCase(M)})}const p=k=>k,d=new Map,x=new WeakMap;let g;function y(k,A){return g||(g=h()),g(k,A)}function b(){return g||(g=h()),g.getInitialState()}function T(k,A=!1){function M(I){let j=I[k];return typeof j>"u"&&A&&(j=Y0(x,M,b)),j}function O(I=p){const j=Y0(d,A,()=>new WeakMap);return Y0(j,I,()=>{const W={};for(const[E,C]of Object.entries(a.selectors??{}))W[E]=hC(C,I,()=>Y0(x,I,b),A);return W})}return{reducerPath:k,getSelectors:O,get selectors(){return O(M)},selectSlice:M}}const S={name:i,reducer:y,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:b,...T(s),injectInto(k,{reducerPath:A,...M}={}){const O=A??s;return k.inject({reducerPath:O,reducer:y},M),{...S,...T(O,!0)}}};return S}}function hC(e,t,r,n){function a(i,...s){let o=t(i);return typeof o>"u"&&n&&(o=r()),e(o,...s)}return a.unwrapped=e,a}var Ja=fC();function dC(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function pC({type:e,reducerName:t,createNotation:r},n,a){let i,s;if("reducer"in n){if(r&&!gC(n))throw new Error(Va(17));i=n.reducer,s=n.prepare}else i=n;a.addCase(e,i).exposeCaseReducer(t,i).exposeAction(t,s?hi(e,s):hi(e))}function mC(e){return e._reducerDefinitionType==="asyncThunk"}function gC(e){return e._reducerDefinitionType==="reducerWithPrepare"}function xC({type:e,reducerName:t},r,n,a){if(!a)throw new Error(Va(18));const{payloadCreator:i,fulfilled:s,pending:o,rejected:l,settled:c,options:f}=r,h=a(e,i,f);n.exposeAction(t,h),s&&n.addCase(h.fulfilled,s),o&&n.addCase(h.pending,o),l&&n.addCase(h.rejected,l),c&&n.addMatcher(h.settled,c),n.exposeCaseReducer(t,{fulfilled:s||X0,pending:o||X0,rejected:l||X0,settled:c||X0})}function X0(){}var vC="task",N3="listener",S3="completed",xx="cancelled",yC=`task-${xx}`,bC=`task-${S3}`,Z1=`${N3}-${xx}`,wC=`${N3}-${S3}`,sp=class{constructor(e){rr(this,"name","TaskAbortError");rr(this,"message");this.code=e,this.message=`${vC} ${xx} (reason: ${e})`}},vx=(e,t)=>{if(typeof e!="function")throw new TypeError(Va(32))},Wh=()=>{},A3=(e,t=Wh)=>(e.catch(t),e),E3=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),vl=(e,t)=>{const r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},yl=e=>{if(e.aborted){const{reason:t}=e;throw new sp(t)}};function T3(e,t){let r=Wh;return new Promise((n,a)=>{const i=()=>a(new sp(e.reason));if(e.aborted){i();return}r=E3(e,i),t.finally(()=>r()).then(n,a)}).finally(()=>{r=Wh})}var _C=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof sp?"cancelled":"rejected",error:r}}finally{t==null||t()}},Hh=e=>t=>A3(T3(e,t).then(r=>(yl(e),r))),j3=e=>{const t=Hh(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:Ec}=Object,Uy={},op="listenerMiddleware",NC=(e,t)=>{const r=n=>E3(e,()=>vl(n,e.reason));return(n,a)=>{vx(n);const i=new AbortController;r(i);const s=_C(async()=>{yl(e),yl(i.signal);const o=await n({pause:Hh(i.signal),delay:j3(i.signal),signal:i.signal});return yl(i.signal),o},()=>vl(i,bC));return a!=null&&a.autoJoin&&t.push(s.catch(Wh)),{result:Hh(e)(s),cancel(){vl(i,yC)}}}},SC=(e,t)=>{const r=async(n,a)=>{yl(t);let i=()=>{};const o=[new Promise((l,c)=>{let f=e({predicate:n,effect:(h,p)=>{p.unsubscribe(),l([h,p.getState(),p.getOriginalState()])}});i=()=>{f(),c()}})];a!=null&&o.push(new Promise(l=>setTimeout(l,a,null)));try{const l=await T3(t,Promise.race(o));return yl(t),l}finally{i()}};return(n,a)=>A3(r(n,a))},P3=e=>{let{type:t,actionCreator:r,matcher:n,predicate:a,effect:i}=e;if(t)a=hi(t).match;else if(r)t=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(Va(21));return vx(i),{predicate:a,type:t,effect:i}},k3=Ec(e=>{const{type:t,predicate:r,effect:n}=P3(e);return{id:lC(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Va(22))}}},{withTypes:()=>k3}),$y=(e,t)=>{const{type:r,effect:n,predicate:a}=P3(t);return Array.from(e.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===a)&&i.effect===n)},J1=e=>{e.pending.forEach(t=>{vl(t,Z1)})},AC=e=>()=>{e.forEach(J1),e.clear()},zy=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},C3=Ec(hi(`${op}/add`),{withTypes:()=>C3}),EC=hi(`${op}/removeAll`),O3=Ec(hi(`${op}/remove`),{withTypes:()=>O3}),TC=(...e)=>{console.error(`${op}/error`,...e)},Qf=(e={})=>{const t=new Map,{extra:r,onError:n=TC}=e;vx(n);const a=f=>(f.unsubscribe=()=>t.delete(f.id),t.set(f.id,f),h=>{f.unsubscribe(),h!=null&&h.cancelActive&&J1(f)}),i=f=>{const h=$y(t,f)??k3(f);return a(h)};Ec(i,{withTypes:()=>i});const s=f=>{const h=$y(t,f);return h&&(h.unsubscribe(),f.cancelActive&&J1(h)),!!h};Ec(s,{withTypes:()=>s});const o=async(f,h,p,d)=>{const x=new AbortController,g=SC(i,x.signal),y=[];try{f.pending.add(x),await Promise.resolve(f.effect(h,Ec({},p,{getOriginalState:d,condition:(b,T)=>g(b,T).then(Boolean),take:g,delay:j3(x.signal),pause:Hh(x.signal),extra:r,signal:x.signal,fork:NC(x.signal,y),unsubscribe:f.unsubscribe,subscribe:()=>{t.set(f.id,f)},cancelActiveListeners:()=>{f.pending.forEach((b,T,S)=>{b!==x&&(vl(b,Z1),S.delete(b))})},cancel:()=>{vl(x,Z1),f.pending.delete(x)},throwIfCancelled:()=>{yl(x.signal)}})))}catch(b){b instanceof sp||zy(n,b,{raisedBy:"effect"})}finally{await Promise.all(y),vl(x,wC),f.pending.delete(x)}},l=AC(t);return{middleware:f=>h=>p=>{if(!h3(p))return h(p);if(C3.match(p))return i(p.payload);if(EC.match(p)){l();return}if(O3.match(p))return s(p.payload);let d=f.getState();const x=()=>{if(d===Uy)throw new Error(Va(23));return d};let g;try{if(g=h(p),t.size>0){const y=f.getState(),b=Array.from(t.values());for(const T of b){let S=!1;try{S=T.predicate(p,y,d)}catch(k){S=!1,zy(n,k,{raisedBy:"predicate"})}S&&o(T,p,f,x)}}}finally{d=Uy}return g},startListening:i,stopListening:s,clearListeners:l}};function Va(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var jC={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},L3=Ja({name:"chartLayout",initialState:jC,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){e.margin.top=t.payload.top,e.margin.right=t.payload.right,e.margin.bottom=t.payload.bottom,e.margin.left=t.payload.left},setScale(e,t){e.scale=t.payload}}}),{setMargin:PC,setLayout:kC,setChartSize:CC,setScale:OC}=L3.actions,LC=L3.reducer;function qy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Wy(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qy(Object(r),!0).forEach(function(n){FC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function FC(e,t,r){return(t=DC(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DC(e){var t=IC(e,"string");return typeof t=="symbol"?t:t+""}function IC(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Gh=Math.PI/180,MC=e=>e*180/Math.PI,Jn=(e,t,r,n)=>({x:e+Math.cos(-Gh*n)*r,y:t+Math.sin(-Gh*n)*r}),F3=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0,width:0,height:0,brushBottom:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},RC=(e,t)=>{var{x:r,y:n}=e,{x:a,y:i}=t;return Math.sqrt((r-a)**2+(n-i)**2)},BC=(e,t)=>{var{x:r,y:n}=e,{cx:a,cy:i}=t,s=RC({x:r,y:n},{x:a,y:i});if(s<=0)return{radius:s,angle:0};var o=(r-a)/s,l=Math.acos(o);return n>i&&(l=2*Math.PI-l),{radius:s,angle:MC(l),angleInRadian:l}},UC=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),a=Math.floor(r/360),i=Math.min(n,a);return{startAngle:t-i*360,endAngle:r-i*360}},$C=(e,t)=>{var{startAngle:r,endAngle:n}=t,a=Math.floor(r/360),i=Math.floor(n/360),s=Math.min(a,i);return e+s*360},zC=(e,t)=>{var{x:r,y:n}=e,{radius:a,angle:i}=BC({x:r,y:n},t),{innerRadius:s,outerRadius:o}=t;if(a<s||a>o||a===0)return null;var{startAngle:l,endAngle:c}=UC(t),f=i,h;if(l<=c){for(;f>c;)f-=360;for(;f<l;)f+=360;h=f>=l&&f<=c}else{for(;f>l;)f-=360;for(;f<c;)f+=360;h=f>=c&&f<=l}return h?Wy(Wy({},t),{},{radius:a,angle:$C(f,t)}):null};function D3(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function Hy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ci(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Hy(Object(r),!0).forEach(function(n){qC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qC(e,t,r){return(t=WC(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function WC(e){var t=HC(e,"string");return typeof t=="symbol"?t:t+""}function HC(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function sn(e,t,r){return El(e)||El(t)?r:Ds(t)?Uc(e,t,r):typeof t=="function"?t(e):r}var GC=(e,t,r,n,a)=>{var i,s=-1,o=(i=t==null?void 0:t.length)!==null&&i!==void 0?i:0;if(o<=1||e==null)return 0;if(n==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var l=0;l<o;l++){var c=l>0?r[l-1].coordinate:r[o-1].coordinate,f=r[l].coordinate,h=l>=o-1?r[0].coordinate:r[l+1].coordinate,p=void 0;if(Wa(f-c)!==Wa(h-f)){var d=[];if(Wa(h-f)===Wa(a[1]-a[0])){p=h;var x=f+a[1]-a[0];d[0]=Math.min(x,(x+c)/2),d[1]=Math.max(x,(x+c)/2)}else{p=c;var g=h+a[1]-a[0];d[0]=Math.min(f,(g+f)/2),d[1]=Math.max(f,(g+f)/2)}var y=[Math.min(f,(p+f)/2),Math.max(f,(p+f)/2)];if(e>y[0]&&e<=y[1]||e>=d[0]&&e<=d[1]){({index:s}=r[l]);break}}else{var b=Math.min(c,h),T=Math.max(c,h);if(e>(b+f)/2&&e<=(T+f)/2){({index:s}=r[l]);break}}}else if(t){for(var S=0;S<o;S++)if(S===0&&e<=(t[S].coordinate+t[S+1].coordinate)/2||S>0&&S<o-1&&e>(t[S].coordinate+t[S-1].coordinate)/2&&e<=(t[S].coordinate+t[S+1].coordinate)/2||S===o-1&&e>(t[S].coordinate+t[S-1].coordinate)/2){({index:s}=t[S]);break}}return s},VC=(e,t,r)=>{if(t&&r){var{width:n,height:a}=r,{align:i,verticalAlign:s,layout:o}=t;if((o==="vertical"||o==="horizontal"&&s==="middle")&&i!=="center"&&Vt(e[i]))return ci(ci({},e),{},{[i]:e[i]+(n||0)});if((o==="horizontal"||o==="vertical"&&i==="center")&&s!=="middle"&&Vt(e[s]))return ci(ci({},e),{},{[s]:e[s]+(a||0)})}return e},Il=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",Gy=1e-4,KC=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,n=e.range(),a=Math.min(n[0],n[1])-Gy,i=Math.max(n[0],n[1])+Gy,s=e(t[0]),o=e(t[r-1]);(s<a||s>i||o<a||o>i)&&e.domain([t[0],t[r-1]])}},YC=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,i=0,s=0;s<t;++s){var o=Fi(e[s][r][1])?e[s][r][0]:e[s][r][1];o>=0?(e[s][r][0]=a,e[s][r][1]=a+o,a=e[s][r][1]):(e[s][r][0]=i,e[s][r][1]=i+o,i=e[s][r][1])}},XC=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,i=0;i<t;++i){var s=Fi(e[i][r][1])?e[i][r][0]:e[i][r][1];s>=0?(e[i][r][0]=a,e[i][r][1]=a+s,a=e[i][r][1]):(e[i][r][0]=0,e[i][r][1]=0)}},ZC={sign:YC,expand:BP,none:zc,silhouette:UP,wiggle:$P,positive:XC},JC=(e,t,r)=>{var n=ZC[r],a=RP().keys(t).value((i,s)=>+sn(i,s,0)).order(q1).offset(n);return a(e)},QC=e=>{var t=e.flat(2).filter(Vt);return[Math.min(...t),Math.max(...t)]},eO=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],tO=(e,t,r)=>{if(e!=null)return eO(Object.keys(e).reduce((n,a)=>{var i=e[a],{stackedData:s}=i,o=s.reduce((l,c)=>{var f=D3(c,t,r),h=QC(f);return[Math.min(l[0],h[0]),Math.max(l[1],h[1])]},[1/0,-1/0]);return[Math.min(o[0],n[0]),Math.max(o[1],n[1])]},[1/0,-1/0]))},Vy=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Ky=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,rO=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();return n}if(e&&t&&t.length>=2){for(var a=tp(t,f=>f.coordinate),i=1/0,s=1,o=a.length;s<o;s++){var l=a[s],c=a[s-1];i=Math.min((l.coordinate||0)-(c.coordinate||0),i)}return i===1/0?0:i}return 0};function Yy(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:a,name:i}=e;return ci(ci({},t),{},{dataKey:r,payload:n,value:a,name:i})}function I3(e,t){if(e)return String(e);if(typeof t=="string")return t}function nO(e,t,r,n,a){if(r==="horizontal"||r==="vertical"){var i=e>=a.left&&e<=a.left+a.width&&t>=a.top&&t<=a.top+a.height;return i?{x:e,y:t}:null}return n?zC({x:e,y:t},n):null}var aO=(e,t,r,n)=>{var a=t.find(c=>c&&c.index===r);if(a){if(e==="horizontal")return{x:a.coordinate,y:n.y};if(e==="vertical")return{x:n.x,y:a.coordinate};if(e==="centric"){var i=a.coordinate,{radius:s}=n;return ci(ci(ci({},n),Jn(n.cx,n.cy,s,i)),{},{angle:i,radius:s})}var o=a.coordinate,{angle:l}=n;return ci(ci(ci({},n),Jn(n.cx,n.cy,o,l)),{},{angle:l,radius:o})}return{x:0,y:0}},iO=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius,qs=e=>e.layout.width,Ws=e=>e.layout.height,sO=e=>e.layout.scale,M3=e=>e.layout.margin,yx=Ce(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),bx=Ce(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),R3="data-recharts-item-index",B3="data-recharts-item-data-key",lp=60;function Xy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function lo(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Xy(Object(r),!0).forEach(function(n){oO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Xy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function oO(e,t,r){return(t=lO(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lO(e){var t=cO(e,"string");return typeof t=="symbol"?t:t+""}function cO(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uO=e=>e.brush.height,ra=Ce([qs,Ws,M3,uO,yx,bx,c3,Fk],(e,t,r,n,a,i,s,o)=>{var l=i.reduce((x,g)=>{var{orientation:y}=g;if(!g.mirror&&!g.hide){var b=typeof g.width=="number"?g.width:lp;return lo(lo({},x),{},{[y]:x[y]+b})}return x},{left:r.left||0,right:r.right||0}),c=a.reduce((x,g)=>{var{orientation:y}=g;return!g.mirror&&!g.hide?lo(lo({},x),{},{[y]:Uc(x,"".concat(y))+g.height}):x},{top:r.top||0,bottom:r.bottom||0}),f=lo(lo({},c),l),h=f.bottom;f.bottom+=n,f=VC(f,s,o);var p=e-f.left-f.right,d=t-f.top-f.bottom;return lo(lo({brushBottom:h},f),{},{width:Math.max(p,0),height:Math.max(d,0)})}),fO=Ce(ra,e=>({x:e.left,y:e.top,width:e.width,height:e.height}));Ce(qs,Ws,(e,t)=>({x:0,y:0,width:e,height:t}));var hO=U.createContext(null),Qc=()=>U.useContext(hO)!=null,cp=e=>e.brush,up=Ce([cp,ra,M3],(e,t,r)=>({height:e.height,x:Vt(e.x)?e.x:t.left,y:Vt(e.y)?e.y:t.top+t.height+t.brushBottom-((r==null?void 0:r.bottom)||0),width:Vt(e.width)?e.width:t.width})),U3=()=>{var e,t=Qc(),r=qt(fO),n=qt(up),a=(e=qt(cp))===null||e===void 0?void 0:e.padding;return!t||!n||!a?r:{width:n.width-a.left-a.right,height:n.height-a.top-a.bottom,x:a.left,y:a.top}},dO={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},pO=()=>{var e;return(e=qt(ra))!==null&&e!==void 0?e:dO},mO=()=>qt(qs),gO=()=>qt(Ws),Er=e=>e.layout.layoutType,$3=()=>qt(Er),xO={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},z3=Ja({name:"legend",initialState:xO,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload(e,t){e.payload.push(t.payload)},removeLegendPayload(e,t){var r=ks(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)}}}),{setLegendSize:pJ,setLegendSettings:mJ,addLegendPayload:vO,removeLegendPayload:yO}=z3.actions,bO=z3.reducer;function Q1(){return Q1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Q1.apply(null,arguments)}function Zy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Lm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Zy(Object(r),!0).forEach(function(n){wO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wO(e,t,r){return(t=_O(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _O(e){var t=NO(e,"string");return typeof t=="symbol"?t:t+""}function NO(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function SO(e){return Array.isArray(e)&&Ds(e[0])&&Ds(e[1])?e.join(" ~ "):e}var AO=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:n={},labelStyle:a={},payload:i,formatter:s,itemSorter:o,wrapperClassName:l,labelClassName:c,label:f,labelFormatter:h,accessibilityLayer:p=!1}=e,d=()=>{if(i&&i.length){var A={padding:0,margin:0},M=(o?tp(i,o):i).map((O,I)=>{if(O.type==="none")return null;var j=O.formatter||s||SO,{value:W,name:E}=O,C=W,G=E;if(j){var Z=j(W,E,O,I,i);if(Array.isArray(Z))[C,G]=Z;else if(Z!=null)C=Z;else return null}var he=Lm({display:"block",paddingTop:4,paddingBottom:4,color:O.color||"#000"},n);return U.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(I),style:he},Ds(G)?U.createElement("span",{className:"recharts-tooltip-item-name"},G):null,Ds(G)?U.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,U.createElement("span",{className:"recharts-tooltip-item-value"},C),U.createElement("span",{className:"recharts-tooltip-item-unit"},O.unit||""))});return U.createElement("ul",{className:"recharts-tooltip-item-list",style:A},M)}return null},x=Lm({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),g=Lm({margin:0},a),y=!El(f),b=y?f:"",T=jn("recharts-default-tooltip",l),S=jn("recharts-tooltip-label",c);y&&h&&i!==void 0&&i!==null&&(b=h(f,i));var k=p?{role:"status","aria-live":"assertive"}:{};return U.createElement("div",Q1({className:T,style:x},k),U.createElement("p",{className:S,style:g},U.isValidElement(b)?b:"".concat(b)),d())},Hu="recharts-tooltip-wrapper",EO={visibility:"hidden"};function TO(e){var{coordinate:t,translateX:r,translateY:n}=e;return jn(Hu,{["".concat(Hu,"-right")]:Vt(r)&&t&&Vt(t.x)&&r>=t.x,["".concat(Hu,"-left")]:Vt(r)&&t&&Vt(t.x)&&r<t.x,["".concat(Hu,"-bottom")]:Vt(n)&&t&&Vt(t.y)&&n>=t.y,["".concat(Hu,"-top")]:Vt(n)&&t&&Vt(t.y)&&n<t.y})}function Jy(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offsetTopLeft:a,position:i,reverseDirection:s,tooltipDimension:o,viewBox:l,viewBoxDimension:c}=e;if(i&&Vt(i[n]))return i[n];var f=r[n]-o-(a>0?a:0),h=r[n]+a;if(t[n])return s[n]?f:h;var p=l[n];if(p==null)return 0;if(s[n]){var d=f,x=p;return d<x?Math.max(h,p):Math.max(f,p)}if(c==null)return 0;var g=h+o,y=p+c;return g>y?Math.max(f,p):Math.max(h,p)}function jO(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function PO(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:n,position:a,reverseDirection:i,tooltipBox:s,useTranslate3d:o,viewBox:l}=e,c,f,h;return s.height>0&&s.width>0&&r?(f=Jy({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.width,viewBox:l,viewBoxDimension:l.width}),h=Jy({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.height,viewBox:l,viewBoxDimension:l.height}),c=jO({translateX:f,translateY:h,useTranslate3d:o})):c=EO,{cssProperties:c,cssClasses:TO({translateX:f,translateY:h,coordinate:r})}}function Qy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Z0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Qy(Object(r),!0).forEach(function(n){eg(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function eg(e,t,r){return(t=kO(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function kO(e){var t=CO(e,"string");return typeof t=="symbol"?t:t+""}function CO(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class OO extends U.PureComponent{constructor(){super(...arguments),eg(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),eg(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,a,i;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(a=(i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:a,children:i,coordinate:s,hasPayload:o,isAnimationActive:l,offset:c,position:f,reverseDirection:h,useTranslate3d:p,viewBox:d,wrapperStyle:x,lastBoundingBox:g,innerRef:y,hasPortalFromProps:b}=this.props,{cssClasses:T,cssProperties:S}=PO({allowEscapeViewBox:r,coordinate:s,offsetTopLeft:c,position:f,reverseDirection:h,tooltipBox:{height:g.height,width:g.width},useTranslate3d:p,viewBox:d}),k=b?{}:Z0(Z0({transition:l&&t?"transform ".concat(n,"ms ").concat(a):void 0},S),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&o?"visible":"hidden",position:"absolute",top:0,left:0}),A=Z0(Z0({},k),{},{visibility:!this.state.dismissed&&t&&o?"visible":"hidden"},x);return U.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:T,style:A,ref:y},i)}}var LO=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),fp={isSsr:LO()},q3=()=>qt(e=>e.rootProps.accessibilityLayer);function Di(e){return Number.isFinite(e)}function Vh(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function tg(){return tg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},tg.apply(null,arguments)}function eb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function tb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eb(Object(r),!0).forEach(function(n){FO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function FO(e,t,r){return(t=DO(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function DO(e){var t=IO(e,"string");return typeof t=="symbol"?t:t+""}function IO(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rb={curveBasisClosed:TP,curveBasisOpen:jP,curveBasis:EP,curveBumpX:hP,curveBumpY:dP,curveLinearClosed:PP,curveLinear:Yd,curveMonotoneX:kP,curveMonotoneY:CP,curveNatural:OP,curveStep:LP,curveStepAfter:DP,curveStepBefore:FP},J0=e=>Di(e.x)&&Di(e.y),Gu=e=>e.x,Vu=e=>e.y,MO=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(Jf(e));return(r==="curveMonotone"||r==="curveBump")&&t?rb["".concat(r).concat(t==="vertical"?"Y":"X")]:rb[r]||Yd},RO=e=>{var{type:t="linear",points:r=[],baseLine:n,layout:a,connectNulls:i=!1}=e,s=MO(t,a),o=i?r.filter(J0):r,l;if(Array.isArray(n)){var c=i?n.filter(h=>J0(h)):n,f=o.map((h,p)=>tb(tb({},h),{},{base:c[p]}));return a==="vertical"?l=G0().y(Vu).x1(Gu).x0(h=>h.base.x):l=G0().x(Gu).y1(Vu).y0(h=>h.base.y),l.defined(J0).curve(s),l(f)}return a==="vertical"&&Vt(n)?l=G0().y(Vu).x1(Gu).x0(n):Vt(n)?l=G0().x(Gu).y1(Vu).y0(n):l=A4().x(Gu).y(Vu),l.defined(J0).curve(s),l(o)},W3=e=>{var{className:t,points:r,path:n,pathRef:a}=e;if((!r||!r.length)&&!n)return null;var i=r&&r.length?RO(e):n;return U.createElement("path",tg({},Vd(e),Zj(e),{className:jn("recharts-curve",t),d:i===null?void 0:i,ref:a}))},BO=["x","y","top","left","width","height","className"];function rg(){return rg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},rg.apply(null,arguments)}function nb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function UO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?nb(Object(r),!0).forEach(function(n){$O(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $O(e,t,r){return(t=zO(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zO(e){var t=qO(e,"string");return typeof t=="symbol"?t:t+""}function qO(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function WO(e,t){if(e==null)return{};var r,n,a=HO(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function HO(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var GO=(e,t,r,n,a,i)=>"M".concat(e,",").concat(a,"v").concat(n,"M").concat(i,",").concat(t,"h").concat(r),VO=e=>{var{x:t=0,y:r=0,top:n=0,left:a=0,width:i=0,height:s=0,className:o}=e,l=WO(e,BO),c=UO({x:t,y:r,top:n,left:a,width:i,height:s},l);return!Vt(t)||!Vt(r)||!Vt(i)||!Vt(s)||!Vt(n)||!Vt(a)?null:U.createElement("path",rg({},Ka(c,!0),{className:jn("recharts-cross",o),d:GO(t,r,i,s,n,a)}))};function KO(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function ab(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function YO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ab(Object(r),!0).forEach(function(n){XO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ab(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XO(e,t,r){return(t=ZO(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ZO(e){var t=JO(e,"string");return typeof t=="symbol"?t:t+""}function JO(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Io(e,t){var r=YO({},e),n=t,a=Object.keys(t),i=a.reduce((s,o)=>(s[o]===void 0&&n[o]!==void 0&&(s[o]=n[o]),s),r);return i}var H3={},G3={},V3={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(!r||typeof r!="object")return!1;const n=Object.getPrototypeOf(r);return n===null||n===Object.prototype||Object.getPrototypeOf(n)===null?Object.prototype.toString.call(r)==="[object Object]":!1}e.isPlainObject=t})(V3);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=V3,r=cx,n=Jd,a=Qd,i=Zd;function s(c,f,h){return o(c,f,void 0,void 0,void 0,void 0,h)}function o(c,f,h,p,d,x,g){const y=g(c,f,h,p,d,x);if(y!==void 0)return y;if(typeof c==typeof f)switch(typeof c){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return c===f;case"number":return c===f||Object.is(c,f);case"function":return c===f;case"object":return l(c,f,x,g)}return l(c,f,x,g)}function l(c,f,h,p){if(Object.is(c,f))return!0;let d=n.getTag(c),x=n.getTag(f);if(d===a.argumentsTag&&(d=a.objectTag),x===a.argumentsTag&&(x=a.objectTag),d!==x)return!1;switch(d){case a.stringTag:return c.toString()===f.toString();case a.numberTag:{const b=c.valueOf(),T=f.valueOf();return i.eq(b,T)}case a.booleanTag:case a.dateTag:case a.symbolTag:return Object.is(c.valueOf(),f.valueOf());case a.regexpTag:return c.source===f.source&&c.flags===f.flags;case a.functionTag:return c===f}h=h??new Map;const g=h.get(c),y=h.get(f);if(g!=null&&y!=null)return g===f;h.set(c,f),h.set(f,c);try{switch(d){case a.mapTag:{if(c.size!==f.size)return!1;for(const[b,T]of c.entries())if(!f.has(b)||!o(T,f.get(b),b,c,f,h,p))return!1;return!0}case a.setTag:{if(c.size!==f.size)return!1;const b=Array.from(c.values()),T=Array.from(f.values());for(let S=0;S<b.length;S++){const k=b[S],A=T.findIndex(M=>o(k,M,void 0,c,f,h,p));if(A===-1)return!1;T.splice(A,1)}return!0}case a.arrayTag:case a.uint8ArrayTag:case a.uint8ClampedArrayTag:case a.uint16ArrayTag:case a.uint32ArrayTag:case a.bigUint64ArrayTag:case a.int8ArrayTag:case a.int16ArrayTag:case a.int32ArrayTag:case a.bigInt64ArrayTag:case a.float32ArrayTag:case a.float64ArrayTag:{if(typeof Buffer<"u"&&Buffer.isBuffer(c)!==Buffer.isBuffer(f)||c.length!==f.length)return!1;for(let b=0;b<c.length;b++)if(!o(c[b],f[b],b,c,f,h,p))return!1;return!0}case a.arrayBufferTag:return c.byteLength!==f.byteLength?!1:l(new Uint8Array(c),new Uint8Array(f),h,p);case a.dataViewTag:return c.byteLength!==f.byteLength||c.byteOffset!==f.byteOffset?!1:l(new Uint8Array(c),new Uint8Array(f),h,p);case a.errorTag:return c.name===f.name&&c.message===f.message;case a.objectTag:{if(!(l(c.constructor,f.constructor,h,p)||t.isPlainObject(c)&&t.isPlainObject(f)))return!1;const T=[...Object.keys(c),...r.getSymbols(c)],S=[...Object.keys(f),...r.getSymbols(f)];if(T.length!==S.length)return!1;for(let k=0;k<T.length;k++){const A=T[k],M=c[A];if(!Object.hasOwn(f,A))return!1;const O=f[A];if(!o(M,O,A,c,f,h,p))return!1}return!0}default:return!1}}finally{h.delete(c),h.delete(f)}}e.isEqualWith=s})(G3);var K3={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(){}e.noop=t})(K3);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=G3,r=K3;function n(a,i){return t.isEqualWith(a,i,r.noop)}e.isEqual=n})(H3);var QO=H3.isEqual;const e7=Do(QO);var Kh=1e-4,Y3=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],X3=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),ib=(e,t)=>r=>{var n=Y3(e,t);return X3(n,r)},t7=(e,t)=>r=>{var n=Y3(e,t),a=[...n.map((i,s)=>i*s).slice(1),0];return X3(a,r)},sb=function(){for(var t,r,n,a,i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];if(s.length===1)switch(s[0]){case"linear":[t,n,r,a]=[0,0,1,1];break;case"ease":[t,n,r,a]=[.25,.1,.25,1];break;case"ease-in":[t,n,r,a]=[.42,0,1,1];break;case"ease-out":[t,n,r,a]=[.42,0,.58,1];break;case"ease-in-out":[t,n,r,a]=[0,0,.58,1];break;default:{var l=s[0].split("(");l[0]==="cubic-bezier"&&l[1].split(")")[0].split(",").length===4&&([t,n,r,a]=l[1].split(")")[0].split(",").map(x=>parseFloat(x)))}}else s.length===4&&([t,n,r,a]=s);var c=ib(t,r),f=ib(n,a),h=t7(t,r),p=x=>x>1?1:x<0?0:x,d=x=>{for(var g=x>1?1:x,y=g,b=0;b<8;++b){var T=c(y)-g,S=h(y);if(Math.abs(T-g)<Kh||S<Kh)return f(y);y=p(y-T/S)}return f(y)};return d.isStepper=!1,d},r7=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:a=17}=t,i=(s,o,l)=>{var c=-(s-o)*r,f=l*n,h=l+(c-f)*a/1e3,p=l*a/1e3+s;return Math.abs(p-o)<Kh&&Math.abs(h)<Kh?[o,0]:[p,h]};return i.isStepper=!0,i.dt=a,i},Z3=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return sb(e);case"spring":return r7();default:if(e.split("(")[0]==="cubic-bezier")return sb(e)}return typeof e=="function"?e:null};function ob(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function lb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ob(Object(r),!0).forEach(function(n){n7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ob(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function n7(e,t,r){return(t=a7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a7(e){var t=i7(e,"string");return typeof t=="symbol"?t:t+""}function i7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var s7=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),o7=(e,t,r)=>e.map(n=>"".concat(s7(n)," ").concat(t,"ms ").concat(r)).join(","),l7=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(a=>n.includes(a))),jf=(e,t)=>Object.keys(t).reduce((r,n)=>lb(lb({},r),{},{[n]:e(n,t[n])}),{});function cb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Bn(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?cb(Object(r),!0).forEach(function(n){c7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function c7(e,t,r){return(t=u7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u7(e){var t=f7(e,"string");return typeof t=="symbol"?t:t+""}function f7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Yh=(e,t,r)=>e+(t-e)*r,ng=e=>{var{from:t,to:r}=e;return t!==r},J3=(e,t,r)=>{var n=jf((a,i)=>{if(ng(i)){var[s,o]=e(i.from,i.to,i.velocity);return Bn(Bn({},i),{},{from:s,velocity:o})}return i},t);return r<1?jf((a,i)=>ng(i)?Bn(Bn({},i),{},{velocity:Yh(i.velocity,n[a].velocity,r),from:Yh(i.from,n[a].from,r)}):i,t):J3(e,n,r-1)};function h7(e,t,r,n,a,i){var s,o=n.reduce((p,d)=>Bn(Bn({},p),{},{[d]:{from:e[d],velocity:0,to:t[d]}}),{}),l=()=>jf((p,d)=>d.from,o),c=()=>!Object.values(o).filter(ng).length,f=null,h=p=>{s||(s=p);var d=p-s,x=d/r.dt;o=J3(r,o,x),a(Bn(Bn(Bn({},e),t),l())),s=p,c()||(f=i.setTimeout(h))};return()=>(f=i.setTimeout(h),()=>{f()})}function d7(e,t,r,n,a,i,s){var o=null,l=a.reduce((h,p)=>Bn(Bn({},h),{},{[p]:[e[p],t[p]]}),{}),c,f=h=>{c||(c=h);var p=(h-c)/n,d=jf((g,y)=>Yh(...y,r(p)),l);if(i(Bn(Bn(Bn({},e),t),d)),p<1)o=s.setTimeout(f);else{var x=jf((g,y)=>Yh(...y,r(1)),l);i(Bn(Bn(Bn({},e),t),x))}};return()=>(o=s.setTimeout(f),()=>{o()})}const Q3=(e,t,r,n,a,i)=>{var s=l7(e,t);return r.isStepper===!0?h7(e,t,r,s,a,i):d7(e,t,r,n,s,a,i)};function p7(e){var t,r=()=>null,n=!1,a=null,i=s=>{if(!n){if(Array.isArray(s)){if(!s.length)return;var o=s,[l,...c]=o;if(typeof l=="number"){a=e.setTimeout(i.bind(null,c),l);return}i(l),a=e.setTimeout(i.bind(null,c));return}typeof s=="string"&&(t=s,r(t)),typeof s=="object"&&(t=s,r(t)),typeof s=="function"&&s()}};return{stop:()=>{n=!0},start:s=>{n=!1,a&&(a(),a=null),i(s)},subscribe:s=>(r=s,()=>{r=()=>null}),getTimeoutController:()=>e}}class m7{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),a=null,i=s=>{s-n>=r?t(s):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(i))};return a=requestAnimationFrame(i),()=>{cancelAnimationFrame(a)}}}function g7(){return p7(new m7)}var x7=U.createContext(g7);function eN(e,t){var r=U.useContext(x7);return U.useMemo(()=>t??r(e),[e,t,r])}var v7=["children","begin","duration","attributeName","easing","isActive","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart","animationManager"];function ag(){return ag=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ag.apply(null,arguments)}function y7(e,t){if(e==null)return{};var r,n,a=b7(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function b7(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function ub(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function co(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ub(Object(r),!0).forEach(function(n){ll(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ub(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ll(e,t,r){return(t=w7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function w7(e){var t=_7(e,"string");return typeof t=="symbol"?t:t+""}function _7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class wx extends U.PureComponent{constructor(t,r){super(t,r),ll(this,"mounted",!1),ll(this,"manager",void 0),ll(this,"stopJSAnimation",null),ll(this,"unSubscribe",null);var{isActive:n,attributeName:a,from:i,to:s,children:o,duration:l,animationManager:c}=this.props;if(this.manager=c,this.handleStyleChange=this.handleStyleChange.bind(this),this.changeStyle=this.changeStyle.bind(this),!n||l<=0){this.state={style:{}},typeof o=="function"&&(this.state={style:s});return}if(i){if(typeof o=="function"){this.state={style:i};return}this.state={style:a?{[a]:i}:i}}else this.state={style:{}}}componentDidMount(){var{isActive:t,canBegin:r}=this.props;this.mounted=!0,!(!t||!r)&&this.runAnimation(this.props)}componentDidUpdate(t){var{isActive:r,canBegin:n,attributeName:a,shouldReAnimate:i,to:s,from:o}=this.props,{style:l}=this.state;if(n){if(!r){var c={style:a?{[a]:s}:s};this.state&&l&&(a&&l[a]!==s||!a&&l!==s)&&this.setState(c);return}if(!(e7(t.to,s)&&t.canBegin&&t.isActive)){var f=!t.canBegin||!t.isActive;this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var h=f||i?o:t.to;if(this.state&&l){var p={style:a?{[a]:h}:h};(a&&l[a]!==h||!a&&l!==h)&&this.setState(p)}this.runAnimation(co(co({},this.props),{},{from:h,begin:0}))}}}componentWillUnmount(){this.mounted=!1;var{onAnimationEnd:t}=this.props;this.unSubscribe&&this.unSubscribe(),this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation(),t&&t()}handleStyleChange(t){this.changeStyle(t)}changeStyle(t){this.mounted&&this.setState({style:t})}runJSAnimation(t){var{from:r,to:n,duration:a,easing:i,begin:s,onAnimationEnd:o,onAnimationStart:l}=t,c=Q3(r,n,Z3(i),a,this.changeStyle,this.manager.getTimeoutController()),f=()=>{this.stopJSAnimation=c()};this.manager.start([l,s,f,a,o])}runAnimation(t){var{begin:r,duration:n,attributeName:a,to:i,easing:s,onAnimationStart:o,onAnimationEnd:l,children:c}=t;if(this.unSubscribe=this.manager.subscribe(this.handleStyleChange),typeof s=="function"||typeof c=="function"||s==="spring"){this.runJSAnimation(t);return}var f=a?{[a]:i}:i,h=o7(Object.keys(f),n,s);this.manager.start([o,r,co(co({},f),{},{transition:h}),n,l])}render(){var t=this.props,{children:r,begin:n,duration:a,attributeName:i,easing:s,isActive:o,from:l,to:c,canBegin:f,onAnimationEnd:h,shouldReAnimate:p,onAnimationReStart:d,animationManager:x}=t,g=y7(t,v7),y=U.Children.count(r),b=this.state.style;if(typeof r=="function")return r(b);if(!o||y===0||a<=0)return r;var T=S=>{var{style:k={},className:A}=S.props,M=U.cloneElement(S,co(co({},g),{},{style:co(co({},k),b),className:A}));return M};return y===1?T(U.Children.only(r)):U.createElement("div",null,U.Children.map(r,S=>T(S)))}}ll(wx,"displayName","Animate");ll(wx,"defaultProps",{begin:0,duration:1e3,attributeName:"",easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}});function Xh(e){var t,r=eN((t=e.attributeName)!==null&&t!==void 0?t:Object.keys(e.to).join(","),e.animationManager);return U.createElement(wx,ag({},e,{animationManager:r}))}function Zh(){return Zh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zh.apply(null,arguments)}var fb=(e,t,r,n,a)=>{var i=Math.min(Math.abs(r)/2,Math.abs(n)/2),s=n>=0?1:-1,o=r>=0?1:-1,l=n>=0&&r>=0||n<0&&r<0?1:0,c;if(i>0&&a instanceof Array){for(var f=[0,0,0,0],h=0,p=4;h<p;h++)f[h]=a[h]>i?i:a[h];c="M".concat(e,",").concat(t+s*f[0]),f[0]>0&&(c+="A ".concat(f[0],",").concat(f[0],",0,0,").concat(l,",").concat(e+o*f[0],",").concat(t)),c+="L ".concat(e+r-o*f[1],",").concat(t),f[1]>0&&(c+="A ".concat(f[1],",").concat(f[1],",0,0,").concat(l,`,
        `).concat(e+r,",").concat(t+s*f[1])),c+="L ".concat(e+r,",").concat(t+n-s*f[2]),f[2]>0&&(c+="A ".concat(f[2],",").concat(f[2],",0,0,").concat(l,`,
        `).concat(e+r-o*f[2],",").concat(t+n)),c+="L ".concat(e+o*f[3],",").concat(t+n),f[3]>0&&(c+="A ".concat(f[3],",").concat(f[3],",0,0,").concat(l,`,
        `).concat(e,",").concat(t+n-s*f[3])),c+="Z"}else if(i>0&&a===+a&&a>0){var d=Math.min(i,a);c="M ".concat(e,",").concat(t+s*d,`
            A `).concat(d,",").concat(d,",0,0,").concat(l,",").concat(e+o*d,",").concat(t,`
            L `).concat(e+r-o*d,",").concat(t,`
            A `).concat(d,",").concat(d,",0,0,").concat(l,",").concat(e+r,",").concat(t+s*d,`
            L `).concat(e+r,",").concat(t+n-s*d,`
            A `).concat(d,",").concat(d,",0,0,").concat(l,",").concat(e+r-o*d,",").concat(t+n,`
            L `).concat(e+o*d,",").concat(t+n,`
            A `).concat(d,",").concat(d,",0,0,").concat(l,",").concat(e,",").concat(t+n-s*d," Z")}else c="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return c},N7={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},tN=e=>{var t=Io(e,N7),r=U.useRef(null),[n,a]=U.useState(-1);U.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var b=r.current.getTotalLength();b&&a(b)}catch{}},[]);var{x:i,y:s,width:o,height:l,radius:c,className:f}=t,{animationEasing:h,animationDuration:p,animationBegin:d,isAnimationActive:x,isUpdateAnimationActive:g}=t;if(i!==+i||s!==+s||o!==+o||l!==+l||o===0||l===0)return null;var y=jn("recharts-rectangle",f);return g?U.createElement(Xh,{canBegin:n>0,from:{width:o,height:l,x:i,y:s},to:{width:o,height:l,x:i,y:s},duration:p,animationEasing:h,isActive:g},b=>{var{width:T,height:S,x:k,y:A}=b;return U.createElement(Xh,{canBegin:n>0,from:"0px ".concat(n===-1?1:n,"px"),to:"".concat(n,"px 0px"),attributeName:"strokeDasharray",begin:d,duration:p,isActive:x,easing:h},U.createElement("path",Zh({},Ka(t,!0),{className:y,d:fb(k,A,T,S,c),ref:r})))}):U.createElement("path",Zh({},Ka(t,!0),{className:y,d:fb(i,s,o,l,c)}))};function rN(e){var{cx:t,cy:r,radius:n,startAngle:a,endAngle:i}=e,s=Jn(t,r,n,a),o=Jn(t,r,n,i);return{points:[s,o],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}function ig(){return ig=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ig.apply(null,arguments)}var S7=(e,t)=>{var r=Wa(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},Q0=e=>{var{cx:t,cy:r,radius:n,angle:a,sign:i,isExternal:s,cornerRadius:o,cornerIsExternal:l}=e,c=o*(s?1:-1)+n,f=Math.asin(o/c)/Gh,h=l?a:a+i*f,p=Jn(t,r,c,h),d=Jn(t,r,n,h),x=l?a-i*f:a,g=Jn(t,r,c*Math.cos(f*Gh),x);return{center:p,circleTangency:d,lineTangency:g,theta:f}},nN=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:i,endAngle:s}=e,o=S7(i,s),l=i+o,c=Jn(t,r,a,i),f=Jn(t,r,a,l),h="M ".concat(c.x,",").concat(c.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(o)>180),",").concat(+(i>l),`,
    `).concat(f.x,",").concat(f.y,`
  `);if(n>0){var p=Jn(t,r,n,i),d=Jn(t,r,n,l);h+="L ".concat(d.x,",").concat(d.y,`
            A `).concat(n,",").concat(n,`,0,
            `).concat(+(Math.abs(o)>180),",").concat(+(i<=l),`,
            `).concat(p.x,",").concat(p.y," Z")}else h+="L ".concat(t,",").concat(r," Z");return h},A7=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,cornerRadius:i,forceCornerRadius:s,cornerIsExternal:o,startAngle:l,endAngle:c}=e,f=Wa(c-l),{circleTangency:h,lineTangency:p,theta:d}=Q0({cx:t,cy:r,radius:a,angle:l,sign:f,cornerRadius:i,cornerIsExternal:o}),{circleTangency:x,lineTangency:g,theta:y}=Q0({cx:t,cy:r,radius:a,angle:c,sign:-f,cornerRadius:i,cornerIsExternal:o}),b=o?Math.abs(l-c):Math.abs(l-c)-d-y;if(b<0)return s?"M ".concat(p.x,",").concat(p.y,`
        a`).concat(i,",").concat(i,",0,0,1,").concat(i*2,`,0
        a`).concat(i,",").concat(i,",0,0,1,").concat(-i*2,`,0
      `):nN({cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:l,endAngle:c});var T="M ".concat(p.x,",").concat(p.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(f<0),",").concat(h.x,",").concat(h.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(b>180),",").concat(+(f<0),",").concat(x.x,",").concat(x.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(f<0),",").concat(g.x,",").concat(g.y,`
  `);if(n>0){var{circleTangency:S,lineTangency:k,theta:A}=Q0({cx:t,cy:r,radius:n,angle:l,sign:f,isExternal:!0,cornerRadius:i,cornerIsExternal:o}),{circleTangency:M,lineTangency:O,theta:I}=Q0({cx:t,cy:r,radius:n,angle:c,sign:-f,isExternal:!0,cornerRadius:i,cornerIsExternal:o}),j=o?Math.abs(l-c):Math.abs(l-c)-A-I;if(j<0&&i===0)return"".concat(T,"L").concat(t,",").concat(r,"Z");T+="L".concat(O.x,",").concat(O.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(f<0),",").concat(M.x,",").concat(M.y,`
      A`).concat(n,",").concat(n,",0,").concat(+(j>180),",").concat(+(f>0),",").concat(S.x,",").concat(S.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(f<0),",").concat(k.x,",").concat(k.y,"Z")}else T+="L".concat(t,",").concat(r,"Z");return T},E7={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},aN=e=>{var t=Io(e,E7),{cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:s,forceCornerRadius:o,cornerIsExternal:l,startAngle:c,endAngle:f,className:h}=t;if(i<a||c===f)return null;var p=jn("recharts-sector",h),d=i-a,x=rs(s,d,0,!0),g;return x>0&&Math.abs(c-f)<360?g=A7({cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:Math.min(x,d/2),forceCornerRadius:o,cornerIsExternal:l,startAngle:c,endAngle:f}):g=nN({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:c,endAngle:f}),U.createElement("path",ig({},Ka(t,!0),{className:p,d:g}))};function T7(e,t,r){var n,a,i,s;if(e==="horizontal")n=t.x,i=n,a=r.top,s=r.top+r.height;else if(e==="vertical")a=t.y,s=a,n=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:o,cy:l,innerRadius:c,outerRadius:f,angle:h}=t,p=Jn(o,l,c,h),d=Jn(o,l,f,h);n=p.x,a=p.y,i=d.x,s=d.y}else return rN(t);return[{x:n,y:a},{x:i,y:s}]}var iN={},sN={},oN={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=hx;function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r})(oN);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=oN;function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r})(sN);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=dx,r=sN;function n(a,i,s){s&&typeof s!="number"&&t.isIterateeCall(a,i,s)&&(i=s=void 0),a=r.toFinite(a),i===void 0?(i=a,a=0):i=r.toFinite(i),s=s===void 0?a<i?1:-1:r.toFinite(s);const o=Math.max(Math.ceil((i-a)/(s||1)),0),l=new Array(o);for(let c=0;c<o;c++)l[c]=a,a+=s;return l}e.range=n})(iN);var j7=iN.range;const lN=Do(j7);function So(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function P7(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function _x(e){let t,r,n;e.length!==2?(t=So,r=(o,l)=>So(e(o),l),n=(o,l)=>e(o)-l):(t=e===So||e===P7?e:k7,r=e,n=e);function a(o,l,c=0,f=o.length){if(c<f){if(t(l,l)!==0)return f;do{const h=c+f>>>1;r(o[h],l)<0?c=h+1:f=h}while(c<f)}return c}function i(o,l,c=0,f=o.length){if(c<f){if(t(l,l)!==0)return f;do{const h=c+f>>>1;r(o[h],l)<=0?c=h+1:f=h}while(c<f)}return c}function s(o,l,c=0,f=o.length){const h=a(o,l,c,f-1);return h>c&&n(o[h-1],l)>-n(o[h],l)?h-1:h}return{left:a,center:s,right:i}}function k7(){return 0}function cN(e){return e===null?NaN:+e}function*C7(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const O7=_x(So),e0=O7.right;_x(cN).center;class hb extends Map{constructor(t,r=D7){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(db(this,t))}has(t){return super.has(db(this,t))}set(t,r){return super.set(L7(this,t),r)}delete(t){return super.delete(F7(this,t))}}function db({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function L7({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function F7({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function D7(e){return e!==null&&typeof e=="object"?e.valueOf():e}function I7(e=So){if(e===So)return uN;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function uN(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const M7=Math.sqrt(50),R7=Math.sqrt(10),B7=Math.sqrt(2);function Jh(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),s=i>=M7?10:i>=R7?5:i>=B7?2:1;let o,l,c;return a<0?(c=Math.pow(10,-a)/s,o=Math.round(e*c),l=Math.round(t*c),o/c<e&&++o,l/c>t&&--l,c=-c):(c=Math.pow(10,a)*s,o=Math.round(e/c),l=Math.round(t/c),o*c<e&&++o,l*c>t&&--l),l<o&&.5<=r&&r<2?Jh(e,t,r*2):[o,l,c]}function sg(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,s]=n?Jh(t,e,r):Jh(e,t,r);if(!(i>=a))return[];const o=i-a+1,l=new Array(o);if(n)if(s<0)for(let c=0;c<o;++c)l[c]=(i-c)/-s;else for(let c=0;c<o;++c)l[c]=(i-c)*s;else if(s<0)for(let c=0;c<o;++c)l[c]=(a+c)/-s;else for(let c=0;c<o;++c)l[c]=(a+c)*s;return l}function og(e,t,r){return t=+t,e=+e,r=+r,Jh(e,t,r)[2]}function lg(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?og(t,e,r):og(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function pb(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function mb(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function fN(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?uN:I7(a);n>r;){if(n-r>600){const l=n-r+1,c=t-r+1,f=Math.log(l),h=.5*Math.exp(2*f/3),p=.5*Math.sqrt(f*h*(l-h)/l)*(c-l/2<0?-1:1),d=Math.max(r,Math.floor(t-c*h/l+p)),x=Math.min(n,Math.floor(t+(l-c)*h/l+p));fN(e,t,d,x,a)}const i=e[t];let s=r,o=n;for(Ku(e,r,t),a(e[n],i)>0&&Ku(e,r,n);s<o;){for(Ku(e,s,o),++s,--o;a(e[s],i)<0;)++s;for(;a(e[o],i)>0;)--o}a(e[r],i)===0?Ku(e,r,o):(++o,Ku(e,o,n)),o<=t&&(r=o+1),t<=o&&(n=o-1)}return e}function Ku(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function U7(e,t,r){if(e=Float64Array.from(C7(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return mb(e);if(t>=1)return pb(e);var n,a=(n-1)*t,i=Math.floor(a),s=pb(fN(e,i).subarray(0,i+1)),o=mb(e.subarray(i+1));return s+(o-s)*(a-i)}}function $7(e,t,r=cN){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),s=+r(e[i],i,e),o=+r(e[i+1],i+1,e);return s+(o-s)*(a-i)}}function z7(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function gi(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Hs(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const cg=Symbol("implicit");function Nx(){var e=new hb,t=[],r=[],n=cg;function a(i){let s=e.get(i);if(s===void 0){if(n!==cg)return n;e.set(i,s=t.push(i)-1)}return r[s%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new hb;for(const s of i)e.has(s)||e.set(s,t.push(s)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return Nx(t,r).unknown(n)},gi.apply(a,arguments),a}function Sx(){var e=Nx().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,s,o=!1,l=0,c=0,f=.5;delete e.unknown;function h(){var p=t().length,d=a<n,x=d?a:n,g=d?n:a;i=(g-x)/Math.max(1,p-l+c*2),o&&(i=Math.floor(i)),x+=(g-x-i*(p-l))*f,s=i*(1-l),o&&(x=Math.round(x),s=Math.round(s));var y=z7(p).map(function(b){return x+i*b});return r(d?y.reverse():y)}return e.domain=function(p){return arguments.length?(t(p),h()):t()},e.range=function(p){return arguments.length?([n,a]=p,n=+n,a=+a,h()):[n,a]},e.rangeRound=function(p){return[n,a]=p,n=+n,a=+a,o=!0,h()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(p){return arguments.length?(o=!!p,h()):o},e.padding=function(p){return arguments.length?(l=Math.min(1,c=+p),h()):l},e.paddingInner=function(p){return arguments.length?(l=Math.min(1,p),h()):l},e.paddingOuter=function(p){return arguments.length?(c=+p,h()):c},e.align=function(p){return arguments.length?(f=Math.max(0,Math.min(1,p)),h()):f},e.copy=function(){return Sx(t(),[n,a]).round(o).paddingInner(l).paddingOuter(c).align(f)},gi.apply(h(),arguments)}function hN(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return hN(t())},e}function q7(){return hN(Sx.apply(null,arguments).paddingInner(1))}function Ax(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function dN(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function t0(){}var Pf=.7,Qh=1/Pf,Tc="\\s*([+-]?\\d+)\\s*",kf="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ns="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",W7=/^#([0-9a-f]{3,8})$/,H7=new RegExp(`^rgb\\(${Tc},${Tc},${Tc}\\)$`),G7=new RegExp(`^rgb\\(${ns},${ns},${ns}\\)$`),V7=new RegExp(`^rgba\\(${Tc},${Tc},${Tc},${kf}\\)$`),K7=new RegExp(`^rgba\\(${ns},${ns},${ns},${kf}\\)$`),Y7=new RegExp(`^hsl\\(${kf},${ns},${ns}\\)$`),X7=new RegExp(`^hsla\\(${kf},${ns},${ns},${kf}\\)$`),gb={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ax(t0,Cf,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:xb,formatHex:xb,formatHex8:Z7,formatHsl:J7,formatRgb:vb,toString:vb});function xb(){return this.rgb().formatHex()}function Z7(){return this.rgb().formatHex8()}function J7(){return pN(this).formatHsl()}function vb(){return this.rgb().formatRgb()}function Cf(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=W7.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?yb(t):r===3?new _a(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?eh(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?eh(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=H7.exec(e))?new _a(t[1],t[2],t[3],1):(t=G7.exec(e))?new _a(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=V7.exec(e))?eh(t[1],t[2],t[3],t[4]):(t=K7.exec(e))?eh(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=Y7.exec(e))?_b(t[1],t[2]/100,t[3]/100,1):(t=X7.exec(e))?_b(t[1],t[2]/100,t[3]/100,t[4]):gb.hasOwnProperty(e)?yb(gb[e]):e==="transparent"?new _a(NaN,NaN,NaN,0):null}function yb(e){return new _a(e>>16&255,e>>8&255,e&255,1)}function eh(e,t,r,n){return n<=0&&(e=t=r=NaN),new _a(e,t,r,n)}function Q7(e){return e instanceof t0||(e=Cf(e)),e?(e=e.rgb(),new _a(e.r,e.g,e.b,e.opacity)):new _a}function ug(e,t,r,n){return arguments.length===1?Q7(e):new _a(e,t,r,n??1)}function _a(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}Ax(_a,ug,dN(t0,{brighter(e){return e=e==null?Qh:Math.pow(Qh,e),new _a(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Pf:Math.pow(Pf,e),new _a(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new _a(bl(this.r),bl(this.g),bl(this.b),ed(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:bb,formatHex:bb,formatHex8:eL,formatRgb:wb,toString:wb}));function bb(){return`#${cl(this.r)}${cl(this.g)}${cl(this.b)}`}function eL(){return`#${cl(this.r)}${cl(this.g)}${cl(this.b)}${cl((isNaN(this.opacity)?1:this.opacity)*255)}`}function wb(){const e=ed(this.opacity);return`${e===1?"rgb(":"rgba("}${bl(this.r)}, ${bl(this.g)}, ${bl(this.b)}${e===1?")":`, ${e})`}`}function ed(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function bl(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function cl(e){return e=bl(e),(e<16?"0":"")+e.toString(16)}function _b(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new ki(e,t,r,n)}function pN(e){if(e instanceof ki)return new ki(e.h,e.s,e.l,e.opacity);if(e instanceof t0||(e=Cf(e)),!e)return new ki;if(e instanceof ki)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),s=NaN,o=i-a,l=(i+a)/2;return o?(t===i?s=(r-n)/o+(r<n)*6:r===i?s=(n-t)/o+2:s=(t-r)/o+4,o/=l<.5?i+a:2-i-a,s*=60):o=l>0&&l<1?0:s,new ki(s,o,l,e.opacity)}function tL(e,t,r,n){return arguments.length===1?pN(e):new ki(e,t,r,n??1)}function ki(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}Ax(ki,tL,dN(t0,{brighter(e){return e=e==null?Qh:Math.pow(Qh,e),new ki(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Pf:Math.pow(Pf,e),new ki(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new _a(Fm(e>=240?e-240:e+120,a,n),Fm(e,a,n),Fm(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new ki(Nb(this.h),th(this.s),th(this.l),ed(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=ed(this.opacity);return`${e===1?"hsl(":"hsla("}${Nb(this.h)}, ${th(this.s)*100}%, ${th(this.l)*100}%${e===1?")":`, ${e})`}`}}));function Nb(e){return e=(e||0)%360,e<0?e+360:e}function th(e){return Math.max(0,Math.min(1,e||0))}function Fm(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const Ex=e=>()=>e;function rL(e,t){return function(r){return e+r*t}}function nL(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function aL(e){return(e=+e)==1?mN:function(t,r){return r-t?nL(t,r,e):Ex(isNaN(t)?r:t)}}function mN(e,t){var r=t-e;return r?rL(e,r):Ex(isNaN(e)?t:e)}const Sb=function e(t){var r=aL(t);function n(a,i){var s=r((a=ug(a)).r,(i=ug(i)).r),o=r(a.g,i.g),l=r(a.b,i.b),c=mN(a.opacity,i.opacity);return function(f){return a.r=s(f),a.g=o(f),a.b=l(f),a.opacity=c(f),a+""}}return n.gamma=e,n}(1);function iL(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function sL(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function oL(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),s;for(s=0;s<n;++s)a[s]=eu(e[s],t[s]);for(;s<r;++s)i[s]=t[s];return function(o){for(s=0;s<n;++s)i[s]=a[s](o);return i}}function lL(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function td(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function cL(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=eu(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var fg=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Dm=new RegExp(fg.source,"g");function uL(e){return function(){return e}}function fL(e){return function(t){return e(t)+""}}function hL(e,t){var r=fg.lastIndex=Dm.lastIndex=0,n,a,i,s=-1,o=[],l=[];for(e=e+"",t=t+"";(n=fg.exec(e))&&(a=Dm.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),o[s]?o[s]+=i:o[++s]=i),(n=n[0])===(a=a[0])?o[s]?o[s]+=a:o[++s]=a:(o[++s]=null,l.push({i:s,x:td(n,a)})),r=Dm.lastIndex;return r<t.length&&(i=t.slice(r),o[s]?o[s]+=i:o[++s]=i),o.length<2?l[0]?fL(l[0].x):uL(t):(t=l.length,function(c){for(var f=0,h;f<t;++f)o[(h=l[f]).i]=h.x(c);return o.join("")})}function eu(e,t){var r=typeof t,n;return t==null||r==="boolean"?Ex(t):(r==="number"?td:r==="string"?(n=Cf(t))?(t=n,Sb):hL:t instanceof Cf?Sb:t instanceof Date?lL:sL(t)?iL:Array.isArray(t)?oL:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?cL:td)(e,t)}function Tx(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function dL(e,t){t===void 0&&(t=e,e=eu);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(s){var o=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return i[o](s-o)}}function pL(e){return function(){return e}}function rd(e){return+e}var Ab=[0,1];function ca(e){return e}function hg(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:pL(isNaN(t)?NaN:.5)}function mL(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function gL(e,t,r){var n=e[0],a=e[1],i=t[0],s=t[1];return a<n?(n=hg(a,n),i=r(s,i)):(n=hg(n,a),i=r(i,s)),function(o){return i(n(o))}}function xL(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<n;)a[s]=hg(e[s],e[s+1]),i[s]=r(t[s],t[s+1]);return function(o){var l=e0(e,o,1,n)-1;return i[l](a[l](o))}}function r0(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function hp(){var e=Ab,t=Ab,r=eu,n,a,i,s=ca,o,l,c;function f(){var p=Math.min(e.length,t.length);return s!==ca&&(s=mL(e[0],e[p-1])),o=p>2?xL:gL,l=c=null,h}function h(p){return p==null||isNaN(p=+p)?i:(l||(l=o(e.map(n),t,r)))(n(s(p)))}return h.invert=function(p){return s(a((c||(c=o(t,e.map(n),td)))(p)))},h.domain=function(p){return arguments.length?(e=Array.from(p,rd),f()):e.slice()},h.range=function(p){return arguments.length?(t=Array.from(p),f()):t.slice()},h.rangeRound=function(p){return t=Array.from(p),r=Tx,f()},h.clamp=function(p){return arguments.length?(s=p?!0:ca,f()):s!==ca},h.interpolate=function(p){return arguments.length?(r=p,f()):r},h.unknown=function(p){return arguments.length?(i=p,h):i},function(p,d){return n=p,a=d,f()}}function jx(){return hp()(ca,ca)}function vL(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function nd(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Hc(e){return e=nd(Math.abs(e)),e?e[1]:NaN}function yL(e,t){return function(r,n){for(var a=r.length,i=[],s=0,o=e[0],l=0;a>0&&o>0&&(l+o+1>n&&(o=Math.max(1,n-l)),i.push(r.substring(a-=o,a+o)),!((l+=o+1)>n));)o=e[s=(s+1)%e.length];return i.reverse().join(t)}}function bL(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var wL=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Of(e){if(!(t=wL.exec(e)))throw new Error("invalid format: "+e);var t;return new Px({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Of.prototype=Px.prototype;function Px(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}Px.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function _L(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var gN;function NL(e,t){var r=nd(e,t);if(!r)return e+"";var n=r[0],a=r[1],i=a-(gN=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,s=n.length;return i===s?n:i>s?n+new Array(i-s+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+nd(e,Math.max(0,t+i-1))[0]}function Eb(e,t){var r=nd(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const Tb={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:vL,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>Eb(e*100,t),r:Eb,s:NL,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function jb(e){return e}var Pb=Array.prototype.map,kb=["y","z","a","f","p","n","¬µ","m","","k","M","G","T","P","E","Z","Y"];function SL(e){var t=e.grouping===void 0||e.thousands===void 0?jb:yL(Pb.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?jb:bL(Pb.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"‚àí":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function c(h){h=Of(h);var p=h.fill,d=h.align,x=h.sign,g=h.symbol,y=h.zero,b=h.width,T=h.comma,S=h.precision,k=h.trim,A=h.type;A==="n"?(T=!0,A="g"):Tb[A]||(S===void 0&&(S=12),k=!0,A="g"),(y||p==="0"&&d==="=")&&(y=!0,p="0",d="=");var M=g==="$"?r:g==="#"&&/[boxX]/.test(A)?"0"+A.toLowerCase():"",O=g==="$"?n:/[%p]/.test(A)?s:"",I=Tb[A],j=/[defgprs%]/.test(A);S=S===void 0?6:/[gprs]/.test(A)?Math.max(1,Math.min(21,S)):Math.max(0,Math.min(20,S));function W(E){var C=M,G=O,Z,he,oe;if(A==="c")G=I(E)+G,E="";else{E=+E;var me=E<0||1/E<0;if(E=isNaN(E)?l:I(Math.abs(E),S),k&&(E=_L(E)),me&&+E==0&&x!=="+"&&(me=!1),C=(me?x==="("?x:o:x==="-"||x==="("?"":x)+C,G=(A==="s"?kb[8+gN/3]:"")+G+(me&&x==="("?")":""),j){for(Z=-1,he=E.length;++Z<he;)if(oe=E.charCodeAt(Z),48>oe||oe>57){G=(oe===46?a+E.slice(Z+1):E.slice(Z))+G,E=E.slice(0,Z);break}}}T&&!y&&(E=t(E,1/0));var pe=C.length+E.length+G.length,ge=pe<b?new Array(b-pe+1).join(p):"";switch(T&&y&&(E=t(ge+E,ge.length?b-G.length:1/0),ge=""),d){case"<":E=C+E+G+ge;break;case"=":E=C+ge+E+G;break;case"^":E=ge.slice(0,pe=ge.length>>1)+C+E+G+ge.slice(pe);break;default:E=ge+C+E+G;break}return i(E)}return W.toString=function(){return h+""},W}function f(h,p){var d=c((h=Of(h),h.type="f",h)),x=Math.max(-8,Math.min(8,Math.floor(Hc(p)/3)))*3,g=Math.pow(10,-x),y=kb[8+x/3];return function(b){return d(g*b)+y}}return{format:c,formatPrefix:f}}var rh,kx,xN;AL({thousands:",",grouping:[3],currency:["$",""]});function AL(e){return rh=SL(e),kx=rh.format,xN=rh.formatPrefix,rh}function EL(e){return Math.max(0,-Hc(Math.abs(e)))}function TL(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Hc(t)/3)))*3-Hc(Math.abs(e)))}function jL(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Hc(t)-Hc(e))+1}function vN(e,t,r,n){var a=lg(e,t,r),i;switch(n=Of(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=TL(a,s))&&(n.precision=i),xN(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=jL(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=EL(a))&&(n.precision=i-(n.type==="%")*2);break}}return kx(n)}function Mo(e){var t=e.domain;return e.ticks=function(r){var n=t();return sg(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return vN(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,s=n[a],o=n[i],l,c,f=10;for(o<s&&(c=s,s=o,o=c,c=a,a=i,i=c);f-- >0;){if(c=og(s,o,r),c===l)return n[a]=s,n[i]=o,t(n);if(c>0)s=Math.floor(s/c)*c,o=Math.ceil(o/c)*c;else if(c<0)s=Math.ceil(s*c)/c,o=Math.floor(o*c)/c;else break;l=c}return e},e}function yN(){var e=jx();return e.copy=function(){return r0(e,yN())},gi.apply(e,arguments),Mo(e)}function bN(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,rd),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return bN(e).unknown(t)},e=arguments.length?Array.from(e,rd):[0,1],Mo(r)}function wN(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],s;return i<a&&(s=r,r=n,n=s,s=a,a=i,i=s),e[r]=t.floor(a),e[n]=t.ceil(i),e}function Cb(e){return Math.log(e)}function Ob(e){return Math.exp(e)}function PL(e){return-Math.log(-e)}function kL(e){return-Math.exp(-e)}function CL(e){return isFinite(e)?+("1e"+e):e<0?0:e}function OL(e){return e===10?CL:e===Math.E?Math.exp:t=>Math.pow(e,t)}function LL(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function Lb(e){return(t,r)=>-e(-t,r)}function Cx(e){const t=e(Cb,Ob),r=t.domain;let n=10,a,i;function s(){return a=LL(n),i=OL(n),r()[0]<0?(a=Lb(a),i=Lb(i),e(PL,kL)):e(Cb,Ob),t}return t.base=function(o){return arguments.length?(n=+o,s()):n},t.domain=function(o){return arguments.length?(r(o),s()):r()},t.ticks=o=>{const l=r();let c=l[0],f=l[l.length-1];const h=f<c;h&&([c,f]=[f,c]);let p=a(c),d=a(f),x,g;const y=o==null?10:+o;let b=[];if(!(n%1)&&d-p<y){if(p=Math.floor(p),d=Math.ceil(d),c>0){for(;p<=d;++p)for(x=1;x<n;++x)if(g=p<0?x/i(-p):x*i(p),!(g<c)){if(g>f)break;b.push(g)}}else for(;p<=d;++p)for(x=n-1;x>=1;--x)if(g=p>0?x/i(-p):x*i(p),!(g<c)){if(g>f)break;b.push(g)}b.length*2<y&&(b=sg(c,f,y))}else b=sg(p,d,Math.min(d-p,y)).map(i);return h?b.reverse():b},t.tickFormat=(o,l)=>{if(o==null&&(o=10),l==null&&(l=n===10?"s":","),typeof l!="function"&&(!(n%1)&&(l=Of(l)).precision==null&&(l.trim=!0),l=kx(l)),o===1/0)return l;const c=Math.max(1,n*o/t.ticks().length);return f=>{let h=f/i(Math.round(a(f)));return h*n<n-.5&&(h*=n),h<=c?l(f):""}},t.nice=()=>r(wN(r(),{floor:o=>i(Math.floor(a(o))),ceil:o=>i(Math.ceil(a(o)))})),t}function _N(){const e=Cx(hp()).domain([1,10]);return e.copy=()=>r0(e,_N()).base(e.base()),gi.apply(e,arguments),e}function Fb(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Db(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Ox(e){var t=1,r=e(Fb(t),Db(t));return r.constant=function(n){return arguments.length?e(Fb(t=+n),Db(t)):t},Mo(r)}function NN(){var e=Ox(hp());return e.copy=function(){return r0(e,NN()).constant(e.constant())},gi.apply(e,arguments)}function Ib(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function FL(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function DL(e){return e<0?-e*e:e*e}function Lx(e){var t=e(ca,ca),r=1;function n(){return r===1?e(ca,ca):r===.5?e(FL,DL):e(Ib(r),Ib(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},Mo(t)}function Fx(){var e=Lx(hp());return e.copy=function(){return r0(e,Fx()).exponent(e.exponent())},gi.apply(e,arguments),e}function IL(){return Fx.apply(null,arguments).exponent(.5)}function Mb(e){return Math.sign(e)*e*e}function ML(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function SN(){var e=jx(),t=[0,1],r=!1,n;function a(i){var s=ML(e(i));return isNaN(s)?n:r?Math.round(s):s}return a.invert=function(i){return e.invert(Mb(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,rd)).map(Mb)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return SN(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},gi.apply(a,arguments),Mo(a)}function AN(){var e=[],t=[],r=[],n;function a(){var s=0,o=Math.max(1,t.length);for(r=new Array(o-1);++s<o;)r[s-1]=$7(e,s/o);return i}function i(s){return s==null||isNaN(s=+s)?n:t[e0(r,s)]}return i.invertExtent=function(s){var o=t.indexOf(s);return o<0?[NaN,NaN]:[o>0?r[o-1]:e[0],o<r.length?r[o]:e[e.length-1]]},i.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let o of s)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(So),a()},i.range=function(s){return arguments.length?(t=Array.from(s),a()):t.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return AN().domain(e).range(t).unknown(n)},gi.apply(i,arguments)}function EN(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function s(l){return l!=null&&l<=l?a[e0(n,l,0,r)]:i}function o(){var l=-1;for(n=new Array(r);++l<r;)n[l]=((l+1)*t-(l-r)*e)/(r+1);return s}return s.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,o()):[e,t]},s.range=function(l){return arguments.length?(r=(a=Array.from(l)).length-1,o()):a.slice()},s.invertExtent=function(l){var c=a.indexOf(l);return c<0?[NaN,NaN]:c<1?[e,n[0]]:c>=r?[n[r-1],t]:[n[c-1],n[c]]},s.unknown=function(l){return arguments.length&&(i=l),s},s.thresholds=function(){return n.slice()},s.copy=function(){return EN().domain([e,t]).range(a).unknown(i)},gi.apply(Mo(s),arguments)}function TN(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[e0(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var s=t.indexOf(i);return[e[s-1],e[s]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return TN().domain(e).range(t).unknown(r)},gi.apply(a,arguments)}const Im=new Date,Mm=new Date;function xn(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const s=a(i),o=a.ceil(i);return i-s<o-i?s:o},a.offset=(i,s)=>(t(i=new Date(+i),s==null?1:Math.floor(s)),i),a.range=(i,s,o)=>{const l=[];if(i=a.ceil(i),o=o==null?1:Math.floor(o),!(i<s)||!(o>0))return l;let c;do l.push(c=new Date(+i)),t(i,o),e(i);while(c<i&&i<s);return l},a.filter=i=>xn(s=>{if(s>=s)for(;e(s),!i(s);)s.setTime(s-1)},(s,o)=>{if(s>=s)if(o<0)for(;++o<=0;)for(;t(s,-1),!i(s););else for(;--o>=0;)for(;t(s,1),!i(s););}),r&&(a.count=(i,s)=>(Im.setTime(+i),Mm.setTime(+s),e(Im),e(Mm),Math.floor(r(Im,Mm))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?s=>n(s)%i===0:s=>a.count(0,s)%i===0):a)),a}const ad=xn(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);ad.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?xn(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):ad);ad.range;const js=1e3,fi=js*60,Ps=fi*60,Ms=Ps*24,Dx=Ms*7,Rb=Ms*30,Rm=Ms*365,ul=xn(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*js)},(e,t)=>(t-e)/js,e=>e.getUTCSeconds());ul.range;const Ix=xn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*js)},(e,t)=>{e.setTime(+e+t*fi)},(e,t)=>(t-e)/fi,e=>e.getMinutes());Ix.range;const Mx=xn(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*fi)},(e,t)=>(t-e)/fi,e=>e.getUTCMinutes());Mx.range;const Rx=xn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*js-e.getMinutes()*fi)},(e,t)=>{e.setTime(+e+t*Ps)},(e,t)=>(t-e)/Ps,e=>e.getHours());Rx.range;const Bx=xn(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Ps)},(e,t)=>(t-e)/Ps,e=>e.getUTCHours());Bx.range;const n0=xn(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*fi)/Ms,e=>e.getDate()-1);n0.range;const dp=xn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ms,e=>e.getUTCDate()-1);dp.range;const jN=xn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ms,e=>Math.floor(e/Ms));jN.range;function Ml(e){return xn(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*fi)/Dx)}const pp=Ml(0),id=Ml(1),RL=Ml(2),BL=Ml(3),Gc=Ml(4),UL=Ml(5),$L=Ml(6);pp.range;id.range;RL.range;BL.range;Gc.range;UL.range;$L.range;function Rl(e){return xn(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/Dx)}const mp=Rl(0),sd=Rl(1),zL=Rl(2),qL=Rl(3),Vc=Rl(4),WL=Rl(5),HL=Rl(6);mp.range;sd.range;zL.range;qL.range;Vc.range;WL.range;HL.range;const Ux=xn(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());Ux.range;const $x=xn(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());$x.range;const Rs=xn(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Rs.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:xn(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Rs.range;const Bs=xn(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Bs.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:xn(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});Bs.range;function PN(e,t,r,n,a,i){const s=[[ul,1,js],[ul,5,5*js],[ul,15,15*js],[ul,30,30*js],[i,1,fi],[i,5,5*fi],[i,15,15*fi],[i,30,30*fi],[a,1,Ps],[a,3,3*Ps],[a,6,6*Ps],[a,12,12*Ps],[n,1,Ms],[n,2,2*Ms],[r,1,Dx],[t,1,Rb],[t,3,3*Rb],[e,1,Rm]];function o(c,f,h){const p=f<c;p&&([c,f]=[f,c]);const d=h&&typeof h.range=="function"?h:l(c,f,h),x=d?d.range(c,+f+1):[];return p?x.reverse():x}function l(c,f,h){const p=Math.abs(f-c)/h,d=_x(([,,y])=>y).right(s,p);if(d===s.length)return e.every(lg(c/Rm,f/Rm,h));if(d===0)return ad.every(Math.max(lg(c,f,h),1));const[x,g]=s[p/s[d-1][2]<s[d][2]/p?d-1:d];return x.every(g)}return[o,l]}const[GL,VL]=PN(Bs,$x,mp,jN,Bx,Mx),[KL,YL]=PN(Rs,Ux,pp,n0,Rx,Ix);function Bm(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Um(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Yu(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function XL(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,s=e.shortDays,o=e.months,l=e.shortMonths,c=Xu(a),f=Zu(a),h=Xu(i),p=Zu(i),d=Xu(s),x=Zu(s),g=Xu(o),y=Zu(o),b=Xu(l),T=Zu(l),S={a:me,A:pe,b:ge,B:Le,c:null,d:Wb,e:Wb,f:yF,g:PF,G:CF,H:gF,I:xF,j:vF,L:kN,m:bF,M:wF,p:Se,q:N,Q:Vb,s:Kb,S:_F,u:NF,U:SF,V:AF,w:EF,W:TF,x:null,X:null,y:jF,Y:kF,Z:OF,"%":Gb},k={a:D,A:L,b:F,B:K,c:null,d:Hb,e:Hb,f:IF,g:GF,G:KF,H:LF,I:FF,j:DF,L:ON,m:MF,M:RF,p:ce,q:xe,Q:Vb,s:Kb,S:BF,u:UF,U:$F,V:zF,w:qF,W:WF,x:null,X:null,y:HF,Y:VF,Z:YF,"%":Gb},A={a:W,A:E,b:C,B:G,c:Z,d:zb,e:zb,f:hF,g:$b,G:Ub,H:qb,I:qb,j:lF,L:fF,m:oF,M:cF,p:j,q:sF,Q:pF,s:mF,S:uF,u:tF,U:rF,V:nF,w:eF,W:aF,x:he,X:oe,y:$b,Y:Ub,Z:iF,"%":dF};S.x=M(r,S),S.X=M(n,S),S.c=M(t,S),k.x=M(r,k),k.X=M(n,k),k.c=M(t,k);function M(ee,fe){return function(le){var ue=[],$e=-1,ye=0,Q=ee.length,nt,Re,ot;for(le instanceof Date||(le=new Date(+le));++$e<Q;)ee.charCodeAt($e)===37&&(ue.push(ee.slice(ye,$e)),(Re=Bb[nt=ee.charAt(++$e)])!=null?nt=ee.charAt(++$e):Re=nt==="e"?" ":"0",(ot=fe[nt])&&(nt=ot(le,Re)),ue.push(nt),ye=$e+1);return ue.push(ee.slice(ye,$e)),ue.join("")}}function O(ee,fe){return function(le){var ue=Yu(1900,void 0,1),$e=I(ue,ee,le+="",0),ye,Q;if($e!=le.length)return null;if("Q"in ue)return new Date(ue.Q);if("s"in ue)return new Date(ue.s*1e3+("L"in ue?ue.L:0));if(fe&&!("Z"in ue)&&(ue.Z=0),"p"in ue&&(ue.H=ue.H%12+ue.p*12),ue.m===void 0&&(ue.m="q"in ue?ue.q:0),"V"in ue){if(ue.V<1||ue.V>53)return null;"w"in ue||(ue.w=1),"Z"in ue?(ye=Um(Yu(ue.y,0,1)),Q=ye.getUTCDay(),ye=Q>4||Q===0?sd.ceil(ye):sd(ye),ye=dp.offset(ye,(ue.V-1)*7),ue.y=ye.getUTCFullYear(),ue.m=ye.getUTCMonth(),ue.d=ye.getUTCDate()+(ue.w+6)%7):(ye=Bm(Yu(ue.y,0,1)),Q=ye.getDay(),ye=Q>4||Q===0?id.ceil(ye):id(ye),ye=n0.offset(ye,(ue.V-1)*7),ue.y=ye.getFullYear(),ue.m=ye.getMonth(),ue.d=ye.getDate()+(ue.w+6)%7)}else("W"in ue||"U"in ue)&&("w"in ue||(ue.w="u"in ue?ue.u%7:"W"in ue?1:0),Q="Z"in ue?Um(Yu(ue.y,0,1)).getUTCDay():Bm(Yu(ue.y,0,1)).getDay(),ue.m=0,ue.d="W"in ue?(ue.w+6)%7+ue.W*7-(Q+5)%7:ue.w+ue.U*7-(Q+6)%7);return"Z"in ue?(ue.H+=ue.Z/100|0,ue.M+=ue.Z%100,Um(ue)):Bm(ue)}}function I(ee,fe,le,ue){for(var $e=0,ye=fe.length,Q=le.length,nt,Re;$e<ye;){if(ue>=Q)return-1;if(nt=fe.charCodeAt($e++),nt===37){if(nt=fe.charAt($e++),Re=A[nt in Bb?fe.charAt($e++):nt],!Re||(ue=Re(ee,le,ue))<0)return-1}else if(nt!=le.charCodeAt(ue++))return-1}return ue}function j(ee,fe,le){var ue=c.exec(fe.slice(le));return ue?(ee.p=f.get(ue[0].toLowerCase()),le+ue[0].length):-1}function W(ee,fe,le){var ue=d.exec(fe.slice(le));return ue?(ee.w=x.get(ue[0].toLowerCase()),le+ue[0].length):-1}function E(ee,fe,le){var ue=h.exec(fe.slice(le));return ue?(ee.w=p.get(ue[0].toLowerCase()),le+ue[0].length):-1}function C(ee,fe,le){var ue=b.exec(fe.slice(le));return ue?(ee.m=T.get(ue[0].toLowerCase()),le+ue[0].length):-1}function G(ee,fe,le){var ue=g.exec(fe.slice(le));return ue?(ee.m=y.get(ue[0].toLowerCase()),le+ue[0].length):-1}function Z(ee,fe,le){return I(ee,t,fe,le)}function he(ee,fe,le){return I(ee,r,fe,le)}function oe(ee,fe,le){return I(ee,n,fe,le)}function me(ee){return s[ee.getDay()]}function pe(ee){return i[ee.getDay()]}function ge(ee){return l[ee.getMonth()]}function Le(ee){return o[ee.getMonth()]}function Se(ee){return a[+(ee.getHours()>=12)]}function N(ee){return 1+~~(ee.getMonth()/3)}function D(ee){return s[ee.getUTCDay()]}function L(ee){return i[ee.getUTCDay()]}function F(ee){return l[ee.getUTCMonth()]}function K(ee){return o[ee.getUTCMonth()]}function ce(ee){return a[+(ee.getUTCHours()>=12)]}function xe(ee){return 1+~~(ee.getUTCMonth()/3)}return{format:function(ee){var fe=M(ee+="",S);return fe.toString=function(){return ee},fe},parse:function(ee){var fe=O(ee+="",!1);return fe.toString=function(){return ee},fe},utcFormat:function(ee){var fe=M(ee+="",k);return fe.toString=function(){return ee},fe},utcParse:function(ee){var fe=O(ee+="",!0);return fe.toString=function(){return ee},fe}}}var Bb={"-":"",_:" ",0:"0"},Pn=/^\s*\d+/,ZL=/^%/,JL=/[\\^$*+?|[\]().{}]/g;function Jt(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function QL(e){return e.replace(JL,"\\$&")}function Xu(e){return new RegExp("^(?:"+e.map(QL).join("|")+")","i")}function Zu(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function eF(e,t,r){var n=Pn.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function tF(e,t,r){var n=Pn.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function rF(e,t,r){var n=Pn.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function nF(e,t,r){var n=Pn.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function aF(e,t,r){var n=Pn.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function Ub(e,t,r){var n=Pn.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function $b(e,t,r){var n=Pn.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function iF(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function sF(e,t,r){var n=Pn.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function oF(e,t,r){var n=Pn.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function zb(e,t,r){var n=Pn.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function lF(e,t,r){var n=Pn.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function qb(e,t,r){var n=Pn.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function cF(e,t,r){var n=Pn.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function uF(e,t,r){var n=Pn.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function fF(e,t,r){var n=Pn.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function hF(e,t,r){var n=Pn.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function dF(e,t,r){var n=ZL.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function pF(e,t,r){var n=Pn.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function mF(e,t,r){var n=Pn.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function Wb(e,t){return Jt(e.getDate(),t,2)}function gF(e,t){return Jt(e.getHours(),t,2)}function xF(e,t){return Jt(e.getHours()%12||12,t,2)}function vF(e,t){return Jt(1+n0.count(Rs(e),e),t,3)}function kN(e,t){return Jt(e.getMilliseconds(),t,3)}function yF(e,t){return kN(e,t)+"000"}function bF(e,t){return Jt(e.getMonth()+1,t,2)}function wF(e,t){return Jt(e.getMinutes(),t,2)}function _F(e,t){return Jt(e.getSeconds(),t,2)}function NF(e){var t=e.getDay();return t===0?7:t}function SF(e,t){return Jt(pp.count(Rs(e)-1,e),t,2)}function CN(e){var t=e.getDay();return t>=4||t===0?Gc(e):Gc.ceil(e)}function AF(e,t){return e=CN(e),Jt(Gc.count(Rs(e),e)+(Rs(e).getDay()===4),t,2)}function EF(e){return e.getDay()}function TF(e,t){return Jt(id.count(Rs(e)-1,e),t,2)}function jF(e,t){return Jt(e.getFullYear()%100,t,2)}function PF(e,t){return e=CN(e),Jt(e.getFullYear()%100,t,2)}function kF(e,t){return Jt(e.getFullYear()%1e4,t,4)}function CF(e,t){var r=e.getDay();return e=r>=4||r===0?Gc(e):Gc.ceil(e),Jt(e.getFullYear()%1e4,t,4)}function OF(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Jt(t/60|0,"0",2)+Jt(t%60,"0",2)}function Hb(e,t){return Jt(e.getUTCDate(),t,2)}function LF(e,t){return Jt(e.getUTCHours(),t,2)}function FF(e,t){return Jt(e.getUTCHours()%12||12,t,2)}function DF(e,t){return Jt(1+dp.count(Bs(e),e),t,3)}function ON(e,t){return Jt(e.getUTCMilliseconds(),t,3)}function IF(e,t){return ON(e,t)+"000"}function MF(e,t){return Jt(e.getUTCMonth()+1,t,2)}function RF(e,t){return Jt(e.getUTCMinutes(),t,2)}function BF(e,t){return Jt(e.getUTCSeconds(),t,2)}function UF(e){var t=e.getUTCDay();return t===0?7:t}function $F(e,t){return Jt(mp.count(Bs(e)-1,e),t,2)}function LN(e){var t=e.getUTCDay();return t>=4||t===0?Vc(e):Vc.ceil(e)}function zF(e,t){return e=LN(e),Jt(Vc.count(Bs(e),e)+(Bs(e).getUTCDay()===4),t,2)}function qF(e){return e.getUTCDay()}function WF(e,t){return Jt(sd.count(Bs(e)-1,e),t,2)}function HF(e,t){return Jt(e.getUTCFullYear()%100,t,2)}function GF(e,t){return e=LN(e),Jt(e.getUTCFullYear()%100,t,2)}function VF(e,t){return Jt(e.getUTCFullYear()%1e4,t,4)}function KF(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Vc(e):Vc.ceil(e),Jt(e.getUTCFullYear()%1e4,t,4)}function YF(){return"+0000"}function Gb(){return"%"}function Vb(e){return+e}function Kb(e){return Math.floor(+e/1e3)}var sc,FN,DN;XF({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function XF(e){return sc=XL(e),FN=sc.format,sc.parse,DN=sc.utcFormat,sc.utcParse,sc}function ZF(e){return new Date(e)}function JF(e){return e instanceof Date?+e:+new Date(+e)}function zx(e,t,r,n,a,i,s,o,l,c){var f=jx(),h=f.invert,p=f.domain,d=c(".%L"),x=c(":%S"),g=c("%I:%M"),y=c("%I %p"),b=c("%a %d"),T=c("%b %d"),S=c("%B"),k=c("%Y");function A(M){return(l(M)<M?d:o(M)<M?x:s(M)<M?g:i(M)<M?y:n(M)<M?a(M)<M?b:T:r(M)<M?S:k)(M)}return f.invert=function(M){return new Date(h(M))},f.domain=function(M){return arguments.length?p(Array.from(M,JF)):p().map(ZF)},f.ticks=function(M){var O=p();return e(O[0],O[O.length-1],M??10)},f.tickFormat=function(M,O){return O==null?A:c(O)},f.nice=function(M){var O=p();return(!M||typeof M.range!="function")&&(M=t(O[0],O[O.length-1],M??10)),M?p(wN(O,M)):f},f.copy=function(){return r0(f,zx(e,t,r,n,a,i,s,o,l,c))},f}function QF(){return gi.apply(zx(KL,YL,Rs,Ux,pp,n0,Rx,Ix,ul,FN).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function eD(){return gi.apply(zx(GL,VL,Bs,$x,mp,dp,Bx,Mx,ul,DN).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function gp(){var e=0,t=1,r,n,a,i,s=ca,o=!1,l;function c(h){return h==null||isNaN(h=+h)?l:s(a===0?.5:(h=(i(h)-r)*a,o?Math.max(0,Math.min(1,h)):h))}c.domain=function(h){return arguments.length?([e,t]=h,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),c):[e,t]},c.clamp=function(h){return arguments.length?(o=!!h,c):o},c.interpolator=function(h){return arguments.length?(s=h,c):s};function f(h){return function(p){var d,x;return arguments.length?([d,x]=p,s=h(d,x),c):[s(0),s(1)]}}return c.range=f(eu),c.rangeRound=f(Tx),c.unknown=function(h){return arguments.length?(l=h,c):l},function(h){return i=h,r=h(e),n=h(t),a=r===n?0:1/(n-r),c}}function Ro(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function IN(){var e=Mo(gp()(ca));return e.copy=function(){return Ro(e,IN())},Hs.apply(e,arguments)}function MN(){var e=Cx(gp()).domain([1,10]);return e.copy=function(){return Ro(e,MN()).base(e.base())},Hs.apply(e,arguments)}function RN(){var e=Ox(gp());return e.copy=function(){return Ro(e,RN()).constant(e.constant())},Hs.apply(e,arguments)}function qx(){var e=Lx(gp());return e.copy=function(){return Ro(e,qx()).exponent(e.exponent())},Hs.apply(e,arguments)}function tD(){return qx.apply(null,arguments).exponent(.5)}function BN(){var e=[],t=ca;function r(n){if(n!=null&&!isNaN(n=+n))return t((e0(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(So),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>U7(e,i/n))},r.copy=function(){return BN(t).domain(e)},Hs.apply(r,arguments)}function xp(){var e=0,t=.5,r=1,n=1,a,i,s,o,l,c=ca,f,h=!1,p;function d(g){return isNaN(g=+g)?p:(g=.5+((g=+f(g))-i)*(n*g<n*i?o:l),c(h?Math.max(0,Math.min(1,g)):g))}d.domain=function(g){return arguments.length?([e,t,r]=g,a=f(e=+e),i=f(t=+t),s=f(r=+r),o=a===i?0:.5/(i-a),l=i===s?0:.5/(s-i),n=i<a?-1:1,d):[e,t,r]},d.clamp=function(g){return arguments.length?(h=!!g,d):h},d.interpolator=function(g){return arguments.length?(c=g,d):c};function x(g){return function(y){var b,T,S;return arguments.length?([b,T,S]=y,c=dL(g,[b,T,S]),d):[c(0),c(.5),c(1)]}}return d.range=x(eu),d.rangeRound=x(Tx),d.unknown=function(g){return arguments.length?(p=g,d):p},function(g){return f=g,a=g(e),i=g(t),s=g(r),o=a===i?0:.5/(i-a),l=i===s?0:.5/(s-i),n=i<a?-1:1,d}}function UN(){var e=Mo(xp()(ca));return e.copy=function(){return Ro(e,UN())},Hs.apply(e,arguments)}function $N(){var e=Cx(xp()).domain([.1,1,10]);return e.copy=function(){return Ro(e,$N()).base(e.base())},Hs.apply(e,arguments)}function zN(){var e=Ox(xp());return e.copy=function(){return Ro(e,zN()).constant(e.constant())},Hs.apply(e,arguments)}function Wx(){var e=Lx(xp());return e.copy=function(){return Ro(e,Wx()).exponent(e.exponent())},Hs.apply(e,arguments)}function rD(){return Wx.apply(null,arguments).exponent(.5)}const of=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Sx,scaleDiverging:UN,scaleDivergingLog:$N,scaleDivergingPow:Wx,scaleDivergingSqrt:rD,scaleDivergingSymlog:zN,scaleIdentity:bN,scaleImplicit:cg,scaleLinear:yN,scaleLog:_N,scaleOrdinal:Nx,scalePoint:q7,scalePow:Fx,scaleQuantile:AN,scaleQuantize:EN,scaleRadial:SN,scaleSequential:IN,scaleSequentialLog:MN,scaleSequentialPow:qx,scaleSequentialQuantile:BN,scaleSequentialSqrt:tD,scaleSequentialSymlog:RN,scaleSqrt:IL,scaleSymlog:NN,scaleThreshold:TN,scaleTime:QF,scaleUtc:eD,tickFormat:vN},Symbol.toStringTag,{value:"Module"}));var Bo=e=>e.chartData,Hx=Ce([Bo],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),qN=(e,t,r,n)=>n?Hx(e):Bo(e);function Kc(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(Di(t)&&Di(r))return!0}return!1}function Yb(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function nD(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,a,i;if(Di(r))a=r;else if(typeof r=="function")return;if(Di(n))i=n;else if(typeof n=="function")return;var s=[a,i];if(Kc(s))return s}}function aD(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(Kc(n))return Yb(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[a,i]=e,s,o;if(a==="auto")t!=null&&(s=Math.min(...t));else if(Vt(a))s=a;else if(typeof a=="function")try{t!=null&&(s=a(t==null?void 0:t[0]))}catch{}else if(typeof a=="string"&&Vy.test(a)){var l=Vy.exec(a);if(l==null||t==null)s=void 0;else{var c=+l[1];s=t[0]-c}}else s=t==null?void 0:t[0];if(i==="auto")t!=null&&(o=Math.max(...t));else if(Vt(i))o=i;else if(typeof i=="function")try{t!=null&&(o=i(t==null?void 0:t[1]))}catch{}else if(typeof i=="string"&&Ky.test(i)){var f=Ky.exec(i);if(f==null||t==null)o=void 0;else{var h=+f[1];o=t[1]+h}}else o=t==null?void 0:t[1];var p=[s,o];if(Kc(p))return t==null?p:Yb(p,t,r)}}}var tu=1e9,iD={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Vx,Lr=!0,di="[DecimalError] ",wl=di+"Invalid argument: ",Gx=di+"Exponent out of range: ",ru=Math.floor,rl=Math.pow,sD=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,qa,_n=1e7,jr=7,WN=9007199254740991,od=ru(WN/jr),ct={};ct.absoluteValue=ct.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};ct.comparedTo=ct.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};ct.decimalPlaces=ct.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*jr;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};ct.dividedBy=ct.div=function(e){return Cs(this,new this.constructor(e))};ct.dividedToIntegerBy=ct.idiv=function(e){var t=this,r=t.constructor;return yr(Cs(t,new r(e),0,1),r.precision)};ct.equals=ct.eq=function(e){return!this.cmp(e)};ct.exponent=function(){return on(this)};ct.greaterThan=ct.gt=function(e){return this.cmp(e)>0};ct.greaterThanOrEqualTo=ct.gte=function(e){return this.cmp(e)>=0};ct.isInteger=ct.isint=function(){return this.e>this.d.length-2};ct.isNegative=ct.isneg=function(){return this.s<0};ct.isPositive=ct.ispos=function(){return this.s>0};ct.isZero=function(){return this.s===0};ct.lessThan=ct.lt=function(e){return this.cmp(e)<0};ct.lessThanOrEqualTo=ct.lte=function(e){return this.cmp(e)<1};ct.logarithm=ct.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(qa))throw Error(di+"NaN");if(r.s<1)throw Error(di+(r.s?"NaN":"-Infinity"));return r.eq(qa)?new n(0):(Lr=!1,t=Cs(Lf(r,i),Lf(e,i),i),Lr=!0,yr(t,a))};ct.minus=ct.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?VN(t,e):HN(t,(e.s=-e.s,e))};ct.modulo=ct.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(di+"NaN");return r.s?(Lr=!1,t=Cs(r,e,0,1).times(e),Lr=!0,r.minus(t)):yr(new n(r),a)};ct.naturalExponential=ct.exp=function(){return GN(this)};ct.naturalLogarithm=ct.ln=function(){return Lf(this)};ct.negated=ct.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};ct.plus=ct.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?HN(t,e):VN(t,(e.s=-e.s,e))};ct.precision=ct.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(wl+e);if(t=on(a)+1,n=a.d.length-1,r=n*jr+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};ct.squareRoot=ct.sqrt=function(){var e,t,r,n,a,i,s,o=this,l=o.constructor;if(o.s<1){if(!o.s)return new l(0);throw Error(di+"NaN")}for(e=on(o),Lr=!1,a=Math.sqrt(+o),a==0||a==1/0?(t=es(o.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=ru((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new l(t)):n=new l(a.toString()),r=l.precision,a=s=r+3;;)if(i=n,n=i.plus(Cs(o,i,s+2)).times(.5),es(i.d).slice(0,s)===(t=es(n.d)).slice(0,s)){if(t=t.slice(s-3,s+1),a==s&&t=="4999"){if(yr(i,r+1,0),i.times(i).eq(o)){n=i;break}}else if(t!="9999")break;s+=4}return Lr=!0,yr(n,r)};ct.times=ct.mul=function(e){var t,r,n,a,i,s,o,l,c,f=this,h=f.constructor,p=f.d,d=(e=new h(e)).d;if(!f.s||!e.s)return new h(0);for(e.s*=f.s,r=f.e+e.e,l=p.length,c=d.length,l<c&&(i=p,p=d,d=i,s=l,l=c,c=s),i=[],s=l+c,n=s;n--;)i.push(0);for(n=c;--n>=0;){for(t=0,a=l+n;a>n;)o=i[a]+d[n]*p[a-n-1]+t,i[a--]=o%_n|0,t=o/_n|0;i[a]=(i[a]+t)%_n|0}for(;!i[--s];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,Lr?yr(e,h.precision):e};ct.toDecimalPlaces=ct.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(ss(e,0,tu),t===void 0?t=n.rounding:ss(t,0,8),yr(r,e+on(r)+1,t))};ct.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=Pl(n,!0):(ss(e,0,tu),t===void 0?t=a.rounding:ss(t,0,8),n=yr(new a(n),e+1,t),r=Pl(n,!0,e+1)),r};ct.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?Pl(a):(ss(e,0,tu),t===void 0?t=i.rounding:ss(t,0,8),n=yr(new i(a),e+on(a)+1,t),r=Pl(n.abs(),!1,e+on(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};ct.toInteger=ct.toint=function(){var e=this,t=e.constructor;return yr(new t(e),on(e)+1,t.rounding)};ct.toNumber=function(){return+this};ct.toPower=ct.pow=function(e){var t,r,n,a,i,s,o=this,l=o.constructor,c=12,f=+(e=new l(e));if(!e.s)return new l(qa);if(o=new l(o),!o.s){if(e.s<1)throw Error(di+"Infinity");return o}if(o.eq(qa))return o;if(n=l.precision,e.eq(qa))return yr(o,n);if(t=e.e,r=e.d.length-1,s=t>=r,i=o.s,s){if((r=f<0?-f:f)<=WN){for(a=new l(qa),t=Math.ceil(n/jr+4),Lr=!1;r%2&&(a=a.times(o),Zb(a.d,t)),r=ru(r/2),r!==0;)o=o.times(o),Zb(o.d,t);return Lr=!0,e.s<0?new l(qa).div(a):yr(a,n)}}else if(i<0)throw Error(di+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,o.s=1,Lr=!1,a=e.times(Lf(o,n+c)),Lr=!0,a=GN(a),a.s=i,a};ct.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=on(a),n=Pl(a,r<=i.toExpNeg||r>=i.toExpPos)):(ss(e,1,tu),t===void 0?t=i.rounding:ss(t,0,8),a=yr(new i(a),e,t),r=on(a),n=Pl(a,e<=r||r<=i.toExpNeg,e)),n};ct.toSignificantDigits=ct.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(ss(e,1,tu),t===void 0?t=n.rounding:ss(t,0,8)),yr(new n(r),e,t)};ct.toString=ct.valueOf=ct.val=ct.toJSON=ct[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=on(e),r=e.constructor;return Pl(e,t<=r.toExpNeg||t>=r.toExpPos)};function HN(e,t){var r,n,a,i,s,o,l,c,f=e.constructor,h=f.precision;if(!e.s||!t.s)return t.s||(t=new f(e)),Lr?yr(t,h):t;if(l=e.d,c=t.d,s=e.e,a=t.e,l=l.slice(),i=s-a,i){for(i<0?(n=l,i=-i,o=c.length):(n=c,a=s,o=l.length),s=Math.ceil(h/jr),o=s>o?s+1:o+1,i>o&&(i=o,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(o=l.length,i=c.length,o-i<0&&(i=o,n=c,c=l,l=n),r=0;i;)r=(l[--i]=l[i]+c[i]+r)/_n|0,l[i]%=_n;for(r&&(l.unshift(r),++a),o=l.length;l[--o]==0;)l.pop();return t.d=l,t.e=a,Lr?yr(t,h):t}function ss(e,t,r){if(e!==~~e||e<t||e>r)throw Error(wl+e)}function es(e){var t,r,n,a=e.length-1,i="",s=e[0];if(a>0){for(i+=s,t=1;t<a;t++)n=e[t]+"",r=jr-n.length,r&&(i+=po(r)),i+=n;s=e[t],n=s+"",r=jr-n.length,r&&(i+=po(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return i+s}var Cs=function(){function e(n,a){var i,s=0,o=n.length;for(n=n.slice();o--;)i=n[o]*a+s,n[o]=i%_n|0,s=i/_n|0;return s&&n.unshift(s),n}function t(n,a,i,s){var o,l;if(i!=s)l=i>s?1:-1;else for(o=l=0;o<i;o++)if(n[o]!=a[o]){l=n[o]>a[o]?1:-1;break}return l}function r(n,a,i){for(var s=0;i--;)n[i]-=s,s=n[i]<a[i]?1:0,n[i]=s*_n+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,s){var o,l,c,f,h,p,d,x,g,y,b,T,S,k,A,M,O,I,j=n.constructor,W=n.s==a.s?1:-1,E=n.d,C=a.d;if(!n.s)return new j(n);if(!a.s)throw Error(di+"Division by zero");for(l=n.e-a.e,O=C.length,A=E.length,d=new j(W),x=d.d=[],c=0;C[c]==(E[c]||0);)++c;if(C[c]>(E[c]||0)&&--l,i==null?T=i=j.precision:s?T=i+(on(n)-on(a))+1:T=i,T<0)return new j(0);if(T=T/jr+2|0,c=0,O==1)for(f=0,C=C[0],T++;(c<A||f)&&T--;c++)S=f*_n+(E[c]||0),x[c]=S/C|0,f=S%C|0;else{for(f=_n/(C[0]+1)|0,f>1&&(C=e(C,f),E=e(E,f),O=C.length,A=E.length),k=O,g=E.slice(0,O),y=g.length;y<O;)g[y++]=0;I=C.slice(),I.unshift(0),M=C[0],C[1]>=_n/2&&++M;do f=0,o=t(C,g,O,y),o<0?(b=g[0],O!=y&&(b=b*_n+(g[1]||0)),f=b/M|0,f>1?(f>=_n&&(f=_n-1),h=e(C,f),p=h.length,y=g.length,o=t(h,g,p,y),o==1&&(f--,r(h,O<p?I:C,p))):(f==0&&(o=f=1),h=C.slice()),p=h.length,p<y&&h.unshift(0),r(g,h,y),o==-1&&(y=g.length,o=t(C,g,O,y),o<1&&(f++,r(g,O<y?I:C,y))),y=g.length):o===0&&(f++,g=[0]),x[c++]=f,o&&g[0]?g[y++]=E[k]||0:(g=[E[k]],y=1);while((k++<A||g[0]!==void 0)&&T--)}return x[0]||x.shift(),d.e=l,yr(d,s?i+on(d)+1:i)}}();function GN(e,t){var r,n,a,i,s,o,l=0,c=0,f=e.constructor,h=f.precision;if(on(e)>16)throw Error(Gx+on(e));if(!e.s)return new f(qa);for(t==null?(Lr=!1,o=h):o=t,s=new f(.03125);e.abs().gte(.1);)e=e.times(s),c+=5;for(n=Math.log(rl(2,c))/Math.LN10*2+5|0,o+=n,r=a=i=new f(qa),f.precision=o;;){if(a=yr(a.times(e),o),r=r.times(++l),s=i.plus(Cs(a,r,o)),es(s.d).slice(0,o)===es(i.d).slice(0,o)){for(;c--;)i=yr(i.times(i),o);return f.precision=h,t==null?(Lr=!0,yr(i,h)):i}i=s}}function on(e){for(var t=e.e*jr,r=e.d[0];r>=10;r/=10)t++;return t}function $m(e,t,r){if(t>e.LN10.sd())throw Lr=!0,r&&(e.precision=r),Error(di+"LN10 precision limit exceeded");return yr(new e(e.LN10),t)}function po(e){for(var t="";e--;)t+="0";return t}function Lf(e,t){var r,n,a,i,s,o,l,c,f,h=1,p=10,d=e,x=d.d,g=d.constructor,y=g.precision;if(d.s<1)throw Error(di+(d.s?"NaN":"-Infinity"));if(d.eq(qa))return new g(0);if(t==null?(Lr=!1,c=y):c=t,d.eq(10))return t==null&&(Lr=!0),$m(g,c);if(c+=p,g.precision=c,r=es(x),n=r.charAt(0),i=on(d),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)d=d.times(e),r=es(d.d),n=r.charAt(0),h++;i=on(d),n>1?(d=new g("0."+r),i++):d=new g(n+"."+r.slice(1))}else return l=$m(g,c+2,y).times(i+""),d=Lf(new g(n+"."+r.slice(1)),c-p).plus(l),g.precision=y,t==null?(Lr=!0,yr(d,y)):d;for(o=s=d=Cs(d.minus(qa),d.plus(qa),c),f=yr(d.times(d),c),a=3;;){if(s=yr(s.times(f),c),l=o.plus(Cs(s,new g(a),c)),es(l.d).slice(0,c)===es(o.d).slice(0,c))return o=o.times(2),i!==0&&(o=o.plus($m(g,c+2,y).times(i+""))),o=Cs(o,new g(h),c),g.precision=y,t==null?(Lr=!0,yr(o,y)):o;o=l,a+=2}}function Xb(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=ru(r/jr),e.d=[],n=(r+1)%jr,r<0&&(n+=jr),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=jr;n<a;)e.d.push(+t.slice(n,n+=jr));t=t.slice(n),n=jr-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),Lr&&(e.e>od||e.e<-od))throw Error(Gx+r)}else e.s=0,e.e=0,e.d=[0];return e}function yr(e,t,r){var n,a,i,s,o,l,c,f,h=e.d;for(s=1,i=h[0];i>=10;i/=10)s++;if(n=t-s,n<0)n+=jr,a=t,c=h[f=0];else{if(f=Math.ceil((n+1)/jr),i=h.length,f>=i)return e;for(c=i=h[f],s=1;i>=10;i/=10)s++;n%=jr,a=n-jr+s}if(r!==void 0&&(i=rl(10,s-a-1),o=c/i%10|0,l=t<0||h[f+1]!==void 0||c%i,l=r<4?(o||l)&&(r==0||r==(e.s<0?3:2)):o>5||o==5&&(r==4||l||r==6&&(n>0?a>0?c/rl(10,s-a):0:h[f-1])%10&1||r==(e.s<0?8:7))),t<1||!h[0])return l?(i=on(e),h.length=1,t=t-i-1,h[0]=rl(10,(jr-t%jr)%jr),e.e=ru(-t/jr)||0):(h.length=1,h[0]=e.e=e.s=0),e;if(n==0?(h.length=f,i=1,f--):(h.length=f+1,i=rl(10,jr-n),h[f]=a>0?(c/rl(10,s-a)%rl(10,a)|0)*i:0),l)for(;;)if(f==0){(h[0]+=i)==_n&&(h[0]=1,++e.e);break}else{if(h[f]+=i,h[f]!=_n)break;h[f--]=0,i=1}for(n=h.length;h[--n]===0;)h.pop();if(Lr&&(e.e>od||e.e<-od))throw Error(Gx+on(e));return e}function VN(e,t){var r,n,a,i,s,o,l,c,f,h,p=e.constructor,d=p.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new p(e),Lr?yr(t,d):t;if(l=e.d,h=t.d,n=t.e,c=e.e,l=l.slice(),s=c-n,s){for(f=s<0,f?(r=l,s=-s,o=h.length):(r=h,n=c,o=l.length),a=Math.max(Math.ceil(d/jr),o)+2,s>a&&(s=a,r.length=1),r.reverse(),a=s;a--;)r.push(0);r.reverse()}else{for(a=l.length,o=h.length,f=a<o,f&&(o=a),a=0;a<o;a++)if(l[a]!=h[a]){f=l[a]<h[a];break}s=0}for(f&&(r=l,l=h,h=r,t.s=-t.s),o=l.length,a=h.length-o;a>0;--a)l[o++]=0;for(a=h.length;a>s;){if(l[--a]<h[a]){for(i=a;i&&l[--i]===0;)l[i]=_n-1;--l[i],l[a]+=_n}l[a]-=h[a]}for(;l[--o]===0;)l.pop();for(;l[0]===0;l.shift())--n;return l[0]?(t.d=l,t.e=n,Lr?yr(t,d):t):new p(0)}function Pl(e,t,r){var n,a=on(e),i=es(e.d),s=i.length;return t?(r&&(n=r-s)>0?i=i.charAt(0)+"."+i.slice(1)+po(n):s>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+po(-a-1)+i,r&&(n=r-s)>0&&(i+=po(n))):a>=s?(i+=po(a+1-s),r&&(n=r-a-1)>0&&(i=i+"."+po(n))):((n=a+1)<s&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-s)>0&&(a+1===s&&(i+="."),i+=po(n))),e.s<0?"-"+i:i}function Zb(e,t){if(e.length>t)return e.length=t,!0}function KN(e){var t,r,n;function a(i){var s=this;if(!(s instanceof a))return new a(i);if(s.constructor=a,i instanceof a){s.s=i.s,s.e=i.e,s.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(wl+i);if(i>0)s.s=1;else if(i<0)i=-i,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(i===~~i&&i<1e7){s.e=0,s.d=[i];return}return Xb(s,i.toString())}else if(typeof i!="string")throw Error(wl+i);if(i.charCodeAt(0)===45?(i=i.slice(1),s.s=-1):s.s=1,sD.test(i))Xb(s,i);else throw Error(wl+i)}if(a.prototype=ct,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=KN,a.config=a.set=oD,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function oD(e){if(!e||typeof e!="object")throw Error(di+"Object expected");var t,r,n,a=["precision",1,tu,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(ru(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(wl+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(wl+r+": "+n);return this}var Vx=KN(iD);qa=new Vx(1);const ur=Vx;var lD=e=>e,YN={"@@functional/placeholder":!0},XN=e=>e===YN,Jb=e=>function t(){return arguments.length===0||arguments.length===1&&XN(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},ZN=(e,t)=>e===1?t:Jb(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var i=n.filter(s=>s!==YN).length;return i>=e?t(...n):ZN(e-i,Jb(function(){for(var s=arguments.length,o=new Array(s),l=0;l<s;l++)o[l]=arguments[l];var c=n.map(f=>XN(f)?o.shift():f);return t(...c,...o)}))}),vp=e=>ZN(e.length,e),dg=(e,t)=>{for(var r=[],n=e;n<t;++n)r[n-e]=n;return r},cD=vp((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),uD=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return lD;var a=r.reverse(),i=a[0],s=a.slice(1);return function(){return s.reduce((o,l)=>l(o),i(...arguments))}},pg=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),JN=e=>{var t=null,r=null;return function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return t&&a.every((s,o)=>{var l;return s===((l=t)===null||l===void 0?void 0:l[o])})||(t=a,r=e(...a)),r}};function QN(e){var t;return e===0?t=1:t=Math.floor(new ur(e).abs().log(10).toNumber())+1,t}function eS(e,t,r){for(var n=new ur(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}vp((e,t,r)=>{var n=+e,a=+t;return n+r*(a-n)});vp((e,t,r)=>{var n=t-+e;return n=n||1/0,(r-e)/n});vp((e,t,r)=>{var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});var tS=e=>{var[t,r]=e,[n,a]=[t,r];return t>r&&([n,a]=[r,t]),[n,a]},rS=(e,t,r)=>{if(e.lte(0))return new ur(0);var n=QN(e.toNumber()),a=new ur(10).pow(n),i=e.div(a),s=n!==1?.05:.1,o=new ur(Math.ceil(i.div(s).toNumber())).add(r).mul(s),l=o.mul(a);return t?new ur(l.toNumber()):new ur(Math.ceil(l.toNumber()))},fD=(e,t,r)=>{var n=new ur(1),a=new ur(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new ur(10).pow(QN(e)-1),a=new ur(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new ur(Math.floor(e)))}else e===0?a=new ur(Math.floor((t-1)/2)):r||(a=new ur(Math.floor(e)));var s=Math.floor((t-1)/2),o=uD(cD(l=>a.add(new ur(l-s).mul(n)).toNumber()),dg);return o(0,t)},nS=function(t,r,n,a){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new ur(0),tickMin:new ur(0),tickMax:new ur(0)};var s=rS(new ur(r).sub(t).div(n-1),a,i),o;t<=0&&r>=0?o=new ur(0):(o=new ur(t).add(r).div(2),o=o.sub(new ur(o).mod(s)));var l=Math.ceil(o.sub(t).div(s).toNumber()),c=Math.ceil(new ur(r).sub(o).div(s).toNumber()),f=l+c+1;return f>n?nS(t,r,n,a,i+1):(f<n&&(c=r>0?c+(n-f):c,l=r>0?l:l+(n-f)),{step:s,tickMin:o.sub(new ur(l).mul(s)),tickMax:o.add(new ur(c).mul(s))})};function hD(e){var[t,r]=e,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(n,2),[s,o]=tS([t,r]);if(s===-1/0||o===1/0){var l=o===1/0?[s,...dg(0,n-1).map(()=>1/0)]:[...dg(0,n-1).map(()=>-1/0),o];return t>r?pg(l):l}if(s===o)return fD(s,n,a);var{step:c,tickMin:f,tickMax:h}=nS(s,o,i,a,0),p=eS(f,h.add(new ur(.1).mul(c)),c);return t>r?pg(p):p}function dD(e,t){var[r,n]=e,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[i,s]=tS([r,n]);if(i===-1/0||s===1/0)return[r,n];if(i===s)return[i];var o=Math.max(t,2),l=rS(new ur(s).sub(i).div(o-1),a,0),c=[...eS(new ur(i),new ur(s),l),s];return a===!1&&(c=c.map(f=>Math.round(f))),r>n?pg(c):c}var pD=JN(hD),mD=JN(dD),gD=e=>e.rootProps.barCategoryGap,a0=e=>e.rootProps.stackOffset,Kx=e=>e.options.chartName,Yx=e=>e.rootProps.syncId,aS=e=>e.rootProps.syncMethod,Xx=e=>e.options.eventEmitter,As={allowDuplicatedCategory:!0,angleAxisId:0,axisLine:!0,cx:0,cy:0,orientation:"outer",reversed:!1,scale:"auto",tick:!0,tickLine:!0,tickSize:8,type:"category"},Ba={allowDataOverflow:!1,allowDuplicatedCategory:!0,angle:0,axisLine:!0,cx:0,cy:0,orientation:"right",radiusAxisId:0,scale:"auto",stroke:"#ccc",tick:!0,tickCount:5,type:"number"},yp=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},xD={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:As.angleAxisId,includeHidden:!1,name:void 0,reversed:As.reversed,scale:As.scale,tick:As.tick,tickCount:void 0,ticks:void 0,type:As.type,unit:void 0},vD={allowDataOverflow:Ba.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Ba.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Ba.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Ba.scale,tick:Ba.tick,tickCount:Ba.tickCount,ticks:void 0,type:Ba.type,unit:void 0},yD={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:As.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:As.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:As.scale,tick:As.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},bD={allowDataOverflow:Ba.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Ba.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Ba.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Ba.scale,tick:Ba.tick,tickCount:Ba.tickCount,ticks:void 0,type:"category",unit:void 0},Zx=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?yD:xD,Jx=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?bD:vD,bp=e=>e.polarOptions,Qx=Ce([qs,Ws,ra],F3),iS=Ce([bp,Qx],(e,t)=>{if(e!=null)return rs(e.innerRadius,t,0)}),sS=Ce([bp,Qx],(e,t)=>{if(e!=null)return rs(e.outerRadius,t,t*.8)}),wD=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},oS=Ce([bp],wD);Ce([Zx,oS],yp);var lS=Ce([Qx,iS,sS],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});Ce([Jx,lS],yp);var _D=Ce([Er,bp,iS,sS,qs,Ws],(e,t,r,n,a,i)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:s,cy:o,startAngle:l,endAngle:c}=t;return{cx:rs(s,a,a/2),cy:rs(o,i,i/2),innerRadius:r,outerRadius:n,startAngle:l,endAngle:c,clockWise:!1}}}),Fr=(e,t)=>t,i0=(e,t,r)=>r;function cS(e){return e==null?void 0:e.id}var vn=e=>{var t=Er(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},nu=e=>e.tooltip.settings.axisId,yn=e=>{var t=vn(e),r=nu(e);return s0(e,t,r)};function uS(e,t,r){var{chartData:n=[]}=t,a=r==null?void 0:r.dataKey,i=new Map;return e.forEach(s=>{var o,l=(o=s.data)!==null&&o!==void 0?o:n;if(!(l==null||l.length===0)){var c=cS(s);l.forEach((f,h)=>{var p=a==null?h:String(sn(f,a,null)),d=sn(f,s.dataKey,0),x;i.has(p)?x=i.get(p):x={},Object.assign(x,{[c]:d}),i.set(p,x)})}}),Array.from(i.values())}function ev(e){return e.stackId!=null&&e.dataKey!=null}function Qb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ld(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Qb(Object(r),!0).forEach(function(n){ND(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Qb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ND(e,t,r){return(t=SD(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SD(e){var t=AD(e,"string");return typeof t=="symbol"?t:t+""}function AD(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mg=[0,"auto"],ED={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},au=(e,t)=>{var r=e.cartesianAxis.xAxis[t];return r??ED},TD={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:mg,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:lp},iu=(e,t)=>{var r=e.cartesianAxis.yAxis[t];return r??TD},jD={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},tv=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??jD},Qr=(e,t,r)=>{switch(t){case"xAxis":return au(e,r);case"yAxis":return iu(e,r);case"zAxis":return tv(e,r);case"angleAxis":return Zx(e,r);case"radiusAxis":return Jx(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},PD=(e,t,r)=>{switch(t){case"xAxis":return au(e,r);case"yAxis":return iu(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},s0=(e,t,r)=>{switch(t){case"xAxis":return au(e,r);case"yAxis":return iu(e,r);case"angleAxis":return Zx(e,r);case"radiusAxis":return Jx(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},fS=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function rv(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var kD=e=>e.graphicalItems.cartesianItems,CD=Ce([Fr,i0],rv),nv=(e,t,r)=>e.filter(r).filter(n=>(t==null?void 0:t.includeHidden)===!0?!0:!n.hide),o0=Ce([kD,Qr,CD],nv),hS=Ce([o0],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(ev)),dS=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),pS=Ce([o0],dS),av=e=>e.map(t=>t.data).filter(Boolean).flat(1),OD=Ce([o0],av),iv=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:a}=t;return e.length>0?e:r.slice(n,a+1)},sv=Ce([OD,qN],iv),ov=(e,t,r)=>(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:sn(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(a=>({value:sn(a,n)}))):e.map(n=>({value:n})),wp=Ce([sv,Qr,o0],ov);function mS(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function Bl(e){return e.filter(t=>Ds(t)||t instanceof Date).map(Number).filter(t=>Fi(t)===!1)}function LD(e,t,r){return!r||typeof t!="number"||Fi(t)?[]:r.length?Bl(r.flatMap(n=>{var a=sn(e,n.dataKey),i,s;if(Array.isArray(a)?[i,s]=a:i=s=a,!(!Di(i)||!Di(s)))return[t-i,t+s]})):[]}var FD=Ce([hS,qN,yn],uS),gS=(e,t,r)=>{var n={},a=t.reduce((i,s)=>(s.stackId==null||(i[s.stackId]==null&&(i[s.stackId]=[]),i[s.stackId].push(s)),i),n);return Object.fromEntries(Object.entries(a).map(i=>{var[s,o]=i,l=o.map(cS);return[s,{stackedData:JC(e,l,r),graphicalItems:o}]}))},DD=Ce([FD,hS,a0],gS),xS=(e,t,r)=>{var{dataStartIndex:n,dataEndIndex:a}=t;if(r!=="zAxis"){var i=tO(e,n,a);if(!(i!=null&&i[0]===0&&i[1]===0))return i}},ID=Ce([DD,Bo,Fr],xS),vS=(e,t,r,n,a)=>r.length>0?e.flatMap(i=>r.flatMap(s=>{var o,l,c=(o=n[s.id])===null||o===void 0?void 0:o.filter(h=>mS(a,h)),f=sn(i,(l=t.dataKey)!==null&&l!==void 0?l:s.dataKey);return{value:f,errorDomain:LD(i,f,c)}})).filter(Boolean):(t==null?void 0:t.dataKey)!=null?e.map(i=>({value:sn(i,t.dataKey),errorDomain:[]})):e.map(i=>({value:i,errorDomain:[]})),_p=e=>e.errorBars,yS=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>mS(r,n));Ce([pS,_p,Fr],yS);var MD=Ce([sv,Qr,pS,_p,Fr],vS);function RD(e){var{value:t}=e;if(Ds(t)||t instanceof Date)return t}var e5=e=>{var t=e.flatMap(n=>[n.value,n.errorDomain]).flat(1),r=Bl(t);if(r.length!==0)return[Math.min(...r),Math.max(...r)]},BD=(e,t,r)=>{var n=e.map(RD).filter(a=>a!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&m4(n))?lN(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},lv=e=>{var t;if(e==null||!("domain"in e))return mg;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=Bl(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e==null?void 0:e.domain)!==null&&t!==void 0?t:mg},cd=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r.filter(Boolean);if(a.length!==0){var i=a.flat(),s=Math.min(...i),o=Math.max(...i);return[s,o]}},bS=e=>e.referenceElements.dots,su=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),UD=Ce([bS,Fr,i0],su),wS=e=>e.referenceElements.areas,$D=Ce([wS,Fr,i0],su),_S=e=>e.referenceElements.lines,zD=Ce([_S,Fr,i0],su),NS=(e,t)=>{var r=Bl(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},qD=Ce(UD,Fr,NS),SS=(e,t)=>{var r=Bl(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},WD=Ce([$D,Fr],SS),AS=(e,t)=>{var r=Bl(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},HD=Ce(zD,Fr,AS),GD=Ce(qD,HD,WD,(e,t,r)=>cd(e,r,t)),ES=Ce([Qr],lv),cv=(e,t,r,n,a,i,s)=>{var o=nD(t,e.allowDataOverflow);if(o!=null)return o;var l=i==="vertical"&&s==="xAxis"||i==="horizontal"&&s==="yAxis",c=l?cd(r,a,e5(n)):cd(a,e5(n));return aD(t,c,e.allowDataOverflow)},VD=Ce([Qr,ES,ID,MD,GD,Er,Fr],cv),KD=[0,1],uv=(e,t,r,n,a,i,s)=>{if(!((e==null||r==null||r.length===0)&&s===void 0)){var{dataKey:o,type:l}=e,c=Il(t,i);return c&&o==null?lN(0,r.length):l==="category"?BD(n,e,c):a==="expand"?KD:s}},fv=Ce([Qr,Er,sv,wp,a0,Fr,VD],uv),TS=(e,t,r,n,a)=>{if(e!=null){var{scale:i,type:s}=e;if(i==="auto")return t==="radial"&&a==="radiusAxis"?"band":t==="radial"&&a==="angleAxis"?"linear":s==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":s==="category"?"band":"linear";if(typeof i=="string"){var o="scale".concat(Jf(i));return o in of?o:"point"}}},ou=Ce([Qr,Er,fS,Kx,Fr],TS);function YD(e){if(e!=null){if(e in of)return of[e]();var t="scale".concat(Jf(e));if(t in of)return of[t]()}}function hv(e,t,r,n){if(!(r==null||n==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(n);var a=YD(t);if(a!=null){var i=a.domain(r).range(n);return KC(i),i}}}var dv=(e,t,r)=>{var n=lv(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&Kc(e))return pD(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&Kc(e))return mD(e,t.tickCount,t.allowDecimals)}},pv=Ce([fv,s0,ou],dv),mv=(e,t,r,n)=>{if(n!=="angleAxis"&&(e==null?void 0:e.type)==="number"&&Kc(t)&&Array.isArray(r)&&r.length>0){var a=t[0],i=r[0],s=t[1],o=r[r.length-1];return[Math.min(a,i),Math.max(s,o)]}return t},XD=Ce([Qr,fv,pv,Fr],mv),ZD=Ce(wp,Qr,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(Bl(e.map(o=>o.value))).sort((o,l)=>o-l);if(n.length<2)return 1/0;var a=n[n.length-1]-n[0];if(a===0)return 1/0;for(var i=0;i<n.length-1;i++){var s=n[i+1]-n[i];r=Math.min(r,s)}return r/a}}),jS=Ce(ZD,Er,gD,ra,(e,t,r,n)=>n,(e,t,r,n,a)=>{if(!Di(e))return 0;var i=t==="vertical"?n.height:n.width;if(a==="gap")return e*i/2;if(a==="no-gap"){var s=rs(r,e*i),o=e*i/2;return o-s-(o-s)/i*s}return 0}),JD=(e,t)=>{var r=au(e,t);return r==null||typeof r.padding!="string"?0:jS(e,"xAxis",t,r.padding)},QD=(e,t)=>{var r=iu(e,t);return r==null||typeof r.padding!="string"?0:jS(e,"yAxis",t,r.padding)},eI=Ce(au,JD,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:a}=e;return typeof a=="string"?{left:t,right:t}:{left:((r=a.left)!==null&&r!==void 0?r:0)+t,right:((n=a.right)!==null&&n!==void 0?n:0)+t}}),tI=Ce(iu,QD,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:a}=e;return typeof a=="string"?{top:t,bottom:t}:{top:((r=a.top)!==null&&r!==void 0?r:0)+t,bottom:((n=a.bottom)!==null&&n!==void 0?n:0)+t}}),rI=Ce([ra,eI,up,cp,(e,t,r)=>r],(e,t,r,n,a)=>{var{padding:i}=n;return a?[i.left,r.width-i.right]:[e.left+t.left,e.left+e.width-t.right]}),nI=Ce([ra,Er,tI,up,cp,(e,t,r)=>r],(e,t,r,n,a,i)=>{var{padding:s}=a;return i?[n.height-s.bottom,s.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),l0=(e,t,r,n)=>{var a;switch(t){case"xAxis":return rI(e,r,n);case"yAxis":return nI(e,r,n);case"zAxis":return(a=tv(e,r))===null||a===void 0?void 0:a.range;case"angleAxis":return oS(e);case"radiusAxis":return lS(e,r);default:return}},PS=Ce([Qr,l0],yp),Np=Ce([Qr,ou,XD,PS],hv);Ce([o0,_p,Fr],yS);function kS(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var Sp=(e,t)=>t,Ap=(e,t,r)=>r,aI=Ce(yx,Sp,Ap,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(kS)),iI=Ce(bx,Sp,Ap,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(kS)),CS=(e,t)=>({width:e.width,height:t.height}),sI=(e,t)=>{var r=typeof t.width=="number"?t.width:lp;return{width:r,height:e.height}};Ce(ra,au,CS);var oI=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},lI=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}};Ce(Ws,ra,aI,Sp,Ap,(e,t,r,n,a)=>{var i={},s;return r.forEach(o=>{var l=CS(t,o);s==null&&(s=oI(t,n,e));var c=n==="top"&&!a||n==="bottom"&&a;i[o.id]=s-Number(c)*l.height,s+=(c?-1:1)*l.height}),i});Ce(qs,ra,iI,Sp,Ap,(e,t,r,n,a)=>{var i={},s;return r.forEach(o=>{var l=sI(t,o);s==null&&(s=lI(t,n,e));var c=n==="left"&&!a||n==="right"&&a;i[o.id]=s-Number(c)*l.width,s+=(c?-1:1)*l.width}),i});Ce(ra,iu,(e,t)=>{var r=typeof t.width=="number"?t.width:lp;return{width:r,height:e.height}});var OS=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:a,type:i,dataKey:s}=r,o=Il(e,n),l=t.map(c=>c.value);if(s&&o&&i==="category"&&a&&m4(l))return l}},gv=Ce([Er,wp,Qr,Fr],OS),LS=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:a,scale:i}=r,s=Il(e,n);if(s&&(a==="number"||i!=="auto"))return t.map(o=>o.value)}},xv=Ce([Er,wp,s0,Fr],LS);Ce([Er,PD,ou,Np,gv,xv,l0,pv,Fr],(e,t,r,n,a,i,s,o,l)=>{if(t==null)return null;var c=Il(e,l);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:l,categoricalDomain:i,duplicateDomain:a,isCategorical:c,niceTicks:o,range:s,realScaleType:r,scale:n}});var cI=(e,t,r,n,a,i,s,o,l)=>{if(!(t==null||n==null)){var c=Il(e,l),{type:f,ticks:h,tickCount:p}=t,d=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,x=f==="category"&&n.bandwidth?n.bandwidth()/d:0;x=l==="angleAxis"&&i!=null&&i.length>=2?Wa(i[0]-i[1])*2*x:x;var g=h||a;if(g){var y=g.map((b,T)=>{var S=s?s.indexOf(b):b;return{index:T,coordinate:n(S)+x,value:b,offset:x}});return y.filter(b=>!Fi(b.coordinate))}return c&&o?o.map((b,T)=>({coordinate:n(b)+x,value:b,index:T,offset:x})):n.ticks?n.ticks(p).map(b=>({coordinate:n(b)+x,value:b,offset:x})):n.domain().map((b,T)=>({coordinate:n(b)+x,value:s?s[b]:b,index:T,offset:x}))}};Ce([Er,s0,ou,Np,pv,l0,gv,xv,Fr],cI);var uI=(e,t,r,n,a,i,s)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var o=Il(e,s),{tickCount:l}=t,c=0;return c=s==="angleAxis"&&(n==null?void 0:n.length)>=2?Wa(n[0]-n[1])*2*c:c,o&&i?i.map((f,h)=>({coordinate:r(f)+c,value:f,index:h,offset:c})):r.ticks?r.ticks(l).map(f=>({coordinate:r(f)+c,value:f,offset:c})):r.domain().map((f,h)=>({coordinate:r(f)+c,value:a?a[f]:f,index:h,offset:c}))}};Ce([Er,s0,Np,l0,gv,xv,Fr],uI);Ce(Qr,Np,(e,t)=>{if(!(e==null||t==null))return ld(ld({},e),{},{scale:t})});var fI=Ce([Qr,ou,fv,PS],hv);Ce((e,t,r)=>tv(e,r),fI,(e,t)=>{if(!(e==null||t==null))return ld(ld({},e),{},{scale:t})});var hI=Ce([Er,yx,bx],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),FS=e=>e.options.defaultTooltipEventType,DS=e=>e.options.validateTooltipEventTypes;function IS(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function vv(e,t){var r=FS(e),n=DS(e);return IS(t,r,n)}function dI(e){return qt(t=>vv(t,e))}var MS=(e,t)=>{var r,n=Number(t);if(!(Fi(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},pI=e=>e.tooltip.settings,go={active:!1,index:null,dataKey:void 0,coordinate:void 0},mI={itemInteraction:{click:go,hover:go},axisInteraction:{click:go,hover:go},keyboardInteraction:go,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},RS=Ja({name:"tooltip",initialState:mI,reducers:{addTooltipEntrySettings(e,t){e.tooltipItemPayloads.push(t.payload)},removeTooltipEntrySettings(e,t){var r=ks(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:gI,removeTooltipEntrySettings:xI,setTooltipSettingsState:vI,setActiveMouseOverItemIndex:BS,mouseLeaveItem:yI,mouseLeaveChart:US,setActiveClickItemIndex:bI,setMouseOverAxisIndex:$S,setMouseClickAxisIndex:wI,setSyncInteraction:gg,setKeyboardInteraction:xg}=RS.actions,_I=RS.reducer;function t5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function nh(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?t5(Object(r),!0).forEach(function(n){NI(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):t5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function NI(e,t,r){return(t=SI(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SI(e){var t=AI(e,"string");return typeof t=="symbol"?t:t+""}function AI(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function EI(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function TI(e){return e.index!=null}var zS=(e,t,r,n)=>{if(t==null)return go;var a=EI(e,t,r);if(a==null)return go;if(a.active)return a;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var i=e.settings.active===!0;if(TI(a)){if(i)return nh(nh({},a),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n};return nh(nh({},go),{},{coordinate:a.coordinate})},yv=(e,t)=>{var r=e==null?void 0:e.index;if(r==null)return null;var n=Number(r);if(!Di(n))return r;var a=0,i=1/0;return t.length>0&&(i=t.length-1),String(Math.max(a,Math.min(n,i)))},qS=(e,t,r,n,a,i,s,o)=>{if(!(i==null||o==null)){var l=s[0],c=l==null?void 0:o(l.positions,i);if(c!=null)return c;var f=a==null?void 0:a[Number(i)];if(f)switch(r){case"horizontal":return{x:f.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:f.coordinate}}}},WS=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var a;return r==="hover"?a=e.itemInteraction.hover.dataKey:a=e.itemInteraction.click.dataKey,a==null&&n!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(i=>{var s;return((s=i.settings)===null||s===void 0?void 0:s.dataKey)===a})},c0=e=>e.options.tooltipPayloadSearcher,lu=e=>e.tooltip;function r5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function n5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?r5(Object(r),!0).forEach(function(n){jI(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):r5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jI(e,t,r){return(t=PI(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PI(e){var t=kI(e,"string");return typeof t=="symbol"?t:t+""}function kI(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function CI(e,t){return e??t}var HS=(e,t,r,n,a,i,s)=>{if(!(t==null||i==null)){var{chartData:o,computedData:l,dataStartIndex:c,dataEndIndex:f}=r,h=[];return e.reduce((p,d)=>{var x,{dataDefinedOnItem:g,settings:y}=d,b=CI(g,o),T=Array.isArray(b)?D3(b,c,f):b,S=(x=y==null?void 0:y.dataKey)!==null&&x!==void 0?x:n==null?void 0:n.dataKey,k=y==null?void 0:y.nameKey,A;if(n!=null&&n.dataKey&&Array.isArray(T)&&!Array.isArray(T[0])&&s==="axis"?A=Kj(T,n.dataKey,a):A=i(T,t,l,k),Array.isArray(A))A.forEach(O=>{var I=n5(n5({},y),{},{name:O.name,unit:O.unit,color:void 0,fill:void 0});p.push(Yy({tooltipEntrySettings:I,dataKey:O.dataKey,payload:O.payload,value:sn(O.payload,O.dataKey),name:O.name}))});else{var M;p.push(Yy({tooltipEntrySettings:y,dataKey:S,payload:A,value:sn(A,S),name:(M=sn(A,k))!==null&&M!==void 0?M:y==null?void 0:y.name}))}return p},h)}},bv=Ce([yn,Er,fS,Kx,vn],TS),OI=Ce([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),LI=Ce([vn,nu],rv),u0=Ce([OI,yn,LI],nv),FI=Ce([u0],e=>e.filter(ev)),DI=Ce([u0],av),cu=Ce([DI,Bo],iv),II=Ce([FI,Bo,yn],uS),wv=Ce([cu,yn,u0],ov),MI=Ce([yn],lv),RI=Ce([u0],e=>e.filter(ev)),BI=Ce([II,RI,a0],gS),UI=Ce([BI,Bo,vn],xS),$I=Ce([u0],dS),zI=Ce([cu,yn,$I,_p,vn],vS),qI=Ce([bS,vn,nu],su),WI=Ce([qI,vn],NS),HI=Ce([wS,vn,nu],su),GI=Ce([HI,vn],SS),VI=Ce([_S,vn,nu],su),KI=Ce([VI,vn],AS),YI=Ce([WI,KI,GI],cd),XI=Ce([yn,MI,UI,zI,YI,Er,vn],cv),GS=Ce([yn,Er,cu,wv,a0,vn,XI],uv),ZI=Ce([GS,yn,bv],dv),JI=Ce([yn,GS,ZI,vn],mv),VS=e=>{var t=vn(e),r=nu(e),n=!1;return l0(e,t,r,n)},KS=Ce([yn,VS],yp),YS=Ce([yn,bv,JI,KS],hv),QI=Ce([Er,wv,yn,vn],OS),eM=Ce([Er,wv,yn,vn],LS),tM=(e,t,r,n,a,i,s,o)=>{if(t){var{type:l}=t,c=Il(e,o);if(n){var f=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,h=l==="category"&&n.bandwidth?n.bandwidth()/f:0;return h=o==="angleAxis"&&a!=null&&(a==null?void 0:a.length)>=2?Wa(a[0]-a[1])*2*h:h,c&&s?s.map((p,d)=>({coordinate:n(p)+h,value:p,index:d,offset:h})):n.domain().map((p,d)=>({coordinate:n(p)+h,value:i?i[p]:p,index:d,offset:h}))}}},Gs=Ce([Er,yn,bv,YS,VS,QI,eM,vn],tM),_v=Ce([FS,DS,pI],(e,t,r)=>IS(r.shared,e,t)),XS=e=>e.tooltip.settings.trigger,Nv=e=>e.tooltip.settings.defaultIndex,Ep=Ce([lu,_v,XS,Nv],zS),Ff=Ce([Ep,cu],yv),ZS=Ce([Gs,Ff],MS),rM=Ce([Ep],e=>{if(e)return e.dataKey}),JS=Ce([lu,_v,XS,Nv],WS),nM=Ce([qs,Ws,Er,ra,Gs,Nv,JS,c0],qS),aM=Ce([Ep,nM],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),iM=Ce([Ep],e=>e.active),sM=Ce([JS,Ff,Bo,yn,ZS,c0,_v],HS);Ce([sM],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function a5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function i5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?a5(Object(r),!0).forEach(function(n){oM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function oM(e,t,r){return(t=lM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lM(e){var t=cM(e,"string");return typeof t=="symbol"?t:t+""}function cM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var uM=()=>qt(yn),fM=()=>{var e=uM(),t=qt(Gs),r=qt(YS);return rO(i5(i5({},e),{},{scale:r}),t)},hM=()=>qt(Kx),Sv=(e,t)=>t,QS=(e,t,r)=>r,Av=(e,t,r,n)=>n,dM=Ce(Gs,e=>tp(e,t=>t.coordinate)),Ev=Ce([lu,Sv,QS,Av],zS),e6=Ce([Ev,cu],yv),pM=(e,t,r)=>{if(t!=null){var n=lu(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},t6=Ce([lu,Sv,QS,Av],WS),ud=Ce([qs,Ws,Er,ra,Gs,Av,t6,c0],qS),mM=Ce([Ev,ud],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),r6=Ce(Gs,e6,MS),gM=Ce([t6,e6,Bo,yn,r6,c0,Sv],HS),xM=Ce([Ev],e=>({isActive:e.active,activeIndex:e.index})),vM=(e,t,r,n,a,i,s,o)=>{if(!(!e||!t||!n||!a||!i)){var l=nO(e.chartX,e.chartY,t,r,o);if(l){var c=iO(l,t),f=GC(c,s,i,n,a),h=aO(t,i,f,l);return{activeIndex:String(f),activeCoordinate:h}}}};function vg(){return vg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},vg.apply(null,arguments)}function s5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ah(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?s5(Object(r),!0).forEach(function(n){yM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function yM(e,t,r){return(t=bM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function bM(e){var t=wM(e,"string");return typeof t=="symbol"?t:t+""}function wM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function _M(e){var{coordinate:t,payload:r,index:n,offset:a,tooltipAxisBandSize:i,layout:s,cursor:o,tooltipEventType:l,chartName:c}=e,f=t,h=r,p=n;if(!o||!f||c!=="ScatterChart"&&l!=="axis")return null;var d,x;if(c==="ScatterChart")d=f,x=VO;else if(c==="BarChart")d=KO(s,f,a,i),x=tN;else if(s==="radial"){var{cx:g,cy:y,radius:b,startAngle:T,endAngle:S}=rN(f);d={cx:g,cy:y,startAngle:T,endAngle:S,innerRadius:b,outerRadius:b},x=aN}else d={points:T7(s,f,a)},x=W3;var k=typeof o=="object"&&"className"in o?o.className:void 0,A=ah(ah(ah(ah({stroke:"#ccc",pointerEvents:"none"},a),d),Ka(o,!1)),{},{payload:h,payloadIndex:p,className:jn("recharts-tooltip-cursor",k)});return U.isValidElement(o)?U.cloneElement(o,A):U.createElement(x,A)}function NM(e){var t=fM(),r=pO(),n=$3(),a=hM();return U.createElement(_M,vg({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:r,layout:n,tooltipAxisBandSize:t,chartName:a}))}var n6=U.createContext(null),SM=()=>U.useContext(n6),a6={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(l,c,f){this.fn=l,this.context=c,this.once=f||!1}function i(l,c,f,h,p){if(typeof f!="function")throw new TypeError("The listener must be a function");var d=new a(f,h||l,p),x=r?r+c:c;return l._events[x]?l._events[x].fn?l._events[x]=[l._events[x],d]:l._events[x].push(d):(l._events[x]=d,l._eventsCount++),l}function s(l,c){--l._eventsCount===0?l._events=new n:delete l._events[c]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var c=[],f,h;if(this._eventsCount===0)return c;for(h in f=this._events)t.call(f,h)&&c.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(f)):c},o.prototype.listeners=function(c){var f=r?r+c:c,h=this._events[f];if(!h)return[];if(h.fn)return[h.fn];for(var p=0,d=h.length,x=new Array(d);p<d;p++)x[p]=h[p].fn;return x},o.prototype.listenerCount=function(c){var f=r?r+c:c,h=this._events[f];return h?h.fn?1:h.length:0},o.prototype.emit=function(c,f,h,p,d,x){var g=r?r+c:c;if(!this._events[g])return!1;var y=this._events[g],b=arguments.length,T,S;if(y.fn){switch(y.once&&this.removeListener(c,y.fn,void 0,!0),b){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,f),!0;case 3:return y.fn.call(y.context,f,h),!0;case 4:return y.fn.call(y.context,f,h,p),!0;case 5:return y.fn.call(y.context,f,h,p,d),!0;case 6:return y.fn.call(y.context,f,h,p,d,x),!0}for(S=1,T=new Array(b-1);S<b;S++)T[S-1]=arguments[S];y.fn.apply(y.context,T)}else{var k=y.length,A;for(S=0;S<k;S++)switch(y[S].once&&this.removeListener(c,y[S].fn,void 0,!0),b){case 1:y[S].fn.call(y[S].context);break;case 2:y[S].fn.call(y[S].context,f);break;case 3:y[S].fn.call(y[S].context,f,h);break;case 4:y[S].fn.call(y[S].context,f,h,p);break;default:if(!T)for(A=1,T=new Array(b-1);A<b;A++)T[A-1]=arguments[A];y[S].fn.apply(y[S].context,T)}}return!0},o.prototype.on=function(c,f,h){return i(this,c,f,h,!1)},o.prototype.once=function(c,f,h){return i(this,c,f,h,!0)},o.prototype.removeListener=function(c,f,h,p){var d=r?r+c:c;if(!this._events[d])return this;if(!f)return s(this,d),this;var x=this._events[d];if(x.fn)x.fn===f&&(!p||x.once)&&(!h||x.context===h)&&s(this,d);else{for(var g=0,y=[],b=x.length;g<b;g++)(x[g].fn!==f||p&&!x[g].once||h&&x[g].context!==h)&&y.push(x[g]);y.length?this._events[d]=y.length===1?y[0]:y:s(this,d)}return this},o.prototype.removeAllListeners=function(c){var f;return c?(f=r?r+c:c,this._events[f]&&s(this,f)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,e.exports=o})(a6);var AM=a6.exports;const EM=Do(AM);var Df=new EM,yg="recharts.syncEvent.tooltip",o5="recharts.syncEvent.brush";function TM(e,t){if(t){var r=Number.parseInt(t,10);if(!Fi(r))return e==null?void 0:e[r]}}var jM={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},i6=Ja({name:"options",initialState:jM,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),PM=i6.reducer,{createEventEmitter:kM}=i6.actions;function CM(e){return e.tooltip.syncInteraction}var OM={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},s6=Ja({name:"chartData",initialState:OM,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:l5,setDataStartEndIndexes:LM,setComputedData:gJ}=s6.actions,FM=s6.reducer,o6=()=>{};function DM(){var e=qt(Yx),t=qt(Xx),r=ta(),n=qt(aS),a=qt(Gs),i=$3(),s=U3(),o=qt(l=>l.rootProps.className);U.useEffect(()=>{if(e==null)return o6;var l=(c,f,h)=>{if(t!==h&&e===c){if(n==="index"){r(f);return}if(a!=null){var p;if(typeof n=="function"){var d={activeTooltipIndex:f.payload.index==null?void 0:Number(f.payload.index),isTooltipActive:f.payload.active,activeIndex:f.payload.index==null?void 0:Number(f.payload.index),activeLabel:f.payload.label,activeDataKey:f.payload.dataKey,activeCoordinate:f.payload.coordinate},x=n(a,d);p=a[x]}else n==="value"&&(p=a.find(M=>String(M.value)===f.payload.label));var{coordinate:g}=f.payload;if(p==null||f.payload.active===!1||g==null||s==null){r(gg({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:y,y:b}=g,T=Math.min(y,s.x+s.width),S=Math.min(b,s.y+s.height),k={x:i==="horizontal"?p.coordinate:T,y:i==="horizontal"?S:p.coordinate},A=gg({active:f.payload.active,coordinate:k,dataKey:f.payload.dataKey,index:String(p.index),label:f.payload.label});r(A)}}};return Df.on(yg,l),()=>{Df.off(yg,l)}},[o,r,t,e,n,a,i,s])}function IM(){var e=qt(Yx),t=qt(Xx),r=ta();U.useEffect(()=>{if(e==null)return o6;var n=(a,i,s)=>{t!==s&&e===a&&r(LM(i))};return Df.on(o5,n),()=>{Df.off(o5,n)}},[r,t,e])}function MM(){var e=ta();U.useEffect(()=>{e(kM())},[e]),DM(),IM()}function RM(e,t,r,n,a,i){var s=qt(p=>pM(p,e,t)),o=qt(Xx),l=qt(Yx),c=qt(aS),f=qt(CM),h=f==null?void 0:f.active;U.useEffect(()=>{if(!h&&l!=null&&o!=null){var p=gg({active:i,coordinate:r,dataKey:s,index:a,label:typeof n=="number"?String(n):n});Df.emit(yg,l,p,o)}},[h,r,s,a,n,o,l,c,i])}function c5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function u5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?c5(Object(r),!0).forEach(function(n){BM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):c5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function BM(e,t,r){return(t=UM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function UM(e){var t=$M(e,"string");return typeof t=="symbol"?t:t+""}function $M(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function zM(e){return e.dataKey}function qM(e,t){return U.isValidElement(e)?U.cloneElement(e,t):typeof e=="function"?U.createElement(e,t):U.createElement(AO,t)}var f5=[],WM={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!fp.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function HM(e){var t=Io(e,WM),{active:r,allowEscapeViewBox:n,animationDuration:a,animationEasing:i,content:s,filterNull:o,isAnimationActive:l,offset:c,payloadUniqBy:f,position:h,reverseDirection:p,useTranslate3d:d,wrapperStyle:x,cursor:g,shared:y,trigger:b,defaultIndex:T,portal:S,axisId:k}=t,A=ta(),M=typeof T=="number"?String(T):T;U.useEffect(()=>{A(vI({shared:y,trigger:b,axisId:k,active:r,defaultIndex:M}))},[A,y,b,k,r,M]);var O=U3(),I=q3(),j=dI(y),{activeIndex:W,isActive:E}=qt(F=>xM(F,j,b,M)),C=qt(F=>gM(F,j,b,M)),G=qt(F=>r6(F,j,b,M)),Z=qt(F=>mM(F,j,b,M)),he=C,oe=SM(),me=r??E,[pe,ge]=Ik([he,me]),Le=j==="axis"?G:void 0;RM(j,b,Z,Le,W,me);var Se=S??oe;if(Se==null)return null;var N=he??f5;me||(N=f5),o&&N.length&&(N=ek(he.filter(F=>F.value!=null&&(F.hide!==!0||t.includeHidden)),f,zM));var D=N.length>0,L=U.createElement(OO,{allowEscapeViewBox:n,animationDuration:a,animationEasing:i,isAnimationActive:l,active:me,coordinate:Z,hasPayload:D,offset:c,position:h,reverseDirection:p,useTranslate3d:d,viewBox:O,wrapperStyle:x,lastBoundingBox:pe,innerRef:ge,hasPortalFromProps:!!S},qM(s,u5(u5({},t),{},{payload:N,label:Le,active:me,coordinate:Z,accessibilityLayer:I})));return U.createElement(U.Fragment,null,Y_.createPortal(L,Se),me&&U.createElement(NM,{cursor:g,tooltipEventType:j,coordinate:Z,payload:he,index:W}))}var l6={},c6={},u6={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n,{signal:a,edges:i}={}){let s,o=null;const l=i!=null&&i.includes("leading"),c=i==null||i.includes("trailing"),f=()=>{o!==null&&(r.apply(s,o),s=void 0,o=null)},h=()=>{c&&f(),g()};let p=null;const d=()=>{p!=null&&clearTimeout(p),p=setTimeout(()=>{p=null,h()},n)},x=()=>{p!==null&&(clearTimeout(p),p=null)},g=()=>{x(),s=void 0,o=null},y=()=>{f()},b=function(...T){if(a!=null&&a.aborted)return;s=this,o=T;const S=p==null;d(),l&&S&&f()};return b.schedule=d,b.cancel=g,b.flush=y,a==null||a.addEventListener("abort",g,{once:!0}),b}e.debounce=t})(u6);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=u6;function r(n,a=0,i={}){typeof i!="object"&&(i={});const{leading:s=!1,trailing:o=!0,maxWait:l}=i,c=Array(2);s&&(c[0]="leading"),o&&(c[1]="trailing");let f,h=null;const p=t.debounce(function(...g){f=n.apply(this,g),h=null},a,{edges:c}),d=function(...g){return l!=null&&(h===null&&(h=Date.now()),Date.now()-h>=l)?(f=n.apply(this,g),h=Date.now(),p.cancel(),p.schedule(),f):(p.apply(this,g),f)},x=()=>(p.flush(),f);return d.cancel=p.cancel,d.flush=x,d}e.debounce=r})(c6);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=c6;function r(n,a=0,i={}){const{leading:s=!0,trailing:o=!0}=i;return t.debounce(n,a,{leading:s,maxWait:a,trailing:o})}e.throttle=r})(l6);var GM=l6.throttle;const VM=Do(GM);var zm=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i]};function h5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function qm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?h5(Object(r),!0).forEach(function(n){KM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):h5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function KM(e,t,r){return(t=YM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function YM(e){var t=XM(e,"string");return typeof t=="symbol"?t:t+""}function XM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ZM=U.forwardRef((e,t)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:a="100%",height:i="100%",minWidth:s=0,minHeight:o,maxHeight:l,children:c,debounce:f=0,id:h,className:p,onResize:d,style:x={}}=e,g=U.useRef(null),y=U.useRef();y.current=d,U.useImperativeHandle(t,()=>g.current);var[b,T]=U.useState({containerWidth:n.width,containerHeight:n.height}),S=U.useCallback((A,M)=>{T(O=>{var I=Math.round(A),j=Math.round(M);return O.containerWidth===I&&O.containerHeight===j?O:{containerWidth:I,containerHeight:j}})},[]);U.useEffect(()=>{var A=j=>{var W,{width:E,height:C}=j[0].contentRect;S(E,C),(W=y.current)===null||W===void 0||W.call(y,E,C)};f>0&&(A=VM(A,f,{trailing:!0,leading:!1}));var M=new ResizeObserver(A),{width:O,height:I}=g.current.getBoundingClientRect();return S(O,I),M.observe(g.current),()=>{M.disconnect()}},[S,f]);var k=U.useMemo(()=>{var{containerWidth:A,containerHeight:M}=b;if(A<0||M<0)return null;zm(af(a)||af(i),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,a,i),zm(!r||r>0,"The aspect(%s) must be greater than zero.",r);var O=af(a)?A:a,I=af(i)?M:i;return r&&r>0&&(O?I=O/r:I&&(O=I*r),l&&I>l&&(I=l)),zm(O>0||I>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,O,I,a,i,s,o,r),U.Children.map(c,j=>U.cloneElement(j,{width:O,height:I,style:qm({width:O,height:I},j.props.style)}))},[r,c,i,l,o,s,b,a]);return U.createElement("div",{id:h?"".concat(h):void 0,className:jn("recharts-responsive-container",p),style:qm(qm({},x),{},{width:a,height:i,minWidth:s,minHeight:o,maxHeight:l}),ref:g},U.createElement("div",{style:{width:0,height:0,overflow:"visible"}},k))}),Tp=e=>null;Tp.displayName="Cell";function JM(e,t,r){return(t=QM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function QM(e){var t=e9(e,"string");return typeof t=="symbol"?t:t+""}function e9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class t9{constructor(t){JM(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function d5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function r9(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?d5(Object(r),!0).forEach(function(n){n9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):d5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function n9(e,t,r){return(t=a9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function a9(e){var t=i9(e,"string");return typeof t=="symbol"?t:t+""}function i9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var s9={cacheSize:2e3,enableCache:!0},f6=r9({},s9),p5=new t9(f6.cacheSize),o9={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},m5="recharts_measurement_span";function l9(e,t){var r=t.fontSize||"",n=t.fontFamily||"",a=t.fontWeight||"",i=t.fontStyle||"",s=t.letterSpacing||"",o=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(a,"|").concat(i,"|").concat(s,"|").concat(o)}var g5=(e,t)=>{try{var r=document.getElementById(m5);r||(r=document.createElement("span"),r.setAttribute("id",m5),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,o9,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},x5=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||fp.isSsr)return{width:0,height:0};if(!f6.enableCache)return g5(t,r);var n=l9(t,r),a=p5.get(n);if(a)return a;var i=g5(t,r);return p5.set(n,i),i},v5=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,y5=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,c9=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,u9=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,h6={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},f9=Object.keys(h6),bc="NaN";function h9(e,t){return e*h6[t]}class ya{static parse(t){var r,[,n,a]=(r=u9.exec(t))!==null&&r!==void 0?r:[];return new ya(parseFloat(n),a??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,Fi(t)&&(this.unit=""),r!==""&&!c9.test(r)&&(this.num=NaN,this.unit=""),f9.includes(r)&&(this.num=h9(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new ya(NaN,""):new ya(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new ya(NaN,""):new ya(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new ya(NaN,""):new ya(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new ya(NaN,""):new ya(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Fi(this.num)}}function d6(e){if(e.includes(bc))return bc;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,a,i]=(r=v5.exec(t))!==null&&r!==void 0?r:[],s=ya.parse(n??""),o=ya.parse(i??""),l=a==="*"?s.multiply(o):s.divide(o);if(l.isNaN())return bc;t=t.replace(v5,l.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var c,[,f,h,p]=(c=y5.exec(t))!==null&&c!==void 0?c:[],d=ya.parse(f??""),x=ya.parse(p??""),g=h==="+"?d.add(x):d.subtract(x);if(g.isNaN())return bc;t=t.replace(y5,g.toString())}return t}var b5=/\(([^()]*)\)/;function d9(e){for(var t=e,r;(r=b5.exec(t))!=null;){var[,n]=r;t=t.replace(b5,d6(n))}return t}function p9(e){var t=e.replace(/\s+/g,"");return t=d9(t),t=d6(t),t}function m9(e){try{return p9(e)}catch{return bc}}function Wm(e){var t=m9(e.slice(5,-1));return t===bc?"":t}var g9=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],x9=["dx","dy","angle","className","breakAll"];function bg(){return bg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},bg.apply(null,arguments)}function w5(e,t){if(e==null)return{};var r,n,a=v9(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function v9(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var p6=/[ \f\n\r\t\v\u2028\u2029]+/,m6=e=>{var{children:t,breakAll:r,style:n}=e;try{var a=[];El(t)||(r?a=t.toString().split(""):a=t.toString().split(p6));var i=a.map(o=>({word:o,width:x5(o,n).width})),s=r?0:x5("¬†",n).width;return{wordsWithComputedWidth:i,spaceWidth:s}}catch{return null}},y9=(e,t,r,n,a)=>{var{maxLines:i,children:s,style:o,breakAll:l}=e,c=Vt(i),f=s,h=function(){var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return E.reduce((C,G)=>{var{word:Z,width:he}=G,oe=C[C.length-1];if(oe&&(n==null||a||oe.width+he+r<Number(n)))oe.words.push(Z),oe.width+=he+r;else{var me={words:[Z],width:he};C.push(me)}return C},[])},p=h(t),d=W=>W.reduce((E,C)=>E.width>C.width?E:C);if(!c||a)return p;var x=p.length>i||d(p).width>Number(n);if(!x)return p;for(var g="‚Ä¶",y=W=>{var E=f.slice(0,W),C=m6({breakAll:l,style:o,children:E+g}).wordsWithComputedWidth,G=h(C),Z=G.length>i||d(G).width>Number(n);return[Z,G]},b=0,T=f.length-1,S=0,k;b<=T&&S<=f.length-1;){var A=Math.floor((b+T)/2),M=A-1,[O,I]=y(M),[j]=y(A);if(!O&&!j&&(b=A+1),O&&j&&(T=A-1),!O&&j){k=I;break}S++}return k||p},_5=e=>{var t=El(e)?[]:e.toString().split(p6);return[{words:t}]},b9=e=>{var{width:t,scaleToFit:r,children:n,style:a,breakAll:i,maxLines:s}=e;if((t||r)&&!fp.isSsr){var o,l,c=m6({breakAll:i,children:n,style:a});if(c){var{wordsWithComputedWidth:f,spaceWidth:h}=c;o=f,l=h}else return _5(n);return y9({breakAll:i,children:n,maxLines:s,style:a},o,l,t,r)}return _5(n)},N5="#808080",g6=U.forwardRef((e,t)=>{var{x:r=0,y:n=0,lineHeight:a="1em",capHeight:i="0.71em",scaleToFit:s=!1,textAnchor:o="start",verticalAnchor:l="end",fill:c=N5}=e,f=w5(e,g9),h=U.useMemo(()=>b9({breakAll:f.breakAll,children:f.children,maxLines:f.maxLines,scaleToFit:s,style:f.style,width:f.width}),[f.breakAll,f.children,f.maxLines,s,f.style,f.width]),{dx:p,dy:d,angle:x,className:g,breakAll:y}=f,b=w5(f,x9);if(!Ds(r)||!Ds(n))return null;var T=r+(Vt(p)?p:0),S=n+(Vt(d)?d:0),k;switch(l){case"start":k=Wm("calc(".concat(i,")"));break;case"middle":k=Wm("calc(".concat((h.length-1)/2," * -").concat(a," + (").concat(i," / 2))"));break;default:k=Wm("calc(".concat(h.length-1," * -").concat(a,")"));break}var A=[];if(s){var M=h[0].width,{width:O}=f;A.push("scale(".concat(Vt(O)?O/M:1,")"))}return x&&A.push("rotate(".concat(x,", ").concat(T,", ").concat(S,")")),A.length&&(b.transform=A.join(" ")),U.createElement("text",bg({},Ka(b,!0),{ref:t,x:T,y:S,className:jn("recharts-text",g),textAnchor:o,fill:c.includes("url")?N5:c}),h.map((I,j)=>{var W=I.words.join(y?"":" ");return U.createElement("tspan",{x:T,dy:j===0?k:a,key:"".concat(W,"-").concat(j)},W)}))});g6.displayName="Text";var x6=e=>e.graphicalItems.polarItems,w9=Ce([Fr,i0],rv),Tv=Ce([x6,Qr,w9],nv),_9=Ce([Tv],av),jv=Ce([_9,Hx],iv),N9=Ce([jv,Qr,Tv],ov),S9=Ce([jv,Qr,Tv],(e,t,r)=>r.length>0?e.flatMap(n=>r.flatMap(a=>{var i,s=sn(n,(i=t.dataKey)!==null&&i!==void 0?i:a.dataKey);return{value:s,errorDomain:[]}})).filter(Boolean):(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:sn(n,t.dataKey),errorDomain:[]})):e.map(n=>({value:n,errorDomain:[]}))),S5=()=>{},A9=Ce([Qr,ES,S5,S9,S5,Er,Fr],cv),v6=Ce([Qr,Er,jv,N9,a0,Fr,A9],uv),E9=Ce([v6,Qr,ou],dv);Ce([Qr,v6,E9,Fr],mv);var T9={radiusAxis:{},angleAxis:{}},j9=Ja({name:"polarAxis",initialState:T9,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),P9=j9.reducer;function A5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function E5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?A5(Object(r),!0).forEach(function(n){k9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):A5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function k9(e,t,r){return(t=C9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C9(e){var t=O9(e,"string");return typeof t=="symbol"?t:t+""}function O9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var L9=(e,t)=>t,Pv=Ce([x6,L9],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),F9=[],kv=(e,t,r)=>(r==null?void 0:r.length)===0?F9:r,y6=Ce([Hx,Pv,kv],(e,t,r)=>{var{chartData:n}=e;if(t!=null){var a;if((t==null?void 0:t.data)!=null&&t.data.length>0?a=t.data:a=n,(!a||!a.length)&&r!=null&&(a=r.map(i=>E5(E5({},t.presentationProps),i.props))),a!=null)return a}}),D9=Ce([y6,Pv,kv],(e,t,r)=>{if(!(e==null||t==null))return e.map((n,a)=>{var i,s=sn(n,t.nameKey,t.name),o;return r!=null&&(i=r[a])!==null&&i!==void 0&&(i=i.props)!==null&&i!==void 0&&i.fill?o=r[a].props.fill:typeof n=="object"&&n!=null&&"fill"in n?o=n.fill:o=t.fill,{value:I3(s,t.dataKey),color:o,payload:n,type:t.legendType}})}),I9=Ce([y6,Pv,kv,ra],(e,t,r,n)=>{if(!(t==null||e==null))return LR({offset:n,pieSettings:t,displayedData:e,cells:r})}),b6={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var a;if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const i=r[Symbol.toStringTag];return i==null||!((a=Object.getOwnPropertyDescriptor(r,Symbol.toStringTag))!=null&&a.writable)?!1:r.toString()===`[object ${i}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}e.isPlainObject=t})(b6);var M9=b6.isPlainObject;const R9=Do(M9);function fd(){return fd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fd.apply(null,arguments)}var T5=(e,t,r,n,a)=>{var i=r-n,s;return s="M ".concat(e,",").concat(t),s+="L ".concat(e+r,",").concat(t),s+="L ".concat(e+r-i/2,",").concat(t+a),s+="L ".concat(e+r-i/2-n,",").concat(t+a),s+="L ".concat(e,",").concat(t," Z"),s},B9={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},U9=e=>{var t=Io(e,B9),r=U.useRef(),[n,a]=U.useState(-1);U.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var y=r.current.getTotalLength();y&&a(y)}catch{}},[]);var{x:i,y:s,upperWidth:o,lowerWidth:l,height:c,className:f}=t,{animationEasing:h,animationDuration:p,animationBegin:d,isUpdateAnimationActive:x}=t;if(i!==+i||s!==+s||o!==+o||l!==+l||c!==+c||o===0&&l===0||c===0)return null;var g=jn("recharts-trapezoid",f);return x?U.createElement(Xh,{canBegin:n>0,from:{upperWidth:0,lowerWidth:0,height:c,x:i,y:s},to:{upperWidth:o,lowerWidth:l,height:c,x:i,y:s},duration:p,animationEasing:h,isActive:x},y=>{var{upperWidth:b,lowerWidth:T,height:S,x:k,y:A}=y;return U.createElement(Xh,{canBegin:n>0,from:"0px ".concat(n===-1?1:n,"px"),to:"".concat(n,"px 0px"),attributeName:"strokeDasharray",begin:d,duration:p,easing:h},U.createElement("path",fd({},Ka(t,!0),{className:g,d:T5(k,A,b,T,S),ref:r})))}):U.createElement("g",null,U.createElement("path",fd({},Ka(t,!0),{className:g,d:T5(i,s,o,l,c)})))},$9=["option","shapeType","propTransformer","activeClassName","isActive"];function z9(e,t){if(e==null)return{};var r,n,a=q9(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function q9(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function j5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function hd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?j5(Object(r),!0).forEach(function(n){W9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function W9(e,t,r){return(t=H9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function H9(e){var t=G9(e,"string");return typeof t=="symbol"?t:t+""}function G9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function V9(e,t){return hd(hd({},t),e)}function K9(e,t){return e==="symbols"}function P5(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return U.createElement(tN,r);case"trapezoid":return U.createElement(U9,r);case"sector":return U.createElement(aN,r);case"symbols":if(K9(t))return U.createElement(M4,r);break;default:return null}}function Y9(e){return U.isValidElement(e)?e.props:e}function X9(e){var{option:t,shapeType:r,propTransformer:n=V9,activeClassName:a="recharts-active-shape",isActive:i}=e,s=z9(e,$9),o;if(U.isValidElement(t))o=U.cloneElement(t,hd(hd({},s),Y9(t)));else if(typeof t=="function")o=t(s);else if(R9(t)&&typeof t!="boolean"){var l=n(t,s);o=U.createElement(P5,{shapeType:r,elementProps:l})}else{var c=s;o=U.createElement(P5,{shapeType:r,elementProps:c})}return i?U.createElement($c,{className:a},o):o}var Z9=(e,t)=>{var r=ta();return(n,a)=>i=>{e==null||e(n,a,i),r(BS({activeIndex:String(a),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}},J9=e=>{var t=ta();return(r,n)=>a=>{e==null||e(r,n,a),t(yI())}},Q9=(e,t)=>{var r=ta();return(n,a)=>i=>{e==null||e(n,a,i),r(bI({activeIndex:String(a),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}};function eR(e){var{fn:t,args:r}=e,n=ta(),a=Qc();return U.useEffect(()=>{if(!a){var i=t(r);return n(gI(i)),()=>{n(xI(i))}}},[t,r,n,a]),null}var tR=()=>{};function rR(e){var{legendPayload:t}=e,r=ta(),n=qt(Er);return U.useEffect(()=>n!=="centric"&&n!=="radial"?tR:(r(vO(t)),()=>{r(yO(t))}),[r,n,t]),null}function nR(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=U.useRef(Lh(t)),n=U.useRef(e);return n.current!==e&&(r.current=Lh(t),n.current=e),r.current}var Hm,aR=()=>{var[e]=U.useState(()=>Lh("uid-"));return e},iR=(Hm=u8.useId)!==null&&Hm!==void 0?Hm:aR;function sR(e,t){var r=iR();return t||(e?"".concat(e,"-").concat(r):r)}var oR=U.createContext(void 0),lR=e=>{var{id:t,type:r,children:n}=e,a=sR("recharts-".concat(r),t);return U.createElement(oR.Provider,{value:a},n(a))},cR={cartesianItems:[],polarItems:[]},w6=Ja({name:"graphicalItems",initialState:cR,reducers:{addCartesianGraphicalItem(e,t){e.cartesianItems.push(t.payload)},replaceCartesianGraphicalItem(e,t){var{prev:r,next:n}=t.payload,a=ks(e).cartesianItems.indexOf(r);a>-1&&(e.cartesianItems[a]=n)},removeCartesianGraphicalItem(e,t){var r=ks(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},addPolarGraphicalItem(e,t){e.polarItems.push(t.payload)},removePolarGraphicalItem(e,t){var r=ks(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)}}}),{addCartesianGraphicalItem:xJ,replaceCartesianGraphicalItem:vJ,removeCartesianGraphicalItem:yJ,addPolarGraphicalItem:uR,removePolarGraphicalItem:fR}=w6.actions,hR=w6.reducer;function dR(e){var t=ta();return U.useEffect(()=>(t(uR(e)),()=>{t(fR(e))}),[t,e]),null}function pR(){}var mR={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},k5={t:0},Gm={t:1};function gR(e){var t=Io(e,mR),{isActive:r,canBegin:n,duration:a,easing:i,begin:s,onAnimationEnd:o,onAnimationStart:l,children:c}=t,f=eN("JavascriptAnimate",t.animationManager),[h,p]=U.useState(r?k5:Gm),d=U.useRef(null);return U.useEffect(()=>{r||p(Gm)},[r]),U.useEffect(()=>{if(!r||!n)return pR;var x=Q3(k5,Gm,Z3(i),a,p,f.getTimeoutController()),g=()=>{d.current=x()};return f.start([l,s,g,a,o]),()=>{f.stop(),d.current&&d.current(),o()}},[r,n,a,i,s,l,o,f]),c(h.t)}var xR=["onMouseEnter","onClick","onMouseLeave"],vR=["id"],yR=["id"];function Cv(e,t){if(e==null)return{};var r,n,a=bR(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function bR(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function C5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function $r(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?C5(Object(r),!0).forEach(function(n){wR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):C5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function wR(e,t,r){return(t=_R(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _R(e){var t=NR(e,"string");return typeof t=="symbol"?t:t+""}function NR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Us(){return Us=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Us.apply(null,arguments)}function SR(e){var t=U.useMemo(()=>v4(e.children,Tp),[e.children]),r=qt(n=>D9(n,e.id,t));return r==null?null:U.createElement(rR,{legendPayload:r})}function AR(e){var{dataKey:t,nameKey:r,sectors:n,stroke:a,strokeWidth:i,fill:s,name:o,hide:l,tooltipType:c}=e;return{dataDefinedOnItem:n==null?void 0:n.map(f=>f.tooltipPayload),positions:n==null?void 0:n.map(f=>f.tooltipPosition),settings:{stroke:a,strokeWidth:i,fill:s,dataKey:t,nameKey:r,name:I3(o,t),hide:l,type:c,color:s,unit:""}}}var ER=(e,t)=>e>t?"start":e<t?"end":"middle",TR=(e,t,r)=>typeof t=="function"?t(e):rs(t,r,r*.8),jR=(e,t,r)=>{var{top:n,left:a,width:i,height:s}=t,o=F3(i,s),l=a+rs(e.cx,i,i/2),c=n+rs(e.cy,s,s/2),f=rs(e.innerRadius,o,0),h=TR(r,e.outerRadius,o),p=e.maxRadius||Math.sqrt(i*i+s*s)/2;return{cx:l,cy:c,innerRadius:f,outerRadius:h,maxRadius:p}},PR=(e,t)=>{var r=Wa(t-e),n=Math.min(Math.abs(t-e),360);return r*n},kR=(e,t)=>{if(U.isValidElement(e))return U.cloneElement(e,t);if(typeof e=="function")return e(t);var r=jn("recharts-pie-label-line",typeof e!="boolean"?e.className:"");return U.createElement(W3,Us({},t,{type:"linear",className:r}))},CR=(e,t,r)=>{if(U.isValidElement(e))return U.cloneElement(e,t);var n=r;if(typeof e=="function"&&(n=e(t),U.isValidElement(n)))return n;var a=jn("recharts-pie-label-text",typeof e!="boolean"&&typeof e!="function"?e.className:"");return U.createElement(g6,Us({},t,{alignmentBaseline:"middle",className:a}),n)};function OR(e){var{sectors:t,props:r,showLabels:n}=e,{label:a,labelLine:i,dataKey:s}=r;if(!n||!a||!t)return null;var o=Vd(r),l=Ka(a,!1),c=Ka(i,!1),f=typeof a=="object"&&"offsetRadius"in a&&a.offsetRadius||20,h=t.map((p,d)=>{var x=(p.startAngle+p.endAngle)/2,g=Jn(p.cx,p.cy,p.outerRadius+f,x),y=$r($r($r($r({},o),p),{},{stroke:"none"},l),{},{index:d,textAnchor:ER(g.x,p.cx)},g),b=$r($r($r($r({},o),p),{},{fill:"none",stroke:p.fill},c),{},{index:d,points:[Jn(p.cx,p.cy,p.outerRadius,x),g],key:"line"});return U.createElement($c,{key:"label-".concat(p.startAngle,"-").concat(p.endAngle,"-").concat(p.midAngle,"-").concat(d)},i&&kR(i,b),CR(a,y,sn(p,s)))});return U.createElement($c,{className:"recharts-pie-labels"},h)}function _6(e){var{sectors:t,activeShape:r,inactiveShape:n,allOtherPieProps:a,showLabels:i}=e,s=qt(Ff),{onMouseEnter:o,onClick:l,onMouseLeave:c}=a,f=Cv(a,xR),h=Z9(o,a.dataKey),p=J9(c),d=Q9(l,a.dataKey);return t==null?null:U.createElement(U.Fragment,null,t.map((x,g)=>{if((x==null?void 0:x.startAngle)===0&&(x==null?void 0:x.endAngle)===0&&t.length!==1)return null;var y=r&&String(g)===s,b=s?n:null,T=y?r:b,S=$r($r({},x),{},{stroke:x.stroke,tabIndex:-1,[R3]:g,[B3]:a.dataKey});return U.createElement($c,Us({tabIndex:-1,className:"recharts-pie-sector"},Qj(f,x,g),{onMouseEnter:h(x,g),onMouseLeave:p(x,g),onClick:d(x,g),key:"sector-".concat(x==null?void 0:x.startAngle,"-").concat(x==null?void 0:x.endAngle,"-").concat(x.midAngle,"-").concat(g)}),U.createElement(X9,Us({option:T,isActive:y,shapeType:"sector"},S)))}),U.createElement(OR,{sectors:t,props:a,showLabels:i}))}function LR(e){var t,{pieSettings:r,displayedData:n,cells:a,offset:i}=e,{cornerRadius:s,startAngle:o,endAngle:l,dataKey:c,nameKey:f,tooltipType:h}=r,p=Math.abs(r.minAngle),d=PR(o,l),x=Math.abs(d),g=n.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,y=n.filter(M=>sn(M,c,0)!==0).length,b=(x>=360?y:y-1)*g,T=x-y*p-b,S=n.reduce((M,O)=>{var I=sn(O,c,0);return M+(Vt(I)?I:0)},0),k;if(S>0){var A;k=n.map((M,O)=>{var I=sn(M,c,0),j=sn(M,f,O),W=jR(r,i,M),E=(Vt(I)?I:0)/S,C,G=$r($r({},M),a&&a[O]&&a[O].props);O?C=A.endAngle+Wa(d)*g*(I!==0?1:0):C=o;var Z=C+Wa(d)*((I!==0?p:0)+E*T),he=(C+Z)/2,oe=(W.innerRadius+W.outerRadius)/2,me=[{name:j,value:I,payload:G,dataKey:c,type:h}],pe=Jn(W.cx,W.cy,oe,he);return A=$r($r($r($r({},r.presentationProps),{},{percent:E,cornerRadius:s,name:j,tooltipPayload:me,midAngle:he,middleRadius:oe,tooltipPosition:pe},G),W),{},{value:sn(M,c),startAngle:C,endAngle:Z,payload:G,paddingAngle:Wa(d)*g}),A})}return k}function FR(e){var{props:t,previousSectorsRef:r}=e,{sectors:n,isAnimationActive:a,animationBegin:i,animationDuration:s,animationEasing:o,activeShape:l,inactiveShape:c,onAnimationStart:f,onAnimationEnd:h}=t,p=nR(t,"recharts-pie-"),d=r.current,[x,g]=U.useState(!0),y=U.useCallback(()=>{typeof h=="function"&&h(),g(!1)},[h]),b=U.useCallback(()=>{typeof f=="function"&&f(),g(!0)},[f]);return U.createElement(gR,{begin:i,duration:s,isActive:a,easing:o,onAnimationStart:b,onAnimationEnd:y,key:p},T=>{var S=[],k=n&&n[0],A=k.startAngle;return n.forEach((M,O)=>{var I=d&&d[O],j=O>0?Uc(M,"paddingAngle",0):0;if(I){var W=xy(I.endAngle-I.startAngle,M.endAngle-M.startAngle),E=$r($r({},M),{},{startAngle:A+j,endAngle:A+W(T)+j});S.push(E),A=E.endAngle}else{var{endAngle:C,startAngle:G}=M,Z=xy(0,C-G),he=Z(T),oe=$r($r({},M),{},{startAngle:A+j,endAngle:A+he+j});S.push(oe),A=oe.endAngle}}),r.current=S,U.createElement($c,null,U.createElement(_6,{sectors:S,activeShape:l,inactiveShape:c,allOtherPieProps:t,showLabels:!x}))})}function DR(e){var{sectors:t,isAnimationActive:r,activeShape:n,inactiveShape:a}=e,i=U.useRef(null),s=i.current;return r&&t&&t.length&&(!s||s!==t)?U.createElement(FR,{props:e,previousSectorsRef:i}):U.createElement(_6,{sectors:t,activeShape:n,inactiveShape:a,allOtherPieProps:e,showLabels:!0})}function IR(e){var{hide:t,className:r,rootTabIndex:n}=e,a=jn("recharts-pie",r);return t?null:U.createElement($c,{tabIndex:n,className:a},U.createElement(DR,e))}var MR={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!fp.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff"};function RR(e){var{id:t}=e,r=Cv(e,vR),n=U.useMemo(()=>v4(e.children,Tp),[e.children]),a=qt(i=>I9(i,t,n));return U.createElement(U.Fragment,null,U.createElement(eR,{fn:AR,args:$r($r({},e),{},{sectors:a})}),U.createElement(IR,Us({},r,{sectors:a})))}function N6(e){var t=Io(e,MR),{id:r}=t,n=Cv(t,yR),a=Vd(n);return U.createElement(lR,{id:r,type:"pie"},i=>U.createElement(U.Fragment,null,U.createElement(dR,{type:"pie",id:i,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:a}),U.createElement(SR,Us({},n,{id:i})),U.createElement(RR,Us({},n,{id:i})),n.children))}N6.displayName="Pie";var BR=Ce([ra],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),UR=Ce([BR,qs,Ws],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),$R=()=>qt(UR),zR={},qR=Ja({name:"errorBars",initialState:zR,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(a=>a.dataKey!==n.dataKey||a.direction!==n.direction))}}}),WR=qR.reducer,HR=e=>{var{chartData:t}=e,r=ta(),n=Qc();return U.useEffect(()=>n?()=>{}:(r(l5(t)),()=>{r(l5(void 0))}),[t,r,n]),null},O5={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},GR=Ja({name:"brush",initialState:O5,reducers:{setBrushSettings(e,t){return t.payload==null?O5:t.payload}}}),VR=GR.reducer,KR={dots:[],areas:[],lines:[]},YR=Ja({name:"referenceElements",initialState:KR,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=ks(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=ks(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=ks(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),XR=YR.reducer,ZR=U.createContext(void 0),JR=e=>{var{children:t}=e,[r]=U.useState("".concat(Lh("recharts"),"-clip")),n=$R();if(n==null)return null;var{x:a,y:i,width:s,height:o}=n;return U.createElement(ZR.Provider,{value:r},U.createElement("defs",null,U.createElement("clipPath",{id:r},U.createElement("rect",{x:a,y:i,height:o,width:s}))),t)};function L5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function F5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?L5(Object(r),!0).forEach(function(n){QR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):L5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function QR(e,t,r){return(t=eB(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function eB(e){var t=tB(e,"string");return typeof t=="symbol"?t:t+""}function tB(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var rB={xAxis:{},yAxis:{},zAxis:{}},nB=Ja({name:"cartesianAxis",initialState:rB,reducers:{addXAxis(e,t){e.xAxis[t.payload.id]=t.payload},removeXAxis(e,t){delete e.xAxis[t.payload.id]},addYAxis(e,t){e.yAxis[t.payload.id]=t.payload},removeYAxis(e,t){delete e.yAxis[t.payload.id]},addZAxis(e,t){e.zAxis[t.payload.id]=t.payload},removeZAxis(e,t){delete e.zAxis[t.payload.id]},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload;e.yAxis[r]&&(e.yAxis[r]=F5(F5({},e.yAxis[r]),{},{width:n}))}}}),aB=nB.reducer,iB={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f0=U;function sB(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var oB=typeof Object.is=="function"?Object.is:sB,lB=f0.useSyncExternalStore,cB=f0.useRef,uB=f0.useEffect,fB=f0.useMemo,hB=f0.useDebugValue;iB.useSyncExternalStoreWithSelector=function(e,t,r,n,a){var i=cB(null);if(i.current===null){var s={hasValue:!1,value:null};i.current=s}else s=i.current;i=fB(function(){function l(d){if(!c){if(c=!0,f=d,d=n(d),a!==void 0&&s.hasValue){var x=s.value;if(a(x,d))return h=x}return h=d}if(x=h,oB(f,d))return x;var g=n(d);return a!==void 0&&a(x,g)?(f=d,x):(f=d,h=g)}var c=!1,f,h,p=r===void 0?null:r;return[function(){return l(t())},p===null?void 0:function(){return l(p())}]},[t,r,n,a]);var o=lB(e,i[0],i[1]);return uB(function(){s.hasValue=!0,s.value=o},[o]),hB(o),o};function dB(e){e()}function pB(){let e=null,t=null;return{clear(){e=null,t=null},notify(){dB(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const a=t={callback:r,next:null,prev:t};return a.prev?a.prev.next=a:e=a,function(){!n||e===null||(n=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}var D5={notify(){},get:()=>[]};function mB(e,t){let r,n=D5,a=0,i=!1;function s(g){f();const y=n.subscribe(g);let b=!1;return()=>{b||(b=!0,y(),h())}}function o(){n.notify()}function l(){x.onStateChange&&x.onStateChange()}function c(){return i}function f(){a++,r||(r=e.subscribe(l),n=pB())}function h(){a--,r&&a===0&&(r(),r=void 0,n.clear(),n=D5)}function p(){i||(i=!0,f())}function d(){i&&(i=!1,h())}const x={addNestedSub:s,notifyNestedSubs:o,handleChangeWrapper:l,isSubscribed:c,trySubscribe:p,tryUnsubscribe:d,getListeners:()=>n};return x}var gB=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",xB=gB(),vB=()=>typeof navigator<"u"&&navigator.product==="ReactNative",yB=vB(),bB=()=>xB||yB?U.useLayoutEffect:U.useEffect,wB=bB(),Vm=Symbol.for("react-redux-context"),Km=typeof globalThis<"u"?globalThis:{};function _B(){if(!U.createContext)return{};const e=Km[Vm]??(Km[Vm]=new Map);let t=e.get(U.createContext);return t||(t=U.createContext(null),e.set(U.createContext,t)),t}var NB=_B();function SB(e){const{children:t,context:r,serverState:n,store:a}=e,i=U.useMemo(()=>{const l=mB(a);return{store:a,subscription:l,getServerState:n?()=>n:void 0}},[a,n]),s=U.useMemo(()=>a.getState(),[a]);wB(()=>{const{subscription:l}=i;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),s!==a.getState()&&l.notifyNestedSubs(),()=>{l.tryUnsubscribe(),l.onStateChange=void 0}},[i,s]);const o=r||NB;return U.createElement(o.Provider,{value:i},t)}var AB=SB,EB=(e,t)=>t,Ov=Ce([EB,Er,_D,vn,KS,Gs,dM,ra],vM),Lv=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},S6=hi("mouseClick"),A6=Qf();A6.startListening({actionCreator:S6,effect:(e,t)=>{var r=e.payload,n=Ov(t.getState(),Lv(r));(n==null?void 0:n.activeIndex)!=null&&t.dispatch(wI({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var wg=hi("mouseMove"),E6=Qf();E6.startListening({actionCreator:wg,effect:(e,t)=>{var r=e.payload,n=t.getState(),a=vv(n,n.tooltip.settings.shared),i=Ov(n,Lv(r));a==="axis"&&((i==null?void 0:i.activeIndex)!=null?t.dispatch($S({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate})):t.dispatch(US()))}});function TB(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":t}var I5={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},T6=Ja({name:"rootProps",initialState:I5,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:I5.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),jB=T6.reducer,{updateOptions:PB}=T6.actions,j6=Ja({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:kB}=j6.actions,CB=j6.reducer,P6=hi("keyDown"),k6=hi("focus"),Fv=Qf();Fv.startListening({actionCreator:P6,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip,i=e.payload;if(!(i!=="ArrowRight"&&i!=="ArrowLeft"&&i!=="Enter")){var s=Number(yv(a,cu(r))),o=Gs(r);if(i==="Enter"){var l=ud(r,"axis","hover",String(a.index));t.dispatch(xg({active:!a.active,activeIndex:a.index,activeDataKey:a.dataKey,activeCoordinate:l}));return}var c=hI(r),f=c==="left-to-right"?1:-1,h=i==="ArrowRight"?1:-1,p=s+h*f;if(!(o==null||p>=o.length||p<0)){var d=ud(r,"axis","hover",String(p));t.dispatch(xg({active:!0,activeIndex:p.toString(),activeDataKey:void 0,activeCoordinate:d}))}}}}});Fv.startListening({actionCreator:k6,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&a.index==null){var i="0",s=ud(r,"axis","hover",String(i));t.dispatch(xg({activeDataKey:void 0,active:!0,activeIndex:i,activeCoordinate:s}))}}}});var ii=hi("externalEvent"),C6=Qf();C6.startListening({actionCreator:ii,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),n={activeCoordinate:aM(r),activeDataKey:rM(r),activeIndex:Ff(r),activeLabel:ZS(r),activeTooltipIndex:Ff(r),isTooltipActive:iM(r)};e.payload.handler(n,e.payload.reactEvent)}}});var OB=Ce([lu],e=>e.tooltipItemPayloads),LB=Ce([OB,c0,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,n)=>{var a=e.find(o=>o.settings.dataKey===n);if(a!=null){var{positions:i}=a;if(i!=null){var s=t(i,r);return s}}}),O6=hi("touchMove"),L6=Qf();L6.startListening({actionCreator:O6,effect:(e,t)=>{var r=e.payload,n=t.getState(),a=vv(n,n.tooltip.settings.shared);if(a==="axis"){var i=Ov(n,Lv({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));(i==null?void 0:i.activeIndex)!=null&&t.dispatch($S({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate}))}else if(a==="item"){var s,o=r.touches[0],l=document.elementFromPoint(o.clientX,o.clientY);if(!l||!l.getAttribute)return;var c=l.getAttribute(R3),f=(s=l.getAttribute(B3))!==null&&s!==void 0?s:void 0,h=LB(t.getState(),c,f);t.dispatch(BS({activeDataKey:f,activeIndex:c,activeCoordinate:h}))}}});var FB=f3({brush:VR,cartesianAxis:aB,chartData:FM,errorBars:WR,graphicalItems:hR,layout:LC,legend:bO,options:PM,polarAxis:P9,polarOptions:CB,referenceElements:XR,rootProps:jB,tooltip:_I}),DB=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return aC({reducer:FB,preloadedState:t,middleware:n=>n({serializableCheck:!1}).concat([A6.middleware,E6.middleware,Fv.middleware,C6.middleware,L6.middleware]),devTools:{serialize:{replacer:TB},name:"recharts-".concat(r)}})};function IB(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,a=Qc(),i=U.useRef(null);if(a)return r;i.current==null&&(i.current=DB(t,n));var s=fx;return U.createElement(AB,{context:s,store:i.current},r)}function MB(e){var{layout:t,width:r,height:n,margin:a}=e,i=ta(),s=Qc();return U.useEffect(()=>{s||(i(kC(t)),i(CC({width:r,height:n})),i(PC(a)))},[i,s,t,r,n,a]),null}function RB(e){var t=ta();return U.useEffect(()=>{t(PB(e))},[t,e]),null}var BB=["children"];function UB(e,t){if(e==null)return{};var r,n,a=$B(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function $B(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function dd(){return dd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},dd.apply(null,arguments)}var zB={width:"100%",height:"100%"},qB=U.forwardRef((e,t)=>{var r=mO(),n=gO(),a=q3();if(!Vh(r)||!Vh(n))return null;var{children:i,otherAttributes:s,title:o,desc:l}=e,c,f;return typeof s.tabIndex=="number"?c=s.tabIndex:c=a?0:void 0,typeof s.role=="string"?f=s.role:f=a?"application":void 0,U.createElement(y4,dd({},s,{title:o,desc:l,role:f,tabIndex:c,width:r,height:n,style:zB,ref:t}),i)}),WB=e=>{var{children:t}=e,r=qt(up);if(!r)return null;var{width:n,height:a,y:i,x:s}=r;return U.createElement(y4,{width:n,height:a,x:s,y:i},t)},M5=U.forwardRef((e,t)=>{var{children:r}=e,n=UB(e,BB),a=Qc();return a?U.createElement(WB,null,r):U.createElement(qB,dd({ref:t},n),r)});function HB(){var e=ta(),[t,r]=U.useState(null),n=qt(sO);return U.useEffect(()=>{if(t!=null){var a=t.getBoundingClientRect(),i=a.width/t.offsetWidth;Di(i)&&i!==n&&e(OC(i))}},[t,e,n]),r}function R5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function GB(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?R5(Object(r),!0).forEach(function(n){VB(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):R5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VB(e,t,r){return(t=KB(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KB(e){var t=YB(e,"string");return typeof t=="symbol"?t:t+""}function YB(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var XB=U.forwardRef((e,t)=>{var{children:r,className:n,height:a,onClick:i,onContextMenu:s,onDoubleClick:o,onMouseDown:l,onMouseEnter:c,onMouseLeave:f,onMouseMove:h,onMouseUp:p,onTouchEnd:d,onTouchMove:x,onTouchStart:g,style:y,width:b}=e,T=ta(),[S,k]=U.useState(null),[A,M]=U.useState(null);MM();var O=HB(),I=U.useCallback(N=>{O(N),typeof t=="function"&&t(N),k(N),M(N)},[O,t,k,M]),j=U.useCallback(N=>{T(S6(N)),T(ii({handler:i,reactEvent:N}))},[T,i]),W=U.useCallback(N=>{T(wg(N)),T(ii({handler:c,reactEvent:N}))},[T,c]),E=U.useCallback(N=>{T(US()),T(ii({handler:f,reactEvent:N}))},[T,f]),C=U.useCallback(N=>{T(wg(N)),T(ii({handler:h,reactEvent:N}))},[T,h]),G=U.useCallback(()=>{T(k6())},[T]),Z=U.useCallback(N=>{T(P6(N.key))},[T]),he=U.useCallback(N=>{T(ii({handler:s,reactEvent:N}))},[T,s]),oe=U.useCallback(N=>{T(ii({handler:o,reactEvent:N}))},[T,o]),me=U.useCallback(N=>{T(ii({handler:l,reactEvent:N}))},[T,l]),pe=U.useCallback(N=>{T(ii({handler:p,reactEvent:N}))},[T,p]),ge=U.useCallback(N=>{T(ii({handler:g,reactEvent:N}))},[T,g]),Le=U.useCallback(N=>{T(O6(N)),T(ii({handler:x,reactEvent:N}))},[T,x]),Se=U.useCallback(N=>{T(ii({handler:d,reactEvent:N}))},[T,d]);return U.createElement(n6.Provider,{value:S},U.createElement(lP.Provider,{value:A},U.createElement("div",{className:jn("recharts-wrapper",n),style:GB({position:"relative",cursor:"default",width:b,height:a},y),onClick:j,onContextMenu:he,onDoubleClick:oe,onFocus:G,onKeyDown:Z,onMouseDown:me,onMouseEnter:W,onMouseLeave:E,onMouseMove:C,onMouseUp:pe,onTouchEnd:Se,onTouchMove:Le,onTouchStart:ge,ref:I},r)))}),ZB=["children","className","width","height","style","compact","title","desc"];function JB(e,t){if(e==null)return{};var r,n,a=QB(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function QB(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var eU=U.forwardRef((e,t)=>{var{children:r,className:n,width:a,height:i,style:s,compact:o,title:l,desc:c}=e,f=JB(e,ZB),h=Vd(f);return o?U.createElement(M5,{otherAttributes:h,title:l,desc:c},r):U.createElement(XB,{className:n,style:s,width:a,height:i,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},U.createElement(M5,{otherAttributes:h,title:l,desc:c,ref:t},U.createElement(JR,null,r)))});function tU(e){var t=ta();return U.useEffect(()=>{t(kB(e))},[t,e]),null}var rU=["width","height","layout"];function _g(){return _g=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},_g.apply(null,arguments)}function nU(e,t){if(e==null)return{};var r,n,a=aU(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function aU(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var iU={top:5,right:5,bottom:5,left:5},sU={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:iU,reverseStackOrder:!1,syncMethod:"index",layout:"radial"},oU=U.forwardRef(function(t,r){var n,a=Io(t.categoricalChartProps,sU),{width:i,height:s,layout:o}=a,l=nU(a,rU);if(!Vh(i)||!Vh(s))return null;var{chartName:c,defaultTooltipEventType:f,validateTooltipEventTypes:h,tooltipPayloadSearcher:p}=t,d={chartName:c,defaultTooltipEventType:f,validateTooltipEventTypes:h,tooltipPayloadSearcher:p,eventEmitter:void 0};return U.createElement(IB,{preloadedState:{options:d},reduxStoreName:(n=a.id)!==null&&n!==void 0?n:c},U.createElement(HR,{chartData:a.data}),U.createElement(MB,{width:i,height:s,layout:o,margin:a.margin}),U.createElement(RB,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),U.createElement(tU,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),U.createElement(eU,_g({width:i,height:s},l,{ref:r})))}),lU=["item"],cU={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},uU=U.forwardRef((e,t)=>{var r=Io(e,cU);return U.createElement(oU,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:lU,tooltipPayloadSearcher:TM,categoricalChartProps:r,ref:t})});/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var pd={};pd.version="0.18.5";var F6=1252,fU=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],D6=function(e){fU.indexOf(e)!=-1&&(F6=e)};function hU(){D6(1252)}var If=function(e){D6(e)};function dU(){If(1200),hU()}var ih=function(t){return String.fromCharCode(t)},B5=function(t){return String.fromCharCode(t)},al,vo="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Mf(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),i=r>>2,n=e.charCodeAt(c++),s=(r&3)<<4|n>>4,a=e.charCodeAt(c++),o=(n&15)<<2|a>>6,l=a&63,isNaN(n)?o=l=64:isNaN(a)&&(l=64),t+=vo.charAt(i)+vo.charAt(s)+vo.charAt(o)+vo.charAt(l);return t}function $s(e){var t="",r=0,n=0,a=0,i=0,s=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)i=vo.indexOf(e.charAt(c++)),s=vo.indexOf(e.charAt(c++)),r=i<<2|s>>4,t+=String.fromCharCode(r),o=vo.indexOf(e.charAt(c++)),n=(s&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=vo.indexOf(e.charAt(c++)),a=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(a));return t}var ar=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Vs=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function kl(e){return ar?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function U5(e){return ar?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ci=function(t){return ar?Vs(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function jp(e){if(typeof ArrayBuffer>"u")return Ci(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function h0(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function pU(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var $n=ar?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Vs(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function mU(e){for(var t=[],r=0,n=e.length+250,a=kl(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[r++]=s;else if(s<2048)a[r++]=192|s>>6&31,a[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++i)&1023;a[r++]=240|s>>8&7,a[r++]=128|s>>2&63,a[r++]=128|o>>6&15|(s&3)<<4,a[r++]=128|o&63}else a[r++]=224|s>>12&15,a[r++]=128|s>>6&63,a[r++]=128|s&63;r>n&&(t.push(a.slice(0,r)),r=0,a=kl(65535),n=65530)}return t.push(a.slice(0,r)),$n(t)}var df=/\u0000/g,sh=/[\u0001-\u0006]/g;function jc(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Oi(e,t){var r=""+e;return r.length>=t?r:zr("0",t-r.length)+r}function Dv(e,t){var r=""+e;return r.length>=t?r:zr(" ",t-r.length)+r}function md(e,t){var r=""+e;return r.length>=t?r:r+zr(" ",t-r.length)}function gU(e,t){var r=""+Math.round(e);return r.length>=t?r:zr("0",t-r.length)+r}function xU(e,t){var r=""+e;return r.length>=t?r:zr("0",t-r.length)+r}var $5=Math.pow(2,32);function oc(e,t){if(e>$5||e<-$5)return gU(e,t);var r=Math.round(e);return xU(r,t)}function gd(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var z5=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Ym=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function vU(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"‰∏äÂçà/‰∏ãÂçà "hh"ÊôÇ"mm"ÂàÜ"ss"Áßí "',e}var qr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"‰∏äÂçà/‰∏ãÂçà "hh"ÊôÇ"mm"ÂàÜ"ss"Áßí "'},q5={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},yU={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function xd(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,s=1,o=0,l=1,c=0,f=0,h=Math.floor(a);c<t&&(h=Math.floor(a),o=h*s+i,f=h*c+l,!(a-h<5e-8));)a=1/(a-h),i=s,s=o,l=c,c=f;if(f>t&&(c>t?(f=l,o=i):(f=c,o=s)),!r)return[0,n*o,f];var p=Math.floor(n*o/f);return[p,n*o-p*f,f]}function oh(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,s=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)s=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],i=l.getDay(),n<60&&(i=(i+6)%7),r&&(i=EU(l,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=i,o}var I6=new Date(1899,11,31,0,0,0),bU=I6.getTime(),wU=new Date(1900,2,1,0,0,0);function M6(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=wU&&(r+=24*60*60*1e3),(r-(bU+(e.getTimezoneOffset()-I6.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Iv(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function _U(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function NU(e){var t=e<0?12:11,r=Iv(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function SU(e){var t=Iv(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function AU(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=NU(e):t===10?r=e.toFixed(10).substr(0,12):r=SU(e),Iv(_U(r.toUpperCase()))}function Ng(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):AU(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return ko(14,M6(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function EU(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function TU(e,t,r,n){var a="",i=0,s=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return Ym[r.m-1][1];case 5:return Ym[r.m-1][0];default:return Ym[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return z5[r.q][0];default:return z5[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Oi(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(r.S+r.u)),i>=60*s&&(i=0),t==="s"?i===0?"0":""+i/s:(a=Oi(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var f=c>0?Oi(l,c):"";return f}function yo(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var R6=/%/g;function jU(e,t,r){var n=t.replace(R6,""),a=t.length-n.length;return Os(e,n,r*Math.pow(10,2*a))+zr("%",a)}function PU(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Os(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function B6(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+B6(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(a+i)%a)+"."+f.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var U6=/# (\?+)( ?)\/( ?)(\d+)/;function kU(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),s=a-i*n,o=n;return r+(i===0?"":""+i)+" "+(s===0?zr(" ",e[1].length+1+e[4].length):Dv(s,e[1].length)+e[2]+"/"+e[3]+Oi(o,e[4].length))}function CU(e,t,r){return r+(t===0?"":""+t)+zr(" ",e[1].length+2+e[4].length)}var $6=/^#*0*\.([0#]+)/,z6=/\).*[0#]/,q6=/\(###\) ###\\?-####/;function oa(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function W5(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function H5(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function OU(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function LU(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function si(e,t,r){if(e.charCodeAt(0)===40&&!t.match(z6)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?si("n",n,r):"("+si("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return PU(e,t,r);if(t.indexOf("%")!==-1)return jU(e,t,r);if(t.indexOf("E")!==-1)return B6(t,r);if(t.charCodeAt(0)===36)return"$"+si(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+oc(l,t.length);if(t.match(/^[#?]+$/))return a=oc(r,0),a==="0"&&(a=""),a.length>t.length?a:oa(t.substr(0,t.length-a.length))+a;if(i=t.match(U6))return kU(i,l,c);if(t.match(/^#+0+$/))return c+oc(l,t.length-t.indexOf("0"));if(i=t.match($6))return a=W5(r,i[1].length).replace(/^([^\.]+)$/,"$1."+oa(i[1])).replace(/\.$/,"."+oa(i[1])).replace(/\.(\d*)$/,function(x,g){return"."+g+zr("0",oa(i[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+W5(l,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+yo(oc(l,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+si(e,t,-r):yo(""+(Math.floor(r)+OU(r,i[1].length)))+"."+Oi(H5(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return si(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=jc(si(e,t.replace(/[\\-]/g,""),r)),s=0,jc(jc(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return s<a.length?a.charAt(s++):x==="0"?"0":""}));if(t.match(q6))return a=si(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=xd(l,Math.pow(10,s)-1,!1),a=""+c,f=Os("n",i[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+i[2]+"/"+i[3],f=md(o[2],s),f.length<i[4].length&&(f=oa(i[4].substr(i[4].length-f.length))+f),a+=f,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=xd(l,Math.pow(10,s)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Dv(o[1],s)+i[2]+"/"+i[3]+md(o[2],s):zr(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=oc(r,0),t.length<=a.length?a:oa(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var h=t.indexOf(".")-s,p=t.length-a.length-h;return oa(t.substr(0,h)+a+t.substr(t.length-p))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=H5(r,i[1].length),r<0?"-"+si(e,t,-r):yo(LU(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Oi(0,3-x.length):"")+x})+"."+Oi(s,i[1].length);switch(t){case"###,##0.00":return si(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var d=yo(oc(l,0));return d!=="0"?c+d:"";case"###,###.00":return si(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return si(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function FU(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Os(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function DU(e,t,r){var n=t.replace(R6,""),a=t.length-n.length;return Os(e,n,r*Math.pow(10,2*a))+zr("%",a)}function W6(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+W6(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(a+i)%a)+"."+f.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Xi(e,t,r){if(e.charCodeAt(0)===40&&!t.match(z6)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Xi("n",n,r):"("+Xi("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return FU(e,t,r);if(t.indexOf("%")!==-1)return DU(e,t,r);if(t.indexOf("E")!==-1)return W6(t,r);if(t.charCodeAt(0)===36)return"$"+Xi(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Oi(l,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:oa(t.substr(0,t.length-a.length))+a;if(i=t.match(U6))return CU(i,l,c);if(t.match(/^#+0+$/))return c+Oi(l,t.length-t.indexOf("0"));if(i=t.match($6))return a=(""+r).replace(/^([^\.]+)$/,"$1."+oa(i[1])).replace(/\.$/,"."+oa(i[1])),a=a.replace(/\.(\d*)$/,function(x,g){return"."+g+zr("0",oa(i[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return c+yo(""+l);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Xi(e,t,-r):yo(""+r)+"."+zr("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Xi(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=jc(Xi(e,t.replace(/[\\-]/g,""),r)),s=0,jc(jc(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return s<a.length?a.charAt(s++):x==="0"?"0":""}));if(t.match(q6))return a=Xi(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=xd(l,Math.pow(10,s)-1,!1),a=""+c,f=Os("n",i[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+i[2]+"/"+i[3],f=md(o[2],s),f.length<i[4].length&&(f=oa(i[4].substr(i[4].length-f.length))+f),a+=f,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=xd(l,Math.pow(10,s)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Dv(o[1],s)+i[2]+"/"+i[3]+md(o[2],s):zr(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:oa(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var h=t.indexOf(".")-s,p=t.length-a.length-h;return oa(t.substr(0,h)+a+t.substr(t.length-p))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Xi(e,t,-r):yo(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Oi(0,3-x.length):"")+x})+"."+Oi(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=yo(""+l);return d!=="0"?c+d:"";default:if(t.match(/\.[0#?]*$/))return Xi(e,t.slice(0,t.lastIndexOf(".")),r)+oa(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Os(e,t,r){return(r|0)===r?Xi(e,t,r):si(e,t,r)}function IU(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var H6=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function G6(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":gd(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"‰∏ä":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="‰∏äÂçà/‰∏ãÂçà")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(H6))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function MU(e,t,r,n){for(var a=[],i="",s=0,o="",l="t",c,f,h,p="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!gd(e,s))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(h=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(h);a[a.length]={t:"t",v:i},++s;break;case"\\":var d=e.charAt(++s),x=d==="("||d===")"?d:"t";a[a.length]={t:x,v:d},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(c==null&&(c=oh(t,r,e.charAt(s+1)==="2"),c==null))return"";a[a.length]={t:"X",v:e.substr(s,2)},l=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=oh(t,r),c==null))return"";for(i=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)i+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=p),a[a.length]={t:o,v:i},l=o;break;case"A":case"a":case"‰∏ä":var g={t:o,v:o};if(c==null&&(c=oh(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(c!=null&&(g.v=c.H>=12?"P":"A"),g.t="T",p="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(c!=null&&(g.v=c.H>=12?"PM":"AM"),g.t="T",s+=5,p="h"):e.substr(s,5).toUpperCase()==="‰∏äÂçà/‰∏ãÂçà"?(c!=null&&(g.v=c.H>=12?"‰∏ãÂçà":"‰∏äÂçà"),g.t="T",s+=5,p="h"):(g.t="t",++s),c==null&&g.t==="T")return"";a[a.length]=g,l=o;break;case"[":for(i=o;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(H6)){if(c==null&&(c=oh(t,r),c==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},l=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",G6(e)||(a[a.length]={t:"t",v:i}));break;case".":if(c!=null){for(i=o;++s<e.length&&(o=e.charAt(s))==="0";)i+=o;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)i+=o;a[a.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++s)===o;)i+=o;a[a.length]={t:o,v:i},l=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:o,v:o},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=‚Ç¨acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++s;break}var y=0,b=0,T;for(s=a.length-1,l="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=p,l="h",y<1&&(y=1);break;case"s":(T=a[s].v.match(/\.0+$/))&&(b=Math.max(b,T[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":l=a[s].t;break;case"m":l==="s"&&(a[s].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&a[s].v.match(/[Hh]/)&&(y=1),y<2&&a[s].v.match(/[Mm]/)&&(y=2),y<3&&a[s].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var S="",k;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=TU(a[s].t.charCodeAt(0),a[s].v,c,b),a[s].t="t";break;case"n":case"?":for(k=s+1;a[k]!=null&&((o=a[k].t)==="?"||o==="D"||(o===" "||o==="t")&&a[k+1]!=null&&(a[k+1].t==="?"||a[k+1].t==="t"&&a[k+1].v==="/")||a[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[k].v==="/"||a[k].v===" "&&a[k+1]!=null&&a[k+1].t=="?"));)a[s].v+=a[k].v,a[k]={v:"",t:";"},++k;S+=a[s].v,s=k-1;break;case"G":a[s].t="t",a[s].v=Ng(t,r);break}var A="",M,O;if(S.length>0){S.charCodeAt(0)==40?(M=t<0&&S.charCodeAt(0)===45?-t:t,O=Os("n",S,M)):(M=t<0&&n>1?-t:t,O=Os("n",S,M),M<0&&a[0]&&a[0].t=="t"&&(O=O.substr(1),a[0].v="-"+a[0].v)),k=O.length-1;var I=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){I=s;break}var j=a.length;if(I===a.length&&O.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(k>=a[s].v.length-1?(k-=a[s].v.length,a[s].v=O.substr(k+1,a[s].v.length)):k<0?a[s].v="":(a[s].v=O.substr(0,k+1),k=-1),a[s].t="t",j=s);k>=0&&j<a.length&&(a[j].v=O.substr(0,k+1)+a[j].v)}else if(I!==a.length&&O.indexOf("E")===-1){for(k=O.indexOf(".")-1,s=I;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(f=a[s].v.indexOf(".")>-1&&s===I?a[s].v.indexOf(".")-1:a[s].v.length-1,A=a[s].v.substr(f+1);f>=0;--f)k>=0&&(a[s].v.charAt(f)==="0"||a[s].v.charAt(f)==="#")&&(A=O.charAt(k--)+A);a[s].v=A,a[s].t="t",j=s}for(k>=0&&j<a.length&&(a[j].v=O.substr(0,k+1)+a[j].v),k=O.indexOf(".")+1,s=I;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==I)){for(f=a[s].v.indexOf(".")>-1&&s===I?a[s].v.indexOf(".")+1:0,A=a[s].v.substr(0,f);f<a[s].v.length;++f)k<O.length&&(A+=O.charAt(k++));a[s].v=A,a[s].t="t",j=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(M=n>1&&t<0&&s>0&&a[s-1].v==="-"?-t:t,a[s].v=Os(a[s].t,a[s].v,M),a[s].t="t");var W="";for(s=0;s!==a.length;++s)a[s]!=null&&(W+=a[s].v);return W}var G5=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function V5(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function RU(e,t){var r=IU(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(G5),o=r[1].match(G5);return V5(t,s)?[n,r[0]]:V5(t,o)?[n,r[1]]:[n,r[s!=null&&o!=null?2:1]]}return[n,i]}function ko(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:qr)[e],n==null&&(n=r.table&&r.table[q5[e]]||qr[q5[e]]),n==null&&(n=yU[e]||"General");break}if(gd(n,0))return Ng(t,r);t instanceof Date&&(t=M6(t,r.date1904));var a=RU(n,t);if(gd(a[1]))return Ng(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return MU(a[1],t,r,a[0])}function V6(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(qr[r]==null){t<0&&(t=r);continue}if(qr[r]==e){t=r;break}}t<0&&(t=391)}return qr[t]=e,t}function Pp(e){for(var t=0;t!=392;++t)e[t]!==void 0&&V6(e[t],t)}function kp(){qr=vU()}var K6=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function BU(e){var t=typeof e=="number"?qr[e]:e;return t=t.replace(K6,"(\\d+)"),new RegExp("^"+t+"$")}function UU(e,t,r){var n=-1,a=-1,i=-1,s=-1,o=-1,l=-1;(t.match(K6)||[]).forEach(function(h,p){var d=parseInt(r[p+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=d;break;case"d":i=d;break;case"h":s=d;break;case"s":l=d;break;case"m":s>=0?o=d:a=d;break}}),l>=0&&o==-1&&a>=0&&(o=a,a=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var f=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return s==-1&&o==-1&&l==-1?c:n==-1&&a==-1&&i==-1?f:c+"T"+f}var $U=function(){var e={};e.version="1.2.0";function t(){for(var O=0,I=new Array(256),j=0;j!=256;++j)O=j,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,I[j]=O;return typeof Int32Array<"u"?new Int32Array(I):I}var r=t();function n(O){var I=0,j=0,W=0,E=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(W=0;W!=256;++W)E[W]=O[W];for(W=0;W!=256;++W)for(j=O[W],I=256+W;I<4096;I+=256)j=E[I]=j>>>8^O[j&255];var C=[];for(W=1;W!=16;++W)C[W-1]=typeof Int32Array<"u"?E.subarray(W*256,W*256+256):E.slice(W*256,W*256+256);return C}var a=n(r),i=a[0],s=a[1],o=a[2],l=a[3],c=a[4],f=a[5],h=a[6],p=a[7],d=a[8],x=a[9],g=a[10],y=a[11],b=a[12],T=a[13],S=a[14];function k(O,I){for(var j=I^-1,W=0,E=O.length;W<E;)j=j>>>8^r[(j^O.charCodeAt(W++))&255];return~j}function A(O,I){for(var j=I^-1,W=O.length-15,E=0;E<W;)j=S[O[E++]^j&255]^T[O[E++]^j>>8&255]^b[O[E++]^j>>16&255]^y[O[E++]^j>>>24]^g[O[E++]]^x[O[E++]]^d[O[E++]]^p[O[E++]]^h[O[E++]]^f[O[E++]]^c[O[E++]]^l[O[E++]]^o[O[E++]]^s[O[E++]]^i[O[E++]]^r[O[E++]];for(W+=15;E<W;)j=j>>>8^r[(j^O[E++])&255];return~j}function M(O,I){for(var j=I^-1,W=0,E=O.length,C=0,G=0;W<E;)C=O.charCodeAt(W++),C<128?j=j>>>8^r[(j^C)&255]:C<2048?(j=j>>>8^r[(j^(192|C>>6&31))&255],j=j>>>8^r[(j^(128|C&63))&255]):C>=55296&&C<57344?(C=(C&1023)+64,G=O.charCodeAt(W++)&1023,j=j>>>8^r[(j^(240|C>>8&7))&255],j=j>>>8^r[(j^(128|C>>2&63))&255],j=j>>>8^r[(j^(128|G>>6&15|(C&3)<<4))&255],j=j>>>8^r[(j^(128|G&63))&255]):(j=j>>>8^r[(j^(224|C>>12&15))&255],j=j>>>8^r[(j^(128|C>>6&63))&255],j=j>>>8^r[(j^(128|C&63))&255]);return~j}return e.table=r,e.bstr=k,e.buf=A,e.str=M,e}(),gr=function(){var t={};t.version="1.2.1";function r(z,ne){for(var Y=z.split("/"),J=ne.split("/"),ae=0,se=0,Ne=Math.min(Y.length,J.length);ae<Ne;++ae){if(se=Y[ae].length-J[ae].length)return se;if(Y[ae]!=J[ae])return Y[ae]<J[ae]?-1:1}return Y.length-J.length}function n(z){if(z.charAt(z.length-1)=="/")return z.slice(0,-1).indexOf("/")===-1?z:n(z.slice(0,-1));var ne=z.lastIndexOf("/");return ne===-1?z:z.slice(0,ne+1)}function a(z){if(z.charAt(z.length-1)=="/")return a(z.slice(0,-1));var ne=z.lastIndexOf("/");return ne===-1?z:z.slice(ne+1)}function i(z,ne){typeof ne=="string"&&(ne=new Date(ne));var Y=ne.getHours();Y=Y<<6|ne.getMinutes(),Y=Y<<5|ne.getSeconds()>>>1,z.write_shift(2,Y);var J=ne.getFullYear()-1980;J=J<<4|ne.getMonth()+1,J=J<<5|ne.getDate(),z.write_shift(2,J)}function s(z){var ne=z.read_shift(2)&65535,Y=z.read_shift(2)&65535,J=new Date,ae=Y&31;Y>>>=5;var se=Y&15;Y>>>=4,J.setMilliseconds(0),J.setFullYear(Y+1980),J.setMonth(se-1),J.setDate(ae);var Ne=ne&31;ne>>>=5;var Oe=ne&63;return ne>>>=6,J.setHours(ne),J.setMinutes(Oe),J.setSeconds(Ne<<1),J}function o(z){Ua(z,0);for(var ne={},Y=0;z.l<=z.length-4;){var J=z.read_shift(2),ae=z.read_shift(2),se=z.l+ae,Ne={};switch(J){case 21589:Y=z.read_shift(1),Y&1&&(Ne.mtime=z.read_shift(4)),ae>5&&(Y&2&&(Ne.atime=z.read_shift(4)),Y&4&&(Ne.ctime=z.read_shift(4))),Ne.mtime&&(Ne.mt=new Date(Ne.mtime*1e3));break}z.l=se,ne[J]=Ne}return ne}var l;function c(){return l||(l={})}function f(z,ne){if(z[0]==80&&z[1]==75)return Xt(z,ne);if((z[0]|32)==109&&(z[1]|32)==105)return Et(z,ne);if(z.length<512)throw new Error("CFB file size "+z.length+" < 512");var Y=3,J=512,ae=0,se=0,Ne=0,Oe=0,Ae=0,Ee=[],ke=z.slice(0,512);Ua(ke,0);var Ge=h(ke);switch(Y=Ge[0],Y){case 3:J=512;break;case 4:J=4096;break;case 0:if(Ge[1]==0)return Xt(z,ne);default:throw new Error("Major Version: Expected 3 or 4 saw "+Y)}J!==512&&(ke=z.slice(0,J),Ua(ke,28));var Ze=z.slice(0,J);p(ke,Y);var it=ke.read_shift(4,"i");if(Y===3&&it!==0)throw new Error("# Directory Sectors: Expected 0 saw "+it);ke.l+=4,Ne=ke.read_shift(4,"i"),ke.l+=4,ke.chk("00100000","Mini Stream Cutoff Size: "),Oe=ke.read_shift(4,"i"),ae=ke.read_shift(4,"i"),Ae=ke.read_shift(4,"i"),se=ke.read_shift(4,"i");for(var Ke=-1,at=0;at<109&&(Ke=ke.read_shift(4,"i"),!(Ke<0));++at)Ee[at]=Ke;var Pt=d(z,J);y(Ae,se,Pt,J,Ee);var pr=T(Pt,Ne,Ee,J);pr[Ne].name="!Directory",ae>0&&Oe!==G&&(pr[Oe].name="!MiniFAT"),pr[Ee[0]].name="!FAT",pr.fat_addrs=Ee,pr.ssz=J;var zt={},Mr=[],Ui=[],bi=[];S(Ne,pr,Pt,Mr,ae,zt,Ui,Oe),x(Ui,bi,Mr),Mr.shift();var $i={FileIndex:Ui,FullPaths:bi};return ne&&ne.raw&&($i.raw={header:Ze,sectors:Pt}),$i}function h(z){if(z[z.l]==80&&z[z.l+1]==75)return[0,0];z.chk(Z,"Header Signature: "),z.l+=16;var ne=z.read_shift(2,"u");return[z.read_shift(2,"u"),ne]}function p(z,ne){var Y=9;switch(z.l+=2,Y=z.read_shift(2)){case 9:if(ne!=3)throw new Error("Sector Shift: Expected 9 saw "+Y);break;case 12:if(ne!=4)throw new Error("Sector Shift: Expected 12 saw "+Y);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Y)}z.chk("0600","Mini Sector Shift: "),z.chk("000000000000","Reserved: ")}function d(z,ne){for(var Y=Math.ceil(z.length/ne)-1,J=[],ae=1;ae<Y;++ae)J[ae-1]=z.slice(ae*ne,(ae+1)*ne);return J[Y-1]=z.slice(Y*ne),J}function x(z,ne,Y){for(var J=0,ae=0,se=0,Ne=0,Oe=0,Ae=Y.length,Ee=[],ke=[];J<Ae;++J)Ee[J]=ke[J]=J,ne[J]=Y[J];for(;Oe<ke.length;++Oe)J=ke[Oe],ae=z[J].L,se=z[J].R,Ne=z[J].C,Ee[J]===J&&(ae!==-1&&Ee[ae]!==ae&&(Ee[J]=Ee[ae]),se!==-1&&Ee[se]!==se&&(Ee[J]=Ee[se])),Ne!==-1&&(Ee[Ne]=J),ae!==-1&&J!=Ee[J]&&(Ee[ae]=Ee[J],ke.lastIndexOf(ae)<Oe&&ke.push(ae)),se!==-1&&J!=Ee[J]&&(Ee[se]=Ee[J],ke.lastIndexOf(se)<Oe&&ke.push(se));for(J=1;J<Ae;++J)Ee[J]===J&&(se!==-1&&Ee[se]!==se?Ee[J]=Ee[se]:ae!==-1&&Ee[ae]!==ae&&(Ee[J]=Ee[ae]));for(J=1;J<Ae;++J)if(z[J].type!==0){if(Oe=J,Oe!=Ee[Oe])do Oe=Ee[Oe],ne[J]=ne[Oe]+"/"+ne[J];while(Oe!==0&&Ee[Oe]!==-1&&Oe!=Ee[Oe]);Ee[J]=-1}for(ne[0]+="/",J=1;J<Ae;++J)z[J].type!==2&&(ne[J]+="/")}function g(z,ne,Y){for(var J=z.start,ae=z.size,se=[],Ne=J;Y&&ae>0&&Ne>=0;)se.push(ne.slice(Ne*C,Ne*C+C)),ae-=C,Ne=il(Y,Ne*4);return se.length===0?De(0):$n(se).slice(0,z.size)}function y(z,ne,Y,J,ae){var se=G;if(z===G){if(ne!==0)throw new Error("DIFAT chain shorter than expected")}else if(z!==-1){var Ne=Y[z],Oe=(J>>>2)-1;if(!Ne)return;for(var Ae=0;Ae<Oe&&(se=il(Ne,Ae*4))!==G;++Ae)ae.push(se);y(il(Ne,J-4),ne-1,Y,J,ae)}}function b(z,ne,Y,J,ae){var se=[],Ne=[];ae||(ae=[]);var Oe=J-1,Ae=0,Ee=0;for(Ae=ne;Ae>=0;){ae[Ae]=!0,se[se.length]=Ae,Ne.push(z[Ae]);var ke=Y[Math.floor(Ae*4/J)];if(Ee=Ae*4&Oe,J<4+Ee)throw new Error("FAT boundary crossed: "+Ae+" 4 "+J);if(!z[ke])break;Ae=il(z[ke],Ee)}return{nodes:se,data:tw([Ne])}}function T(z,ne,Y,J){var ae=z.length,se=[],Ne=[],Oe=[],Ae=[],Ee=J-1,ke=0,Ge=0,Ze=0,it=0;for(ke=0;ke<ae;++ke)if(Oe=[],Ze=ke+ne,Ze>=ae&&(Ze-=ae),!Ne[Ze]){Ae=[];var Ke=[];for(Ge=Ze;Ge>=0;){Ke[Ge]=!0,Ne[Ge]=!0,Oe[Oe.length]=Ge,Ae.push(z[Ge]);var at=Y[Math.floor(Ge*4/J)];if(it=Ge*4&Ee,J<4+it)throw new Error("FAT boundary crossed: "+Ge+" 4 "+J);if(!z[at]||(Ge=il(z[at],it),Ke[Ge]))break}se[Ze]={nodes:Oe,data:tw([Ae])}}return se}function S(z,ne,Y,J,ae,se,Ne,Oe){for(var Ae=0,Ee=J.length?2:0,ke=ne[z].data,Ge=0,Ze=0,it;Ge<ke.length;Ge+=128){var Ke=ke.slice(Ge,Ge+128);Ua(Ke,64),Ze=Ke.read_shift(2),it=$v(Ke,0,Ze-Ee),J.push(it);var at={name:it,type:Ke.read_shift(1),color:Ke.read_shift(1),L:Ke.read_shift(4,"i"),R:Ke.read_shift(4,"i"),C:Ke.read_shift(4,"i"),clsid:Ke.read_shift(16),state:Ke.read_shift(4,"i"),start:0,size:0},Pt=Ke.read_shift(2)+Ke.read_shift(2)+Ke.read_shift(2)+Ke.read_shift(2);Pt!==0&&(at.ct=k(Ke,Ke.l-8));var pr=Ke.read_shift(2)+Ke.read_shift(2)+Ke.read_shift(2)+Ke.read_shift(2);pr!==0&&(at.mt=k(Ke,Ke.l-8)),at.start=Ke.read_shift(4,"i"),at.size=Ke.read_shift(4,"i"),at.size<0&&at.start<0&&(at.size=at.type=0,at.start=G,at.name=""),at.type===5?(Ae=at.start,ae>0&&Ae!==G&&(ne[Ae].name="!StreamData")):at.size>=4096?(at.storage="fat",ne[at.start]===void 0&&(ne[at.start]=b(Y,at.start,ne.fat_addrs,ne.ssz)),ne[at.start].name=at.name,at.content=ne[at.start].data.slice(0,at.size)):(at.storage="minifat",at.size<0?at.size=0:Ae!==G&&at.start!==G&&ne[Ae]&&(at.content=g(at,ne[Ae].data,(ne[Oe]||{}).data))),at.content&&Ua(at.content,0),se[it]=at,Ne.push(at)}}function k(z,ne){return new Date((za(z,ne+4)/1e7*Math.pow(2,32)+za(z,ne)/1e7-11644473600)*1e3)}function A(z,ne){return c(),f(l.readFileSync(z),ne)}function M(z,ne){var Y=ne&&ne.type;switch(Y||ar&&Buffer.isBuffer(z)&&(Y="buffer"),Y||"base64"){case"file":return A(z,ne);case"base64":return f(Ci($s(z)),ne);case"binary":return f(Ci(z),ne)}return f(z,ne)}function O(z,ne){var Y=ne||{},J=Y.root||"Root Entry";if(z.FullPaths||(z.FullPaths=[]),z.FileIndex||(z.FileIndex=[]),z.FullPaths.length!==z.FileIndex.length)throw new Error("inconsistent CFB structure");z.FullPaths.length===0&&(z.FullPaths[0]=J+"/",z.FileIndex[0]={name:J,type:5}),Y.CLSID&&(z.FileIndex[0].clsid=Y.CLSID),I(z)}function I(z){var ne="Sh33tJ5";if(!gr.find(z,"/"+ne)){var Y=De(4);Y[0]=55,Y[1]=Y[3]=50,Y[2]=54,z.FileIndex.push({name:ne,type:2,content:Y,size:4,L:69,R:69,C:69}),z.FullPaths.push(z.FullPaths[0]+ne),j(z)}}function j(z,ne){O(z);for(var Y=!1,J=!1,ae=z.FullPaths.length-1;ae>=0;--ae){var se=z.FileIndex[ae];switch(se.type){case 0:J?Y=!0:(z.FileIndex.pop(),z.FullPaths.pop());break;case 1:case 2:case 5:J=!0,isNaN(se.R*se.L*se.C)&&(Y=!0),se.R>-1&&se.L>-1&&se.R==se.L&&(Y=!0);break;default:Y=!0;break}}if(!(!Y&&!ne)){var Ne=new Date(1987,1,19),Oe=0,Ae=Object.create?Object.create(null):{},Ee=[];for(ae=0;ae<z.FullPaths.length;++ae)Ae[z.FullPaths[ae]]=!0,z.FileIndex[ae].type!==0&&Ee.push([z.FullPaths[ae],z.FileIndex[ae]]);for(ae=0;ae<Ee.length;++ae){var ke=n(Ee[ae][0]);J=Ae[ke],J||(Ee.push([ke,{name:a(ke).replace("/",""),type:1,clsid:oe,ct:Ne,mt:Ne,content:null}]),Ae[ke]=!0)}for(Ee.sort(function(it,Ke){return r(it[0],Ke[0])}),z.FullPaths=[],z.FileIndex=[],ae=0;ae<Ee.length;++ae)z.FullPaths[ae]=Ee[ae][0],z.FileIndex[ae]=Ee[ae][1];for(ae=0;ae<Ee.length;++ae){var Ge=z.FileIndex[ae],Ze=z.FullPaths[ae];if(Ge.name=a(Ze).replace("/",""),Ge.L=Ge.R=Ge.C=-(Ge.color=1),Ge.size=Ge.content?Ge.content.length:0,Ge.start=0,Ge.clsid=Ge.clsid||oe,ae===0)Ge.C=Ee.length>1?1:-1,Ge.size=0,Ge.type=5;else if(Ze.slice(-1)=="/"){for(Oe=ae+1;Oe<Ee.length&&n(z.FullPaths[Oe])!=Ze;++Oe);for(Ge.C=Oe>=Ee.length?-1:Oe,Oe=ae+1;Oe<Ee.length&&n(z.FullPaths[Oe])!=n(Ze);++Oe);Ge.R=Oe>=Ee.length?-1:Oe,Ge.type=1}else n(z.FullPaths[ae+1]||"")==n(Ze)&&(Ge.R=ae+1),Ge.type=2}}}function W(z,ne){var Y=ne||{};if(Y.fileType=="mad")return vi(z,Y);switch(j(z),Y.fileType){case"zip":return Wt(z,Y)}var J=function(it){for(var Ke=0,at=0,Pt=0;Pt<it.FileIndex.length;++Pt){var pr=it.FileIndex[Pt];if(pr.content){var zt=pr.content.length;zt>0&&(zt<4096?Ke+=zt+63>>6:at+=zt+511>>9)}}for(var Mr=it.FullPaths.length+3>>2,Ui=Ke+7>>3,bi=Ke+127>>7,$i=Ui+at+Mr+bi,Qa=$i+127>>7,Ks=Qa<=109?0:Math.ceil((Qa-109)/127);$i+Qa+Ks+127>>7>Qa;)Ks=++Qa<=109?0:Math.ceil((Qa-109)/127);var Gn=[1,Ks,Qa,bi,Mr,at,Ke,0];return it.FileIndex[0].size=Ke<<6,Gn[7]=(it.FileIndex[0].start=Gn[0]+Gn[1]+Gn[2]+Gn[3]+Gn[4]+Gn[5])+(Gn[6]+7>>3),Gn}(z),ae=De(J[7]<<9),se=0,Ne=0;{for(se=0;se<8;++se)ae.write_shift(1,he[se]);for(se=0;se<8;++se)ae.write_shift(2,0);for(ae.write_shift(2,62),ae.write_shift(2,3),ae.write_shift(2,65534),ae.write_shift(2,9),ae.write_shift(2,6),se=0;se<3;++se)ae.write_shift(2,0);for(ae.write_shift(4,0),ae.write_shift(4,J[2]),ae.write_shift(4,J[0]+J[1]+J[2]+J[3]-1),ae.write_shift(4,0),ae.write_shift(4,4096),ae.write_shift(4,J[3]?J[0]+J[1]+J[2]-1:G),ae.write_shift(4,J[3]),ae.write_shift(-4,J[1]?J[0]-1:G),ae.write_shift(4,J[1]),se=0;se<109;++se)ae.write_shift(-4,se<J[2]?J[1]+se:-1)}if(J[1])for(Ne=0;Ne<J[1];++Ne){for(;se<236+Ne*127;++se)ae.write_shift(-4,se<J[2]?J[1]+se:-1);ae.write_shift(-4,Ne===J[1]-1?G:Ne+1)}var Oe=function(it){for(Ne+=it;se<Ne-1;++se)ae.write_shift(-4,se+1);it&&(++se,ae.write_shift(-4,G))};for(Ne=se=0,Ne+=J[1];se<Ne;++se)ae.write_shift(-4,me.DIFSECT);for(Ne+=J[2];se<Ne;++se)ae.write_shift(-4,me.FATSECT);Oe(J[3]),Oe(J[4]);for(var Ae=0,Ee=0,ke=z.FileIndex[0];Ae<z.FileIndex.length;++Ae)ke=z.FileIndex[Ae],ke.content&&(Ee=ke.content.length,!(Ee<4096)&&(ke.start=Ne,Oe(Ee+511>>9)));for(Oe(J[6]+7>>3);ae.l&511;)ae.write_shift(-4,me.ENDOFCHAIN);for(Ne=se=0,Ae=0;Ae<z.FileIndex.length;++Ae)ke=z.FileIndex[Ae],ke.content&&(Ee=ke.content.length,!(!Ee||Ee>=4096)&&(ke.start=Ne,Oe(Ee+63>>6)));for(;ae.l&511;)ae.write_shift(-4,me.ENDOFCHAIN);for(se=0;se<J[4]<<2;++se){var Ge=z.FullPaths[se];if(!Ge||Ge.length===0){for(Ae=0;Ae<17;++Ae)ae.write_shift(4,0);for(Ae=0;Ae<3;++Ae)ae.write_shift(4,-1);for(Ae=0;Ae<12;++Ae)ae.write_shift(4,0);continue}ke=z.FileIndex[se],se===0&&(ke.start=ke.size?ke.start-1:G);var Ze=se===0&&Y.root||ke.name;if(Ee=2*(Ze.length+1),ae.write_shift(64,Ze,"utf16le"),ae.write_shift(2,Ee),ae.write_shift(1,ke.type),ae.write_shift(1,ke.color),ae.write_shift(-4,ke.L),ae.write_shift(-4,ke.R),ae.write_shift(-4,ke.C),ke.clsid)ae.write_shift(16,ke.clsid,"hex");else for(Ae=0;Ae<4;++Ae)ae.write_shift(4,0);ae.write_shift(4,ke.state||0),ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(4,0),ae.write_shift(4,ke.start),ae.write_shift(4,ke.size),ae.write_shift(4,0)}for(se=1;se<z.FileIndex.length;++se)if(ke=z.FileIndex[se],ke.size>=4096)if(ae.l=ke.start+1<<9,ar&&Buffer.isBuffer(ke.content))ke.content.copy(ae,ae.l,0,ke.size),ae.l+=ke.size+511&-512;else{for(Ae=0;Ae<ke.size;++Ae)ae.write_shift(1,ke.content[Ae]);for(;Ae&511;++Ae)ae.write_shift(1,0)}for(se=1;se<z.FileIndex.length;++se)if(ke=z.FileIndex[se],ke.size>0&&ke.size<4096)if(ar&&Buffer.isBuffer(ke.content))ke.content.copy(ae,ae.l,0,ke.size),ae.l+=ke.size+63&-64;else{for(Ae=0;Ae<ke.size;++Ae)ae.write_shift(1,ke.content[Ae]);for(;Ae&63;++Ae)ae.write_shift(1,0)}if(ar)ae.l=ae.length;else for(;ae.l<ae.length;)ae.write_shift(1,0);return ae}function E(z,ne){var Y=z.FullPaths.map(function(Ae){return Ae.toUpperCase()}),J=Y.map(function(Ae){var Ee=Ae.split("/");return Ee[Ee.length-(Ae.slice(-1)=="/"?2:1)]}),ae=!1;ne.charCodeAt(0)===47?(ae=!0,ne=Y[0].slice(0,-1)+ne):ae=ne.indexOf("/")!==-1;var se=ne.toUpperCase(),Ne=ae===!0?Y.indexOf(se):J.indexOf(se);if(Ne!==-1)return z.FileIndex[Ne];var Oe=!se.match(sh);for(se=se.replace(df,""),Oe&&(se=se.replace(sh,"!")),Ne=0;Ne<Y.length;++Ne)if((Oe?Y[Ne].replace(sh,"!"):Y[Ne]).replace(df,"")==se||(Oe?J[Ne].replace(sh,"!"):J[Ne]).replace(df,"")==se)return z.FileIndex[Ne];return null}var C=64,G=-2,Z="d0cf11e0a1b11ae1",he=[208,207,17,224,161,177,26,225],oe="00000000000000000000000000000000",me={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:G,FREESECT:-1,HEADER_SIGNATURE:Z,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:oe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function pe(z,ne,Y){c();var J=W(z,Y);l.writeFileSync(ne,J)}function ge(z){for(var ne=new Array(z.length),Y=0;Y<z.length;++Y)ne[Y]=String.fromCharCode(z[Y]);return ne.join("")}function Le(z,ne){var Y=W(z,ne);switch(ne&&ne.type||"buffer"){case"file":return c(),l.writeFileSync(ne.filename,Y),Y;case"binary":return typeof Y=="string"?Y:ge(Y);case"base64":return Mf(typeof Y=="string"?Y:ge(Y));case"buffer":if(ar)return Buffer.isBuffer(Y)?Y:Vs(Y);case"array":return typeof Y=="string"?Ci(Y):Y}return Y}var Se;function N(z){try{var ne=z.InflateRaw,Y=new ne;if(Y._processChunk(new Uint8Array([3,0]),Y._finishFlushFlag),Y.bytesRead)Se=z;else throw new Error("zlib does not expose bytesRead")}catch(J){console.error("cannot use native zlib: "+(J.message||J))}}function D(z,ne){if(!Se)return tt(z,ne);var Y=Se.InflateRaw,J=new Y,ae=J._processChunk(z.slice(z.l),J._finishFlushFlag);return z.l+=J.bytesRead,ae}function L(z){return Se?Se.deflateRawSync(z):pt(z)}var F=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],K=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],ce=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function xe(z){var ne=(z<<1|z<<11)&139536|(z<<5|z<<15)&558144;return(ne>>16|ne>>8|ne)&255}for(var ee=typeof Uint8Array<"u",fe=ee?new Uint8Array(256):[],le=0;le<256;++le)fe[le]=xe(le);function ue(z,ne){var Y=fe[z&255];return ne<=8?Y>>>8-ne:(Y=Y<<8|fe[z>>8&255],ne<=16?Y>>>16-ne:(Y=Y<<8|fe[z>>16&255],Y>>>24-ne))}function $e(z,ne){var Y=ne&7,J=ne>>>3;return(z[J]|(Y<=6?0:z[J+1]<<8))>>>Y&3}function ye(z,ne){var Y=ne&7,J=ne>>>3;return(z[J]|(Y<=5?0:z[J+1]<<8))>>>Y&7}function Q(z,ne){var Y=ne&7,J=ne>>>3;return(z[J]|(Y<=4?0:z[J+1]<<8))>>>Y&15}function nt(z,ne){var Y=ne&7,J=ne>>>3;return(z[J]|(Y<=3?0:z[J+1]<<8))>>>Y&31}function Re(z,ne){var Y=ne&7,J=ne>>>3;return(z[J]|(Y<=1?0:z[J+1]<<8))>>>Y&127}function ot(z,ne,Y){var J=ne&7,ae=ne>>>3,se=(1<<Y)-1,Ne=z[ae]>>>J;return Y<8-J||(Ne|=z[ae+1]<<8-J,Y<16-J)||(Ne|=z[ae+2]<<16-J,Y<24-J)||(Ne|=z[ae+3]<<24-J),Ne&se}function ze(z,ne,Y){var J=ne&7,ae=ne>>>3;return J<=5?z[ae]|=(Y&7)<<J:(z[ae]|=Y<<J&255,z[ae+1]=(Y&7)>>8-J),ne+3}function lt(z,ne,Y){var J=ne&7,ae=ne>>>3;return Y=(Y&1)<<J,z[ae]|=Y,ne+1}function Qe(z,ne,Y){var J=ne&7,ae=ne>>>3;return Y<<=J,z[ae]|=Y&255,Y>>>=8,z[ae+1]=Y,ne+8}function Tt(z,ne,Y){var J=ne&7,ae=ne>>>3;return Y<<=J,z[ae]|=Y&255,Y>>>=8,z[ae+1]=Y&255,z[ae+2]=Y>>>8,ne+16}function ft(z,ne){var Y=z.length,J=2*Y>ne?2*Y:ne+5,ae=0;if(Y>=ne)return z;if(ar){var se=U5(J);if(z.copy)z.copy(se);else for(;ae<z.length;++ae)se[ae]=z[ae];return se}else if(ee){var Ne=new Uint8Array(J);if(Ne.set)Ne.set(z);else for(;ae<Y;++ae)Ne[ae]=z[ae];return Ne}return z.length=J,z}function Ot(z){for(var ne=new Array(z),Y=0;Y<z;++Y)ne[Y]=0;return ne}function Fe(z,ne,Y){var J=1,ae=0,se=0,Ne=0,Oe=0,Ae=z.length,Ee=ee?new Uint16Array(32):Ot(32);for(se=0;se<32;++se)Ee[se]=0;for(se=Ae;se<Y;++se)z[se]=0;Ae=z.length;var ke=ee?new Uint16Array(Ae):Ot(Ae);for(se=0;se<Ae;++se)Ee[ae=z[se]]++,J<ae&&(J=ae),ke[se]=0;for(Ee[0]=0,se=1;se<=J;++se)Ee[se+16]=Oe=Oe+Ee[se-1]<<1;for(se=0;se<Ae;++se)Oe=z[se],Oe!=0&&(ke[se]=Ee[Oe+16]++);var Ge=0;for(se=0;se<Ae;++se)if(Ge=z[se],Ge!=0)for(Oe=ue(ke[se],J)>>J-Ge,Ne=(1<<J+4-Ge)-1;Ne>=0;--Ne)ne[Oe|Ne<<Ge]=Ge&15|se<<4;return J}var Xe=ee?new Uint16Array(512):Ot(512),At=ee?new Uint16Array(32):Ot(32);if(!ee){for(var xt=0;xt<512;++xt)Xe[xt]=0;for(xt=0;xt<32;++xt)At[xt]=0}(function(){for(var z=[],ne=0;ne<32;ne++)z.push(5);Fe(z,At,32);var Y=[];for(ne=0;ne<=143;ne++)Y.push(8);for(;ne<=255;ne++)Y.push(9);for(;ne<=279;ne++)Y.push(7);for(;ne<=287;ne++)Y.push(8);Fe(Y,Xe,288)})();var st=function(){for(var ne=ee?new Uint8Array(32768):[],Y=0,J=0;Y<ce.length-1;++Y)for(;J<ce[Y+1];++J)ne[J]=Y;for(;J<32768;++J)ne[J]=29;var ae=ee?new Uint8Array(259):[];for(Y=0,J=0;Y<K.length-1;++Y)for(;J<K[Y+1];++J)ae[J]=Y;function se(Oe,Ae){for(var Ee=0;Ee<Oe.length;){var ke=Math.min(65535,Oe.length-Ee),Ge=Ee+ke==Oe.length;for(Ae.write_shift(1,+Ge),Ae.write_shift(2,ke),Ae.write_shift(2,~ke&65535);ke-- >0;)Ae[Ae.l++]=Oe[Ee++]}return Ae.l}function Ne(Oe,Ae){for(var Ee=0,ke=0,Ge=ee?new Uint16Array(32768):[];ke<Oe.length;){var Ze=Math.min(65535,Oe.length-ke);if(Ze<10){for(Ee=ze(Ae,Ee,+(ke+Ze==Oe.length)),Ee&7&&(Ee+=8-(Ee&7)),Ae.l=Ee/8|0,Ae.write_shift(2,Ze),Ae.write_shift(2,~Ze&65535);Ze-- >0;)Ae[Ae.l++]=Oe[ke++];Ee=Ae.l*8;continue}Ee=ze(Ae,Ee,+(ke+Ze==Oe.length)+2);for(var it=0;Ze-- >0;){var Ke=Oe[ke];it=(it<<5^Ke)&32767;var at=-1,Pt=0;if((at=Ge[it])&&(at|=ke&-32768,at>ke&&(at-=32768),at<ke))for(;Oe[at+Pt]==Oe[ke+Pt]&&Pt<250;)++Pt;if(Pt>2){Ke=ae[Pt],Ke<=22?Ee=Qe(Ae,Ee,fe[Ke+1]>>1)-1:(Qe(Ae,Ee,3),Ee+=5,Qe(Ae,Ee,fe[Ke-23]>>5),Ee+=3);var pr=Ke<8?0:Ke-4>>2;pr>0&&(Tt(Ae,Ee,Pt-K[Ke]),Ee+=pr),Ke=ne[ke-at],Ee=Qe(Ae,Ee,fe[Ke]>>3),Ee-=3;var zt=Ke<4?0:Ke-2>>1;zt>0&&(Tt(Ae,Ee,ke-at-ce[Ke]),Ee+=zt);for(var Mr=0;Mr<Pt;++Mr)Ge[it]=ke&32767,it=(it<<5^Oe[ke])&32767,++ke;Ze-=Pt-1}else Ke<=143?Ke=Ke+48:Ee=lt(Ae,Ee,1),Ee=Qe(Ae,Ee,fe[Ke]),Ge[it]=ke&32767,++ke}Ee=Qe(Ae,Ee,0)-1}return Ae.l=(Ee+7)/8|0,Ae.l}return function(Ae,Ee){return Ae.length<8?se(Ae,Ee):Ne(Ae,Ee)}}();function pt(z){var ne=De(50+Math.floor(z.length*1.1)),Y=st(z,ne);return ne.slice(0,Y)}var ht=ee?new Uint16Array(32768):Ot(32768),Qt=ee?new Uint16Array(32768):Ot(32768),$t=ee?new Uint16Array(128):Ot(128),mt=1,jt=1;function er(z,ne){var Y=nt(z,ne)+257;ne+=5;var J=nt(z,ne)+1;ne+=5;var ae=Q(z,ne)+4;ne+=4;for(var se=0,Ne=ee?new Uint8Array(19):Ot(19),Oe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ae=1,Ee=ee?new Uint8Array(8):Ot(8),ke=ee?new Uint8Array(8):Ot(8),Ge=Ne.length,Ze=0;Ze<ae;++Ze)Ne[F[Ze]]=se=ye(z,ne),Ae<se&&(Ae=se),Ee[se]++,ne+=3;var it=0;for(Ee[0]=0,Ze=1;Ze<=Ae;++Ze)ke[Ze]=it=it+Ee[Ze-1]<<1;for(Ze=0;Ze<Ge;++Ze)(it=Ne[Ze])!=0&&(Oe[Ze]=ke[it]++);var Ke=0;for(Ze=0;Ze<Ge;++Ze)if(Ke=Ne[Ze],Ke!=0){it=fe[Oe[Ze]]>>8-Ke;for(var at=(1<<7-Ke)-1;at>=0;--at)$t[it|at<<Ke]=Ke&7|Ze<<3}var Pt=[];for(Ae=1;Pt.length<Y+J;)switch(it=$t[Re(z,ne)],ne+=it&7,it>>>=3){case 16:for(se=3+$e(z,ne),ne+=2,it=Pt[Pt.length-1];se-- >0;)Pt.push(it);break;case 17:for(se=3+ye(z,ne),ne+=3;se-- >0;)Pt.push(0);break;case 18:for(se=11+Re(z,ne),ne+=7;se-- >0;)Pt.push(0);break;default:Pt.push(it),Ae<it&&(Ae=it);break}var pr=Pt.slice(0,Y),zt=Pt.slice(Y);for(Ze=Y;Ze<286;++Ze)pr[Ze]=0;for(Ze=J;Ze<30;++Ze)zt[Ze]=0;return mt=Fe(pr,ht,286),jt=Fe(zt,Qt,30),ne}function Pe(z,ne){if(z[0]==3&&!(z[1]&3))return[kl(ne),2];for(var Y=0,J=0,ae=U5(ne||1<<18),se=0,Ne=ae.length>>>0,Oe=0,Ae=0;!(J&1);){if(J=ye(z,Y),Y+=3,J>>>1)J>>1==1?(Oe=9,Ae=5):(Y=er(z,Y),Oe=mt,Ae=jt);else{Y&7&&(Y+=8-(Y&7));var Ee=z[Y>>>3]|z[(Y>>>3)+1]<<8;if(Y+=32,Ee>0)for(!ne&&Ne<se+Ee&&(ae=ft(ae,se+Ee),Ne=ae.length);Ee-- >0;)ae[se++]=z[Y>>>3],Y+=8;continue}for(;;){!ne&&Ne<se+32767&&(ae=ft(ae,se+32767),Ne=ae.length);var ke=ot(z,Y,Oe),Ge=J>>>1==1?Xe[ke]:ht[ke];if(Y+=Ge&15,Ge>>>=4,!(Ge>>>8&255))ae[se++]=Ge;else{if(Ge==256)break;Ge-=257;var Ze=Ge<8?0:Ge-4>>2;Ze>5&&(Ze=0);var it=se+K[Ge];Ze>0&&(it+=ot(z,Y,Ze),Y+=Ze),ke=ot(z,Y,Ae),Ge=J>>>1==1?At[ke]:Qt[ke],Y+=Ge&15,Ge>>>=4;var Ke=Ge<4?0:Ge-2>>1,at=ce[Ge];for(Ke>0&&(at+=ot(z,Y,Ke),Y+=Ke),!ne&&Ne<it&&(ae=ft(ae,it+100),Ne=ae.length);se<it;)ae[se]=ae[se-at],++se}}}return ne?[ae,Y+7>>>3]:[ae.slice(0,se),Y+7>>>3]}function tt(z,ne){var Y=z.slice(z.l||0),J=Pe(Y,ne);return z.l+=J[1],J[0]}function bt(z,ne){if(z)typeof console<"u"&&console.error(ne);else throw new Error(ne)}function Xt(z,ne){var Y=z;Ua(Y,0);var J=[],ae=[],se={FileIndex:J,FullPaths:ae};O(se,{root:ne.root});for(var Ne=Y.length-4;(Y[Ne]!=80||Y[Ne+1]!=75||Y[Ne+2]!=5||Y[Ne+3]!=6)&&Ne>=0;)--Ne;Y.l=Ne+4,Y.l+=4;var Oe=Y.read_shift(2);Y.l+=6;var Ae=Y.read_shift(4);for(Y.l=Ae,Ne=0;Ne<Oe;++Ne){Y.l+=20;var Ee=Y.read_shift(4),ke=Y.read_shift(4),Ge=Y.read_shift(2),Ze=Y.read_shift(2),it=Y.read_shift(2);Y.l+=8;var Ke=Y.read_shift(4),at=o(Y.slice(Y.l+Ge,Y.l+Ge+Ze));Y.l+=Ge+Ze+it;var Pt=Y.l;Y.l=Ke+4,wr(Y,Ee,ke,se,at),Y.l=Pt}return se}function wr(z,ne,Y,J,ae){z.l+=2;var se=z.read_shift(2),Ne=z.read_shift(2),Oe=s(z);if(se&8257)throw new Error("Unsupported ZIP encryption");for(var Ae=z.read_shift(4),Ee=z.read_shift(4),ke=z.read_shift(4),Ge=z.read_shift(2),Ze=z.read_shift(2),it="",Ke=0;Ke<Ge;++Ke)it+=String.fromCharCode(z[z.l++]);if(Ze){var at=o(z.slice(z.l,z.l+Ze));(at[21589]||{}).mt&&(Oe=at[21589].mt),((ae||{})[21589]||{}).mt&&(Oe=ae[21589].mt)}z.l+=Ze;var Pt=z.slice(z.l,z.l+Ee);switch(Ne){case 8:Pt=D(z,ke);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ne)}var pr=!1;se&8&&(Ae=z.read_shift(4),Ae==134695760&&(Ae=z.read_shift(4),pr=!0),Ee=z.read_shift(4),ke=z.read_shift(4)),Ee!=ne&&bt(pr,"Bad compressed size: "+ne+" != "+Ee),ke!=Y&&bt(pr,"Bad uncompressed size: "+Y+" != "+ke),Hn(J,it,Pt,{unsafe:!0,mt:Oe})}function Wt(z,ne){var Y=ne||{},J=[],ae=[],se=De(1),Ne=Y.compression?8:0,Oe=0,Ae=0,Ee=0,ke=0,Ge=0,Ze=z.FullPaths[0],it=Ze,Ke=z.FileIndex[0],at=[],Pt=0;for(Ae=1;Ae<z.FullPaths.length;++Ae)if(it=z.FullPaths[Ae].slice(Ze.length),Ke=z.FileIndex[Ae],!(!Ke.size||!Ke.content||it=="Sh33tJ5")){var pr=ke,zt=De(it.length);for(Ee=0;Ee<it.length;++Ee)zt.write_shift(1,it.charCodeAt(Ee)&127);zt=zt.slice(0,zt.l),at[Ge]=$U.buf(Ke.content,0);var Mr=Ke.content;Ne==8&&(Mr=L(Mr)),se=De(30),se.write_shift(4,67324752),se.write_shift(2,20),se.write_shift(2,Oe),se.write_shift(2,Ne),Ke.mt?i(se,Ke.mt):se.write_shift(4,0),se.write_shift(-4,at[Ge]),se.write_shift(4,Mr.length),se.write_shift(4,Ke.content.length),se.write_shift(2,zt.length),se.write_shift(2,0),ke+=se.length,J.push(se),ke+=zt.length,J.push(zt),ke+=Mr.length,J.push(Mr),se=De(46),se.write_shift(4,33639248),se.write_shift(2,0),se.write_shift(2,20),se.write_shift(2,Oe),se.write_shift(2,Ne),se.write_shift(4,0),se.write_shift(-4,at[Ge]),se.write_shift(4,Mr.length),se.write_shift(4,Ke.content.length),se.write_shift(2,zt.length),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(4,0),se.write_shift(4,pr),Pt+=se.l,ae.push(se),Pt+=zt.length,ae.push(zt),++Ge}return se=De(22),se.write_shift(4,101010256),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,Ge),se.write_shift(2,Ge),se.write_shift(4,Pt),se.write_shift(4,ke),se.write_shift(2,0),$n([$n(J),$n(ae),se])}var _t={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ut(z,ne){if(z.ctype)return z.ctype;var Y=z.name||"",J=Y.match(/\.([^\.]+)$/);return J&&_t[J[1]]||ne&&(J=(Y=ne).match(/[\.\\]([^\.\\])+$/),J&&_t[J[1]])?_t[J[1]]:"application/octet-stream"}function ir(z){for(var ne=Mf(z),Y=[],J=0;J<ne.length;J+=76)Y.push(ne.slice(J,J+76));return Y.join(`\r
`)+`\r
`}function Dr(z){var ne=z.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ee){var ke=Ee.charCodeAt(0).toString(16).toUpperCase();return"="+(ke.length==1?"0"+ke:ke)});ne=ne.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ne.charAt(0)==`
`&&(ne="=0D"+ne.slice(1)),ne=ne.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Y=[],J=ne.split(`\r
`),ae=0;ae<J.length;++ae){var se=J[ae];if(se.length==0){Y.push("");continue}for(var Ne=0;Ne<se.length;){var Oe=76,Ae=se.slice(Ne,Ne+Oe);Ae.charAt(Oe-1)=="="?Oe--:Ae.charAt(Oe-2)=="="?Oe-=2:Ae.charAt(Oe-3)=="="&&(Oe-=3),Ae=se.slice(Ne,Ne+Oe),Ne+=Oe,Ne<se.length&&(Ae+="="),Y.push(Ae)}}return Y.join(`\r
`)}function un(z){for(var ne=[],Y=0;Y<z.length;++Y){for(var J=z[Y];Y<=z.length&&J.charAt(J.length-1)=="=";)J=J.slice(0,J.length-1)+z[++Y];ne.push(J)}for(var ae=0;ae<ne.length;++ae)ne[ae]=ne[ae].replace(/[=][0-9A-Fa-f]{2}/g,function(se){return String.fromCharCode(parseInt(se.slice(1),16))});return Ci(ne.join(`\r
`))}function kn(z,ne,Y){for(var J="",ae="",se="",Ne,Oe=0;Oe<10;++Oe){var Ae=ne[Oe];if(!Ae||Ae.match(/^\s*$/))break;var Ee=Ae.match(/^(.*?):\s*([^\s].*)$/);if(Ee)switch(Ee[1].toLowerCase()){case"content-location":J=Ee[2].trim();break;case"content-type":se=Ee[2].trim();break;case"content-transfer-encoding":ae=Ee[2].trim();break}}switch(++Oe,ae.toLowerCase()){case"base64":Ne=Ci($s(ne.slice(Oe).join("")));break;case"quoted-printable":Ne=un(ne.slice(Oe));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ae)}var ke=Hn(z,J.slice(Y.length),Ne,{unsafe:!0});se&&(ke.ctype=se)}function Et(z,ne){if(ge(z.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Y=ne&&ne.root||"",J=(ar&&Buffer.isBuffer(z)?z.toString("binary"):ge(z)).split(`\r
`),ae=0,se="";for(ae=0;ae<J.length;++ae)if(se=J[ae],!!/^Content-Location:/i.test(se)&&(se=se.slice(se.indexOf("file")),Y||(Y=se.slice(0,se.lastIndexOf("/")+1)),se.slice(0,Y.length)!=Y))for(;Y.length>0&&(Y=Y.slice(0,Y.length-1),Y=Y.slice(0,Y.lastIndexOf("/")+1),se.slice(0,Y.length)!=Y););var Ne=(J[1]||"").match(/boundary="(.*?)"/);if(!Ne)throw new Error("MAD cannot find boundary");var Oe="--"+(Ne[1]||""),Ae=[],Ee=[],ke={FileIndex:Ae,FullPaths:Ee};O(ke);var Ge,Ze=0;for(ae=0;ae<J.length;++ae){var it=J[ae];it!==Oe&&it!==Oe+"--"||(Ze++&&kn(ke,J.slice(Ge,ae),Y),Ge=ae)}return ke}function vi(z,ne){var Y=ne||{},J=Y.boundary||"SheetJS";J="------="+J;for(var ae=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+J.slice(2)+'"',"","",""],se=z.FullPaths[0],Ne=se,Oe=z.FileIndex[0],Ae=1;Ae<z.FullPaths.length;++Ae)if(Ne=z.FullPaths[Ae].slice(se.length),Oe=z.FileIndex[Ae],!(!Oe.size||!Oe.content||Ne=="Sh33tJ5")){Ne=Ne.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Pt){return"_x"+Pt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Pt){return"_u"+Pt.charCodeAt(0).toString(16)+"_"});for(var Ee=Oe.content,ke=ar&&Buffer.isBuffer(Ee)?Ee.toString("binary"):ge(Ee),Ge=0,Ze=Math.min(1024,ke.length),it=0,Ke=0;Ke<=Ze;++Ke)(it=ke.charCodeAt(Ke))>=32&&it<128&&++Ge;var at=Ge>=Ze*4/5;ae.push(J),ae.push("Content-Location: "+(Y.root||"file:///C:/SheetJS/")+Ne),ae.push("Content-Transfer-Encoding: "+(at?"quoted-printable":"base64")),ae.push("Content-Type: "+Ut(Oe,Ne)),ae.push(""),ae.push(at?Dr(ke):ir(ke))}return ae.push(J+`--\r
`),ae.join(`\r
`)}function yi(z){var ne={};return O(ne,z),ne}function Hn(z,ne,Y,J){var ae=J&&J.unsafe;ae||O(z);var se=!ae&&gr.find(z,ne);if(!se){var Ne=z.FullPaths[0];ne.slice(0,Ne.length)==Ne?Ne=ne:(Ne.slice(-1)!="/"&&(Ne+="/"),Ne=(Ne+ne).replace("//","/")),se={name:a(ne),type:2},z.FileIndex.push(se),z.FullPaths.push(Ne),ae||gr.utils.cfb_gc(z)}return se.content=Y,se.size=Y?Y.length:0,J&&(J.CLSID&&(se.clsid=J.CLSID),J.mt&&(se.mt=J.mt),J.ct&&(se.ct=J.ct)),se}function da(z,ne){O(z);var Y=gr.find(z,ne);if(Y){for(var J=0;J<z.FileIndex.length;++J)if(z.FileIndex[J]==Y)return z.FileIndex.splice(J,1),z.FullPaths.splice(J,1),!0}return!1}function Cr(z,ne,Y){O(z);var J=gr.find(z,ne);if(J){for(var ae=0;ae<z.FileIndex.length;++ae)if(z.FileIndex[ae]==J)return z.FileIndex[ae].name=a(Y),z.FullPaths[ae]=Y,!0}return!1}function en(z){j(z,!0)}return t.find=E,t.read=M,t.parse=f,t.write=Le,t.writeFile=pe,t.utils={cfb_new:yi,cfb_add:Hn,cfb_del:da,cfb_mov:Cr,cfb_gc:en,ReadShift:mf,CheckField:hA,prep_blob:Ua,bconcat:$n,use_zlib:N,_deflateRaw:pt,_inflateRaw:tt,consts:me},t}();function zU(e){return typeof e=="string"?jp(e):Array.isArray(e)?pU(e):e}function d0(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=jp(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Bf(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([zU(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=h0(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function Wn(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function K5(e,t){for(var r=[],n=Wn(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function Mv(e){for(var t=[],r=Wn(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Cp(e){for(var t=[],r=Wn(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function qU(e){for(var t=[],r=Wn(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var vd=new Date(1899,11,30,0,0,0);function Aa(e,t){var r=e.getTime(),n=vd.getTime()+(e.getTimezoneOffset()-vd.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var Y6=new Date,WU=vd.getTime()+(Y6.getTimezoneOffset()-vd.getTimezoneOffset())*6e4,Y5=Y6.getTimezoneOffset();function X6(e){var t=new Date;return t.setTime(e*24*60*60*1e3+WU),t.getTimezoneOffset()!==Y5&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Y5)*6e4),t}var X5=new Date("2017-02-19T19:06:09.000Z"),Z6=isNaN(X5.getFullYear())?new Date("2/19/17"):X5,HU=Z6.getFullYear()==2017;function fa(e,t){var r=new Date(e);if(HU)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(Z6.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function Op(e,t){if(ar&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"‚Ç¨":"¬Ä","‚Äö":"¬Ç",∆í:"¬É","‚Äû":"¬Ñ","‚Ä¶":"¬Ö","‚Ä†":"¬Ü","‚Ä°":"¬á","ÀÜ":"¬à","‚Ä∞":"¬â",≈†:"¬ä","‚Äπ":"¬ã",≈í:"¬å",≈Ω:"¬é","‚Äò":"¬ë","‚Äô":"¬í","‚Äú":"¬ì","‚Äù":"¬î","‚Ä¢":"¬ï","‚Äì":"¬ñ","‚Äî":"¬ó","Àú":"¬ò","‚Ñ¢":"¬ô",≈°:"¬ö","‚Ä∫":"¬õ",≈ì:"¬ú",≈æ:"¬û",≈∏:"¬ü"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[‚Ç¨‚Äö∆í‚Äû‚Ä¶‚Ä†‚Ä°ÀÜ‚Ä∞≈†‚Äπ≈í≈Ω‚Äò‚Äô‚Äú‚Äù‚Ä¢‚Äì‚ÄîÀú‚Ñ¢≈°‚Ä∫≈ì≈æ≈∏]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function Ea(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=Ea(e[r]));return t}function zr(e,t){for(var r="";r.length<t;)r+=e;return r}function Ls(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var GU=["january","february","march","april","may","june","july","august","september","october","november","december"];function Rf(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&GU.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function Bt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return ar?n=Vs(r):n=mU(r),gr.utils.cfb_add(e,t,n)}gr.utils.cfb_add(e,t,r)}else e.file(t,r)}function Rv(){return gr.utils.cfb_new()}var cn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,VU={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Bv=Mv(VU),Uv=/[&<>'"]/g,KU=/[\u0000-\u0008\u000b-\u001f]/g;function hr(e){var t=e+"";return t.replace(Uv,function(r){return Bv[r]}).replace(KU,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Z5(e){return hr(e).replace(/ /g,"_x0020_")}var J6=/[\u0000-\u001f]/g;function YU(e){var t=e+"";return t.replace(Uv,function(r){return Bv[r]}).replace(/\n/g,"<br/>").replace(J6,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function XU(e){var t=e+"";return t.replace(Uv,function(r){return Bv[r]}).replace(J6,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function ZU(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function JU(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function Xm(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=a&63,t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function J5(e){var t=kl(2*e.length),r,n,a=1,i=0,s=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[i++]=s&255,t[i++]=s>>>8,s=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function Q5(e){return Vs(e,"binary").toString("utf8")}var lh="foo bar baz√¢¬ò¬É√∞¬ü¬ç¬£",pf=ar&&(Q5(lh)==Xm(lh)&&Q5||J5(lh)==Xm(lh)&&J5)||Xm,Bf=ar?function(e){return Vs(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},QU=function(){var e=[["nbsp"," "],["middot","¬∑"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),Q6=/(^\s|\s$|\n)/;function zn(e,t){return"<"+e+(t.match(Q6)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Uf(e){return Wn(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Je(e,t,r){return"<"+e+(r!=null?Uf(r):"")+(t!=null?(t.match(Q6)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Sg(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function e$(e,t){switch(typeof e){case"string":var r=Je("vt:lpwstr",hr(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Je((e|0)==e?"vt:i4":"vt:r8",hr(String(e)));case"boolean":return Je("vt:bool",e?"true":"false")}if(e instanceof Date)return Je("vt:filetime",Sg(e));throw new Error("Unable to serialize "+e)}var An={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},uu=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],$a={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function t$(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function r$(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=n?-t:t;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[r+o]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var ew=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},tw=ar?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Vs(t)})):ew(e)}:ew,rw=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(lf(e,a)));return n.join("").replace(df,"")},$v=ar?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(df,""):rw(e,t,r)}:rw,nw=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},eA=ar?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):nw(e,t,r)}:nw,aw=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(mc(e,a)));return n.join("")},p0=ar?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):aw(t,r,n)}:aw,tA=function(e,t){var r=za(e,t);return r>0?p0(e,t+4,t+4+r-1):""},rA=tA,nA=function(e,t){var r=za(e,t);return r>0?p0(e,t+4,t+4+r-1):""},aA=nA,iA=function(e,t){var r=2*za(e,t);return r>0?p0(e,t+4,t+4+r-1):""},sA=iA,oA=function(t,r){var n=za(t,r);return n>0?$v(t,r+4,r+4+n):""},lA=oA,cA=function(e,t){var r=za(e,t);return r>0?p0(e,t+4,t+4+r):""},uA=cA,fA=function(e,t){return t$(e,t)},yd=fA,zv=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};ar&&(rA=function(t,r){if(!Buffer.isBuffer(t))return tA(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},aA=function(t,r){if(!Buffer.isBuffer(t))return nA(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},sA=function(t,r){if(!Buffer.isBuffer(t))return iA(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},lA=function(t,r){if(!Buffer.isBuffer(t))return oA(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},uA=function(t,r){if(!Buffer.isBuffer(t))return cA(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},yd=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):fA(t,r)},zv=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var mc=function(e,t){return e[t]},lf=function(e,t){return e[t+1]*256+e[t]},n$=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},za=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},il=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},a$=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function mf(e,t){var r="",n,a,i=[],s,o,l,c;switch(t){case"dbcs":if(c=this.l,ar&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(lf(this,c)),c+=2;e*=2;break;case"utf8":r=p0(this,this.l,this.l+e);break;case"utf16le":e*=2,r=$v(this,this.l,this.l+e);break;case"wstr":return mf.call(this,e,"dbcs");case"lpstr-ansi":r=rA(this,this.l),e=4+za(this,this.l);break;case"lpstr-cp":r=aA(this,this.l),e=4+za(this,this.l);break;case"lpwstr":r=sA(this,this.l),e=4+2*za(this,this.l);break;case"lpp4":e=4+za(this,this.l),r=lA(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+za(this,this.l),r=uA(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=mc(this,this.l+e++))!==0;)i.push(ih(s));r=i.join("");break;case"_wstr":for(e=0,r="";(s=lf(this,this.l+e))!==0;)i.push(ih(s)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=mc(this,c),this.l=c+1,o=mf.call(this,e-l,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(ih(lf(this,c))),c+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=mc(this,c),this.l=c+1,o=mf.call(this,e-l,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(ih(mc(this,c))),c+=1}r=i.join("");break;default:switch(e){case 1:return n=mc(this,this.l),this.l++,n;case 2:return n=(t==="i"?n$:lf)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?il:a$)(this,this.l),this.l+=4,n):(a=za(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=yd(this,this.l):a=yd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=eA(this,this.l,e);break}}return this.l+=e,r}var i$=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},s$=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},o$=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function l$(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)o$(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var s=t.charCodeAt(a);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,i$(this,t,this.l);break;case 8:if(n=8,r==="f"){r$(this,t,this.l);break}case 16:break;case-4:n=4,s$(this,t,this.l);break}return this.l+=n,this}function hA(e,t){var r=eA(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Ua(e,t){e.l=t,e.read_shift=mf,e.chk=hA,e.write_shift=l$}function os(e,t){e.l+=t}function De(e){var t=kl(e);return Ua(t,0),t}function Sa(){var e=[],t=ar?256:2048,r=function(c){var f=De(c);return Ua(f,0),f},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(c){return n&&c<n.length-n.l?n:(a(),n=r(Math.max(c+1,t)))},s=function(){return a(),$n(e)},o=function(c){a(),n=c,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:o,end:s,_bufs:e}}function qe(e,t,r,n){var a=+t,i;if(!isNaN(a)){n||(n=tV[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var s=e.next(i);a<=127?s.write_shift(1,a):(s.write_shift(1,(a&127)+128),s.write_shift(1,a>>7));for(var o=0;o!=4;++o)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&zv(r)&&e.push(r)}}function gf(e,t,r){var n=Ea(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function iw(e,t,r){var n=Ea(e);return n.s=gf(n.s,t.s,r),n.e=gf(n.e,t.s,r),n}function xf(e,t){if(e.cRel&&e.c<0)for(e=Ea(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=Ea(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=dr(e);return!e.cRel&&e.cRel!=null&&(r=f$(r)),!e.rRel&&e.rRel!=null&&(r=c$(r)),r}function Zm(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Qn(e.s.c)+":"+(e.e.cRel?"":"$")+Qn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+qn(e.s.r)+":"+(e.e.rRel?"":"$")+qn(e.e.r):xf(e.s,t.biff)+":"+xf(e.e,t.biff)}function qv(e){return parseInt(u$(e),10)-1}function qn(e){return""+(e+1)}function c$(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function u$(e){return e.replace(/\$(\d+)$/,"$1")}function Wv(e){for(var t=h$(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Qn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function f$(e){return e.replace(/^([A-Z])/,"$$$1")}function h$(e){return e.replace(/^\$([A-Z])/,"$1")}function d$(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function En(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function dr(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Za(e){var t=e.indexOf(":");return t==-1?{s:En(e),e:En(e)}:{s:En(e.slice(0,t)),e:En(e.slice(t+1))}}function ln(e,t){return typeof t>"u"||typeof t=="number"?ln(e.s,e.e):(typeof e!="string"&&(e=dr(e)),typeof t!="string"&&(t=dr(t)),e==t?e:e+":"+t)}function kr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function sw(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=ko(e.z,r?Aa(t):t)}catch{}try{return e.w=ko((e.XF||{}).numFmtId||(r?14:0),r?Aa(t):t)}catch{return""+t}}function zs(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?m0[e.v]||e.v:t==null?sw(e,e.v):sw(e,t))}function Ul(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function dA(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),s=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?En(n.origin):n.origin;s=l.r,o=l.c}i["!ref"]||(i["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var f=kr(i["!ref"]);c.s.c=f.s.c,c.s.r=f.s.r,c.e.c=Math.max(c.e.c,f.e.c),c.e.r=Math.max(c.e.r,f.e.r),s==-1&&(c.e.r=s=f.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=t[h].length;++p)if(!(typeof t[h][p]>"u")){var d={v:t[h][p]},x=s+h,g=o+p;if(c.s.r>x&&(c.s.r=x),c.s.c>g&&(c.s.c=g),c.e.r<x&&(c.e.r=x),c.e.c<g&&(c.e.c=g),t[h][p]&&typeof t[h][p]=="object"&&!Array.isArray(t[h][p])&&!(t[h][p]instanceof Date))d=t[h][p];else if(Array.isArray(d.v)&&(d.f=t[h][p][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else if(n.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=n.dateNF||qr[14],n.cellDates?(d.t="d",d.w=ko(d.z,Aa(d.v))):(d.t="n",d.v=Aa(d.v),d.w=ko(d.z,d.v))):d.t="s";if(a)i[x]||(i[x]=[]),i[x][g]&&i[x][g].z&&(d.z=i[x][g].z),i[x][g]=d;else{var y=dr({c:g,r:x});i[y]&&i[y].z&&(d.z=i[y].z),i[y]=d}}}return c.s.c<1e7&&(i["!ref"]=ln(c)),i}function fu(e,t){return dA(null,e,t)}function p$(e){return e.read_shift(4,"i")}function Li(e,t){return t||(t=De(4)),t.write_shift(4,e),t}function ea(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Tn(e,t){var r=!1;return t==null&&(r=!0,t=De(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function m$(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function g$(e,t){return t||(t=De(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Hv(e,t){var r=e.l,n=e.read_shift(1),a=ea(e),i=[],s={t:a,h:a};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)i.push(m$(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}function x$(e,t){var r=!1;return t==null&&(r=!0,t=De(15+4*e.t.length)),t.write_shift(1,0),Tn(e.t,t),r?t.slice(0,t.l):t}var v$=Hv;function y$(e,t){var r=!1;return t==null&&(r=!0,t=De(23+4*e.t.length)),t.write_shift(1,1),Tn(e.t,t),t.write_shift(4,1),g$({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function xi(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function $l(e,t){return t==null&&(t=De(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function zl(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function ql(e,t){return t==null&&(t=De(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var b$=ea,pA=Tn;function Gv(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function bd(e,t){var r=!1;return t==null&&(r=!0,t=De(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var w$=ea,Ag=Gv,Vv=bd;function mA(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?yd([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):il(t,0)>>2;return r?a/100:a}function gA(e,t){t==null&&(t=De(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?n=1:a==(a|0)&&a>=-(1<<29)&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function xA(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function _$(e,t){return t||(t=De(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Wl=xA,hu=_$;function du(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Cl(e,t){return(t||De(8)).write_shift(8,e,"f")}function N$(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var c=O$[a];c&&(t.rgb=xw(c));break;case 2:t.rgb=xw([s,o,l]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function wd(e,t){if(t||(t=De(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function S$(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function A$(e,t){t||(t=De(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var vA=2,Ra=3,ch=11,_d=19,uh=64,E$=65,T$=71,j$=4108,P$=4126,Rn=80,ow={1:{n:"CodePage",t:vA},2:{n:"Category",t:Rn},3:{n:"PresentationFormat",t:Rn},4:{n:"ByteCount",t:Ra},5:{n:"LineCount",t:Ra},6:{n:"ParagraphCount",t:Ra},7:{n:"SlideCount",t:Ra},8:{n:"NoteCount",t:Ra},9:{n:"HiddenCount",t:Ra},10:{n:"MultimediaClipCount",t:Ra},11:{n:"ScaleCrop",t:ch},12:{n:"HeadingPairs",t:j$},13:{n:"TitlesOfParts",t:P$},14:{n:"Manager",t:Rn},15:{n:"Company",t:Rn},16:{n:"LinksUpToDate",t:ch},17:{n:"CharacterCount",t:Ra},19:{n:"SharedDoc",t:ch},22:{n:"HyperlinksChanged",t:ch},23:{n:"AppVersion",t:Ra,p:"version"},24:{n:"DigSig",t:E$},26:{n:"ContentType",t:Rn},27:{n:"ContentStatus",t:Rn},28:{n:"Language",t:Rn},29:{n:"Version",t:Rn},255:{},2147483648:{n:"Locale",t:_d},2147483651:{n:"Behavior",t:_d},1919054434:{}},lw={1:{n:"CodePage",t:vA},2:{n:"Title",t:Rn},3:{n:"Subject",t:Rn},4:{n:"Author",t:Rn},5:{n:"Keywords",t:Rn},6:{n:"Comments",t:Rn},7:{n:"Template",t:Rn},8:{n:"LastAuthor",t:Rn},9:{n:"RevNumber",t:Rn},10:{n:"EditTime",t:uh},11:{n:"LastPrinted",t:uh},12:{n:"CreatedDate",t:uh},13:{n:"ModifiedDate",t:uh},14:{n:"PageCount",t:Ra},15:{n:"WordCount",t:Ra},16:{n:"CharCount",t:Ra},17:{n:"Thumbnail",t:T$},18:{n:"Application",t:Rn},19:{n:"DocSecurity",t:Ra},255:{},2147483648:{n:"Locale",t:_d},2147483651:{n:"Behavior",t:_d},1919054434:{}};function k$(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var C$=k$([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),O$=Ea(C$),m0={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},L$={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},fh={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function yA(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function bA(e,t){var r=qU(L$),n=[],a;n[n.length]=cn,n[n.length]=Je("Types",null,{xmlns:An.CT,"xmlns:xsd":An.xsd,"xmlns:xsi":An.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Je("Default",null,{Extension:l[0],ContentType:l[1]})}));var i=function(l){e[l]&&e[l].length>0&&(a=e[l][0],n[n.length]=Je("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:fh[l][t.bookType]||fh[l].xlsx}))},s=function(l){(e[l]||[]).forEach(function(c){n[n.length]=Je("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:fh[l][t.bookType]||fh[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(c){n[n.length]=Je("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return i("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Zt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function wA(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Pc(e){var t=[cn,Je("Relationships",null,{xmlns:An.RELS})];return Wn(e["!id"]).forEach(function(r){t[t.length]=Je("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function cr(e,t,r,n,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[Zt.HLINK,Zt.XPATH,Zt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}function F$(e){var t=[cn];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function cw(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function D$(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function I$(e){var t=[cn];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(cw(e[r][0],e[r][1])),t.push(D$("",e[r][0]));return t.push(cw("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function _A(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+pd.version+"</meta:generator></office:meta></office:document-meta>"}var _l=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Jm(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=hr(t),n[n.length]=r?Je(e,t,r):zn(e,t))}function NA(e,t){var r=t||{},n=[cn,Je("cp:coreProperties",null,{"xmlns:cp":An.CORE_PROPS,"xmlns:dc":An.dc,"xmlns:dcterms":An.dcterms,"xmlns:dcmitype":An.dcmitype,"xmlns:xsi":An.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Jm("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Sg(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&Jm("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Sg(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=_l.length;++i){var s=_l[i],o=r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:e?e[s[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Jm(s[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var kc=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],SA=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function AA(e){var t=[],r=Je;return e||(e={}),e.Application="SheetJS",t[t.length]=cn,t[t.length]=Je("Properties",null,{xmlns:An.EXT_PROPS,"xmlns:vt":An.vt}),kc.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=hr(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+hr(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function EA(e){var t=[cn,Je("Properties",null,{xmlns:An.CUST_PROPS,"xmlns:vt":An.vt})];if(!e)return t.join("");var r=1;return Wn(e).forEach(function(a){++r,t[t.length]=Je("property",e$(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:hr(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var uw={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function M$(e,t){var r=[];return Wn(uw).map(function(n){for(var a=0;a<_l.length;++a)if(_l[a][1]==n)return _l[a];for(a=0;a<kc.length;++a)if(kc[a][1]==n)return kc[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(zn(uw[n[1]]||n[1],a))}}),Je("DocumentProperties",r.join(""),{xmlns:$a.o})}function R$(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&Wn(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var s=0;s<_l.length;++s)if(i==_l[s][1])return;for(s=0;s<kc.length;++s)if(i==kc[s][1])return;for(s=0;s<r.length;++s)if(i==r[s])return;var o=e[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),a.push(Je(Z5(i),o,{"dt:dt":l}))}}),t&&Wn(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var s=t[i],o="string";typeof s=="number"?(o="float",s=String(s)):s===!0||s===!1?(o="boolean",s=s?"1":"0"):s instanceof Date?(o="dateTime.tz",s=s.toISOString()):s=String(s),a.push(Je(Z5(i),s,{"dt:dt":o}))}}),"<"+n+' xmlns="'+$a.o+'">'+a.join("")+"</"+n+">"}function B$(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var s=De(8);return s.write_shift(4,n),s.write_shift(4,a),s}function fw(e,t){var r=De(4),n=De(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=De(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=B$(t);break;case 31:case 80:for(n=De(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return $n([r,n])}var TA=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function U$(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function hw(e,t,r){var n=De(8),a=[],i=[],s=8,o=0,l=De(8),c=De(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),i.push(l),a.push(c),s+=8+l.length,!t){c=De(8),c.write_shift(4,0),a.unshift(c);var f=[De(4)];for(f[0].write_shift(4,e.length),o=0;o<e.length;++o){var h=e[o][0];for(l=De(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);f.push(l)}l=$n(f),i.unshift(l),s+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(TA.indexOf(e[o][0])>-1||SA.indexOf(e[o][0])>-1)&&e[o][1]!=null){var p=e[o][1],d=0;if(t){d=+t[e[o][0]];var x=r[d];if(x.p=="version"&&typeof p=="string"){var g=p.split(".");p=(+g[0]<<16)+(+g[1]||0)}l=fw(x.t,p)}else{var y=U$(p);y==-1&&(y=31,p=String(p)),l=fw(y,p)}i.push(l),c=De(8),c.write_shift(4,t?d:2+o),a.push(c),s+=8+l.length}var b=8*(i.length+1);for(o=0;o<i.length;++o)a[o].write_shift(4,b),b+=i[o].length;return n.write_shift(4,s),n.write_shift(4,i.length),$n([n].concat(a).concat(i))}function dw(e,t,r,n,a,i){var s=De(a?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,gr.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,a?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,a?68:48);var l=hw(e,r,n);if(o.push(l),a){var c=hw(a,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+l.length),o.push(c)}return $n(o)}function $$(e,t){t||(t=De(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function z$(e,t){return e.read_shift(t)===1}function la(e,t){return t||(t=De(2)),t.write_shift(2,+!!e),t}function jA(e){return e.read_shift(2,"u")}function oi(e,t){return t||(t=De(2)),t.write_shift(2,e),t}function PA(e,t,r){return r||(r=De(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function kA(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var s=n?e.read_shift(n,a):"";return s}function q$(e){var t=e.t||"",r=De(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=De(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return $n(a)}function W$(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function H$(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):W$(e,n,r)}function G$(e,t,r){if(r.biff>5)return H$(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function CA(e,t,r){return r||(r=De(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function pw(e,t){t||(t=De(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function V$(e){var t=De(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)t.write_shift(4,s[r]);if(i==28)n=n.slice(1),pw(n,t);else if(i&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));var o=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),i&8&&pw(a>-1?n.slice(a+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Ol(e,t,r,n){return n||(n=De(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function K$(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[a,i,s]}function Y$(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function OA(e,t){return t||(t=De(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function Kv(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=De(a);return i.write_shift(2,n),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function X$(e,t){var r=!t||t.biff==8,n=De(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function Z$(e,t){var r=!t||t.biff>=8?2:1,n=De(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function J$(e,t){var r=De(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=q$(e[a]);var i=$n([r].concat(n));return i.parts=[r.length].concat(n.map(function(s){return s.length})),i}function Q$(){var e=De(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function ez(e){var t=De(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function tz(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,i=De(a);return i.write_shift(2,(e.sz||12)*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function rz(e,t,r,n){var a=De(10);return Ol(e,t,n,a),a.write_shift(4,r),a}function nz(e,t,r,n,a){var i=!a||a.biff==8,s=De(8+ +i+(1+i)*r.length);return Ol(e,t,n,s),s.write_shift(2,r.length),i&&s.write_shift(1,1),s.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),s}function az(e,t,r,n){var a=r&&r.biff==5;n||(n=De(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}function iz(e,t){var r=t.biff==8||!t.biff?4:2,n=De(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function mw(e,t,r,n){var a=r&&r.biff==5;n||(n=De(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function sz(e){var t=De(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function oz(e,t,r,n,a,i){var s=De(8);return Ol(e,t,n,s),PA(r,i,s),s}function lz(e,t,r,n){var a=De(14);return Ol(e,t,n,a),Cl(r,a),a}function cz(e,t,r){if(r.biff<8)return uz(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(K$(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function uz(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=kA(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function fz(e){var t=De(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)OA(e[r],t);return t}function hz(e){var t=De(24),r=En(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return $n([t,V$(e[1])])}function dz(e){var t=e[1].Tooltip,r=De(10+2*(t.length+1));r.write_shift(2,2048);var n=En(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function pz(e){return e||(e=De(4)),e.write_shift(2,1),e.write_shift(2,1),e}function mz(e,t,r){if(!r.cellStyles)return os(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:a,e:i,w:s,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function gz(e,t){var r=De(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function xz(e){for(var t=De(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function vz(e,t,r){var n=De(15);return x0(n,e,t),n.write_shift(8,r,"f"),n}function yz(e,t,r){var n=De(9);return x0(n,e,t),n.write_shift(2,r),n}var bz=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=Mv({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],f=kl(1);switch(l.type){case"base64":f=Ci($s(o));break;case"binary":f=Ci(o);break;case"buffer":case"array":f=o;break}Ua(f,0);var h=f.read_shift(1),p=!!(h&136),d=!1,x=!1;switch(h){case 2:break;case 3:break;case 48:d=!0,p=!0;break;case 49:d=!0,p=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var g=0,y=521;h==2&&(g=f.read_shift(2)),f.l+=3,h!=2&&(g=f.read_shift(4)),g>1048576&&(g=1e6),h!=2&&(y=f.read_shift(2));var b=f.read_shift(2),T=l.codepage||1252;h!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(T=e[f[f.l]]),f.l+=1,f.l+=2),x&&(f.l+=36);for(var S=[],k={},A=Math.min(f.length,h==2?521:y-10-(d?264:0)),M=x?32:11;f.l<A&&f[f.l]!=13;)switch(k={},k.name=al.utils.decode(T,f.slice(f.l,f.l+M)).replace(/[\u0000\r\n].*$/g,""),f.l+=M,k.type=String.fromCharCode(f.read_shift(1)),h!=2&&!x&&(k.offset=f.read_shift(4)),k.len=f.read_shift(1),h==2&&(k.offset=f.read_shift(2)),k.dec=f.read_shift(1),k.name.length&&S.push(k),h!=2&&(f.l+=x?13:14),k.type){case"B":(!d||k.len!=8)&&l.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+k.name+":"+k.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+k.type)}if(f[f.l]!==13&&(f.l=y-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=y;var O=0,I=0;for(c[0]=[],I=0;I!=S.length;++I)c[0][I]=S[I].name;for(;g-- >0;){if(f[f.l]===42){f.l+=b;continue}for(++f.l,c[++O]=[],I=0,I=0;I!=S.length;++I){var j=f.slice(f.l,f.l+S[I].len);f.l+=S[I].len,Ua(j,0);var W=al.utils.decode(T,j);switch(S[I].type){case"C":W.trim().length&&(c[O][I]=W.replace(/\s+$/,""));break;case"D":W.length===8?c[O][I]=new Date(+W.slice(0,4),+W.slice(4,6)-1,+W.slice(6,8)):c[O][I]=W;break;case"F":c[O][I]=parseFloat(W.trim());break;case"+":case"I":c[O][I]=x?j.read_shift(-4,"i")^2147483648:j.read_shift(4,"i");break;case"L":switch(W.trim().toUpperCase()){case"Y":case"T":c[O][I]=!0;break;case"N":case"F":c[O][I]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+W+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[O][I]="##MEMO##"+(x?parseInt(W.trim(),10):j.read_shift(4));break;case"N":W=W.replace(/\u0000/g,"").trim(),W&&W!="."&&(c[O][I]=+W||0);break;case"@":c[O][I]=new Date(j.read_shift(-8,"f")-621356832e5);break;case"T":c[O][I]=new Date((j.read_shift(4)-2440588)*864e5+j.read_shift(4));break;case"Y":c[O][I]=j.read_shift(4,"i")/1e4+j.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[O][I]=-j.read_shift(-8,"f");break;case"B":if(d&&S[I].len==8){c[O][I]=j.read_shift(8,"f");break}case"G":case"P":j.l+=S[I].len;break;case"0":if(S[I].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+S[I].type)}}}if(h!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=S,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var f=fu(r(o,c),c);return f["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,f}function a(o,l){try{return Ul(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,l){var c=l||{};if(+c.codepage>=0&&If(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var f=Sa(),h=Td(o,{header:1,raw:!0,cellDates:!0}),p=h[0],d=h.slice(1),x=o["!cols"]||[],g=0,y=0,b=0,T=1;for(g=0;g<p.length;++g){if(((x[g]||{}).DBF||{}).name){p[g]=x[g].DBF.name,++b;continue}if(p[g]!=null){if(++b,typeof p[g]=="number"&&(p[g]=p[g].toString(10)),typeof p[g]!="string")throw new Error("DBF Invalid column name "+p[g]+" |"+typeof p[g]+"|");if(p.indexOf(p[g])!==g){for(y=0;y<1024;++y)if(p.indexOf(p[g]+"_"+y)==-1){p[g]+="_"+y;break}}}}var S=kr(o["!ref"]),k=[],A=[],M=[];for(g=0;g<=S.e.c-S.s.c;++g){var O="",I="",j=0,W=[];for(y=0;y<d.length;++y)d[y][g]!=null&&W.push(d[y][g]);if(W.length==0||p[g]==null){k[g]="?";continue}for(y=0;y<W.length;++y){switch(typeof W[y]){case"number":I="B";break;case"string":I="C";break;case"boolean":I="L";break;case"object":I=W[y]instanceof Date?"D":"C";break;default:I="C"}j=Math.max(j,String(W[y]).length),O=O&&O!=I?"C":I}j>250&&(j=250),I=((x[g]||{}).DBF||{}).type,I=="C"&&x[g].DBF.len>j&&(j=x[g].DBF.len),O=="B"&&I=="N"&&(O="N",M[g]=x[g].DBF.dec,j=x[g].DBF.len),A[g]=O=="C"||I=="N"?j:i[O]||0,T+=A[g],k[g]=O}var E=f.next(32);for(E.write_shift(4,318902576),E.write_shift(4,d.length),E.write_shift(2,296+32*b),E.write_shift(2,T),g=0;g<4;++g)E.write_shift(4,0);for(E.write_shift(4,0|(+t[F6]||3)<<8),g=0,y=0;g<p.length;++g)if(p[g]!=null){var C=f.next(32),G=(p[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);C.write_shift(1,G,"sbcs"),C.write_shift(1,k[g]=="?"?"C":k[g],"sbcs"),C.write_shift(4,y),C.write_shift(1,A[g]||i[k[g]]||0),C.write_shift(1,M[g]||0),C.write_shift(1,2),C.write_shift(4,0),C.write_shift(1,0),C.write_shift(4,0),C.write_shift(4,0),y+=A[g]||i[k[g]]||0}var Z=f.next(264);for(Z.write_shift(4,13),g=0;g<65;++g)Z.write_shift(4,0);for(g=0;g<d.length;++g){var he=f.next(T);for(he.write_shift(1,0),y=0;y<p.length;++y)if(p[y]!=null)switch(k[y]){case"L":he.write_shift(1,d[g][y]==null?63:d[g][y]?84:70);break;case"B":he.write_shift(8,d[g][y]||0,"f");break;case"N":var oe="0";for(typeof d[g][y]=="number"&&(oe=d[g][y].toFixed(M[y]||0)),b=0;b<A[y]-oe.length;++b)he.write_shift(1,32);he.write_shift(1,oe,"sbcs");break;case"D":d[g][y]?(he.write_shift(4,("0000"+d[g][y].getFullYear()).slice(-4),"sbcs"),he.write_shift(2,("00"+(d[g][y].getMonth()+1)).slice(-2),"sbcs"),he.write_shift(2,("00"+d[g][y].getDate()).slice(-2),"sbcs")):he.write_shift(8,"00000000","sbcs");break;case"C":var me=String(d[g][y]!=null?d[g][y]:"").slice(0,A[y]);for(he.write_shift(1,me,"sbcs"),b=0;b<A[y]-me.length;++b)he.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}}(),wz=function(){var e={AA:"√Ä",BA:"√Å",CA:"√Ç",DA:195,HA:"√Ñ",JA:197,AE:"√à",BE:"√â",CE:"√ä",HE:"√ã",AI:"√å",BI:"√ç",CI:"√é",HI:"√è",AO:"√í",BO:"√ì",CO:"√î",DO:213,HO:"√ñ",AU:"√ô",BU:"√ö",CU:"√õ",HU:"√ú",Aa:"√†",Ba:"√°",Ca:"√¢",Da:227,Ha:"√§",Ja:229,Ae:"√®",Be:"√©",Ce:"√™",He:"√´",Ai:"√¨",Bi:"√≠",Ci:"√Æ",Hi:"√Ø",Ao:"√≤",Bo:"√≥",Co:"√¥",Do:245,Ho:"√∂",Au:"√π",Bu:"√∫",Cu:"√ª",Hu:"√º",KC:"√á",Kc:"√ß",q:"√¶",z:"≈ì",a:"√Ü",j:"≈í",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Wn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,d){var x=e[d];return typeof x=="number"?B5(x):x},n=function(p,d,x){var g=d.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return g==59?p:B5(g)};e["|"]=254;function a(p,d){switch(d.type){case"base64":return i($s(p),d);case"binary":return i(p,d);case"buffer":return i(ar&&Buffer.isBuffer(p)?p.toString("binary"):h0(p),d);case"array":return i(Op(p),d)}throw new Error("Unrecognized type "+d.type)}function i(p,d){var x=p.split(/[\n\r]+/),g=-1,y=-1,b=0,T=0,S=[],k=[],A=null,M={},O=[],I=[],j=[],W=0,E;for(+d.codepage>=0&&If(+d.codepage);b!==x.length;++b){W=0;var C=x[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),G=C.replace(/;;/g,"\0").split(";").map(function(F){return F.replace(/\u0000/g,";")}),Z=G[0],he;if(C.length>0)switch(Z){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":G[1].charAt(0)=="P"&&k.push(C.slice(3).replace(/;;/g,";"));break;case"C":var oe=!1,me=!1,pe=!1,ge=!1,Le=-1,Se=-1;for(T=1;T<G.length;++T)switch(G[T].charAt(0)){case"A":break;case"X":y=parseInt(G[T].slice(1))-1,me=!0;break;case"Y":for(g=parseInt(G[T].slice(1))-1,me||(y=0),E=S.length;E<=g;++E)S[E]=[];break;case"K":he=G[T].slice(1),he.charAt(0)==='"'?he=he.slice(1,he.length-1):he==="TRUE"?he=!0:he==="FALSE"?he=!1:isNaN(Ls(he))?isNaN(Rf(he).getDate())||(he=fa(he)):(he=Ls(he),A!==null&&G6(A)&&(he=X6(he))),oe=!0;break;case"E":ge=!0;var N=yq(G[T].slice(1),{r:g,c:y});S[g][y]=[S[g][y],N];break;case"S":pe=!0,S[g][y]=[S[g][y],"S5S"];break;case"G":break;case"R":Le=parseInt(G[T].slice(1))-1;break;case"C":Se=parseInt(G[T].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+C)}if(oe&&(S[g][y]&&S[g][y].length==2?S[g][y][0]=he:S[g][y]=he,A=null),pe){if(ge)throw new Error("SYLK shared formula cannot have own formula");var D=Le>-1&&S[Le][Se];if(!D||!D[1])throw new Error("SYLK shared formula cannot find base");S[g][y][1]=bq(D[1],{r:g-Le,c:y-Se})}break;case"F":var L=0;for(T=1;T<G.length;++T)switch(G[T].charAt(0)){case"X":y=parseInt(G[T].slice(1))-1,++L;break;case"Y":for(g=parseInt(G[T].slice(1))-1,E=S.length;E<=g;++E)S[E]=[];break;case"M":W=parseInt(G[T].slice(1))/20;break;case"F":break;case"G":break;case"P":A=k[parseInt(G[T].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(j=G[T].slice(1).split(" "),E=parseInt(j[0],10);E<=parseInt(j[1],10);++E)W=parseInt(j[2],10),I[E-1]=W===0?{hidden:!0}:{wch:W},Yv(I[E-1]);break;case"C":y=parseInt(G[T].slice(1))-1,I[y]||(I[y]={});break;case"R":g=parseInt(G[T].slice(1))-1,O[g]||(O[g]={}),W>0?(O[g].hpt=W,O[g].hpx=MA(W)):W===0&&(O[g].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+C)}L<1&&(A=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+C)}}return O.length>0&&(M["!rows"]=O),I.length>0&&(M["!cols"]=I),d&&d.sheetRows&&(S=S.slice(0,d.sheetRows)),[S,M]}function s(p,d){var x=a(p,d),g=x[0],y=x[1],b=fu(g,d);return Wn(y).forEach(function(T){b[T]=y[T]}),b}function o(p,d){return Ul(s(p,d),d)}function l(p,d,x,g){var y="C;Y"+(x+1)+";X"+(g+1)+";K";switch(p.t){case"n":y+=p.v||0,p.f&&!p.F&&(y+=";E"+Zv(p.f,{r:x,c:g}));break;case"b":y+=p.v?"TRUE":"FALSE";break;case"e":y+=p.w||p.v;break;case"d":y+='"'+(p.w||p.v)+'"';break;case"s":y+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function c(p,d){d.forEach(function(x,g){var y="F;W"+(g+1)+" "+(g+1)+" ";x.hidden?y+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=Nd(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=Sd(x.wpx)),typeof x.wch=="number"&&(y+=Math.round(x.wch))),y.charAt(y.length-1)!=" "&&p.push(y)})}function f(p,d){d.forEach(function(x,g){var y="F;";x.hidden?y+="M0;":x.hpt?y+="M"+20*x.hpt+";":x.hpx&&(y+="M"+20*Ad(x.hpx)+";"),y.length>2&&p.push(y+"R"+(g+1))})}function h(p,d){var x=["ID;PWXL;N;E"],g=[],y=kr(p["!ref"]),b,T=Array.isArray(p),S=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),p["!cols"]&&c(x,p["!cols"]),p["!rows"]&&f(x,p["!rows"]),x.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var k=y.s.r;k<=y.e.r;++k)for(var A=y.s.c;A<=y.e.c;++A){var M=dr({r:k,c:A});b=T?(p[k]||[])[A]:p[M],!(!b||b.v==null&&(!b.f||b.F))&&g.push(l(b,p,k,A))}return x.join(S)+S+g.join(S)+S+"E"+S}return{to_workbook:o,to_sheet:s,from_sheet:h}}(),_z=function(){function e(i,s){switch(s.type){case"base64":return t($s(i),s);case"binary":return t(i,s);case"buffer":return t(ar&&Buffer.isBuffer(i)?i.toString("binary"):h0(i),s);case"array":return t(Op(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){for(var o=i.split(`
`),l=-1,c=-1,f=0,h=[];f!==o.length;++f){if(o[f].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var p=o[f].trim().split(","),d=p[0],x=p[1];++f;for(var g=o[f]||"";(g.match(/["]/g)||[]).length&1&&f<o.length-1;)g+=`
`+o[++f];switch(g=g.trim(),+d){case-1:if(g==="BOT"){h[++l]=[],c=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?h[l][c]=!0:g==="FALSE"?h[l][c]=!1:isNaN(Ls(x))?isNaN(Rf(x).getDate())?h[l][c]=x:h[l][c]=fa(x):h[l][c]=Ls(x),++c;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),h[l][c++]=g!==""?g:null;break}if(g==="EOD")break}}return s&&s.sheetRows&&(h=h.slice(0,s.sheetRows)),h}function r(i,s){return fu(e(i,s),s)}function n(i,s){return Ul(r(i,s),s)}var a=function(){var i=function(l,c,f,h,p){l.push(c),l.push(f+","+h),l.push('"'+p.replace(/"/g,'""')+'"')},s=function(l,c,f,h){l.push(c+","+f),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],f=kr(l["!ref"]),h,p=Array.isArray(l);i(c,"TABLE",0,1,"sheetjs"),i(c,"VECTORS",0,f.e.r-f.s.r+1,""),i(c,"TUPLES",0,f.e.c-f.s.c+1,""),i(c,"DATA",0,0,"");for(var d=f.s.r;d<=f.e.r;++d){s(c,-1,0,"BOT");for(var x=f.s.c;x<=f.e.c;++x){var g=dr({r:d,c:x});if(h=p?(l[d]||[])[x]:l[g],!h){s(c,1,0,"");continue}switch(h.t){case"n":var y=h.w;!y&&h.v!=null&&(y=h.v),y==null?h.f&&!h.F?s(c,1,0,"="+h.f):s(c,1,0,""):s(c,0,y,"V");break;case"b":s(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":s(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=ko(h.z||qr[14],Aa(fa(h.v)))),s(c,0,h.w,"V");break;default:s(c,1,0,"")}}}s(c,-1,0,"EOD");var b=`\r
`,T=c.join(b);return T}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),LA=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,p){for(var d=h.split(`
`),x=-1,g=-1,y=0,b=[];y!==d.length;++y){var T=d[y].trim().split(":");if(T[0]==="cell"){var S=En(T[1]);if(b.length<=S.r)for(x=b.length;x<=S.r;++x)b[x]||(b[x]=[]);switch(x=S.r,g=S.c,T[2]){case"t":b[x][g]=e(T[3]);break;case"v":b[x][g]=+T[3];break;case"vtf":var k=T[T.length-1];case"vtc":switch(T[3]){case"nl":b[x][g]=!!+T[4];break;default:b[x][g]=+T[4];break}T[2]=="vtf"&&(b[x][g]=[b[x][g],k])}}}return p&&p.sheetRows&&(b=b.slice(0,p.sheetRows)),b}function n(h,p){return fu(r(h,p),p)}function a(h,p){return Ul(n(h,p),p)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var p=[],d=[],x,g="",y=Za(h["!ref"]),b=Array.isArray(h),T=y.s.r;T<=y.e.r;++T)for(var S=y.s.c;S<=y.e.c;++S)if(g=dr({r:T,c:S}),x=b?(h[T]||[])[S]:h[g],!(!x||x.v==null||x.t==="z")){switch(d=["cell",g,"t"],x.t){case"s":case"str":d.push(t(x.v));break;case"n":x.f?(d[2]="vtf",d[3]="n",d[4]=x.v,d[5]=t(x.f)):(d[2]="v",d[3]=x.v);break;case"b":d[2]="vt"+(x.f?"f":"c"),d[3]="nl",d[4]=x.v?"1":"0",d[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var k=Aa(fa(x.v));d[2]="vtc",d[3]="nd",d[4]=""+k,d[5]=x.w||ko(x.z||qr[14],k);break;case"e":continue}p.push(d.join(":"))}return p.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function f(h){return[i,s,o,s,c(h),l].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:f}}(),Nz=function(){function e(f,h,p,d,x){x.raw?h[p][d]=f:f===""||(f==="TRUE"?h[p][d]=!0:f==="FALSE"?h[p][d]=!1:isNaN(Ls(f))?isNaN(Rf(f).getDate())?h[p][d]=f:h[p][d]=fa(f):h[p][d]=Ls(f))}function t(f,h){var p=h||{},d=[];if(!f||f.length===0)return d;for(var x=f.split(/[\r\n]/),g=x.length-1;g>=0&&x[g].length===0;)--g;for(var y=10,b=0,T=0;T<=g;++T)b=x[T].indexOf(" "),b==-1?b=x[T].length:b++,y=Math.max(y,b);for(T=0;T<=g;++T){d[T]=[];var S=0;for(e(x[T].slice(0,y).trim(),d,T,S,p),S=1;S<=(x[T].length-y)/10+1;++S)e(x[T].slice(y+(S-1)*10,y+S*10).trim(),d,T,S,p)}return p.sheetRows&&(d=d.slice(0,p.sheetRows)),d}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(f){for(var h={},p=!1,d=0,x=0;d<f.length;++d)(x=f.charCodeAt(d))==34?p=!p:!p&&x in r&&(h[x]=(h[x]||0)+1);x=[];for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&x.push([h[d],d]);if(!x.length){h=n;for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&x.push([h[d],d])}return x.sort(function(g,y){return g[0]-y[0]||n[g[1]]-n[y[1]]}),r[x.pop()[1]]||44}function i(f,h){var p=h||{},d="",x=p.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(d=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(d=f.charAt(4),f=f.slice(6)):d=a(f.slice(0,1024)):p&&p.FS?d=p.FS:d=a(f.slice(0,1024));var y=0,b=0,T=0,S=0,k=0,A=d.charCodeAt(0),M=!1,O=0,I=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var j=p.dateNF!=null?BU(p.dateNF):null;function W(){var E=f.slice(S,k),C={};if(E.charAt(0)=='"'&&E.charAt(E.length-1)=='"'&&(E=E.slice(1,-1).replace(/""/g,'"')),E.length===0)C.t="z";else if(p.raw)C.t="s",C.v=E;else if(E.trim().length===0)C.t="s",C.v=E;else if(E.charCodeAt(0)==61)E.charCodeAt(1)==34&&E.charCodeAt(E.length-1)==34?(C.t="s",C.v=E.slice(2,-1).replace(/""/g,'"')):wq(E)?(C.t="n",C.f=E.slice(1)):(C.t="s",C.v=E);else if(E=="TRUE")C.t="b",C.v=!0;else if(E=="FALSE")C.t="b",C.v=!1;else if(!isNaN(T=Ls(E)))C.t="n",p.cellText!==!1&&(C.w=E),C.v=T;else if(!isNaN(Rf(E).getDate())||j&&E.match(j)){C.z=p.dateNF||qr[14];var G=0;j&&E.match(j)&&(E=UU(E,p.dateNF,E.match(j)||[]),G=1),p.cellDates?(C.t="d",C.v=fa(E,G)):(C.t="n",C.v=Aa(fa(E,G))),p.cellText!==!1&&(C.w=ko(C.z,C.v instanceof Date?Aa(C.v):C.v)),p.cellNF||delete C.z}else C.t="s",C.v=E;if(C.t=="z"||(p.dense?(x[y]||(x[y]=[]),x[y][b]=C):x[dr({c:b,r:y})]=C),S=k+1,I=f.charCodeAt(S),g.e.c<b&&(g.e.c=b),g.e.r<y&&(g.e.r=y),O==A)++b;else if(b=0,++y,p.sheetRows&&p.sheetRows<=y)return!0}e:for(;k<f.length;++k)switch(O=f.charCodeAt(k)){case 34:I===34&&(M=!M);break;case A:case 10:case 13:if(!M&&W())break e;break}return k-S>0&&W(),x["!ref"]=ln(g),x}function s(f,h){return!(h&&h.PRN)||h.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?i(f,h):fu(t(f,h),h)}function o(f,h){var p="",d=h.type=="string"?[0,0,0,0]:DV(f,h);switch(h.type){case"base64":p=$s(f);break;case"binary":p=f;break;case"buffer":h.codepage==65001?p=f.toString("utf8"):h.codepage&&typeof al<"u"?p=al.utils.decode(h.codepage,f):p=ar&&Buffer.isBuffer(f)?f.toString("binary"):h0(f);break;case"array":p=Op(f);break;case"string":p=f;break;default:throw new Error("Unrecognized type "+h.type)}return d[0]==239&&d[1]==187&&d[2]==191?p=pf(p.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?p=pf(p):h.type=="binary"&&typeof al<"u"&&h.codepage&&(p=al.utils.decode(h.codepage,al.utils.encode(28591,p))),p.slice(0,19)=="socialcalc:version:"?LA.to_sheet(h.type=="string"?p:pf(p),h):s(p,h)}function l(f,h){return Ul(o(f,h),h)}function c(f){for(var h=[],p=kr(f["!ref"]),d,x=Array.isArray(f),g=p.s.r;g<=p.e.r;++g){for(var y=[],b=p.s.c;b<=p.e.c;++b){var T=dr({r:g,c:b});if(d=x?(f[g]||[])[b]:f[T],!d||d.v==null){y.push("          ");continue}for(var S=(d.w||(zs(d),d.w)||"").slice(0,10);S.length<10;)S+=" ";y.push(S+(b===0?" ":""))}h.push(y.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}(),gw=function(){function e(N,D,L){if(N){Ua(N,N.l||0);for(var F=L.Enum||Le;N.l<N.length;){var K=N.read_shift(2),ce=F[K]||F[65535],xe=N.read_shift(2),ee=N.l+xe,fe=ce.f&&ce.f(N,xe,L);if(N.l=ee,D(fe,ce,K))return}}}function t(N,D){switch(D.type){case"base64":return r(Ci($s(N)),D);case"binary":return r(Ci(N),D);case"buffer":case"array":return r(N,D)}throw"Unsupported type "+D.type}function r(N,D){if(!N)return N;var L=D||{},F=L.dense?[]:{},K="Sheet1",ce="",xe=0,ee={},fe=[],le=[],ue={s:{r:0,c:0},e:{r:0,c:0}},$e=L.sheetRows||0;if(N[2]==0&&(N[3]==8||N[3]==9)&&N.length>=16&&N[14]==5&&N[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(N[2]==2)L.Enum=Le,e(N,function(Re,ot,ze){switch(ze){case 0:L.vers=Re,Re>=4096&&(L.qpro=!0);break;case 6:ue=Re;break;case 204:Re&&(ce=Re);break;case 222:ce=Re;break;case 15:case 51:L.qpro||(Re[1].v=Re[1].v.slice(1));case 13:case 14:case 16:ze==14&&(Re[2]&112)==112&&(Re[2]&15)>1&&(Re[2]&15)<15&&(Re[1].z=L.dateNF||qr[14],L.cellDates&&(Re[1].t="d",Re[1].v=X6(Re[1].v))),L.qpro&&Re[3]>xe&&(F["!ref"]=ln(ue),ee[K]=F,fe.push(K),F=L.dense?[]:{},ue={s:{r:0,c:0},e:{r:0,c:0}},xe=Re[3],K=ce||"Sheet"+(xe+1),ce="");var lt=L.dense?(F[Re[0].r]||[])[Re[0].c]:F[dr(Re[0])];if(lt){lt.t=Re[1].t,lt.v=Re[1].v,Re[1].z!=null&&(lt.z=Re[1].z),Re[1].f!=null&&(lt.f=Re[1].f);break}L.dense?(F[Re[0].r]||(F[Re[0].r]=[]),F[Re[0].r][Re[0].c]=Re[1]):F[dr(Re[0])]=Re[1];break}},L);else if(N[2]==26||N[2]==14)L.Enum=Se,N[2]==14&&(L.qpro=!0,N.l=0),e(N,function(Re,ot,ze){switch(ze){case 204:K=Re;break;case 22:Re[1].v=Re[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Re[3]>xe&&(F["!ref"]=ln(ue),ee[K]=F,fe.push(K),F=L.dense?[]:{},ue={s:{r:0,c:0},e:{r:0,c:0}},xe=Re[3],K="Sheet"+(xe+1)),$e>0&&Re[0].r>=$e)break;L.dense?(F[Re[0].r]||(F[Re[0].r]=[]),F[Re[0].r][Re[0].c]=Re[1]):F[dr(Re[0])]=Re[1],ue.e.c<Re[0].c&&(ue.e.c=Re[0].c),ue.e.r<Re[0].r&&(ue.e.r=Re[0].r);break;case 27:Re[14e3]&&(le[Re[14e3][0]]=Re[14e3][1]);break;case 1537:le[Re[0]]=Re[1],Re[0]==xe&&(K=Re[1]);break}},L);else throw new Error("Unrecognized LOTUS BOF "+N[2]);if(F["!ref"]=ln(ue),ee[ce||K]=F,fe.push(ce||K),!le.length)return{SheetNames:fe,Sheets:ee};for(var ye={},Q=[],nt=0;nt<le.length;++nt)ee[fe[nt]]?(Q.push(le[nt]||fe[nt]),ye[le[nt]]=ee[le[nt]]||ee[fe[nt]]):(Q.push(le[nt]),ye[le[nt]]={"!ref":"A1"});return{SheetNames:Q,Sheets:ye}}function n(N,D){var L=D||{};if(+L.codepage>=0&&If(+L.codepage),L.type=="string")throw new Error("Cannot write WK1 to JS string");var F=Sa(),K=kr(N["!ref"]),ce=Array.isArray(N),xe=[];et(F,0,i(1030)),et(F,6,l(K));for(var ee=Math.min(K.e.r,8191),fe=K.s.r;fe<=ee;++fe)for(var le=qn(fe),ue=K.s.c;ue<=K.e.c;++ue){fe===K.s.r&&(xe[ue]=Qn(ue));var $e=xe[ue]+le,ye=ce?(N[fe]||[])[ue]:N[$e];if(!(!ye||ye.t=="z"))if(ye.t=="n")(ye.v|0)==ye.v&&ye.v>=-32768&&ye.v<=32767?et(F,13,d(fe,ue,ye.v)):et(F,14,g(fe,ue,ye.v));else{var Q=zs(ye);et(F,15,h(fe,ue,Q.slice(0,239)))}}return et(F,1),F.end()}function a(N,D){var L=D||{};if(+L.codepage>=0&&If(+L.codepage),L.type=="string")throw new Error("Cannot write WK3 to JS string");var F=Sa();et(F,0,s(N));for(var K=0,ce=0;K<N.SheetNames.length;++K)(N.Sheets[N.SheetNames[K]]||{})["!ref"]&&et(F,27,ge(N.SheetNames[K],ce++));var xe=0;for(K=0;K<N.SheetNames.length;++K){var ee=N.Sheets[N.SheetNames[K]];if(!(!ee||!ee["!ref"])){for(var fe=kr(ee["!ref"]),le=Array.isArray(ee),ue=[],$e=Math.min(fe.e.r,8191),ye=fe.s.r;ye<=$e;++ye)for(var Q=qn(ye),nt=fe.s.c;nt<=fe.e.c;++nt){ye===fe.s.r&&(ue[nt]=Qn(nt));var Re=ue[nt]+Q,ot=le?(ee[ye]||[])[nt]:ee[Re];if(!(!ot||ot.t=="z"))if(ot.t=="n")et(F,23,W(ye,nt,xe,ot.v));else{var ze=zs(ot);et(F,22,O(ye,nt,xe,ze.slice(0,239)))}}++xe}}return et(F,1),F.end()}function i(N){var D=De(2);return D.write_shift(2,N),D}function s(N){var D=De(26);D.write_shift(2,4096),D.write_shift(2,4),D.write_shift(4,0);for(var L=0,F=0,K=0,ce=0;ce<N.SheetNames.length;++ce){var xe=N.SheetNames[ce],ee=N.Sheets[xe];if(!(!ee||!ee["!ref"])){++K;var fe=Za(ee["!ref"]);L<fe.e.r&&(L=fe.e.r),F<fe.e.c&&(F=fe.e.c)}}return L>8191&&(L=8191),D.write_shift(2,L),D.write_shift(1,K),D.write_shift(1,F),D.write_shift(2,0),D.write_shift(2,0),D.write_shift(1,1),D.write_shift(1,2),D.write_shift(4,0),D.write_shift(4,0),D}function o(N,D,L){var F={s:{c:0,r:0},e:{c:0,r:0}};return D==8&&L.qpro?(F.s.c=N.read_shift(1),N.l++,F.s.r=N.read_shift(2),F.e.c=N.read_shift(1),N.l++,F.e.r=N.read_shift(2),F):(F.s.c=N.read_shift(2),F.s.r=N.read_shift(2),D==12&&L.qpro&&(N.l+=2),F.e.c=N.read_shift(2),F.e.r=N.read_shift(2),D==12&&L.qpro&&(N.l+=2),F.s.c==65535&&(F.s.c=F.e.c=F.s.r=F.e.r=0),F)}function l(N){var D=De(8);return D.write_shift(2,N.s.c),D.write_shift(2,N.s.r),D.write_shift(2,N.e.c),D.write_shift(2,N.e.r),D}function c(N,D,L){var F=[{c:0,r:0},{t:"n",v:0},0,0];return L.qpro&&L.vers!=20768?(F[0].c=N.read_shift(1),F[3]=N.read_shift(1),F[0].r=N.read_shift(2),N.l+=2):(F[2]=N.read_shift(1),F[0].c=N.read_shift(2),F[0].r=N.read_shift(2)),F}function f(N,D,L){var F=N.l+D,K=c(N,D,L);if(K[1].t="s",L.vers==20768){N.l++;var ce=N.read_shift(1);return K[1].v=N.read_shift(ce,"utf8"),K}return L.qpro&&N.l++,K[1].v=N.read_shift(F-N.l,"cstr"),K}function h(N,D,L){var F=De(7+L.length);F.write_shift(1,255),F.write_shift(2,D),F.write_shift(2,N),F.write_shift(1,39);for(var K=0;K<F.length;++K){var ce=L.charCodeAt(K);F.write_shift(1,ce>=128?95:ce)}return F.write_shift(1,0),F}function p(N,D,L){var F=c(N,D,L);return F[1].v=N.read_shift(2,"i"),F}function d(N,D,L){var F=De(7);return F.write_shift(1,255),F.write_shift(2,D),F.write_shift(2,N),F.write_shift(2,L,"i"),F}function x(N,D,L){var F=c(N,D,L);return F[1].v=N.read_shift(8,"f"),F}function g(N,D,L){var F=De(13);return F.write_shift(1,255),F.write_shift(2,D),F.write_shift(2,N),F.write_shift(8,L,"f"),F}function y(N,D,L){var F=N.l+D,K=c(N,D,L);if(K[1].v=N.read_shift(8,"f"),L.qpro)N.l=F;else{var ce=N.read_shift(2);k(N.slice(N.l,N.l+ce),K),N.l+=ce}return K}function b(N,D,L){var F=D&32768;return D&=-32769,D=(F?N:0)+(D>=8192?D-16384:D),(F?"":"$")+(L?Qn(D):qn(D))}var T={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},S=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function k(N,D){Ua(N,0);for(var L=[],F=0,K="",ce="",xe="",ee="";N.l<N.length;){var fe=N[N.l++];switch(fe){case 0:L.push(N.read_shift(8,"f"));break;case 1:ce=b(D[0].c,N.read_shift(2),!0),K=b(D[0].r,N.read_shift(2),!1),L.push(ce+K);break;case 2:{var le=b(D[0].c,N.read_shift(2),!0),ue=b(D[0].r,N.read_shift(2),!1);ce=b(D[0].c,N.read_shift(2),!0),K=b(D[0].r,N.read_shift(2),!1),L.push(le+ue+":"+ce+K)}break;case 3:if(N.l<N.length){console.error("WK1 premature formula end");return}break;case 4:L.push("("+L.pop()+")");break;case 5:L.push(N.read_shift(2));break;case 6:{for(var $e="";fe=N[N.l++];)$e+=String.fromCharCode(fe);L.push('"'+$e.replace(/"/g,'""')+'"')}break;case 8:L.push("-"+L.pop());break;case 23:L.push("+"+L.pop());break;case 22:L.push("NOT("+L.pop()+")");break;case 20:case 21:ee=L.pop(),xe=L.pop(),L.push(["AND","OR"][fe-20]+"("+xe+","+ee+")");break;default:if(fe<32&&S[fe])ee=L.pop(),xe=L.pop(),L.push(xe+S[fe]+ee);else if(T[fe]){if(F=T[fe][1],F==69&&(F=N[N.l++]),F>L.length){console.error("WK1 bad formula parse 0x"+fe.toString(16)+":|"+L.join("|")+"|");return}var ye=L.slice(-F);L.length-=F,L.push(T[fe][0]+"("+ye.join(",")+")")}else return fe<=7?console.error("WK1 invalid opcode "+fe.toString(16)):fe<=24?console.error("WK1 unsupported op "+fe.toString(16)):fe<=30?console.error("WK1 invalid opcode "+fe.toString(16)):fe<=115?console.error("WK1 unsupported function opcode "+fe.toString(16)):console.error("WK1 unrecognized opcode "+fe.toString(16))}}L.length==1?D[1].f=""+L[0]:console.error("WK1 bad formula parse |"+L.join("|")+"|")}function A(N){var D=[{c:0,r:0},{t:"n",v:0},0];return D[0].r=N.read_shift(2),D[3]=N[N.l++],D[0].c=N[N.l++],D}function M(N,D){var L=A(N);return L[1].t="s",L[1].v=N.read_shift(D-4,"cstr"),L}function O(N,D,L,F){var K=De(6+F.length);K.write_shift(2,N),K.write_shift(1,L),K.write_shift(1,D),K.write_shift(1,39);for(var ce=0;ce<F.length;++ce){var xe=F.charCodeAt(ce);K.write_shift(1,xe>=128?95:xe)}return K.write_shift(1,0),K}function I(N,D){var L=A(N);L[1].v=N.read_shift(2);var F=L[1].v>>1;if(L[1].v&1)switch(F&7){case 0:F=(F>>3)*5e3;break;case 1:F=(F>>3)*500;break;case 2:F=(F>>3)/20;break;case 3:F=(F>>3)/200;break;case 4:F=(F>>3)/2e3;break;case 5:F=(F>>3)/2e4;break;case 6:F=(F>>3)/16;break;case 7:F=(F>>3)/64;break}return L[1].v=F,L}function j(N,D){var L=A(N),F=N.read_shift(4),K=N.read_shift(4),ce=N.read_shift(2);if(ce==65535)return F===0&&K===3221225472?(L[1].t="e",L[1].v=15):F===0&&K===3489660928?(L[1].t="e",L[1].v=42):L[1].v=0,L;var xe=ce&32768;return ce=(ce&32767)-16446,L[1].v=(1-xe*2)*(K*Math.pow(2,ce+32)+F*Math.pow(2,ce)),L}function W(N,D,L,F){var K=De(14);if(K.write_shift(2,N),K.write_shift(1,L),K.write_shift(1,D),F==0)return K.write_shift(4,0),K.write_shift(4,0),K.write_shift(2,65535),K;var ce=0,xe=0,ee=0,fe=0;return F<0&&(ce=1,F=-F),xe=Math.log2(F)|0,F/=Math.pow(2,xe-31),fe=F>>>0,fe&2147483648||(F/=2,++xe,fe=F>>>0),F-=fe,fe|=2147483648,fe>>>=0,F*=Math.pow(2,32),ee=F>>>0,K.write_shift(4,ee),K.write_shift(4,fe),xe+=16383+(ce?32768:0),K.write_shift(2,xe),K}function E(N,D){var L=j(N);return N.l+=D-14,L}function C(N,D){var L=A(N),F=N.read_shift(4);return L[1].v=F>>6,L}function G(N,D){var L=A(N),F=N.read_shift(8,"f");return L[1].v=F,L}function Z(N,D){var L=G(N);return N.l+=D-10,L}function he(N,D){return N[N.l+D-1]==0?N.read_shift(D,"cstr"):""}function oe(N,D){var L=N[N.l++];L>D-1&&(L=D-1);for(var F="";F.length<L;)F+=String.fromCharCode(N[N.l++]);return F}function me(N,D,L){if(!(!L.qpro||D<21)){var F=N.read_shift(1);N.l+=17,N.l+=1,N.l+=2;var K=N.read_shift(D-21,"cstr");return[F,K]}}function pe(N,D){for(var L={},F=N.l+D;N.l<F;){var K=N.read_shift(2);if(K==14e3){for(L[K]=[0,""],L[K][0]=N.read_shift(2);N[N.l];)L[K][1]+=String.fromCharCode(N[N.l]),N.l++;N.l++}}return L}function ge(N,D){var L=De(5+N.length);L.write_shift(2,14e3),L.write_shift(2,D);for(var F=0;F<N.length;++F){var K=N.charCodeAt(F);L[L.l++]=K>127?95:K}return L[L.l++]=0,L}var Le={0:{n:"BOF",f:jA},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:x},15:{n:"LABEL",f},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:he},222:{n:"SHEETNAMELP",f:oe},65535:{n:""}},Se={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:M},23:{n:"NUMBER17",f:j},24:{n:"NUMBER18",f:I},25:{n:"FORMULA19",f:E},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:pe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:C},38:{n:"??"},39:{n:"NUMBER27",f:G},40:{n:"FORMULA28",f:Z},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:he},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:me},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}(),Sz=/^\s|\s$|[\t\n\r]/;function FA(e,t){if(!t.bookSST)return"";var r=[cn];r[r.length]=Je("sst",null,{xmlns:uu[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(Sz)&&(i+=' xml:space="preserve"'),i+=">"+hr(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function Az(e){return[e.read_shift(4),e.read_shift(4)]}function Ez(e,t){return t||(t=De(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var Tz=x$;function jz(e){var t=Sa();qe(t,159,Ez(e));for(var r=0;r<e.length;++r)qe(t,19,Tz(e[r]));return qe(t,160),t.end()}function Pz(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function DA(e){var t=0,r,n=Pz(e),a=n.length+1,i,s,o,l,c;for(r=kl(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)s=r[i],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^s;return t^52811}var kz=function(){function e(a,i){switch(i.type){case"base64":return t($s(a),i);case"binary":return t(a,i);case"buffer":return t(ar&&Buffer.isBuffer(a)?a.toString("binary"):h0(a),i);case"array":return t(Op(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var s=i||{},o=s.dense?[]:{},l=a.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,h){Array.isArray(o)&&(o[h]=[]);for(var p=/\\\w+\b/g,d=0,x,g=-1;x=p.exec(f);){switch(x[0]){case"\\cell":var y=f.slice(d,p.lastIndex-x[0].length);if(y[0]==" "&&(y=y.slice(1)),++g,y.length){var b={v:y,t:"s"};Array.isArray(o)?o[h][g]=b:o[dr({r:h,c:g})]=b}break}d=p.lastIndex}g>c.e.c&&(c.e.c=g)}),o["!ref"]=ln(c),o}function r(a,i){return Ul(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],s=kr(a["!ref"]),o,l=Array.isArray(a),c=s.s.r;c<=s.e.r;++c){i.push("\\trowd\\trautofit1");for(var f=s.s.c;f<=s.e.c;++f)i.push("\\cellx"+(f+1));for(i.push("\\pard\\intbl"),f=s.s.c;f<=s.e.c;++f){var h=dr({r:c,c:f});o=l?(a[c]||[])[f]:a[h],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(zs(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function xw(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var Cz=6,Fs=Cz;function Nd(e){return Math.floor((e+Math.round(128/Fs)/256)*Fs)}function Sd(e){return Math.floor((e-5)/Fs*100+.5)/100}function Eg(e){return Math.round((e*Fs+5)/Fs*256)/256}function Yv(e){e.width?(e.wpx=Nd(e.width),e.wch=Sd(e.wpx),e.MDW=Fs):e.wpx?(e.wch=Sd(e.wpx),e.width=Eg(e.wch),e.MDW=Fs):typeof e.wch=="number"&&(e.width=Eg(e.wch),e.wpx=Nd(e.width),e.MDW=Fs),e.customWidth&&delete e.customWidth}var Oz=96,IA=Oz;function Ad(e){return e*96/IA}function MA(e){return e*IA/96}function Lz(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Je("numFmt",null,{numFmtId:n,formatCode:hr(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Je("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function Fz(e){var t=[];return t[t.length]=Je("cellXfs",null),e.forEach(function(r){t[t.length]=Je("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Je("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function RA(e,t){var r=[cn,Je("styleSheet",null,{xmlns:uu[0],"xmlns:vt":An.vt})],n;return e.SSF&&(n=Lz(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Fz(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Dz(e,t){var r=e.read_shift(2),n=ea(e);return[r,n]}function Iz(e,t,r){r||(r=De(6+4*t.length)),r.write_shift(2,e),Tn(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function Mz(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=S$(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=N$(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=ea(e),n}function Rz(e,t){t||(t=De(25+4*32)),t.write_shift(2,e.sz*20),A$(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),wd(e.color,t);var n=0;return e.scheme=="major"&&(n=1),e.scheme=="minor"&&(n=2),t.write_shift(1,n),Tn(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Bz=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Qm,Uz=os;function vw(e,t){t||(t=De(4*3+8*7+16*1)),Qm||(Qm=Mv(Bz));var r=Qm[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(wd({auto:1},t),wd({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function $z(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function BA(e,t,r){r||(r=De(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Ju(e,t){return t||(t=De(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var zz=os;function qz(e,t){return t||(t=De(51)),t.write_shift(1,0),Ju(null,t),Ju(null,t),Ju(null,t),Ju(null,t),Ju(null,t),t.length>t.l?t.slice(0,t.l):t}function Wz(e,t){return t||(t=De(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),bd(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function Hz(e,t,r){var n=De(2052);return n.write_shift(4,e),bd(t,n),bd(r,n),n.length>n.l?n.slice(0,n.l):n}function Gz(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(qe(e,615,Li(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&qe(e,44,Iz(a,t[a]))}),qe(e,616))}}function Vz(e){var t=1;qe(e,611,Li(t)),qe(e,43,Rz({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),qe(e,612)}function Kz(e){var t=2;qe(e,603,Li(t)),qe(e,45,vw({patternType:"none"})),qe(e,45,vw({patternType:"gray125"})),qe(e,604)}function Yz(e){var t=1;qe(e,613,Li(t)),qe(e,46,qz()),qe(e,614)}function Xz(e){var t=1;qe(e,626,Li(t)),qe(e,47,BA({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),qe(e,627)}function Zz(e,t){qe(e,617,Li(t.length)),t.forEach(function(r){qe(e,47,BA(r,0))}),qe(e,618)}function Jz(e){var t=1;qe(e,619,Li(t)),qe(e,48,Wz({xfId:0,builtinId:0,name:"Normal"})),qe(e,620)}function Qz(e){var t=0;qe(e,505,Li(t)),qe(e,506)}function eq(e){var t=0;qe(e,508,Hz(t,"TableStyleMedium9","PivotStyleMedium4")),qe(e,509)}function tq(e,t){var r=Sa();return qe(r,278),Gz(r,e.SSF),Vz(r),Kz(r),Yz(r),Xz(r),Zz(r,t.cellXfs),Jz(r),Qz(r),eq(r),qe(r,279),r.end()}function UA(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[cn];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="Ôº≠Ôº≥ Ôº∞„Ç¥„Ç∑„ÉÉ„ÇØ"/>',r[r.length]='<a:font script="Hang" typeface="ÎßëÏùÄ Í≥†Îîï"/>',r[r.length]='<a:font script="Hans" typeface="ÂÆã‰Ωì"/>',r[r.length]='<a:font script="Hant" typeface="Êñ∞Á¥∞ÊòéÈ´î"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="Ôº≠Ôº≥ Ôº∞„Ç¥„Ç∑„ÉÉ„ÇØ"/>',r[r.length]='<a:font script="Hang" typeface="ÎßëÏùÄ Í≥†Îîï"/>',r[r.length]='<a:font script="Hans" typeface="ÂÆã‰Ωì"/>',r[r.length]='<a:font script="Hant" typeface="Êñ∞Á¥∞ÊòéÈ´î"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function rq(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:ea(e)}}function nq(e){var t=De(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Tn(e.name,t),t.slice(0,t.l)}function aq(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function iq(e){var t=De(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function sq(e,t){var r=De(8+2*t.length);return r.write_shift(4,e),Tn(t,r),r.slice(0,r.l)}function oq(e){return e.l+=4,e.read_shift(4)!=0}function lq(e,t){var r=De(8);return r.write_shift(4,e),r.write_shift(4,1),r}function cq(){var e=Sa();return qe(e,332),qe(e,334,Li(1)),qe(e,335,nq({name:"XLDAPR",version:12e4,flags:3496657072})),qe(e,336),qe(e,339,sq(1,"XLDAPR")),qe(e,52),qe(e,35,Li(514)),qe(e,4096,Li(0)),qe(e,4097,oi(1)),qe(e,36),qe(e,53),qe(e,340),qe(e,337,lq(1)),qe(e,51,iq([[1,0]])),qe(e,338),qe(e,333),e.end()}function $A(){var e=[cn];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function uq(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=dr(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var wc=1024;function zA(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Je("xml",null,{"xmlns:v":$a.v,"xmlns:o":$a.o,"xmlns:x":$a.x,"xmlns:mv":$a.mv}).replace(/\/>/,">"),Je("o:shapelayout",Je("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Je("v:shapetype",[Je("v:stroke",null,{joinstyle:"miter"}),Je("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];wc<e*1e3;)wc+=1e3;return t.forEach(function(i){var s=En(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?Je("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=Je("v:fill",l,o),f={on:"t",obscured:"t"};++wc,a=a.concat(["<v:shape"+Uf({id:"_x0000_s"+wc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,Je("v:shadow",null,f),Je("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",zn("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),zn("x:AutoFill","False"),zn("x:Row",String(s.r)),zn("x:Column",String(s.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function qA(e){var t=[cn,Je("comments",null,{xmlns:uu[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var i=hr(a.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(a=r.indexOf(hr(l.a))),i.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),i.length<=1)t.push(zn("t",hr(i[0]||"")));else{for(var s=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)s+=`Reply:
    `+i[o]+`
`;t.push(zn("t",hr(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function fq(e,t,r){var n=[cn,Je("ThreadedComments",null,{xmlns:An.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var i="";(a[1]||[]).forEach(function(s,o){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var l={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?i=l.id:l.parentId=i,s.ID=l.id,s.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(Je("threadedComment",zn("text",s.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function hq(e){var t=[cn,Je("personList",null,{xmlns:An.TCMNT,"xmlns:x":uu[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Je("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function dq(e){var t={};t.iauthor=e.read_shift(4);var r=Wl(e);return t.rfx=r.s,t.ref=dr(r.s),e.l+=16,t}function pq(e,t){return t==null&&(t=De(36)),t.write_shift(4,e[1].iauthor),hu(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var mq=ea;function gq(e){return Tn(e.slice(0,54))}function xq(e){var t=Sa(),r=[];return qe(t,628),qe(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),qe(t,632,gq(a.a)))})}),qe(t,631),qe(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var i={s:En(n[0]),e:En(n[0])};qe(t,635,pq([i,a])),a.t&&a.t.length>0&&qe(t,637,y$(a)),qe(t,636),delete a.iauthor})}),qe(t,634),qe(t,629),t.end()}function vq(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&gr.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var WA=["xlsb","xlsm","xlam","biff8","xla"],yq=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,s){var o=!1,l=!1;i.length==0?l=!0:i.charAt(0)=="["&&(l=!0,i=i.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var c=i.length>0?parseInt(i,10)|0:0,f=s.length>0?parseInt(s,10)|0:0;return o?f+=t.c:--f,l?c+=t.r:--c,a+(o?"":"$")+Qn(f)+(l?"":"$")+qn(c)}return function(a,i){return t=i,a.replace(e,r)}}(),Xv=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Zv=function(){return function(t,r){return t.replace(Xv,function(n,a,i,s,o,l){var c=Wv(s)-(i?0:r.c),f=qv(l)-(o?0:r.r),h=f==0?"":o?f+1:"["+f+"]",p=c==0?"":i?c+1:"["+c+"]";return a+"R"+h+"C"+p})}}();function bq(e,t){return e.replace(Xv,function(r,n,a,i,s,o){return n+(a=="$"?a+i:Qn(Wv(i)+t.c))+(s=="$"?s+o:qn(qv(o)+t.r))})}function wq(e){return e.length!=1}function an(e){e.l+=1}function Co(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function HA(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return GA(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),s=Co(e),o=Co(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function GA(e){var t=Co(e),r=Co(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function _q(e,t,r){if(r.biff<8)return GA(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=Co(e),s=Co(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function VA(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return Nq(e);var n=e.read_shift(r&&r.biff==12?4:2),a=Co(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function Nq(e){var t=Co(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function Sq(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function Aq(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return Eq(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:o}}function Eq(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function Tq(e,t,r){var n=(e[e.l++]&96)>>5,a=HA(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function jq(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=HA(e,i,r);return[n,a,s]}function Pq(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function kq(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function Cq(e,t,r){var n=(e[e.l++]&96)>>5,a=_q(e,t-1,r);return[n,a]}function Oq(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function yw(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function Lq(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function Fq(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Dq(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Iq(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Mq(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function KA(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Rq(e){return e.read_shift(2),KA(e)}function Bq(e){return e.read_shift(2),KA(e)}function Uq(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=VA(e,0,r);return[n,a]}function $q(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=Aq(e,0,r);return[n,a]}function zq(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=VA(e,0,r);return[n,a,i]}function qq(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[qW[a],ZA[a],n]}function Wq(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Hq(e);return[a,(i[0]===0?ZA:zW)[i[1]]]}function Hq(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Gq(e,t,r){e.l+=r&&r.biff==2?3:4}function Vq(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Kq(e){return e.l++,m0[e.read_shift(1)]}function Yq(e){return e.l++,e.read_shift(2)}function Xq(e){return e.l++,e.read_shift(1)!==0}function Zq(e){return e.l++,du(e)}function Jq(e,t,r){return e.l++,kA(e,t-1,r)}function Qq(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=z$(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=m0[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=du(e);break;case 2:r[1]=G$(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function eW(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?Wl:Y$)(e));return a}function tW(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var o=0;o!=a;++o)s[i][o]=Qq(e,r.biff);return s}function rW(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function nW(e,t,r){if(r.biff==5)return aW(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function aW(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function iW(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function sW(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function oW(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function lW(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var cW=os,uW=os,fW=os;function g0(e,t,r){return e.l+=2,[Sq(e)]}function Jv(e){return e.l+=6,[]}var hW=g0,dW=Jv,pW=Jv,mW=g0;function YA(e){return e.l+=2,[jA(e),e.read_shift(2)&1]}var gW=g0,xW=YA,vW=Jv,yW=g0,bW=g0,wW=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function _W(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),s=wW[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:a,C:i}}function NW(e){return e.l+=2,[e.read_shift(4)]}function SW(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function AW(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function EW(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function TW(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function jW(e){return e.l+=4,[0,0]}var bw={1:{n:"PtgExp",f:Vq},2:{n:"PtgTbl",f:fW},3:{n:"PtgAdd",f:an},4:{n:"PtgSub",f:an},5:{n:"PtgMul",f:an},6:{n:"PtgDiv",f:an},7:{n:"PtgPower",f:an},8:{n:"PtgConcat",f:an},9:{n:"PtgLt",f:an},10:{n:"PtgLe",f:an},11:{n:"PtgEq",f:an},12:{n:"PtgGe",f:an},13:{n:"PtgGt",f:an},14:{n:"PtgNe",f:an},15:{n:"PtgIsect",f:an},16:{n:"PtgUnion",f:an},17:{n:"PtgRange",f:an},18:{n:"PtgUplus",f:an},19:{n:"PtgUminus",f:an},20:{n:"PtgPercent",f:an},21:{n:"PtgParen",f:an},22:{n:"PtgMissArg",f:an},23:{n:"PtgStr",f:Jq},26:{n:"PtgSheet",f:SW},27:{n:"PtgEndSheet",f:AW},28:{n:"PtgErr",f:Kq},29:{n:"PtgBool",f:Xq},30:{n:"PtgInt",f:Yq},31:{n:"PtgNum",f:Zq},32:{n:"PtgArray",f:Oq},33:{n:"PtgFunc",f:qq},34:{n:"PtgFuncVar",f:Wq},35:{n:"PtgName",f:rW},36:{n:"PtgRef",f:Uq},37:{n:"PtgArea",f:Tq},38:{n:"PtgMemArea",f:iW},39:{n:"PtgMemErr",f:cW},40:{n:"PtgMemNoMem",f:uW},41:{n:"PtgMemFunc",f:sW},42:{n:"PtgRefErr",f:oW},43:{n:"PtgAreaErr",f:Pq},44:{n:"PtgRefN",f:$q},45:{n:"PtgAreaN",f:Cq},46:{n:"PtgMemAreaN",f:EW},47:{n:"PtgMemNoMemN",f:TW},57:{n:"PtgNameX",f:nW},58:{n:"PtgRef3d",f:zq},59:{n:"PtgArea3d",f:jq},60:{n:"PtgRefErr3d",f:lW},61:{n:"PtgAreaErr3d",f:kq},255:{}},PW={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},kW={1:{n:"PtgElfLel",f:YA},2:{n:"PtgElfRw",f:yW},3:{n:"PtgElfCol",f:hW},6:{n:"PtgElfRwV",f:bW},7:{n:"PtgElfColV",f:mW},10:{n:"PtgElfRadical",f:gW},11:{n:"PtgElfRadicalS",f:vW},13:{n:"PtgElfColS",f:dW},15:{n:"PtgElfColSV",f:pW},16:{n:"PtgElfRadicalLel",f:xW},25:{n:"PtgList",f:_W},29:{n:"PtgSxName",f:NW},255:{}},CW={0:{n:"PtgAttrNoop",f:jW},1:{n:"PtgAttrSemi",f:Mq},2:{n:"PtgAttrIf",f:Dq},4:{n:"PtgAttrChoose",f:Lq},8:{n:"PtgAttrGoto",f:Fq},16:{n:"PtgAttrSum",f:Gq},32:{n:"PtgAttrBaxcel",f:yw},33:{n:"PtgAttrBaxcel",f:yw},64:{n:"PtgAttrSpace",f:Rq},65:{n:"PtgAttrSpaceSemi",f:Bq},128:{n:"PtgAttrIfError",f:Iq},255:{}};function OW(e,t,r,n){if(n.biff<8)return os(e,t);for(var a=e.l+t,i=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=tW(e,0,n),i.push(r[s][1]);break;case"PtgMemArea":r[s][2]=eW(e,r[s][1],n),i.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),i.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=a-e.l,t!==0&&i.push(os(e,t)),i}function LW(e,t,r){for(var n=e.l+t,a,i,s=[];n!=e.l;)t=n-e.l,i=e[e.l],a=bw[i]||bw[PW[i]],(i===24||i===25)&&(a=(i===24?kW:CW)[e[e.l+1]]),!a||!a.f?os(e,t):s.push([a.n,a.f(e,t,r)]);return s}function FW(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var s=n[i];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var DW={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function IW(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function XA(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function ww(e,t,r){var n=XA(e,t,r);return n=="#REF"?n:IW(n,r)}function Yc(e,t,r,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,c,f,h=0,p=0,d,x="";if(!e[0]||!e[0][0])return"";for(var g=-1,y="",b=0,T=e[0].length;b<T;++b){var S=e[0][b];switch(S[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),g>=0){switch(e[0][g][1][0]){case 0:y=zr(" ",e[0][g][1][1]);break;case 1:y=zr("\r",e[0][g][1][1]);break;default:if(y="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}c=c+y,g=-1}o.push(c+DW[S[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=gf(S[1][1],s,a),o.push(xf(f,i));break;case"PtgRefN":f=r?gf(S[1][1],r,a):S[1][1],o.push(xf(f,i));break;case"PtgRef3d":h=S[1][1],f=gf(S[1][2],s,a),x=ww(n,h,a),o.push(x+"!"+xf(f,i));break;case"PtgFunc":case"PtgFuncVar":var k=S[1][0],A=S[1][1];k||(k=0),k&=127;var M=k==0?[]:o.slice(-k);o.length-=k,A==="User"&&(A=M.shift()),o.push(A+"("+M.join(",")+")");break;case"PtgBool":o.push(S[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(S[1]);break;case"PtgNum":o.push(String(S[1]));break;case"PtgStr":o.push('"'+S[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(S[1]);break;case"PtgAreaN":d=iw(S[1][1],r?{s:r}:s,a),o.push(Zm(d,a));break;case"PtgArea":d=iw(S[1][1],s,a),o.push(Zm(d,a));break;case"PtgArea3d":h=S[1][1],d=S[1][2],x=ww(n,h,a),o.push(x+"!"+Zm(d,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=S[1][2];var O=(n.names||[])[p-1]||(n[0]||[])[p],I=O?O.Name:"SH33TJSNAME"+String(p);I&&I.slice(0,6)=="_xlfn."&&!a.xlfn&&(I=I.slice(6)),o.push(I);break;case"PtgNameX":var j=S[1][1];p=S[1][2];var W;if(a.biff<=5)j<0&&(j=-j),n[j]&&(W=n[j][p]);else{var E="";if(((n[j]||[])[0]||[])[0]==14849||(((n[j]||[])[0]||[])[0]==1025?n[j][p]&&n[j][p].itab>0&&(E=n.SheetNames[n[j][p].itab-1]+"!"):E=n.SheetNames[p-1]+"!"),n[j]&&n[j][p])E+=n[j][p].Name;else if(n[0]&&n[0][p])E+=n[0][p].Name;else{var C=(XA(n,j,a)||"").split(";;");C[p-1]?E=C[p-1]:E+="SH33TJSERRX"}o.push(E);break}W||(W={Name:"SH33TJSERRY"}),o.push(W.Name);break;case"PtgParen":var G="(",Z=")";if(g>=0){switch(y="",e[0][g][1][0]){case 2:G=zr(" ",e[0][g][1][1])+G;break;case 3:G=zr("\r",e[0][g][1][1])+G;break;case 4:Z=zr(" ",e[0][g][1][1])+Z;break;case 5:Z=zr("\r",e[0][g][1][1])+Z;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}o.push(G+o.pop()+Z);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:S[1][1],r:S[1][0]};var he={c:r.c,r:r.r};if(n.sharedf[dr(f)]){var oe=n.sharedf[dr(f)];o.push(Yc(oe,s,he,n,a))}else{var me=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(f.c<c[0].s.c||f.c>c[0].e.c)&&!(f.r<c[0].s.r||f.r>c[0].e.r)){o.push(Yc(c[1],s,he,n,a)),me=!0;break}me||o.push(S[1])}break;case"PtgArray":o.push("{"+FW(S[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+S[1].idx+"[#"+S[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(S));default:throw new Error("Unrecognized Formula Token: "+String(S))}var pe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&g>=0&&pe.indexOf(e[0][b][0])==-1){S=e[0][g];var ge=!0;switch(S[1][0]){case 4:ge=!1;case 0:y=zr(" ",S[1][1]);break;case 5:ge=!1;case 1:y=zr("\r",S[1][1]);break;default:if(y="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+S[1][0])}o.push((ge?y:"")+o.pop()+(ge?"":y)),g=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function MW(e){if(e==null){var t=De(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Cl(e);return Cl(0)}function RW(e,t,r,n,a){var i=Ol(t,r,a),s=MW(e.v),o=De(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=De(e.bf.length),f=0;f<e.bf.length;++f)c[f]=e.bf[f];var h=$n([i,s,o,c]);return h}function Lp(e,t,r){var n=e.read_shift(4),a=LW(e,n,r),i=e.read_shift(4),s=i>0?OW(e,i,a,r):null;return[a,s]}var BW=Lp,Fp=Lp,UW=Lp,$W=Lp,zW={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ZA={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},qW={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function WW(e){var t="of:="+e.replace(Xv,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function HW(e){return e.replace(/\./,"!")}var vf=typeof Map<"u";function Qv(e,t,r){var n=0,a=e.length;if(r){if(vf?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=vf?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(vf?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function Dp(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Fs=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Sd(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=Eg(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function JA(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Uo(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,i=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){V6(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=i;++a)if(e[a].numFmtId===n)return a;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function GW(e,t,r){if(e&&e["!ref"]){var n=kr(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function VW(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+ln(e[r])+'"/>';return t+"</mergeCells>"}function KW(e,t,r,n,a){var i=!1,s={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}i=!0,s.codeName=Bf(hr(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+Je("outlinePr",null,c)}!i&&!o||(a[a.length]=Je("sheetPr",o,s))}var YW=["objects","scenarios","selectLockedCells","selectUnlockedCells"],XW=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function ZW(e){var t={sheet:1};return YW.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),XW.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=DA(e.password).toString(16).toUpperCase()),Je("sheetProtection",null,t)}function JW(e){return JA(e),Je("pageMargins",null,e)}function QW(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=Je("col",null,Dp(a,n)));return r[r.length]="</cols>",r.join("")}function eH(e,t,r,n){var a=typeof e.ref=="string"?e.ref:ln(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,s=Za(a);s.s.r==s.e.r&&(s.e.r=Za(t["!ref"]).e.r,a=ln(s));for(var o=0;o<i.length;++o){var l=i[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Je("autoFilter",null,{ref:a})}function tH(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Je("sheetViews",Je("sheetView",null,a),{})}function rH(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",i=e.t,s=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=m0[e.v];break;case"d":n&&n.cellDates?a=fa(e.v,-1).toISOString():(e=Ea(e),e.t="n",a=""+(e.v=Aa(fa(e.v)))),typeof e.z>"u"&&(e.z=qr[14]);break;default:a=e.v;break}var o=zn("v",hr(a)),l={r:t},c=Uo(n.cellXfs,e,n);switch(c!==0&&(l.s=c),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=zn("v",""+Qv(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=i&&(e.t=i,e.v=s),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Je("f",hr(e.f),f)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),Je("c",o,l)}function nH(e,t,r,n){var a=[],i=[],s=kr(e["!ref"]),o="",l,c="",f=[],h=0,p=0,d=e["!rows"],x=Array.isArray(e),g={r:c},y,b=-1;for(p=s.s.c;p<=s.e.c;++p)f[p]=Qn(p);for(h=s.s.r;h<=s.e.r;++h){for(i=[],c=qn(h),p=s.s.c;p<=s.e.c;++p){l=f[p]+c;var T=x?(e[h]||[])[p]:e[l];T!==void 0&&(o=rH(T,l,e,t))!=null&&i.push(o)}(i.length>0||d&&d[h])&&(g={r:c},d&&d[h]&&(y=d[h],y.hidden&&(g.hidden=1),b=-1,y.hpx?b=Ad(y.hpx):y.hpt&&(b=y.hpt),b>-1&&(g.ht=b,g.customHeight=1),y.level&&(g.outlineLevel=y.level)),a[a.length]=Je("row",i.join(""),g))}if(d)for(;h<d.length;++h)d&&d[h]&&(g={r:h+1},y=d[h],y.hidden&&(g.hidden=1),b=-1,y.hpx?b=Ad(y.hpx):y.hpt&&(b=y.hpt),b>-1&&(g.ht=b,g.customHeight=1),y.level&&(g.outlineLevel=y.level),a[a.length]=Je("row","",g));return a.join("")}function QA(e,t,r,n){var a=[cn,Je("worksheet",null,{xmlns:uu[0],"xmlns:r":An.r})],i=r.SheetNames[e],s=0,o="",l=r.Sheets[i];l==null&&(l={});var c=l["!ref"]||"A1",f=kr(c);if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),c=ln(f)}n||(n={}),l["!comments"]=[];var h=[];KW(l,r,e,t,a),a[a.length]=Je("dimension",null,{ref:c}),a[a.length]=tH(l,t,e,r),t.sheetFormat&&(a[a.length]=Je("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(a[a.length]=QW(l,l["!cols"])),a[s=a.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=nH(l,t),o.length>0&&(a[a.length]=o)),a.length>s+1&&(a[a.length]="</sheetData>",a[s]=a[s].replace("/>",">")),l["!protect"]&&(a[a.length]=ZW(l["!protect"])),l["!autofilter"]!=null&&(a[a.length]=eH(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(a[a.length]=VW(l["!merges"]));var p=-1,d,x=-1;return l["!links"].length>0&&(a[a.length]="<hyperlinks>",l["!links"].forEach(function(g){g[1].Target&&(d={ref:g[0]},g[1].Target.charAt(0)!="#"&&(x=cr(n,-1,hr(g[1].Target).replace(/#.*$/,""),Zt.HLINK),d["r:id"]="rId"+x),(p=g[1].Target.indexOf("#"))>-1&&(d.location=hr(g[1].Target.slice(p+1))),g[1].Tooltip&&(d.tooltip=hr(g[1].Tooltip)),a[a.length]=Je("hyperlink",null,d))}),a[a.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(a[a.length]=JW(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=zn("ignoredErrors",Je("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(x=cr(n,-1,"../drawings/drawing"+(e+1)+".xml",Zt.DRAW),a[a.length]=Je("drawing",null,{"r:id":"rId"+x}),l["!drawing"]=h),l["!comments"].length>0&&(x=cr(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Zt.VML),a[a.length]=Je("legacyDrawing",null,{"r:id":"rId"+x}),l["!legacy"]=x),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function aH(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function iH(e,t,r){var n=De(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;a.hpx?i=Ad(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var s=0;a.level&&(s|=a.level),a.hidden&&(s|=16),(a.hpx||a.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:e,c:0},f=0;f<16;++f)if(!(t.s.c>f+1<<10||t.e.c<f<<10)){for(var h=-1,p=-1,d=f<<10;d<f+1<<10;++d){c.c=d;var x=Array.isArray(r)?(r[c.r]||[])[c.c]:r[dr(c)];x&&(h<0&&(h=d),p=d)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,p))}var g=n.l;return n.l=l,n.write_shift(4,o),n.l=g,n.length>n.l?n.slice(0,n.l):n}function sH(e,t,r,n){var a=iH(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&qe(e,0,a)}var oH=Wl,lH=hu;function cH(){}function uH(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=b$(e),r}function fH(e,t,r){r==null&&(r=De(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return wd({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),pA(e,r),r.slice(0,r.l)}function hH(e){var t=xi(e);return[t]}function dH(e,t,r){return r==null&&(r=De(8)),$l(t,r)}function pH(e){var t=zl(e);return[t]}function mH(e,t,r){return r==null&&(r=De(4)),ql(t,r)}function gH(e){var t=xi(e),r=e.read_shift(1);return[t,r,"b"]}function xH(e,t,r){return r==null&&(r=De(9)),$l(t,r),r.write_shift(1,e.v?1:0),r}function vH(e){var t=zl(e),r=e.read_shift(1);return[t,r,"b"]}function yH(e,t,r){return r==null&&(r=De(5)),ql(t,r),r.write_shift(1,e.v?1:0),r}function bH(e){var t=xi(e),r=e.read_shift(1);return[t,r,"e"]}function wH(e,t,r){return r==null&&(r=De(9)),$l(t,r),r.write_shift(1,e.v),r}function _H(e){var t=zl(e),r=e.read_shift(1);return[t,r,"e"]}function NH(e,t,r){return r==null&&(r=De(8)),ql(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function SH(e){var t=xi(e),r=e.read_shift(4);return[t,r,"s"]}function AH(e,t,r){return r==null&&(r=De(12)),$l(t,r),r.write_shift(4,t.v),r}function EH(e){var t=zl(e),r=e.read_shift(4);return[t,r,"s"]}function TH(e,t,r){return r==null&&(r=De(8)),ql(t,r),r.write_shift(4,t.v),r}function jH(e){var t=xi(e),r=du(e);return[t,r,"n"]}function PH(e,t,r){return r==null&&(r=De(16)),$l(t,r),Cl(e.v,r),r}function kH(e){var t=zl(e),r=du(e);return[t,r,"n"]}function CH(e,t,r){return r==null&&(r=De(12)),ql(t,r),Cl(e.v,r),r}function OH(e){var t=xi(e),r=mA(e);return[t,r,"n"]}function LH(e,t,r){return r==null&&(r=De(12)),$l(t,r),gA(e.v,r),r}function FH(e){var t=zl(e),r=mA(e);return[t,r,"n"]}function DH(e,t,r){return r==null&&(r=De(8)),ql(t,r),gA(e.v,r),r}function IH(e){var t=xi(e),r=Hv(e);return[t,r,"is"]}function MH(e){var t=xi(e),r=ea(e);return[t,r,"str"]}function RH(e,t,r){return r==null&&(r=De(12+4*e.v.length)),$l(t,r),Tn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function BH(e){var t=zl(e),r=ea(e);return[t,r,"str"]}function UH(e,t,r){return r==null&&(r=De(8+4*e.v.length)),ql(t,r),Tn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function $H(e,t,r){var n=e.l+t,a=xi(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"b"];if(r.cellFormula){e.l+=2;var o=Fp(e,n-e.l,r);s[3]=Yc(o,null,a,r.supbooks,r)}else e.l=n;return s}function zH(e,t,r){var n=e.l+t,a=xi(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"e"];if(r.cellFormula){e.l+=2;var o=Fp(e,n-e.l,r);s[3]=Yc(o,null,a,r.supbooks,r)}else e.l=n;return s}function qH(e,t,r){var n=e.l+t,a=xi(e);a.r=r["!row"];var i=du(e),s=[a,i,"n"];if(r.cellFormula){e.l+=2;var o=Fp(e,n-e.l,r);s[3]=Yc(o,null,a,r.supbooks,r)}else e.l=n;return s}function WH(e,t,r){var n=e.l+t,a=xi(e);a.r=r["!row"];var i=ea(e),s=[a,i,"str"];if(r.cellFormula){e.l+=2;var o=Fp(e,n-e.l,r);s[3]=Yc(o,null,a,r.supbooks,r)}else e.l=n;return s}var HH=Wl,GH=hu;function VH(e,t){return t==null&&(t=De(4)),t.write_shift(4,e),t}function KH(e,t){var r=e.l+t,n=Wl(e),a=Gv(e),i=ea(e),s=ea(e),o=ea(e);e.l=r;var l={rfx:n,relId:a,loc:i,display:o};return s&&(l.Tooltip=s),l}function YH(e,t){var r=De(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));hu({s:En(e[0]),e:En(e[0])},r),Vv("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return Tn(a||"",r),Tn(e[1].Tooltip||"",r),Tn("",r),r.slice(0,r.l)}function XH(){}function ZH(e,t,r){var n=e.l+t,a=xA(e),i=e.read_shift(1),s=[a];if(s[2]=i,r.cellFormula){var o=BW(e,n-e.l,r);s[1]=o}else e.l=n;return s}function JH(e,t,r){var n=e.l+t,a=Wl(e),i=[a];if(r.cellFormula){var s=$W(e,n-e.l,r);i[1]=s,e.l=n}else e.l=n;return i}function QH(e,t,r){r==null&&(r=De(18));var n=Dp(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var eE=["left","right","top","bottom","header","footer"];function eG(e){var t={};return eE.forEach(function(r){t[r]=du(e)}),t}function tG(e,t){return t==null&&(t=De(6*8)),JA(e),eE.forEach(function(r){Cl(e[r],t)}),t}function rG(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function nG(e,t,r){r==null&&(r=De(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function aG(e){var t=De(24);return t.write_shift(4,4),t.write_shift(4,1),hu(e,t),t}function iG(e,t){return t==null&&(t=De(16*4+2)),t.write_shift(2,e.password?DA(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function sG(){}function oG(){}function lG(e,t,r,n,a,i,s){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=Ea(t),t.z=t.z||qr[14],t.v=Aa(fa(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r,c:n};switch(l.s=Uo(a.cellXfs,t,a),t.l&&i["!links"].push([dr(l),t.l]),t.c&&i["!comments"].push([dr(l),t.c]),t.t){case"s":case"str":return a.bookSST?(o=Qv(a.Strings,t.v,a.revStrings),l.t="s",l.v=o,s?qe(e,18,TH(t,l)):qe(e,7,AH(t,l))):(l.t="str",s?qe(e,17,UH(t,l)):qe(e,6,RH(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?s?qe(e,13,DH(t,l)):qe(e,2,LH(t,l)):s?qe(e,16,CH(t,l)):qe(e,5,PH(t,l)),!0;case"b":return l.t="b",s?qe(e,15,yH(t,l)):qe(e,4,xH(t,l)),!0;case"e":return l.t="e",s?qe(e,14,NH(t,l)):qe(e,3,wH(t,l)),!0}return s?qe(e,12,mH(t,l)):qe(e,1,dH(t,l)),!0}function cG(e,t,r,n){var a=kr(t["!ref"]||"A1"),i,s="",o=[];qe(e,145);var l=Array.isArray(t),c=a.e.r;t["!rows"]&&(c=Math.max(a.e.r,t["!rows"].length-1));for(var f=a.s.r;f<=c;++f){s=qn(f),sH(e,t,a,f);var h=!1;if(f<=a.e.r)for(var p=a.s.c;p<=a.e.c;++p){f===a.s.r&&(o[p]=Qn(p)),i=o[p]+s;var d=l?(t[f]||[])[p]:t[i];if(!d){h=!1;continue}h=lG(e,d,f,p,n,t,h)}}qe(e,146)}function uG(e,t){!t||!t["!merges"]||(qe(e,177,VH(t["!merges"].length)),t["!merges"].forEach(function(r){qe(e,176,GH(r))}),qe(e,178))}function fG(e,t){!t||!t["!cols"]||(qe(e,390),t["!cols"].forEach(function(r,n){r&&qe(e,60,QH(n,r))}),qe(e,391))}function hG(e,t){!t||!t["!ref"]||(qe(e,648),qe(e,649,aG(kr(t["!ref"]))),qe(e,650))}function dG(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=cr(r,-1,n[1].Target.replace(/#.*$/,""),Zt.HLINK);qe(e,494,YH(n,a))}}),delete t["!links"]}function pG(e,t,r,n){if(t["!comments"].length>0){var a=cr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Zt.VML);qe(e,551,Vv("rId"+a)),t["!legacy"]=a}}function mG(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],i=typeof a.ref=="string"?a.ref:ln(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=Za(i);o.s.r==o.e.r&&(o.e.r=Za(t["!ref"]).e.r,i=ln(o));for(var l=0;l<s.length;++l){var c=s[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+i;break}}l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),qe(e,161,hu(kr(i))),qe(e,162)}}function gG(e,t,r){qe(e,133),qe(e,137,nG(t,r)),qe(e,138),qe(e,134)}function xG(e,t){t["!protect"]&&qe(e,535,iG(t["!protect"]))}function vG(e,t,r,n){var a=Sa(),i=r.SheetNames[e],s=r.Sheets[i]||{},o=i;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var l=kr(s["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],qe(a,129),(r.vbaraw||s["!outline"])&&qe(a,147,fH(o,s["!outline"])),qe(a,148,lH(l)),gG(a,s,r.Workbook),fG(a,s),cG(a,s,e,t),xG(a,s),mG(a,s,r,e),uG(a,s),dG(a,s,n),s["!margins"]&&qe(a,476,tG(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&hG(a,s),pG(a,s,e,n),qe(a,130),a.end()}function yG(e,t){e.l+=10;var r=ea(e);return{name:r}}var bG=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function wG(e){return!e.Workbook||!e.Workbook.WBProps?"false":JU(e.Workbook.WBProps.date1904)?"true":"false"}var _G="][*?/\\".split("");function tE(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return _G.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function NG(e,t,r){e.forEach(function(n,a){tE(n);for(var i=0;i<a;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var s=t&&t[a]&&t[a].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function SG(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];NG(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)GW(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function rE(e){var t=[cn];t[t.length]=Je("workbook",null,{xmlns:uu[0],"xmlns:r":An.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(bG.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Je("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:hr(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=Je("sheet",null,s)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=Je("definedName",hr(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function AG(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=Ag(e),r.name=ea(e),r}function EG(e,t){return t||(t=De(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Vv(e.strRelID,t),Tn(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function TG(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?ea(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function jG(e,t){t||(t=De(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),pA(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function PG(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=w$(e),s=UW(e,0,r),o=Gv(e);e.l=n;var l={Name:i,Ptg:s};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}function kG(e,t){qe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};qe(e,156,EG(a))}qe(e,144)}function CG(e,t){t||(t=De(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Tn("SheetJS",t),Tn(pd.version,t),Tn(pd.version,t),Tn("7262",t),t.length>t.l?t.slice(0,t.l):t}function OG(e,t){t||(t=De(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function LG(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(qe(e,135),qe(e,158,OG(a)),qe(e,136))}}function FG(e,t){var r=Sa();return qe(r,131),qe(r,128,CG()),qe(r,153,jG(e.Workbook&&e.Workbook.WBProps||null)),LG(r,e),kG(r,e),qe(r,132),r.end()}function DG(e,t,r){return(t.slice(-4)===".bin"?FG:rE)(e)}function IG(e,t,r,n,a){return(t.slice(-4)===".bin"?vG:QA)(e,r,n,a)}function MG(e,t,r){return(t.slice(-4)===".bin"?tq:RA)(e,r)}function RG(e,t,r){return(t.slice(-4)===".bin"?jz:FA)(e,r)}function BG(e,t,r){return(t.slice(-4)===".bin"?xq:qA)(e)}function UG(e){return(e.slice(-4)===".bin"?cq:$A)()}function $G(e,t){var r=[];return e.Props&&r.push(M$(e.Props,t)),e.Custprops&&r.push(R$(e.Props,e.Custprops)),r.join("")}function zG(){return""}function qG(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var i=[];i.push(Je("NumberFormat",null,{"ss:Format":hr(qr[n.numFmtId])}));var s={"ss:ID":"s"+(21+a)};r.push(Je("Style",i.join(""),s))}),Je("Styles",r.join(""))}function nE(e){return Je("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+Zv(e.Ref,{r:0,c:0})})}function WG(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(nE(a)))}return Je("Names",r.join(""))}function HG(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],s=0;s<a.length;++s){var o=a[s];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||i.push(nE(o)))}return i.join("")}function GG(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Je("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Je("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Je("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Je("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(zn("ProtectContents","True")),e["!protect"].objects&&a.push(zn("ProtectObjects","True")),e["!protect"].scenarios&&a.push(zn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(zn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(zn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&a.push("<"+s[1]+"/>")})),a.length==0?"":Je("WorksheetOptions",a.join(""),{xmlns:$a.x})}function VG(e){return e.map(function(t){var r=ZU(t.t||""),n=Je("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Je("Comment",n,{"ss:Author":t.a})}).join("")}function KG(e,t,r,n,a,i,s){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+hr(Zv(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var l=En(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==s.r?"":"["+(l.r-s.r)+"]")+"C"+(l.c==s.c?"":"["+(l.c-s.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=hr(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=hr(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],f=0;f!=c.length;++f)c[f].s.c!=s.c||c[f].s.r!=s.r||(c[f].e.c>c[f].s.c&&(o["ss:MergeAcross"]=c[f].e.c-c[f].s.c),c[f].e.r>c[f].s.r&&(o["ss:MergeDown"]=c[f].e.r-c[f].s.r));var h="",p="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",p=String(e.v);break;case"b":h="Boolean",p=e.v?"1":"0";break;case"e":h="Error",p=m0[e.v];break;case"d":h="DateTime",p=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||qr[14]);break;case"s":h="String",p=XU(e.v||"");break}var d=Uo(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+d),o["ss:Index"]=s.c+1;var x=e.v!=null?p:"",g=e.t=="z"?"":'<Data ss:Type="'+h+'">'+x+"</Data>";return(e.c||[]).length>0&&(g+=VG(e.c)),Je("Cell",g,o)}function YG(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=MA(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function XG(e,t,r,n){if(!e["!ref"])return"";var a=kr(e["!ref"]),i=e["!merges"]||[],s=0,o=[];e["!cols"]&&e["!cols"].forEach(function(y,b){Yv(y);var T=!!y.width,S=Dp(b,y),k={"ss:Index":b+1};T&&(k["ss:Width"]=Nd(S.width)),y.hidden&&(k["ss:Hidden"]="1"),o.push(Je("Column",null,k))});for(var l=Array.isArray(e),c=a.s.r;c<=a.e.r;++c){for(var f=[YG(c,(e["!rows"]||[])[c])],h=a.s.c;h<=a.e.c;++h){var p=!1;for(s=0;s!=i.length;++s)if(!(i[s].s.c>h)&&!(i[s].s.r>c)&&!(i[s].e.c<h)&&!(i[s].e.r<c)){(i[s].s.c!=h||i[s].s.r!=c)&&(p=!0);break}if(!p){var d={r:c,c:h},x=dr(d),g=l?(e[c]||[])[h]:e[x];f.push(KG(g,x,e,t,r,n,d))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function ZG(e,t,r){var n=[],a=r.SheetNames[e],i=r.Sheets[a],s=i?HG(i,t,e,r):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=i?XG(i,t,e,r):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(GG(i,t,e,r)),n.join("")}function JG(e,t){t||(t={}),e.SSF||(e.SSF=Ea(qr)),e.SSF&&(kp(),Pp(e.SSF),t.revssf=Cp(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Uo(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push($G(e,t)),r.push(zG()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Je("Worksheet",ZG(n,t,e),{"ss:Name":hr(e.SheetNames[n])}));return r[2]=qG(e,t),r[3]=WG(e),cn+Je("Workbook",r.join(""),{xmlns:$a.ss,"xmlns:o":$a.o,"xmlns:x":$a.x,"xmlns:ss":$a.ss,"xmlns:dt":$a.dt,"xmlns:html":$a.html})}var e1={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function QG(e,t){var r=[],n=[],a=[],i=0,s,o=K5(ow,"n"),l=K5(lw,"n");if(e.Props)for(s=Wn(e.Props),i=0;i<s.length;++i)(Object.prototype.hasOwnProperty.call(o,s[i])?r:Object.prototype.hasOwnProperty.call(l,s[i])?n:a).push([s[i],e.Props[s[i]]]);if(e.Custprops)for(s=Wn(e.Custprops),i=0;i<s.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},s[i])||(Object.prototype.hasOwnProperty.call(o,s[i])?r:Object.prototype.hasOwnProperty.call(l,s[i])?n:a).push([s[i],e.Custprops[s[i]]]);var c=[];for(i=0;i<a.length;++i)TA.indexOf(a[i][0])>-1||SA.indexOf(a[i][0])>-1||a[i][1]!=null&&c.push(a[i]);n.length&&gr.utils.cfb_add(t,"/SummaryInformation",dw(n,e1.SI,l,lw)),(r.length||c.length)&&gr.utils.cfb_add(t,"/DocumentSummaryInformation",dw(r,e1.DSI,o,ow,c.length?c:null,e1.UDI))}function eV(e,t){var r=t||{},n=gr.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return gr.utils.cfb_add(n,a,aE(e,r)),r.biff==8&&(e.Props||e.Custprops)&&QG(e,n),r.biff==8&&e.vbaraw&&vq(n,gr.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var tV={0:{f:aH},1:{f:hH},2:{f:OH},3:{f:bH},4:{f:gH},5:{f:jH},6:{f:MH},7:{f:SH},8:{f:WH},9:{f:qH},10:{f:$H},11:{f:zH},12:{f:pH},13:{f:FH},14:{f:_H},15:{f:vH},16:{f:kH},17:{f:BH},18:{f:EH},19:{f:Hv},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:PG},40:{},42:{},43:{f:Mz},44:{f:Dz},45:{f:Uz},46:{f:zz},47:{f:$z},48:{},49:{f:p$},50:{},51:{f:aq},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:mz},62:{f:IH},63:{f:uq},64:{f:sG},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:os,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:rG},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:uH},148:{f:oH,p:16},151:{f:XH},152:{},153:{f:TG},154:{},155:{},156:{f:AG},157:{},158:{},159:{T:1,f:Az},160:{T:-1},161:{T:1,f:Wl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:HH},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:rq},336:{T:-1},337:{f:oq,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Ag},357:{},358:{},359:{},360:{T:1},361:{},362:{f:cz},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:ZH},427:{f:JH},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:eG},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:cH},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:KH},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Ag},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:mq},633:{T:1},634:{T:-1},635:{T:1,f:dq},636:{T:-1},637:{f:v$},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:yG},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:oG},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function et(e,t,r,n){var a=t;if(!isNaN(a)){var i=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&zv(r)&&e.push(r)}}function rV(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return et(e,t,r,a);var i=t;if(!isNaN(i)){for(var s=r.parts||[],o=0,l=0,c=0;c+(s[o]||8224)<=8224;)c+=s[o]||8224,o++;var f=e.next(4);for(f.write_shift(2,i),f.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c;l<a;){for(f=e.next(4),f.write_shift(2,60),c=0;c+(s[o]||8224)<=8224;)c+=s[o]||8224,o++;f.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c}}}function x0(e,t,r){return e||(e=De(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function nV(e,t,r,n){var a=De(9);return x0(a,e,t),PA(r,n||"b",a),a}function aV(e,t,r){var n=De(8+2*r.length);return x0(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function iV(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?Aa(fa(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?et(e,2,yz(r,n,a)):et(e,3,vz(r,n,a));return;case"b":case"e":et(e,5,nV(r,n,t.v,t.t));return;case"s":case"str":et(e,4,aV(r,n,(t.v||"").slice(0,255)));return}et(e,1,x0(null,r,n))}function sV(e,t,r,n){var a=Array.isArray(t),i=kr(t["!ref"]||"A1"),s,o="",l=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),s=ln(i)}for(var c=i.s.r;c<=i.e.r;++c){o=qn(c);for(var f=i.s.c;f<=i.e.c;++f){c===i.s.r&&(l[f]=Qn(f)),s=l[f]+o;var h=a?(t[c]||[])[f]:t[s];h&&iV(e,h,c,f)}}}function oV(e,t){for(var r=t||{},n=Sa(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return et(n,r.biff==4?1033:r.biff==3?521:9,Kv(e,16,r)),sV(n,e.Sheets[e.SheetNames[a]],a,r),et(n,10),n.end()}function lV(e,t,r){et(e,49,tz({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function cV(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&et(e,1054,az(a,t[a],r))})}function uV(e,t){var r=De(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),et(e,2151,r),r=De(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),OA(kr(t["!ref"]||"A1"),r),r.write_shift(4,4),et(e,2152,r)}function fV(e,t){for(var r=0;r<16;++r)et(e,224,mw({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){et(e,224,mw(n,0,t))})}function hV(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];et(e,440,hz(n)),n[1].Tooltip&&et(e,2048,dz(n))}delete t["!links"]}function dV(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&et(e,125,gz(Dp(a,n),a))})}}function pV(e,t,r,n,a){var i=16+Uo(a.cellXfs,t,a);if(t.v==null&&!t.bf){et(e,513,Ol(r,n,i));return}if(t.bf)et(e,6,RW(t,r,n,a,i));else switch(t.t){case"d":case"n":var s=t.t=="d"?Aa(fa(t.v)):t.v;et(e,515,lz(r,n,s,i));break;case"b":case"e":et(e,517,oz(r,n,t.v,i,a,t.t));break;case"s":case"str":if(a.bookSST){var o=Qv(a.Strings,t.v,a.revStrings);et(e,253,rz(r,n,o,i))}else et(e,516,nz(r,n,(t.v||"").slice(0,255),i,a));break;default:et(e,513,Ol(r,n,i))}}function mV(e,t,r){var n=Sa(),a=r.SheetNames[e],i=r.Sheets[a]||{},s=(r||{}).Workbook||{},o=(s.Sheets||[])[e]||{},l=Array.isArray(i),c=t.biff==8,f,h="",p=[],d=kr(i["!ref"]||"A1"),x=c?65536:16384;if(d.e.c>255||d.e.r>=x){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,x-1)}et(n,2057,Kv(r,16,t)),et(n,13,oi(1)),et(n,12,oi(100)),et(n,15,la(!0)),et(n,17,la(!1)),et(n,16,Cl(.001)),et(n,95,la(!0)),et(n,42,la(!1)),et(n,43,la(!1)),et(n,130,oi(1)),et(n,128,sz()),et(n,131,la(!1)),et(n,132,la(!1)),c&&dV(n,i["!cols"]),et(n,512,iz(d,t)),c&&(i["!links"]=[]);for(var g=d.s.r;g<=d.e.r;++g){h=qn(g);for(var y=d.s.c;y<=d.e.c;++y){g===d.s.r&&(p[y]=Qn(y)),f=p[y]+h;var b=l?(i[g]||[])[y]:i[f];b&&(pV(n,b,g,y,t),c&&b.l&&i["!links"].push([f,b.l]))}}var T=o.CodeName||o.name||a;return c&&et(n,574,ez((s.Views||[])[0])),c&&(i["!merges"]||[]).length&&et(n,229,fz(i["!merges"])),c&&hV(n,i),et(n,442,CA(T)),c&&uV(n,i),et(n,10),n.end()}function gV(e,t,r){var n=Sa(),a=(e||{}).Workbook||{},i=a.Sheets||[],s=a.WBProps||{},o=r.biff==8,l=r.biff==5;if(et(n,2057,Kv(e,5,r)),r.bookType=="xla"&&et(n,135),et(n,225,o?oi(1200):null),et(n,193,$$(2)),l&&et(n,191),l&&et(n,192),et(n,226),et(n,92,X$("SheetJS",r)),et(n,66,oi(o?1200:1252)),o&&et(n,353,oi(0)),o&&et(n,448),et(n,317,xz(e.SheetNames.length)),o&&e.vbaraw&&et(n,211),o&&e.vbaraw){var c=s.CodeName||"ThisWorkbook";et(n,442,CA(c))}et(n,156,oi(17)),et(n,25,la(!1)),et(n,18,la(!1)),et(n,19,oi(0)),o&&et(n,431,la(!1)),o&&et(n,444,oi(0)),et(n,61,Q$()),et(n,64,la(!1)),et(n,141,oi(0)),et(n,34,la(wG(e)=="true")),et(n,14,la(!0)),o&&et(n,439,la(!1)),et(n,218,oi(0)),lV(n,e,r),cV(n,e.SSF,r),fV(n,r),o&&et(n,352,la(!1));var f=n.end(),h=Sa();o&&et(h,140,pz()),o&&r.Strings&&rV(h,252,J$(r.Strings)),et(h,10);var p=h.end(),d=Sa(),x=0,g=0;for(g=0;g<e.SheetNames.length;++g)x+=(o?12:11)+(o?2:1)*e.SheetNames[g].length;var y=f.length+x+p.length;for(g=0;g<e.SheetNames.length;++g){var b=i[g]||{};et(d,133,Z$({pos:y,hs:b.Hidden||0,dt:0,name:e.SheetNames[g]},r)),y+=t[g].length}var T=d.end();if(x!=T.length)throw new Error("BS8 "+x+" != "+T.length);var S=[];return f.length&&S.push(f),T.length&&S.push(T),p.length&&S.push(p),$n(S)}function xV(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=Ea(qr)),e&&e.SSF&&(kp(),Pp(e.SSF),r.revssf=Cp(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,e2(r),r.cellXfs=[],Uo(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=mV(a,r,e);return n.unshift(gV(e,n,r)),$n(n)}function aE(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=Za(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return xV(e,t);case 4:case 3:case 2:return oV(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function vV(e,t,r,n){for(var a=e["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,l=0,c=0;c<a.length;++c)if(!(a[c].s.r>r||a[c].s.c>s)&&!(a[c].e.r<r||a[c].e.c<s)){if(a[c].s.r<r||a[c].s.c<s){o=-1;break}o=a[c].e.r-a[c].s.r+1,l=a[c].e.c-a[c].s.c+1;break}if(!(o<0)){var f=dr({r,c:s}),h=n.dense?(e[r]||[])[s]:e[f],p=h&&h.v!=null&&(h.h||YU(h.w||(zs(h),h.w)||""))||"",d={};o>1&&(d.rowspan=o),l>1&&(d.colspan=l),n.editable?p='<span contenteditable="true">'+p+"</span>":h&&(d["data-t"]=h&&h.t||"z",h.v!=null&&(d["data-v"]=h.v),h.z!=null&&(d["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+h.l.Target+'">'+p+"</a>")),d.id=(n.id||"sjs")+"-"+f,i.push(Je("td",p,d))}}var x="<tr>";return x+i.join("")+"</tr>"}var yV='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',bV="</body></html>";function wV(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function iE(e,t){var r=t||{},n=r.header!=null?r.header:yV,a=r.footer!=null?r.footer:bV,i=[n],s=Za(e["!ref"]);r.dense=Array.isArray(e),i.push(wV(e,s,r));for(var o=s.s.r;o<=s.e.r;++o)i.push(vV(e,s,o,r));return i.push("</table>"+a),i.join("")}function sE(e,t,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var s=typeof n.origin=="string"?En(n.origin):n.origin;a=s.r,i=s.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var f=Za(e["!ref"]);c.s.r=Math.min(c.s.r,f.s.r),c.s.c=Math.min(c.s.c,f.s.c),c.e.r=Math.max(c.e.r,f.e.r),c.e.c=Math.max(c.e.c,f.e.c),a==-1&&(c.e.r=a=f.e.r+1)}var h=[],p=0,d=e["!rows"]||(e["!rows"]=[]),x=0,g=0,y=0,b=0,T=0,S=0;for(e["!cols"]||(e["!cols"]=[]);x<o.length&&g<l;++x){var k=o[x];if(_w(k)){if(n.display)continue;d[g]={hidden:!0}}var A=k.children;for(y=b=0;y<A.length;++y){var M=A[y];if(!(n.display&&_w(M))){var O=M.hasAttribute("data-v")?M.getAttribute("data-v"):M.hasAttribute("v")?M.getAttribute("v"):QU(M.innerHTML),I=M.getAttribute("data-z")||M.getAttribute("z");for(p=0;p<h.length;++p){var j=h[p];j.s.c==b+i&&j.s.r<g+a&&g+a<=j.e.r&&(b=j.e.c+1-i,p=-1)}S=+M.getAttribute("colspan")||1,((T=+M.getAttribute("rowspan")||1)>1||S>1)&&h.push({s:{r:g+a,c:b+i},e:{r:g+a+(T||1)-1,c:b+i+(S||1)-1}});var W={t:"s",v:O},E=M.getAttribute("data-t")||M.getAttribute("t")||"";O!=null&&(O.length==0?W.t=E||"z":n.raw||O.trim().length==0||E=="s"||(O==="TRUE"?W={t:"b",v:!0}:O==="FALSE"?W={t:"b",v:!1}:isNaN(Ls(O))?isNaN(Rf(O).getDate())||(W={t:"d",v:fa(O)},n.cellDates||(W={t:"n",v:Aa(W.v)}),W.z=n.dateNF||qr[14]):W={t:"n",v:Ls(O)})),W.z===void 0&&I!=null&&(W.z=I);var C="",G=M.getElementsByTagName("A");if(G&&G.length)for(var Z=0;Z<G.length&&!(G[Z].hasAttribute("href")&&(C=G[Z].getAttribute("href"),C.charAt(0)!="#"));++Z);C&&C.charAt(0)!="#"&&(W.l={Target:C}),n.dense?(e[g+a]||(e[g+a]=[]),e[g+a][b+i]=W):e[dr({c:b+i,r:g+a})]=W,c.e.c<b+i&&(c.e.c=b+i),b+=S}}++g}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,g-1+a),e["!ref"]=ln(c),g>=l&&(e["!fullref"]=ln((c.e.r=o.length-x+g-1+a,c))),e}function oE(e,t){var r=t||{},n=r.dense?[]:{};return sE(n,e,t)}function _V(e,t){return Ul(oE(e,t),t)}function _w(e){var t="",r=NV(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function NV(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var SV=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Uf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return cn+t}}(),Nw=function(){var e=function(i){return hr(i).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,s,o){var l=[];l.push('      <table:table table:name="'+hr(s.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,f=0,h=Za(i["!ref"]||"A1"),p=i["!merges"]||[],d=0,x=Array.isArray(i);if(i["!cols"])for(f=0;f<=h.e.c;++f)l.push("        <table:table-column"+(i["!cols"][f]?' table:style-name="co'+i["!cols"][f].ods+'"':"")+`></table:table-column>
`);var g="",y=i["!rows"]||[];for(c=0;c<h.s.r;++c)g=y[c]?' table:style-name="ro'+y[c].ods+'"':"",l.push("        <table:table-row"+g+`></table:table-row>
`);for(;c<=h.e.r;++c){for(g=y[c]?' table:style-name="ro'+y[c].ods+'"':"",l.push("        <table:table-row"+g+`>
`),f=0;f<h.s.c;++f)l.push(t);for(;f<=h.e.c;++f){var b=!1,T={},S="";for(d=0;d!=p.length;++d)if(!(p[d].s.c>f)&&!(p[d].s.r>c)&&!(p[d].e.c<f)&&!(p[d].e.r<c)){(p[d].s.c!=f||p[d].s.r!=c)&&(b=!0),T["table:number-columns-spanned"]=p[d].e.c-p[d].s.c+1,T["table:number-rows-spanned"]=p[d].e.r-p[d].s.r+1;break}if(b){l.push(r);continue}var k=dr({r:c,c:f}),A=x?(i[c]||[])[f]:i[k];if(A&&A.f&&(T["table:formula"]=hr(WW(A.f)),A.F&&A.F.slice(0,k.length)==k)){var M=Za(A.F);T["table:number-matrix-columns-spanned"]=M.e.c-M.s.c+1,T["table:number-matrix-rows-spanned"]=M.e.r-M.s.r+1}if(!A){l.push(t);continue}switch(A.t){case"b":S=A.v?"TRUE":"FALSE",T["office:value-type"]="boolean",T["office:boolean-value"]=A.v?"true":"false";break;case"n":S=A.w||String(A.v||0),T["office:value-type"]="float",T["office:value"]=A.v||0;break;case"s":case"str":S=A.v==null?"":A.v,T["office:value-type"]="string";break;case"d":S=A.w||fa(A.v).toISOString(),T["office:value-type"]="date",T["office:date-value"]=fa(A.v).toISOString(),T["table:style-name"]="ce1";break;default:l.push(t);continue}var O=e(S);if(A.l&&A.l.Target){var I=A.l.Target;I=I.charAt(0)=="#"?"#"+HW(I.slice(1)):I,I.charAt(0)!="#"&&!I.match(/^\w+:/)&&(I="../"+I),O=Je("text:a",O,{"xlink:href":I.replace(/&/g,"&amp;")})}l.push("          "+Je("table:table-cell",Je("text:p",O,{}),T)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},a=function(i,s){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;s.SheetNames.map(function(c){return s.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var f=0;f<c["!cols"].length;++f)if(c["!cols"][f]){var h=c["!cols"][f];if(h.width==null&&h.wpx==null&&h.wch==null)continue;Yv(h),h.ods=o;var p=c["!cols"][f].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),i.push(`  </style:style>
`),++o}}});var l=0;s.SheetNames.map(function(c){return s.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var f=0;f<c["!rows"].length;++f)if(c["!rows"][f]){c["!rows"][f].ods=l;var h=c["!rows"][f].hpx+"px";i.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),i.push(`  </style:style>
`),++l}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(s,o){var l=[cn],c=Uf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=Uf({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+f+`>
`),l.push(_A().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),a(l,s),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=s.SheetNames.length;++h)l.push(n(s.Sheets[s.SheetNames[h]],s,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function lE(e,t){if(t.bookType=="fods")return Nw(e,t);var r=Rv(),n="",a=[],i=[];return n="mimetype",Bt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Bt(r,n,Nw(e,t)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",Bt(r,n,SV(e,t)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",Bt(r,n,cn+_A()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",Bt(r,n,I$(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Bt(r,n,F$(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Ed(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function AV(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Ci(Bf(e))}function EV(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Oo(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function TV(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=a&255;e[t+15]|=r>=0?0:128}function $f(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function lr(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Cc(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function gn(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=$f(e,r),i=a&7;a=Math.floor(a/8);var s=0,o;if(a==0)break;switch(i){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:s=4,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=$f(e,r),o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var c={data:o,type:i};t[a]==null?t[a]=[c]:t[a].push(c)}return t}function Dn(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(lr(n*8+a.type)),a.type==2&&t.push(lr(a.data.length)),t.push(a.data))})}),Oo(t)}function Ei(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=$f(e,n),i=gn(e.slice(n[0],n[0]+a));n[0]+=a;var s={id:Cc(i[1][0].data),messages:[]};i[2].forEach(function(o){var l=gn(o.data),c=Cc(l[3][0].data);s.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=i[3])!=null&&t[0]&&(s.merge=Cc(i[3][0].data)>>>0>0),r.push(s)}return r}function lc(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:lr(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:lr(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(s){a.push(s.data),s.meta[3]=[{type:0,data:lr(s.data.length)}],n[2].push({data:Dn(s.meta),type:2})});var i=Dn(n);t.push(lr(i.length)),t.push(i),a.forEach(function(s){return t.push(s)})}),Oo(t)}function jV(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=$f(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var o=s-59;s=t[r[0]],o>1&&(s|=t[r[0]+1]<<8),o>2&&(s|=t[r[0]+2]<<16),o>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=o}a.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var l=0,c=0;if(i==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,i==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Oo(a)],l==0)throw new Error("Invalid offset 0");if(l>a[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(a.push(a[0].slice(-l)),c-=l;c>=a[a.length-1].length;)a.push(a[a.length-1]),c-=a[a.length-1].length;a.push(a[0].slice(-l,-l+c))}}var f=Oo(a);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function Ti(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(jV(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Oo(t)}function cc(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var i=lr(n),s=i.length;t.push(i),n<=60?(s++,t.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),s+=n,a[0]=0,a[1]=s&255,a[2]=s>>8&255,a[3]=s>>16&255,r+=n}return Oo(t)}function t1(e,t){var r=new Uint8Array(32),n=Ed(r),a=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,TV(r,a,e.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,a)}function r1(e,t){var r=new Uint8Array(32),n=Ed(r),a=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,a)}function uo(e){var t=gn(e);return $f(t[1][0].data)}function PV(e,t,r){var n,a,i,s;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var o=((s=(i=e[8])==null?void 0:i[0])==null?void 0:s.data)&&Cc(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=Ed(e[7][0].data),f=0,h=[],p=Ed(e[4][0].data),d=0,x=[],g=0;g<t.length;++g){if(t[g]==null){c.setUint16(g*2,65535,!0),p.setUint16(g*2,65535);continue}c.setUint16(g*2,f,!0),p.setUint16(g*2,d,!0);var y,b;switch(typeof t[g]){case"string":y=t1({t:"s",v:t[g]},r),b=r1({t:"s",v:t[g]},r);break;case"number":y=t1({t:"n",v:t[g]},r),b=r1({t:"n",v:t[g]},r);break;case"boolean":y=t1({t:"b",v:t[g]},r),b=r1({t:"b",v:t[g]},r);break;default:throw new Error("Unsupported value "+t[g])}h.push(y),f+=y.length,x.push(b),d+=b.length,++l}for(e[2][0].data=lr(l);g<e[7][0].data.length/2;++g)c.setUint16(g*2,65535,!0),p.setUint16(g*2,65535,!0);return e[6][0].data=Oo(h),e[3][0].data=Oo(x),l}function kV(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Za(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(ln(n)));var i=Td(r,{range:n,header:1}),s=["~Sh33tJ5~"];i.forEach(function(D){return D.forEach(function(L){typeof L=="string"&&s.push(L)})});var o={},l=[],c=gr.read(t.numbers,{type:"base64"});c.FileIndex.map(function(D,L){return[D,c.FullPaths[L]]}).forEach(function(D){var L=D[0],F=D[1];if(L.type==2&&L.name.match(/\.iwa/)){var K=L.content,ce=Ti(K),xe=Ei(ce);xe.forEach(function(ee){l.push(ee.id),o[ee.id]={deps:[],location:F,type:Cc(ee.messages[0].meta[1][0].data)}})}}),l.sort(function(D,L){return D-L});var f=l.filter(function(D){return D>1}).map(function(D){return[D,lr(D)]});c.FileIndex.map(function(D,L){return[D,c.FullPaths[L]]}).forEach(function(D){var L=D[0];if(D[1],!!L.name.match(/\.iwa/)){var F=Ei(Ti(L.content));F.forEach(function(K){K.messages.forEach(function(ce){f.forEach(function(xe){K.messages.some(function(ee){return Cc(ee.meta[1][0].data)!=11006&&EV(ee.data,xe[1])})&&o[xe[0]].deps.push(K.id)})})})}});for(var h=gr.find(c,o[1].location),p=Ei(Ti(h.content)),d,x=0;x<p.length;++x){var g=p[x];g.id==1&&(d=g)}var y=uo(gn(d.messages[0].data)[1][0].data);for(h=gr.find(c,o[y].location),p=Ei(Ti(h.content)),x=0;x<p.length;++x)g=p[x],g.id==y&&(d=g);for(y=uo(gn(d.messages[0].data)[2][0].data),h=gr.find(c,o[y].location),p=Ei(Ti(h.content)),x=0;x<p.length;++x)g=p[x],g.id==y&&(d=g);for(y=uo(gn(d.messages[0].data)[2][0].data),h=gr.find(c,o[y].location),p=Ei(Ti(h.content)),x=0;x<p.length;++x)g=p[x],g.id==y&&(d=g);var b=gn(d.messages[0].data);{b[6][0].data=lr(n.e.r+1),b[7][0].data=lr(n.e.c+1);var T=uo(b[46][0].data),S=gr.find(c,o[T].location),k=Ei(Ti(S.content));{for(var A=0;A<k.length&&k[A].id!=T;++A);if(k[A].id!=T)throw"Bad ColumnRowUIDMapArchive";var M=gn(k[A].messages[0].data);M[1]=[],M[2]=[],M[3]=[];for(var O=0;O<=n.e.c;++O){var I=[];I[1]=I[2]=[{type:0,data:lr(O+420690)}],M[1].push({type:2,data:Dn(I)}),M[2].push({type:0,data:lr(O)}),M[3].push({type:0,data:lr(O)})}M[4]=[],M[5]=[],M[6]=[];for(var j=0;j<=n.e.r;++j)I=[],I[1]=I[2]=[{type:0,data:lr(j+726270)}],M[4].push({type:2,data:Dn(I)}),M[5].push({type:0,data:lr(j)}),M[6].push({type:0,data:lr(j)});k[A].messages[0].data=Dn(M)}S.content=cc(lc(k)),S.size=S.content.length,delete b[46];var W=gn(b[4][0].data);{W[7][0].data=lr(n.e.r+1);var E=gn(W[1][0].data),C=uo(E[2][0].data);S=gr.find(c,o[C].location),k=Ei(Ti(S.content));{if(k[0].id!=C)throw"Bad HeaderStorageBucket";var G=gn(k[0].messages[0].data);for(j=0;j<i.length;++j){var Z=gn(G[2][0].data);Z[1][0].data=lr(j),Z[4][0].data=lr(i[j].length),G[2][j]={type:G[2][0].type,data:Dn(Z)}}k[0].messages[0].data=Dn(G)}S.content=cc(lc(k)),S.size=S.content.length;var he=uo(W[2][0].data);S=gr.find(c,o[he].location),k=Ei(Ti(S.content));{if(k[0].id!=he)throw"Bad HeaderStorageBucket";for(G=gn(k[0].messages[0].data),O=0;O<=n.e.c;++O)Z=gn(G[2][0].data),Z[1][0].data=lr(O),Z[4][0].data=lr(n.e.r+1),G[2][O]={type:G[2][0].type,data:Dn(Z)};k[0].messages[0].data=Dn(G)}S.content=cc(lc(k)),S.size=S.content.length;var oe=uo(W[4][0].data);(function(){for(var D=gr.find(c,o[oe].location),L=Ei(Ti(D.content)),F,K=0;K<L.length;++K){var ce=L[K];ce.id==oe&&(F=ce)}var xe=gn(F.messages[0].data);{xe[3]=[];var ee=[];s.forEach(function(ue,$e){ee[1]=[{type:0,data:lr($e)}],ee[2]=[{type:0,data:lr(1)}],ee[3]=[{type:2,data:AV(ue)}],xe[3].push({type:2,data:Dn(ee)})})}F.messages[0].data=Dn(xe);var fe=lc(L),le=cc(fe);D.content=le,D.size=D.content.length})();var me=gn(W[3][0].data);{var pe=me[1][0];delete me[2];var ge=gn(pe.data);{var Le=uo(ge[2][0].data);(function(){for(var D=gr.find(c,o[Le].location),L=Ei(Ti(D.content)),F,K=0;K<L.length;++K){var ce=L[K];ce.id==Le&&(F=ce)}var xe=gn(F.messages[0].data);{delete xe[6],delete me[7];var ee=new Uint8Array(xe[5][0].data);xe[5]=[];for(var fe=0,le=0;le<=n.e.r;++le){var ue=gn(ee);fe+=PV(ue,i[le],s),ue[1][0].data=lr(le),xe[5].push({data:Dn(ue),type:2})}xe[1]=[{type:0,data:lr(n.e.c+1)}],xe[2]=[{type:0,data:lr(n.e.r+1)}],xe[3]=[{type:0,data:lr(fe)}],xe[4]=[{type:0,data:lr(n.e.r+1)}]}F.messages[0].data=Dn(xe);var $e=lc(L),ye=cc($e);D.content=ye,D.size=D.content.length})()}pe.data=Dn(ge)}W[3][0].data=Dn(me)}b[4][0].data=Dn(W)}d.messages[0].data=Dn(b);var Se=lc(p),N=cc(Se);return h.content=N,h.size=h.content.length,c}function CV(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function e2(e){CV([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function OV(e,t){return t.bookType=="ods"?lE(e,t):t.bookType=="numbers"?kV(e,t):t.bookType=="xlsb"?LV(e,t):FV(e,t)}function LV(e,t){wc=1024,e&&!e.SSF&&(e.SSF=Ea(qr)),e&&e.SSF&&(kp(),Pp(e.SSF),t.revssf=Cp(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,vf?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=WA.indexOf(t.bookType)>-1,a=yA();e2(t=t||{});var i=Rv(),s="",o=0;if(t.cellXfs=[],Uo(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Bt(i,s,NA(e.Props,t)),a.coreprops.push(s),cr(t.rels,2,s,Zt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,Bt(i,s,AA(e.Props)),a.extprops.push(s),cr(t.rels,3,s,Zt.EXT_PROPS),e.Custprops!==e.Props&&Wn(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Bt(i,s,EA(e.Custprops)),a.custprops.push(s),cr(t.rels,4,s,Zt.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,Bt(i,s,IG(o-1,s,t,e,f)),a.sheets.push(s),cr(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Zt.WS[0])}if(h){var d=h["!comments"],x=!1,g="";d&&d.length>0&&(g="xl/comments"+o+"."+r,Bt(i,g,BG(d,g)),a.comments.push(g),cr(f,-1,"../comments"+o+"."+r,Zt.CMNT),x=!0),h["!legacy"]&&x&&Bt(i,"xl/drawings/vmlDrawing"+o+".vml",zA(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}f["!id"].rId1&&Bt(i,wA(s),Pc(f))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,Bt(i,s,RG(t.Strings,s,t)),a.strs.push(s),cr(t.wbrels,-1,"sharedStrings."+r,Zt.SST)),s="xl/workbook."+r,Bt(i,s,DG(e,s)),a.workbooks.push(s),cr(t.rels,1,s,Zt.WB),s="xl/theme/theme1.xml",Bt(i,s,UA(e.Themes,t)),a.themes.push(s),cr(t.wbrels,-1,"theme/theme1.xml",Zt.THEME),s="xl/styles."+r,Bt(i,s,MG(e,s,t)),a.styles.push(s),cr(t.wbrels,-1,"styles."+r,Zt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",Bt(i,s,e.vbaraw),a.vba.push(s),cr(t.wbrels,-1,"vbaProject.bin",Zt.VBA)),s="xl/metadata."+r,Bt(i,s,UG(s)),a.metadata.push(s),cr(t.wbrels,-1,"metadata."+r,Zt.XLMETA),Bt(i,"[Content_Types].xml",bA(a,t)),Bt(i,"_rels/.rels",Pc(t.rels)),Bt(i,"xl/_rels/workbook."+r+".rels",Pc(t.wbrels)),delete t.revssf,delete t.ssf,i}function FV(e,t){wc=1024,e&&!e.SSF&&(e.SSF=Ea(qr)),e&&e.SSF&&(kp(),Pp(e.SSF),t.revssf=Cp(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,vf?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=WA.indexOf(t.bookType)>-1,a=yA();e2(t=t||{});var i=Rv(),s="",o=0;if(t.cellXfs=[],Uo(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Bt(i,s,NA(e.Props,t)),a.coreprops.push(s),cr(t.rels,2,s,Zt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,Bt(i,s,AA(e.Props)),a.extprops.push(s),cr(t.rels,3,s,Zt.EXT_PROPS),e.Custprops!==e.Props&&Wn(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Bt(i,s,EA(e.Custprops)),a.custprops.push(s),cr(t.rels,4,s,Zt.CUST_PROPS));var f=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var h={"!id":{}},p=e.Sheets[e.SheetNames[o-1]],d=(p||{})["!type"]||"sheet";switch(d){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,Bt(i,s,QA(o-1,t,e,h)),a.sheets.push(s),cr(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Zt.WS[0])}if(p){var x=p["!comments"],g=!1,y="";if(x&&x.length>0){var b=!1;x.forEach(function(T){T[1].forEach(function(S){S.T==!0&&(b=!0)})}),b&&(y="xl/threadedComments/threadedComment"+o+"."+r,Bt(i,y,fq(x,f,t)),a.threadedcomments.push(y),cr(h,-1,"../threadedComments/threadedComment"+o+"."+r,Zt.TCMNT)),y="xl/comments"+o+"."+r,Bt(i,y,qA(x)),a.comments.push(y),cr(h,-1,"../comments"+o+"."+r,Zt.CMNT),g=!0}p["!legacy"]&&g&&Bt(i,"xl/drawings/vmlDrawing"+o+".vml",zA(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}h["!id"].rId1&&Bt(i,wA(s),Pc(h))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,Bt(i,s,FA(t.Strings,t)),a.strs.push(s),cr(t.wbrels,-1,"sharedStrings."+r,Zt.SST)),s="xl/workbook."+r,Bt(i,s,rE(e)),a.workbooks.push(s),cr(t.rels,1,s,Zt.WB),s="xl/theme/theme1.xml",Bt(i,s,UA(e.Themes,t)),a.themes.push(s),cr(t.wbrels,-1,"theme/theme1.xml",Zt.THEME),s="xl/styles."+r,Bt(i,s,RA(e,t)),a.styles.push(s),cr(t.wbrels,-1,"styles."+r,Zt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",Bt(i,s,e.vbaraw),a.vba.push(s),cr(t.wbrels,-1,"vbaProject.bin",Zt.VBA)),s="xl/metadata."+r,Bt(i,s,$A()),a.metadata.push(s),cr(t.wbrels,-1,"metadata."+r,Zt.XLMETA),f.length>1&&(s="xl/persons/person.xml",Bt(i,s,hq(f)),a.people.push(s),cr(t.wbrels,-1,"persons/person.xml",Zt.PEOPLE)),Bt(i,"[Content_Types].xml",bA(a,t)),Bt(i,"_rels/.rels",Pc(t.rels)),Bt(i,"xl/_rels/workbook."+r+".rels",Pc(t.wbrels)),delete t.revssf,delete t.ssf,i}function DV(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=$s(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function cE(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return d0(t.file,gr.write(e,{type:ar?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return gr.write(e,t)}function IV(e,t){var r=Ea(t||{}),n=OV(e,r);return MV(n,r)}function MV(e,t){var r={},n=ar?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?gr.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(jp(a))}return t.password&&typeof encrypt_agile<"u"?cE(encrypt_agile(a,t.password),t):t.type==="file"?d0(t.file,a):t.type=="string"?pf(a):a}function RV(e,t){var r=t||{},n=eV(e,r);return cE(n,r)}function Zi(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Mf(Bf(n));case"binary":return Bf(n);case"string":return e;case"file":return d0(t.file,n,"utf8");case"buffer":return ar?Vs(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Zi(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function BV(e,t){switch(t.type){case"base64":return Mf(e);case"binary":return e;case"string":return e;case"file":return d0(t.file,e,"binary");case"buffer":return ar?Vs(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function hh(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Mf(r):t.type=="string"?pf(r):r;case"file":return d0(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function uE(e,t){dU(),SG(e);var r=Ea(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=uE(e,r);return r.type="array",jp(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Zi(JG(e,r),r);case"slk":case"sylk":return Zi(wz.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return Zi(iE(e.Sheets[e.SheetNames[a]],r),r);case"txt":return BV(fE(e.Sheets[e.SheetNames[a]],r),r);case"csv":return Zi(t2(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return Zi(_z.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return hh(bz.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return Zi(Nz.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return Zi(kz.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return Zi(LA.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return Zi(lE(e,r),r);case"wk1":return hh(gw.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return hh(gw.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),hh(aE(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),RV(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return IV(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function UV(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function $V(e,t,r){var n={};return n.type="file",n.file=t,UV(n),uE(e,n)}function zV(e,t,r,n,a,i,s,o){var l=qn(r),c=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,p=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!s||e[r])for(var d=t.s.c;d<=t.e.c;++d){var x=s?e[r][d]:e[n[d]+l];if(x===void 0||x.t===void 0){if(c===void 0)continue;i[d]!=null&&(p[i[d]]=c);continue}var g=x.v;switch(x.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(i[d]!=null){if(g==null)if(x.t=="e"&&g===null)p[i[d]]=null;else if(c!==void 0)p[i[d]]=c;else if(f&&g===null)p[i[d]]=null;else continue;else p[i[d]]=f&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?g:zs(x,g,o);g!=null&&(h=!1)}}return{row:p,isempty:h}}function Td(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],s=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},f=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof f){case"string":l=kr(f);break;case"number":l=kr(e["!ref"]),l.s.r=f;break;default:l=f}n>0&&(a=0);var h=qn(l.s.r),p=[],d=[],x=0,g=0,y=Array.isArray(e),b=l.s.r,T=0,S={};y&&!e[b]&&(e[b]=[]);var k=c.skipHidden&&e["!cols"]||[],A=c.skipHidden&&e["!rows"]||[];for(T=l.s.c;T<=l.e.c;++T)if(!(k[T]||{}).hidden)switch(p[T]=Qn(T),r=y?e[b][T]:e[p[T]+h],n){case 1:i[T]=T-l.s.c;break;case 2:i[T]=p[T];break;case 3:i[T]=c.header[T-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=s=zs(r,null,c),g=S[s]||0,!g)S[s]=1;else{do o=s+"_"+g++;while(S[o]);S[s]=g,S[o]=1}i[T]=o}for(b=l.s.r+a;b<=l.e.r;++b)if(!(A[b]||{}).hidden){var M=zV(e,l,b,p,n,i,y,c);(M.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(d[x++]=M.row)}return d.length=x,d}var Sw=/"/g;function qV(e,t,r,n,a,i,s,o){for(var l=!0,c=[],f="",h=qn(r),p=t.s.c;p<=t.e.c;++p)if(n[p]){var d=o.dense?(e[r]||[])[p]:e[n[p]+h];if(d==null)f="";else if(d.v!=null){l=!1,f=""+(o.rawNumbers&&d.t=="n"?d.v:zs(d,null,o));for(var x=0,g=0;x!==f.length;++x)if((g=f.charCodeAt(x))===a||g===i||g===34||o.forceQuotes){f='"'+f.replace(Sw,'""')+'"';break}f=="ID"&&(f='"ID"')}else d.f!=null&&!d.F?(l=!1,f="="+d.f,f.indexOf(",")>=0&&(f='"'+f.replace(Sw,'""')+'"')):f="";c.push(f)}return o.blankrows===!1&&l?null:c.join(s)}function t2(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=kr(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((i=="|"?"\\|":i)+"+$"),f="",h=[];n.dense=Array.isArray(e);for(var p=n.skipHidden&&e["!cols"]||[],d=n.skipHidden&&e["!rows"]||[],x=a.s.c;x<=a.e.c;++x)(p[x]||{}).hidden||(h[x]=Qn(x));for(var g=0,y=a.s.r;y<=a.e.r;++y)(d[y]||{}).hidden||(f=qV(e,a,y,h,s,l,i,n),f!=null&&(n.strip&&(f=f.replace(c,"")),(f||n.blankrows!==!1)&&r.push((g++?o:"")+f)));return delete n.dense,r.join("")}function fE(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=t2(e,t);return r}function WV(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=kr(e["!ref"]),i="",s=[],o,l=[],c=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)s[o]=Qn(o);for(var f=a.s.r;f<=a.e.r;++f)for(i=qn(f),o=a.s.c;o<=a.e.c;++o)if(t=s[o]+i,r=c?(e[f]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function hE(e,t,r){var n=r||{},a=+!n.skipHeader,i=e||{},s=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?En(n.origin):n.origin;s=l.r,o=l.c}var c,f={s:{c:0,r:0},e:{c:o,r:s+t.length-1+a}};if(i["!ref"]){var h=kr(i["!ref"]);f.e.c=Math.max(f.e.c,h.e.c),f.e.r=Math.max(f.e.r,h.e.r),s==-1&&(s=h.e.r+1,f.e.r=s+t.length-1+a)}else s==-1&&(s=0,f.e.r=t.length-1+a);var p=n.header||[],d=0;t.forEach(function(g,y){Wn(g).forEach(function(b){(d=p.indexOf(b))==-1&&(p[d=p.length]=b);var T=g[b],S="z",k="",A=dr({c:o+d,r:s+y+a});c=zf(i,A),T&&typeof T=="object"&&!(T instanceof Date)?i[A]=T:(typeof T=="number"?S="n":typeof T=="boolean"?S="b":typeof T=="string"?S="s":T instanceof Date?(S="d",n.cellDates||(S="n",T=Aa(T)),k=n.dateNF||qr[14]):T===null&&n.nullError&&(S="e",T=0),c?(c.t=S,c.v=T,delete c.w,delete c.R,k&&(c.z=k)):i[A]=c={t:S,v:T},k&&(c.z=k))})}),f.e.c=Math.max(f.e.c,o+p.length-1);var x=qn(s);if(a)for(d=0;d<p.length;++d)i[Qn(d+o)+x]={t:"s",v:p[d]};return i["!ref"]=ln(f),i}function HV(e,t){return hE(null,e,t)}function zf(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=En(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?zf(e,dr(t)):zf(e,dr({r:t,c:r||0}))}function GV(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function VV(){return{SheetNames:[],Sheets:{}}}function KV(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=s+a)!=-1;++a);}if(tE(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function YV(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=GV(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function XV(e,t){return e.z=t,e}function dE(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function ZV(e,t,r){return dE(e,"#"+t,r)}function JV(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function QV(e,t,r,n){for(var a=typeof t!="string"?t:kr(t),i=typeof t=="string"?t:ln(t),s=a.s.r;s<=a.e.r;++s)for(var o=a.s.c;o<=a.e.c;++o){var l=zf(e,s,o);l.t="n",l.F=i,delete l.v,s==a.s.r&&o==a.s.c&&(l.f=r,n&&(l.D=!0))}return e}var Qu={encode_col:Qn,encode_row:qn,encode_cell:dr,encode_range:ln,decode_col:Wv,decode_row:qv,split_cell:d$,decode_cell:En,decode_range:Za,format_cell:zs,sheet_add_aoa:dA,sheet_add_json:hE,sheet_add_dom:sE,aoa_to_sheet:fu,json_to_sheet:HV,table_to_sheet:oE,table_to_book:_V,sheet_to_csv:t2,sheet_to_txt:fE,sheet_to_json:Td,sheet_to_html:iE,sheet_to_formulae:WV,sheet_to_row_object_array:Td,sheet_get_cell:zf,book_new:VV,book_append_sheet:KV,book_set_sheet_visibility:YV,cell_set_number_format:XV,cell_set_hyperlink:dE,cell_set_internal_link:ZV,cell_add_comment:JV,sheet_set_array_formula:QV,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function fr(e){"@babel/helpers - typeof";return fr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fr(e)}var Ii=Uint8Array,Ha=Uint16Array,r2=Int32Array,n2=new Ii([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),a2=new Ii([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Aw=new Ii([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),pE=function(e,t){for(var r=new Ha(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var a=new r2(r[30]),n=1;n<30;++n)for(var i=r[n];i<r[n+1];++i)a[i]=i-r[n]<<5|n;return{b:r,r:a}},mE=pE(n2,2),eK=mE.b,Tg=mE.r;eK[28]=258,Tg[258]=28;var tK=pE(a2,0),Ew=tK.r,jg=new Ha(32768);for(var Pr=0;Pr<32768;++Pr){var fo=(Pr&43690)>>1|(Pr&21845)<<1;fo=(fo&52428)>>2|(fo&13107)<<2,fo=(fo&61680)>>4|(fo&3855)<<4,jg[Pr]=((fo&65280)>>8|(fo&255)<<8)>>1}var yf=function(e,t,r){for(var n=e.length,a=0,i=new Ha(t);a<n;++a)e[a]&&++i[e[a]-1];var s=new Ha(t);for(a=1;a<t;++a)s[a]=s[a-1]+i[a-1]<<1;var o;if(r){o=new Ha(1<<t);var l=15-t;for(a=0;a<n;++a)if(e[a])for(var c=a<<4|e[a],f=t-e[a],h=s[e[a]-1]++<<f,p=h|(1<<f)-1;h<=p;++h)o[jg[h]>>l]=c}else for(o=new Ha(n),a=0;a<n;++a)e[a]&&(o[a]=jg[s[e[a]-1]++]>>15-e[a]);return o},Ll=new Ii(288);for(var Pr=0;Pr<144;++Pr)Ll[Pr]=8;for(var Pr=144;Pr<256;++Pr)Ll[Pr]=9;for(var Pr=256;Pr<280;++Pr)Ll[Pr]=7;for(var Pr=280;Pr<288;++Pr)Ll[Pr]=8;var jd=new Ii(32);for(var Pr=0;Pr<32;++Pr)jd[Pr]=5;var rK=yf(Ll,9,0),nK=yf(jd,5,0),gE=function(e){return(e+7)/8|0},aK=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new Ii(e.subarray(t,r))},bs=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},ef=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},n1=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var a=r.length,i=r.slice();if(!a)return{t:vE,l:0};if(a==1){var s=new Ii(r[0].s+1);return s[r[0].s]=1,{t:s,l:1}}r.sort(function(A,M){return A.f-M.f}),r.push({s:-1,f:25001});var o=r[0],l=r[1],c=0,f=1,h=2;for(r[0]={s:-1,f:o.f+l.f,l:o,r:l};f!=a-1;)o=r[r[c].f<r[h].f?c++:h++],l=r[c!=f&&r[c].f<r[h].f?c++:h++],r[f++]={s:-1,f:o.f+l.f,l:o,r:l};for(var p=i[0].s,n=1;n<a;++n)i[n].s>p&&(p=i[n].s);var d=new Ha(p+1),x=Pg(r[f-1],d,0);if(x>t){var n=0,g=0,y=x-t,b=1<<y;for(i.sort(function(M,O){return d[O.s]-d[M.s]||M.f-O.f});n<a;++n){var T=i[n].s;if(d[T]>t)g+=b-(1<<x-d[T]),d[T]=t;else break}for(g>>=y;g>0;){var S=i[n].s;d[S]<t?g-=1<<t-d[S]++-1:++n}for(;n>=0&&g;--n){var k=i[n].s;d[k]==t&&(--d[k],++g)}x=t}return{t:new Ii(d),l:x}},Pg=function(e,t,r){return e.s==-1?Math.max(Pg(e.l,t,r+1),Pg(e.r,t,r+1)):t[e.s]=r},Tw=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new Ha(++t),n=0,a=e[0],i=1,s=function(l){r[n++]=l},o=1;o<=t;++o)if(e[o]==a&&o!=t)++i;else{if(!a&&i>2){for(;i>138;i-=138)s(32754);i>2&&(s(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(s(a),--i;i>6;i-=6)s(8304);i>2&&(s(i-3<<5|8208),i=0)}for(;i--;)s(a);i=1,a=e[o]}return{c:r.subarray(0,n),n:t}},tf=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},xE=function(e,t,r){var n=r.length,a=gE(t+2);e[a]=n&255,e[a+1]=n>>8,e[a+2]=e[a]^255,e[a+3]=e[a+1]^255;for(var i=0;i<n;++i)e[a+i+4]=r[i];return(a+4+n)*8},jw=function(e,t,r,n,a,i,s,o,l,c,f){bs(t,f++,r),++a[256];for(var h=n1(a,15),p=h.t,d=h.l,x=n1(i,15),g=x.t,y=x.l,b=Tw(p),T=b.c,S=b.n,k=Tw(g),A=k.c,M=k.n,O=new Ha(19),I=0;I<T.length;++I)++O[T[I]&31];for(var I=0;I<A.length;++I)++O[A[I]&31];for(var j=n1(O,7),W=j.t,E=j.l,C=19;C>4&&!W[Aw[C-1]];--C);var G=c+5<<3,Z=tf(a,Ll)+tf(i,jd)+s,he=tf(a,p)+tf(i,g)+s+14+3*C+tf(O,W)+2*O[16]+3*O[17]+7*O[18];if(l>=0&&G<=Z&&G<=he)return xE(t,f,e.subarray(l,l+c));var oe,me,pe,ge;if(bs(t,f,1+(he<Z)),f+=2,he<Z){oe=yf(p,d,0),me=p,pe=yf(g,y,0),ge=g;var Le=yf(W,E,0);bs(t,f,S-257),bs(t,f+5,M-1),bs(t,f+10,C-4),f+=14;for(var I=0;I<C;++I)bs(t,f+3*I,W[Aw[I]]);f+=3*C;for(var Se=[T,A],N=0;N<2;++N)for(var D=Se[N],I=0;I<D.length;++I){var L=D[I]&31;bs(t,f,Le[L]),f+=W[L],L>15&&(bs(t,f,D[I]>>5&127),f+=D[I]>>12)}}else oe=rK,me=Ll,pe=nK,ge=jd;for(var I=0;I<o;++I){var F=n[I];if(F>255){var L=F>>18&31;ef(t,f,oe[L+257]),f+=me[L+257],L>7&&(bs(t,f,F>>23&31),f+=n2[L]);var K=F&31;ef(t,f,pe[K]),f+=ge[K],K>3&&(ef(t,f,F>>5&8191),f+=a2[K])}else ef(t,f,oe[F]),f+=me[F]}return ef(t,f,oe[256]),f+me[256]},iK=new r2([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),vE=new Ii(0),sK=function(e,t,r,n,a,i){var s=i.z||e.length,o=new Ii(n+s+5*(1+Math.ceil(s/7e3))+a),l=o.subarray(n,o.length-a),c=i.l,f=(i.r||0)&7;if(t){f&&(l[0]=i.r>>3);for(var h=iK[t-1],p=h>>13,d=h&8191,x=(1<<r)-1,g=i.p||new Ha(32768),y=i.h||new Ha(x+1),b=Math.ceil(r/3),T=2*b,S=function(ye){return(e[ye]^e[ye+1]<<b^e[ye+2]<<T)&x},k=new r2(25e3),A=new Ha(288),M=new Ha(32),O=0,I=0,j=i.i||0,W=0,E=i.w||0,C=0;j+2<s;++j){var G=S(j),Z=j&32767,he=y[G];if(g[Z]=he,y[G]=Z,E<=j){var oe=s-j;if((O>7e3||W>24576)&&(oe>423||!c)){f=jw(e,l,0,k,A,M,I,W,C,j-C,f),W=O=I=0,C=j;for(var me=0;me<286;++me)A[me]=0;for(var me=0;me<30;++me)M[me]=0}var pe=2,ge=0,Le=d,Se=Z-he&32767;if(oe>2&&G==S(j-Se))for(var N=Math.min(p,oe)-1,D=Math.min(32767,j),L=Math.min(258,oe);Se<=D&&--Le&&Z!=he;){if(e[j+pe]==e[j+pe-Se]){for(var F=0;F<L&&e[j+F]==e[j+F-Se];++F);if(F>pe){if(pe=F,ge=Se,F>N)break;for(var K=Math.min(Se,F-2),ce=0,me=0;me<K;++me){var xe=j-Se+me&32767,ee=g[xe],fe=xe-ee&32767;fe>ce&&(ce=fe,he=xe)}}}Z=he,he=g[Z],Se+=Z-he&32767}if(ge){k[W++]=268435456|Tg[pe]<<18|Ew[ge];var le=Tg[pe]&31,ue=Ew[ge]&31;I+=n2[le]+a2[ue],++A[257+le],++M[ue],E=j+pe,++O}else k[W++]=e[j],++A[e[j]]}}for(j=Math.max(j,E);j<s;++j)k[W++]=e[j],++A[e[j]];f=jw(e,l,c,k,A,M,I,W,C,j-C,f),c||(i.r=f&7|l[f/8|0]<<3,f-=7,i.h=y,i.p=g,i.i=j,i.w=E)}else{for(var j=i.w||0;j<s+c;j+=65535){var $e=j+65535;$e>=s&&(l[f/8|0]=c,$e=s),f=xE(l,f+1,e.subarray(j,$e))}i.i=s}return aK(o,0,n+gE(f)+a)},yE=function(){var e=1,t=0;return{p:function(r){for(var n=e,a=t,i=r.length|0,s=0;s!=i;){for(var o=Math.min(s+2655,i);s<o;++s)a+=n+=r[s];n=(n&65535)+15*(n>>16),a=(a&65535)+15*(a>>16)}e=n,t=a},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},oK=function(e,t,r,n,a){if(!a&&(a={l:1},t.dictionary)){var i=t.dictionary.subarray(-32768),s=new Ii(i.length+e.length);s.set(i),s.set(e,i.length),e=s,a.w=i.length}return sK(e,t.level==null?6:t.level,t.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,a)},bE=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},lK=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var a=yE();a.p(t.dictionary),bE(e,2,a.d())}};function kg(e,t){t||(t={});var r=yE();r.p(e);var n=oK(e,t,t.dictionary?6:2,4);return lK(n,t),bE(n,n.length-4,r.d()),n}var cK=typeof TextDecoder<"u"&&new TextDecoder,uK=0;try{cK.decode(vE,{stream:!0}),uK=1}catch{}function fK(e){if(Array.isArray(e))return e}function hK(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],l=!0,c=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(l=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(f){c=!0,a=f}finally{try{if(!l&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw a}}return o}}function Pw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function dK(e,t){if(e){if(typeof e=="string")return Pw(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Pw(e,t):void 0}}function pK(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function kw(e,t){return fK(e)||hK(e,t)||dK(e,t)||pK()}function Cw(e,t="utf8"){return new TextDecoder(t).decode(e)}const mK=new TextEncoder;function gK(e){return mK.encode(e)}const xK=1024*8,vK=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),a1={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class i2{constructor(t=xK,r={}){rr(this,"buffer");rr(this,"byteLength");rr(this,"byteOffset");rr(this,"length");rr(this,"offset");rr(this,"lastWrittenByte");rr(this,"littleEndian");rr(this,"_data");rr(this,"_mark");rr(this,"_marks");let n=!1;typeof t=="number"?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const a=r.offset?r.offset>>>0:0,i=t.byteLength-a;let s=a;(ArrayBuffer.isView(t)||t instanceof i2)&&(t.byteLength!==t.buffer.byteLength&&(s=t.byteOffset+a),t=t.buffer),n?this.lastWrittenByte=i:this.lastWrittenByte=0,this.buffer=t,this.length=i,this.byteLength=i,this.byteOffset=s,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,s,i),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const n=(this.offset+t)*2,a=new Uint8Array(n);a.set(new Uint8Array(this.buffer)),this.buffer=a.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const n=a1[r].BYTES_PER_ELEMENT*t,a=this.byteOffset+this.offset,i=this.buffer.slice(a,a+n);if(this.littleEndian===vK&&r!=="uint8"&&r!=="int8"){const o=new Uint8Array(this.buffer.slice(a,a+n));o.reverse();const l=new a1[r](o.buffer);return this.offset+=n,l.reverse(),l}const s=new a1[r](i);return this.offset+=n,s}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let n=0;n<t;n++)r+=this.readChar();return r}readUtf8(t=1){return Cw(this.readBytes(t))}decodeText(t=1,r="utf8"){return Cw(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(gK(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const yK=4,Ow=0,Lw=1,bK=2;function pu(e){let t=e.length;for(;--t>=0;)e[t]=0}const wK=0,wE=1,_K=2,NK=3,SK=258,s2=29,v0=256,qf=v0+1+s2,Oc=30,o2=19,_E=2*qf+1,fl=15,i1=16,AK=7,l2=256,NE=16,SE=17,AE=18,Cg=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Ah=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),EK=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),EE=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),TK=512,_s=new Array((qf+2)*2);pu(_s);const bf=new Array(Oc*2);pu(bf);const Wf=new Array(TK);pu(Wf);const Hf=new Array(SK-NK+1);pu(Hf);const c2=new Array(s2);pu(c2);const Pd=new Array(Oc);pu(Pd);function s1(e,t,r,n,a){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=a,this.has_stree=e&&e.length}let TE,jE,PE;function o1(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}const kE=e=>e<256?Wf[e]:Wf[256+(e>>>7)],Gf=(e,t)=>{e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255},Na=(e,t,r)=>{e.bi_valid>i1-r?(e.bi_buf|=t<<e.bi_valid&65535,Gf(e,e.bi_buf),e.bi_buf=t>>i1-e.bi_valid,e.bi_valid+=r-i1):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},Qi=(e,t,r)=>{Na(e,r[t*2],r[t*2+1])},CE=(e,t)=>{let r=0;do r|=e&1,e>>>=1,r<<=1;while(--t>0);return r>>>1},jK=e=>{e.bi_valid===16?(Gf(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},PK=(e,t)=>{const r=t.dyn_tree,n=t.max_code,a=t.stat_desc.static_tree,i=t.stat_desc.has_stree,s=t.stat_desc.extra_bits,o=t.stat_desc.extra_base,l=t.stat_desc.max_length;let c,f,h,p,d,x,g=0;for(p=0;p<=fl;p++)e.bl_count[p]=0;for(r[e.heap[e.heap_max]*2+1]=0,c=e.heap_max+1;c<_E;c++)f=e.heap[c],p=r[r[f*2+1]*2+1]+1,p>l&&(p=l,g++),r[f*2+1]=p,!(f>n)&&(e.bl_count[p]++,d=0,f>=o&&(d=s[f-o]),x=r[f*2],e.opt_len+=x*(p+d),i&&(e.static_len+=x*(a[f*2+1]+d)));if(g!==0){do{for(p=l-1;e.bl_count[p]===0;)p--;e.bl_count[p]--,e.bl_count[p+1]+=2,e.bl_count[l]--,g-=2}while(g>0);for(p=l;p!==0;p--)for(f=e.bl_count[p];f!==0;)h=e.heap[--c],!(h>n)&&(r[h*2+1]!==p&&(e.opt_len+=(p-r[h*2+1])*r[h*2],r[h*2+1]=p),f--)}},OE=(e,t,r)=>{const n=new Array(fl+1);let a=0,i,s;for(i=1;i<=fl;i++)a=a+r[i-1]<<1,n[i]=a;for(s=0;s<=t;s++){let o=e[s*2+1];o!==0&&(e[s*2]=CE(n[o]++,o))}},kK=()=>{let e,t,r,n,a;const i=new Array(fl+1);for(r=0,n=0;n<s2-1;n++)for(c2[n]=r,e=0;e<1<<Cg[n];e++)Hf[r++]=n;for(Hf[r-1]=n,a=0,n=0;n<16;n++)for(Pd[n]=a,e=0;e<1<<Ah[n];e++)Wf[a++]=n;for(a>>=7;n<Oc;n++)for(Pd[n]=a<<7,e=0;e<1<<Ah[n]-7;e++)Wf[256+a++]=n;for(t=0;t<=fl;t++)i[t]=0;for(e=0;e<=143;)_s[e*2+1]=8,e++,i[8]++;for(;e<=255;)_s[e*2+1]=9,e++,i[9]++;for(;e<=279;)_s[e*2+1]=7,e++,i[7]++;for(;e<=287;)_s[e*2+1]=8,e++,i[8]++;for(OE(_s,qf+1,i),e=0;e<Oc;e++)bf[e*2+1]=5,bf[e*2]=CE(e,5);TE=new s1(_s,Cg,v0+1,qf,fl),jE=new s1(bf,Ah,0,Oc,fl),PE=new s1(new Array(0),EK,0,o2,AK)},LE=e=>{let t;for(t=0;t<qf;t++)e.dyn_ltree[t*2]=0;for(t=0;t<Oc;t++)e.dyn_dtree[t*2]=0;for(t=0;t<o2;t++)e.bl_tree[t*2]=0;e.dyn_ltree[l2*2]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},FE=e=>{e.bi_valid>8?Gf(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Fw=(e,t,r,n)=>{const a=t*2,i=r*2;return e[a]<e[i]||e[a]===e[i]&&n[t]<=n[r]},l1=(e,t,r)=>{const n=e.heap[r];let a=r<<1;for(;a<=e.heap_len&&(a<e.heap_len&&Fw(t,e.heap[a+1],e.heap[a],e.depth)&&a++,!Fw(t,n,e.heap[a],e.depth));)e.heap[r]=e.heap[a],r=a,a<<=1;e.heap[r]=n},Dw=(e,t,r)=>{let n,a,i=0,s,o;if(e.sym_next!==0)do n=e.pending_buf[e.sym_buf+i++]&255,n+=(e.pending_buf[e.sym_buf+i++]&255)<<8,a=e.pending_buf[e.sym_buf+i++],n===0?Qi(e,a,t):(s=Hf[a],Qi(e,s+v0+1,t),o=Cg[s],o!==0&&(a-=c2[s],Na(e,a,o)),n--,s=kE(n),Qi(e,s,r),o=Ah[s],o!==0&&(n-=Pd[s],Na(e,n,o)));while(i<e.sym_next);Qi(e,l2,t)},Og=(e,t)=>{const r=t.dyn_tree,n=t.stat_desc.static_tree,a=t.stat_desc.has_stree,i=t.stat_desc.elems;let s,o,l=-1,c;for(e.heap_len=0,e.heap_max=_E,s=0;s<i;s++)r[s*2]!==0?(e.heap[++e.heap_len]=l=s,e.depth[s]=0):r[s*2+1]=0;for(;e.heap_len<2;)c=e.heap[++e.heap_len]=l<2?++l:0,r[c*2]=1,e.depth[c]=0,e.opt_len--,a&&(e.static_len-=n[c*2+1]);for(t.max_code=l,s=e.heap_len>>1;s>=1;s--)l1(e,r,s);c=i;do s=e.heap[1],e.heap[1]=e.heap[e.heap_len--],l1(e,r,1),o=e.heap[1],e.heap[--e.heap_max]=s,e.heap[--e.heap_max]=o,r[c*2]=r[s*2]+r[o*2],e.depth[c]=(e.depth[s]>=e.depth[o]?e.depth[s]:e.depth[o])+1,r[s*2+1]=r[o*2+1]=c,e.heap[1]=c++,l1(e,r,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],PK(e,t),OE(r,l,e.bl_count)},Iw=(e,t,r)=>{let n,a=-1,i,s=t[0*2+1],o=0,l=7,c=4;for(s===0&&(l=138,c=3),t[(r+1)*2+1]=65535,n=0;n<=r;n++)i=s,s=t[(n+1)*2+1],!(++o<l&&i===s)&&(o<c?e.bl_tree[i*2]+=o:i!==0?(i!==a&&e.bl_tree[i*2]++,e.bl_tree[NE*2]++):o<=10?e.bl_tree[SE*2]++:e.bl_tree[AE*2]++,o=0,a=i,s===0?(l=138,c=3):i===s?(l=6,c=3):(l=7,c=4))},Mw=(e,t,r)=>{let n,a=-1,i,s=t[0*2+1],o=0,l=7,c=4;for(s===0&&(l=138,c=3),n=0;n<=r;n++)if(i=s,s=t[(n+1)*2+1],!(++o<l&&i===s)){if(o<c)do Qi(e,i,e.bl_tree);while(--o!==0);else i!==0?(i!==a&&(Qi(e,i,e.bl_tree),o--),Qi(e,NE,e.bl_tree),Na(e,o-3,2)):o<=10?(Qi(e,SE,e.bl_tree),Na(e,o-3,3)):(Qi(e,AE,e.bl_tree),Na(e,o-11,7));o=0,a=i,s===0?(l=138,c=3):i===s?(l=6,c=3):(l=7,c=4)}},CK=e=>{let t;for(Iw(e,e.dyn_ltree,e.l_desc.max_code),Iw(e,e.dyn_dtree,e.d_desc.max_code),Og(e,e.bl_desc),t=o2-1;t>=3&&e.bl_tree[EE[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t},OK=(e,t,r,n)=>{let a;for(Na(e,t-257,5),Na(e,r-1,5),Na(e,n-4,4),a=0;a<n;a++)Na(e,e.bl_tree[EE[a]*2+1],3);Mw(e,e.dyn_ltree,t-1),Mw(e,e.dyn_dtree,r-1)},LK=e=>{let t=4093624447,r;for(r=0;r<=31;r++,t>>>=1)if(t&1&&e.dyn_ltree[r*2]!==0)return Ow;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return Lw;for(r=32;r<v0;r++)if(e.dyn_ltree[r*2]!==0)return Lw;return Ow};let Rw=!1;const FK=e=>{Rw||(kK(),Rw=!0),e.l_desc=new o1(e.dyn_ltree,TE),e.d_desc=new o1(e.dyn_dtree,jE),e.bl_desc=new o1(e.bl_tree,PE),e.bi_buf=0,e.bi_valid=0,LE(e)},DE=(e,t,r,n)=>{Na(e,(wK<<1)+(n?1:0),3),FE(e),Gf(e,r),Gf(e,~r),r&&e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r},DK=e=>{Na(e,wE<<1,3),Qi(e,l2,_s),jK(e)},IK=(e,t,r,n)=>{let a,i,s=0;e.level>0?(e.strm.data_type===bK&&(e.strm.data_type=LK(e)),Og(e,e.l_desc),Og(e,e.d_desc),s=CK(e),a=e.opt_len+3+7>>>3,i=e.static_len+3+7>>>3,i<=a&&(a=i)):a=i=r+5,r+4<=a&&t!==-1?DE(e,t,r,n):e.strategy===yK||i===a?(Na(e,(wE<<1)+(n?1:0),3),Dw(e,_s,bf)):(Na(e,(_K<<1)+(n?1:0),3),OK(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),Dw(e,e.dyn_ltree,e.dyn_dtree)),LE(e),n&&FE(e)},MK=(e,t,r)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=r,t===0?e.dyn_ltree[r*2]++:(e.matches++,t--,e.dyn_ltree[(Hf[r]+v0+1)*2]++,e.dyn_dtree[kE(t)*2]++),e.sym_next===e.sym_end);var RK=FK,BK=DE,UK=IK,$K=MK,zK=DK,qK={_tr_init:RK,_tr_stored_block:BK,_tr_flush_block:UK,_tr_tally:$K,_tr_align:zK};const WK=(e,t,r,n)=>{let a=e&65535|0,i=e>>>16&65535|0,s=0;for(;r!==0;){s=r>2e3?2e3:r,r-=s;do a=a+t[n++]|0,i=i+a|0;while(--s);a%=65521,i%=65521}return a|i<<16|0};var Vf=WK;const HK=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},GK=new Uint32Array(HK()),VK=(e,t,r,n)=>{const a=GK,i=n+r;e^=-1;for(let s=n;s<i;s++)e=e>>>8^a[(e^t[s])&255];return e^-1};var wn=VK,Xc={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},y0={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:KK,_tr_stored_block:Lg,_tr_flush_block:YK,_tr_tally:Ao,_tr_align:XK}=qK,{Z_NO_FLUSH:Eo,Z_PARTIAL_FLUSH:ZK,Z_FULL_FLUSH:JK,Z_FINISH:ui,Z_BLOCK:Bw,Z_OK:Mn,Z_STREAM_END:Uw,Z_STREAM_ERROR:as,Z_DATA_ERROR:QK,Z_BUF_ERROR:c1,Z_DEFAULT_COMPRESSION:eY,Z_FILTERED:tY,Z_HUFFMAN_ONLY:dh,Z_RLE:rY,Z_FIXED:nY,Z_DEFAULT_STRATEGY:aY,Z_UNKNOWN:iY,Z_DEFLATED:Ip}=y0,sY=9,oY=15,lY=8,cY=29,uY=256,Fg=uY+1+cY,fY=30,hY=19,dY=2*Fg+1,pY=15,Gt=3,bo=258,is=bo+Gt+1,mY=32,Zc=42,u2=57,Dg=69,Ig=73,Mg=91,Rg=103,hl=113,cf=666,ua=1,mu=2,Fl=3,gu=4,gY=3,dl=(e,t)=>(e.msg=Xc[t],t),$w=e=>e*2-(e>4?9:0),xo=e=>{let t=e.length;for(;--t>=0;)e[t]=0},xY=e=>{let t,r,n,a=e.w_size;t=e.hash_size,n=t;do r=e.head[--n],e.head[n]=r>=a?r-a:0;while(--t);t=a,n=t;do r=e.prev[--n],e.prev[n]=r>=a?r-a:0;while(--t)};let vY=(e,t,r)=>(t<<e.hash_shift^r)&e.hash_mask,To=vY;const Ma=e=>{const t=e.state;let r=t.pending;r>e.avail_out&&(r=e.avail_out),r!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,t.pending===0&&(t.pending_out=0))},Ga=(e,t)=>{YK(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Ma(e.strm)},nr=(e,t)=>{e.pending_buf[e.pending++]=t},rf=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255},Bg=(e,t,r,n)=>{let a=e.avail_in;return a>n&&(a=n),a===0?0:(e.avail_in-=a,t.set(e.input.subarray(e.next_in,e.next_in+a),r),e.state.wrap===1?e.adler=Vf(e.adler,t,a,r):e.state.wrap===2&&(e.adler=wn(e.adler,t,a,r)),e.next_in+=a,e.total_in+=a,a)},IE=(e,t)=>{let r=e.max_chain_length,n=e.strstart,a,i,s=e.prev_length,o=e.nice_match;const l=e.strstart>e.w_size-is?e.strstart-(e.w_size-is):0,c=e.window,f=e.w_mask,h=e.prev,p=e.strstart+bo;let d=c[n+s-1],x=c[n+s];e.prev_length>=e.good_match&&(r>>=2),o>e.lookahead&&(o=e.lookahead);do if(a=t,!(c[a+s]!==x||c[a+s-1]!==d||c[a]!==c[n]||c[++a]!==c[n+1])){n+=2,a++;do;while(c[++n]===c[++a]&&c[++n]===c[++a]&&c[++n]===c[++a]&&c[++n]===c[++a]&&c[++n]===c[++a]&&c[++n]===c[++a]&&c[++n]===c[++a]&&c[++n]===c[++a]&&n<p);if(i=bo-(p-n),n=p-bo,i>s){if(e.match_start=t,s=i,i>=o)break;d=c[n+s-1],x=c[n+s]}}while((t=h[t&f])>l&&--r!==0);return s<=e.lookahead?s:e.lookahead},Jc=e=>{const t=e.w_size;let r,n,a;do{if(n=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-is)&&(e.window.set(e.window.subarray(t,t+t-n),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),xY(e),n+=t),e.strm.avail_in===0)break;if(r=Bg(e.strm,e.window,e.strstart+e.lookahead,n),e.lookahead+=r,e.lookahead+e.insert>=Gt)for(a=e.strstart-e.insert,e.ins_h=e.window[a],e.ins_h=To(e,e.ins_h,e.window[a+1]);e.insert&&(e.ins_h=To(e,e.ins_h,e.window[a+Gt-1]),e.prev[a&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=a,a++,e.insert--,!(e.lookahead+e.insert<Gt)););}while(e.lookahead<is&&e.strm.avail_in!==0)},ME=(e,t)=>{let r=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,n,a,i,s=0,o=e.strm.avail_in;do{if(n=65535,i=e.bi_valid+42>>3,e.strm.avail_out<i||(i=e.strm.avail_out-i,a=e.strstart-e.block_start,n>a+e.strm.avail_in&&(n=a+e.strm.avail_in),n>i&&(n=i),n<r&&(n===0&&t!==ui||t===Eo||n!==a+e.strm.avail_in)))break;s=t===ui&&n===a+e.strm.avail_in?1:0,Lg(e,0,0,s),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,Ma(e.strm),a&&(a>n&&(a=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+a),e.strm.next_out),e.strm.next_out+=a,e.strm.avail_out-=a,e.strm.total_out+=a,e.block_start+=a,n-=a),n&&(Bg(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(s===0);return o-=e.strm.avail_in,o&&(o>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=o&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-o,e.strm.next_in),e.strstart),e.strstart+=o,e.insert+=o>e.w_size-e.insert?e.w_size-e.insert:o),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),s?gu:t!==Eo&&t!==ui&&e.strm.avail_in===0&&e.strstart===e.block_start?mu:(i=e.window_size-e.strstart,e.strm.avail_in>i&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,i+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),i>e.strm.avail_in&&(i=e.strm.avail_in),i&&(Bg(e.strm,e.window,e.strstart,i),e.strstart+=i,e.insert+=i>e.w_size-e.insert?e.w_size-e.insert:i),e.high_water<e.strstart&&(e.high_water=e.strstart),i=e.bi_valid+42>>3,i=e.pending_buf_size-i>65535?65535:e.pending_buf_size-i,r=i>e.w_size?e.w_size:i,a=e.strstart-e.block_start,(a>=r||(a||t===ui)&&t!==Eo&&e.strm.avail_in===0&&a<=i)&&(n=a>i?i:a,s=t===ui&&e.strm.avail_in===0&&n===a?1:0,Lg(e,e.block_start,n,s),e.block_start+=n,Ma(e.strm)),s?Fl:ua)},u1=(e,t)=>{let r,n;for(;;){if(e.lookahead<is){if(Jc(e),e.lookahead<is&&t===Eo)return ua;if(e.lookahead===0)break}if(r=0,e.lookahead>=Gt&&(e.ins_h=To(e,e.ins_h,e.window[e.strstart+Gt-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),r!==0&&e.strstart-r<=e.w_size-is&&(e.match_length=IE(e,r)),e.match_length>=Gt)if(n=Ao(e,e.strstart-e.match_start,e.match_length-Gt),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=Gt){e.match_length--;do e.strstart++,e.ins_h=To(e,e.ins_h,e.window[e.strstart+Gt-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=To(e,e.ins_h,e.window[e.strstart+1]);else n=Ao(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(Ga(e,!1),e.strm.avail_out===0))return ua}return e.insert=e.strstart<Gt-1?e.strstart:Gt-1,t===ui?(Ga(e,!0),e.strm.avail_out===0?Fl:gu):e.sym_next&&(Ga(e,!1),e.strm.avail_out===0)?ua:mu},uc=(e,t)=>{let r,n,a;for(;;){if(e.lookahead<is){if(Jc(e),e.lookahead<is&&t===Eo)return ua;if(e.lookahead===0)break}if(r=0,e.lookahead>=Gt&&(e.ins_h=To(e,e.ins_h,e.window[e.strstart+Gt-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=Gt-1,r!==0&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-is&&(e.match_length=IE(e,r),e.match_length<=5&&(e.strategy===tY||e.match_length===Gt&&e.strstart-e.match_start>4096)&&(e.match_length=Gt-1)),e.prev_length>=Gt&&e.match_length<=e.prev_length){a=e.strstart+e.lookahead-Gt,n=Ao(e,e.strstart-1-e.prev_match,e.prev_length-Gt),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=a&&(e.ins_h=To(e,e.ins_h,e.window[e.strstart+Gt-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=Gt-1,e.strstart++,n&&(Ga(e,!1),e.strm.avail_out===0))return ua}else if(e.match_available){if(n=Ao(e,0,e.window[e.strstart-1]),n&&Ga(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return ua}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=Ao(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<Gt-1?e.strstart:Gt-1,t===ui?(Ga(e,!0),e.strm.avail_out===0?Fl:gu):e.sym_next&&(Ga(e,!1),e.strm.avail_out===0)?ua:mu},yY=(e,t)=>{let r,n,a,i;const s=e.window;for(;;){if(e.lookahead<=bo){if(Jc(e),e.lookahead<=bo&&t===Eo)return ua;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=Gt&&e.strstart>0&&(a=e.strstart-1,n=s[a],n===s[++a]&&n===s[++a]&&n===s[++a])){i=e.strstart+bo;do;while(n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&a<i);e.match_length=bo-(i-a),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=Gt?(r=Ao(e,1,e.match_length-Gt),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=Ao(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(Ga(e,!1),e.strm.avail_out===0))return ua}return e.insert=0,t===ui?(Ga(e,!0),e.strm.avail_out===0?Fl:gu):e.sym_next&&(Ga(e,!1),e.strm.avail_out===0)?ua:mu},bY=(e,t)=>{let r;for(;;){if(e.lookahead===0&&(Jc(e),e.lookahead===0)){if(t===Eo)return ua;break}if(e.match_length=0,r=Ao(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(Ga(e,!1),e.strm.avail_out===0))return ua}return e.insert=0,t===ui?(Ga(e,!0),e.strm.avail_out===0?Fl:gu):e.sym_next&&(Ga(e,!1),e.strm.avail_out===0)?ua:mu};function Yi(e,t,r,n,a){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=a}const uf=[new Yi(0,0,0,0,ME),new Yi(4,4,8,4,u1),new Yi(4,5,16,8,u1),new Yi(4,6,32,32,u1),new Yi(4,4,16,16,uc),new Yi(8,16,32,32,uc),new Yi(8,16,128,128,uc),new Yi(8,32,128,256,uc),new Yi(32,128,258,1024,uc),new Yi(32,258,258,4096,uc)],wY=e=>{e.window_size=2*e.w_size,xo(e.head),e.max_lazy_match=uf[e.level].max_lazy,e.good_match=uf[e.level].good_length,e.nice_match=uf[e.level].nice_length,e.max_chain_length=uf[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=Gt-1,e.match_available=0,e.ins_h=0};function _Y(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Ip,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(dY*2),this.dyn_dtree=new Uint16Array((2*fY+1)*2),this.bl_tree=new Uint16Array((2*hY+1)*2),xo(this.dyn_ltree),xo(this.dyn_dtree),xo(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(pY+1),this.heap=new Uint16Array(2*Fg+1),xo(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Fg+1),xo(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const b0=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==Zc&&t.status!==u2&&t.status!==Dg&&t.status!==Ig&&t.status!==Mg&&t.status!==Rg&&t.status!==hl&&t.status!==cf?1:0},RE=e=>{if(b0(e))return dl(e,as);e.total_in=e.total_out=0,e.data_type=iY;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap===2?u2:t.wrap?Zc:hl,e.adler=t.wrap===2?0:1,t.last_flush=-2,KK(t),Mn},BE=e=>{const t=RE(e);return t===Mn&&wY(e.state),t},NY=(e,t)=>b0(e)||e.state.wrap!==2?as:(e.state.gzhead=t,Mn),UE=(e,t,r,n,a,i)=>{if(!e)return as;let s=1;if(t===eY&&(t=6),n<0?(s=0,n=-n):n>15&&(s=2,n-=16),a<1||a>sY||r!==Ip||n<8||n>15||t<0||t>9||i<0||i>nY||n===8&&s!==1)return dl(e,as);n===8&&(n=9);const o=new _Y;return e.state=o,o.strm=e,o.status=Zc,o.wrap=s,o.gzhead=null,o.w_bits=n,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=a+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+Gt-1)/Gt),o.window=new Uint8Array(o.w_size*2),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<a+6,o.pending_buf_size=o.lit_bufsize*4,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=(o.lit_bufsize-1)*3,o.level=t,o.strategy=i,o.method=r,BE(e)},SY=(e,t)=>UE(e,t,Ip,oY,lY,aY),AY=(e,t)=>{if(b0(e)||t>Bw||t<0)return e?dl(e,as):as;const r=e.state;if(!e.output||e.avail_in!==0&&!e.input||r.status===cf&&t!==ui)return dl(e,e.avail_out===0?c1:as);const n=r.last_flush;if(r.last_flush=t,r.pending!==0){if(Ma(e),e.avail_out===0)return r.last_flush=-1,Mn}else if(e.avail_in===0&&$w(t)<=$w(n)&&t!==ui)return dl(e,c1);if(r.status===cf&&e.avail_in!==0)return dl(e,c1);if(r.status===Zc&&r.wrap===0&&(r.status=hl),r.status===Zc){let a=Ip+(r.w_bits-8<<4)<<8,i=-1;if(r.strategy>=dh||r.level<2?i=0:r.level<6?i=1:r.level===6?i=2:i=3,a|=i<<6,r.strstart!==0&&(a|=mY),a+=31-a%31,rf(r,a),r.strstart!==0&&(rf(r,e.adler>>>16),rf(r,e.adler&65535)),e.adler=1,r.status=hl,Ma(e),r.pending!==0)return r.last_flush=-1,Mn}if(r.status===u2){if(e.adler=0,nr(r,31),nr(r,139),nr(r,8),r.gzhead)nr(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),nr(r,r.gzhead.time&255),nr(r,r.gzhead.time>>8&255),nr(r,r.gzhead.time>>16&255),nr(r,r.gzhead.time>>24&255),nr(r,r.level===9?2:r.strategy>=dh||r.level<2?4:0),nr(r,r.gzhead.os&255),r.gzhead.extra&&r.gzhead.extra.length&&(nr(r,r.gzhead.extra.length&255),nr(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=wn(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=Dg;else if(nr(r,0),nr(r,0),nr(r,0),nr(r,0),nr(r,0),nr(r,r.level===9?2:r.strategy>=dh||r.level<2?4:0),nr(r,gY),r.status=hl,Ma(e),r.pending!==0)return r.last_flush=-1,Mn}if(r.status===Dg){if(r.gzhead.extra){let a=r.pending,i=(r.gzhead.extra.length&65535)-r.gzindex;for(;r.pending+i>r.pending_buf_size;){let o=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+o),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>a&&(e.adler=wn(e.adler,r.pending_buf,r.pending-a,a)),r.gzindex+=o,Ma(e),r.pending!==0)return r.last_flush=-1,Mn;a=0,i-=o}let s=new Uint8Array(r.gzhead.extra);r.pending_buf.set(s.subarray(r.gzindex,r.gzindex+i),r.pending),r.pending+=i,r.gzhead.hcrc&&r.pending>a&&(e.adler=wn(e.adler,r.pending_buf,r.pending-a,a)),r.gzindex=0}r.status=Ig}if(r.status===Ig){if(r.gzhead.name){let a=r.pending,i;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>a&&(e.adler=wn(e.adler,r.pending_buf,r.pending-a,a)),Ma(e),r.pending!==0)return r.last_flush=-1,Mn;a=0}r.gzindex<r.gzhead.name.length?i=r.gzhead.name.charCodeAt(r.gzindex++)&255:i=0,nr(r,i)}while(i!==0);r.gzhead.hcrc&&r.pending>a&&(e.adler=wn(e.adler,r.pending_buf,r.pending-a,a)),r.gzindex=0}r.status=Mg}if(r.status===Mg){if(r.gzhead.comment){let a=r.pending,i;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>a&&(e.adler=wn(e.adler,r.pending_buf,r.pending-a,a)),Ma(e),r.pending!==0)return r.last_flush=-1,Mn;a=0}r.gzindex<r.gzhead.comment.length?i=r.gzhead.comment.charCodeAt(r.gzindex++)&255:i=0,nr(r,i)}while(i!==0);r.gzhead.hcrc&&r.pending>a&&(e.adler=wn(e.adler,r.pending_buf,r.pending-a,a))}r.status=Rg}if(r.status===Rg){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(Ma(e),r.pending!==0))return r.last_flush=-1,Mn;nr(r,e.adler&255),nr(r,e.adler>>8&255),e.adler=0}if(r.status=hl,Ma(e),r.pending!==0)return r.last_flush=-1,Mn}if(e.avail_in!==0||r.lookahead!==0||t!==Eo&&r.status!==cf){let a=r.level===0?ME(r,t):r.strategy===dh?bY(r,t):r.strategy===rY?yY(r,t):uf[r.level].func(r,t);if((a===Fl||a===gu)&&(r.status=cf),a===ua||a===Fl)return e.avail_out===0&&(r.last_flush=-1),Mn;if(a===mu&&(t===ZK?XK(r):t!==Bw&&(Lg(r,0,0,!1),t===JK&&(xo(r.head),r.lookahead===0&&(r.strstart=0,r.block_start=0,r.insert=0))),Ma(e),e.avail_out===0))return r.last_flush=-1,Mn}return t!==ui?Mn:r.wrap<=0?Uw:(r.wrap===2?(nr(r,e.adler&255),nr(r,e.adler>>8&255),nr(r,e.adler>>16&255),nr(r,e.adler>>24&255),nr(r,e.total_in&255),nr(r,e.total_in>>8&255),nr(r,e.total_in>>16&255),nr(r,e.total_in>>24&255)):(rf(r,e.adler>>>16),rf(r,e.adler&65535)),Ma(e),r.wrap>0&&(r.wrap=-r.wrap),r.pending!==0?Mn:Uw)},EY=e=>{if(b0(e))return as;const t=e.state.status;return e.state=null,t===hl?dl(e,QK):Mn},TY=(e,t)=>{let r=t.length;if(b0(e))return as;const n=e.state,a=n.wrap;if(a===2||a===1&&n.status!==Zc||n.lookahead)return as;if(a===1&&(e.adler=Vf(e.adler,t,r,0)),n.wrap=0,r>=n.w_size){a===0&&(xo(n.head),n.strstart=0,n.block_start=0,n.insert=0);let l=new Uint8Array(n.w_size);l.set(t.subarray(r-n.w_size,r),0),t=l,r=n.w_size}const i=e.avail_in,s=e.next_in,o=e.input;for(e.avail_in=r,e.next_in=0,e.input=t,Jc(n);n.lookahead>=Gt;){let l=n.strstart,c=n.lookahead-(Gt-1);do n.ins_h=To(n,n.ins_h,n.window[l+Gt-1]),n.prev[l&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=l,l++;while(--c);n.strstart=l,n.lookahead=Gt-1,Jc(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=Gt-1,n.match_available=0,e.next_in=s,e.input=o,e.avail_in=i,n.wrap=a,Mn};var jY=SY,PY=UE,kY=BE,CY=RE,OY=NY,LY=AY,FY=EY,DY=TY,IY="pako deflate (from Nodeca project)",wf={deflateInit:jY,deflateInit2:PY,deflateReset:kY,deflateResetKeep:CY,deflateSetHeader:OY,deflate:LY,deflateEnd:FY,deflateSetDictionary:DY,deflateInfo:IY};const MY=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var RY=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)MY(r,n)&&(e[n]=r[n])}}return e},BY=e=>{let t=0;for(let n=0,a=e.length;n<a;n++)t+=e[n].length;const r=new Uint8Array(t);for(let n=0,a=0,i=e.length;n<i;n++){let s=e[n];r.set(s,a),a+=s.length}return r},Mp={assign:RY,flattenChunks:BY};let $E=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{$E=!1}const Kf=new Uint8Array(256);for(let e=0;e<256;e++)Kf[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Kf[254]=Kf[254]=1;var UY=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,n,a,i,s=e.length,o=0;for(a=0;a<s;a++)r=e.charCodeAt(a),(r&64512)===55296&&a+1<s&&(n=e.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),o+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(o),i=0,a=0;i<o;a++)r=e.charCodeAt(a),(r&64512)===55296&&a+1<s&&(n=e.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),r<128?t[i++]=r:r<2048?(t[i++]=192|r>>>6,t[i++]=128|r&63):r<65536?(t[i++]=224|r>>>12,t[i++]=128|r>>>6&63,t[i++]=128|r&63):(t[i++]=240|r>>>18,t[i++]=128|r>>>12&63,t[i++]=128|r>>>6&63,t[i++]=128|r&63);return t};const $Y=(e,t)=>{if(t<65534&&e.subarray&&$E)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r};var zY=(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let n,a;const i=new Array(r*2);for(a=0,n=0;n<r;){let s=e[n++];if(s<128){i[a++]=s;continue}let o=Kf[s];if(o>4){i[a++]=65533,n+=o-1;continue}for(s&=o===2?31:o===3?15:7;o>1&&n<r;)s=s<<6|e[n++]&63,o--;if(o>1){i[a++]=65533;continue}s<65536?i[a++]=s:(s-=65536,i[a++]=55296|s>>10&1023,i[a++]=56320|s&1023)}return $Y(i,a)},qY=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+Kf[e[r]]>t?r:t},Yf={string2buf:UY,buf2string:zY,utf8border:qY};function WY(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var zE=WY;const qE=Object.prototype.toString,{Z_NO_FLUSH:HY,Z_SYNC_FLUSH:GY,Z_FULL_FLUSH:VY,Z_FINISH:KY,Z_OK:kd,Z_STREAM_END:YY,Z_DEFAULT_COMPRESSION:XY,Z_DEFAULT_STRATEGY:ZY,Z_DEFLATED:JY}=y0;function f2(e){this.options=Mp.assign({level:XY,method:JY,chunkSize:16384,windowBits:15,memLevel:8,strategy:ZY},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zE,this.strm.avail_out=0;let r=wf.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==kd)throw new Error(Xc[r]);if(t.header&&wf.deflateSetHeader(this.strm,t.header),t.dictionary){let n;if(typeof t.dictionary=="string"?n=Yf.string2buf(t.dictionary):qE.call(t.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(t.dictionary):n=t.dictionary,r=wf.deflateSetDictionary(this.strm,n),r!==kd)throw new Error(Xc[r]);this._dict_set=!0}}f2.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize;let a,i;if(this.ended)return!1;for(t===~~t?i=t:i=t===!0?KY:HY,typeof e=="string"?r.input=Yf.string2buf(e):qE.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){if(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(i===GY||i===VY)&&r.avail_out<=6){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(a=wf.deflate(r,i),a===YY)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),a=wf.deflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===kd;if(r.avail_out===0){this.onData(r.output);continue}if(i>0&&r.next_out>0){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(r.avail_in===0)break}return!0};f2.prototype.onData=function(e){this.chunks.push(e)};f2.prototype.onEnd=function(e){e===kd&&(this.result=Mp.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};const ph=16209,QY=16191;var eX=function(t,r){let n,a,i,s,o,l,c,f,h,p,d,x,g,y,b,T,S,k,A,M,O,I,j,W;const E=t.state;n=t.next_in,j=t.input,a=n+(t.avail_in-5),i=t.next_out,W=t.output,s=i-(r-t.avail_out),o=i+(t.avail_out-257),l=E.dmax,c=E.wsize,f=E.whave,h=E.wnext,p=E.window,d=E.hold,x=E.bits,g=E.lencode,y=E.distcode,b=(1<<E.lenbits)-1,T=(1<<E.distbits)-1;e:do{x<15&&(d+=j[n++]<<x,x+=8,d+=j[n++]<<x,x+=8),S=g[d&b];t:for(;;){if(k=S>>>24,d>>>=k,x-=k,k=S>>>16&255,k===0)W[i++]=S&65535;else if(k&16){A=S&65535,k&=15,k&&(x<k&&(d+=j[n++]<<x,x+=8),A+=d&(1<<k)-1,d>>>=k,x-=k),x<15&&(d+=j[n++]<<x,x+=8,d+=j[n++]<<x,x+=8),S=y[d&T];r:for(;;){if(k=S>>>24,d>>>=k,x-=k,k=S>>>16&255,k&16){if(M=S&65535,k&=15,x<k&&(d+=j[n++]<<x,x+=8,x<k&&(d+=j[n++]<<x,x+=8)),M+=d&(1<<k)-1,M>l){t.msg="invalid distance too far back",E.mode=ph;break e}if(d>>>=k,x-=k,k=i-s,M>k){if(k=M-k,k>f&&E.sane){t.msg="invalid distance too far back",E.mode=ph;break e}if(O=0,I=p,h===0){if(O+=c-k,k<A){A-=k;do W[i++]=p[O++];while(--k);O=i-M,I=W}}else if(h<k){if(O+=c+h-k,k-=h,k<A){A-=k;do W[i++]=p[O++];while(--k);if(O=0,h<A){k=h,A-=k;do W[i++]=p[O++];while(--k);O=i-M,I=W}}}else if(O+=h-k,k<A){A-=k;do W[i++]=p[O++];while(--k);O=i-M,I=W}for(;A>2;)W[i++]=I[O++],W[i++]=I[O++],W[i++]=I[O++],A-=3;A&&(W[i++]=I[O++],A>1&&(W[i++]=I[O++]))}else{O=i-M;do W[i++]=W[O++],W[i++]=W[O++],W[i++]=W[O++],A-=3;while(A>2);A&&(W[i++]=W[O++],A>1&&(W[i++]=W[O++]))}}else if(k&64){t.msg="invalid distance code",E.mode=ph;break e}else{S=y[(S&65535)+(d&(1<<k)-1)];continue r}break}}else if(k&64)if(k&32){E.mode=QY;break e}else{t.msg="invalid literal/length code",E.mode=ph;break e}else{S=g[(S&65535)+(d&(1<<k)-1)];continue t}break}}while(n<a&&i<o);A=x>>3,n-=A,x-=A<<3,d&=(1<<x)-1,t.next_in=n,t.next_out=i,t.avail_in=n<a?5+(a-n):5-(n-a),t.avail_out=i<o?257+(o-i):257-(i-o),E.hold=d,E.bits=x};const fc=15,zw=852,qw=592,Ww=0,f1=1,Hw=2,tX=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),rX=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),nX=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),aX=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),iX=(e,t,r,n,a,i,s,o)=>{const l=o.bits;let c=0,f=0,h=0,p=0,d=0,x=0,g=0,y=0,b=0,T=0,S,k,A,M,O,I=null,j;const W=new Uint16Array(fc+1),E=new Uint16Array(fc+1);let C=null,G,Z,he;for(c=0;c<=fc;c++)W[c]=0;for(f=0;f<n;f++)W[t[r+f]]++;for(d=l,p=fc;p>=1&&W[p]===0;p--);if(d>p&&(d=p),p===0)return a[i++]=1<<24|64<<16|0,a[i++]=1<<24|64<<16|0,o.bits=1,0;for(h=1;h<p&&W[h]===0;h++);for(d<h&&(d=h),y=1,c=1;c<=fc;c++)if(y<<=1,y-=W[c],y<0)return-1;if(y>0&&(e===Ww||p!==1))return-1;for(E[1]=0,c=1;c<fc;c++)E[c+1]=E[c]+W[c];for(f=0;f<n;f++)t[r+f]!==0&&(s[E[t[r+f]]++]=f);if(e===Ww?(I=C=s,j=20):e===f1?(I=tX,C=rX,j=257):(I=nX,C=aX,j=0),T=0,f=0,c=h,O=i,x=d,g=0,A=-1,b=1<<d,M=b-1,e===f1&&b>zw||e===Hw&&b>qw)return 1;for(;;){G=c-g,s[f]+1<j?(Z=0,he=s[f]):s[f]>=j?(Z=C[s[f]-j],he=I[s[f]-j]):(Z=96,he=0),S=1<<c-g,k=1<<x,h=k;do k-=S,a[O+(T>>g)+k]=G<<24|Z<<16|he|0;while(k!==0);for(S=1<<c-1;T&S;)S>>=1;if(S!==0?(T&=S-1,T+=S):T=0,f++,--W[c]===0){if(c===p)break;c=t[r+s[f]]}if(c>d&&(T&M)!==A){for(g===0&&(g=d),O+=h,x=c-g,y=1<<x;x+g<p&&(y-=W[x+g],!(y<=0));)x++,y<<=1;if(b+=1<<x,e===f1&&b>zw||e===Hw&&b>qw)return 1;A=T&M,a[A]=d<<24|x<<16|O-i|0}}return T!==0&&(a[O+T]=c-g<<24|64<<16|0),o.bits=d,0};var _f=iX;const sX=0,WE=1,HE=2,{Z_FINISH:Gw,Z_BLOCK:oX,Z_TREES:mh,Z_OK:Dl,Z_STREAM_END:lX,Z_NEED_DICT:cX,Z_STREAM_ERROR:pi,Z_DATA_ERROR:GE,Z_MEM_ERROR:VE,Z_BUF_ERROR:uX,Z_DEFLATED:Vw}=y0,Rp=16180,Kw=16181,Yw=16182,Xw=16183,Zw=16184,Jw=16185,Qw=16186,e_=16187,t_=16188,r_=16189,Cd=16190,ws=16191,h1=16192,n_=16193,d1=16194,a_=16195,i_=16196,s_=16197,o_=16198,gh=16199,xh=16200,l_=16201,c_=16202,u_=16203,f_=16204,h_=16205,p1=16206,d_=16207,p_=16208,Or=16209,KE=16210,YE=16211,fX=852,hX=592,dX=15,pX=dX,m_=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function mX(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Hl=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Rp||t.mode>YE?1:0},XE=e=>{if(Hl(e))return pi;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=Rp,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(fX),t.distcode=t.distdyn=new Int32Array(hX),t.sane=1,t.back=-1,Dl},ZE=e=>{if(Hl(e))return pi;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,XE(e)},JE=(e,t)=>{let r;if(Hl(e))return pi;const n=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?pi:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,ZE(e))},QE=(e,t)=>{if(!e)return pi;const r=new mX;e.state=r,r.strm=e,r.window=null,r.mode=Rp;const n=JE(e,t);return n!==Dl&&(e.state=null),n},gX=e=>QE(e,pX);let g_=!0,m1,g1;const xX=e=>{if(g_){m1=new Int32Array(512),g1=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(_f(WE,e.lens,0,288,m1,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;_f(HE,e.lens,0,32,g1,0,e.work,{bits:5}),g_=!1}e.lencode=m1,e.lenbits=9,e.distcode=g1,e.distbits=5},eT=(e,t,r,n)=>{let a;const i=e.state;return i.window===null&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),n>=i.wsize?(i.window.set(t.subarray(r-i.wsize,r),0),i.wnext=0,i.whave=i.wsize):(a=i.wsize-i.wnext,a>n&&(a=n),i.window.set(t.subarray(r-n,r-n+a),i.wnext),n-=a,n?(i.window.set(t.subarray(r-n,r),0),i.wnext=n,i.whave=i.wsize):(i.wnext+=a,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=a))),0},vX=(e,t)=>{let r,n,a,i,s,o,l,c,f,h,p,d,x,g,y=0,b,T,S,k,A,M,O,I;const j=new Uint8Array(4);let W,E;const C=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Hl(e)||!e.output||!e.input&&e.avail_in!==0)return pi;r=e.state,r.mode===ws&&(r.mode=h1),s=e.next_out,a=e.output,l=e.avail_out,i=e.next_in,n=e.input,o=e.avail_in,c=r.hold,f=r.bits,h=o,p=l,I=Dl;e:for(;;)switch(r.mode){case Rp:if(r.wrap===0){r.mode=h1;break}for(;f<16;){if(o===0)break e;o--,c+=n[i++]<<f,f+=8}if(r.wrap&2&&c===35615){r.wbits===0&&(r.wbits=15),r.check=0,j[0]=c&255,j[1]=c>>>8&255,r.check=wn(r.check,j,2,0),c=0,f=0,r.mode=Kw;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((c&255)<<8)+(c>>8))%31){e.msg="incorrect header check",r.mode=Or;break}if((c&15)!==Vw){e.msg="unknown compression method",r.mode=Or;break}if(c>>>=4,f-=4,O=(c&15)+8,r.wbits===0&&(r.wbits=O),O>15||O>r.wbits){e.msg="invalid window size",r.mode=Or;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=c&512?r_:ws,c=0,f=0;break;case Kw:for(;f<16;){if(o===0)break e;o--,c+=n[i++]<<f,f+=8}if(r.flags=c,(r.flags&255)!==Vw){e.msg="unknown compression method",r.mode=Or;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=Or;break}r.head&&(r.head.text=c>>8&1),r.flags&512&&r.wrap&4&&(j[0]=c&255,j[1]=c>>>8&255,r.check=wn(r.check,j,2,0)),c=0,f=0,r.mode=Yw;case Yw:for(;f<32;){if(o===0)break e;o--,c+=n[i++]<<f,f+=8}r.head&&(r.head.time=c),r.flags&512&&r.wrap&4&&(j[0]=c&255,j[1]=c>>>8&255,j[2]=c>>>16&255,j[3]=c>>>24&255,r.check=wn(r.check,j,4,0)),c=0,f=0,r.mode=Xw;case Xw:for(;f<16;){if(o===0)break e;o--,c+=n[i++]<<f,f+=8}r.head&&(r.head.xflags=c&255,r.head.os=c>>8),r.flags&512&&r.wrap&4&&(j[0]=c&255,j[1]=c>>>8&255,r.check=wn(r.check,j,2,0)),c=0,f=0,r.mode=Zw;case Zw:if(r.flags&1024){for(;f<16;){if(o===0)break e;o--,c+=n[i++]<<f,f+=8}r.length=c,r.head&&(r.head.extra_len=c),r.flags&512&&r.wrap&4&&(j[0]=c&255,j[1]=c>>>8&255,r.check=wn(r.check,j,2,0)),c=0,f=0}else r.head&&(r.head.extra=null);r.mode=Jw;case Jw:if(r.flags&1024&&(d=r.length,d>o&&(d=o),d&&(r.head&&(O=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(i,i+d),O)),r.flags&512&&r.wrap&4&&(r.check=wn(r.check,n,d,i)),o-=d,i+=d,r.length-=d),r.length))break e;r.length=0,r.mode=Qw;case Qw:if(r.flags&2048){if(o===0)break e;d=0;do O=n[i+d++],r.head&&O&&r.length<65536&&(r.head.name+=String.fromCharCode(O));while(O&&d<o);if(r.flags&512&&r.wrap&4&&(r.check=wn(r.check,n,d,i)),o-=d,i+=d,O)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=e_;case e_:if(r.flags&4096){if(o===0)break e;d=0;do O=n[i+d++],r.head&&O&&r.length<65536&&(r.head.comment+=String.fromCharCode(O));while(O&&d<o);if(r.flags&512&&r.wrap&4&&(r.check=wn(r.check,n,d,i)),o-=d,i+=d,O)break e}else r.head&&(r.head.comment=null);r.mode=t_;case t_:if(r.flags&512){for(;f<16;){if(o===0)break e;o--,c+=n[i++]<<f,f+=8}if(r.wrap&4&&c!==(r.check&65535)){e.msg="header crc mismatch",r.mode=Or;break}c=0,f=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=ws;break;case r_:for(;f<32;){if(o===0)break e;o--,c+=n[i++]<<f,f+=8}e.adler=r.check=m_(c),c=0,f=0,r.mode=Cd;case Cd:if(r.havedict===0)return e.next_out=s,e.avail_out=l,e.next_in=i,e.avail_in=o,r.hold=c,r.bits=f,cX;e.adler=r.check=1,r.mode=ws;case ws:if(t===oX||t===mh)break e;case h1:if(r.last){c>>>=f&7,f-=f&7,r.mode=p1;break}for(;f<3;){if(o===0)break e;o--,c+=n[i++]<<f,f+=8}switch(r.last=c&1,c>>>=1,f-=1,c&3){case 0:r.mode=n_;break;case 1:if(xX(r),r.mode=gh,t===mh){c>>>=2,f-=2;break e}break;case 2:r.mode=i_;break;case 3:e.msg="invalid block type",r.mode=Or}c>>>=2,f-=2;break;case n_:for(c>>>=f&7,f-=f&7;f<32;){if(o===0)break e;o--,c+=n[i++]<<f,f+=8}if((c&65535)!==(c>>>16^65535)){e.msg="invalid stored block lengths",r.mode=Or;break}if(r.length=c&65535,c=0,f=0,r.mode=d1,t===mh)break e;case d1:r.mode=a_;case a_:if(d=r.length,d){if(d>o&&(d=o),d>l&&(d=l),d===0)break e;a.set(n.subarray(i,i+d),s),o-=d,i+=d,l-=d,s+=d,r.length-=d;break}r.mode=ws;break;case i_:for(;f<14;){if(o===0)break e;o--,c+=n[i++]<<f,f+=8}if(r.nlen=(c&31)+257,c>>>=5,f-=5,r.ndist=(c&31)+1,c>>>=5,f-=5,r.ncode=(c&15)+4,c>>>=4,f-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=Or;break}r.have=0,r.mode=s_;case s_:for(;r.have<r.ncode;){for(;f<3;){if(o===0)break e;o--,c+=n[i++]<<f,f+=8}r.lens[C[r.have++]]=c&7,c>>>=3,f-=3}for(;r.have<19;)r.lens[C[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,W={bits:r.lenbits},I=_f(sX,r.lens,0,19,r.lencode,0,r.work,W),r.lenbits=W.bits,I){e.msg="invalid code lengths set",r.mode=Or;break}r.have=0,r.mode=o_;case o_:for(;r.have<r.nlen+r.ndist;){for(;y=r.lencode[c&(1<<r.lenbits)-1],b=y>>>24,T=y>>>16&255,S=y&65535,!(b<=f);){if(o===0)break e;o--,c+=n[i++]<<f,f+=8}if(S<16)c>>>=b,f-=b,r.lens[r.have++]=S;else{if(S===16){for(E=b+2;f<E;){if(o===0)break e;o--,c+=n[i++]<<f,f+=8}if(c>>>=b,f-=b,r.have===0){e.msg="invalid bit length repeat",r.mode=Or;break}O=r.lens[r.have-1],d=3+(c&3),c>>>=2,f-=2}else if(S===17){for(E=b+3;f<E;){if(o===0)break e;o--,c+=n[i++]<<f,f+=8}c>>>=b,f-=b,O=0,d=3+(c&7),c>>>=3,f-=3}else{for(E=b+7;f<E;){if(o===0)break e;o--,c+=n[i++]<<f,f+=8}c>>>=b,f-=b,O=0,d=11+(c&127),c>>>=7,f-=7}if(r.have+d>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=Or;break}for(;d--;)r.lens[r.have++]=O}}if(r.mode===Or)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=Or;break}if(r.lenbits=9,W={bits:r.lenbits},I=_f(WE,r.lens,0,r.nlen,r.lencode,0,r.work,W),r.lenbits=W.bits,I){e.msg="invalid literal/lengths set",r.mode=Or;break}if(r.distbits=6,r.distcode=r.distdyn,W={bits:r.distbits},I=_f(HE,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,W),r.distbits=W.bits,I){e.msg="invalid distances set",r.mode=Or;break}if(r.mode=gh,t===mh)break e;case gh:r.mode=xh;case xh:if(o>=6&&l>=258){e.next_out=s,e.avail_out=l,e.next_in=i,e.avail_in=o,r.hold=c,r.bits=f,eX(e,p),s=e.next_out,a=e.output,l=e.avail_out,i=e.next_in,n=e.input,o=e.avail_in,c=r.hold,f=r.bits,r.mode===ws&&(r.back=-1);break}for(r.back=0;y=r.lencode[c&(1<<r.lenbits)-1],b=y>>>24,T=y>>>16&255,S=y&65535,!(b<=f);){if(o===0)break e;o--,c+=n[i++]<<f,f+=8}if(T&&!(T&240)){for(k=b,A=T,M=S;y=r.lencode[M+((c&(1<<k+A)-1)>>k)],b=y>>>24,T=y>>>16&255,S=y&65535,!(k+b<=f);){if(o===0)break e;o--,c+=n[i++]<<f,f+=8}c>>>=k,f-=k,r.back+=k}if(c>>>=b,f-=b,r.back+=b,r.length=S,T===0){r.mode=h_;break}if(T&32){r.back=-1,r.mode=ws;break}if(T&64){e.msg="invalid literal/length code",r.mode=Or;break}r.extra=T&15,r.mode=l_;case l_:if(r.extra){for(E=r.extra;f<E;){if(o===0)break e;o--,c+=n[i++]<<f,f+=8}r.length+=c&(1<<r.extra)-1,c>>>=r.extra,f-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=c_;case c_:for(;y=r.distcode[c&(1<<r.distbits)-1],b=y>>>24,T=y>>>16&255,S=y&65535,!(b<=f);){if(o===0)break e;o--,c+=n[i++]<<f,f+=8}if(!(T&240)){for(k=b,A=T,M=S;y=r.distcode[M+((c&(1<<k+A)-1)>>k)],b=y>>>24,T=y>>>16&255,S=y&65535,!(k+b<=f);){if(o===0)break e;o--,c+=n[i++]<<f,f+=8}c>>>=k,f-=k,r.back+=k}if(c>>>=b,f-=b,r.back+=b,T&64){e.msg="invalid distance code",r.mode=Or;break}r.offset=S,r.extra=T&15,r.mode=u_;case u_:if(r.extra){for(E=r.extra;f<E;){if(o===0)break e;o--,c+=n[i++]<<f,f+=8}r.offset+=c&(1<<r.extra)-1,c>>>=r.extra,f-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=Or;break}r.mode=f_;case f_:if(l===0)break e;if(d=p-l,r.offset>d){if(d=r.offset-d,d>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=Or;break}d>r.wnext?(d-=r.wnext,x=r.wsize-d):x=r.wnext-d,d>r.length&&(d=r.length),g=r.window}else g=a,x=s-r.offset,d=r.length;d>l&&(d=l),l-=d,r.length-=d;do a[s++]=g[x++];while(--d);r.length===0&&(r.mode=xh);break;case h_:if(l===0)break e;a[s++]=r.length,l--,r.mode=xh;break;case p1:if(r.wrap){for(;f<32;){if(o===0)break e;o--,c|=n[i++]<<f,f+=8}if(p-=l,e.total_out+=p,r.total+=p,r.wrap&4&&p&&(e.adler=r.check=r.flags?wn(r.check,a,p,s-p):Vf(r.check,a,p,s-p)),p=l,r.wrap&4&&(r.flags?c:m_(c))!==r.check){e.msg="incorrect data check",r.mode=Or;break}c=0,f=0}r.mode=d_;case d_:if(r.wrap&&r.flags){for(;f<32;){if(o===0)break e;o--,c+=n[i++]<<f,f+=8}if(r.wrap&4&&c!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=Or;break}c=0,f=0}r.mode=p_;case p_:I=lX;break e;case Or:I=GE;break e;case KE:return VE;case YE:default:return pi}return e.next_out=s,e.avail_out=l,e.next_in=i,e.avail_in=o,r.hold=c,r.bits=f,(r.wsize||p!==e.avail_out&&r.mode<Or&&(r.mode<p1||t!==Gw))&&eT(e,e.output,e.next_out,p-e.avail_out),h-=e.avail_in,p-=e.avail_out,e.total_in+=h,e.total_out+=p,r.total+=p,r.wrap&4&&p&&(e.adler=r.check=r.flags?wn(r.check,a,p,e.next_out-p):Vf(r.check,a,p,e.next_out-p)),e.data_type=r.bits+(r.last?64:0)+(r.mode===ws?128:0)+(r.mode===gh||r.mode===d1?256:0),(h===0&&p===0||t===Gw)&&I===Dl&&(I=uX),I},yX=e=>{if(Hl(e))return pi;let t=e.state;return t.window&&(t.window=null),e.state=null,Dl},bX=(e,t)=>{if(Hl(e))return pi;const r=e.state;return r.wrap&2?(r.head=t,t.done=!1,Dl):pi},wX=(e,t)=>{const r=t.length;let n,a,i;return Hl(e)||(n=e.state,n.wrap!==0&&n.mode!==Cd)?pi:n.mode===Cd&&(a=1,a=Vf(a,t,r,0),a!==n.check)?GE:(i=eT(e,t,r,r),i?(n.mode=KE,VE):(n.havedict=1,Dl))};var _X=ZE,NX=JE,SX=XE,AX=gX,EX=QE,TX=vX,jX=yX,PX=bX,kX=wX,CX="pako inflate (from Nodeca project)",Ns={inflateReset:_X,inflateReset2:NX,inflateResetKeep:SX,inflateInit:AX,inflateInit2:EX,inflate:TX,inflateEnd:jX,inflateGetHeader:PX,inflateSetDictionary:kX,inflateInfo:CX};function OX(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var LX=OX;const tT=Object.prototype.toString,{Z_NO_FLUSH:FX,Z_FINISH:DX,Z_OK:Xf,Z_STREAM_END:x1,Z_NEED_DICT:v1,Z_STREAM_ERROR:IX,Z_DATA_ERROR:x_,Z_MEM_ERROR:MX}=y0;function w0(e){this.options=Mp.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zE,this.strm.avail_out=0;let r=Ns.inflateInit2(this.strm,t.windowBits);if(r!==Xf)throw new Error(Xc[r]);if(this.header=new LX,Ns.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=Yf.string2buf(t.dictionary):tT.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=Ns.inflateSetDictionary(this.strm,t.dictionary),r!==Xf)))throw new Error(Xc[r])}w0.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,a=this.options.dictionary;let i,s,o;if(this.ended)return!1;for(t===~~t?s=t:s=t===!0?DX:FX,tT.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),i=Ns.inflate(r,s),i===v1&&a&&(i=Ns.inflateSetDictionary(r,a),i===Xf?i=Ns.inflate(r,s):i===x_&&(i=v1));r.avail_in>0&&i===x1&&r.state.wrap>0&&e[r.next_in]!==0;)Ns.inflateReset(r),i=Ns.inflate(r,s);switch(i){case IX:case x_:case v1:case MX:return this.onEnd(i),this.ended=!0,!1}if(o=r.avail_out,r.next_out&&(r.avail_out===0||i===x1))if(this.options.to==="string"){let l=Yf.utf8border(r.output,r.next_out),c=r.next_out-l,f=Yf.buf2string(r.output,l);r.next_out=c,r.avail_out=n-c,c&&r.output.set(r.output.subarray(l,l+c),0),this.onData(f)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(i===Xf&&o===0)){if(i===x1)return i=Ns.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};w0.prototype.onData=function(e){this.chunks.push(e)};w0.prototype.onEnd=function(e){e===Xf&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Mp.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function h2(e,t){const r=new w0(t);if(r.push(e),r.err)throw r.msg||Xc[r.err];return r.result}function RX(e,t){return t=t||{},t.raw=!0,h2(e,t)}var BX=w0,UX=h2,$X=RX,zX=h2,qX=y0,WX={Inflate:BX,inflate:UX,inflateRaw:$X,ungzip:zX,constants:qX};const{Inflate:HX,inflate:GX,inflateRaw:bJ,ungzip:wJ}=WX;var v_=HX,VX=GX;const rT=[];for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;rT[e]=t}const y_=4294967295;function KX(e,t,r){let n=e;for(let a=0;a<r;a++)n=rT[(n^t[a])&255]^n>>>8;return n}function YX(e,t){return(KX(y_,e,t)^y_)>>>0}function b_(e,t,r){const n=e.readUint32(),a=YX(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(a!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${a}`)}function nT(e,t,r){for(let n=0;n<r;n++)t[n]=e[n]}function aT(e,t,r,n){let a=0;for(;a<n;a++)t[a]=e[a];for(;a<r;a++)t[a]=e[a]+t[a-n]&255}function iT(e,t,r,n){let a=0;if(r.length===0)for(;a<n;a++)t[a]=e[a];else for(;a<n;a++)t[a]=e[a]+r[a]&255}function sT(e,t,r,n,a){let i=0;if(r.length===0){for(;i<a;i++)t[i]=e[i];for(;i<n;i++)t[i]=e[i]+(t[i-a]>>1)&255}else{for(;i<a;i++)t[i]=e[i]+(r[i]>>1)&255;for(;i<n;i++)t[i]=e[i]+(t[i-a]+r[i]>>1)&255}}function oT(e,t,r,n,a){let i=0;if(r.length===0){for(;i<a;i++)t[i]=e[i];for(;i<n;i++)t[i]=e[i]+t[i-a]&255}else{for(;i<a;i++)t[i]=e[i]+r[i]&255;for(;i<n;i++)t[i]=e[i]+XX(t[i-a],r[i],r[i-a])&255}}function XX(e,t,r){const n=e+t-r,a=Math.abs(n-e),i=Math.abs(n-t),s=Math.abs(n-r);return a<=i&&a<=s?e:i<=s?t:r}function ZX(e,t,r,n,a,i){switch(e){case 0:nT(t,r,a);break;case 1:aT(t,r,a,i);break;case 2:iT(t,r,n,a);break;case 3:sT(t,r,n,a,i);break;case 4:oT(t,r,n,a,i);break;default:throw new Error(`Unsupported filter: ${e}`)}}const JX=new Uint16Array([255]),QX=new Uint8Array(JX.buffer),eZ=QX[0]===255;function tZ(e){const{data:t,width:r,height:n,channels:a,depth:i}=e,s=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],o=Math.ceil(i/8)*a,l=new Uint8Array(n*r*o);let c=0;for(let f=0;f<7;f++){const h=s[f],p=Math.ceil((r-h.x)/h.xStep),d=Math.ceil((n-h.y)/h.yStep);if(p<=0||d<=0)continue;const x=p*o,g=new Uint8Array(x);for(let y=0;y<d;y++){const b=t[c++],T=t.subarray(c,c+x);c+=x;const S=new Uint8Array(x);ZX(b,T,S,g,x,o),g.set(S);for(let k=0;k<p;k++){const A=h.x+k*h.xStep,M=h.y+y*h.yStep;if(!(A>=r||M>=n))for(let O=0;O<o;O++)l[(M*r+A)*o+O]=S[k*o+O]}}}if(i===16){const f=new Uint16Array(l.buffer);if(eZ)for(let h=0;h<f.length;h++)f[h]=rZ(f[h]);return f}else return l}function rZ(e){return(e&255)<<8|e>>8&255}const nZ=new Uint16Array([255]),aZ=new Uint8Array(nZ.buffer),iZ=aZ[0]===255,sZ=new Uint8Array(0);function w_(e){const{data:t,width:r,height:n,channels:a,depth:i}=e,s=Math.ceil(i/8)*a,o=Math.ceil(i/8*a*r),l=new Uint8Array(n*o);let c=sZ,f=0,h,p;for(let d=0;d<n;d++){switch(h=t.subarray(f+1,f+1+o),p=l.subarray(d*o,(d+1)*o),t[f]){case 0:nT(h,p,o);break;case 1:aT(h,p,o,s);break;case 2:iT(h,p,c,o);break;case 3:sT(h,p,c,o,s);break;case 4:oT(h,p,c,o,s);break;default:throw new Error(`Unsupported filter: ${t[f]}`)}c=p,f+=o+1}if(i===16){const d=new Uint16Array(l.buffer);if(iZ)for(let x=0;x<d.length;x++)d[x]=oZ(d[x]);return d}else return l}function oZ(e){return(e&255)<<8|e>>8&255}const Eh=Uint8Array.of(137,80,78,71,13,10,26,10);function __(e){if(!lZ(e.readBytes(Eh.length)))throw new Error("wrong PNG signature")}function lZ(e){if(e.length<Eh.length)return!1;for(let t=0;t<Eh.length;t++)if(e[t]!==Eh[t])return!1;return!0}const cZ="tEXt",uZ=0,lT=new TextDecoder("latin1");function fZ(e){if(dZ(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const hZ=/^[\u0000-\u00FF]*$/;function dZ(e){if(!hZ.test(e))throw new Error("invalid latin1 text")}function pZ(e,t,r){const n=cT(t);e[n]=mZ(t,r-n.length-1)}function cT(e){for(e.mark();e.readByte()!==uZ;);const t=e.offset;e.reset();const r=lT.decode(e.readBytes(t-e.offset-1));return e.skip(1),fZ(r),r}function mZ(e,t){return lT.decode(e.readBytes(t))}const Ia={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},y1={UNKNOWN:-1,DEFLATE:0},N_={UNKNOWN:-1,ADAPTIVE:0},b1={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},vh={NONE:0,BACKGROUND:1,PREVIOUS:2},w1={SOURCE:0,OVER:1};class gZ extends i2{constructor(r,n={}){super(r);rr(this,"_checkCrc");rr(this,"_inflator");rr(this,"_png");rr(this,"_apng");rr(this,"_end");rr(this,"_hasPalette");rr(this,"_palette");rr(this,"_hasTransparency");rr(this,"_transparency");rr(this,"_compressionMethod");rr(this,"_filterMethod");rr(this,"_interlaceMethod");rr(this,"_colorType");rr(this,"_isAnimated");rr(this,"_numberOfFrames");rr(this,"_numberOfPlays");rr(this,"_frames");rr(this,"_writingDataChunks");const{checkCrc:a=!1}=n;this._checkCrc=a,this._inflator=new v_,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=y1.UNKNOWN,this._filterMethod=N_.UNKNOWN,this._interlaceMethod=b1.UNKNOWN,this._colorType=Ia.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(__(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(__(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const a=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case cZ:pZ(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-a!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?b_(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const a=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=a+r;break}if(this.offset-a!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?b_(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=xZ(this.readUint8());const n=this.readUint8();this._colorType=n;let a;switch(n){case Ia.GREYSCALE:a=1;break;case Ia.TRUECOLOUR:a=3;break;case Ia.INDEXED_COLOUR:a=1;break;case Ia.GREYSCALE_ALPHA:a=2;break;case Ia.TRUECOLOUR_ALPHA:a=4;break;case Ia.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=a,this._compressionMethod=this.readUint8(),this._compressionMethod!==y1.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const a=[];this._palette=a;for(let i=0;i<n;i++)a.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,a=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,a=this.offset+this.byteOffset;if(a+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case Ia.GREYSCALE:case Ia.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case Ia.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const a=this.readByte();this._palette[n].push(a)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case Ia.UNKNOWN:case Ia.GREYSCALE_ALPHA:case Ia.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=cT(this),a=this.readUint8();if(a!==y1.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${a}`);const i=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:VX(i)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),a=this.readByte();this._png.resolution={x:r,y:n,unit:a}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},a=this._frames.at(r);if(a){if(a.data=w_({data:a.data,width:a.width,height:a.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||a.xOffset===0&&a.yOffset===0&&a.width===this._png.width&&a.height===this._png.height)n.data=a.data;else{const i=this._apng.frames.at(r-1);this.disposeFrame(a,i,n),this.addFrameDataToCanvas(n,a)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,a){switch(r.disposeOp){case vh.NONE:break;case vh.BACKGROUND:for(let i=0;i<this._png.height;i++)for(let s=0;s<this._png.width;s++){const o=(i*r.width+s)*this._png.channels;for(let l=0;l<this._png.channels;l++)a.data[o+l]=0}break;case vh.PREVIOUS:a.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const a=1<<this._png.depth,i=(s,o)=>{const l=((s+n.yOffset)*this._png.width+n.xOffset+o)*this._png.channels,c=(s*n.width+o)*this._png.channels;return{index:l,frameIndex:c}};switch(n.blendOp){case w1.SOURCE:for(let s=0;s<n.height;s++)for(let o=0;o<n.width;o++){const{index:l,frameIndex:c}=i(s,o);for(let f=0;f<this._png.channels;f++)r.data[l+f]=n.data[c+f]}break;case w1.OVER:for(let s=0;s<n.height;s++)for(let o=0;o<n.width;o++){const{index:l,frameIndex:c}=i(s,o);for(let f=0;f<this._png.channels;f++){const h=n.data[c+this._png.channels-1]/a,p=f%(this._png.channels-1)===0?1:n.data[c+f],d=Math.floor(h*p+(1-h)*r.data[l+f]);r.data[l+f]+=d}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==N_.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===b1.NO_INTERLACE)this._png.data=w_({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===b1.ADAM7)this._png.data=tZ({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:vh.NONE,blendOp:w1.SOURCE,data:r}),this._inflator=new v_,this._writingDataChunks=!1}}function xZ(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var S_;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(S_||(S_={}));function vZ(e,t){return new gZ(e,t).decode()}var Ct=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function _1(){Ct.console&&typeof Ct.console.log=="function"&&Ct.console.log.apply(Ct.console,arguments)}var vr={log:_1,warn:function(e){Ct.console&&(typeof Ct.console.warn=="function"?Ct.console.warn.apply(Ct.console,arguments):_1.call(null,arguments))},error:function(e){Ct.console&&(typeof Ct.console.error=="function"?Ct.console.error.apply(Ct.console,arguments):_1(e))}};function N1(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){nl(n.response,t,r)},n.onerror=function(){vr.error("could not download file")},n.send()}function A_(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function yh(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var nl=Ct.saveAs||((typeof window>"u"?"undefined":fr(window))!=="object"||window!==Ct?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=Ct.URL||Ct.webkitURL,a=document.createElement("a");t=t||e.name||"download",a.download=t,a.rel="noopener",typeof e=="string"?(a.href=e,a.origin!==location.origin?A_(a.href)?N1(e,t,r):yh(a,a.target="_blank"):yh(a)):(a.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(a.href)},4e4),setTimeout(function(){yh(a)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(A_(e))N1(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){yh(n)})}else navigator.msSaveOrOpenBlob(function(a,i){return i===void 0?i={autoBom:!1}:fr(i)!=="object"&&(vr.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return N1(e,t,r);var a=e.type==="application/octet-stream",i=/constructor/i.test(Ct.HTMLElement)||Ct.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||a&&i)&&(typeof FileReader>"u"?"undefined":fr(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var f=o.result;f=s?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=f:location=f,n=null},o.readAsDataURL(e)}else{var l=Ct.URL||Ct.webkitURL,c=l.createObjectURL(e);n?n.location=c:location.href=c,n=null,setTimeout(function(){l.revokeObjectURL(c)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function uT(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<r.length;n++){var a=r[n].re,i=r[n].process,s=a.exec(e);s&&(t=i(s),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),l=this.g.toString(16),c=this.b.toString(16);return o.length==1&&(o="0"+o),l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),"#"+o+l+c}}var Th=Ct.atob.bind(Ct),E_=Ct.btoa.bind(Ct);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function S1(e,t){var r=e[0],n=e[1],a=e[2],i=e[3];r=Kn(r,n,a,i,t[0],7,-680876936),i=Kn(i,r,n,a,t[1],12,-389564586),a=Kn(a,i,r,n,t[2],17,606105819),n=Kn(n,a,i,r,t[3],22,-1044525330),r=Kn(r,n,a,i,t[4],7,-176418897),i=Kn(i,r,n,a,t[5],12,1200080426),a=Kn(a,i,r,n,t[6],17,-1473231341),n=Kn(n,a,i,r,t[7],22,-45705983),r=Kn(r,n,a,i,t[8],7,1770035416),i=Kn(i,r,n,a,t[9],12,-1958414417),a=Kn(a,i,r,n,t[10],17,-42063),n=Kn(n,a,i,r,t[11],22,-1990404162),r=Kn(r,n,a,i,t[12],7,1804603682),i=Kn(i,r,n,a,t[13],12,-40341101),a=Kn(a,i,r,n,t[14],17,-1502002290),r=Yn(r,n=Kn(n,a,i,r,t[15],22,1236535329),a,i,t[1],5,-165796510),i=Yn(i,r,n,a,t[6],9,-1069501632),a=Yn(a,i,r,n,t[11],14,643717713),n=Yn(n,a,i,r,t[0],20,-373897302),r=Yn(r,n,a,i,t[5],5,-701558691),i=Yn(i,r,n,a,t[10],9,38016083),a=Yn(a,i,r,n,t[15],14,-660478335),n=Yn(n,a,i,r,t[4],20,-405537848),r=Yn(r,n,a,i,t[9],5,568446438),i=Yn(i,r,n,a,t[14],9,-1019803690),a=Yn(a,i,r,n,t[3],14,-187363961),n=Yn(n,a,i,r,t[8],20,1163531501),r=Yn(r,n,a,i,t[13],5,-1444681467),i=Yn(i,r,n,a,t[2],9,-51403784),a=Yn(a,i,r,n,t[7],14,1735328473),r=Xn(r,n=Yn(n,a,i,r,t[12],20,-1926607734),a,i,t[5],4,-378558),i=Xn(i,r,n,a,t[8],11,-2022574463),a=Xn(a,i,r,n,t[11],16,1839030562),n=Xn(n,a,i,r,t[14],23,-35309556),r=Xn(r,n,a,i,t[1],4,-1530992060),i=Xn(i,r,n,a,t[4],11,1272893353),a=Xn(a,i,r,n,t[7],16,-155497632),n=Xn(n,a,i,r,t[10],23,-1094730640),r=Xn(r,n,a,i,t[13],4,681279174),i=Xn(i,r,n,a,t[0],11,-358537222),a=Xn(a,i,r,n,t[3],16,-722521979),n=Xn(n,a,i,r,t[6],23,76029189),r=Xn(r,n,a,i,t[9],4,-640364487),i=Xn(i,r,n,a,t[12],11,-421815835),a=Xn(a,i,r,n,t[15],16,530742520),r=Zn(r,n=Xn(n,a,i,r,t[2],23,-995338651),a,i,t[0],6,-198630844),i=Zn(i,r,n,a,t[7],10,1126891415),a=Zn(a,i,r,n,t[14],15,-1416354905),n=Zn(n,a,i,r,t[5],21,-57434055),r=Zn(r,n,a,i,t[12],6,1700485571),i=Zn(i,r,n,a,t[3],10,-1894986606),a=Zn(a,i,r,n,t[10],15,-1051523),n=Zn(n,a,i,r,t[1],21,-2054922799),r=Zn(r,n,a,i,t[8],6,1873313359),i=Zn(i,r,n,a,t[15],10,-30611744),a=Zn(a,i,r,n,t[6],15,-1560198380),n=Zn(n,a,i,r,t[13],21,1309151649),r=Zn(r,n,a,i,t[4],6,-145523070),i=Zn(i,r,n,a,t[11],10,-1120210379),a=Zn(a,i,r,n,t[2],15,718787259),n=Zn(n,a,i,r,t[9],21,-343485551),e[0]=wo(r,e[0]),e[1]=wo(n,e[1]),e[2]=wo(a,e[2]),e[3]=wo(i,e[3])}function Bp(e,t,r,n,a,i){return t=wo(wo(t,e),wo(n,i)),wo(t<<a|t>>>32-a,r)}function Kn(e,t,r,n,a,i,s){return Bp(t&r|~t&n,e,t,a,i,s)}function Yn(e,t,r,n,a,i,s){return Bp(t&n|r&~n,e,t,a,i,s)}function Xn(e,t,r,n,a,i,s){return Bp(t^r^n,e,t,a,i,s)}function Zn(e,t,r,n,a,i,s){return Bp(r^(t|~n),e,t,a,i,s)}function fT(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)S1(n,yZ(e.substring(t-64,t)));e=e.substring(t-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)a[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(a[t>>2]|=128<<(t%4<<3),t>55)for(S1(n,a),t=0;t<16;t++)a[t]=0;return a[14]=8*r,S1(n,a),n}function yZ(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var T_="0123456789abcdef".split("");function bZ(e){for(var t="",r=0;r<4;r++)t+=T_[e>>8*r+4&15]+T_[e>>8*r&15];return t}function wZ(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function Ug(e){return fT(e).map(wZ).join("")}var _Z=function(e){for(var t=0;t<e.length;t++)e[t]=bZ(e[t]);return e.join("")}(fT("hello"))!="5d41402abc4b2a76b9719d911017c592";function wo(e,t){if(_Z){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function $g(e,t){var r,n,a,i;if(e!==r){for(var s=(a=e,i=1+(256/e.length|0),new Array(i+1).join(a)),o=[],l=0;l<256;l++)o[l]=l;var c=0;for(l=0;l<256;l++){var f=o[l];c=(c+f+s.charCodeAt(l))%256,o[l]=o[c],o[c]=f}r=e,n=o}else o=n;var h=t.length,p=0,d=0,x="";for(l=0;l<h;l++)d=(d+(f=o[p=(p+1)%256]))%256,o[p]=o[d],o[d]=f,s=o[(o[p]+o[d])%256],x+=String.fromCharCode(t.charCodeAt(l)^s);return x}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var j_={print:4,modify:8,copy:16,"annot-forms":32};function gc(e,t,r,n){this.v=1,this.r=2;var a=192;e.forEach(function(o){if(j_.perm!==void 0)throw new Error("Invalid permission: "+o);a+=j_[o]}),this.padding="(¬øN^Nu¬äAd\0NV√ø√∫\b..\0¬∂√êh>¬Ä/\f¬©√ædSiz";var i=(t+this.padding).substr(0,32),s=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,s),this.P=-(1+(255^a)),this.encryptionKey=Ug(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=$g(this.encryptionKey,this.padding)}function xc(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var a=e.charCodeAt(n);t+=a<33||a===35||a===37||a===40||a===41||a===47||a===60||a===62||a===91||a===93||a===123||a===125||a>126?"#"+("0"+a.toString(16)).slice(-2):e[n]}return t}function P_(e){if(fr(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,a){if(a=a||!1,typeof r!="string"||typeof n!="function"||typeof a!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var i=Math.random().toString(35);return t[r][i]=[n,!!a],i},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),a=[];for(var i in t[r]){var s=t[r][i];try{s[0].apply(e,n)}catch(o){Ct.console&&vr.error("jsPDF PubSub Error",o.message,o)}s[1]&&a.push(i)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function Od(e){if(!(this instanceof Od))return new Od(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function hT(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function sl(e,t,r,n,a){if(!(this instanceof sl))return new sl(e,t,r,n,a);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,hT.call(this,n,a)}function _c(e,t,r,n,a){if(!(this instanceof _c))return new _c(e,t,r,n,a);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,hT.call(this,n,a)}function St(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],a=arguments[2],i=arguments[3],s=[],o=1,l=16,c="S",f=null;fr(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,a=e.format||a,i=e.compress||e.compressPdf||i,(f=e.encryption||null)!==null&&(f.userPassword=f.userPassword||"",f.ownerPassword=f.ownerPassword||"",f.userPermissions=f.userPermissions||[]),o=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(l=e.floatPrecision),c=e.defaultPathOperation||"S"),s=e.filters||(i===!0?["FlateEncode"]:s),n=n||"mm",r=(""+(r||"P")).toLowerCase();var h=e.putOnlyUsedFonts||!1,p={},d={internal:{},__private__:{}};d.__private__.PubSub=P_;var x="1.3",g=d.__private__.getPdfVersion=function(){return x};d.__private__.setPdfVersion=function(w){x=w};var y={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};d.__private__.getPageFormats=function(){return y};var b=d.__private__.getPageFormat=function(w){return y[w]};a=a||"a4";var T="compat",S="advanced",k=T;function A(){this.saveGraphicsState(),Q(new Et(pt,0,0,-pt,0,ja()*pt).toString()+" cm"),this.setFontSize(this.getFontSize()/pt),c="n",k=S}function M(){this.restoreGraphicsState(),c="S",k=T}var O=d.__private__.combineFontStyleAndFontWeight=function(w,B){if(w=="bold"&&B=="normal"||w=="bold"&&B==400||w=="normal"&&B=="italic"||w=="bold"&&B=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return B&&(w=B==400||B==="normal"?w==="italic"?"italic":"normal":B!=700&&B!=="bold"||w!=="normal"?(B==700?"bold":B)+""+w:"bold"),w};d.advancedAPI=function(w){var B=k===T;return B&&A.call(this),typeof w!="function"||(w(this),B&&M.call(this)),this},d.compatAPI=function(w){var B=k===S;return B&&M.call(this),typeof w!="function"||(w(this),B&&A.call(this)),this},d.isAdvancedAPI=function(){return k===S};var I,j=function(w){if(k!==S)throw new Error(w+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},W=d.roundToPrecision=d.__private__.roundToPrecision=function(w,B){var ie=t||B;if(isNaN(w)||isNaN(ie))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return w.toFixed(ie).replace(/0+$/,"")};I=d.hpf=d.__private__.hpf=typeof l=="number"?function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.hpf");return W(w,l)}:l==="smart"?function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.hpf");return W(w,w>-1&&w<1?16:5)}:function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.hpf");return W(w,16)};var E=d.f2=d.__private__.f2=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.f2");return W(w,2)},C=d.__private__.f3=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.f3");return W(w,3)},G=d.scale=d.__private__.scale=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.scale");return k===T?w*pt:k===S?w:void 0},Z=function(w){return G(function(B){return k===T?ja()-B:k===S?B:void 0}(w))};d.__private__.setPrecision=d.setPrecision=function(w){typeof parseInt(w,10)=="number"&&(t=parseInt(w,10))};var he,oe="00000000000000000000000000000000",me=d.__private__.getFileId=function(){return oe},pe=d.__private__.setFileId=function(w){return oe=w!==void 0&&/^[a-fA-F0-9]{32}$/.test(w)?w.toUpperCase():oe.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),f!==null&&(Wr=new gc(f.userPermissions,f.userPassword,f.ownerPassword,oe)),oe};d.setFileId=function(w){return pe(w),this},d.getFileId=function(){return me()};var ge=d.__private__.convertDateToPDFDate=function(w){var B=w.getTimezoneOffset(),ie=B<0?"+":"-",de=Math.floor(Math.abs(B/60)),we=Math.abs(B%60),Be=[ie,L(de),"'",L(we),"'"].join("");return["D:",w.getFullYear(),L(w.getMonth()+1),L(w.getDate()),L(w.getHours()),L(w.getMinutes()),L(w.getSeconds()),Be].join("")},Le=d.__private__.convertPDFDateToDate=function(w){var B=parseInt(w.substr(2,4),10),ie=parseInt(w.substr(6,2),10)-1,de=parseInt(w.substr(8,2),10),we=parseInt(w.substr(10,2),10),Be=parseInt(w.substr(12,2),10),He=parseInt(w.substr(14,2),10);return new Date(B,ie,de,we,Be,He,0)},Se=d.__private__.setCreationDate=function(w){var B;if(w===void 0&&(w=new Date),w instanceof Date)B=ge(w);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(w))throw new Error("Invalid argument passed to jsPDF.setCreationDate");B=w}return he=B},N=d.__private__.getCreationDate=function(w){var B=he;return w==="jsDate"&&(B=Le(he)),B};d.setCreationDate=function(w){return Se(w),this},d.getCreationDate=function(w){return N(w)};var D,L=d.__private__.padd2=function(w){return("0"+parseInt(w)).slice(-2)},F=d.__private__.padd2Hex=function(w){return("00"+(w=w.toString())).substr(w.length)},K=0,ce=[],xe=[],ee=0,fe=[],le=[],ue=!1,$e=xe;d.__private__.setCustomOutputDestination=function(w){ue=!0,$e=w};var ye=function(w){ue||($e=w)};d.__private__.resetCustomOutputDestination=function(){ue=!1,$e=xe};var Q=d.__private__.out=function(w){return w=w.toString(),ee+=w.length+1,$e.push(w),$e},nt=d.__private__.write=function(w){return Q(arguments.length===1?w.toString():Array.prototype.join.call(arguments," "))},Re=d.__private__.getArrayBuffer=function(w){for(var B=w.length,ie=new ArrayBuffer(B),de=new Uint8Array(ie);B--;)de[B]=w.charCodeAt(B);return ie},ot=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];d.__private__.getStandardFonts=function(){return ot};var ze=e.fontSize||16;d.__private__.setFontSize=d.setFontSize=function(w){return ze=k===S?w/pt:w,this};var lt,Qe=d.__private__.getFontSize=d.getFontSize=function(){return k===T?ze:ze*pt},Tt=e.R2L||!1;d.__private__.setR2L=d.setR2L=function(w){return Tt=w,this},d.__private__.getR2L=d.getR2L=function(){return Tt};var ft,Ot=d.__private__.setZoomMode=function(w){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(w))lt=w;else if(isNaN(w)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(w)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+w+'" is not recognized.');lt=w}else lt=parseInt(w,10)};d.__private__.getZoomMode=function(){return lt};var Fe,Xe=d.__private__.setPageMode=function(w){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(w)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+w+'" is not recognized.');ft=w};d.__private__.getPageMode=function(){return ft};var At=d.__private__.setLayoutMode=function(w){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(w)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+w+'" is not recognized.');Fe=w};d.__private__.getLayoutMode=function(){return Fe},d.__private__.setDisplayMode=d.setDisplayMode=function(w,B,ie){return Ot(w),At(B),Xe(ie),this};var xt={title:"",subject:"",author:"",keywords:"",creator:""};d.__private__.getDocumentProperty=function(w){if(Object.keys(xt).indexOf(w)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return xt[w]},d.__private__.getDocumentProperties=function(){return xt},d.__private__.setDocumentProperties=d.setProperties=d.setDocumentProperties=function(w){for(var B in xt)xt.hasOwnProperty(B)&&w[B]&&(xt[B]=w[B]);return this},d.__private__.setDocumentProperty=function(w,B){if(Object.keys(xt).indexOf(w)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return xt[w]=B};var st,pt,ht,Qt,$t,mt={},jt={},er=[],Pe={},tt={},bt={},Xt={},wr=null,Wt=0,_t=[],Ut=new P_(d),ir=e.hotfixes||[],Dr={},un={},kn=[],Et=function w(B,ie,de,we,Be,He){if(!(this instanceof w))return new w(B,ie,de,we,Be,He);isNaN(B)&&(B=1),isNaN(ie)&&(ie=0),isNaN(de)&&(de=0),isNaN(we)&&(we=1),isNaN(Be)&&(Be=0),isNaN(He)&&(He=0),this._matrix=[B,ie,de,we,Be,He]};Object.defineProperty(Et.prototype,"sx",{get:function(){return this._matrix[0]},set:function(w){this._matrix[0]=w}}),Object.defineProperty(Et.prototype,"shy",{get:function(){return this._matrix[1]},set:function(w){this._matrix[1]=w}}),Object.defineProperty(Et.prototype,"shx",{get:function(){return this._matrix[2]},set:function(w){this._matrix[2]=w}}),Object.defineProperty(Et.prototype,"sy",{get:function(){return this._matrix[3]},set:function(w){this._matrix[3]=w}}),Object.defineProperty(Et.prototype,"tx",{get:function(){return this._matrix[4]},set:function(w){this._matrix[4]=w}}),Object.defineProperty(Et.prototype,"ty",{get:function(){return this._matrix[5]},set:function(w){this._matrix[5]=w}}),Object.defineProperty(Et.prototype,"a",{get:function(){return this._matrix[0]},set:function(w){this._matrix[0]=w}}),Object.defineProperty(Et.prototype,"b",{get:function(){return this._matrix[1]},set:function(w){this._matrix[1]=w}}),Object.defineProperty(Et.prototype,"c",{get:function(){return this._matrix[2]},set:function(w){this._matrix[2]=w}}),Object.defineProperty(Et.prototype,"d",{get:function(){return this._matrix[3]},set:function(w){this._matrix[3]=w}}),Object.defineProperty(Et.prototype,"e",{get:function(){return this._matrix[4]},set:function(w){this._matrix[4]=w}}),Object.defineProperty(Et.prototype,"f",{get:function(){return this._matrix[5]},set:function(w){this._matrix[5]=w}}),Object.defineProperty(Et.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Et.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Et.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Et.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Et.prototype.join=function(w){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(I).join(w)},Et.prototype.multiply=function(w){var B=w.sx*this.sx+w.shy*this.shx,ie=w.sx*this.shy+w.shy*this.sy,de=w.shx*this.sx+w.sy*this.shx,we=w.shx*this.shy+w.sy*this.sy,Be=w.tx*this.sx+w.ty*this.shx+this.tx,He=w.tx*this.shy+w.ty*this.sy+this.ty;return new Et(B,ie,de,we,Be,He)},Et.prototype.decompose=function(){var w=this.sx,B=this.shy,ie=this.shx,de=this.sy,we=this.tx,Be=this.ty,He=Math.sqrt(w*w+B*B),gt=(w/=He)*ie+(B/=He)*de;ie-=w*gt,de-=B*gt;var wt=Math.sqrt(ie*ie+de*de);return gt/=wt,w*(de/=wt)<B*(ie/=wt)&&(w=-w,B=-B,gt=-gt,He=-He),{scale:new Et(He,0,0,wt,0,0),translate:new Et(1,0,0,1,we,Be),rotate:new Et(w,B,-B,w,0,0),skew:new Et(1,0,gt,1,0,0)}},Et.prototype.toString=function(w){return this.join(" ")},Et.prototype.inversed=function(){var w=this.sx,B=this.shy,ie=this.shx,de=this.sy,we=this.tx,Be=this.ty,He=1/(w*de-B*ie),gt=de*He,wt=-B*He,kt=-ie*He,It=w*He;return new Et(gt,wt,kt,It,-gt*we-kt*Be,-wt*we-It*Be)},Et.prototype.applyToPoint=function(w){var B=w.x*this.sx+w.y*this.shx+this.tx,ie=w.x*this.shy+w.y*this.sy+this.ty;return new Vo(B,ie)},Et.prototype.applyToRectangle=function(w){var B=this.applyToPoint(w),ie=this.applyToPoint(new Vo(w.x+w.w,w.y+w.h));return new Su(B.x,B.y,ie.x-B.x,ie.y-B.y)},Et.prototype.clone=function(){var w=this.sx,B=this.shy,ie=this.shx,de=this.sy,we=this.tx,Be=this.ty;return new Et(w,B,ie,de,we,Be)},d.Matrix=Et;var vi=d.matrixMult=function(w,B){return B.multiply(w)},yi=new Et(1,0,0,1,0,0);d.unitMatrix=d.identityMatrix=yi;var Hn=function(w,B){if(!tt[w]){var ie=(B instanceof sl?"Sh":"P")+(Object.keys(Pe).length+1).toString(10);B.id=ie,tt[w]=ie,Pe[ie]=B,Ut.publish("addPattern",B)}};d.ShadingPattern=sl,d.TilingPattern=_c,d.addShadingPattern=function(w,B){return j("addShadingPattern()"),Hn(w,B),this},d.beginTilingPattern=function(w){j("beginTilingPattern()"),Au(w.boundingBox[0],w.boundingBox[1],w.boundingBox[2]-w.boundingBox[0],w.boundingBox[3]-w.boundingBox[1],w.matrix)},d.endTilingPattern=function(w,B){j("endTilingPattern()"),B.stream=le[D].join(`
`),Hn(w,B),Ut.publish("endTilingPattern",B),kn.pop().restore()};var da,Cr=d.__private__.newObject=function(){var w=en();return z(w,!0),w},en=d.__private__.newObjectDeferred=function(){return K++,ce[K]=function(){return ee},K},z=function(w,B){return B=typeof B=="boolean"&&B,ce[w]=ee,B&&Q(w+" 0 obj"),w},ne=d.__private__.newAdditionalObject=function(){var w={objId:en(),content:""};return fe.push(w),w},Y=en(),J=en(),ae=d.__private__.decodeColorString=function(w){var B=w.split(" ");if(B.length!==2||B[1]!=="g"&&B[1]!=="G")B.length!==5||B[4]!=="k"&&B[4]!=="K"||(B=[(1-B[0])*(1-B[3]),(1-B[1])*(1-B[3]),(1-B[2])*(1-B[3]),"r"]);else{var ie=parseFloat(B[0]);B=[ie,ie,ie,"r"]}for(var de="#",we=0;we<3;we++)de+=("0"+Math.floor(255*parseFloat(B[we])).toString(16)).slice(-2);return de},se=d.__private__.encodeColorString=function(w){var B;typeof w=="string"&&(w={ch1:w});var ie=w.ch1,de=w.ch2,we=w.ch3,Be=w.ch4,He=w.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof ie=="string"&&ie.charAt(0)!=="#"){var gt=new uT(ie);if(gt.ok)ie=gt.toHex();else if(!/^\d*\.?\d*$/.test(ie))throw new Error('Invalid color "'+ie+'" passed to jsPDF.encodeColorString.')}if(typeof ie=="string"&&/^#[0-9A-Fa-f]{3}$/.test(ie)&&(ie="#"+ie[1]+ie[1]+ie[2]+ie[2]+ie[3]+ie[3]),typeof ie=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ie)){var wt=parseInt(ie.substr(1),16);ie=wt>>16&255,de=wt>>8&255,we=255&wt}if(de===void 0||Be===void 0&&ie===de&&de===we)B=typeof ie=="string"?ie+" "+He[0]:w.precision===2?E(ie/255)+" "+He[0]:C(ie/255)+" "+He[0];else if(Be===void 0||fr(Be)==="object"){if(Be&&!isNaN(Be.a)&&Be.a===0)return["1.","1.","1.",He[1]].join(" ");B=typeof ie=="string"?[ie,de,we,He[1]].join(" "):w.precision===2?[E(ie/255),E(de/255),E(we/255),He[1]].join(" "):[C(ie/255),C(de/255),C(we/255),He[1]].join(" ")}else B=typeof ie=="string"?[ie,de,we,Be,He[2]].join(" "):w.precision===2?[E(ie),E(de),E(we),E(Be),He[2]].join(" "):[C(ie),C(de),C(we),C(Be),He[2]].join(" ");return B},Ne=d.__private__.getFilters=function(){return s},Oe=d.__private__.putStream=function(w){var B=(w=w||{}).data||"",ie=w.filters||Ne(),de=w.alreadyAppliedFilters||[],we=w.addLength1||!1,Be=B.length,He=w.objectId,gt=function(fn){return fn};if(f!==null&&He===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");f!==null&&(gt=Wr.encryptor(He,0));var wt={};ie===!0&&(ie=["FlateEncode"]);var kt=w.additionalKeyValues||[],It=(wt=St.API.processDataByFilters!==void 0?St.API.processDataByFilters(B,ie):{data:B,reverseChain:[]}).reverseChain+(Array.isArray(de)?de.join(" "):de.toString());if(wt.data.length!==0&&(kt.push({key:"Length",value:wt.data.length}),we===!0&&kt.push({key:"Length1",value:Be})),It.length!=0)if(It.split("/").length-1==1)kt.push({key:"Filter",value:It});else{kt.push({key:"Filter",value:"["+It+"]"});for(var tr=0;tr<kt.length;tr+=1)if(kt[tr].key==="DecodeParms"){for(var Ir=[],rn=0;rn<wt.reverseChain.split("/").length-1;rn+=1)Ir.push("null");Ir.push(kt[tr].value),kt[tr].value="["+Ir.join(" ")+"]"}}Q("<<");for(var mr=0;mr<kt.length;mr++)Q("/"+kt[mr].key+" "+kt[mr].value);Q(">>"),wt.data.length!==0&&(Q("stream"),Q(gt(wt.data)),Q("endstream"))},Ae=d.__private__.putPage=function(w){var B=w.number,ie=w.data,de=w.objId,we=w.contentsObjId;z(de,!0),Q("<</Type /Page"),Q("/Parent "+w.rootDictionaryObjId+" 0 R"),Q("/Resources "+w.resourceDictionaryObjId+" 0 R"),Q("/MediaBox ["+parseFloat(I(w.mediaBox.bottomLeftX))+" "+parseFloat(I(w.mediaBox.bottomLeftY))+" "+I(w.mediaBox.topRightX)+" "+I(w.mediaBox.topRightY)+"]"),w.cropBox!==null&&Q("/CropBox ["+I(w.cropBox.bottomLeftX)+" "+I(w.cropBox.bottomLeftY)+" "+I(w.cropBox.topRightX)+" "+I(w.cropBox.topRightY)+"]"),w.bleedBox!==null&&Q("/BleedBox ["+I(w.bleedBox.bottomLeftX)+" "+I(w.bleedBox.bottomLeftY)+" "+I(w.bleedBox.topRightX)+" "+I(w.bleedBox.topRightY)+"]"),w.trimBox!==null&&Q("/TrimBox ["+I(w.trimBox.bottomLeftX)+" "+I(w.trimBox.bottomLeftY)+" "+I(w.trimBox.topRightX)+" "+I(w.trimBox.topRightY)+"]"),w.artBox!==null&&Q("/ArtBox ["+I(w.artBox.bottomLeftX)+" "+I(w.artBox.bottomLeftY)+" "+I(w.artBox.topRightX)+" "+I(w.artBox.topRightY)+"]"),typeof w.userUnit=="number"&&w.userUnit!==1&&Q("/UserUnit "+w.userUnit),Ut.publish("putPage",{objId:de,pageContext:_t[B],pageNumber:B,page:ie}),Q("/Contents "+we+" 0 R"),Q(">>"),Q("endobj");var Be=ie.join(`
`);return k===S&&(Be+=`
Q`),z(we,!0),Oe({data:Be,filters:Ne(),objectId:we}),Q("endobj"),de},Ee=d.__private__.putPages=function(){var w,B,ie=[];for(w=1;w<=Wt;w++)_t[w].objId=en(),_t[w].contentsObjId=en();for(w=1;w<=Wt;w++)ie.push(Ae({number:w,data:le[w],objId:_t[w].objId,contentsObjId:_t[w].contentsObjId,mediaBox:_t[w].mediaBox,cropBox:_t[w].cropBox,bleedBox:_t[w].bleedBox,trimBox:_t[w].trimBox,artBox:_t[w].artBox,userUnit:_t[w].userUnit,rootDictionaryObjId:Y,resourceDictionaryObjId:J}));z(Y,!0),Q("<</Type /Pages");var de="/Kids [";for(B=0;B<Wt;B++)de+=ie[B]+" 0 R ";Q(de+"]"),Q("/Count "+Wt),Q(">>"),Q("endobj"),Ut.publish("postPutPages")},ke=function(w){Ut.publish("putFont",{font:w,out:Q,newObject:Cr,putStream:Oe}),w.isAlreadyPutted!==!0&&(w.objectNumber=Cr(),Q("<<"),Q("/Type /Font"),Q("/BaseFont /"+xc(w.postScriptName)),Q("/Subtype /Type1"),typeof w.encoding=="string"&&Q("/Encoding /"+w.encoding),Q("/FirstChar 32"),Q("/LastChar 255"),Q(">>"),Q("endobj"))},Ge=function(w){w.objectNumber=Cr();var B=[];B.push({key:"Type",value:"/XObject"}),B.push({key:"Subtype",value:"/Form"}),B.push({key:"BBox",value:"["+[I(w.x),I(w.y),I(w.x+w.width),I(w.y+w.height)].join(" ")+"]"}),B.push({key:"Matrix",value:"["+w.matrix.toString()+"]"});var ie=w.pages[1].join(`
`);Oe({data:ie,additionalKeyValues:B,objectId:w.objectNumber}),Q("endobj")},Ze=function(w,B){B||(B=21);var ie=Cr(),de=function(He,gt){var wt,kt=[],It=1/(gt-1);for(wt=0;wt<1;wt+=It)kt.push(wt);if(kt.push(1),He[0].offset!=0){var tr={offset:0,color:He[0].color};He.unshift(tr)}if(He[He.length-1].offset!=1){var Ir={offset:1,color:He[He.length-1].color};He.push(Ir)}for(var rn="",mr=0,fn=0;fn<kt.length;fn++){for(wt=kt[fn];wt>He[mr+1].offset;)mr++;var nn=He[mr].offset,Cn=(wt-nn)/(He[mr+1].offset-nn),hs=He[mr].color,Zs=He[mr+1].color;rn+=F(Math.round((1-Cn)*hs[0]+Cn*Zs[0]).toString(16))+F(Math.round((1-Cn)*hs[1]+Cn*Zs[1]).toString(16))+F(Math.round((1-Cn)*hs[2]+Cn*Zs[2]).toString(16))}return rn.trim()}(w.colors,B),we=[];we.push({key:"FunctionType",value:"0"}),we.push({key:"Domain",value:"[0.0 1.0]"}),we.push({key:"Size",value:"["+B+"]"}),we.push({key:"BitsPerSample",value:"8"}),we.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),we.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Oe({data:de,additionalKeyValues:we,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:ie}),Q("endobj"),w.objectNumber=Cr(),Q("<< /ShadingType "+w.type),Q("/ColorSpace /DeviceRGB");var Be="/Coords ["+I(parseFloat(w.coords[0]))+" "+I(parseFloat(w.coords[1]))+" ";w.type===2?Be+=I(parseFloat(w.coords[2]))+" "+I(parseFloat(w.coords[3])):Be+=I(parseFloat(w.coords[2]))+" "+I(parseFloat(w.coords[3]))+" "+I(parseFloat(w.coords[4]))+" "+I(parseFloat(w.coords[5])),Q(Be+="]"),w.matrix&&Q("/Matrix ["+w.matrix.toString()+"]"),Q("/Function "+ie+" 0 R"),Q("/Extend [true true]"),Q(">>"),Q("endobj")},it=function(w,B){var ie=en(),de=Cr();B.push({resourcesOid:ie,objectOid:de}),w.objectNumber=de;var we=[];we.push({key:"Type",value:"/Pattern"}),we.push({key:"PatternType",value:"1"}),we.push({key:"PaintType",value:"1"}),we.push({key:"TilingType",value:"1"}),we.push({key:"BBox",value:"["+w.boundingBox.map(I).join(" ")+"]"}),we.push({key:"XStep",value:I(w.xStep)}),we.push({key:"YStep",value:I(w.yStep)}),we.push({key:"Resources",value:ie+" 0 R"}),w.matrix&&we.push({key:"Matrix",value:"["+w.matrix.toString()+"]"}),Oe({data:w.stream,additionalKeyValues:we,objectId:w.objectNumber}),Q("endobj")},Ke=function(w){for(var B in w.objectNumber=Cr(),Q("<<"),w)switch(B){case"opacity":Q("/ca "+E(w[B]));break;case"stroke-opacity":Q("/CA "+E(w[B]))}Q(">>"),Q("endobj")},at=function(w){z(w.resourcesOid,!0),Q("<<"),Q("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var B in Q("/Font <<"),mt)mt.hasOwnProperty(B)&&(h===!1||h===!0&&p.hasOwnProperty(B))&&Q("/"+B+" "+mt[B].objectNumber+" 0 R");Q(">>")}(),function(){if(Object.keys(Pe).length>0){for(var B in Q("/Shading <<"),Pe)Pe.hasOwnProperty(B)&&Pe[B]instanceof sl&&Pe[B].objectNumber>=0&&Q("/"+B+" "+Pe[B].objectNumber+" 0 R");Ut.publish("putShadingPatternDict"),Q(">>")}}(),function(B){if(Object.keys(Pe).length>0){for(var ie in Q("/Pattern <<"),Pe)Pe.hasOwnProperty(ie)&&Pe[ie]instanceof d.TilingPattern&&Pe[ie].objectNumber>=0&&Pe[ie].objectNumber<B&&Q("/"+ie+" "+Pe[ie].objectNumber+" 0 R");Ut.publish("putTilingPatternDict"),Q(">>")}}(w.objectOid),function(){if(Object.keys(bt).length>0){var B;for(B in Q("/ExtGState <<"),bt)bt.hasOwnProperty(B)&&bt[B].objectNumber>=0&&Q("/"+B+" "+bt[B].objectNumber+" 0 R");Ut.publish("putGStateDict"),Q(">>")}}(),function(){for(var B in Q("/XObject <<"),Dr)Dr.hasOwnProperty(B)&&Dr[B].objectNumber>=0&&Q("/"+B+" "+Dr[B].objectNumber+" 0 R");Ut.publish("putXobjectDict"),Q(">>")}(),Q(">>"),Q("endobj")},Pt=function(w){jt[w.fontName]=jt[w.fontName]||{},jt[w.fontName][w.fontStyle]=w.id},pr=function(w,B,ie,de,we){var Be={id:"F"+(Object.keys(mt).length+1).toString(10),postScriptName:w,fontName:B,fontStyle:ie,encoding:de,isStandardFont:we||!1,metadata:{}};return Ut.publish("addFont",{font:Be,instance:this}),mt[Be.id]=Be,Pt(Be),Be.id},zt=d.__private__.pdfEscape=d.pdfEscape=function(w,B){return function(ie,de){var we,Be,He,gt,wt,kt,It,tr,Ir;if(He=(de=de||{}).sourceEncoding||"Unicode",wt=de.outputEncoding,(de.autoencode||wt)&&mt[st].metadata&&mt[st].metadata[He]&&mt[st].metadata[He].encoding&&(gt=mt[st].metadata[He].encoding,!wt&&mt[st].encoding&&(wt=mt[st].encoding),!wt&&gt.codePages&&(wt=gt.codePages[0]),typeof wt=="string"&&(wt=gt[wt]),wt)){for(It=!1,kt=[],we=0,Be=ie.length;we<Be;we++)(tr=wt[ie.charCodeAt(we)])?kt.push(String.fromCharCode(tr)):kt.push(ie[we]),kt[we].charCodeAt(0)>>8&&(It=!0);ie=kt.join("")}for(we=ie.length;It===void 0&&we!==0;)ie.charCodeAt(we-1)>>8&&(It=!0),we--;if(!It)return ie;for(kt=de.noBOM?[]:[254,255],we=0,Be=ie.length;we<Be;we++){if((Ir=(tr=ie.charCodeAt(we))>>8)>>8)throw new Error("Character at position "+we+" of string '"+ie+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");kt.push(Ir),kt.push(tr-(Ir<<8))}return String.fromCharCode.apply(void 0,kt)}(w,B).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Mr=d.__private__.beginPage=function(w){le[++Wt]=[],_t[Wt]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(w[0]),topRightY:Number(w[1])}},$i(Wt),ye(le[D])},Ui=function(w,B){var ie,de,we;switch(r=B||r,typeof w=="string"&&(ie=b(w.toLowerCase()),Array.isArray(ie)&&(de=ie[0],we=ie[1])),Array.isArray(w)&&(de=w[0]*pt,we=w[1]*pt),isNaN(de)&&(de=a[0],we=a[1]),(de>14400||we>14400)&&(vr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),de=Math.min(14400,de),we=Math.min(14400,we)),a=[de,we],r.substr(0,1)){case"l":we>de&&(a=[we,de]);break;case"p":de>we&&(a=[we,de])}Mr(a),Kp(bu),Q(Vl),_u!==0&&Q(_u+" J"),Nu!==0&&Q(Nu+" j"),Ut.publish("addPage",{pageNumber:Wt})},bi=function(w){w>0&&w<=Wt&&(le.splice(w,1),_t.splice(w,1),Wt--,D>Wt&&(D=Wt),this.setPage(D))},$i=function(w){w>0&&w<=Wt&&(D=w)},Qa=d.__private__.getNumberOfPages=d.getNumberOfPages=function(){return le.length-1},Ks=function(w,B,ie){var de,we=void 0;return ie=ie||{},w=w!==void 0?w:mt[st].fontName,B=B!==void 0?B:mt[st].fontStyle,de=w.toLowerCase(),jt[de]!==void 0&&jt[de][B]!==void 0?we=jt[de][B]:jt[w]!==void 0&&jt[w][B]!==void 0?we=jt[w][B]:ie.disableWarning===!1&&vr.warn("Unable to look up font label for font '"+w+"', '"+B+"'. Refer to getFontList() for available fonts."),we||ie.noFallback||(we=jt.times[B])==null&&(we=jt.times.normal),we},Gn=d.__private__.putInfo=function(){var w=Cr(),B=function(de){return de};for(var ie in f!==null&&(B=Wr.encryptor(w,0)),Q("<<"),Q("/Producer ("+zt(B("jsPDF "+St.version))+")"),xt)xt.hasOwnProperty(ie)&&xt[ie]&&Q("/"+ie.substr(0,1).toUpperCase()+ie.substr(1)+" ("+zt(B(xt[ie]))+")");Q("/CreationDate ("+zt(B(he))+")"),Q(">>"),Q("endobj")},Up=d.__private__.putCatalog=function(w){var B=(w=w||{}).rootDictionaryObjId||Y;switch(Cr(),Q("<<"),Q("/Type /Catalog"),Q("/Pages "+B+" 0 R"),lt||(lt="fullwidth"),lt){case"fullwidth":Q("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Q("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Q("/OpenAction [3 0 R /Fit]");break;case"original":Q("/OpenAction [3 0 R /XYZ null null 1]");break;default:var ie=""+lt;ie.substr(ie.length-1)==="%"&&(lt=parseInt(lt)/100),typeof lt=="number"&&Q("/OpenAction [3 0 R /XYZ null null "+E(lt)+"]")}switch(Fe||(Fe="continuous"),Fe){case"continuous":Q("/PageLayout /OneColumn");break;case"single":Q("/PageLayout /SinglePage");break;case"two":case"twoleft":Q("/PageLayout /TwoColumnLeft");break;case"tworight":Q("/PageLayout /TwoColumnRight")}ft&&Q("/PageMode /"+ft),Ut.publish("putCatalog"),Q(">>"),Q("endobj")},tn=d.__private__.putTrailer=function(){Q("trailer"),Q("<<"),Q("/Size "+(K+1)),Q("/Root "+K+" 0 R"),Q("/Info "+(K-1)+" 0 R"),f!==null&&Q("/Encrypt "+Wr.oid+" 0 R"),Q("/ID [ <"+oe+"> <"+oe+"> ]"),Q(">>")},_0=d.__private__.putHeader=function(){Q("%PDF-"+x),Q("%¬∫√ü¬¨√†")},N0=d.__private__.putXRef=function(){var w="0000000000";Q("xref"),Q("0 "+(K+1)),Q("0000000000 65535 f ");for(var B=1;B<=K;B++)typeof ce[B]=="function"?Q((w+ce[B]()).slice(-10)+" 00000 n "):ce[B]!==void 0?Q((w+ce[B]).slice(-10)+" 00000 n "):Q("0000000000 00000 n ")},cs=d.__private__.buildDocument=function(){var w;K=0,ee=0,xe=[],ce=[],fe=[],Y=en(),J=en(),ye(xe),Ut.publish("buildDocument"),_0(),Ee(),function(){Ut.publish("putAdditionalObjects");for(var ie=0;ie<fe.length;ie++){var de=fe[ie];z(de.objId,!0),Q(de.content),Q("endobj")}Ut.publish("postPutAdditionalObjects")}(),w=[],function(){for(var ie in mt)mt.hasOwnProperty(ie)&&(h===!1||h===!0&&p.hasOwnProperty(ie))&&ke(mt[ie])}(),function(){var ie;for(ie in bt)bt.hasOwnProperty(ie)&&Ke(bt[ie])}(),function(){for(var ie in Dr)Dr.hasOwnProperty(ie)&&Ge(Dr[ie])}(),function(ie){var de;for(de in Pe)Pe.hasOwnProperty(de)&&(Pe[de]instanceof sl?Ze(Pe[de]):Pe[de]instanceof _c&&it(Pe[de],ie))}(w),Ut.publish("putResources"),w.forEach(at),at({resourcesOid:J,objectOid:Number.MAX_SAFE_INTEGER}),Ut.publish("postPutResources"),f!==null&&(Wr.oid=Cr(),Q("<<"),Q("/Filter /Standard"),Q("/V "+Wr.v),Q("/R "+Wr.r),Q("/U <"+Wr.toHexString(Wr.U)+">"),Q("/O <"+Wr.toHexString(Wr.O)+">"),Q("/P "+Wr.P),Q(">>"),Q("endobj")),Gn(),Up();var B=ee;return N0(),tn(),Q("startxref"),Q(""+B),Q("%%EOF"),ye(le[D]),xe.join(`
`)},$o=d.__private__.getBlob=function(w){return new Blob([Re(w)],{type:"application/pdf"})},wi=d.output=d.__private__.output=(da=function(w,B){switch(typeof(B=B||{})=="string"?B={filename:B}:B.filename=B.filename||"generated.pdf",w){case void 0:return cs();case"save":d.save(B.filename);break;case"arraybuffer":return Re(cs());case"blob":return $o(cs());case"bloburi":case"bloburl":if(Ct.URL!==void 0&&typeof Ct.URL.createObjectURL=="function")return Ct.URL&&Ct.URL.createObjectURL($o(cs()))||void 0;vr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var ie="",de=cs();try{ie=E_(de)}catch{ie=E_(unescape(encodeURIComponent(de)))}return"data:application/pdf;filename="+B.filename+";base64,"+ie;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Ct)==="[object Window]"){var we="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Be=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';B.pdfObjectUrl&&(we=B.pdfObjectUrl,Be="");var He='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+we+'"'+Be+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(B)+");<\/script></body></html>",gt=Ct.open();return gt!==null&&gt.document.write(He),gt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Ct)==="[object Window]"){var wt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(B.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+B.filename+'" width="500px" height="400px" /></body></html>',kt=Ct.open();if(kt!==null){kt.document.write(wt);var It=this;kt.document.documentElement.querySelector("#pdfViewer").onload=function(){kt.document.title=B.filename,kt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(It.output("bloburl"))}}return kt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Ct)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var tr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",B)+'"></iframe></body></html>',Ir=Ct.open();if(Ir!==null&&(Ir.document.write(tr),Ir.document.title=B.filename),Ir||typeof safari>"u")return Ir;break;case"datauri":case"dataurl":return Ct.document.location.href=this.output("datauristring",B);default:return null}},da.foo=function(){try{return da.apply(this,arguments)}catch(ie){var w=ie.stack||"";~w.indexOf(" at ")&&(w=w.split(" at ")[1]);var B="Error in function "+w.split(`
`)[0].split("<")[0]+": "+ie.message;if(!Ct.console)throw new Error(B);Ct.console.error(B,ie),Ct.alert&&alert(B)}},da.foo.bar=da,da.foo),zo=function(w){return Array.isArray(ir)===!0&&ir.indexOf(w)>-1};switch(n){case"pt":pt=1;break;case"mm":pt=72/25.4;break;case"cm":pt=72/2.54;break;case"in":pt=72;break;case"px":pt=zo("px_scaling")==1?.75:96/72;break;case"pc":case"em":pt=12;break;case"ex":pt=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);pt=n}var Wr=null;Se(),pe();var xu=d.__private__.getPageInfo=d.getPageInfo=function(w){if(isNaN(w)||w%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:_t[w].objId,pageNumber:w,pageContext:_t[w]}},$p=d.__private__.getPageInfoByObjId=function(w){if(isNaN(w)||w%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var B in _t)if(_t[B].objId===w)break;return xu(B)},zp=d.__private__.getCurrentPageInfo=d.getCurrentPageInfo=function(){return{objId:_t[D].objId,pageNumber:D,pageContext:_t[D]}};d.addPage=function(){return Ui.apply(this,arguments),this},d.setPage=function(){return $i.apply(this,arguments),ye.call(this,le[D]),this},d.insertPage=function(w){return this.addPage(),this.movePage(D,w),this},d.movePage=function(w,B){var ie,de;if(w>B){ie=le[w],de=_t[w];for(var we=w;we>B;we--)le[we]=le[we-1],_t[we]=_t[we-1];le[B]=ie,_t[B]=de,this.setPage(B)}else if(w<B){ie=le[w],de=_t[w];for(var Be=w;Be<B;Be++)le[Be]=le[Be+1],_t[Be]=_t[Be+1];le[B]=ie,_t[B]=de,this.setPage(B)}return this},d.deletePage=function(){return bi.apply(this,arguments),this},d.__private__.text=d.text=function(w,B,ie,de,we){var Be,He,gt,wt,kt,It,tr,Ir,rn,mr=(de=de||{}).scope||this;if(typeof w=="number"&&typeof B=="number"&&(typeof ie=="string"||Array.isArray(ie))){var fn=ie;ie=B,B=w,w=fn}if(arguments[3]instanceof Et==0?(gt=arguments[4],wt=arguments[5],fr(tr=arguments[3])==="object"&&tr!==null||(typeof gt=="string"&&(wt=gt,gt=null),typeof tr=="string"&&(wt=tr,tr=null),typeof tr=="number"&&(gt=tr,tr=null),de={flags:tr,angle:gt,align:wt})):(j("The transform parameter of text() with a Matrix value"),rn=we),isNaN(B)||isNaN(ie)||w==null)throw new Error("Invalid arguments passed to jsPDF.text");if(w.length===0)return mr;var nn,Cn="",hs=typeof de.lineHeightFactor=="number"?de.lineHeightFactor:Wo,Zs=mr.internal.scaleFactor;function tm(_r){return _r=_r.split("	").join(Array(de.TabLen||9).join(" ")),zt(_r,tr)}function E0(_r){for(var Nr,Gr=_r.concat(),Vr=[],gs=Gr.length;gs--;)typeof(Nr=Gr.shift())=="string"?Vr.push(Nr):Array.isArray(_r)&&(Nr.length===1||Nr[1]===void 0&&Nr[2]===void 0)?Vr.push(Nr[0]):Vr.push([Nr[0],Nr[1],Nr[2]]);return Vr}function Yo(_r,Nr){var Gr;if(typeof _r=="string")Gr=Nr(_r)[0];else if(Array.isArray(_r)){for(var Vr,gs,ac=_r.concat(),Ki=[],Du=ac.length;Du--;)typeof(Vr=ac.shift())=="string"?Ki.push(Nr(Vr)[0]):Array.isArray(Vr)&&typeof Vr[0]=="string"&&(gs=Nr(Vr[0],Vr[1],Vr[2]),Ki.push([gs[0],gs[1],gs[2]]));Gr=Ki}return Gr}var _i=!1,ju=!0;if(typeof w=="string")_i=!0;else if(Array.isArray(w)){var Zl=w.concat();He=[];for(var Js,bn=Zl.length;bn--;)(typeof(Js=Zl.shift())!="string"||Array.isArray(Js)&&typeof Js[0]!="string")&&(ju=!1);_i=ju}if(_i===!1)throw new Error('Type of text must be string or Array. "'+w+'" is not recognized.');typeof w=="string"&&(w=w.match(/[\r?\n]/)?w.split(/\r\n|\r|\n/g):[w]);var ds=ze/mr.internal.scaleFactor,ps=ds*(hs-1);switch(de.baseline){case"bottom":ie-=ps;break;case"top":ie+=ds-ps;break;case"hanging":ie+=ds-2*ps;break;case"middle":ie+=ds/2-ps}if((It=de.maxWidth||0)>0&&(typeof w=="string"?w=mr.splitTextToSize(w,It):Object.prototype.toString.call(w)==="[object Array]"&&(w=w.reduce(function(_r,Nr){return _r.concat(mr.splitTextToSize(Nr,It))},[]))),Be={text:w,x:B,y:ie,options:de,mutex:{pdfEscape:zt,activeFontKey:st,fonts:mt,activeFontSize:ze}},Ut.publish("preProcessText",Be),w=Be.text,gt=(de=Be.options).angle,rn instanceof Et==0&&gt&&typeof gt=="number"){gt*=Math.PI/180,de.rotationDirection===0&&(gt=-gt),k===S&&(gt=-gt);var Jl=Math.cos(gt),Pu=Math.sin(gt);rn=new Et(Jl,Pu,-Pu,Jl,0,0)}else gt&&gt instanceof Et&&(rn=gt);k!==S||rn||(rn=yi),(kt=de.charSpace||Yl)!==void 0&&(Cn+=I(G(kt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Ir=de.horizontalScale)!==void 0&&(Cn+=I(100*Ir)+` Tz
`),de.lang;var na=-1,T0=de.renderingMode!==void 0?de.renderingMode:de.stroke,Ql=mr.internal.getCurrentPageInfo().pageContext;switch(T0){case 0:case!1:case"fill":na=0;break;case 1:case!0:case"stroke":na=1;break;case 2:case"fillThenStroke":na=2;break;case 3:case"invisible":na=3;break;case 4:case"fillAndAddForClipping":na=4;break;case 5:case"strokeAndAddPathForClipping":na=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":na=6;break;case 7:case"addToPathForClipping":na=7}var j0=Ql.usedRenderingMode!==void 0?Ql.usedRenderingMode:-1;na!==-1?Cn+=na+` Tr
`:j0!==-1&&(Cn+=`0 Tr
`),na!==-1&&(Ql.usedRenderingMode=na),wt=de.align||"left";var hn,ei=ze*hs,ku=mr.internal.pageSize.getWidth(),Cu=mt[st];kt=de.charSpace||Yl,It=de.maxWidth||0,tr=Object.assign({autoencode:!0,noBOM:!0},de.flags);var Qs=[],ec=function(_r){return mr.getStringUnitWidth(_r,{font:Cu,charSpace:kt,fontSize:ze,doKerning:!1})*ze/Zs};if(Object.prototype.toString.call(w)==="[object Array]"){var pa;He=E0(w),wt!=="left"&&(hn=He.map(ec));var ma,Xo=0;if(wt==="right"){B-=hn[0],w=[],bn=He.length;for(var Wi=0;Wi<bn;Wi++)Wi===0?(ma=us(B),pa=fs(ie)):(ma=G(Xo-hn[Wi]),pa=-ei),w.push([He[Wi],ma,pa]),Xo=hn[Wi]}else if(wt==="center"){B-=hn[0]/2,w=[],bn=He.length;for(var eo=0;eo<bn;eo++)eo===0?(ma=us(B),pa=fs(ie)):(ma=G((Xo-hn[eo])/2),pa=-ei),w.push([He[eo],ma,pa]),Xo=hn[eo]}else if(wt==="left"){w=[],bn=He.length;for(var Ou=0;Ou<bn;Ou++)w.push(He[Ou])}else if(wt==="justify"&&Cu.encoding==="Identity-H"){w=[],bn=He.length,It=It!==0?It:ku;for(var to=0,Hr=0;Hr<bn;Hr++)if(pa=Hr===0?fs(ie):-ei,ma=Hr===0?us(B):to,Hr<bn-1){var rm=G((It-hn[Hr])/(He[Hr].split(" ").length-1)),Hi=He[Hr].split(" ");w.push([Hi[0]+" ",ma,pa]),to=0;for(var Gi=1;Gi<Hi.length;Gi++){var tc=(ec(Hi[Gi-1]+" "+Hi[Gi])-ec(Hi[Gi]))*Zs+rm;Gi==Hi.length-1?w.push([Hi[Gi],tc,0]):w.push([Hi[Gi]+" ",tc,0]),to-=tc}}else w.push([He[Hr],ma,pa]);w.push(["",to,0])}else{if(wt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(w=[],bn=He.length,It=It!==0?It:ku,Hr=0;Hr<bn;Hr++)pa=Hr===0?fs(ie):-ei,ma=Hr===0?us(B):0,Hr<bn-1?Qs.push(I(G((It-hn[Hr])/(He[Hr].split(" ").length-1)))):Qs.push(0),w.push([He[Hr],ma,pa])}}(typeof de.R2L=="boolean"?de.R2L:Tt)===!0&&(w=Yo(w,function(_r,Nr,Gr){return[_r.split("").reverse().join(""),Nr,Gr]})),Be={text:w,x:B,y:ie,options:de,mutex:{pdfEscape:zt,activeFontKey:st,fonts:mt,activeFontSize:ze}},Ut.publish("postProcessText",Be),w=Be.text,nn=Be.mutex.isHex||!1;var Lu=mt[st].encoding;Lu!=="WinAnsiEncoding"&&Lu!=="StandardEncoding"||(w=Yo(w,function(_r,Nr,Gr){return[tm(_r),Nr,Gr]})),He=E0(w),w=[];for(var rc,nc,Zo,Jo=Array.isArray(He[0])?1:0,ms="",Fu=function(_r,Nr,Gr){var Vr="";return Gr instanceof Et?(Gr=typeof de.angle=="number"?vi(Gr,new Et(1,0,0,1,_r,Nr)):vi(new Et(1,0,0,1,_r,Nr),Gr),k===S&&(Gr=vi(new Et(1,0,0,-1,0,0),Gr)),Vr=Gr.join(" ")+` Tm
`):Vr=I(_r)+" "+I(Nr)+` Td
`,Vr},Pa=0;Pa<He.length;Pa++){switch(ms="",Jo){case 1:Zo=(nn?"<":"(")+He[Pa][0]+(nn?">":")"),rc=parseFloat(He[Pa][1]),nc=parseFloat(He[Pa][2]);break;case 0:Zo=(nn?"<":"(")+He[Pa]+(nn?">":")"),rc=us(B),nc=fs(ie)}Qs!==void 0&&Qs[Pa]!==void 0&&(ms=Qs[Pa]+` Tw
`),Pa===0?w.push(ms+Fu(rc,nc,rn)+Zo):Jo===0?w.push(ms+Zo):Jo===1&&w.push(ms+Fu(rc,nc,rn)+Zo)}w=Jo===0?w.join(` Tj
T* `):w.join(` Tj
`),w+=` Tj
`;var Vi=`BT
/`;return Vi+=st+" "+ze+` Tf
`,Vi+=I(ze*hs)+` TL
`,Vi+=Ho+`
`,Vi+=Cn,Vi+=w,Q(Vi+="ET"),p[st]=!0,mr};var qp=d.__private__.clip=d.clip=function(w){return Q(w==="evenodd"?"W*":"W"),this};d.clipEvenOdd=function(){return qp("evenodd")},d.__private__.discardPath=d.discardPath=function(){return Q("n"),this};var zi=d.__private__.isValidStyle=function(w){var B=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(w)!==-1&&(B=!0),B};d.__private__.setDefaultPathOperation=d.setDefaultPathOperation=function(w){return zi(w)&&(c=w),this};var S0=d.__private__.getStyle=d.getStyle=function(w){var B=c;switch(w){case"D":case"S":B="S";break;case"F":B="f";break;case"FD":case"DF":B="B";break;case"f":case"f*":case"B":case"B*":B=w}return B},A0=d.close=function(){return Q("h"),this};d.stroke=function(){return Q("S"),this},d.fill=function(w){return Ys("f",w),this},d.fillEvenOdd=function(w){return Ys("f*",w),this},d.fillStroke=function(w){return Ys("B",w),this},d.fillStrokeEvenOdd=function(w){return Ys("B*",w),this};var Ys=function(w,B){fr(B)==="object"?Hp(B,w):Q(w)},vu=function(w){w===null||k===S&&w===void 0||(w=S0(w),Q(w))};function Wp(w,B,ie,de,we){var Be=new _c(B||this.boundingBox,ie||this.xStep,de||this.yStep,this.gState,we||this.matrix);Be.stream=this.stream;var He=w+"$$"+this.cloneIndex+++"$$";return Hn(He,Be),Be}var Hp=function(w,B){var ie=tt[w.key],de=Pe[ie];if(de instanceof sl)Q("q"),Q(Gp(B)),de.gState&&d.setGState(de.gState),Q(w.matrix.toString()+" cm"),Q("/"+ie+" sh"),Q("Q");else if(de instanceof _c){var we=new Et(1,0,0,-1,0,ja());w.matrix&&(we=we.multiply(w.matrix||yi),ie=Wp.call(de,w.key,w.boundingBox,w.xStep,w.yStep,we).id),Q("q"),Q("/Pattern cs"),Q("/"+ie+" scn"),de.gState&&d.setGState(de.gState),Q(B),Q("Q")}},Gp=function(w){switch(w){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},yu=d.moveTo=function(w,B){return Q(I(G(w))+" "+I(Z(B))+" m"),this},qo=d.lineTo=function(w,B){return Q(I(G(w))+" "+I(Z(B))+" l"),this},Xs=d.curveTo=function(w,B,ie,de,we,Be){return Q([I(G(w)),I(Z(B)),I(G(ie)),I(Z(de)),I(G(we)),I(Z(Be)),"c"].join(" ")),this};d.__private__.line=d.line=function(w,B,ie,de,we){if(isNaN(w)||isNaN(B)||isNaN(ie)||isNaN(de)||!zi(we))throw new Error("Invalid arguments passed to jsPDF.line");return k===T?this.lines([[ie-w,de-B]],w,B,[1,1],we||"S"):this.lines([[ie-w,de-B]],w,B,[1,1]).stroke()},d.__private__.lines=d.lines=function(w,B,ie,de,we,Be){var He,gt,wt,kt,It,tr,Ir,rn,mr,fn,nn,Cn;if(typeof w=="number"&&(Cn=ie,ie=B,B=w,w=Cn),de=de||[1,1],Be=Be||!1,isNaN(B)||isNaN(ie)||!Array.isArray(w)||!Array.isArray(de)||!zi(we)||typeof Be!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(yu(B,ie),He=de[0],gt=de[1],kt=w.length,fn=B,nn=ie,wt=0;wt<kt;wt++)(It=w[wt]).length===2?(fn=It[0]*He+fn,nn=It[1]*gt+nn,qo(fn,nn)):(tr=It[0]*He+fn,Ir=It[1]*gt+nn,rn=It[2]*He+fn,mr=It[3]*gt+nn,fn=It[4]*He+fn,nn=It[5]*gt+nn,Xs(tr,Ir,rn,mr,fn,nn));return Be&&A0(),vu(we),this},d.path=function(w){for(var B=0;B<w.length;B++){var ie=w[B],de=ie.c;switch(ie.op){case"m":yu(de[0],de[1]);break;case"l":qo(de[0],de[1]);break;case"c":Xs.apply(this,de);break;case"h":A0()}}return this},d.__private__.rect=d.rect=function(w,B,ie,de,we){if(isNaN(w)||isNaN(B)||isNaN(ie)||isNaN(de)||!zi(we))throw new Error("Invalid arguments passed to jsPDF.rect");return k===T&&(de=-de),Q([I(G(w)),I(Z(B)),I(G(ie)),I(G(de)),"re"].join(" ")),vu(we),this},d.__private__.triangle=d.triangle=function(w,B,ie,de,we,Be,He){if(isNaN(w)||isNaN(B)||isNaN(ie)||isNaN(de)||isNaN(we)||isNaN(Be)||!zi(He))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[ie-w,de-B],[we-ie,Be-de],[w-we,B-Be]],w,B,[1,1],He,!0),this},d.__private__.roundedRect=d.roundedRect=function(w,B,ie,de,we,Be,He){if(isNaN(w)||isNaN(B)||isNaN(ie)||isNaN(de)||isNaN(we)||isNaN(Be)||!zi(He))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var gt=4/3*(Math.SQRT2-1);return we=Math.min(we,.5*ie),Be=Math.min(Be,.5*de),this.lines([[ie-2*we,0],[we*gt,0,we,Be-Be*gt,we,Be],[0,de-2*Be],[0,Be*gt,-we*gt,Be,-we,Be],[2*we-ie,0],[-we*gt,0,-we,-Be*gt,-we,-Be],[0,2*Be-de],[0,-Be*gt,we*gt,-Be,we,-Be]],w+we,B,[1,1],He,!0),this},d.__private__.ellipse=d.ellipse=function(w,B,ie,de,we){if(isNaN(w)||isNaN(B)||isNaN(ie)||isNaN(de)||!zi(we))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Be=4/3*(Math.SQRT2-1)*ie,He=4/3*(Math.SQRT2-1)*de;return yu(w+ie,B),Xs(w+ie,B-He,w+Be,B-de,w,B-de),Xs(w-Be,B-de,w-ie,B-He,w-ie,B),Xs(w-ie,B+He,w-Be,B+de,w,B+de),Xs(w+Be,B+de,w+ie,B+He,w+ie,B),vu(we),this},d.__private__.circle=d.circle=function(w,B,ie,de){if(isNaN(w)||isNaN(B)||isNaN(ie)||!zi(de))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(w,B,ie,ie,de)},d.setFont=function(w,B,ie){return ie&&(B=O(B,ie)),st=Ks(w,B,{disableWarning:!1}),this};var Vp=d.__private__.getFont=d.getFont=function(){return mt[Ks.apply(d,arguments)]};d.__private__.getFontList=d.getFontList=function(){var w,B,ie={};for(w in jt)if(jt.hasOwnProperty(w))for(B in ie[w]=[],jt[w])jt[w].hasOwnProperty(B)&&ie[w].push(B);return ie},d.addFont=function(w,B,ie,de,we){var Be=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Be.indexOf(arguments[3])!==-1?we=arguments[3]:arguments[3]&&Be.indexOf(arguments[3])==-1&&(ie=O(ie,de)),pr.call(this,w,B,ie,we=we||"Identity-H")};var Wo,bu=e.lineWidth||.200025,Lt=d.__private__.getLineWidth=d.getLineWidth=function(){return bu},Kp=d.__private__.setLineWidth=d.setLineWidth=function(w){return bu=w,Q(I(G(w))+" w"),this};d.__private__.setLineDash=St.API.setLineDash=St.API.setLineDashPattern=function(w,B){if(w=w||[],B=B||0,isNaN(B)||!Array.isArray(w))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return w=w.map(function(ie){return I(G(ie))}).join(" "),B=I(G(B)),Q("["+w+"] "+B+" d"),this};var Yp=d.__private__.getLineHeight=d.getLineHeight=function(){return ze*Wo};d.__private__.getLineHeight=d.getLineHeight=function(){return ze*Wo};var Xp=d.__private__.setLineHeightFactor=d.setLineHeightFactor=function(w){return typeof(w=w||1.15)=="number"&&(Wo=w),this},Zp=d.__private__.getLineHeightFactor=d.getLineHeightFactor=function(){return Wo};Xp(e.lineHeight);var us=d.__private__.getHorizontalCoordinate=function(w){return G(w)},fs=d.__private__.getVerticalCoordinate=function(w){return k===S?w:_t[D].mediaBox.topRightY-_t[D].mediaBox.bottomLeftY-G(w)},Jp=d.__private__.getHorizontalCoordinateString=d.getHorizontalCoordinateString=function(w){return I(us(w))},Qp=d.__private__.getVerticalCoordinateString=d.getVerticalCoordinateString=function(w){return I(fs(w))},Vl=e.strokeColor||"0 G";d.__private__.getStrokeColor=d.getDrawColor=function(){return ae(Vl)},d.__private__.setStrokeColor=d.setDrawColor=function(w,B,ie,de){return Vl=se({ch1:w,ch2:B,ch3:ie,ch4:de,pdfColorType:"draw",precision:2}),Q(Vl),this};var wu=e.fillColor||"0 g";d.__private__.getFillColor=d.getFillColor=function(){return ae(wu)},d.__private__.setFillColor=d.setFillColor=function(w,B,ie,de){return wu=se({ch1:w,ch2:B,ch3:ie,ch4:de,pdfColorType:"fill",precision:2}),Q(wu),this};var Ho=e.textColor||"0 g",Kl=d.__private__.getTextColor=d.getTextColor=function(){return ae(Ho)};d.__private__.setTextColor=d.setTextColor=function(w,B,ie,de){return Ho=se({ch1:w,ch2:B,ch3:ie,ch4:de,pdfColorType:"text",precision:3}),this};var Yl=e.charSpace,em=d.__private__.getCharSpace=d.getCharSpace=function(){return parseFloat(Yl||0)};d.__private__.setCharSpace=d.setCharSpace=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Yl=w,this};var _u=0;d.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},d.__private__.setLineCap=d.setLineCap=function(w){var B=d.CapJoinStyles[w];if(B===void 0)throw new Error("Line cap style of '"+w+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return _u=B,Q(B+" J"),this};var Nu=0;d.__private__.setLineJoin=d.setLineJoin=function(w){var B=d.CapJoinStyles[w];if(B===void 0)throw new Error("Line join style of '"+w+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Nu=B,Q(B+" j"),this},d.__private__.setLineMiterLimit=d.__private__.setMiterLimit=d.setLineMiterLimit=d.setMiterLimit=function(w){if(w=w||0,isNaN(w))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Q(I(G(w))+" M"),this},d.GState=Od,d.setGState=function(w){(w=typeof w=="string"?bt[Xt[w]]:Go(null,w)).equals(wr)||(Q("/"+w.id+" gs"),wr=w)};var Go=function(w,B){if(!w||!Xt[w]){var ie=!1;for(var de in bt)if(bt.hasOwnProperty(de)&&bt[de].equals(B)){ie=!0;break}if(ie)B=bt[de];else{var we="GS"+(Object.keys(bt).length+1).toString(10);bt[we]=B,B.id=we}return w&&(Xt[w]=B.id),Ut.publish("addGState",B),B}};d.addGState=function(w,B){return Go(w,B),this},d.saveGraphicsState=function(){return Q("q"),er.push({key:st,size:ze,color:Ho}),this},d.restoreGraphicsState=function(){Q("Q");var w=er.pop();return st=w.key,ze=w.size,Ho=w.color,wr=null,this},d.setCurrentTransformationMatrix=function(w){return Q(w.toString()+" cm"),this},d.comment=function(w){return Q("#"+w),this};var Vo=function(w,B){var ie=w||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ie},set:function(Be){isNaN(Be)||(ie=parseFloat(Be))}});var de=B||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return de},set:function(Be){isNaN(Be)||(de=parseFloat(Be))}});var we="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return we},set:function(Be){we=Be.toString()}}),this},Su=function(w,B,ie,de){Vo.call(this,w,B),this.type="rect";var we=ie||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return we},set:function(He){isNaN(He)||(we=parseFloat(He))}});var Be=de||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Be},set:function(He){isNaN(He)||(Be=parseFloat(He))}}),this},Xl=function(){this.page=Wt,this.currentPage=D,this.pages=le.slice(0),this.pagesContext=_t.slice(0),this.x=ht,this.y=Qt,this.matrix=$t,this.width=Eu(D),this.height=ja(D),this.outputDestination=$e,this.id="",this.objectNumber=-1};Xl.prototype.restore=function(){Wt=this.page,D=this.currentPage,_t=this.pagesContext,le=this.pages,ht=this.x,Qt=this.y,$t=this.matrix,Tu(D,this.width),qi(D,this.height),$e=this.outputDestination};var Au=function(w,B,ie,de,we){kn.push(new Xl),Wt=D=0,le=[],ht=w,Qt=B,$t=we,Mr([ie,de])};for(var Ko in d.beginFormObject=function(w,B,ie,de,we){return Au(w,B,ie,de,we),this},d.endFormObject=function(w){return function(B){if(un[B])kn.pop().restore();else{var ie=new Xl,de="Xo"+(Object.keys(Dr).length+1).toString(10);ie.id=de,un[B]=de,Dr[de]=ie,Ut.publish("addFormObject",ie),kn.pop().restore()}}(w),this},d.doFormObject=function(w,B){var ie=Dr[un[w]];return Q("q"),Q(B.toString()+" cm"),Q("/"+ie.id+" Do"),Q("Q"),this},d.getFormObject=function(w){var B=Dr[un[w]];return{x:B.x,y:B.y,width:B.width,height:B.height,matrix:B.matrix}},d.save=function(w,B){return w=w||"generated.pdf",(B=B||{}).returnPromise=B.returnPromise||!1,B.returnPromise===!1?(nl($o(cs()),w),typeof nl.unload=="function"&&Ct.setTimeout&&setTimeout(nl.unload,911),this):new Promise(function(ie,de){try{var we=nl($o(cs()),w);typeof nl.unload=="function"&&Ct.setTimeout&&setTimeout(nl.unload,911),ie(we)}catch(Be){de(Be.message)}})},St.API)St.API.hasOwnProperty(Ko)&&(Ko==="events"&&St.API.events.length?function(w,B){var ie,de,we;for(we=B.length-1;we!==-1;we--)ie=B[we][0],de=B[we][1],w.subscribe.apply(w,[ie].concat(typeof de=="function"?[de]:de))}(Ut,St.API.events):d[Ko]=St.API[Ko]);var Eu=d.getPageWidth=function(w){return(_t[w=w||D].mediaBox.topRightX-_t[w].mediaBox.bottomLeftX)/pt},Tu=d.setPageWidth=function(w,B){_t[w].mediaBox.topRightX=B*pt+_t[w].mediaBox.bottomLeftX},ja=d.getPageHeight=function(w){return(_t[w=w||D].mediaBox.topRightY-_t[w].mediaBox.bottomLeftY)/pt},qi=d.setPageHeight=function(w,B){_t[w].mediaBox.topRightY=B*pt+_t[w].mediaBox.bottomLeftY};return d.internal={pdfEscape:zt,getStyle:S0,getFont:Vp,getFontSize:Qe,getCharSpace:em,getTextColor:Kl,getLineHeight:Yp,getLineHeightFactor:Zp,getLineWidth:Lt,write:nt,getHorizontalCoordinate:us,getVerticalCoordinate:fs,getCoordinateString:Jp,getVerticalCoordinateString:Qp,collections:{},newObject:Cr,newAdditionalObject:ne,newObjectDeferred:en,newObjectDeferredBegin:z,getFilters:Ne,putStream:Oe,events:Ut,scaleFactor:pt,pageSize:{getWidth:function(){return Eu(D)},setWidth:function(w){Tu(D,w)},getHeight:function(){return ja(D)},setHeight:function(w){qi(D,w)}},encryptionOptions:f,encryption:Wr,getEncryptor:function(w){return f!==null?Wr.encryptor(w,0):function(B){return B}},output:wi,getNumberOfPages:Qa,pages:le,out:Q,f2:E,f3:C,getPageInfo:xu,getPageInfoByObjId:$p,getCurrentPageInfo:zp,getPDFVersion:g,Point:Vo,Rectangle:Su,Matrix:Et,hasHotfix:zo},Object.defineProperty(d.internal.pageSize,"width",{get:function(){return Eu(D)},set:function(w){Tu(D,w)},enumerable:!0,configurable:!0}),Object.defineProperty(d.internal.pageSize,"height",{get:function(){return ja(D)},set:function(w){qi(D,w)},enumerable:!0,configurable:!0}),(function(w){for(var B=0,ie=ot.length;B<ie;B++){var de=pr.call(this,w[B][0],w[B][1],w[B][2],ot[B][3],!0);h===!1&&(p[de]=!0);var we=w[B][0].split("-");Pt({id:de,fontName:we[0],fontStyle:we[1]||""})}Ut.publish("addFonts",{fonts:mt,dictionary:jt})}).call(d,ot),st="F1",Ui(a,r),Ut.publish("initialized"),d}gc.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},gc.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},gc.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},gc.prototype.processOwnerPassword=function(e,t){return $g(Ug(t).substr(0,5),e)},gc.prototype.encryptor=function(e,t){var r=Ug(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return $g(r,n)}},Od.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||fr(e)!==fr(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},St.API={events:[]},St.version="3.0.2";var Ur=St.API,d2=1,Gl=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},hc=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Ft=function(e){return e.toFixed(2)},ho=function(e){return e.toFixed(5)};Ur.__acroform__={};var Ta=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},k_=function(e){return e*d2},Ji=function(e){var t=new pT,r=dt.internal.getHeight(e)||0,n=dt.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Ft(n)),Number(Ft(r))],t},NZ=Ur.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},SZ=Ur.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},AZ=Ur.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},Xr=Ur.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return AZ(e,t-1)},Zr=Ur.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return NZ(e,t-1)},Jr=Ur.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return SZ(e,t-1)},EZ=Ur.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,a=e[0],i=e[1],s=e[2],o=e[3],l={};return l.lowerLeft_X=r(a)||0,l.lowerLeft_Y=n(i+o)||0,l.upperRight_X=r(a+s)||0,l.upperRight_Y=n(i)||0,[Number(Ft(l.lowerLeft_X)),Number(Ft(l.lowerLeft_Y)),Number(Ft(l.upperRight_X)),Number(Ft(l.upperRight_Y))]},TZ=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=zg(e,r),a=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+a+" "+Ft(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var i=Ji(e);return i.scope=e.scope,i.stream=t.join(`
`),i}},zg=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},a=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");a=e.multiline?a.map(function(E){return E.split(`
`)}):a.map(function(E){return[E]});var i=r,s=dt.internal.getHeight(e)||0;s=s<0?-s:s;var o=dt.internal.getWidth(e)||0;o=o<0?-o:o;var l=function(E,C,G){if(E+1<a.length){var Z=C+" "+a[E+1][0];return bh(Z,e,G).width<=o-4}return!1};i++;e:for(;i>0;){t="",i--;var c,f,h=bh("3",e,i).height,p=e.multiline?s-i:(s-h)/2,d=p+=2,x=0,g=0,y=0;if(i<=0){t=`(...) Tj
`,t+="% Width of Text: "+bh(t,e,i=12).width+", FieldWidth:"+o+`
`;break}for(var b="",T=0,S=0;S<a.length;S++)if(a.hasOwnProperty(S)){var k=!1;if(a[S].length!==1&&y!==a[S].length-1){if((h+2)*(T+2)+2>s)continue e;b+=a[S][y],k=!0,g=S,S--}else{b=(b+=a[S][y]+" ").substr(b.length-1)==" "?b.substr(0,b.length-1):b;var A=parseInt(S),M=l(A,b,i),O=S>=a.length-1;if(M&&!O){b+=" ",y=0;continue}if(M||O){if(O)g=A;else if(e.multiline&&(h+2)*(T+2)+2>s)continue e}else{if(!e.multiline||(h+2)*(T+2)+2>s)continue e;g=A}}for(var I="",j=x;j<=g;j++){var W=a[j];if(e.multiline){if(j===g){I+=W[y]+" ",y=(y+1)%W.length;continue}if(j===x){I+=W[W.length-1]+" ";continue}}I+=W[0]+" "}switch(I=I.substr(I.length-1)==" "?I.substr(0,I.length-1):I,f=bh(I,e,i).width,e.textAlign){case"right":c=o-f-2;break;case"center":c=(o-f)/2;break;default:c=2}t+=Ft(c)+" "+Ft(d)+` Td
`,t+="("+Gl(I)+`) Tj
`,t+=-Ft(c)+` 0 Td
`,d=-(i+2),f=0,x=k?g:g+1,T++,b=""}break}return n.text=t,n.fontSize=i,n},bh=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),a=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:a}},jZ={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},PZ=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},kZ=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(Ri.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(jZ)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");d2=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new mT,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in n)if(n.hasOwnProperty(a)){var i=n[a];i.objId=void 0,i.hasAnnotation&&PZ(i,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,a){var i=!n;for(var s in n||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(s)){var o=n[s],l=[],c=o.Rect;if(o.Rect&&(o.Rect=EZ(o.Rect,a)),a.internal.newObjectDeferredBegin(o.objId,!0),o.DA=dt.createDefaultAppearanceStream(o),fr(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(l=o.getKeyValueListForStream()),o.Rect=c,o.hasAppearanceStream&&!o.appearanceStreamContent){var f=TZ(o);l.push({key:"AP",value:"<</N "+f+">>"}),a.internal.acroformPlugin.xForms.push(f)}if(o.appearanceStreamContent){var h="";for(var p in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(p)){var d=o.appearanceStreamContent[p];if(h+="/"+p+" ",h+="<<",Object.keys(d).length>=1||Array.isArray(d)){for(var s in d)if(d.hasOwnProperty(s)){var x=d[s];typeof x=="function"&&(x=x.call(a,o)),h+="/"+s+" "+x+" ",a.internal.acroformPlugin.xForms.indexOf(x)>=0||a.internal.acroformPlugin.xForms.push(x)}}else typeof(x=d)=="function"&&(x=x.call(a,o)),h+="/"+s+" "+x,a.internal.acroformPlugin.xForms.indexOf(x)>=0||a.internal.acroformPlugin.xForms.push(x);h+=">>"}l.push({key:"AP",value:`<<
`+h+">>"})}a.internal.putStream({additionalKeyValues:l,objectId:o.objId}),a.internal.out("endobj")}i&&function(g,y){for(var b in g)if(g.hasOwnProperty(b)){var T=b,S=g[b];y.internal.newObjectDeferredBegin(S.objId,!0),fr(S)==="object"&&typeof S.putStream=="function"&&S.putStream(),delete g[T]}}(a.internal.acroformPlugin.xForms,a)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},dT=Ur.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(s){return s};if(Array.isArray(e)){for(var a="[",i=0;i<e.length;i++)switch(i!==0&&(a+=" "),fr(e[i])){case"boolean":case"number":case"object":a+=e[i].toString();break;case"string":e[i].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),a+="("+Gl(n(e[i].toString()))+")"):a+=e[i].toString()}return a+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},A1=function(e,t,r){var n=function(a){return a};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),"("+Gl(n(e))+")"},ts=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};ts.prototype.toString=function(){return this.objId+" 0 R"},ts.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},ts.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],a=this[n];a&&(Array.isArray(a)?e.push({key:n,value:dT(a,this.objId,this.scope)}):a instanceof ts?(a.scope=this.scope,e.push({key:n,value:a.objId+" 0 R"})):typeof a!="function"&&e.push({key:n,value:a}))}return e};var pT=function(){ts.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};Ta(pT,ts);var mT=function(){ts.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Gl(r(e))+")"}},set:function(r){e=r}})};Ta(mT,ts);var Ri=function e(){ts.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute F supplied.');t=b}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Xr(t,3)},set:function(b){b?this.F=Zr(t,3):this.F=Jr(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute Ff supplied.');r=b}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(b){n=b!==void 0?b:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(b){n[0]=b}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(b){n[1]=b}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(b){n[2]=b}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(b){n[3]=b}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(b){switch(b){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=b;break;default:throw new Error('Invalid value "'+b+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof Ld)return;i="FieldObject"+e.FieldNum++}var b=function(T){return T};return this.scope&&(b=this.scope.internal.getEncryptor(this.objId)),"("+Gl(b(i))+")"},set:function(b){i=b.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(b){i=b}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(b){s=b}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(b){o=b}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(b){l=b}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return c===void 0?50/d2:c},set:function(b){c=b}});var f="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return f},set:function(b){f=b}});var h="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!h||this instanceof Ld||this instanceof Nl))return A1(h,this.objId,this.scope)},set:function(b){b=b.toString(),h=b}});var p=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof Nn==0?A1(p,this.objId,this.scope):p},set:function(b){b=b.toString(),p=this instanceof Nn==0?b.substr(0,1)==="("?hc(b.substr(1,b.length-2)):hc(b):b}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof Nn==1?hc(p.substr(1,p.length-1)):p},set:function(b){b=b.toString(),p=this instanceof Nn==1?"/"+b:b}});var d=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(d)return d},set:function(b){this.V=b}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(d)return this instanceof Nn==0?A1(d,this.objId,this.scope):d},set:function(b){b=b.toString(),d=this instanceof Nn==0?b.substr(0,1)==="("?hc(b.substr(1,b.length-2)):hc(b):b}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof Nn==1?hc(d.substr(1,d.length-1)):d},set:function(b){b=b.toString(),d=this instanceof Nn==1?"/"+b:b}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var x,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(b){b=!!b,g=b}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(x)return x},set:function(b){x=b}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Xr(this.Ff,1)},set:function(b){b?this.Ff=Zr(this.Ff,1):this.Ff=Jr(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Xr(this.Ff,2)},set:function(b){b?this.Ff=Zr(this.Ff,2):this.Ff=Jr(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Xr(this.Ff,3)},set:function(b){b?this.Ff=Zr(this.Ff,3):this.Ff=Jr(this.Ff,3)}});var y=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(y!==null)return y},set:function(b){if([0,1,2].indexOf(b)===-1)throw new Error('Invalid value "'+b+'" for attribute Q supplied.');y=b}}),Object.defineProperty(this,"textAlign",{get:function(){var b;switch(y){case 0:default:b="left";break;case 1:b="center";break;case 2:b="right"}return b},configurable:!0,enumerable:!0,set:function(b){switch(b){case"right":case 2:y=2;break;case"center":case 1:y=1;break;default:y=0}}})};Ta(Ri,ts);var Lc=function(){Ri.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return dT(t,this.objId,this.scope)},set:function(r){var n,a;a=[],typeof(n=r)=="string"&&(a=function(i,s,o){o||(o=1);for(var l,c=[];l=s.exec(i);)c.push(l[o]);return c}(n,/\((.*?)\)/g)),t=a}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Xr(this.Ff,18)},set:function(r){r?this.Ff=Zr(this.Ff,18):this.Ff=Jr(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Xr(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Zr(this.Ff,19):this.Ff=Jr(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Xr(this.Ff,20)},set:function(r){r?(this.Ff=Zr(this.Ff,20),t.sort()):this.Ff=Jr(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Xr(this.Ff,22)},set:function(r){r?this.Ff=Zr(this.Ff,22):this.Ff=Jr(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Xr(this.Ff,23)},set:function(r){r?this.Ff=Zr(this.Ff,23):this.Ff=Jr(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Xr(this.Ff,27)},set:function(r){r?this.Ff=Zr(this.Ff,27):this.Ff=Jr(this.Ff,27)}}),this.hasAppearanceStream=!1};Ta(Lc,Ri);var Fc=function(){Lc.call(this),this.fontName="helvetica",this.combo=!1};Ta(Fc,Lc);var Dc=function(){Fc.call(this),this.combo=!0};Ta(Dc,Fc);var jh=function(){Dc.call(this),this.edit=!0};Ta(jh,Dc);var Nn=function(){Ri.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Xr(this.Ff,15)},set:function(r){r?this.Ff=Zr(this.Ff,15):this.Ff=Jr(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Xr(this.Ff,16)},set:function(r){r?this.Ff=Zr(this.Ff,16):this.Ff=Jr(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Xr(this.Ff,17)},set:function(r){r?this.Ff=Zr(this.Ff,17):this.Ff=Jr(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Xr(this.Ff,26)},set:function(r){r?this.Ff=Zr(this.Ff,26):this.Ff=Jr(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(i){return i};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,a=[];for(n in a.push("<<"),t)a.push("/"+n+" ("+Gl(r(t[n]))+")");return a.push(">>"),a.join(`
`)}},set:function(r){fr(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};Ta(Nn,Ri);var Ph=function(){Nn.call(this),this.pushButton=!0};Ta(Ph,Nn);var Ic=function(){Nn.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};Ta(Ic,Nn);var Ld=function(){var e,t;Ri.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(a){e=a}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(a){t=a}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(o){return o};this.scope&&(a=this.scope.internal.getEncryptor(this.objId));var i,s=[];for(i in s.push("<<"),n)s.push("/"+i+" ("+Gl(a(n[i]))+")");return s.push(">>"),s.join(`
`)},set:function(a){fr(a)==="object"&&(n=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(a){typeof a=="string"&&(n.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(a){r=a}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(a){r="/"+a}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=dt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Ta(Ld,Ri),Ic.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},Ic.prototype.createOption=function(e){var t=new Ld;return t.Parent=this,t.optionName=e,this.Kids.push(t),CZ.call(this.scope,t),t};var kh=function(){Nn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=dt.CheckBox.createAppearanceStream()};Ta(kh,Nn);var Nl=function(){Ri.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Xr(this.Ff,13)},set:function(t){t?this.Ff=Zr(this.Ff,13):this.Ff=Jr(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Xr(this.Ff,21)},set:function(t){t?this.Ff=Zr(this.Ff,21):this.Ff=Jr(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Xr(this.Ff,23)},set:function(t){t?this.Ff=Zr(this.Ff,23):this.Ff=Jr(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Xr(this.Ff,24)},set:function(t){t?this.Ff=Zr(this.Ff,24):this.Ff=Jr(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Xr(this.Ff,25)},set:function(t){t?this.Ff=Zr(this.Ff,25):this.Ff=Jr(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Xr(this.Ff,26)},set:function(t){t?this.Ff=Zr(this.Ff,26):this.Ff=Jr(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Ta(Nl,Ri);var Ch=function(){Nl.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Xr(this.Ff,14)},set:function(e){e?this.Ff=Zr(this.Ff,14):this.Ff=Jr(this.Ff,14)}}),this.password=!0};Ta(Ch,Nl);var dt={CheckBox:{createAppearanceStream:function(){return{N:{On:dt.CheckBox.YesNormal},D:{On:dt.CheckBox.YesPushDown,Off:dt.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=Ji(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),i=zg(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+Ft(dt.internal.getWidth(e))+" "+Ft(dt.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Ft(i.fontSize)+" Tf "+a),r.push("BT"),r.push(i.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=Ji(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),a=[],i=dt.internal.getHeight(e),s=dt.internal.getWidth(e),o=zg(e,e.caption);return a.push("1 g"),a.push("0 0 "+Ft(s)+" "+Ft(i)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+Ft(s-1)+" "+Ft(i-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+r+" "+Ft(o.fontSize)+" Tf "+n),a.push(o.text),a.push("ET"),a.push("Q"),t.stream=a.join(`
`),t},OffPushDown:function(e){var t=Ji(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Ft(dt.internal.getWidth(e))+" "+Ft(dt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:dt.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=dt.RadioButton.Circle.YesNormal,t.D[e]=dt.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=Ji(e);t.scope=e.scope;var r=[],n=dt.internal.getWidth(e)<=dt.internal.getHeight(e)?dt.internal.getWidth(e)/4:dt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=dt.internal.Bezier_C,i=Number((n*a).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+ho(dt.internal.getWidth(e)/2)+" "+ho(dt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Ji(e);t.scope=e.scope;var r=[],n=dt.internal.getWidth(e)<=dt.internal.getHeight(e)?dt.internal.getWidth(e)/4:dt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),i=Number((a*dt.internal.Bezier_C).toFixed(5)),s=Number((n*dt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+ho(dt.internal.getWidth(e)/2)+" "+ho(dt.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+ho(dt.internal.getWidth(e)/2)+" "+ho(dt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=Ji(e);t.scope=e.scope;var r=[],n=dt.internal.getWidth(e)<=dt.internal.getHeight(e)?dt.internal.getWidth(e)/4:dt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),i=Number((a*dt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+ho(dt.internal.getWidth(e)/2)+" "+ho(dt.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:dt.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=dt.RadioButton.Cross.YesNormal,t.D[e]=dt.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=Ji(e);t.scope=e.scope;var r=[],n=dt.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+Ft(dt.internal.getWidth(e)-2)+" "+Ft(dt.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(Ft(n.x1.x)+" "+Ft(n.x1.y)+" m"),r.push(Ft(n.x2.x)+" "+Ft(n.x2.y)+" l"),r.push(Ft(n.x4.x)+" "+Ft(n.x4.y)+" m"),r.push(Ft(n.x3.x)+" "+Ft(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Ji(e);t.scope=e.scope;var r=dt.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+Ft(dt.internal.getWidth(e))+" "+Ft(dt.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Ft(dt.internal.getWidth(e)-2)+" "+Ft(dt.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(Ft(r.x1.x)+" "+Ft(r.x1.y)+" m"),n.push(Ft(r.x2.x)+" "+Ft(r.x2.y)+" l"),n.push(Ft(r.x4.x)+" "+Ft(r.x4.y)+" m"),n.push(Ft(r.x3.x)+" "+Ft(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=Ji(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Ft(dt.internal.getWidth(e))+" "+Ft(dt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};dt.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=dt.internal.getWidth(e),r=dt.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},dt.internal.getWidth=function(e){var t=0;return fr(e)==="object"&&(t=k_(e.Rect[2])),t},dt.internal.getHeight=function(e){var t=0;return fr(e)==="object"&&(t=k_(e.Rect[3])),t};var CZ=Ur.addField=function(e){if(kZ(this,e),!(e instanceof Ri))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};Ur.AcroFormChoiceField=Lc,Ur.AcroFormListBox=Fc,Ur.AcroFormComboBox=Dc,Ur.AcroFormEditBox=jh,Ur.AcroFormButton=Nn,Ur.AcroFormPushButton=Ph,Ur.AcroFormRadioButton=Ic,Ur.AcroFormCheckBox=kh,Ur.AcroFormTextField=Nl,Ur.AcroFormPasswordField=Ch,Ur.AcroFormAppearance=dt,Ur.AcroForm={ChoiceField:Lc,ListBox:Fc,ComboBox:Dc,EditBox:jh,Button:Nn,PushButton:Ph,RadioButton:Ic,CheckBox:kh,TextField:Nl,PasswordField:Ch,Appearance:dt},St.AcroForm={ChoiceField:Lc,ListBox:Fc,ComboBox:Dc,EditBox:jh,Button:Nn,PushButton:Ph,RadioButton:Ic,CheckBox:kh,TextField:Nl,PasswordField:Ch,Appearance:dt};function gT(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){var t="addImage_";e.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},a=e.__addimage__.getImageFileTypeByImageData=function(E,C){var G,Z,he,oe,me,pe=r;if((C=C||r)==="RGBA"||E.data!==void 0&&E.data instanceof Uint8ClampedArray&&"height"in E&&"width"in E)return"RGBA";if(M(E))for(me in n)for(he=n[me],G=0;G<he.length;G+=1){for(oe=!0,Z=0;Z<he[G].length;Z+=1)if(he[G][Z]!==void 0&&he[G][Z]!==E[Z]){oe=!1;break}if(oe===!0){pe=me;break}}else for(me in n)for(he=n[me],G=0;G<he.length;G+=1){for(oe=!0,Z=0;Z<he[G].length;Z+=1)if(he[G][Z]!==void 0&&he[G][Z]!==E.charCodeAt(Z)){oe=!1;break}if(oe===!0){pe=me;break}}return pe===r&&C!==r&&(pe=C),pe},i=function E(C){for(var G=this.internal.write,Z=this.internal.putStream,he=(0,this.internal.getFilters)();he.indexOf("FlateEncode")!==-1;)he.splice(he.indexOf("FlateEncode"),1);C.objectId=this.internal.newObject();var oe=[];if(oe.push({key:"Type",value:"/XObject"}),oe.push({key:"Subtype",value:"/Image"}),oe.push({key:"Width",value:C.width}),oe.push({key:"Height",value:C.height}),C.colorSpace===b.INDEXED?oe.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(C.palette.length/3-1)+" "+("sMask"in C&&C.sMask!==void 0?C.objectId+2:C.objectId+1)+" 0 R]"}):(oe.push({key:"ColorSpace",value:"/"+C.colorSpace}),C.colorSpace===b.DEVICE_CMYK&&oe.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),oe.push({key:"BitsPerComponent",value:C.bitsPerComponent}),"decodeParameters"in C&&C.decodeParameters!==void 0&&oe.push({key:"DecodeParms",value:"<<"+C.decodeParameters+">>"}),"transparency"in C&&Array.isArray(C.transparency)){for(var me="",pe=0,ge=C.transparency.length;pe<ge;pe++)me+=C.transparency[pe]+" "+C.transparency[pe]+" ";oe.push({key:"Mask",value:"["+me+"]"})}C.sMask!==void 0&&oe.push({key:"SMask",value:C.objectId+1+" 0 R"});var Le=C.filter!==void 0?["/"+C.filter]:void 0;if(Z({data:C.data,additionalKeyValues:oe,alreadyAppliedFilters:Le,objectId:C.objectId}),G("endobj"),"sMask"in C&&C.sMask!==void 0){var Se=(C.predictor!=null?"/Predictor "+C.predictor:"")+" /Colors 1 /BitsPerComponent 8 /Columns "+C.width,N={width:C.width,height:C.height,colorSpace:"DeviceGray",bitsPerComponent:C.bitsPerComponent,decodeParameters:Se,data:C.sMask};"filter"in C&&(N.filter=C.filter),E.call(this,N)}if(C.colorSpace===b.INDEXED){var D=this.internal.newObject();Z({data:I(new Uint8Array(C.palette)),objectId:D}),G("endobj")}},s=function(){var E=this.internal.collections[t+"images"];for(var C in E)i.call(this,E[C])},o=function(){var E,C=this.internal.collections[t+"images"],G=this.internal.write;for(var Z in C)G("/I"+(E=C[Z]).index,E.objectId,"0","R")},l=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",o))},c=function(){var E=this.internal.collections[t+"images"];return l.call(this),E},f=function(){return Object.keys(this.internal.collections[t+"images"]).length},h=function(E){return typeof e["process"+E.toUpperCase()]=="function"},p=function(E){return fr(E)==="object"&&E.nodeType===1},d=function(E,C){if(E.nodeName==="IMG"&&E.hasAttribute("src")){var G=""+E.getAttribute("src");if(G.indexOf("data:image/")===0)return Th(unescape(G).split("base64,").pop());var Z=e.loadFile(G,!0);if(Z!==void 0)return Z}if(E.nodeName==="CANVAS"){if(E.width===0||E.height===0)throw new Error("Given canvas must have data. Canvas width: "+E.width+", height: "+E.height);var he;switch(C){case"PNG":he="image/png";break;case"WEBP":he="image/webp";break;default:he="image/jpeg"}return Th(E.toDataURL(he,1).split("base64,").pop())}},x=function(E){var C=this.internal.collections[t+"images"];if(C){for(var G in C)if(E===C[G].alias)return C[G]}},g=function(E,C,G){return E||C||(E=-96,C=-96),E<0&&(E=-1*G.width*72/E/this.internal.scaleFactor),C<0&&(C=-1*G.height*72/C/this.internal.scaleFactor),E===0&&(E=C*G.width/G.height),C===0&&(C=E*G.height/G.width),[E,C]},y=function(E,C,G,Z,he,oe){var me=g.call(this,G,Z,he),pe=this.internal.getCoordinateString,ge=this.internal.getVerticalCoordinateString,Le=c.call(this);if(G=me[0],Z=me[1],Le[he.index]=he,oe){oe*=Math.PI/180;var Se=Math.cos(oe),N=Math.sin(oe),D=function(F){return F.toFixed(4)},L=[D(Se),D(N),D(-1*N),D(Se),0,0,"cm"]}this.internal.write("q"),oe?(this.internal.write([1,"0","0",1,pe(E),ge(C+Z),"cm"].join(" ")),this.internal.write(L.join(" ")),this.internal.write([pe(G),"0","0",pe(Z),"0","0","cm"].join(" "))):this.internal.write([pe(G),"0","0",pe(Z),pe(E),ge(C+Z),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+he.index+" Do"),this.internal.write("Q")},b=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var T=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},S=e.__addimage__.sHashCode=function(E){var C,G,Z=0;if(typeof E=="string")for(G=E.length,C=0;C<G;C++)Z=(Z<<5)-Z+E.charCodeAt(C),Z|=0;else if(M(E))for(G=E.byteLength/2,C=0;C<G;C++)Z=(Z<<5)-Z+E[C],Z|=0;return Z},k=e.__addimage__.validateStringAsBase64=function(E){(E=E||"").toString().trim();var C=!0;return E.length===0&&(C=!1),E.length%4!=0&&(C=!1),/^[A-Za-z0-9+/]+$/.test(E.substr(0,E.length-2))===!1&&(C=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(E.substr(-2))===!1&&(C=!1),C},A=e.__addimage__.extractImageFromDataUrl=function(E){if(E==null||!(E=E.trim()).startsWith("data:"))return null;var C=E.indexOf(",");return C<0?null:E.substring(0,C).trim().endsWith("base64")?E.substring(C+1):null};e.__addimage__.isArrayBuffer=function(E){return E instanceof ArrayBuffer};var M=e.__addimage__.isArrayBufferView=function(E){return E instanceof Int8Array||E instanceof Uint8Array||E instanceof Uint8ClampedArray||E instanceof Int16Array||E instanceof Uint16Array||E instanceof Int32Array||E instanceof Uint32Array||E instanceof Float32Array||E instanceof Float64Array},O=e.__addimage__.binaryStringToUint8Array=function(E){for(var C=E.length,G=new Uint8Array(C),Z=0;Z<C;Z++)G[Z]=E.charCodeAt(Z);return G},I=e.__addimage__.arrayBufferToBinaryString=function(E){for(var C="",G=M(E)?E:new Uint8Array(E),Z=0;Z<G.length;Z+=8192)C+=String.fromCharCode.apply(null,G.subarray(Z,Z+8192));return C};e.addImage=function(){var E,C,G,Z,he,oe,me,pe,ge;if(typeof arguments[1]=="number"?(C=r,G=arguments[1],Z=arguments[2],he=arguments[3],oe=arguments[4],me=arguments[5],pe=arguments[6],ge=arguments[7]):(C=arguments[1],G=arguments[2],Z=arguments[3],he=arguments[4],oe=arguments[5],me=arguments[6],pe=arguments[7],ge=arguments[8]),fr(E=arguments[0])==="object"&&!p(E)&&"imageData"in E){var Le=E;E=Le.imageData,C=Le.format||C||r,G=Le.x||G||0,Z=Le.y||Z||0,he=Le.w||Le.width||he,oe=Le.h||Le.height||oe,me=Le.alias||me,pe=Le.compression||pe,ge=Le.rotation||Le.angle||ge}var Se=this.internal.getFilters();if(pe===void 0&&Se.indexOf("FlateEncode")!==-1&&(pe="SLOW"),isNaN(G)||isNaN(Z))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var N=j.call(this,E,C,me,pe);return y.call(this,G,Z,he,oe,N,ge),this};var j=function(E,C,G,Z){var he,oe,me;if(typeof E=="string"&&a(E)===r){E=unescape(E);var pe=W(E,!1);(pe!==""||(pe=e.loadFile(E,!0))!==void 0)&&(E=pe)}if(p(E)&&(E=d(E,C)),C=a(E,C),!h(C))throw new Error("addImage does not support files of type '"+C+"', please ensure that a plugin for '"+C+"' support is added.");if(((me=G)==null||me.length===0)&&(G=function(ge){return typeof ge=="string"||M(ge)?S(ge):M(ge.data)?S(ge.data):null}(E)),(he=x.call(this,G))||(E instanceof Uint8Array||C==="RGBA"||(oe=E,E=O(E)),he=this["process"+C.toUpperCase()](E,f.call(this),G,function(ge){return ge&&typeof ge=="string"&&(ge=ge.toUpperCase()),ge in e.image_compression?ge:T.NONE}(Z),oe)),!he)throw new Error("An unknown error occurred whilst processing the image.");return he},W=e.__addimage__.convertBase64ToBinaryString=function(E,C){C=typeof C!="boolean"||C;var G,Z="";if(typeof E=="string"){var he;G=(he=A(E))!==null&&he!==void 0?he:E;try{Z=Th(G)}catch(oe){if(C)throw k(G)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+oe.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return Z};e.getImageProperties=function(E){var C,G,Z="";if(p(E)&&(E=d(E)),typeof E=="string"&&a(E)===r&&((Z=W(E,!1))===""&&(Z=e.loadFile(E)||""),E=Z),G=a(E),!h(G))throw new Error("addImage does not support files of type '"+G+"', please ensure that a plugin for '"+G+"' support is added.");if(E instanceof Uint8Array||(E=O(E)),!(C=this["process"+G.toUpperCase()](E)))throw new Error("An unknown error occurred whilst processing the image");return C.fileType=G,C}})(St.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};St.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,a,i,s=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(r.objId),c=r.pageContext.annotations,f=!1,h=0;h<c.length&&!f;h++)switch((n=c[h]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(f=!0);break;case"reference":case"text":case"freetext":f=!0}if(f!=0){this.internal.write("/Annots [");for(var p=0;p<c.length;p++){n=c[p];var d=this.internal.pdfEscape,x=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var g=this.internal.newAdditionalObject(),y=this.internal.newAdditionalObject(),b=this.internal.getEncryptor(g.objId),T=n.title||"Note";i="<</Type /Annot /Subtype /Text "+(a="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+d(b(n.contents))+")",i+=" /Popup "+y.objId+" 0 R",i+=" /P "+l.objId+" 0 R",i+=" /T ("+d(b(T))+") >>",g.content=i;var S=g.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+s(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+S,n.open&&(i+=" /Open true"),i+=" >>",y.content=i,this.internal.write(g.objId,"0 R",y.objId,"0 R");break;case"freetext":a="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var k=n.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+d(x(n.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+k+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(n.options.name){var A=this.annotations._nameMap[n.options.name];n.options.pageNumber=A.page,n.options.top=A.y}else n.options.top||(n.options.top=0);if(a="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",i="",n.options.url)i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+d(x(n.options.url))+") >>";else if(n.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,i+=" /FitV "+n.options.left+"]";break;default:var M=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),i+=" /XYZ "+n.options.left+" "+M+" "+n.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,a,i,s){var o=this.internal.getCurrentPageInfo(),l=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:l(r),y:c(n),w:l(r+a),h:c(n+i)},options:s,type:"link"})},e.textWithLink=function(r,n,a,i){var s,o,l=this.getTextWidth(r),c=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){o=i.maxWidth;var f=this.splitTextToSize(r,o).length;s=Math.ceil(c*f)}else o=l,s=c;return this.text(r,n,a,i),a+=.2*c,i.align==="center"&&(n-=l/2),i.align==="right"&&(n-=l),this.link(n,a-c,o,s,i),l},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(St.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];e.__arabicParser__={};var i=e.__arabicParser__.isInArabicSubstitutionA=function(g){return t[g.charCodeAt(0)]!==void 0},s=e.__arabicParser__.isArabicLetter=function(g){return typeof g=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(g)},o=e.__arabicParser__.isArabicEndLetter=function(g){return s(g)&&i(g)&&t[g.charCodeAt(0)].length<=2},l=e.__arabicParser__.isArabicAlfLetter=function(g){return s(g)&&a.indexOf(g.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(g){return s(g)&&i(g)&&t[g.charCodeAt(0)].length>=1};var c=e.__arabicParser__.arabicLetterHasFinalForm=function(g){return s(g)&&i(g)&&t[g.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(g){return s(g)&&i(g)&&t[g.charCodeAt(0)].length>=3};var f=e.__arabicParser__.arabicLetterHasMedialForm=function(g){return s(g)&&i(g)&&t[g.charCodeAt(0)].length==4},h=e.__arabicParser__.resolveLigatures=function(g){var y=0,b=r,T="",S=0;for(y=0;y<g.length;y+=1)b[g.charCodeAt(y)]!==void 0?(S++,typeof(b=b[g.charCodeAt(y)])=="number"&&(T+=String.fromCharCode(b),b=r,S=0),y===g.length-1&&(b=r,T+=g.charAt(y-(S-1)),y-=S-1,S=0)):(b=r,T+=g.charAt(y-S),y-=S,S=0);return T};e.__arabicParser__.isArabicDiacritic=function(g){return g!==void 0&&n[g.charCodeAt(0)]!==void 0};var p=e.__arabicParser__.getCorrectForm=function(g,y,b){return s(g)?i(g)===!1?-1:!c(g)||!s(y)&&!s(b)||!s(b)&&o(y)||o(g)&&!s(y)||o(g)&&l(y)||o(g)&&o(y)?0:f(g)&&s(y)&&!o(y)&&s(b)&&c(b)?3:o(g)||!s(b)?1:2:-1},d=function(g){var y=0,b=0,T=0,S="",k="",A="",M=(g=g||"").split("\\s+"),O=[];for(y=0;y<M.length;y+=1){for(O.push(""),b=0;b<M[y].length;b+=1)S=M[y][b],k=M[y][b-1],A=M[y][b+1],s(S)?(T=p(S,k,A),O[y]+=T!==-1?String.fromCharCode(t[S.charCodeAt(0)][T]):S):O[y]+=S;O[y]=h(O[y])}return O.join(" ")},x=e.__arabicParser__.processArabic=e.processArabic=function(){var g,y=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,b=[];if(Array.isArray(y)){var T=0;for(b=[],T=0;T<y.length;T+=1)Array.isArray(y[T])?b.push([d(y[T][0]),y[T][1],y[T][2]]):b.push([d(y[T])]);g=b}else g=d(y);return typeof arguments[0]=="string"?g:(arguments[0].text=g,arguments[0])};e.events.push(["preProcessText",x])}(St.API),St.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(o){r=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(o){a=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(o){i=o}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(o){s=o}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var a;if((r=r||"2d")!=="2d")return null;for(a in n)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=n[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(St.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var l=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return l},set:function(g){l=g}});var c=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return c},set:function(g){c=g}});var f=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return f},set:function(g){f=g}});var h=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return h},set:function(g){h=g}});var p=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return p},set:function(g){p=g}});var d=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return d},set:function(g){d=g}});var x=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return x},set:function(g){x=g}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(l){return n.call(this),this.internal.__cell__.headerFunction=typeof l=="function"?l:void 0,this},e.getTextDimensions=function(l,c){n.call(this);var f=(c=c||{}).fontSize||this.getFontSize(),h=c.font||this.getFont(),p=c.scaleFactor||this.internal.scaleFactor,d=0,x=0,g=0,y=this;if(!Array.isArray(l)&&typeof l!="string"){if(typeof l!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");l=String(l)}var b=c.maxWidth;b>0?typeof l=="string"?l=this.splitTextToSize(l,b):Object.prototype.toString.call(l)==="[object Array]"&&(l=l.reduce(function(S,k){return S.concat(y.splitTextToSize(k,b))},[])):l=Array.isArray(l)?l:[l];for(var T=0;T<l.length;T++)d<(g=this.getStringUnitWidth(l[T],{font:h})*f)&&(d=g);return d!==0&&(x=l.length),{w:d/=p,h:Math.max((x*f*this.getLineHeightFactor()-f*(this.getLineHeightFactor()-1))/p,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var l=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new i(l.left,l.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=e.cell=function(){var l;l=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var c=this.internal.__cell__.lastCell,f=this.internal.__cell__.padding,h=this.internal.__cell__.margins||t,p=this.internal.__cell__.tableHeaderRow,d=this.internal.__cell__.printHeaders;return c.lineNumber!==void 0&&(c.lineNumber===l.lineNumber?(l.x=(c.x||0)+(c.width||0),l.y=c.y||0):c.y+c.height+l.height+h.bottom>this.getPageHeight()?(this.cellAddPage(),l.y=h.top,d&&p&&(this.printHeaderRow(l.lineNumber,!0),l.y+=p[0].height)):l.y=c.y+c.height||l.y),l.text[0]!==void 0&&(this.rect(l.x,l.y,l.width,l.height,r===!0?"FD":void 0),l.align==="right"?this.text(l.text,l.x+l.width-f,l.y+f,{align:"right",baseline:"top"}):l.align==="center"?this.text(l.text,l.x+l.width/2,l.y+f,{align:"center",baseline:"top",maxWidth:l.width-f-f}):this.text(l.text,l.x+f,l.y+f,{align:"left",baseline:"top",maxWidth:l.width-f-f})),this.internal.__cell__.lastCell=l,this};e.table=function(l,c,f,h,p){if(n.call(this),!f)throw new Error("No data for PDF table.");var d,x,g,y,b=[],T=[],S=[],k={},A={},M=[],O=[],I=(p=p||{}).autoSize||!1,j=p.printHeaders!==!1,W=p.css&&p.css["font-size"]!==void 0?16*p.css["font-size"]:p.fontSize||12,E=p.margins||Object.assign({width:this.getPageWidth()},t),C=typeof p.padding=="number"?p.padding:3,G=p.headerBackgroundColor||"#c8c8c8",Z=p.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=j,this.internal.__cell__.margins=E,this.internal.__cell__.table_font_size=W,this.internal.__cell__.padding=C,this.internal.__cell__.headerBackgroundColor=G,this.internal.__cell__.headerTextColor=Z,this.setFontSize(W),h==null)T=b=Object.keys(f[0]),S=b.map(function(){return"left"});else if(Array.isArray(h)&&fr(h[0])==="object")for(b=h.map(function(Le){return Le.name}),T=h.map(function(Le){return Le.prompt||Le.name||""}),S=h.map(function(Le){return Le.align||"left"}),d=0;d<h.length;d+=1)A[h[d].name]=.7499990551181103*h[d].width;else Array.isArray(h)&&typeof h[0]=="string"&&(T=b=h,S=b.map(function(){return"left"}));if(I||Array.isArray(h)&&typeof h[0]=="string")for(d=0;d<b.length;d+=1){for(k[y=b[d]]=f.map(function(Le){return Le[y]}),this.setFont(void 0,"bold"),M.push(this.getTextDimensions(T[d],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),x=k[y],this.setFont(void 0,"normal"),g=0;g<x.length;g+=1)M.push(this.getTextDimensions(x[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);A[y]=Math.max.apply(null,M)+C+C,M=[]}if(j){var he={};for(d=0;d<b.length;d+=1)he[b[d]]={},he[b[d]].text=T[d],he[b[d]].align=S[d];var oe=o.call(this,he,A);O=b.map(function(Le){return new i(l,c,A[Le],oe,he[Le].text,void 0,he[Le].align)}),this.setTableHeaderRow(O),this.printHeaderRow(1,!1)}var me=h.reduce(function(Le,Se){return Le[Se.name]=Se.align,Le},{});for(d=0;d<f.length;d+=1){"rowStart"in p&&p.rowStart instanceof Function&&p.rowStart({row:d,data:f[d]},this);var pe=o.call(this,f[d],A);for(g=0;g<b.length;g+=1){var ge=f[d][b[g]];"cellStart"in p&&p.cellStart instanceof Function&&p.cellStart({row:d,col:g,data:ge},this),s.call(this,new i(l,c,A[b[g]],pe,ge,d+2,me[b[g]]))}}return this.internal.__cell__.table_x=l,this.internal.__cell__.table_y=c,this};var o=function(l,c){var f=this.internal.__cell__.padding,h=this.internal.__cell__.table_font_size,p=this.internal.scaleFactor;return Object.keys(l).map(function(d){var x=l[d];return this.splitTextToSize(x.hasOwnProperty("text")?x.text:x,c[d]-f-f)},this).map(function(d){return this.getLineHeightFactor()*d.length*h/p+f+f},this).reduce(function(d,x){return Math.max(d,x)},0)};e.setTableHeaderRow=function(l){n.call(this),this.internal.__cell__.tableHeaderRow=l},e.printHeaderRow=function(l,c){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var f;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var h=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(h[0],h[1],h[2],h[3],void 0,-1)}this.setFont(void 0,"bold");for(var p=[],d=0;d<this.internal.__cell__.tableHeaderRow.length;d+=1){f=this.internal.__cell__.tableHeaderRow[d].clone(),c&&(f.y=this.internal.__cell__.margins.top||0,p.push(f)),f.lineNumber=l;var x=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,f),this.setTextColor(x)}p.length>0&&this.setTableHeaderRow(p),this.setFont(void 0,"normal"),r=!1}}(St.API);var xT={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},vT=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],qg=gT(vT),yT=[100,200,300,400,500,600,700,800,900],OZ=gT(yT);function E1(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(i){return xT[i=i||"normal"]?i:"normal"}(e.style),n=function(i){return i?typeof i=="number"?i>=100&&i<=900&&i%100==0?i:400:/^\d00$/.test(i)?parseInt(i):i==="bold"?700:400:400}(e.weight),a=function(i){return typeof qg[i=i||"normal"]=="number"?i:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:a,src:e.src||[],ref:e.ref||{name:t,style:[a,r,n].join(" ")}}}function C_(e,t,r,n){var a;for(a=r;a>=0&&a<t.length;a+=n)if(e[t[a]])return e[t[a]];for(a=r;a>=0&&a<t.length;a-=n)if(e[t[a]])return e[t[a]]}var LZ={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},O_={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function L_(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function F_(e){return e.trimLeft()}function FZ(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function DZ(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var wh,D_,I_,dc,_h,M_,R_,B_,T1=["times"];function U_(e,t,r,n){var a=4,i=z_;switch(n){case St.API.image_compression.FAST:a=1,i=$_;break;case St.API.image_compression.MEDIUM:a=6,i=q_;break;case St.API.image_compression.SLOW:a=9,i=W_}e=function(o,l,c,f){for(var h,p=o.length/l,d=new Uint8Array(o.length+p),x=[IZ,$_,z_,q_,W_],g=0;g<p;g+=1){var y=g*l,b=o.subarray(y,y+l);if(f)d.set(f(b,c,h),y+g);else{for(var T=x.length,S=[],k=0;k<T;k+=1)S[k]=x[k](b,c,h);var A=RZ(S.concat());d.set(S[A],y+g)}h=b}return d}(e,t,r,i);var s=kg(e,{level:a});return St.API.__addimage__.arrayBufferToBinaryString(s)}function IZ(e){var t=Array.apply([],e);return t.unshift(0),t}function $_(e,t){var r=e.length,n=[];n[0]=1;for(var a=0;a<r;a+=1){var i=e[a-t]||0;n[a+1]=e[a]-i+256&255}return n}function z_(e,t,r){var n=e.length,a=[];a[0]=2;for(var i=0;i<n;i+=1){var s=r&&r[i]||0;a[i+1]=e[i]-s+256&255}return a}function q_(e,t,r){var n=e.length,a=[];a[0]=3;for(var i=0;i<n;i+=1){var s=e[i-t]||0,o=r&&r[i]||0;a[i+1]=e[i]+256-(s+o>>>1)&255}return a}function W_(e,t,r){var n=e.length,a=[];a[0]=4;for(var i=0;i<n;i+=1){var s=MZ(e[i-t]||0,r&&r[i]||0,r&&r[i-t]||0);a[i+1]=e[i]-s+256&255}return a}function MZ(e,t,r){if(e===t&&t===r)return e;var n=Math.abs(t-r),a=Math.abs(e-r),i=Math.abs(e+t-r-r);return n<=a&&n<=i?e:a<=i?t:r}function RZ(e){var t=e.map(function(r){return r.reduce(function(n,a){return n+Math.abs(a)},0)});return t.indexOf(Math.min.apply(null,t))}function j1(e,t,r){var n=t*r,a=Math.floor(n/8),i=16-(n-8*a+r),s=(1<<r)-1;return bT(e,a)>>i&s}function H_(e,t,r,n){var a=r*n,i=Math.floor(a/8),s=16-(a-8*i+n),o=(1<<n)-1,l=(t&o)<<s;(function(c,f,h){if(f+1<c.byteLength)c.setUint16(f,h,!1);else{var p=h>>8&255;c.setUint8(f,p)}})(e,i,bT(e,i)&~(o<<s)&65535|l)}function bT(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function BZ(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,a=e[t++],i=a>>7,s=1<<1+(7&a);e[t++],e[t++];var o=null,l=null;i&&(o=t,l=s,t+=3*s);var c=!0,f=[],h=0,p=null,d=0,x=null;for(this.width=r,this.height=n;c&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,x=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((E=e[t++])>=0))throw Error("Invalid block size");if(E===0)break;t+=E}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var g=e[t++];h=e[t++]|e[t++]<<8,p=e[t++],1&g||(p=null),d=g>>2&7,t++;break;case 254:for(;;){if(!((E=e[t++])>=0))throw Error("Invalid block size");if(E===0)break;t+=E}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var y=e[t++]|e[t++]<<8,b=e[t++]|e[t++]<<8,T=e[t++]|e[t++]<<8,S=e[t++]|e[t++]<<8,k=e[t++],A=k>>6&1,M=1<<1+(7&k),O=o,I=l,j=!1;k>>7&&(j=!0,O=t,I=M,t+=3*M);var W=t;for(t++;;){var E;if(!((E=e[t++])>=0))throw Error("Invalid block size");if(E===0)break;t+=E}f.push({x:y,y:b,width:T,height:S,has_local_palette:j,palette_offset:O,palette_size:I,data_offset:W,data_length:t-W,transparent_index:p,interlaced:!!A,delay:h,disposal:d});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return f.length},this.loopCount=function(){return x},this.frameInfo=function(C){if(C<0||C>=f.length)throw new Error("Frame index out of range.");return f[C]},this.decodeAndBlitFrameBGRA=function(C,G){var Z=this.frameInfo(C),he=Z.width*Z.height,oe=new Uint8Array(he);G_(e,Z.data_offset,oe,he);var me=Z.palette_offset,pe=Z.transparent_index;pe===null&&(pe=256);var ge=Z.width,Le=r-ge,Se=ge,N=4*(Z.y*r+Z.x),D=4*((Z.y+Z.height)*r+Z.x),L=N,F=4*Le;Z.interlaced===!0&&(F+=4*r*7);for(var K=8,ce=0,xe=oe.length;ce<xe;++ce){var ee=oe[ce];if(Se===0&&(Se=ge,(L+=F)>=D&&(F=4*Le+4*r*(K-1),L=N+(ge+Le)*(K<<1),K>>=1)),ee===pe)L+=4;else{var fe=e[me+3*ee],le=e[me+3*ee+1],ue=e[me+3*ee+2];G[L++]=ue,G[L++]=le,G[L++]=fe,G[L++]=255}--Se}},this.decodeAndBlitFrameRGBA=function(C,G){var Z=this.frameInfo(C),he=Z.width*Z.height,oe=new Uint8Array(he);G_(e,Z.data_offset,oe,he);var me=Z.palette_offset,pe=Z.transparent_index;pe===null&&(pe=256);var ge=Z.width,Le=r-ge,Se=ge,N=4*(Z.y*r+Z.x),D=4*((Z.y+Z.height)*r+Z.x),L=N,F=4*Le;Z.interlaced===!0&&(F+=4*r*7);for(var K=8,ce=0,xe=oe.length;ce<xe;++ce){var ee=oe[ce];if(Se===0&&(Se=ge,(L+=F)>=D&&(F=4*Le+4*r*(K-1),L=N+(ge+Le)*(K<<1),K>>=1)),ee===pe)L+=4;else{var fe=e[me+3*ee],le=e[me+3*ee+1],ue=e[me+3*ee+2];G[L++]=fe,G[L++]=le,G[L++]=ue,G[L++]=255}--Se}}}function G_(e,t,r,n){for(var a=e[t++],i=1<<a,s=i+1,o=s+1,l=a+1,c=(1<<l)-1,f=0,h=0,p=0,d=e[t++],x=new Int32Array(4096),g=null;;){for(;f<16&&d!==0;)h|=e[t++]<<f,f+=8,d===1?d=e[t++]:--d;if(f<l)break;var y=h&c;if(h>>=l,f-=l,y!==i){if(y===s)break;for(var b=y<o?y:g,T=0,S=b;S>i;)S=x[S]>>8,++T;var k=S;if(p+T+(b!==y?1:0)>n)return void vr.log("Warning, gif stream longer than expected.");r[p++]=k;var A=p+=T;for(b!==y&&(r[p++]=k),S=b;T--;)S=x[S],r[--A]=255&S,S>>=8;g!==null&&o<4096&&(x[o++]=g<<8|k,o>=c+1&&l<12&&(++l,c=c<<1|1)),g=y}else o=s+1,c=(1<<(l=a+1))-1,g=null}return p!==n&&vr.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function P1(e){var t,r,n,a,i,s=Math.floor,o=new Array(64),l=new Array(64),c=new Array(64),f=new Array(64),h=new Array(65535),p=new Array(65535),d=new Array(64),x=new Array(64),g=[],y=0,b=7,T=new Array(64),S=new Array(64),k=new Array(64),A=new Array(256),M=new Array(2048),O=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],I=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],j=[0,1,2,3,4,5,6,7,8,9,10,11],W=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],E=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],C=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],G=[0,1,2,3,4,5,6,7,8,9,10,11],Z=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],he=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function oe(N,D){for(var L=0,F=0,K=new Array,ce=1;ce<=16;ce++){for(var xe=1;xe<=N[ce];xe++)K[D[F]]=[],K[D[F]][0]=L,K[D[F]][1]=ce,F++,L++;L*=2}return K}function me(N){for(var D=N[0],L=N[1]-1;L>=0;)D&1<<L&&(y|=1<<b),L--,--b<0&&(y==255?(pe(255),pe(0)):pe(y),b=7,y=0)}function pe(N){g.push(N)}function ge(N){pe(N>>8&255),pe(255&N)}function Le(N,D,L,F,K){for(var ce,xe=K[0],ee=K[240],fe=function(ze,lt){var Qe,Tt,ft,Ot,Fe,Xe,At,xt,st,pt,ht=0;for(st=0;st<8;++st){Qe=ze[ht],Tt=ze[ht+1],ft=ze[ht+2],Ot=ze[ht+3],Fe=ze[ht+4],Xe=ze[ht+5],At=ze[ht+6];var Qt=Qe+(xt=ze[ht+7]),$t=Qe-xt,mt=Tt+At,jt=Tt-At,er=ft+Xe,Pe=ft-Xe,tt=Ot+Fe,bt=Ot-Fe,Xt=Qt+tt,wr=Qt-tt,Wt=mt+er,_t=mt-er;ze[ht]=Xt+Wt,ze[ht+4]=Xt-Wt;var Ut=.707106781*(_t+wr);ze[ht+2]=wr+Ut,ze[ht+6]=wr-Ut;var ir=.382683433*((Xt=bt+Pe)-(_t=jt+$t)),Dr=.5411961*Xt+ir,un=1.306562965*_t+ir,kn=.707106781*(Wt=Pe+jt),Et=$t+kn,vi=$t-kn;ze[ht+5]=vi+Dr,ze[ht+3]=vi-Dr,ze[ht+1]=Et+un,ze[ht+7]=Et-un,ht+=8}for(ht=0,st=0;st<8;++st){Qe=ze[ht],Tt=ze[ht+8],ft=ze[ht+16],Ot=ze[ht+24],Fe=ze[ht+32],Xe=ze[ht+40],At=ze[ht+48];var yi=Qe+(xt=ze[ht+56]),Hn=Qe-xt,da=Tt+At,Cr=Tt-At,en=ft+Xe,z=ft-Xe,ne=Ot+Fe,Y=Ot-Fe,J=yi+ne,ae=yi-ne,se=da+en,Ne=da-en;ze[ht]=J+se,ze[ht+32]=J-se;var Oe=.707106781*(Ne+ae);ze[ht+16]=ae+Oe,ze[ht+48]=ae-Oe;var Ae=.382683433*((J=Y+z)-(Ne=Cr+Hn)),Ee=.5411961*J+Ae,ke=1.306562965*Ne+Ae,Ge=.707106781*(se=z+Cr),Ze=Hn+Ge,it=Hn-Ge;ze[ht+40]=it+Ee,ze[ht+24]=it-Ee,ze[ht+8]=Ze+ke,ze[ht+56]=Ze-ke,ht++}for(st=0;st<64;++st)pt=ze[st]*lt[st],d[st]=pt>0?pt+.5|0:pt-.5|0;return d}(N,D),le=0;le<64;++le)x[O[le]]=fe[le];var ue=x[0]-L;L=x[0],ue==0?me(F[0]):(me(F[p[ce=32767+ue]]),me(h[ce]));for(var $e=63;$e>0&&x[$e]==0;)$e--;if($e==0)return me(xe),L;for(var ye,Q=1;Q<=$e;){for(var nt=Q;x[Q]==0&&Q<=$e;)++Q;var Re=Q-nt;if(Re>=16){ye=Re>>4;for(var ot=1;ot<=ye;++ot)me(ee);Re&=15}ce=32767+x[Q],me(K[(Re<<4)+p[ce]]),me(h[ce]),Q++}return $e!=63&&me(xe),L}function Se(N){N=Math.min(Math.max(N,1),100),i!=N&&(function(D){for(var L=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],F=0;F<64;F++){var K=s((L[F]*D+50)/100);K=Math.min(Math.max(K,1),255),o[O[F]]=K}for(var ce=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],xe=0;xe<64;xe++){var ee=s((ce[xe]*D+50)/100);ee=Math.min(Math.max(ee,1),255),l[O[xe]]=ee}for(var fe=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],le=0,ue=0;ue<8;ue++)for(var $e=0;$e<8;$e++)c[le]=1/(o[O[le]]*fe[ue]*fe[$e]*8),f[le]=1/(l[O[le]]*fe[ue]*fe[$e]*8),le++}(N<50?Math.floor(5e3/N):Math.floor(200-2*N)),i=N)}this.encode=function(N,D){D&&Se(D),g=new Array,y=0,b=7,ge(65496),ge(65504),ge(16),pe(74),pe(70),pe(73),pe(70),pe(0),pe(1),pe(1),pe(0),ge(1),ge(1),pe(0),pe(0),function(){ge(65499),ge(132),pe(0);for(var Tt=0;Tt<64;Tt++)pe(o[Tt]);pe(1);for(var ft=0;ft<64;ft++)pe(l[ft])}(),function(Tt,ft){ge(65472),ge(17),pe(8),ge(ft),ge(Tt),pe(3),pe(1),pe(17),pe(0),pe(2),pe(17),pe(1),pe(3),pe(17),pe(1)}(N.width,N.height),function(){ge(65476),ge(418),pe(0);for(var Tt=0;Tt<16;Tt++)pe(I[Tt+1]);for(var ft=0;ft<=11;ft++)pe(j[ft]);pe(16);for(var Ot=0;Ot<16;Ot++)pe(W[Ot+1]);for(var Fe=0;Fe<=161;Fe++)pe(E[Fe]);pe(1);for(var Xe=0;Xe<16;Xe++)pe(C[Xe+1]);for(var At=0;At<=11;At++)pe(G[At]);pe(17);for(var xt=0;xt<16;xt++)pe(Z[xt+1]);for(var st=0;st<=161;st++)pe(he[st])}(),ge(65498),ge(12),pe(3),pe(1),pe(0),pe(2),pe(17),pe(3),pe(17),pe(0),pe(63),pe(0);var L=0,F=0,K=0;y=0,b=7,this.encode.displayName="_encode_";for(var ce,xe,ee,fe,le,ue,$e,ye,Q,nt=N.data,Re=N.width,ot=N.height,ze=4*Re,lt=0;lt<ot;){for(ce=0;ce<ze;){for(le=ze*lt+ce,$e=-1,ye=0,Q=0;Q<64;Q++)ue=le+(ye=Q>>3)*ze+($e=4*(7&Q)),lt+ye>=ot&&(ue-=ze*(lt+1+ye-ot)),ce+$e>=ze&&(ue-=ce+$e-ze+4),xe=nt[ue++],ee=nt[ue++],fe=nt[ue++],T[Q]=(M[xe]+M[ee+256|0]+M[fe+512|0]>>16)-128,S[Q]=(M[xe+768|0]+M[ee+1024|0]+M[fe+1280|0]>>16)-128,k[Q]=(M[xe+1280|0]+M[ee+1536|0]+M[fe+1792|0]>>16)-128;L=Le(T,c,L,t,n),F=Le(S,f,F,r,a),K=Le(k,f,K,r,a),ce+=32}lt+=8}if(b>=0){var Qe=[];Qe[1]=b+1,Qe[0]=(1<<b+1)-1,me(Qe)}return ge(65497),new Uint8Array(g)},e=e||50,function(){for(var N=String.fromCharCode,D=0;D<256;D++)A[D]=N(D)}(),t=oe(I,j),r=oe(C,G),n=oe(W,E),a=oe(Z,he),function(){for(var N=1,D=2,L=1;L<=15;L++){for(var F=N;F<D;F++)p[32767+F]=L,h[32767+F]=[],h[32767+F][1]=L,h[32767+F][0]=F;for(var K=-(D-1);K<=-N;K++)p[32767+K]=L,h[32767+K]=[],h[32767+K][1]=L,h[32767+K][0]=D-1+K;N<<=1,D<<=1}}(),function(){for(var N=0;N<256;N++)M[N]=19595*N,M[N+256|0]=38470*N,M[N+512|0]=7471*N+32768,M[N+768|0]=-11059*N,M[N+1024|0]=-21709*N,M[N+1280|0]=32768*N+8421375,M[N+1536|0]=-27439*N,M[N+1792|0]=-5329*N}(),Se(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function ji(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function V_(e){function t(j){if(!j)throw Error("assert :P")}function r(j,W,E){for(var C=0;4>C;C++)if(j[W+C]!=E.charCodeAt(C))return!0;return!1}function n(j,W,E,C,G){for(var Z=0;Z<G;Z++)j[W+Z]=E[C+Z]}function a(j,W,E,C){for(var G=0;G<C;G++)j[W+G]=E}function i(j){return new Int32Array(j)}function s(j,W){for(var E=[],C=0;C<j;C++)E.push(new W);return E}function o(j,W){var E=[];return function C(G,Z,he){for(var oe=he[Z],me=0;me<oe&&(G.push(he.length>Z+1?[]:new W),!(he.length<Z+1));me++)C(G[me],Z+1,he)}(E,0,j),E}var l=function(){var j=this;function W(m,v){for(var _=1<<v-1>>>0;m&_;)_>>>=1;return _?(m&_-1)+_:m}function E(m,v,_,P,R){t(!(P%_));do m[v+(P-=_)]=R;while(0<P)}function C(m,v,_,P,R){if(t(2328>=R),512>=R)var q=i(512);else if((q=i(R))==null)return 0;return function(H,V,X,te,ve,je){var re,be,_e=V,Ie=1<<X,Te=i(16),Me=i(16);for(t(ve!=0),t(te!=null),t(H!=null),t(0<X),be=0;be<ve;++be){if(15<te[be])return 0;++Te[te[be]]}if(Te[0]==ve)return 0;for(Me[1]=0,re=1;15>re;++re){if(Te[re]>1<<re)return 0;Me[re+1]=Me[re]+Te[re]}for(be=0;be<ve;++be)re=te[be],0<te[be]&&(je[Me[re]++]=be);if(Me[15]==1)return(te=new G).g=0,te.value=je[0],E(H,_e,1,Ie,te),Ie;var Ue,Ve=-1,We=Ie-1,Nt=0,ut=1,Mt=1,vt=1<<X;for(be=0,re=1,ve=2;re<=X;++re,ve<<=1){if(ut+=Mt<<=1,0>(Mt-=Te[re]))return 0;for(;0<Te[re];--Te[re])(te=new G).g=re,te.value=je[be++],E(H,_e+Nt,ve,vt,te),Nt=W(Nt,re)}for(re=X+1,ve=2;15>=re;++re,ve<<=1){if(ut+=Mt<<=1,0>(Mt-=Te[re]))return 0;for(;0<Te[re];--Te[re]){if(te=new G,(Nt&We)!=Ve){for(_e+=vt,Ue=1<<(Ve=re)-X;15>Ve&&!(0>=(Ue-=Te[Ve]));)++Ve,Ue<<=1;Ie+=vt=1<<(Ue=Ve-X),H[V+(Ve=Nt&We)].g=Ue+X,H[V+Ve].value=_e-V-Ve}te.g=re-X,te.value=je[be++],E(H,_e+(Nt>>X),ve,vt,te),Nt=W(Nt,re)}}return ut!=2*Me[15]-1?0:Ie}(m,v,_,P,R,q)}function G(){this.value=this.g=0}function Z(){this.value=this.g=0}function he(){this.G=s(5,G),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(Wi,Z)}function oe(m,v,_,P){t(m!=null),t(v!=null),t(2147483648>P),m.Ca=254,m.I=0,m.b=-8,m.Ka=0,m.oa=v,m.pa=_,m.Jd=v,m.Yc=_+P,m.Zc=4<=P?_+P-4+1:_,xe(m)}function me(m,v){for(var _=0;0<v--;)_|=fe(m,128)<<v;return _}function pe(m,v){var _=me(m,v);return ee(m)?-_:_}function ge(m,v,_,P){var R,q=0;for(t(m!=null),t(v!=null),t(4294967288>P),m.Sb=P,m.Ra=0,m.u=0,m.h=0,4<P&&(P=4),R=0;R<P;++R)q+=v[_+R]<<8*R;m.Ra=q,m.bb=P,m.oa=v,m.pa=_}function Le(m){for(;8<=m.u&&m.bb<m.Sb;)m.Ra>>>=8,m.Ra+=m.oa[m.pa+m.bb]<<to-8>>>0,++m.bb,m.u-=8;F(m)&&(m.h=1,m.u=0)}function Se(m,v){if(t(0<=v),!m.h&&v<=Ou){var _=L(m)&eo[v];return m.u+=v,Le(m),_}return m.h=1,m.u=0}function N(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function D(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function L(m){return m.Ra>>>(m.u&to-1)>>>0}function F(m){return t(m.bb<=m.Sb),m.h||m.bb==m.Sb&&m.u>to}function K(m,v){m.u=v,m.h=F(m)}function ce(m){m.u>=Hr&&(t(m.u>=Hr),Le(m))}function xe(m){t(m!=null&&m.oa!=null),m.pa<m.Zc?(m.I=(m.oa[m.pa++]|m.I<<8)>>>0,m.b+=8):(t(m!=null&&m.oa!=null),m.pa<m.Yc?(m.b+=8,m.I=m.oa[m.pa++]|m.I<<8):m.Ka?m.b=0:(m.I<<=8,m.b+=8,m.Ka=1))}function ee(m){return me(m,1)}function fe(m,v){var _=m.Ca;0>m.b&&xe(m);var P=m.b,R=_*v>>>8,q=(m.I>>>P>R)+0;for(q?(_-=R,m.I-=R+1<<P>>>0):_=R+1,P=_,R=0;256<=P;)R+=8,P>>=8;return P=7^R+rm[P],m.b-=P,m.Ca=(_<<P)-1,q}function le(m,v,_){m[v+0]=_>>24&255,m[v+1]=_>>16&255,m[v+2]=_>>8&255,m[v+3]=255&_}function ue(m,v){return m[v+0]|m[v+1]<<8}function $e(m,v){return ue(m,v)|m[v+2]<<16}function ye(m,v){return ue(m,v)|ue(m,v+2)<<16}function Q(m,v){var _=1<<v;return t(m!=null),t(0<v),m.X=i(_),m.X==null?0:(m.Mb=32-v,m.Xa=v,1)}function nt(m,v){t(m!=null),t(v!=null),t(m.Xa==v.Xa),n(v.X,0,m.X,0,1<<v.Xa)}function Re(){this.X=[],this.Xa=this.Mb=0}function ot(m,v,_,P){t(_!=null),t(P!=null);var R=_[0],q=P[0];return R==0&&(R=(m*q+v/2)/v),q==0&&(q=(v*R+m/2)/m),0>=R||0>=q?0:(_[0]=R,P[0]=q,1)}function ze(m,v){return m+(1<<v)-1>>>v}function lt(m,v){return((4278255360&m)+(4278255360&v)>>>0&4278255360)+((16711935&m)+(16711935&v)>>>0&16711935)>>>0}function Qe(m,v){j[v]=function(_,P,R,q,H,V,X){var te;for(te=0;te<H;++te){var ve=j[m](V[X+te-1],R,q+te);V[X+te]=lt(_[P+te],ve)}}}function Tt(){this.ud=this.hd=this.jd=0}function ft(m,v){return((4278124286&(m^v))>>>1)+(m&v)>>>0}function Ot(m){return 0<=m&&256>m?m:0>m?0:255<m?255:void 0}function Fe(m,v){return Ot(m+(m-v+.5>>1))}function Xe(m,v,_){return Math.abs(v-_)-Math.abs(m-_)}function At(m,v,_,P,R,q,H){for(P=q[H-1],_=0;_<R;++_)q[H+_]=P=lt(m[v+_],P)}function xt(m,v,_,P,R){var q;for(q=0;q<_;++q){var H=m[v+q],V=H>>8&255,X=16711935&(X=(X=16711935&H)+((V<<16)+V));P[R+q]=(4278255360&H)+X>>>0}}function st(m,v){v.jd=255&m,v.hd=m>>8&255,v.ud=m>>16&255}function pt(m,v,_,P,R,q){var H;for(H=0;H<P;++H){var V=v[_+H],X=V>>>8,te=V,ve=255&(ve=(ve=V>>>16)+((m.jd<<24>>24)*(X<<24>>24)>>>5));te=255&(te=(te+=(m.hd<<24>>24)*(X<<24>>24)>>>5)+((m.ud<<24>>24)*(ve<<24>>24)>>>5)),R[q+H]=(4278255360&V)+(ve<<16)+te}}function ht(m,v,_,P,R){j[v]=function(q,H,V,X,te,ve,je,re,be){for(X=je;X<re;++X)for(je=0;je<be;++je)te[ve++]=R(V[P(q[H++])])},j[m]=function(q,H,V,X,te,ve,je){var re=8>>q.b,be=q.Ea,_e=q.K[0],Ie=q.w;if(8>re)for(q=(1<<q.b)-1,Ie=(1<<re)-1;H<V;++H){var Te,Me=0;for(Te=0;Te<be;++Te)Te&q||(Me=P(X[te++])),ve[je++]=R(_e[Me&Ie]),Me>>=re}else j["VP8LMapColor"+_](X,te,_e,Ie,ve,je,H,V,be)}}function Qt(m,v,_,P,R){for(_=v+_;v<_;){var q=m[v++];P[R++]=q>>16&255,P[R++]=q>>8&255,P[R++]=255&q}}function $t(m,v,_,P,R){for(_=v+_;v<_;){var q=m[v++];P[R++]=q>>16&255,P[R++]=q>>8&255,P[R++]=255&q,P[R++]=q>>24&255}}function mt(m,v,_,P,R){for(_=v+_;v<_;){var q=(H=m[v++])>>16&240|H>>12&15,H=240&H|H>>28&15;P[R++]=q,P[R++]=H}}function jt(m,v,_,P,R){for(_=v+_;v<_;){var q=(H=m[v++])>>16&248|H>>13&7,H=H>>5&224|H>>3&31;P[R++]=q,P[R++]=H}}function er(m,v,_,P,R){for(_=v+_;v<_;){var q=m[v++];P[R++]=255&q,P[R++]=q>>8&255,P[R++]=q>>16&255}}function Pe(m,v,_,P,R,q){if(q==0)for(_=v+_;v<_;)le(P,((q=m[v++])[0]>>24|q[1]>>8&65280|q[2]<<8&16711680|q[3]<<24)>>>0),R+=32;else n(P,R,m,v,_)}function tt(m,v){j[v][0]=j[m+"0"],j[v][1]=j[m+"1"],j[v][2]=j[m+"2"],j[v][3]=j[m+"3"],j[v][4]=j[m+"4"],j[v][5]=j[m+"5"],j[v][6]=j[m+"6"],j[v][7]=j[m+"7"],j[v][8]=j[m+"8"],j[v][9]=j[m+"9"],j[v][10]=j[m+"10"],j[v][11]=j[m+"11"],j[v][12]=j[m+"12"],j[v][13]=j[m+"13"],j[v][14]=j[m+"0"],j[v][15]=j[m+"0"]}function bt(m){return m==im||m==sm||m==F0||m==om}function Xt(){this.eb=[],this.size=this.A=this.fb=0}function wr(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Wt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Xt,this.f.kb=new wr,this.sd=null}function _t(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Ut(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function ir(m){return alert("todo:WebPSamplerProcessPlane"),m.T}function Dr(m,v){var _=m.T,P=v.ba.f.RGBA,R=P.eb,q=P.fb+m.ka*P.A,H=ri[v.ba.S],V=m.y,X=m.O,te=m.f,ve=m.N,je=m.ea,re=m.W,be=v.cc,_e=v.dc,Ie=v.Mc,Te=v.Nc,Me=m.ka,Ue=m.ka+m.T,Ve=m.U,We=Ve+1>>1;for(Me==0?H(V,X,null,null,te,ve,je,re,te,ve,je,re,R,q,null,null,Ve):(H(v.ec,v.fc,V,X,be,_e,Ie,Te,te,ve,je,re,R,q-P.A,R,q,Ve),++_);Me+2<Ue;Me+=2)be=te,_e=ve,Ie=je,Te=re,ve+=m.Rc,re+=m.Rc,q+=2*P.A,H(V,(X+=2*m.fa)-m.fa,V,X,be,_e,Ie,Te,te,ve,je,re,R,q-P.A,R,q,Ve);return X+=m.fa,m.j+Ue<m.o?(n(v.ec,v.fc,V,X,Ve),n(v.cc,v.dc,te,ve,We),n(v.Mc,v.Nc,je,re,We),_--):1&Ue||H(V,X,null,null,te,ve,je,re,te,ve,je,re,R,q+P.A,null,null,Ve),_}function un(m,v,_){var P=m.F,R=[m.J];if(P!=null){var q=m.U,H=v.ba.S,V=H==L0||H==F0;v=v.ba.f.RGBA;var X=[0],te=m.ka;X[0]=m.T,m.Kb&&(te==0?--X[0]:(--te,R[0]-=m.width),m.j+m.ka+m.T==m.o&&(X[0]=m.o-m.j-te));var ve=v.eb;te=v.fb+te*v.A,m=T2(P,R[0],m.width,q,X,ve,te+(V?0:3),v.A),t(_==X),m&&bt(H)&&Iu(ve,te,V,q,X,v.A)}return 0}function kn(m){var v=m.ma,_=v.ba.S,P=11>_,R=_==C0||_==O0||_==L0||_==am||_==12||bt(_);if(v.memory=null,v.Ib=null,v.Jb=null,v.Nd=null,!pa(v.Oa,m,R?11:12))return 0;if(R&&bt(_)&&ju(),m.da)alert("todo:use_scaling");else{if(P){if(v.Ib=ir,m.Kb){if(_=m.U+1>>1,v.memory=i(m.U+2*_),v.memory==null)return 0;v.ec=v.memory,v.fc=0,v.cc=v.ec,v.dc=v.fc+m.U,v.Mc=v.cc,v.Nc=v.dc+_,v.Ib=Dr,ju()}}else alert("todo:EmitYUV");R&&(v.Jb=un,P&&Yo())}if(P&&!W2){for(m=0;256>m;++m)zT[m]=89858*(m-128)+I0>>D0,HT[m]=-22014*(m-128)+I0,WT[m]=-45773*(m-128),qT[m]=113618*(m-128)+I0>>D0;for(m=Ru;m<um;++m)v=76283*(m-16)+I0>>D0,GT[m-Ru]=hn(v,255),VT[m-Ru]=hn(v+8>>4,15);W2=1}return 1}function Et(m){var v=m.ma,_=m.U,P=m.T;return t(!(1&m.ka)),0>=_||0>=P?0:(_=v.Ib(m,v),v.Jb!=null&&v.Jb(m,v,_),v.Dc+=_,1)}function vi(m){m.ma.memory=null}function yi(m,v,_,P){return Se(m,8)!=47?0:(v[0]=Se(m,14)+1,_[0]=Se(m,14)+1,P[0]=Se(m,1),Se(m,3)!=0?0:!m.h)}function Hn(m,v){if(4>m)return m+1;var _=m-2>>1;return(2+(1&m)<<_)+Se(v,_)+1}function da(m,v){return 120<v?v-120:1<=(_=((_=jT[v-1])>>4)*m+(8-(15&_)))?_:1;var _}function Cr(m,v,_){var P=L(_),R=m[v+=255&P].g-8;return 0<R&&(K(_,_.u+8),P=L(_),v+=m[v].value,v+=P&(1<<R)-1),K(_,_.u+m[v].g),m[v].value}function en(m,v,_){return _.g+=m.g,_.value+=m.value<<v>>>0,t(8>=_.g),m.g}function z(m,v,_){var P=m.xc;return t((v=P==0?0:m.vc[m.md*(_>>P)+(v>>P)])<m.Wb),m.Ya[v]}function ne(m,v,_,P){var R=m.ab,q=m.c*v,H=m.C;v=H+v;var V=_,X=P;for(P=m.Ta,_=m.Ua;0<R--;){var te=m.gc[R],ve=H,je=v,re=V,be=X,_e=(X=P,V=_,te.Ea);switch(t(ve<je),t(je<=te.nc),te.hc){case 2:tc(re,be,(je-ve)*_e,X,V);break;case 0:var Ie=ve,Te=je,Me=X,Ue=V,Ve=(vt=te).Ea;Ie==0&&(Hi(re,be,null,null,1,Me,Ue),At(re,be+1,0,0,Ve-1,Me,Ue+1),be+=Ve,Ue+=Ve,++Ie);for(var We=1<<vt.b,Nt=We-1,ut=ze(Ve,vt.b),Mt=vt.K,vt=vt.w+(Ie>>vt.b)*ut;Ie<Te;){var Ht=Mt,dn=vt,Rt=1;for(Gi(re,be,Me,Ue-Ve,1,Me,Ue);Rt<Ve;){var yt=(Rt&~Nt)+We;yt>Ve&&(yt=Ve),(0,Jo[Ht[dn++]>>8&15])(re,be+ +Rt,Me,Ue+Rt-Ve,yt-Rt,Me,Ue+Rt),Rt=yt}be+=Ve,Ue+=Ve,++Ie&Nt||(vt+=ut)}je!=te.nc&&n(X,V-_e,X,V+(je-ve-1)*_e,_e);break;case 1:for(_e=re,Te=be,Ve=(re=te.Ea)-(Ue=re&~(Me=(be=1<<te.b)-1)),Ie=ze(re,te.b),We=te.K,te=te.w+(ve>>te.b)*Ie;ve<je;){for(Nt=We,ut=te,Mt=new Tt,vt=Te+Ue,Ht=Te+re;Te<vt;)st(Nt[ut++],Mt),ms(Mt,_e,Te,be,X,V),Te+=be,V+=be;Te<Ht&&(st(Nt[ut++],Mt),ms(Mt,_e,Te,Ve,X,V),Te+=Ve,V+=Ve),++ve&Me||(te+=Ie)}break;case 3:if(re==X&&be==V&&0<te.b){for(Te=X,re=_e=V+(je-ve)*_e-(Ue=(je-ve)*ze(te.Ea,te.b)),be=X,Me=V,Ie=[],Ue=(Ve=Ue)-1;0<=Ue;--Ue)Ie[Ue]=be[Me+Ue];for(Ue=Ve-1;0<=Ue;--Ue)Te[re+Ue]=Ie[Ue];Lu(te,ve,je,X,_e,X,V)}else Lu(te,ve,je,re,be,X,V)}V=P,X=_}X!=_&&n(P,_,V,X,q)}function Y(m,v){var _=m.V,P=m.Ba+m.c*m.C,R=v-m.C;if(t(v<=m.l.o),t(16>=R),0<R){var q=m.l,H=m.Ta,V=m.Ua,X=q.width;if(ne(m,R,_,P),R=V=[V],t((_=m.C)<(P=v)),t(q.v<q.va),P>q.o&&(P=q.o),_<q.j){var te=q.j-_;_=q.j,R[0]+=te*X}if(_>=P?_=0:(R[0]+=4*q.v,q.ka=_-q.j,q.U=q.va-q.v,q.T=P-_,_=1),_){if(V=V[0],11>(_=m.ca).S){var ve=_.f.RGBA,je=(P=_.S,R=q.U,q=q.T,te=ve.eb,ve.A),re=q;for(ve=ve.fb+m.Ma*ve.A;0<re--;){var be=H,_e=V,Ie=R,Te=te,Me=ve;switch(P){case k0:Fu(be,_e,Ie,Te,Me);break;case C0:Pa(be,_e,Ie,Te,Me);break;case im:Pa(be,_e,Ie,Te,Me),Iu(Te,Me,0,Ie,1,0);break;case F2:Nr(be,_e,Ie,Te,Me);break;case O0:Pe(be,_e,Ie,Te,Me,1);break;case sm:Pe(be,_e,Ie,Te,Me,1),Iu(Te,Me,0,Ie,1,0);break;case L0:Pe(be,_e,Ie,Te,Me,0);break;case F0:Pe(be,_e,Ie,Te,Me,0),Iu(Te,Me,1,Ie,1,0);break;case am:Vi(be,_e,Ie,Te,Me);break;case om:Vi(be,_e,Ie,Te,Me),E2(Te,Me,Ie,1,0);break;case D2:_r(be,_e,Ie,Te,Me);break;default:t(0)}V+=X,ve+=je}m.Ma+=q}else alert("todo:EmitRescaledRowsYUVA");t(m.Ma<=_.height)}}m.C=v,t(m.C<=m.i)}function J(m){var v;if(0<m.ua)return 0;for(v=0;v<m.Wb;++v){var _=m.Ya[v].G,P=m.Ya[v].H;if(0<_[1][P[1]+0].g||0<_[2][P[2]+0].g||0<_[3][P[3]+0].g)return 0}return 1}function ae(m,v,_,P,R,q){if(m.Z!=0){var H=m.qd,V=m.rd;for(t(no[m.Z]!=null);v<_;++v)no[m.Z](H,V,P,R,P,R,q),H=P,V=R,R+=q;m.qd=H,m.rd=V}}function se(m,v){var _=m.l.ma,P=_.Z==0||_.Z==1?m.l.j:m.C;if(P=m.C<P?P:m.C,t(v<=m.l.o),v>P){var R=m.l.width,q=_.ca,H=_.tb+R*P,V=m.V,X=m.Ba+m.c*P,te=m.gc;t(m.ab==1),t(te[0].hc==3),nc(te[0],P,v,V,X,q,H),ae(_,P,v,q,H,R)}m.C=m.Ma=v}function Ne(m,v,_,P,R,q,H){var V=m.$/P,X=m.$%P,te=m.m,ve=m.s,je=_+m.$,re=je;R=_+P*R;var be=_+P*q,_e=280+ve.ua,Ie=m.Pb?V:16777216,Te=0<ve.ua?ve.Wa:null,Me=ve.wc,Ue=je<be?z(ve,X,V):null;t(m.C<q),t(be<=R);var Ve=!1;e:for(;;){for(;Ve||je<be;){var We=0;if(V>=Ie){var Nt=je-_;t((Ie=m).Pb),Ie.wd=Ie.m,Ie.xd=Nt,0<Ie.s.ua&&nt(Ie.s.Wa,Ie.s.vb),Ie=V+kT}if(X&Me||(Ue=z(ve,X,V)),t(Ue!=null),Ue.Qb&&(v[je]=Ue.qb,Ve=!0),!Ve)if(ce(te),Ue.jc){We=te,Nt=v;var ut=je,Mt=Ue.pd[L(We)&Wi-1];t(Ue.jc),256>Mt.g?(K(We,We.u+Mt.g),Nt[ut]=Mt.value,We=0):(K(We,We.u+Mt.g-256),t(256<=Mt.value),We=Mt.value),We==0&&(Ve=!0)}else We=Cr(Ue.G[0],Ue.H[0],te);if(te.h)break;if(Ve||256>We){if(!Ve)if(Ue.nd)v[je]=(Ue.qb|We<<8)>>>0;else{if(ce(te),Ve=Cr(Ue.G[1],Ue.H[1],te),ce(te),Nt=Cr(Ue.G[2],Ue.H[2],te),ut=Cr(Ue.G[3],Ue.H[3],te),te.h)break;v[je]=(ut<<24|Ve<<16|We<<8|Nt)>>>0}if(Ve=!1,++je,++X>=P&&(X=0,++V,H!=null&&V<=q&&!(V%16)&&H(m,V),Te!=null))for(;re<je;)We=v[re++],Te.X[(506832829*We&4294967295)>>>Te.Mb]=We}else if(280>We){if(We=Hn(We-256,te),Nt=Cr(Ue.G[4],Ue.H[4],te),ce(te),Nt=da(P,Nt=Hn(Nt,te)),te.h)break;if(je-_<Nt||R-je<We)break e;for(ut=0;ut<We;++ut)v[je+ut]=v[je+ut-Nt];for(je+=We,X+=We;X>=P;)X-=P,++V,H!=null&&V<=q&&!(V%16)&&H(m,V);if(t(je<=R),X&Me&&(Ue=z(ve,X,V)),Te!=null)for(;re<je;)We=v[re++],Te.X[(506832829*We&4294967295)>>>Te.Mb]=We}else{if(!(We<_e))break e;for(Ve=We-280,t(Te!=null);re<je;)We=v[re++],Te.X[(506832829*We&4294967295)>>>Te.Mb]=We;We=je,t(!(Ve>>>(Nt=Te).Xa)),v[We]=Nt.X[Ve],Ve=!0}Ve||t(te.h==F(te))}if(m.Pb&&te.h&&je<R)t(m.m.h),m.a=5,m.m=m.wd,m.$=m.xd,0<m.s.ua&&nt(m.s.vb,m.s.Wa);else{if(te.h)break e;H!=null&&H(m,V>q?q:V),m.a=0,m.$=je-_}return 1}return m.a=3,0}function Oe(m){t(m!=null),m.vc=null,m.yc=null,m.Ya=null;var v=m.Wa;v!=null&&(v.X=null),m.vb=null,t(m!=null)}function Ae(){var m=new Ir;return m==null?null:(m.a=0,m.xb=R2,tt("Predictor","VP8LPredictors"),tt("Predictor","VP8LPredictors_C"),tt("PredictorAdd","VP8LPredictorsAdd"),tt("PredictorAdd","VP8LPredictorsAdd_C"),tc=xt,ms=pt,Fu=Qt,Pa=$t,Vi=mt,_r=jt,Nr=er,j.VP8LMapColor32b=rc,j.VP8LMapColor8b=Zo,m)}function Ee(m,v,_,P,R){var q=1,H=[m],V=[v],X=P.m,te=P.s,ve=null,je=0;e:for(;;){if(_)for(;q&&Se(X,1);){var re=H,be=V,_e=P,Ie=1,Te=_e.m,Me=_e.gc[_e.ab],Ue=Se(Te,2);if(_e.Oc&1<<Ue)q=0;else{switch(_e.Oc|=1<<Ue,Me.hc=Ue,Me.Ea=re[0],Me.nc=be[0],Me.K=[null],++_e.ab,t(4>=_e.ab),Ue){case 0:case 1:Me.b=Se(Te,3)+2,Ie=Ee(ze(Me.Ea,Me.b),ze(Me.nc,Me.b),0,_e,Me.K),Me.K=Me.K[0];break;case 3:var Ve,We=Se(Te,8)+1,Nt=16<We?0:4<We?1:2<We?2:3;if(re[0]=ze(Me.Ea,Nt),Me.b=Nt,Ve=Ie=Ee(We,1,0,_e,Me.K)){var ut,Mt=We,vt=Me,Ht=1<<(8>>vt.b),dn=i(Ht);if(dn==null)Ve=0;else{var Rt=vt.K[0],yt=vt.w;for(dn[0]=vt.K[0][0],ut=1;ut<1*Mt;++ut)dn[ut]=lt(Rt[yt+ut],dn[ut-1]);for(;ut<4*Ht;++ut)dn[ut]=0;vt.K[0]=null,vt.K[0]=dn,Ve=1}}Ie=Ve;break;case 2:break;default:t(0)}q=Ie}}if(H=H[0],V=V[0],q&&Se(X,1)&&!(q=1<=(je=Se(X,4))&&11>=je)){P.a=3;break e}var rt;if(rt=q)t:{var Kr,Dt,Kt,Tr=P,On=H,aa=V,Rr=je,Vn=_,ia=Tr.m,pn=Tr.s,Yt=[null],sr=1,Br=0,or=PT[Rr];r:for(;;){if(Vn&&Se(ia,1)){var Ln=Se(ia,3)+2,Si=ze(On,Ln),Yr=ze(aa,Ln),ga=Si*Yr;if(!Ee(Si,Yr,0,Tr,Yt))break r;for(Yt=Yt[0],pn.xc=Ln,Kr=0;Kr<ga;++Kr){var xr=Yt[Kr]>>8&65535;Yt[Kr]=xr,xr>=sr&&(sr=xr+1)}}if(ia.h)break r;for(Dt=0;5>Dt;++Dt){var mn=I2[Dt];!Dt&&0<Rr&&(mn+=1<<Rr),Br<mn&&(Br=mn)}var Ca=s(sr*or,G),sa=sr,Oa=s(sa,he);if(Oa==null)var La=null;else t(65536>=sa),La=Oa;var xa=i(Br);if(La==null||xa==null||Ca==null){Tr.a=1;break r}var Fa=Ca;for(Kr=Kt=0;Kr<sr;++Kr){var Sr=La[Kr],Da=Sr.G,Ai=Sr.H,Qo=0,vs=1,Fn=0;for(Dt=0;5>Dt;++Dt){mn=I2[Dt],Da[Dt]=Fa,Ai[Dt]=Kt,!Dt&&0<Rr&&(mn+=1<<Rr);a:{var R0,fm=mn,B0=Tr,Bu=xa,XT=Fa,ZT=Kt,hm=0,ao=B0.m,JT=Se(ao,1);if(a(Bu,0,0,fm),JT){var QT=Se(ao,1)+1,e8=Se(ao,1),V2=Se(ao,e8==0?1:8);Bu[V2]=1,QT==2&&(Bu[V2=Se(ao,8)]=1);var U0=1}else{var K2=i(19),Y2=Se(ao,4)+4;if(19<Y2){B0.a=3;var $0=0;break a}for(R0=0;R0<Y2;++R0)K2[TT[R0]]=Se(ao,3);var dm=void 0,Uu=void 0,X2=B0,t8=K2,z0=fm,Z2=Bu,pm=0,io=X2.m,J2=8,Q2=s(128,G);n:for(;C(Q2,0,7,t8,19);){if(Se(io,1)){var r8=2+2*Se(io,3);if((dm=2+Se(io,r8))>z0)break n}else dm=z0;for(Uu=0;Uu<z0&&dm--;){ce(io);var ey=Q2[0+(127&L(io))];K(io,io.u+ey.g);var ic=ey.value;if(16>ic)Z2[Uu++]=ic,ic!=0&&(J2=ic);else{var n8=ic==16,ty=ic-16,a8=AT[ty],ry=Se(io,ST[ty])+a8;if(Uu+ry>z0)break n;for(var i8=n8?J2:0;0<ry--;)Z2[Uu++]=i8}}pm=1;break n}pm||(X2.a=3),U0=pm}(U0=U0&&!ao.h)&&(hm=C(XT,ZT,8,Bu,fm)),U0&&hm!=0?$0=hm:(B0.a=3,$0=0)}if($0==0)break r;if(vs&&ET[Dt]==1&&(vs=Fa[Kt].g==0),Qo+=Fa[Kt].g,Kt+=$0,3>=Dt){var $u,mm=xa[0];for($u=1;$u<mn;++$u)xa[$u]>mm&&(mm=xa[$u]);Fn+=mm}}if(Sr.nd=vs,Sr.Qb=0,vs&&(Sr.qb=(Da[3][Ai[3]+0].value<<24|Da[1][Ai[1]+0].value<<16|Da[2][Ai[2]+0].value)>>>0,Qo==0&&256>Da[0][Ai[0]+0].value&&(Sr.Qb=1,Sr.qb+=Da[0][Ai[0]+0].value<<8)),Sr.jc=!Sr.Qb&&6>Fn,Sr.jc){var q0,ys=Sr;for(q0=0;q0<Wi;++q0){var so=q0,oo=ys.pd[so],W0=ys.G[0][ys.H[0]+so];256<=W0.value?(oo.g=W0.g+256,oo.value=W0.value):(oo.g=0,oo.value=0,so>>=en(W0,8,oo),so>>=en(ys.G[1][ys.H[1]+so],16,oo),so>>=en(ys.G[2][ys.H[2]+so],0,oo),en(ys.G[3][ys.H[3]+so],24,oo))}}}pn.vc=Yt,pn.Wb=sr,pn.Ya=La,pn.yc=Ca,rt=1;break t}rt=0}if(!(q=rt)){P.a=3;break e}if(0<je){if(te.ua=1<<je,!Q(te.Wa,je)){P.a=1,q=0;break e}}else te.ua=0;var gm=P,ny=H,s8=V,xm=gm.s,vm=xm.xc;if(gm.c=ny,gm.i=s8,xm.md=ze(ny,vm),xm.wc=vm==0?-1:(1<<vm)-1,_){P.xb=MT;break e}if((ve=i(H*V))==null){P.a=1,q=0;break e}q=(q=Ne(P,ve,0,H,V,V,null))&&!X.h;break e}return q?(R!=null?R[0]=ve:(t(ve==null),t(_)),P.$=0,_||Oe(te)):Oe(te),q}function ke(m,v){var _=m.c*m.i,P=_+v+16*v;return t(m.c<=v),m.V=i(P),m.V==null?(m.Ta=null,m.Ua=0,m.a=1,0):(m.Ta=m.V,m.Ua=m.Ba+_+v,1)}function Ge(m,v){var _=m.C,P=v-_,R=m.V,q=m.Ba+m.c*_;for(t(v<=m.l.o);0<P;){var H=16<P?16:P,V=m.l.ma,X=m.l.width,te=X*H,ve=V.ca,je=V.tb+X*_,re=m.Ta,be=m.Ua;ne(m,H,R,q),j2(re,be,ve,je,te),ae(V,_,_+H,ve,je,X),P-=H,R+=H*m.c,_+=H}t(_==v),m.C=m.Ma=v}function Ze(){this.ub=this.yd=this.td=this.Rb=0}function it(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ke(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function at(){this.Yb=function(){var m=[];return function v(_,P,R){for(var q=R[P],H=0;H<q&&(_.push(R.length>P+1?[]:0),!(R.length<P+1));H++)v(_[H],P+1,R)}(m,0,[3,11]),m}()}function Pt(){this.jb=i(3),this.Wc=o([4,8],at),this.Xc=o([4,17],at)}function pr(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function zt(){this.ld=this.La=this.dd=this.tc=0}function Mr(){this.Na=this.la=0}function Ui(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function bi(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function $i(){this.uc=this.M=this.Nb=0,this.wa=Array(new zt),this.Y=0,this.ya=Array(new bi),this.aa=0,this.l=new Gn}function Qa(){this.y=i(16),this.f=i(8),this.ea=i(8)}function Ks(){this.cb=this.a=0,this.sc="",this.m=new N,this.Od=new Ze,this.Kc=new it,this.ed=new pr,this.Qa=new Ke,this.Ic=this.$c=this.Aa=0,this.D=new $i,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,N),this.ia=0,this.pb=s(4,Ui),this.Pa=new Pt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Qa),this.Hd=0,this.rb=Array(new Mr),this.sb=0,this.wa=Array(new zt),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new bi),this.L=this.aa=0,this.gd=o([4,2],zt),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Gn(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Up(){var m=new Ks;return m!=null&&(m.a=0,m.sc="OK",m.cb=0,m.Xb=0,Mu||(Mu=cs)),m}function tn(m,v,_){return m.a==0&&(m.a=v,m.sc=_,m.cb=0),0}function _0(m,v,_){return 3<=_&&m[v+0]==157&&m[v+1]==1&&m[v+2]==42}function N0(m,v){if(m==null)return 0;if(m.a=0,m.sc="OK",v==null)return tn(m,2,"null VP8Io passed to VP8GetHeaders()");var _=v.data,P=v.w,R=v.ha;if(4>R)return tn(m,7,"Truncated header.");var q=_[P+0]|_[P+1]<<8|_[P+2]<<16,H=m.Od;if(H.Rb=!(1&q),H.td=q>>1&7,H.yd=q>>4&1,H.ub=q>>5,3<H.td)return tn(m,3,"Incorrect keyframe parameters.");if(!H.yd)return tn(m,4,"Frame not displayable.");P+=3,R-=3;var V=m.Kc;if(H.Rb){if(7>R)return tn(m,7,"cannot parse picture header");if(!_0(_,P,R))return tn(m,3,"Bad code word");V.c=16383&(_[P+4]<<8|_[P+3]),V.Td=_[P+4]>>6,V.i=16383&(_[P+6]<<8|_[P+5]),V.Ud=_[P+6]>>6,P+=7,R-=7,m.za=V.c+15>>4,m.Ub=V.i+15>>4,v.width=V.c,v.height=V.i,v.Da=0,v.j=0,v.v=0,v.va=v.width,v.o=v.height,v.da=0,v.ib=v.width,v.hb=v.height,v.U=v.width,v.T=v.height,a((q=m.Pa).jb,0,255,q.jb.length),t((q=m.Qa)!=null),q.Cb=0,q.Bb=0,q.Fb=1,a(q.Zb,0,0,q.Zb.length),a(q.Lb,0,0,q.Lb)}if(H.ub>R)return tn(m,7,"bad partition length");oe(q=m.m,_,P,H.ub),P+=H.ub,R-=H.ub,H.Rb&&(V.Ld=ee(q),V.Kd=ee(q)),V=m.Qa;var X,te=m.Pa;if(t(q!=null),t(V!=null),V.Cb=ee(q),V.Cb){if(V.Bb=ee(q),ee(q)){for(V.Fb=ee(q),X=0;4>X;++X)V.Zb[X]=ee(q)?pe(q,7):0;for(X=0;4>X;++X)V.Lb[X]=ee(q)?pe(q,6):0}if(V.Bb)for(X=0;3>X;++X)te.jb[X]=ee(q)?me(q,8):255}else V.Bb=0;if(q.Ka)return tn(m,3,"cannot parse segment header");if((V=m.ed).zd=ee(q),V.Tb=me(q,6),V.wb=me(q,3),V.Pc=ee(q),V.Pc&&ee(q)){for(te=0;4>te;++te)ee(q)&&(V.vd[te]=pe(q,6));for(te=0;4>te;++te)ee(q)&&(V.od[te]=pe(q,6))}if(m.L=V.Tb==0?0:V.zd?1:2,q.Ka)return tn(m,3,"cannot parse filter header");var ve=R;if(R=X=P,P=X+ve,V=ve,m.Xb=(1<<me(m.m,2))-1,ve<3*(te=m.Xb))_=7;else{for(X+=3*te,V-=3*te,ve=0;ve<te;++ve){var je=_[R+0]|_[R+1]<<8|_[R+2]<<16;je>V&&(je=V),oe(m.Jc[+ve],_,X,je),X+=je,V-=je,R+=3}oe(m.Jc[+te],_,X,V),_=X<P?0:5}if(_!=0)return tn(m,_,"cannot parse partitions");for(_=me(X=m.m,7),R=ee(X)?pe(X,4):0,P=ee(X)?pe(X,4):0,V=ee(X)?pe(X,4):0,te=ee(X)?pe(X,4):0,X=ee(X)?pe(X,4):0,ve=m.Qa,je=0;4>je;++je){if(ve.Cb){var re=ve.Zb[je];ve.Fb||(re+=_)}else{if(0<je){m.pb[je]=m.pb[0];continue}re=_}var be=m.pb[je];be.Sc[0]=lm[hn(re+R,127)],be.Sc[1]=cm[hn(re+0,127)],be.Eb[0]=2*lm[hn(re+P,127)],be.Eb[1]=101581*cm[hn(re+V,127)]>>16,8>be.Eb[1]&&(be.Eb[1]=8),be.Qc[0]=lm[hn(re+te,117)],be.Qc[1]=cm[hn(re+X,127)],be.lc=re+X}if(!H.Rb)return tn(m,4,"Not a key frame.");for(ee(q),H=m.Pa,_=0;4>_;++_){for(R=0;8>R;++R)for(P=0;3>P;++P)for(V=0;11>V;++V)te=fe(q,DT[_][R][P][V])?me(q,8):LT[_][R][P][V],H.Wc[_][R].Yb[P][V]=te;for(R=0;17>R;++R)H.Xc[_][R]=H.Wc[_][IT[R]]}return m.kc=ee(q),m.kc&&(m.Bd=me(q,8)),m.cb=1}function cs(m,v,_,P,R,q,H){var V=v[R].Yb[_];for(_=0;16>R;++R){if(!fe(m,V[_+0]))return R;for(;!fe(m,V[_+1]);)if(V=v[++R].Yb[0],_=0,R==16)return 16;var X=v[R+1].Yb;if(fe(m,V[_+2])){var te=m,ve=0;if(fe(te,(re=V)[(je=_)+3]))if(fe(te,re[je+6])){for(V=0,je=2*(ve=fe(te,re[je+8]))+(re=fe(te,re[je+9+ve])),ve=0,re=CT[je];re[V];++V)ve+=ve+fe(te,re[V]);ve+=3+(8<<je)}else fe(te,re[je+7])?(ve=7+2*fe(te,165),ve+=fe(te,145)):ve=5+fe(te,159);else ve=fe(te,re[je+4])?3+fe(te,re[je+5]):2;V=X[2]}else ve=1,V=X[1];X=H+OT[R],0>(te=m).b&&xe(te);var je,re=te.b,be=(je=te.Ca>>1)-(te.I>>re)>>31;--te.b,te.Ca+=be,te.Ca|=1,te.I-=(je+1&be)<<re,q[X]=((ve^be)-be)*P[(0<R)+0]}return 16}function $o(m){var v=m.rb[m.sb-1];v.la=0,v.Na=0,a(m.zc,0,0,m.zc.length),m.ja=0}function wi(m,v,_,P,R){R=m[v+_+32*P]+(R>>3),m[v+_+32*P]=-256&R?0>R?0:255:R}function zo(m,v,_,P,R,q){wi(m,v,0,_,P+R),wi(m,v,1,_,P+q),wi(m,v,2,_,P-q),wi(m,v,3,_,P-R)}function Wr(m){return(20091*m>>16)+m}function xu(m,v,_,P){var R,q=0,H=i(16);for(R=0;4>R;++R){var V=m[v+0]+m[v+8],X=m[v+0]-m[v+8],te=(35468*m[v+4]>>16)-Wr(m[v+12]),ve=Wr(m[v+4])+(35468*m[v+12]>>16);H[q+0]=V+ve,H[q+1]=X+te,H[q+2]=X-te,H[q+3]=V-ve,q+=4,v++}for(R=q=0;4>R;++R)V=(m=H[q+0]+4)+H[q+8],X=m-H[q+8],te=(35468*H[q+4]>>16)-Wr(H[q+12]),wi(_,P,0,0,V+(ve=Wr(H[q+4])+(35468*H[q+12]>>16))),wi(_,P,1,0,X+te),wi(_,P,2,0,X-te),wi(_,P,3,0,V-ve),q++,P+=32}function $p(m,v,_,P){var R=m[v+0]+4,q=35468*m[v+4]>>16,H=Wr(m[v+4]),V=35468*m[v+1]>>16;zo(_,P,0,R+H,m=Wr(m[v+1]),V),zo(_,P,1,R+q,m,V),zo(_,P,2,R-q,m,V),zo(_,P,3,R-H,m,V)}function zp(m,v,_,P,R){xu(m,v,_,P),R&&xu(m,v+16,_,P+4)}function qp(m,v,_,P){Vr(m,v+0,_,P,1),Vr(m,v+32,_,P+128,1)}function zi(m,v,_,P){var R;for(m=m[v+0]+4,R=0;4>R;++R)for(v=0;4>v;++v)wi(_,P,v,R,m)}function S0(m,v,_,P){m[v+0]&&Ki(m,v+0,_,P),m[v+16]&&Ki(m,v+16,_,P+4),m[v+32]&&Ki(m,v+32,_,P+128),m[v+48]&&Ki(m,v+48,_,P+128+4)}function A0(m,v,_,P){var R,q=i(16);for(R=0;4>R;++R){var H=m[v+0+R]+m[v+12+R],V=m[v+4+R]+m[v+8+R],X=m[v+4+R]-m[v+8+R],te=m[v+0+R]-m[v+12+R];q[0+R]=H+V,q[8+R]=H-V,q[4+R]=te+X,q[12+R]=te-X}for(R=0;4>R;++R)H=(m=q[0+4*R]+3)+q[3+4*R],V=q[1+4*R]+q[2+4*R],X=q[1+4*R]-q[2+4*R],te=m-q[3+4*R],_[P+0]=H+V>>3,_[P+16]=te+X>>3,_[P+32]=H-V>>3,_[P+48]=te-X>>3,P+=64}function Ys(m,v,_){var P,R=v-32,q=ka,H=255-m[R-1];for(P=0;P<_;++P){var V,X=q,te=H+m[v-1];for(V=0;V<_;++V)m[v+V]=X[te+m[R+V]];v+=32}}function vu(m,v){Ys(m,v,4)}function Wp(m,v){Ys(m,v,8)}function Hp(m,v){Ys(m,v,16)}function Gp(m,v){var _;for(_=0;16>_;++_)n(m,v+32*_,m,v-32,16)}function yu(m,v){var _;for(_=16;0<_;--_)a(m,v,m[v-1],16),v+=32}function qo(m,v,_){var P;for(P=0;16>P;++P)a(v,_+32*P,m,16)}function Xs(m,v){var _,P=16;for(_=0;16>_;++_)P+=m[v-1+32*_]+m[v+_-32];qo(P>>5,m,v)}function Vp(m,v){var _,P=8;for(_=0;16>_;++_)P+=m[v-1+32*_];qo(P>>4,m,v)}function Wo(m,v){var _,P=8;for(_=0;16>_;++_)P+=m[v+_-32];qo(P>>4,m,v)}function bu(m,v){qo(128,m,v)}function Lt(m,v,_){return m+2*v+_+2>>2}function Kp(m,v){var _,P=v-32;for(P=new Uint8Array([Lt(m[P-1],m[P+0],m[P+1]),Lt(m[P+0],m[P+1],m[P+2]),Lt(m[P+1],m[P+2],m[P+3]),Lt(m[P+2],m[P+3],m[P+4])]),_=0;4>_;++_)n(m,v+32*_,P,0,P.length)}function Yp(m,v){var _=m[v-1],P=m[v-1+32],R=m[v-1+64],q=m[v-1+96];le(m,v+0,16843009*Lt(m[v-1-32],_,P)),le(m,v+32,16843009*Lt(_,P,R)),le(m,v+64,16843009*Lt(P,R,q)),le(m,v+96,16843009*Lt(R,q,q))}function Xp(m,v){var _,P=4;for(_=0;4>_;++_)P+=m[v+_-32]+m[v-1+32*_];for(P>>=3,_=0;4>_;++_)a(m,v+32*_,P,4)}function Zp(m,v){var _=m[v-1+0],P=m[v-1+32],R=m[v-1+64],q=m[v-1-32],H=m[v+0-32],V=m[v+1-32],X=m[v+2-32],te=m[v+3-32];m[v+0+96]=Lt(P,R,m[v-1+96]),m[v+1+96]=m[v+0+64]=Lt(_,P,R),m[v+2+96]=m[v+1+64]=m[v+0+32]=Lt(q,_,P),m[v+3+96]=m[v+2+64]=m[v+1+32]=m[v+0+0]=Lt(H,q,_),m[v+3+64]=m[v+2+32]=m[v+1+0]=Lt(V,H,q),m[v+3+32]=m[v+2+0]=Lt(X,V,H),m[v+3+0]=Lt(te,X,V)}function us(m,v){var _=m[v+1-32],P=m[v+2-32],R=m[v+3-32],q=m[v+4-32],H=m[v+5-32],V=m[v+6-32],X=m[v+7-32];m[v+0+0]=Lt(m[v+0-32],_,P),m[v+1+0]=m[v+0+32]=Lt(_,P,R),m[v+2+0]=m[v+1+32]=m[v+0+64]=Lt(P,R,q),m[v+3+0]=m[v+2+32]=m[v+1+64]=m[v+0+96]=Lt(R,q,H),m[v+3+32]=m[v+2+64]=m[v+1+96]=Lt(q,H,V),m[v+3+64]=m[v+2+96]=Lt(H,V,X),m[v+3+96]=Lt(V,X,X)}function fs(m,v){var _=m[v-1+0],P=m[v-1+32],R=m[v-1+64],q=m[v-1-32],H=m[v+0-32],V=m[v+1-32],X=m[v+2-32],te=m[v+3-32];m[v+0+0]=m[v+1+64]=q+H+1>>1,m[v+1+0]=m[v+2+64]=H+V+1>>1,m[v+2+0]=m[v+3+64]=V+X+1>>1,m[v+3+0]=X+te+1>>1,m[v+0+96]=Lt(R,P,_),m[v+0+64]=Lt(P,_,q),m[v+0+32]=m[v+1+96]=Lt(_,q,H),m[v+1+32]=m[v+2+96]=Lt(q,H,V),m[v+2+32]=m[v+3+96]=Lt(H,V,X),m[v+3+32]=Lt(V,X,te)}function Jp(m,v){var _=m[v+0-32],P=m[v+1-32],R=m[v+2-32],q=m[v+3-32],H=m[v+4-32],V=m[v+5-32],X=m[v+6-32],te=m[v+7-32];m[v+0+0]=_+P+1>>1,m[v+1+0]=m[v+0+64]=P+R+1>>1,m[v+2+0]=m[v+1+64]=R+q+1>>1,m[v+3+0]=m[v+2+64]=q+H+1>>1,m[v+0+32]=Lt(_,P,R),m[v+1+32]=m[v+0+96]=Lt(P,R,q),m[v+2+32]=m[v+1+96]=Lt(R,q,H),m[v+3+32]=m[v+2+96]=Lt(q,H,V),m[v+3+64]=Lt(H,V,X),m[v+3+96]=Lt(V,X,te)}function Qp(m,v){var _=m[v-1+0],P=m[v-1+32],R=m[v-1+64],q=m[v-1+96];m[v+0+0]=_+P+1>>1,m[v+2+0]=m[v+0+32]=P+R+1>>1,m[v+2+32]=m[v+0+64]=R+q+1>>1,m[v+1+0]=Lt(_,P,R),m[v+3+0]=m[v+1+32]=Lt(P,R,q),m[v+3+32]=m[v+1+64]=Lt(R,q,q),m[v+3+64]=m[v+2+64]=m[v+0+96]=m[v+1+96]=m[v+2+96]=m[v+3+96]=q}function Vl(m,v){var _=m[v-1+0],P=m[v-1+32],R=m[v-1+64],q=m[v-1+96],H=m[v-1-32],V=m[v+0-32],X=m[v+1-32],te=m[v+2-32];m[v+0+0]=m[v+2+32]=_+H+1>>1,m[v+0+32]=m[v+2+64]=P+_+1>>1,m[v+0+64]=m[v+2+96]=R+P+1>>1,m[v+0+96]=q+R+1>>1,m[v+3+0]=Lt(V,X,te),m[v+2+0]=Lt(H,V,X),m[v+1+0]=m[v+3+32]=Lt(_,H,V),m[v+1+32]=m[v+3+64]=Lt(P,_,H),m[v+1+64]=m[v+3+96]=Lt(R,P,_),m[v+1+96]=Lt(q,R,P)}function wu(m,v){var _;for(_=0;8>_;++_)n(m,v+32*_,m,v-32,8)}function Ho(m,v){var _;for(_=0;8>_;++_)a(m,v,m[v-1],8),v+=32}function Kl(m,v,_){var P;for(P=0;8>P;++P)a(v,_+32*P,m,8)}function Yl(m,v){var _,P=8;for(_=0;8>_;++_)P+=m[v+_-32]+m[v-1+32*_];Kl(P>>4,m,v)}function em(m,v){var _,P=4;for(_=0;8>_;++_)P+=m[v+_-32];Kl(P>>3,m,v)}function _u(m,v){var _,P=4;for(_=0;8>_;++_)P+=m[v-1+32*_];Kl(P>>3,m,v)}function Nu(m,v){Kl(128,m,v)}function Go(m,v,_){var P=m[v-_],R=m[v+0],q=3*(R-P)+nm[1020+m[v-2*_]-m[v+_]],H=P0[112+(q+4>>3)];m[v-_]=ka[255+P+P0[112+(q+3>>3)]],m[v+0]=ka[255+R-H]}function Vo(m,v,_,P){var R=m[v+0],q=m[v+_];return ti[255+m[v-2*_]-m[v-_]]>P||ti[255+q-R]>P}function Su(m,v,_,P){return 4*ti[255+m[v-_]-m[v+0]]+ti[255+m[v-2*_]-m[v+_]]<=P}function Xl(m,v,_,P,R){var q=m[v-3*_],H=m[v-2*_],V=m[v-_],X=m[v+0],te=m[v+_],ve=m[v+2*_],je=m[v+3*_];return 4*ti[255+V-X]+ti[255+H-te]>P?0:ti[255+m[v-4*_]-q]<=R&&ti[255+q-H]<=R&&ti[255+H-V]<=R&&ti[255+je-ve]<=R&&ti[255+ve-te]<=R&&ti[255+te-X]<=R}function Au(m,v,_,P){var R=2*P+1;for(P=0;16>P;++P)Su(m,v+P,_,R)&&Go(m,v+P,_)}function Ko(m,v,_,P){var R=2*P+1;for(P=0;16>P;++P)Su(m,v+P*_,1,R)&&Go(m,v+P*_,1)}function Eu(m,v,_,P){var R;for(R=3;0<R;--R)Au(m,v+=4*_,_,P)}function Tu(m,v,_,P){var R;for(R=3;0<R;--R)Ko(m,v+=4,_,P)}function ja(m,v,_,P,R,q,H,V){for(q=2*q+1;0<R--;){if(Xl(m,v,_,q,H))if(Vo(m,v,_,V))Go(m,v,_);else{var X=m,te=v,ve=_,je=X[te-2*ve],re=X[te-ve],be=X[te+0],_e=X[te+ve],Ie=X[te+2*ve],Te=27*(Ue=nm[1020+3*(be-re)+nm[1020+je-_e]])+63>>7,Me=18*Ue+63>>7,Ue=9*Ue+63>>7;X[te-3*ve]=ka[255+X[te-3*ve]+Ue],X[te-2*ve]=ka[255+je+Me],X[te-ve]=ka[255+re+Te],X[te+0]=ka[255+be-Te],X[te+ve]=ka[255+_e-Me],X[te+2*ve]=ka[255+Ie-Ue]}v+=P}}function qi(m,v,_,P,R,q,H,V){for(q=2*q+1;0<R--;){if(Xl(m,v,_,q,H))if(Vo(m,v,_,V))Go(m,v,_);else{var X=m,te=v,ve=_,je=X[te-ve],re=X[te+0],be=X[te+ve],_e=P0[112+(4+(Ie=3*(re-je))>>3)],Ie=P0[112+(Ie+3>>3)],Te=_e+1>>1;X[te-2*ve]=ka[255+X[te-2*ve]+Te],X[te-ve]=ka[255+je+Ie],X[te+0]=ka[255+re-_e],X[te+ve]=ka[255+be-Te]}v+=P}}function w(m,v,_,P,R,q){ja(m,v,_,1,16,P,R,q)}function B(m,v,_,P,R,q){ja(m,v,1,_,16,P,R,q)}function ie(m,v,_,P,R,q){var H;for(H=3;0<H;--H)qi(m,v+=4*_,_,1,16,P,R,q)}function de(m,v,_,P,R,q){var H;for(H=3;0<H;--H)qi(m,v+=4,1,_,16,P,R,q)}function we(m,v,_,P,R,q,H,V){ja(m,v,R,1,8,q,H,V),ja(_,P,R,1,8,q,H,V)}function Be(m,v,_,P,R,q,H,V){ja(m,v,1,R,8,q,H,V),ja(_,P,1,R,8,q,H,V)}function He(m,v,_,P,R,q,H,V){qi(m,v+4*R,R,1,8,q,H,V),qi(_,P+4*R,R,1,8,q,H,V)}function gt(m,v,_,P,R,q,H,V){qi(m,v+4,1,R,8,q,H,V),qi(_,P+4,1,R,8,q,H,V)}function wt(){this.ba=new Wt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Ut,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function kt(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function It(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function tr(){this.ua=0,this.Wa=new Re,this.vb=new Re,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new he,this.yc=new G}function Ir(){this.xb=this.a=0,this.l=new Gn,this.ca=new Wt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new D,this.Pb=0,this.wd=new D,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new tr,this.ab=0,this.gc=s(4,It),this.Oc=0}function rn(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Gn,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function mr(m,v,_,P,R,q,H){for(m=m==null?0:m[v+0],v=0;v<H;++v)R[q+v]=m+_[P+v]&255,m=R[q+v]}function fn(m,v,_,P,R,q,H){var V;if(m==null)mr(null,null,_,P,R,q,H);else for(V=0;V<H;++V)R[q+V]=m[v+V]+_[P+V]&255}function nn(m,v,_,P,R,q,H){if(m==null)mr(null,null,_,P,R,q,H);else{var V,X=m[v+0],te=X,ve=X;for(V=0;V<H;++V)te=ve+(X=m[v+V])-te,ve=_[P+V]+(-256&te?0>te?0:255:te)&255,te=X,R[q+V]=ve}}function Cn(m,v,_,P){var R=v.width,q=v.o;if(t(m!=null&&v!=null),0>_||0>=P||_+P>q)return null;if(!m.Cc){if(m.ga==null){var H;if(m.ga=new rn,(H=m.ga==null)||(H=v.width*v.o,t(m.Gb.length==0),m.Gb=i(H),m.Uc=0,m.Gb==null?H=0:(m.mb=m.Gb,m.nb=m.Uc,m.rc=null,H=1),H=!H),!H){H=m.ga;var V=m.Fa,X=m.P,te=m.qc,ve=m.mb,je=m.nb,re=X+1,be=te-1,_e=H.l;if(t(V!=null&&ve!=null&&v!=null),no[0]=null,no[1]=mr,no[2]=fn,no[3]=nn,H.ca=ve,H.tb=je,H.c=v.width,H.i=v.height,t(0<H.c&&0<H.i),1>=te)v=0;else if(H.$a=3&V[X+0],H.Z=V[X+0]>>2&3,H.Lc=V[X+0]>>4&3,X=V[X+0]>>6&3,0>H.$a||1<H.$a||4<=H.Z||1<H.Lc||X)v=0;else if(_e.put=Et,_e.ac=kn,_e.bc=vi,_e.ma=H,_e.width=v.width,_e.height=v.height,_e.Da=v.Da,_e.v=v.v,_e.va=v.va,_e.j=v.j,_e.o=v.o,H.$a)e:{t(H.$a==1),v=Ae();t:for(;;){if(v==null){v=0;break e}if(t(H!=null),H.mc=v,v.c=H.c,v.i=H.i,v.l=H.l,v.l.ma=H,v.l.width=H.c,v.l.height=H.i,v.a=0,ge(v.m,V,re,be),!Ee(H.c,H.i,1,v,null)||(v.ab==1&&v.gc[0].hc==3&&J(v.s)?(H.ic=1,V=v.c*v.i,v.Ta=null,v.Ua=0,v.V=i(V),v.Ba=0,v.V==null?(v.a=1,v=0):v=1):(H.ic=0,v=ke(v,H.c)),!v))break t;v=1;break e}H.mc=null,v=0}else v=be>=H.c*H.i;H=!v}if(H)return null;m.ga.Lc!=1?m.Ga=0:P=q-_}t(m.ga!=null),t(_+P<=q);e:{if(v=(V=m.ga).c,q=V.l.o,V.$a==0){if(re=m.rc,be=m.Vc,_e=m.Fa,X=m.P+1+_*v,te=m.mb,ve=m.nb+_*v,t(X<=m.P+m.qc),V.Z!=0)for(t(no[V.Z]!=null),H=0;H<P;++H)no[V.Z](re,be,_e,X,te,ve,v),re=te,be=ve,ve+=v,X+=v;else for(H=0;H<P;++H)n(te,ve,_e,X,v),re=te,be=ve,ve+=v,X+=v;m.rc=re,m.Vc=be}else{if(t(V.mc!=null),v=_+P,t((H=V.mc)!=null),t(v<=H.i),H.C>=v)v=1;else if(V.ic||Yo(),V.ic){V=H.V,re=H.Ba,be=H.c;var Ie=H.i,Te=(_e=1,X=H.$/be,te=H.$%be,ve=H.m,je=H.s,H.$),Me=be*Ie,Ue=be*v,Ve=je.wc,We=Te<Ue?z(je,te,X):null;t(Te<=Me),t(v<=Ie),t(J(je));t:for(;;){for(;!ve.h&&Te<Ue;){if(te&Ve||(We=z(je,te,X)),t(We!=null),ce(ve),256>(Ie=Cr(We.G[0],We.H[0],ve)))V[re+Te]=Ie,++Te,++te>=be&&(te=0,++X<=v&&!(X%16)&&se(H,X));else{if(!(280>Ie)){_e=0;break t}Ie=Hn(Ie-256,ve);var Nt,ut=Cr(We.G[4],We.H[4],ve);if(ce(ve),!(Te>=(ut=da(be,ut=Hn(ut,ve)))&&Me-Te>=Ie)){_e=0;break t}for(Nt=0;Nt<Ie;++Nt)V[re+Te+Nt]=V[re+Te+Nt-ut];for(Te+=Ie,te+=Ie;te>=be;)te-=be,++X<=v&&!(X%16)&&se(H,X);Te<Ue&&te&Ve&&(We=z(je,te,X))}t(ve.h==F(ve))}se(H,X>v?v:X);break t}!_e||ve.h&&Te<Me?(_e=0,H.a=ve.h?5:3):H.$=Te,v=_e}else v=Ne(H,H.V,H.Ba,H.c,H.i,v,Ge);if(!v){P=0;break e}}_+P>=q&&(m.Cc=1),P=1}if(!P)return null;if(m.Cc&&((P=m.ga)!=null&&(P.mc=null),m.ga=null,0<m.Ga))return alert("todo:WebPDequantizeLevels"),null}return m.nb+_*R}function hs(m,v,_,P,R,q){for(;0<R--;){var H,V=m,X=v+(_?1:0),te=m,ve=v+(_?0:3);for(H=0;H<P;++H){var je=te[ve+4*H];je!=255&&(je*=32897,V[X+4*H+0]=V[X+4*H+0]*je>>23,V[X+4*H+1]=V[X+4*H+1]*je>>23,V[X+4*H+2]=V[X+4*H+2]*je>>23)}v+=q}}function Zs(m,v,_,P,R){for(;0<P--;){var q;for(q=0;q<_;++q){var H=m[v+2*q+0],V=15&(te=m[v+2*q+1]),X=4369*V,te=(240&te|te>>4)*X>>16;m[v+2*q+0]=(240&H|H>>4)*X>>16&240|(15&H|H<<4)*X>>16>>4&15,m[v+2*q+1]=240&te|V}v+=R}}function tm(m,v,_,P,R,q,H,V){var X,te,ve=255;for(te=0;te<R;++te){for(X=0;X<P;++X){var je=m[v+X];q[H+4*X]=je,ve&=je}v+=_,H+=V}return ve!=255}function E0(m,v,_,P,R){var q;for(q=0;q<R;++q)_[P+q]=m[v+q]>>8}function Yo(){Iu=hs,E2=Zs,T2=tm,j2=E0}function _i(m,v,_){j[m]=function(P,R,q,H,V,X,te,ve,je,re,be,_e,Ie,Te,Me,Ue,Ve){var We,Nt=Ve-1>>1,ut=V[X+0]|te[ve+0]<<16,Mt=je[re+0]|be[_e+0]<<16;t(P!=null);var vt=3*ut+Mt+131074>>2;for(v(P[R+0],255&vt,vt>>16,Ie,Te),q!=null&&(vt=3*Mt+ut+131074>>2,v(q[H+0],255&vt,vt>>16,Me,Ue)),We=1;We<=Nt;++We){var Ht=V[X+We]|te[ve+We]<<16,dn=je[re+We]|be[_e+We]<<16,Rt=ut+Ht+Mt+dn+524296,yt=Rt+2*(Ht+Mt)>>3;vt=yt+ut>>1,ut=(Rt=Rt+2*(ut+dn)>>3)+Ht>>1,v(P[R+2*We-1],255&vt,vt>>16,Ie,Te+(2*We-1)*_),v(P[R+2*We-0],255&ut,ut>>16,Ie,Te+(2*We-0)*_),q!=null&&(vt=Rt+Mt>>1,ut=yt+dn>>1,v(q[H+2*We-1],255&vt,vt>>16,Me,Ue+(2*We-1)*_),v(q[H+2*We+0],255&ut,ut>>16,Me,Ue+(2*We+0)*_)),ut=Ht,Mt=dn}1&Ve||(vt=3*ut+Mt+131074>>2,v(P[R+Ve-1],255&vt,vt>>16,Ie,Te+(Ve-1)*_),q!=null&&(vt=3*Mt+ut+131074>>2,v(q[H+Ve-1],255&vt,vt>>16,Me,Ue+(Ve-1)*_)))}}function ju(){ri[k0]=RT,ri[C0]=B2,ri[F2]=BT,ri[O0]=U2,ri[L0]=$2,ri[am]=z2,ri[D2]=UT,ri[im]=B2,ri[sm]=U2,ri[F0]=$2,ri[om]=z2}function Zl(m){return m&~$T?0>m?0:255:m>>q2}function Js(m,v){return Zl((19077*m>>8)+(26149*v>>8)-14234)}function bn(m,v,_){return Zl((19077*m>>8)-(6419*v>>8)-(13320*_>>8)+8708)}function ds(m,v){return Zl((19077*m>>8)+(33050*v>>8)-17685)}function ps(m,v,_,P,R){P[R+0]=Js(m,_),P[R+1]=bn(m,v,_),P[R+2]=ds(m,v)}function Jl(m,v,_,P,R){P[R+0]=ds(m,v),P[R+1]=bn(m,v,_),P[R+2]=Js(m,_)}function Pu(m,v,_,P,R){var q=bn(m,v,_);v=q<<3&224|ds(m,v)>>3,P[R+0]=248&Js(m,_)|q>>5,P[R+1]=v}function na(m,v,_,P,R){var q=240&ds(m,v)|15;P[R+0]=240&Js(m,_)|bn(m,v,_)>>4,P[R+1]=q}function T0(m,v,_,P,R){P[R+0]=255,ps(m,v,_,P,R+1)}function Ql(m,v,_,P,R){Jl(m,v,_,P,R),P[R+3]=255}function j0(m,v,_,P,R){ps(m,v,_,P,R),P[R+3]=255}function hn(m,v){return 0>m?0:m>v?v:m}function ei(m,v,_){j[m]=function(P,R,q,H,V,X,te,ve,je){for(var re=ve+(-2&je)*_;ve!=re;)v(P[R+0],q[H+0],V[X+0],te,ve),v(P[R+1],q[H+0],V[X+0],te,ve+_),R+=2,++H,++X,ve+=2*_;1&je&&v(P[R+0],q[H+0],V[X+0],te,ve)}}function ku(m,v,_){return _==0?m==0?v==0?6:5:v==0?4:0:_}function Cu(m,v,_,P,R){switch(m>>>30){case 3:Vr(v,_,P,R,0);break;case 2:gs(v,_,P,R);break;case 1:Ki(v,_,P,R)}}function Qs(m,v){var _,P,R=v.M,q=v.Nb,H=m.oc,V=m.pc+40,X=m.oc,te=m.pc+584,ve=m.oc,je=m.pc+600;for(_=0;16>_;++_)H[V+32*_-1]=129;for(_=0;8>_;++_)X[te+32*_-1]=129,ve[je+32*_-1]=129;for(0<R?H[V-1-32]=X[te-1-32]=ve[je-1-32]=129:(a(H,V-32-1,127,21),a(X,te-32-1,127,9),a(ve,je-32-1,127,9)),P=0;P<m.za;++P){var re=v.ya[v.aa+P];if(0<P){for(_=-1;16>_;++_)n(H,V+32*_-4,H,V+32*_+12,4);for(_=-1;8>_;++_)n(X,te+32*_-4,X,te+32*_+4,4),n(ve,je+32*_-4,ve,je+32*_+4,4)}var be=m.Gd,_e=m.Hd+P,Ie=re.ad,Te=re.Hc;if(0<R&&(n(H,V-32,be[_e].y,0,16),n(X,te-32,be[_e].f,0,8),n(ve,je-32,be[_e].ea,0,8)),re.Za){var Me=H,Ue=V-32+16;for(0<R&&(P>=m.za-1?a(Me,Ue,be[_e].y[15],4):n(Me,Ue,be[_e+1].y,0,4)),_=0;4>_;_++)Me[Ue+128+_]=Me[Ue+256+_]=Me[Ue+384+_]=Me[Ue+0+_];for(_=0;16>_;++_,Te<<=2)Me=H,Ue=V+H2[_],Ni[re.Ob[_]](Me,Ue),Cu(Te,Ie,16*+_,Me,Ue)}else if(Me=ku(P,R,re.Ob[0]),ro[Me](H,V),Te!=0)for(_=0;16>_;++_,Te<<=2)Cu(Te,Ie,16*+_,H,V+H2[_]);for(_=re.Gc,Me=ku(P,R,re.Dd),xs[Me](X,te),xs[Me](ve,je),Te=Ie,Me=X,Ue=te,255&(re=0|_)&&(170&re?ac(Te,256,Me,Ue):Du(Te,256,Me,Ue)),re=ve,Te=je,255&(_>>=8)&&(170&_?ac(Ie,320,re,Te):Du(Ie,320,re,Te)),R<m.Ub-1&&(n(be[_e].y,0,H,V+480,16),n(be[_e].f,0,X,te+224,8),n(be[_e].ea,0,ve,je+224,8)),_=8*q*m.B,be=m.sa,_e=m.ta+16*P+16*q*m.R,Ie=m.qa,re=m.ra+8*P+_,Te=m.Ha,Me=m.Ia+8*P+_,_=0;16>_;++_)n(be,_e+_*m.R,H,V+32*_,16);for(_=0;8>_;++_)n(Ie,re+_*m.B,X,te+32*_,8),n(Te,Me+_*m.B,ve,je+32*_,8)}}function ec(m,v,_,P,R,q,H,V,X){var te=[0],ve=[0],je=0,re=X!=null?X.kd:0,be=X??new kt;if(m==null||12>_)return 7;be.data=m,be.w=v,be.ha=_,v=[v],_=[_],be.gb=[be.gb];e:{var _e=v,Ie=_,Te=be.gb;if(t(m!=null),t(Ie!=null),t(Te!=null),Te[0]=0,12<=Ie[0]&&!r(m,_e[0],"RIFF")){if(r(m,_e[0]+8,"WEBP")){Te=3;break e}var Me=ye(m,_e[0]+4);if(12>Me||4294967286<Me){Te=3;break e}if(re&&Me>Ie[0]-8){Te=7;break e}Te[0]=Me,_e[0]+=12,Ie[0]-=12}Te=0}if(Te!=0)return Te;for(Me=0<be.gb[0],_=_[0];;){e:{var Ue=m;Ie=v,Te=_;var Ve=te,We=ve,Nt=_e=[0];if((vt=je=[je])[0]=0,8>Te[0])Te=7;else{if(!r(Ue,Ie[0],"VP8X")){if(ye(Ue,Ie[0]+4)!=10){Te=3;break e}if(18>Te[0]){Te=7;break e}var ut=ye(Ue,Ie[0]+8),Mt=1+$e(Ue,Ie[0]+12);if(2147483648<=Mt*(Ue=1+$e(Ue,Ie[0]+15))){Te=3;break e}Nt!=null&&(Nt[0]=ut),Ve!=null&&(Ve[0]=Mt),We!=null&&(We[0]=Ue),Ie[0]+=18,Te[0]-=18,vt[0]=1}Te=0}}if(je=je[0],_e=_e[0],Te!=0)return Te;if(Ie=!!(2&_e),!Me&&je)return 3;if(q!=null&&(q[0]=!!(16&_e)),H!=null&&(H[0]=Ie),V!=null&&(V[0]=0),H=te[0],_e=ve[0],je&&Ie&&X==null){Te=0;break}if(4>_){Te=7;break}if(Me&&je||!Me&&!je&&!r(m,v[0],"ALPH")){_=[_],be.na=[be.na],be.P=[be.P],be.Sa=[be.Sa];e:{ut=m,Te=v,Me=_;var vt=be.gb;Ve=be.na,We=be.P,Nt=be.Sa,Mt=22,t(ut!=null),t(Me!=null),Ue=Te[0];var Ht=Me[0];for(t(Ve!=null),t(Nt!=null),Ve[0]=null,We[0]=null,Nt[0]=0;;){if(Te[0]=Ue,Me[0]=Ht,8>Ht){Te=7;break e}var dn=ye(ut,Ue+4);if(4294967286<dn){Te=3;break e}var Rt=8+dn+1&-2;if(Mt+=Rt,0<vt&&Mt>vt){Te=3;break e}if(!r(ut,Ue,"VP8 ")||!r(ut,Ue,"VP8L")){Te=0;break e}if(Ht[0]<Rt){Te=7;break e}r(ut,Ue,"ALPH")||(Ve[0]=ut,We[0]=Ue+8,Nt[0]=dn),Ue+=Rt,Ht-=Rt}}if(_=_[0],be.na=be.na[0],be.P=be.P[0],be.Sa=be.Sa[0],Te!=0)break}_=[_],be.Ja=[be.Ja],be.xa=[be.xa];e:if(vt=m,Te=v,Me=_,Ve=be.gb[0],We=be.Ja,Nt=be.xa,ut=Te[0],Ue=!r(vt,ut,"VP8 "),Mt=!r(vt,ut,"VP8L"),t(vt!=null),t(Me!=null),t(We!=null),t(Nt!=null),8>Me[0])Te=7;else{if(Ue||Mt){if(vt=ye(vt,ut+4),12<=Ve&&vt>Ve-12){Te=3;break e}if(re&&vt>Me[0]-8){Te=7;break e}We[0]=vt,Te[0]+=8,Me[0]-=8,Nt[0]=Mt}else Nt[0]=5<=Me[0]&&vt[ut+0]==47&&!(vt[ut+4]>>5),We[0]=Me[0];Te=0}if(_=_[0],be.Ja=be.Ja[0],be.xa=be.xa[0],v=v[0],Te!=0)break;if(4294967286<be.Ja)return 3;if(V==null||Ie||(V[0]=be.xa?2:1),H=[H],_e=[_e],be.xa){if(5>_){Te=7;break}V=H,re=_e,Ie=q,m==null||5>_?m=0:5<=_&&m[v+0]==47&&!(m[v+4]>>5)?(Me=[0],vt=[0],Ve=[0],ge(We=new D,m,v,_),yi(We,Me,vt,Ve)?(V!=null&&(V[0]=Me[0]),re!=null&&(re[0]=vt[0]),Ie!=null&&(Ie[0]=Ve[0]),m=1):m=0):m=0}else{if(10>_){Te=7;break}V=_e,m==null||10>_||!_0(m,v+3,_-3)?m=0:(re=m[v+0]|m[v+1]<<8|m[v+2]<<16,Ie=16383&(m[v+7]<<8|m[v+6]),m=16383&(m[v+9]<<8|m[v+8]),1&re||3<(re>>1&7)||!(re>>4&1)||re>>5>=be.Ja||!Ie||!m?m=0:(H&&(H[0]=Ie),V&&(V[0]=m),m=1))}if(!m||(H=H[0],_e=_e[0],je&&(te[0]!=H||ve[0]!=_e)))return 3;X!=null&&(X[0]=be,X.offset=v-X.w,t(4294967286>v-X.w),t(X.offset==X.ha-_));break}return Te==0||Te==7&&je&&X==null?(q!=null&&(q[0]|=be.na!=null&&0<be.na.length),P!=null&&(P[0]=H),R!=null&&(R[0]=_e),0):Te}function pa(m,v,_){var P=v.width,R=v.height,q=0,H=0,V=P,X=R;if(v.Da=m!=null&&0<m.Da,v.Da&&(V=m.cd,X=m.bd,q=m.v,H=m.j,11>_||(q&=-2,H&=-2),0>q||0>H||0>=V||0>=X||q+V>P||H+X>R))return 0;if(v.v=q,v.j=H,v.va=q+V,v.o=H+X,v.U=V,v.T=X,v.da=m!=null&&0<m.da,v.da){if(!ot(V,X,_=[m.ib],q=[m.hb]))return 0;v.ib=_[0],v.hb=q[0]}return v.ob=m!=null&&m.ob,v.Kb=m==null||!m.Sd,v.da&&(v.ob=v.ib<3*P/4&&v.hb<3*R/4,v.Kb=0),1}function ma(m){if(m==null)return 2;if(11>m.S){var v=m.f.RGBA;v.fb+=(m.height-1)*v.A,v.A=-v.A}else v=m.f.kb,m=m.height,v.O+=(m-1)*v.fa,v.fa=-v.fa,v.N+=(m-1>>1)*v.Ab,v.Ab=-v.Ab,v.W+=(m-1>>1)*v.Db,v.Db=-v.Db,v.F!=null&&(v.J+=(m-1)*v.lb,v.lb=-v.lb);return 0}function Xo(m,v,_,P){if(P==null||0>=m||0>=v)return 2;if(_!=null){if(_.Da){var R=_.cd,q=_.bd,H=-2&_.v,V=-2&_.j;if(0>H||0>V||0>=R||0>=q||H+R>m||V+q>v)return 2;m=R,v=q}if(_.da){if(!ot(m,v,R=[_.ib],q=[_.hb]))return 2;m=R[0],v=q[0]}}P.width=m,P.height=v;e:{var X=P.width,te=P.height;if(m=P.S,0>=X||0>=te||!(m>=k0&&13>m))m=2;else{if(0>=P.Rd&&P.sd==null){H=q=R=v=0;var ve=(V=X*G2[m])*te;if(11>m||(q=(te+1)/2*(v=(X+1)/2),m==12&&(H=(R=X)*te)),(te=i(ve+2*q+H))==null){m=1;break e}P.sd=te,11>m?((X=P.f.RGBA).eb=te,X.fb=0,X.A=V,X.size=ve):((X=P.f.kb).y=te,X.O=0,X.fa=V,X.Fd=ve,X.f=te,X.N=0+ve,X.Ab=v,X.Cd=q,X.ea=te,X.W=0+ve+q,X.Db=v,X.Ed=q,m==12&&(X.F=te,X.J=0+ve+2*q),X.Tc=H,X.lb=R)}if(v=1,R=P.S,q=P.width,H=P.height,R>=k0&&13>R)if(11>R)m=P.f.RGBA,v&=(V=Math.abs(m.A))*(H-1)+q<=m.size,v&=V>=q*G2[R],v&=m.eb!=null;else{m=P.f.kb,V=(q+1)/2,ve=(H+1)/2,X=Math.abs(m.fa),te=Math.abs(m.Ab);var je=Math.abs(m.Db),re=Math.abs(m.lb),be=re*(H-1)+q;v&=X*(H-1)+q<=m.Fd,v&=te*(ve-1)+V<=m.Cd,v=(v&=je*(ve-1)+V<=m.Ed)&X>=q&te>=V&je>=V,v&=m.y!=null,v&=m.f!=null,v&=m.ea!=null,R==12&&(v&=re>=q,v&=be<=m.Tc,v&=m.F!=null)}else v=0;m=v?0:2}}return m!=0||_!=null&&_.fd&&(m=ma(P)),m}var Wi=64,eo=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Ou=24,to=32,Hr=8,rm=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Qe("Predictor0","PredictorAdd0"),j.Predictor0=function(){return 4278190080},j.Predictor1=function(m){return m},j.Predictor2=function(m,v,_){return v[_+0]},j.Predictor3=function(m,v,_){return v[_+1]},j.Predictor4=function(m,v,_){return v[_-1]},j.Predictor5=function(m,v,_){return ft(ft(m,v[_+1]),v[_+0])},j.Predictor6=function(m,v,_){return ft(m,v[_-1])},j.Predictor7=function(m,v,_){return ft(m,v[_+0])},j.Predictor8=function(m,v,_){return ft(v[_-1],v[_+0])},j.Predictor9=function(m,v,_){return ft(v[_+0],v[_+1])},j.Predictor10=function(m,v,_){return ft(ft(m,v[_-1]),ft(v[_+0],v[_+1]))},j.Predictor11=function(m,v,_){var P=v[_+0];return 0>=Xe(P>>24&255,m>>24&255,(v=v[_-1])>>24&255)+Xe(P>>16&255,m>>16&255,v>>16&255)+Xe(P>>8&255,m>>8&255,v>>8&255)+Xe(255&P,255&m,255&v)?P:m},j.Predictor12=function(m,v,_){var P=v[_+0];return(Ot((m>>24&255)+(P>>24&255)-((v=v[_-1])>>24&255))<<24|Ot((m>>16&255)+(P>>16&255)-(v>>16&255))<<16|Ot((m>>8&255)+(P>>8&255)-(v>>8&255))<<8|Ot((255&m)+(255&P)-(255&v)))>>>0},j.Predictor13=function(m,v,_){var P=v[_-1];return(Fe((m=ft(m,v[_+0]))>>24&255,P>>24&255)<<24|Fe(m>>16&255,P>>16&255)<<16|Fe(m>>8&255,P>>8&255)<<8|Fe(255&m,255&P))>>>0};var Hi=j.PredictorAdd0;j.PredictorAdd1=At,Qe("Predictor2","PredictorAdd2"),Qe("Predictor3","PredictorAdd3"),Qe("Predictor4","PredictorAdd4"),Qe("Predictor5","PredictorAdd5"),Qe("Predictor6","PredictorAdd6"),Qe("Predictor7","PredictorAdd7"),Qe("Predictor8","PredictorAdd8"),Qe("Predictor9","PredictorAdd9"),Qe("Predictor10","PredictorAdd10"),Qe("Predictor11","PredictorAdd11"),Qe("Predictor12","PredictorAdd12"),Qe("Predictor13","PredictorAdd13");var Gi=j.PredictorAdd2;ht("ColorIndexInverseTransform","MapARGB","32b",function(m){return m>>8&255},function(m){return m}),ht("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(m){return m},function(m){return m>>8&255});var tc,Lu=j.ColorIndexInverseTransform,rc=j.MapARGB,nc=j.VP8LColorIndexInverseTransformAlpha,Zo=j.MapAlpha,Jo=j.VP8LPredictorsAdd=[];Jo.length=16,(j.VP8LPredictors=[]).length=16,(j.VP8LPredictorsAdd_C=[]).length=16,(j.VP8LPredictors_C=[]).length=16;var ms,Fu,Pa,Vi,_r,Nr,Gr,Vr,gs,ac,Ki,Du,p2,m2,g2,x2,v2,y2,b2,w2,_2,N2,S2,A2,Iu,E2,T2,j2,P2=i(511),k2=i(2041),C2=i(225),O2=i(767),L2=0,nm=k2,P0=C2,ka=O2,ti=P2,k0=0,C0=1,F2=2,O0=3,L0=4,am=5,D2=6,im=7,sm=8,F0=9,om=10,ST=[2,3,7],AT=[3,3,11],I2=[280,256,256,256,40],ET=[0,1,1,1,0],TT=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],jT=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],PT=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],kT=8,lm=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],cm=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Mu=null,CT=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],OT=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],M2=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],LT=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],FT=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],DT=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],IT=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],ro=[],Ni=[],xs=[],MT=1,R2=2,no=[],ri=[];_i("UpsampleRgbLinePair",ps,3),_i("UpsampleBgrLinePair",Jl,3),_i("UpsampleRgbaLinePair",j0,4),_i("UpsampleBgraLinePair",Ql,4),_i("UpsampleArgbLinePair",T0,4),_i("UpsampleRgba4444LinePair",na,2),_i("UpsampleRgb565LinePair",Pu,2);var RT=j.UpsampleRgbLinePair,BT=j.UpsampleBgrLinePair,B2=j.UpsampleRgbaLinePair,U2=j.UpsampleBgraLinePair,$2=j.UpsampleArgbLinePair,z2=j.UpsampleRgba4444LinePair,UT=j.UpsampleRgb565LinePair,D0=16,I0=1<<D0-1,Ru=-227,um=482,q2=6,$T=(256<<q2)-1,W2=0,zT=i(256),qT=i(256),WT=i(256),HT=i(256),GT=i(um-Ru),VT=i(um-Ru);ei("YuvToRgbRow",ps,3),ei("YuvToBgrRow",Jl,3),ei("YuvToRgbaRow",j0,4),ei("YuvToBgraRow",Ql,4),ei("YuvToArgbRow",T0,4),ei("YuvToRgba4444Row",na,2),ei("YuvToRgb565Row",Pu,2);var H2=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],M0=[0,2,8],KT=[8,7,6,4,4,2,2,2,1,1,1,1],YT=1;this.WebPDecodeRGBA=function(m,v,_,P,R){var q=C0,H=new wt,V=new Wt;H.ba=V,V.S=q,V.width=[V.width],V.height=[V.height];var X=V.width,te=V.height,ve=new _t;if(ve==null||m==null)var je=2;else t(ve!=null),je=ec(m,v,_,ve.width,ve.height,ve.Pd,ve.Qd,ve.format,null);if(je!=0?X=0:(X!=null&&(X[0]=ve.width[0]),te!=null&&(te[0]=ve.height[0]),X=1),X){V.width=V.width[0],V.height=V.height[0],P!=null&&(P[0]=V.width),R!=null&&(R[0]=V.height);e:{if(P=new Gn,(R=new kt).data=m,R.w=v,R.ha=_,R.kd=1,v=[0],t(R!=null),((m=ec(R.data,R.w,R.ha,null,null,null,v,null,R))==0||m==7)&&v[0]&&(m=4),(v=m)==0){if(t(H!=null),P.data=R.data,P.w=R.w+R.offset,P.ha=R.ha-R.offset,P.put=Et,P.ac=kn,P.bc=vi,P.ma=H,R.xa){if((m=Ae())==null){H=1;break e}if(function(re,be){var _e=[0],Ie=[0],Te=[0];t:for(;;){if(re==null)return 0;if(be==null)return re.a=2,0;if(re.l=be,re.a=0,ge(re.m,be.data,be.w,be.ha),!yi(re.m,_e,Ie,Te)){re.a=3;break t}if(re.xb=R2,be.width=_e[0],be.height=Ie[0],!Ee(_e[0],Ie[0],1,re,null))break t;return 1}return t(re.a!=0),0}(m,P)){if(P=(v=Xo(P.width,P.height,H.Oa,H.ba))==0){t:{P=m;r:for(;;){if(P==null){P=0;break t}if(t(P.s.yc!=null),t(P.s.Ya!=null),t(0<P.s.Wb),t((_=P.l)!=null),t((R=_.ma)!=null),P.xb!=0){if(P.ca=R.ba,P.tb=R.tb,t(P.ca!=null),!pa(R.Oa,_,O0)){P.a=2;break r}if(!ke(P,_.width)||_.da)break r;if((_.da||bt(P.ca.S))&&Yo(),11>P.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),P.ca.f.kb.F!=null&&Yo()),P.Pb&&0<P.s.ua&&P.s.vb.X==null&&!Q(P.s.vb,P.s.Wa.Xa)){P.a=1;break r}P.xb=0}if(!Ne(P,P.V,P.Ba,P.c,P.i,_.o,Y))break r;R.Dc=P.Ma,P=1;break t}t(P.a!=0),P=0}P=!P}P&&(v=m.a)}else v=m.a}else{if((m=new Up)==null){H=1;break e}if(m.Fa=R.na,m.P=R.P,m.qc=R.Sa,N0(m,P)){if((v=Xo(P.width,P.height,H.Oa,H.ba))==0){if(m.Aa=0,_=H.Oa,t((R=m)!=null),_!=null){if(0<(X=0>(X=_.Md)?0:100<X?255:255*X/100)){for(te=ve=0;4>te;++te)12>(je=R.pb[te]).lc&&(je.ia=X*KT[0>je.lc?0:je.lc]>>3),ve|=je.ia;ve&&(alert("todo:VP8InitRandom"),R.ia=1)}R.Ga=_.Id,100<R.Ga?R.Ga=100:0>R.Ga&&(R.Ga=0)}(function(re,be){if(re==null)return 0;if(be==null)return tn(re,2,"NULL VP8Io parameter in VP8Decode().");if(!re.cb&&!N0(re,be))return 0;if(t(re.cb),be.ac==null||be.ac(be)){be.ob&&(re.L=0);var _e=M0[re.L];if(re.L==2?(re.yb=0,re.zb=0):(re.yb=be.v-_e>>4,re.zb=be.j-_e>>4,0>re.yb&&(re.yb=0),0>re.zb&&(re.zb=0)),re.Va=be.o+15+_e>>4,re.Hb=be.va+15+_e>>4,re.Hb>re.za&&(re.Hb=re.za),re.Va>re.Ub&&(re.Va=re.Ub),0<re.L){var Ie=re.ed;for(_e=0;4>_e;++_e){var Te;if(re.Qa.Cb){var Me=re.Qa.Lb[_e];re.Qa.Fb||(Me+=Ie.Tb)}else Me=Ie.Tb;for(Te=0;1>=Te;++Te){var Ue=re.gd[_e][Te],Ve=Me;if(Ie.Pc&&(Ve+=Ie.vd[0],Te&&(Ve+=Ie.od[0])),0<(Ve=0>Ve?0:63<Ve?63:Ve)){var We=Ve;0<Ie.wb&&(We=4<Ie.wb?We>>2:We>>1)>9-Ie.wb&&(We=9-Ie.wb),1>We&&(We=1),Ue.dd=We,Ue.tc=2*Ve+We,Ue.ld=40<=Ve?2:15<=Ve?1:0}else Ue.tc=0;Ue.La=Te}}}_e=0}else tn(re,6,"Frame setup failed"),_e=re.a;if(_e=_e==0){if(_e){re.$c=0,0<re.Aa||(re.Ic=YT);t:{_e=re.Ic,Ie=4*(We=re.za);var Nt=32*We,ut=We+1,Mt=0<re.L?We*(0<re.Aa?2:1):0,vt=(re.Aa==2?2:1)*We;if((Ue=Ie+832+(Te=3*(16*_e+M0[re.L])/2*Nt)+(Me=re.Fa!=null&&0<re.Fa.length?re.Kc.c*re.Kc.i:0))!=Ue)_e=0;else{if(Ue>re.Vb){if(re.Vb=0,re.Ec=i(Ue),re.Fc=0,re.Ec==null){_e=tn(re,1,"no memory during frame initialization.");break t}re.Vb=Ue}Ue=re.Ec,Ve=re.Fc,re.Ac=Ue,re.Bc=Ve,Ve+=Ie,re.Gd=s(Nt,Qa),re.Hd=0,re.rb=s(ut+1,Mr),re.sb=1,re.wa=Mt?s(Mt,zt):null,re.Y=0,re.D.Nb=0,re.D.wa=re.wa,re.D.Y=re.Y,0<re.Aa&&(re.D.Y+=We),t(!0),re.oc=Ue,re.pc=Ve,Ve+=832,re.ya=s(vt,bi),re.aa=0,re.D.ya=re.ya,re.D.aa=re.aa,re.Aa==2&&(re.D.aa+=We),re.R=16*We,re.B=8*We,We=(Nt=M0[re.L])*re.R,Nt=Nt/2*re.B,re.sa=Ue,re.ta=Ve+We,re.qa=re.sa,re.ra=re.ta+16*_e*re.R+Nt,re.Ha=re.qa,re.Ia=re.ra+8*_e*re.B+Nt,re.$c=0,Ve+=Te,re.mb=Me?Ue:null,re.nb=Me?Ve:null,t(Ve+Me<=re.Fc+re.Vb),$o(re),a(re.Ac,re.Bc,0,Ie),_e=1}}if(_e){if(be.ka=0,be.y=re.sa,be.O=re.ta,be.f=re.qa,be.N=re.ra,be.ea=re.Ha,be.Vd=re.Ia,be.fa=re.R,be.Rc=re.B,be.F=null,be.J=0,!L2){for(_e=-255;255>=_e;++_e)P2[255+_e]=0>_e?-_e:_e;for(_e=-1020;1020>=_e;++_e)k2[1020+_e]=-128>_e?-128:127<_e?127:_e;for(_e=-112;112>=_e;++_e)C2[112+_e]=-16>_e?-16:15<_e?15:_e;for(_e=-255;510>=_e;++_e)O2[255+_e]=0>_e?0:255<_e?255:_e;L2=1}Gr=A0,Vr=zp,ac=qp,Ki=zi,Du=S0,gs=$p,p2=w,m2=B,g2=we,x2=Be,v2=ie,y2=de,b2=He,w2=gt,_2=Au,N2=Ko,S2=Eu,A2=Tu,Ni[0]=Xp,Ni[1]=vu,Ni[2]=Kp,Ni[3]=Yp,Ni[4]=Zp,Ni[5]=fs,Ni[6]=us,Ni[7]=Jp,Ni[8]=Vl,Ni[9]=Qp,ro[0]=Xs,ro[1]=Hp,ro[2]=Gp,ro[3]=yu,ro[4]=Vp,ro[5]=Wo,ro[6]=bu,xs[0]=Yl,xs[1]=Wp,xs[2]=wu,xs[3]=Ho,xs[4]=_u,xs[5]=em,xs[6]=Nu,_e=1}else _e=0}_e&&(_e=function(Ht,dn){for(Ht.M=0;Ht.M<Ht.Va;++Ht.M){var Rt,yt=Ht.Jc[Ht.M&Ht.Xb],rt=Ht.m,Kr=Ht;for(Rt=0;Rt<Kr.za;++Rt){var Dt=rt,Kt=Kr,Tr=Kt.Ac,On=Kt.Bc+4*Rt,aa=Kt.zc,Rr=Kt.ya[Kt.aa+Rt];if(Kt.Qa.Bb?Rr.$b=fe(Dt,Kt.Pa.jb[0])?2+fe(Dt,Kt.Pa.jb[2]):fe(Dt,Kt.Pa.jb[1]):Rr.$b=0,Kt.kc&&(Rr.Ad=fe(Dt,Kt.Bd)),Rr.Za=!fe(Dt,145)+0,Rr.Za){var Vn=Rr.Ob,ia=0;for(Kt=0;4>Kt;++Kt){var pn,Yt=aa[0+Kt];for(pn=0;4>pn;++pn){Yt=FT[Tr[On+pn]][Yt];for(var sr=M2[fe(Dt,Yt[0])];0<sr;)sr=M2[2*sr+fe(Dt,Yt[sr])];Yt=-sr,Tr[On+pn]=Yt}n(Vn,ia,Tr,On,4),ia+=4,aa[0+Kt]=Yt}}else Yt=fe(Dt,156)?fe(Dt,128)?1:3:fe(Dt,163)?2:0,Rr.Ob[0]=Yt,a(Tr,On,Yt,4),a(aa,0,Yt,4);Rr.Dd=fe(Dt,142)?fe(Dt,114)?fe(Dt,183)?1:3:2:0}if(Kr.m.Ka)return tn(Ht,7,"Premature end-of-partition0 encountered.");for(;Ht.ja<Ht.za;++Ht.ja){if(Kr=yt,Dt=(rt=Ht).rb[rt.sb-1],Tr=rt.rb[rt.sb+rt.ja],Rt=rt.ya[rt.aa+rt.ja],On=rt.kc?Rt.Ad:0)Dt.la=Tr.la=0,Rt.Za||(Dt.Na=Tr.Na=0),Rt.Hc=0,Rt.Gc=0,Rt.ia=0;else{var Br,or;if(Dt=Tr,Tr=Kr,On=rt.Pa.Xc,aa=rt.ya[rt.aa+rt.ja],Rr=rt.pb[aa.$b],Kt=aa.ad,Vn=0,ia=rt.rb[rt.sb-1],Yt=pn=0,a(Kt,Vn,0,384),aa.Za)var Ln=0,Si=On[3];else{sr=i(16);var Yr=Dt.Na+ia.Na;if(Yr=Mu(Tr,On[1],Yr,Rr.Eb,0,sr,0),Dt.Na=ia.Na=(0<Yr)+0,1<Yr)Gr(sr,0,Kt,Vn);else{var ga=sr[0]+3>>3;for(sr=0;256>sr;sr+=16)Kt[Vn+sr]=ga}Ln=1,Si=On[0]}var xr=15&Dt.la,mn=15&ia.la;for(sr=0;4>sr;++sr){var Ca=1&mn;for(ga=or=0;4>ga;++ga)xr=xr>>1|(Ca=(Yr=Mu(Tr,Si,Yr=Ca+(1&xr),Rr.Sc,Ln,Kt,Vn))>Ln)<<7,or=or<<2|(3<Yr?3:1<Yr?2:Kt[Vn+0]!=0),Vn+=16;xr>>=4,mn=mn>>1|Ca<<7,pn=(pn<<8|or)>>>0}for(Si=xr,Ln=mn>>4,Br=0;4>Br;Br+=2){for(or=0,xr=Dt.la>>4+Br,mn=ia.la>>4+Br,sr=0;2>sr;++sr){for(Ca=1&mn,ga=0;2>ga;++ga)Yr=Ca+(1&xr),xr=xr>>1|(Ca=0<(Yr=Mu(Tr,On[2],Yr,Rr.Qc,0,Kt,Vn)))<<3,or=or<<2|(3<Yr?3:1<Yr?2:Kt[Vn+0]!=0),Vn+=16;xr>>=2,mn=mn>>1|Ca<<5}Yt|=or<<4*Br,Si|=xr<<4<<Br,Ln|=(240&mn)<<Br}Dt.la=Si,ia.la=Ln,aa.Hc=pn,aa.Gc=Yt,aa.ia=43690&Yt?0:Rr.ia,On=!(pn|Yt)}if(0<rt.L&&(rt.wa[rt.Y+rt.ja]=rt.gd[Rt.$b][Rt.Za],rt.wa[rt.Y+rt.ja].La|=!On),Kr.Ka)return tn(Ht,7,"Premature end-of-file encountered.")}if($o(Ht),rt=dn,Kr=1,Rt=(yt=Ht).D,Dt=0<yt.L&&yt.M>=yt.zb&&yt.M<=yt.Va,yt.Aa==0)t:{if(Rt.M=yt.M,Rt.uc=Dt,Qs(yt,Rt),Kr=1,Rt=(or=yt.D).Nb,Dt=(Yt=M0[yt.L])*yt.R,Tr=Yt/2*yt.B,sr=16*Rt*yt.R,ga=8*Rt*yt.B,On=yt.sa,aa=yt.ta-Dt+sr,Rr=yt.qa,Kt=yt.ra-Tr+ga,Vn=yt.Ha,ia=yt.Ia-Tr+ga,mn=(xr=or.M)==0,pn=xr>=yt.Va-1,yt.Aa==2&&Qs(yt,or),or.uc)for(Ca=(Yr=yt).D.M,t(Yr.D.uc),or=Yr.yb;or<Yr.Hb;++or){Ln=or,Si=Ca;var sa=(Oa=(Fn=Yr).D).Nb;Br=Fn.R;var Oa=Oa.wa[Oa.Y+Ln],La=Fn.sa,xa=Fn.ta+16*sa*Br+16*Ln,Fa=Oa.dd,Sr=Oa.tc;if(Sr!=0)if(t(3<=Sr),Fn.L==1)0<Ln&&N2(La,xa,Br,Sr+4),Oa.La&&A2(La,xa,Br,Sr),0<Si&&_2(La,xa,Br,Sr+4),Oa.La&&S2(La,xa,Br,Sr);else{var Da=Fn.B,Ai=Fn.qa,Qo=Fn.ra+8*sa*Da+8*Ln,vs=Fn.Ha,Fn=Fn.Ia+8*sa*Da+8*Ln;sa=Oa.ld,0<Ln&&(m2(La,xa,Br,Sr+4,Fa,sa),x2(Ai,Qo,vs,Fn,Da,Sr+4,Fa,sa)),Oa.La&&(y2(La,xa,Br,Sr,Fa,sa),w2(Ai,Qo,vs,Fn,Da,Sr,Fa,sa)),0<Si&&(p2(La,xa,Br,Sr+4,Fa,sa),g2(Ai,Qo,vs,Fn,Da,Sr+4,Fa,sa)),Oa.La&&(v2(La,xa,Br,Sr,Fa,sa),b2(Ai,Qo,vs,Fn,Da,Sr,Fa,sa))}}if(yt.ia&&alert("todo:DitherRow"),rt.put!=null){if(or=16*xr,xr=16*(xr+1),mn?(rt.y=yt.sa,rt.O=yt.ta+sr,rt.f=yt.qa,rt.N=yt.ra+ga,rt.ea=yt.Ha,rt.W=yt.Ia+ga):(or-=Yt,rt.y=On,rt.O=aa,rt.f=Rr,rt.N=Kt,rt.ea=Vn,rt.W=ia),pn||(xr-=Yt),xr>rt.o&&(xr=rt.o),rt.F=null,rt.J=null,yt.Fa!=null&&0<yt.Fa.length&&or<xr&&(rt.J=Cn(yt,rt,or,xr-or),rt.F=yt.mb,rt.F==null&&rt.F.length==0)){Kr=tn(yt,3,"Could not decode alpha data.");break t}or<rt.j&&(Yt=rt.j-or,or=rt.j,t(!(1&Yt)),rt.O+=yt.R*Yt,rt.N+=yt.B*(Yt>>1),rt.W+=yt.B*(Yt>>1),rt.F!=null&&(rt.J+=rt.width*Yt)),or<xr&&(rt.O+=rt.v,rt.N+=rt.v>>1,rt.W+=rt.v>>1,rt.F!=null&&(rt.J+=rt.v),rt.ka=or-rt.j,rt.U=rt.va-rt.v,rt.T=xr-or,Kr=rt.put(rt))}Rt+1!=yt.Ic||pn||(n(yt.sa,yt.ta-Dt,On,aa+16*yt.R,Dt),n(yt.qa,yt.ra-Tr,Rr,Kt+8*yt.B,Tr),n(yt.Ha,yt.Ia-Tr,Vn,ia+8*yt.B,Tr))}if(!Kr)return tn(Ht,6,"Output aborted.")}return 1}(re,be)),be.bc!=null&&be.bc(be),_e&=1}return _e?(re.cb=0,_e):0})(m,P)||(v=m.a)}}else v=m.a}v==0&&H.Oa!=null&&H.Oa.fd&&(v=ma(H.ba))}H=v}q=H!=0?null:11>q?V.f.RGBA.eb:V.f.kb.y}else q=null;return q};var G2=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(j,W){for(var E="",C=0;C<4;C++)E+=String.fromCharCode(j[W++]);return E}function f(j,W){return j[W+0]|j[W+1]<<8}function h(j,W){return(j[W+0]|j[W+1]<<8|j[W+2]<<16)>>>0}function p(j,W){return(j[W+0]|j[W+1]<<8|j[W+2]<<16|j[W+3]<<24)>>>0}new l;var d=[0],x=[0],g=[],y=new l,b=e,T=function(j,W){var E={},C=0,G=!1,Z=0,he=0;if(E.frames=[],!function(N,D){for(var L=0;L<4;L++)if(N[D+L]!="RIFF".charCodeAt(L))return!0;return!1}(j,W)){for(p(j,W+=4),W+=8;W<j.length;){var oe=c(j,W),me=p(j,W+=4);W+=4;var pe=me+(1&me);switch(oe){case"VP8 ":case"VP8L":E.frames[C]===void 0&&(E.frames[C]={}),(Se=E.frames[C]).src_off=G?he:W-8,Se.src_size=Z+me+8,C++,G&&(G=!1,Z=0,he=0);break;case"VP8X":(Se=E.header={}).feature_flags=j[W];var ge=W+4;Se.canvas_width=1+h(j,ge),ge+=3,Se.canvas_height=1+h(j,ge),ge+=3;break;case"ALPH":G=!0,Z=pe+8,he=W-8;break;case"ANIM":(Se=E.header).bgcolor=p(j,W),ge=W+4,Se.loop_count=f(j,ge),ge+=2;break;case"ANMF":var Le,Se;(Se=E.frames[C]={}).offset_x=2*h(j,W),W+=3,Se.offset_y=2*h(j,W),W+=3,Se.width=1+h(j,W),W+=3,Se.height=1+h(j,W),W+=3,Se.duration=h(j,W),W+=3,Le=j[W++],Se.dispose=1&Le,Se.blend=Le>>1&1}oe!="ANMF"&&(W+=pe)}return E}}(b,0);T.response=b,T.rgbaoutput=!0,T.dataurl=!1;var S=T.header?T.header:null,k=T.frames?T.frames:null;if(S){S.loop_counter=S.loop_count,d=[S.canvas_height],x=[S.canvas_width];for(var A=0;A<k.length&&k[A].blend!=0;A++);}var M=k[0],O=y.WebPDecodeRGBA(b,M.src_off,M.src_size,x,d);M.rgba=O,M.imgwidth=x[0],M.imgheight=d[0];for(var I=0;I<x[0]*d[0]*4;I++)g[I]=O[I];return this.width=x,this.height=d,this.data=g,this}(function(e){var t,r,n,a,i,s,o,l,c,f=function(N){return N=N||{},this.isStrokeTransparent=N.isStrokeTransparent||!1,this.strokeOpacity=N.strokeOpacity||1,this.strokeStyle=N.strokeStyle||"#000000",this.fillStyle=N.fillStyle||"#000000",this.isFillTransparent=N.isFillTransparent||!1,this.fillOpacity=N.fillOpacity||1,this.font=N.font||"10px sans-serif",this.textBaseline=N.textBaseline||"alphabetic",this.textAlign=N.textAlign||"left",this.lineWidth=N.lineWidth||1,this.lineJoin=N.lineJoin||"miter",this.lineCap=N.lineCap||"butt",this.path=N.path||[],this.transform=N.transform!==void 0?N.transform.clone():new l,this.globalCompositeOperation=N.globalCompositeOperation||"normal",this.globalAlpha=N.globalAlpha||1,this.clip_path=N.clip_path||[],this.currentPoint=N.currentPoint||new s,this.miterLimit=N.miterLimit||10,this.lastPoint=N.lastPoint||new s,this.lineDashOffset=N.lineDashOffset||0,this.lineDash=N.lineDash||[],this.margin=N.margin||[0,0,0,0],this.prevPageLastElemOffset=N.prevPageLastElemOffset||0,this.ignoreClearRect=typeof N.ignoreClearRect!="boolean"||N.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new h(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,s=this.internal.Point,o=this.internal.Rectangle,l=this.internal.Matrix,c=new f}]);var h=function(N){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var D=N;Object.defineProperty(this,"pdf",{get:function(){return D}});var L=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return L},set:function(ye){L=!!ye}});var F=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return F},set:function(ye){F=!!ye}});var K=0;Object.defineProperty(this,"posX",{get:function(){return K},set:function(ye){isNaN(ye)||(K=ye)}});var ce=0;Object.defineProperty(this,"posY",{get:function(){return ce},set:function(ye){isNaN(ye)||(ce=ye)}}),Object.defineProperty(this,"margin",{get:function(){return c.margin},set:function(ye){var Q;typeof ye=="number"?Q=[ye,ye,ye,ye]:((Q=new Array(4))[0]=ye[0],Q[1]=ye.length>=2?ye[1]:Q[0],Q[2]=ye.length>=3?ye[2]:Q[0],Q[3]=ye.length>=4?ye[3]:Q[1]),c.margin=Q}});var xe=!1;Object.defineProperty(this,"autoPaging",{get:function(){return xe},set:function(ye){xe=ye}});var ee=0;Object.defineProperty(this,"lastBreak",{get:function(){return ee},set:function(ye){ee=ye}});var fe=[];Object.defineProperty(this,"pageBreaks",{get:function(){return fe},set:function(ye){fe=ye}}),Object.defineProperty(this,"ctx",{get:function(){return c},set:function(ye){ye instanceof f&&(c=ye)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(ye){c.path=ye}});var le=[];Object.defineProperty(this,"ctxStack",{get:function(){return le},set:function(ye){le=ye}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(ye){var Q;Q=p(ye),this.ctx.fillStyle=Q.style,this.ctx.isFillTransparent=Q.a===0,this.ctx.fillOpacity=Q.a,this.pdf.setFillColor(Q.r,Q.g,Q.b,{a:Q.a}),this.pdf.setTextColor(Q.r,Q.g,Q.b,{a:Q.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(ye){var Q=p(ye);this.ctx.strokeStyle=Q.style,this.ctx.isStrokeTransparent=Q.a===0,this.ctx.strokeOpacity=Q.a,Q.a===0?this.pdf.setDrawColor(255,255,255):(Q.a,this.pdf.setDrawColor(Q.r,Q.g,Q.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(ye){["butt","round","square"].indexOf(ye)!==-1&&(this.ctx.lineCap=ye,this.pdf.setLineCap(ye))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(ye){isNaN(ye)||(this.ctx.lineWidth=ye,this.pdf.setLineWidth(ye))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(ye){["bevel","round","miter"].indexOf(ye)!==-1&&(this.ctx.lineJoin=ye,this.pdf.setLineJoin(ye))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(ye){isNaN(ye)||(this.ctx.miterLimit=ye,this.pdf.setMiterLimit(ye))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(ye){this.ctx.textBaseline=ye}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(ye){["right","end","center","left","start"].indexOf(ye)!==-1&&(this.ctx.textAlign=ye)}});var ue=null,$e=null;Object.defineProperty(this,"fontFaces",{get:function(){return $e},set:function(ye){ue=null,$e=ye}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(ye){var Q;if(this.ctx.font=ye,(Q=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(ye))!==null){var nt=Q[1];Q[2];var Re=Q[3],ot=Q[4];Q[5];var ze=Q[6],lt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(ot)[2];ot=Math.floor(lt==="px"?parseFloat(ot)*this.pdf.internal.scaleFactor:lt==="em"?parseFloat(ot)*this.pdf.getFontSize():parseFloat(ot)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(ot);var Qe=function(pt){var ht,Qt,$t=[],mt=pt.trim();if(mt==="")return T1;if(mt in O_)return[O_[mt]];for(;mt!=="";){switch(Qt=null,ht=(mt=F_(mt)).charAt(0)){case'"':case"'":Qt=FZ(mt.substring(1),ht);break;default:Qt=DZ(mt)}if(Qt===null||($t.push(Qt[0]),(mt=F_(Qt[1]))!==""&&mt.charAt(0)!==","))return T1;mt=mt.replace(/^,/,"")}return $t}(ze);if(this.fontFaces){var Tt=function(pt,ht){if(ue===null){var Qt=function($t){var mt=[];return Object.keys($t).forEach(function(jt){$t[jt].forEach(function(er){var Pe=null;switch(er){case"bold":Pe={family:jt,weight:"bold"};break;case"italic":Pe={family:jt,style:"italic"};break;case"bolditalic":Pe={family:jt,weight:"bold",style:"italic"};break;case"":case"normal":Pe={family:jt}}Pe!==null&&(Pe.ref={name:jt,style:er},mt.push(Pe))})}),mt}(pt.getFontList());ue=function($t){for(var mt={},jt=0;jt<$t.length;++jt){var er=E1($t[jt]),Pe=er.family,tt=er.stretch,bt=er.style,Xt=er.weight;mt[Pe]=mt[Pe]||{},mt[Pe][tt]=mt[Pe][tt]||{},mt[Pe][tt][bt]=mt[Pe][tt][bt]||{},mt[Pe][tt][bt][Xt]=er}return mt}(Qt.concat(ht))}return ue}(this.pdf,this.fontFaces),ft=Qe.map(function(pt){return{family:pt,stretch:"normal",weight:Re,style:nt}}),Ot=function(pt,ht,Qt){for(var $t=(Qt=Qt||{}).defaultFontFamily||"times",mt=Object.assign({},LZ,Qt.genericFontFamilies||{}),jt=null,er=null,Pe=0;Pe<ht.length;++Pe)if(mt[(jt=E1(ht[Pe])).family]&&(jt.family=mt[jt.family]),pt.hasOwnProperty(jt.family)){er=pt[jt.family];break}if(!(er=er||pt[$t]))throw new Error("Could not find a font-family for the rule '"+L_(jt)+"' and default family '"+$t+"'.");if(er=function(tt,bt){if(bt[tt])return bt[tt];var Xt=qg[tt],wr=Xt<=qg.normal?-1:1,Wt=C_(bt,vT,Xt,wr);if(!Wt)throw new Error("Could not find a matching font-stretch value for "+tt);return Wt}(jt.stretch,er),er=function(tt,bt){if(bt[tt])return bt[tt];for(var Xt=xT[tt],wr=0;wr<Xt.length;++wr)if(bt[Xt[wr]])return bt[Xt[wr]];throw new Error("Could not find a matching font-style for "+tt)}(jt.style,er),!(er=function(tt,bt){if(bt[tt])return bt[tt];if(tt===400&&bt[500])return bt[500];if(tt===500&&bt[400])return bt[400];var Xt=OZ[tt],wr=C_(bt,yT,Xt,tt<400?-1:1);if(!wr)throw new Error("Could not find a matching font-weight for value "+tt);return wr}(jt.weight,er)))throw new Error("Failed to resolve a font for the rule '"+L_(jt)+"'.");return er}(Tt,ft);this.pdf.setFont(Ot.ref.name,Ot.ref.style)}else{var Fe="";(Re==="bold"||parseInt(Re,10)>=700||nt==="bold")&&(Fe="bold"),nt==="italic"&&(Fe+="italic"),Fe.length===0&&(Fe="normal");for(var Xe="",At={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},xt=0;xt<Qe.length;xt++){if(this.pdf.internal.getFont(Qe[xt],Fe,{noFallback:!0,disableWarning:!0})!==void 0){Xe=Qe[xt];break}if(Fe==="bolditalic"&&this.pdf.internal.getFont(Qe[xt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Xe=Qe[xt],Fe="bold";else if(this.pdf.internal.getFont(Qe[xt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Xe=Qe[xt],Fe="normal";break}}if(Xe===""){for(var st=0;st<Qe.length;st++)if(At[Qe[st]]){Xe=At[Qe[st]];break}}Xe=Xe===""?"Times":Xe,this.pdf.setFont(Xe,Fe)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(ye){this.ctx.globalCompositeOperation=ye}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(ye){this.ctx.globalAlpha=ye}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(ye){this.ctx.lineDashOffset=ye,Se.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(ye){this.ctx.lineDash=ye,Se.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(ye){this.ctx.ignoreClearRect=!!ye}})};h.prototype.setLineDash=function(N){this.lineDash=N},h.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},h.prototype.fill=function(){k.call(this,"fill",!1)},h.prototype.stroke=function(){k.call(this,"stroke",!1)},h.prototype.beginPath=function(){this.path=[{type:"begin"}]},h.prototype.moveTo=function(N,D){if(isNaN(N)||isNaN(D))throw vr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var L=this.ctx.transform.applyToPoint(new s(N,D));this.path.push({type:"mt",x:L.x,y:L.y}),this.ctx.lastPoint=new s(N,D)},h.prototype.closePath=function(){var N=new s(0,0),D=0;for(D=this.path.length-1;D!==-1;D--)if(this.path[D].type==="begin"&&fr(this.path[D+1])==="object"&&typeof this.path[D+1].x=="number"){N=new s(this.path[D+1].x,this.path[D+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(N.x,N.y)},h.prototype.lineTo=function(N,D){if(isNaN(N)||isNaN(D))throw vr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var L=this.ctx.transform.applyToPoint(new s(N,D));this.path.push({type:"lt",x:L.x,y:L.y}),this.ctx.lastPoint=new s(L.x,L.y)},h.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),k.call(this,null,!0)},h.prototype.quadraticCurveTo=function(N,D,L,F){if(isNaN(L)||isNaN(F)||isNaN(N)||isNaN(D))throw vr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var K=this.ctx.transform.applyToPoint(new s(L,F)),ce=this.ctx.transform.applyToPoint(new s(N,D));this.path.push({type:"qct",x1:ce.x,y1:ce.y,x:K.x,y:K.y}),this.ctx.lastPoint=new s(K.x,K.y)},h.prototype.bezierCurveTo=function(N,D,L,F,K,ce){if(isNaN(K)||isNaN(ce)||isNaN(N)||isNaN(D)||isNaN(L)||isNaN(F))throw vr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var xe=this.ctx.transform.applyToPoint(new s(K,ce)),ee=this.ctx.transform.applyToPoint(new s(N,D)),fe=this.ctx.transform.applyToPoint(new s(L,F));this.path.push({type:"bct",x1:ee.x,y1:ee.y,x2:fe.x,y2:fe.y,x:xe.x,y:xe.y}),this.ctx.lastPoint=new s(xe.x,xe.y)},h.prototype.arc=function(N,D,L,F,K,ce){if(isNaN(N)||isNaN(D)||isNaN(L)||isNaN(F)||isNaN(K))throw vr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ce=!!ce,!this.ctx.transform.isIdentity){var xe=this.ctx.transform.applyToPoint(new s(N,D));N=xe.x,D=xe.y;var ee=this.ctx.transform.applyToPoint(new s(0,L)),fe=this.ctx.transform.applyToPoint(new s(0,0));L=Math.sqrt(Math.pow(ee.x-fe.x,2)+Math.pow(ee.y-fe.y,2))}Math.abs(K-F)>=2*Math.PI&&(F=0,K=2*Math.PI),this.path.push({type:"arc",x:N,y:D,radius:L,startAngle:F,endAngle:K,counterclockwise:ce})},h.prototype.arcTo=function(N,D,L,F,K){throw new Error("arcTo not implemented.")},h.prototype.rect=function(N,D,L,F){if(isNaN(N)||isNaN(D)||isNaN(L)||isNaN(F))throw vr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(N,D),this.lineTo(N+L,D),this.lineTo(N+L,D+F),this.lineTo(N,D+F),this.lineTo(N,D),this.lineTo(N+L,D),this.lineTo(N,D)},h.prototype.fillRect=function(N,D,L,F){if(isNaN(N)||isNaN(D)||isNaN(L)||isNaN(F))throw vr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!d.call(this)){var K={};this.lineCap!=="butt"&&(K.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(K.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(N,D,L,F),this.fill(),K.hasOwnProperty("lineCap")&&(this.lineCap=K.lineCap),K.hasOwnProperty("lineJoin")&&(this.lineJoin=K.lineJoin)}},h.prototype.strokeRect=function(N,D,L,F){if(isNaN(N)||isNaN(D)||isNaN(L)||isNaN(F))throw vr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");x.call(this)||(this.beginPath(),this.rect(N,D,L,F),this.stroke())},h.prototype.clearRect=function(N,D,L,F){if(isNaN(N)||isNaN(D)||isNaN(L)||isNaN(F))throw vr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(N,D,L,F))},h.prototype.save=function(N){N=typeof N!="boolean"||N;for(var D=this.pdf.internal.getCurrentPageInfo().pageNumber,L=0;L<this.pdf.internal.getNumberOfPages();L++)this.pdf.setPage(L+1),this.pdf.internal.out("q");if(this.pdf.setPage(D),N){this.ctx.fontSize=this.pdf.internal.getFontSize();var F=new f(this.ctx);this.ctxStack.push(this.ctx),this.ctx=F}},h.prototype.restore=function(N){N=typeof N!="boolean"||N;for(var D=this.pdf.internal.getCurrentPageInfo().pageNumber,L=0;L<this.pdf.internal.getNumberOfPages();L++)this.pdf.setPage(L+1),this.pdf.internal.out("Q");this.pdf.setPage(D),N&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},h.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var p=function(N){var D,L,F,K;if(N.isCanvasGradient===!0&&(N=N.getColor()),!N)return{r:0,g:0,b:0,a:0,style:N};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(N))D=0,L=0,F=0,K=0;else{var ce=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(N);if(ce!==null)D=parseInt(ce[1]),L=parseInt(ce[2]),F=parseInt(ce[3]),K=1;else if((ce=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(N))!==null)D=parseInt(ce[1]),L=parseInt(ce[2]),F=parseInt(ce[3]),K=parseFloat(ce[4]);else{if(K=1,typeof N=="string"&&N.charAt(0)!=="#"){var xe=new uT(N);N=xe.ok?xe.toHex():"#000000"}N.length===4?(D=N.substring(1,2),D+=D,L=N.substring(2,3),L+=L,F=N.substring(3,4),F+=F):(D=N.substring(1,3),L=N.substring(3,5),F=N.substring(5,7)),D=parseInt(D,16),L=parseInt(L,16),F=parseInt(F,16)}}return{r:D,g:L,b:F,a:K,style:N}},d=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},x=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};h.prototype.fillText=function(N,D,L,F){if(isNaN(D)||isNaN(L)||typeof N!="string")throw vr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(F=isNaN(F)?void 0:F,!d.call(this)){var K=pe(this.ctx.transform.rotation),ce=this.ctx.transform.scaleX;C.call(this,{text:N,x:D,y:L,scale:ce,angle:K,align:this.textAlign,maxWidth:F})}},h.prototype.strokeText=function(N,D,L,F){if(isNaN(D)||isNaN(L)||typeof N!="string")throw vr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!x.call(this)){F=isNaN(F)?void 0:F;var K=pe(this.ctx.transform.rotation),ce=this.ctx.transform.scaleX;C.call(this,{text:N,x:D,y:L,scale:ce,renderingMode:"stroke",angle:K,align:this.textAlign,maxWidth:F})}},h.prototype.measureText=function(N){if(typeof N!="string")throw vr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var D=this.pdf,L=this.pdf.internal.scaleFactor,F=D.internal.getFontSize(),K=D.getStringUnitWidth(N)*F/D.internal.scaleFactor;return new function(ce){var xe=(ce=ce||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return xe}}),this}({width:K*=Math.round(96*L/72*1e4)/1e4})},h.prototype.scale=function(N,D){if(isNaN(N)||isNaN(D))throw vr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var L=new l(N,0,0,D,0,0);this.ctx.transform=this.ctx.transform.multiply(L)},h.prototype.rotate=function(N){if(isNaN(N))throw vr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var D=new l(Math.cos(N),Math.sin(N),-Math.sin(N),Math.cos(N),0,0);this.ctx.transform=this.ctx.transform.multiply(D)},h.prototype.translate=function(N,D){if(isNaN(N)||isNaN(D))throw vr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var L=new l(1,0,0,1,N,D);this.ctx.transform=this.ctx.transform.multiply(L)},h.prototype.transform=function(N,D,L,F,K,ce){if(isNaN(N)||isNaN(D)||isNaN(L)||isNaN(F)||isNaN(K)||isNaN(ce))throw vr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var xe=new l(N,D,L,F,K,ce);this.ctx.transform=this.ctx.transform.multiply(xe)},h.prototype.setTransform=function(N,D,L,F,K,ce){N=isNaN(N)?1:N,D=isNaN(D)?0:D,L=isNaN(L)?0:L,F=isNaN(F)?1:F,K=isNaN(K)?0:K,ce=isNaN(ce)?0:ce,this.ctx.transform=new l(N,D,L,F,K,ce)};var g=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};h.prototype.drawImage=function(N,D,L,F,K,ce,xe,ee,fe){var le=this.pdf.getImageProperties(N),ue=1,$e=1,ye=1,Q=1;F!==void 0&&ee!==void 0&&(ye=ee/F,Q=fe/K,ue=le.width/F*ee/F,$e=le.height/K*fe/K),ce===void 0&&(ce=D,xe=L,D=0,L=0),F!==void 0&&ee===void 0&&(ee=F,fe=K),F===void 0&&ee===void 0&&(ee=le.width,fe=le.height);for(var nt,Re=this.ctx.transform.decompose(),ot=pe(Re.rotate.shx),ze=new l,lt=(ze=(ze=(ze=ze.multiply(Re.translate)).multiply(Re.skew)).multiply(Re.scale)).applyToRectangle(new o(ce-D*ye,xe-L*Q,F*ue,K*$e)),Qe=y.call(this,lt),Tt=[],ft=0;ft<Qe.length;ft+=1)Tt.indexOf(Qe[ft])===-1&&Tt.push(Qe[ft]);if(S(Tt),this.autoPaging)for(var Ot=Tt[0],Fe=Tt[Tt.length-1],Xe=Ot;Xe<Fe+1;Xe++){this.pdf.setPage(Xe);var At=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],xt=Xe===1?this.posY+this.margin[0]:this.margin[0],st=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],pt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],ht=Xe===1?0:st+(Xe-2)*pt;if(this.ctx.clip_path.length!==0){var Qt=this.path;nt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=T(nt,this.posX+this.margin[3],-ht+xt+this.ctx.prevPageLastElemOffset),A.call(this,"fill",!0),this.path=Qt}var $t=JSON.parse(JSON.stringify(lt));$t=T([$t],this.posX+this.margin[3],-ht+xt+this.ctx.prevPageLastElemOffset)[0];var mt=(Xe>Ot||Xe<Fe)&&g.call(this);mt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],At,pt,null).clip().discardPath()),this.pdf.addImage(N,"JPEG",$t.x,$t.y,$t.w,$t.h,null,null,ot),mt&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(N,"JPEG",lt.x,lt.y,lt.w,lt.h,null,null,ot)};var y=function(N,D,L){var F=[];D=D||this.pdf.internal.pageSize.width,L=L||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var K=this.posY+this.ctx.prevPageLastElemOffset;switch(N.type){default:case"mt":case"lt":F.push(Math.floor((N.y+K)/L)+1);break;case"arc":F.push(Math.floor((N.y+K-N.radius)/L)+1),F.push(Math.floor((N.y+K+N.radius)/L)+1);break;case"qct":var ce=ge(this.ctx.lastPoint.x,this.ctx.lastPoint.y,N.x1,N.y1,N.x,N.y);F.push(Math.floor((ce.y+K)/L)+1),F.push(Math.floor((ce.y+ce.h+K)/L)+1);break;case"bct":var xe=Le(this.ctx.lastPoint.x,this.ctx.lastPoint.y,N.x1,N.y1,N.x2,N.y2,N.x,N.y);F.push(Math.floor((xe.y+K)/L)+1),F.push(Math.floor((xe.y+xe.h+K)/L)+1);break;case"rect":F.push(Math.floor((N.y+K)/L)+1),F.push(Math.floor((N.y+N.h+K)/L)+1)}for(var ee=0;ee<F.length;ee+=1)for(;this.pdf.internal.getNumberOfPages()<F[ee];)b.call(this);return F},b=function(){var N=this.fillStyle,D=this.strokeStyle,L=this.font,F=this.lineCap,K=this.lineWidth,ce=this.lineJoin;this.pdf.addPage(),this.fillStyle=N,this.strokeStyle=D,this.font=L,this.lineCap=F,this.lineWidth=K,this.lineJoin=ce},T=function(N,D,L){for(var F=0;F<N.length;F++)switch(N[F].type){case"bct":N[F].x2+=D,N[F].y2+=L;case"qct":N[F].x1+=D,N[F].y1+=L;default:N[F].x+=D,N[F].y+=L}return N},S=function(N){return N.sort(function(D,L){return D-L})},k=function(N,D){for(var L,F,K=this.fillStyle,ce=this.strokeStyle,xe=this.lineCap,ee=this.lineWidth,fe=Math.abs(ee*this.ctx.transform.scaleX),le=this.lineJoin,ue=JSON.parse(JSON.stringify(this.path)),$e=JSON.parse(JSON.stringify(this.path)),ye=[],Q=0;Q<$e.length;Q++)if($e[Q].x!==void 0)for(var nt=y.call(this,$e[Q]),Re=0;Re<nt.length;Re+=1)ye.indexOf(nt[Re])===-1&&ye.push(nt[Re]);for(var ot=0;ot<ye.length;ot++)for(;this.pdf.internal.getNumberOfPages()<ye[ot];)b.call(this);if(S(ye),this.autoPaging)for(var ze=ye[0],lt=ye[ye.length-1],Qe=ze;Qe<lt+1;Qe++){this.pdf.setPage(Qe),this.fillStyle=K,this.strokeStyle=ce,this.lineCap=xe,this.lineWidth=fe,this.lineJoin=le;var Tt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ft=Qe===1?this.posY+this.margin[0]:this.margin[0],Ot=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Fe=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Xe=Qe===1?0:Ot+(Qe-2)*Fe;if(this.ctx.clip_path.length!==0){var At=this.path;L=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=T(L,this.posX+this.margin[3],-Xe+ft+this.ctx.prevPageLastElemOffset),A.call(this,N,!0),this.path=At}if(F=JSON.parse(JSON.stringify(ue)),this.path=T(F,this.posX+this.margin[3],-Xe+ft+this.ctx.prevPageLastElemOffset),D===!1||Qe===0){var xt=(Qe>ze||Qe<lt)&&g.call(this);xt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Tt,Fe,null).clip().discardPath()),A.call(this,N,D),xt&&this.pdf.restoreGraphicsState()}this.lineWidth=ee}else this.lineWidth=fe,A.call(this,N,D),this.lineWidth=ee;this.path=ue},A=function(N,D){if((N!=="stroke"||D||!x.call(this))&&(N==="stroke"||D||!d.call(this))){for(var L,F,K=[],ce=this.path,xe=0;xe<ce.length;xe++){var ee=ce[xe];switch(ee.type){case"begin":K.push({begin:!0});break;case"close":K.push({close:!0});break;case"mt":K.push({start:ee,deltas:[],abs:[]});break;case"lt":var fe=K.length;if(ce[xe-1]&&!isNaN(ce[xe-1].x)&&(L=[ee.x-ce[xe-1].x,ee.y-ce[xe-1].y],fe>0)){for(;fe>=0;fe--)if(K[fe-1].close!==!0&&K[fe-1].begin!==!0){K[fe-1].deltas.push(L),K[fe-1].abs.push(ee);break}}break;case"bct":L=[ee.x1-ce[xe-1].x,ee.y1-ce[xe-1].y,ee.x2-ce[xe-1].x,ee.y2-ce[xe-1].y,ee.x-ce[xe-1].x,ee.y-ce[xe-1].y],K[K.length-1].deltas.push(L);break;case"qct":var le=ce[xe-1].x+2/3*(ee.x1-ce[xe-1].x),ue=ce[xe-1].y+2/3*(ee.y1-ce[xe-1].y),$e=ee.x+2/3*(ee.x1-ee.x),ye=ee.y+2/3*(ee.y1-ee.y),Q=ee.x,nt=ee.y;L=[le-ce[xe-1].x,ue-ce[xe-1].y,$e-ce[xe-1].x,ye-ce[xe-1].y,Q-ce[xe-1].x,nt-ce[xe-1].y],K[K.length-1].deltas.push(L);break;case"arc":K.push({deltas:[],abs:[],arc:!0}),Array.isArray(K[K.length-1].abs)&&K[K.length-1].abs.push(ee)}}F=D?null:N==="stroke"?"stroke":"fill";for(var Re=!1,ot=0;ot<K.length;ot++)if(K[ot].arc)for(var ze=K[ot].abs,lt=0;lt<ze.length;lt++){var Qe=ze[lt];Qe.type==="arc"?I.call(this,Qe.x,Qe.y,Qe.radius,Qe.startAngle,Qe.endAngle,Qe.counterclockwise,void 0,D,!Re):G.call(this,Qe.x,Qe.y),Re=!0}else if(K[ot].close===!0)this.pdf.internal.out("h"),Re=!1;else if(K[ot].begin!==!0){var Tt=K[ot].start.x,ft=K[ot].start.y;Z.call(this,K[ot].deltas,Tt,ft),Re=!0}F&&j.call(this,F),D&&W.call(this)}},M=function(N){var D=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,L=D*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return N-L;case"top":return N+D-L;case"hanging":return N+D-2*L;case"middle":return N+D/2-L;default:return N}},O=function(N){return N+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};h.prototype.createLinearGradient=function(){var N=function(){};return N.colorStops=[],N.addColorStop=function(D,L){this.colorStops.push([D,L])},N.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},N.isCanvasGradient=!0,N},h.prototype.createPattern=function(){return this.createLinearGradient()},h.prototype.createRadialGradient=function(){return this.createLinearGradient()};var I=function(N,D,L,F,K,ce,xe,ee,fe){for(var le=oe.call(this,L,F,K,ce),ue=0;ue<le.length;ue++){var $e=le[ue];ue===0&&(fe?E.call(this,$e.x1+N,$e.y1+D):G.call(this,$e.x1+N,$e.y1+D)),he.call(this,N,D,$e.x2,$e.y2,$e.x3,$e.y3,$e.x4,$e.y4)}ee?W.call(this):j.call(this,xe)},j=function(N){switch(N){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},W=function(){this.pdf.clip(),this.pdf.discardPath()},E=function(N,D){this.pdf.internal.out(r(N)+" "+n(D)+" m")},C=function(N){var D;switch(N.align){case"right":case"end":D="right";break;case"center":D="center";break;default:D="left"}var L=this.pdf.getTextDimensions(N.text),F=M.call(this,N.y),K=O.call(this,F)-L.h,ce=this.ctx.transform.applyToPoint(new s(N.x,F)),xe=this.ctx.transform.decompose(),ee=new l;ee=(ee=(ee=ee.multiply(xe.translate)).multiply(xe.skew)).multiply(xe.scale);for(var fe,le,ue,$e=this.ctx.transform.applyToRectangle(new o(N.x,F,L.w,L.h)),ye=ee.applyToRectangle(new o(N.x,K,L.w,L.h)),Q=y.call(this,ye),nt=[],Re=0;Re<Q.length;Re+=1)nt.indexOf(Q[Re])===-1&&nt.push(Q[Re]);if(S(nt),this.autoPaging)for(var ot=nt[0],ze=nt[nt.length-1],lt=ot;lt<ze+1;lt++){this.pdf.setPage(lt);var Qe=lt===1?this.posY+this.margin[0]:this.margin[0],Tt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ft=this.pdf.internal.pageSize.height-this.margin[2],Ot=ft-this.margin[0],Fe=this.pdf.internal.pageSize.width-this.margin[1],Xe=Fe-this.margin[3],At=lt===1?0:Tt+(lt-2)*Ot;if(this.ctx.clip_path.length!==0){var xt=this.path;fe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=T(fe,this.posX+this.margin[3],-1*At+Qe),A.call(this,"fill",!0),this.path=xt}var st=T([JSON.parse(JSON.stringify(ye))],this.posX+this.margin[3],-At+Qe+this.ctx.prevPageLastElemOffset)[0];N.scale>=.01&&(le=this.pdf.internal.getFontSize(),this.pdf.setFontSize(le*N.scale),ue=this.lineWidth,this.lineWidth=ue*N.scale);var pt=this.autoPaging!=="text";if(pt||st.y+st.h<=ft){if(pt||st.y>=Qe&&st.x<=Fe){var ht=pt?N.text:this.pdf.splitTextToSize(N.text,N.maxWidth||Fe-st.x)[0],Qt=T([JSON.parse(JSON.stringify($e))],this.posX+this.margin[3],-At+Qe+this.ctx.prevPageLastElemOffset)[0],$t=pt&&(lt>ot||lt<ze)&&g.call(this);$t&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Xe,Ot,null).clip().discardPath()),this.pdf.text(ht,Qt.x,Qt.y,{angle:N.angle,align:D,renderingMode:N.renderingMode}),$t&&this.pdf.restoreGraphicsState()}}else st.y<ft&&(this.ctx.prevPageLastElemOffset+=ft-st.y);N.scale>=.01&&(this.pdf.setFontSize(le),this.lineWidth=ue)}else N.scale>=.01&&(le=this.pdf.internal.getFontSize(),this.pdf.setFontSize(le*N.scale),ue=this.lineWidth,this.lineWidth=ue*N.scale),this.pdf.text(N.text,ce.x+this.posX,ce.y+this.posY,{angle:N.angle,align:D,renderingMode:N.renderingMode,maxWidth:N.maxWidth}),N.scale>=.01&&(this.pdf.setFontSize(le),this.lineWidth=ue)},G=function(N,D,L,F){L=L||0,F=F||0,this.pdf.internal.out(r(N+L)+" "+n(D+F)+" l")},Z=function(N,D,L){return this.pdf.lines(N,D,L,null,null)},he=function(N,D,L,F,K,ce,xe,ee){this.pdf.internal.out([t(a(L+N)),t(i(F+D)),t(a(K+N)),t(i(ce+D)),t(a(xe+N)),t(i(ee+D)),"c"].join(" "))},oe=function(N,D,L,F){for(var K=2*Math.PI,ce=Math.PI/2;D>L;)D-=K;var xe=Math.abs(L-D);xe<K&&F&&(xe=K-xe);for(var ee=[],fe=F?-1:1,le=D;xe>1e-5;){var ue=le+fe*Math.min(xe,ce);ee.push(me.call(this,N,le,ue)),xe-=Math.abs(ue-le),le=ue}return ee},me=function(N,D,L){var F=(L-D)/2,K=N*Math.cos(F),ce=N*Math.sin(F),xe=K,ee=-ce,fe=xe*xe+ee*ee,le=fe+xe*K+ee*ce,ue=4/3*(Math.sqrt(2*fe*le)-le)/(xe*ce-ee*K),$e=xe-ue*ee,ye=ee+ue*xe,Q=$e,nt=-ye,Re=F+D,ot=Math.cos(Re),ze=Math.sin(Re);return{x1:N*Math.cos(D),y1:N*Math.sin(D),x2:$e*ot-ye*ze,y2:$e*ze+ye*ot,x3:Q*ot-nt*ze,y3:Q*ze+nt*ot,x4:N*Math.cos(L),y4:N*Math.sin(L)}},pe=function(N){return 180*N/Math.PI},ge=function(N,D,L,F,K,ce){var xe=N+.5*(L-N),ee=D+.5*(F-D),fe=K+.5*(L-K),le=ce+.5*(F-ce),ue=Math.min(N,K,xe,fe),$e=Math.max(N,K,xe,fe),ye=Math.min(D,ce,ee,le),Q=Math.max(D,ce,ee,le);return new o(ue,ye,$e-ue,Q-ye)},Le=function(N,D,L,F,K,ce,xe,ee){var fe,le,ue,$e,ye,Q,nt,Re,ot,ze,lt,Qe,Tt,ft,Ot=L-N,Fe=F-D,Xe=K-L,At=ce-F,xt=xe-K,st=ee-ce;for(le=0;le<41;le++)ot=(nt=(ue=N+(fe=le/40)*Ot)+fe*((ye=L+fe*Xe)-ue))+fe*(ye+fe*(K+fe*xt-ye)-nt),ze=(Re=($e=D+fe*Fe)+fe*((Q=F+fe*At)-$e))+fe*(Q+fe*(ce+fe*st-Q)-Re),le==0?(lt=ot,Qe=ze,Tt=ot,ft=ze):(lt=Math.min(lt,ot),Qe=Math.min(Qe,ze),Tt=Math.max(Tt,ot),ft=Math.max(ft,ze));return new o(Math.round(lt),Math.round(Qe),Math.round(Tt-lt),Math.round(ft-Qe))},Se=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var N,D,L=(N=this.ctx.lineDash,D=this.ctx.lineDashOffset,JSON.stringify({lineDash:N,lineDashOffset:D}));this.prevLineDash!==L&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=L)}}})(St.API),function(e){var t=function(s){var o,l,c,f,h,p,d,x,g,y;for(l=[],c=0,f=(s+=o="\0\0\0\0".slice(s.length%4||4)).length;f>c;c+=4)(h=(s.charCodeAt(c)<<24)+(s.charCodeAt(c+1)<<16)+(s.charCodeAt(c+2)<<8)+s.charCodeAt(c+3))!==0?(p=(h=((h=((h=((h=(h-(y=h%85))/85)-(g=h%85))/85)-(x=h%85))/85)-(d=h%85))/85)%85,l.push(p+33,d+33,x+33,g+33,y+33)):l.push(122);return function(b,T){for(var S=T;S>0;S--)b.pop()}(l,o.length),String.fromCharCode.apply(String,l)+"~>"},r=function(s){var o,l,c,f,h,p=String,d="length",x=255,g="charCodeAt",y="slice",b="replace";for(s[y](-2),s=s[y](0,-2)[b](/\s/g,"")[b]("z","!!!!!"),c=[],f=0,h=(s+=o="uuuuu"[y](s[d]%5||5))[d];h>f;f+=5)l=52200625*(s[g](f)-33)+614125*(s[g](f+1)-33)+7225*(s[g](f+2)-33)+85*(s[g](f+3)-33)+(s[g](f+4)-33),c.push(x&l>>24,x&l>>16,x&l>>8,x&l);return function(T,S){for(var k=S;k>0;k--)T.pop()}(c,o[d]),p.fromCharCode.apply(p,c)},n=function(s){return s.split("").map(function(o){return("0"+o.charCodeAt().toString(16)).slice(-2)}).join("")+">"},a=function(s){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),o.test(s)===!1)return"";for(var l="",c=0;c<s.length;c+=2)l+=String.fromCharCode("0x"+(s[c]+s[c+1]));return l},i=function(s){for(var o=new Uint8Array(s.length),l=s.length;l--;)o[l]=s.charCodeAt(l);return(o=kg(o)).reduce(function(c,f){return c+String.fromCharCode(f)},"")};e.processDataByFilters=function(s,o){var l=0,c=s||"",f=[];for(typeof(o=o||[])=="string"&&(o=[o]),l=0;l<o.length;l+=1)switch(o[l]){case"ASCII85Decode":case"/ASCII85Decode":c=r(c),f.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=t(c),f.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=a(c),f.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=n(c),f.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=i(c),f.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[l]+'" is not implemented')}return{data:c,reverseChain:f.reverse().join(" ")}}}(St.API),function(e){e.loadFile=function(t,r,n){return function(a,i,s){i=i!==!1,s=typeof s=="function"?s:function(){};var o=void 0;try{o=function(l,c,f){var h=new XMLHttpRequest,p=0,d=function(x){var g=x.length,y=[],b=String.fromCharCode;for(p=0;p<g;p+=1)y.push(b(255&x.charCodeAt(p)));return y.join("")};if(h.open("GET",l,!c),h.overrideMimeType("text/plain; charset=x-user-defined"),c===!1&&(h.onload=function(){h.status===200?f(d(this.responseText)):f(void 0)}),h.send(null),c&&h.status===200)return d(h.responseText)}(a,i,s)}catch{}return o}(t,r,n)},e.loadImageFile=e.loadFile}(St.API),function(e){function t(){return(Ct.html2canvas?Promise.resolve(Ct.html2canvas):ym(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function r(){return(Ct.DOMPurify?Promise.resolve(Ct.DOMPurify):ym(()=>import("./purify.es-BFmuJLeH.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var n=function(o){var l=fr(o);return l==="undefined"?"undefined":l==="string"||o instanceof String?"string":l==="number"||o instanceof Number?"number":l==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":l==="object"?"object":"unknown"},a=function(o,l){var c=document.createElement(o);for(var f in l.className&&(c.className=l.className),l.innerHTML&&l.dompurify&&(c.innerHTML=l.dompurify.sanitize(l.innerHTML)),l.style)c.style[f]=l.style[f];return c},i=function o(l,c){for(var f=l.nodeType===3?document.createTextNode(l.nodeValue):l.cloneNode(!1),h=l.firstChild;h;h=h.nextSibling)c!==!0&&h.nodeType===1&&h.nodeName==="SCRIPT"||f.appendChild(o(h,c));return l.nodeType===1&&(l.nodeName==="CANVAS"?(f.width=l.width,f.height=l.height,f.getContext("2d").drawImage(l,0,0)):l.nodeName!=="TEXTAREA"&&l.nodeName!=="SELECT"||(f.value=l.value),f.addEventListener("load",function(){f.scrollTop=l.scrollTop,f.scrollLeft=l.scrollLeft},!0)),f},s=function o(l){var c=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),f=o.convert(Promise.resolve(),c);return(f=f.setProgress(1,o,1,[o])).set(l)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(o,l){return o.__proto__=l||s.prototype,o},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(o,l){return this.then(function(){switch(l=l||function(c){switch(n(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(o),l){case"string":return this.then(r).then(function(c){return this.set({src:a("div",{innerHTML:o,dompurify:c})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},s.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},l=i(this.prop.src,this.opt.html2canvas.javascriptEnabled);l.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(l),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(l){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,l(this.prop.container,c)}).then(function(l){(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(l){var c=this.opt.jsPDF,f=this.opt.fontFaces,h=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,p=Object.assign({async:!0,allowTaint:!0,scale:h,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete p.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=f,f)for(var d=0;d<f.length;++d){var x=f[d],g=x.src.find(function(y){return y.format==="truetype"});g&&c.addFont(g.url,x.ref.name,x.ref.style)}return p.windowHeight=p.windowHeight||0,p.windowHeight=p.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):p.windowHeight,c.context2d.save(!0),l(this.prop.container,p)}).then(function(l){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(o,l,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(o,l):this.outputPdf(o,l)},s.prototype.outputPdf=function(o,l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,l)})},s.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},s.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(o){if(n(o)!=="object")return this;var l=Object.keys(o||{}).map(function(c){if(c in s.template.prop)return function(){this.prop[c]=o[c]};switch(c){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[c]=o[c]}}},this);return this.then(function(){return this.thenList(l)})},s.prototype.get=function(o,l){return this.then(function(){var c=o in s.template.prop?this.prop[o]:this.opt[o];return l?l(c):c})},s.prototype.setMargin=function(o){return this.then(function(){switch(n(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},s.prototype.setPageSize=function(o){function l(c,f){return Math.floor(c*f/72*96)}return this.then(function(){(o=o||St.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:l(o.inner.width,o.k),height:l(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},s.prototype.setProgress=function(o,l,c,f){return o!=null&&(this.progress.val=o),l!=null&&(this.progress.state=l),c!=null&&(this.progress.n=c),f!=null&&(this.progress.stack=f),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(o,l,c,f){return this.setProgress(o?this.progress.val+o:null,l||null,c?this.progress.n+c:null,f?this.progress.stack.concat(f):null)},s.prototype.then=function(o,l){var c=this;return this.thenCore(o,l,function(f,h){return c.updateProgress(null,null,1,[f]),Promise.prototype.then.call(this,function(p){return c.updateProgress(null,f),p}).then(f,h).then(function(p){return c.updateProgress(1),p})})},s.prototype.thenCore=function(o,l,c){c=c||Promise.prototype.then;var f=this;o&&(o=o.bind(f)),l&&(l=l.bind(f));var h=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?f:s.convert(Object.assign({},f),Promise.prototype),p=c.call(h,o,l);return s.convert(p,f.__proto__)},s.prototype.thenExternal=function(o,l){return Promise.prototype.then.call(this,o,l)},s.prototype.thenList=function(o){var l=this;return o.forEach(function(c){l=l.thenCore(c)}),l},s.prototype.catch=function(o){o&&(o=o.bind(this));var l=Promise.prototype.catch.call(this,o);return s.convert(l,this)},s.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},s.prototype.error=function(o){return this.then(function(){throw new Error(o)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,St.getPageSize=function(o,l,c){if(fr(o)==="object"){var f=o;o=f.orientation,l=f.unit||l,c=f.format||c}l=l||"mm",c=c||"a4",o=(""+(o||"P")).toLowerCase();var h,p=(""+c).toLowerCase(),d={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(l){case"pt":h=1;break;case"mm":h=72/25.4;break;case"cm":h=72/2.54;break;case"in":h=72;break;case"px":h=.75;break;case"pc":case"em":h=12;break;case"ex":h=6;break;default:throw"Invalid unit: "+l}var x,g=0,y=0;if(d.hasOwnProperty(p))g=d[p][1]/h,y=d[p][0]/h;else try{g=c[1],y=c[0]}catch{throw new Error("Invalid format: "+c)}if(o==="p"||o==="portrait")o="p",y>g&&(x=y,y=g,g=x);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",g>y&&(x=y,y=g,g=x)}return{width:y,height:g,unit:l,k:h,orientation:o}},e.html=function(o,l){(l=l||{}).callback=l.callback||function(){},l.html2canvas=l.html2canvas||{},l.html2canvas.canvas=l.html2canvas.canvas||this.canvas,l.jsPDF=l.jsPDF||this,l.fontFaces=l.fontFaces?l.fontFaces.map(E1):null;var c=new s(l);return l.worker?c:c.from(o).doCallback()}}(St.API),St.API.addJS=function(e){return I_=e,this.internal.events.subscribe("postPutResources",function(){wh=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(wh+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),D_=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+I_+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){wh!==void 0&&D_!==void 0&&this.internal.out("/Names <</JavaScript "+wh+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=r.outline.render().split(/\r\n/),i=0;i<a.length;i++){var s=a[i],o=n.exec(s);if(o!=null){var l=o[1];r.internal.newObjectDeferredBegin(l,!1)}r.internal.write(s)}if(this.outline.createNamedDestinations){var c=this.internal.pages.length,f=[];for(i=0;i<c;i++){var h=r.internal.newObject();f.push(h);var p=r.internal.getPageInfo(i+1);r.internal.write("<< /D["+p.objId+" 0 R /XYZ null null null]>> endobj")}var d=r.internal.newObject();for(r.internal.write("<< /Names [ "),i=0;i<f.length;i++)r.internal.write("(page_"+(i+1)+")"+f[i]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+d+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,a,i){var s={title:a,options:i,children:[]};return n==null&&(n=this.root),n.children.push(s),s},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var a=0;a<n.children.length;a++)this.genIds_r(n.children[a])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<n.children.length;i++){var s=n.children[i];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(n)),i>0&&this.line("/Prev "+this.makeRef(n.children[i-1])),i<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[i+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var o=this.count=this.count_r({count:0},s);if(o>0&&this.line("/Count "+o),s.options&&s.options.pageNumber){var l=r.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+l.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var c=0;c<n.children.length;c++)this.renderItems(n.children[c])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,a){for(var i=0;i<a.children.length;i++)n.count++,this.count_r(n,a.children[i]);return n.count}}])}(St.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,a,i,s,o){var l,c=this.decode.DCT_DECODE,f=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=s||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,l=function(h){for(var p,d=256*h.charCodeAt(4)+h.charCodeAt(5),x=h.length,g={width:0,height:0,numcomponents:1},y=4;y<x;y+=2){if(y+=d,t.indexOf(h.charCodeAt(y+1))!==-1){p=256*h.charCodeAt(y+5)+h.charCodeAt(y+6),g={width:256*h.charCodeAt(y+7)+h.charCodeAt(y+8),height:p,numcomponents:h.charCodeAt(y+9)};break}d=256*h.charCodeAt(y+2)+h.charCodeAt(y+3)}return g}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),l.numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}f={data:r,width:l.width,height:l.height,colorSpace:o,bitsPerComponent:8,filter:c,index:n,alias:a}}return f}}(St.API),St.API.processPNG=function(e,t,r,n){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var a,i=vZ(e,{checkCrc:!0}),s=i.width,o=i.height,l=i.channels,c=i.palette,f=i.depth;a=c&&l===1?function(O){for(var I=O.width,j=O.height,W=O.data,E=O.palette,C=O.depth,G=!1,Z=[],he=[],oe=void 0,me=!1,pe=0,ge=0;ge<E.length;ge++){var Le=kw(E[ge],4),Se=Le[0],N=Le[1],D=Le[2],L=Le[3];Z.push(Se,N,D),L!=null&&(L===0?(pe++,he.length<1&&he.push(ge)):L<255&&(me=!0))}if(me||pe>1){G=!0,he=void 0;var F=I*j;oe=new Uint8Array(F);for(var K=new DataView(W.buffer),ce=0;ce<F;ce++){var xe=j1(K,ce,C),ee=kw(E[xe],4)[3];oe[ce]=ee}}return{colorSpace:"Indexed",colorsPerPixel:1,colorBytes:W,alphaBytes:oe,needSMask:G,palette:Z,mask:he}}(i):l===2||l===4?function(O){for(var I=O.data,j=O.width,W=O.height,E=O.channels,C=O.depth,G=E===2?"DeviceGray":"DeviceRGB",Z=E-1,he=j*W,oe=Z,me=he*oe,pe=1*he,ge=Math.ceil(me*C/8),Le=Math.ceil(pe*C/8),Se=new Uint8Array(ge),N=new Uint8Array(Le),D=new DataView(I.buffer),L=new DataView(Se.buffer),F=new DataView(N.buffer),K=!1,ce=0;ce<he;ce++){for(var xe=ce*E,ee=0;ee<oe;ee++)H_(L,j1(D,xe+ee,C),ce*oe+ee,C);var fe=j1(D,xe+oe,C);fe<(1<<C)-1&&(K=!0),H_(F,fe,1*ce,C)}return{colorSpace:G,colorsPerPixel:Z,colorBytes:Se,alphaBytes:N,needSMask:K}}(i):function(O){var I=O.data,j=O.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:j,colorsPerPixel:j==="DeviceGray"?1:3,colorBytes:I instanceof Uint8Array?I:new Uint8Array(I.buffer),needSMask:!1}}(i);var h,p,d,x=a,g=x.colorSpace,y=x.colorsPerPixel,b=x.colorBytes,T=x.alphaBytes,S=x.needSMask,k=x.palette,A=x.mask,M=null;return n!==St.API.image_compression.NONE&&typeof kg=="function"?(M=function(O){var I;switch(O){case St.API.image_compression.FAST:I=11;break;case St.API.image_compression.MEDIUM:I=13;break;case St.API.image_compression.SLOW:I=14;break;default:I=12}return I}(n),h=this.decode.FLATE_DECODE,p="/Predictor ".concat(M," "),e=U_(b,s*y,y,n),S&&(d=U_(T,s,1,n))):(h=void 0,p="",e=b,S&&(d=T)),p+="/Colors ".concat(y," /BitsPerComponent ").concat(f," /Columns ").concat(s),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(d&&this.__addimage__.isArrayBuffer(d)||this.__addimage__.isArrayBufferView(d))&&(d=this.__addimage__.arrayBufferToBinaryString(d)),{alias:r,data:e,index:t,filter:h,decodeParameters:p,transparency:A,palette:k,sMask:d,predictor:M,width:s,height:o,bitsPerComponent:f,colorSpace:g}}},function(e){e.processGIF89A=function(t,r,n,a){var i=new BZ(t),s=i.width,o=i.height,l=[];i.decodeAndBlitFrameRGBA(0,l);var c={data:l,width:s,height:o},f=new P1(100).encode(c,100);return e.processJPEG.call(this,f,r,n,a)},e.processGIF87A=e.processGIF89A}(St.API),ji.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:a,green:n,blue:r,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},ji.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){vr.log("bit decode error:"+r)}},ji.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,a=0;a<t;a++)for(var i=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+8*a*4,o=0;o<8&&8*a+o<this.width;o++){var l=this.palette[i>>7-o&1];this.data[s+4*o]=l.blue,this.data[s+4*o+1]=l.green,this.data[s+4*o+2]=l.red,this.data[s+4*o+3]=255}r!==0&&(this.pos+=4-r)}},ji.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<e;a++){var i=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+2*a*4,o=i>>4,l=15&i,c=this.palette[o];if(this.data[s]=c.blue,this.data[s+1]=c.green,this.data[s+2]=c.red,this.data[s+3]=255,2*a+1>=this.width)break;c=this.palette[l],this.data[s+4]=c.blue,this.data[s+4+1]=c.green,this.data[s+4+2]=c.red,this.data[s+4+3]=255}t!==0&&(this.pos+=4-t)}},ji.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+4*n;if(a<this.palette.length){var s=this.palette[a];this.data[i]=s.red,this.data[i+1]=s.green,this.data[i+2]=s.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}e!==0&&(this.pos+=4-e)}},ji.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<this.width;a++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(i&t)/t*255|0,o=(i>>5&t)/t*255|0,l=(i>>10&t)/t*255|0,c=i>>15?255:0,f=n*this.width*4+4*a;this.data[f]=l,this.data[f+1]=o,this.data[f+2]=s,this.data[f+3]=c}this.pos+=e}},ji.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&t)/t*255|0,l=(s>>5&r)/r*255|0,c=(s>>11)/t*255|0,f=a*this.width*4+4*i;this.data[f]=c,this.data[f+1]=l,this.data[f+2]=o,this.data[f+3]=255}this.pos+=e}},ji.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*r;this.data[s]=i,this.data[s+1]=a,this.data[s+2]=n,this.data[s+3]=255}this.pos+=this.width%4}},ji.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=i,this.data[o+1]=a,this.data[o+2]=n,this.data[o+3]=s}},ji.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,a){var i=new ji(t,!1),s=i.width,o=i.height,l={data:i.getData(),width:s,height:o},c=new P1(100).encode(l,100);return e.processJPEG.call(this,c,r,n,a)}}(St.API),V_.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,a){var i=new V_(t),s=i.width,o=i.height,l={data:i.getData(),width:s,height:o},c=new P1(100).encode(l,100);return e.processJPEG.call(this,c,r,n,a)}}(St.API),St.API.processRGBA=function(e,t,r){for(var n=e.data,a=n.length,i=new Uint8Array(a/4*3),s=new Uint8Array(a/4),o=0,l=0,c=0;c<a;c+=4){var f=n[c],h=n[c+1],p=n[c+2],d=n[c+3];i[o++]=f,i[o++]=h,i[o++]=p,s[l++]=d}var x=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:x,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},St.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},dc=St.API,_h=dc.getCharWidthsArray=function(e,t){var r,n,a=(t=t||{}).font||this.internal.getFont(),i=t.fontSize||this.internal.getFontSize(),s=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:a.metadata.Unicode.widths,l=o.fof?o.fof:1,c=t.kerning?t.kerning:a.metadata.Unicode.kerning,f=c.fof?c.fof:1,h=t.doKerning!==!1,p=0,d=e.length,x=0,g=o[0]||l,y=[];for(r=0;r<d;r++)n=e.charCodeAt(r),typeof a.metadata.widthOfString=="function"?y.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(n))+s*(1e3/i)||0)/1e3):(p=h&&fr(c[n])==="object"&&!isNaN(parseInt(c[n][x],10))?c[n][x]/f:0,y.push((o[n]||g)/l+p)),x=n;return y},M_=dc.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),a=t.charSpace||this.internal.getCharSpace();return dc.processArabic&&(e=dc.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,a)/r:_h.apply(this,arguments).reduce(function(i,s){return i+s},0)},R_=function(e,t,r,n){for(var a=[],i=0,s=e.length,o=0;i!==s&&o+t[i]<r;)o+=t[i],i++;a.push(e.slice(0,i));var l=i;for(o=0;i!==s;)o+t[i]>n&&(a.push(e.slice(l,i)),o=0,l=i),o+=t[i],i++;return l!==i&&a.push(e.slice(l,i)),a},B_=function(e,t,r){r||(r={});var n,a,i,s,o,l,c,f=[],h=[f],p=r.textIndent||0,d=0,x=0,g=e.split(" "),y=_h.apply(this,[" ",r])[0];if(l=r.lineIndent===-1?g[0].length+2:r.lineIndent||0){var b=Array(l).join(" "),T=[];g.map(function(k){(k=k.split(/\s*\n/)).length>1?T=T.concat(k.map(function(A,M){return(M&&A.length?`
`:"")+A})):T.push(k[0])}),g=T,l=M_.apply(this,[b,r])}for(i=0,s=g.length;i<s;i++){var S=0;if(n=g[i],l&&n[0]==`
`&&(n=n.substr(1),S=1),p+d+(x=(a=_h.apply(this,[n,r])).reduce(function(k,A){return k+A},0))>t||S){if(x>t){for(o=R_.apply(this,[n,a,t-(p+d),t]),f.push(o.shift()),f=[o.pop()];o.length;)h.push([o.shift()]);x=a.slice(n.length-(f[0]?f[0].length:0)).reduce(function(k,A){return k+A},0)}else f=[n];h.push(f),p=x+l,d=y}else f.push(n),p+=d+x,d=y}return c=l?function(k,A){return(A?b:"")+k.join(" ")}:function(k){return k.join(" ")},h.map(c)},dc.splitTextToSize=function(e,t,r){var n,a=(r=r||{}).fontSize||this.internal.getFontSize(),i=(function(f){if(f.widths&&f.kerning)return{widths:f.widths,kerning:f.kerning};var h=this.internal.getFont(f.fontName,f.fontStyle),p="Unicode";return h.metadata[p]?{widths:h.metadata[p].widths||{0:1},kerning:h.metadata[p].kerning||{}}:{font:h.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var s=1*this.internal.scaleFactor*t/a;i.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/a:0,i.lineIndent=r.lineIndent;var o,l,c=[];for(o=0,l=n.length;o<l;o++)c=c.concat(B_.apply(this,[n[o],s,i]));return c},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",n={},a={},i=0;i<16;i++)n[r[i]]=t[i],a[t[i]]=r[i];var s=function(p){return"0x"+parseInt(p,10).toString(16)},o=e.__fontmetrics__.compress=function(p){var d,x,g,y,b=["{"];for(var T in p){if(d=p[T],isNaN(parseInt(T,10))?x="'"+T+"'":(T=parseInt(T,10),x=(x=s(T).slice(2)).slice(0,-1)+a[x.slice(-1)]),typeof d=="number")d<0?(g=s(d).slice(3),y="-"):(g=s(d).slice(2),y=""),g=y+g.slice(0,-1)+a[g.slice(-1)];else{if(fr(d)!=="object")throw new Error("Don't know what to do with value type "+fr(d)+".");g=o(d)}b.push(x+g)}return b.push("}"),b.join("")},l=e.__fontmetrics__.uncompress=function(p){if(typeof p!="string")throw new Error("Invalid argument passed to uncompress.");for(var d,x,g,y,b={},T=1,S=b,k=[],A="",M="",O=p.length-1,I=1;I<O;I+=1)(y=p[I])=="'"?d?(g=d.join(""),d=void 0):d=[]:d?d.push(y):y=="{"?(k.push([S,g]),S={},g=void 0):y=="}"?((x=k.pop())[0][x[1]]=S,g=void 0,S=x[0]):y=="-"?T=-1:g===void 0?n.hasOwnProperty(y)?(A+=n[y],g=parseInt(A,16)*T,T=1,A=""):A+=y:n.hasOwnProperty(y)?(M+=n[y],S[g]=parseInt(M,16)*T,T=1,g=void 0,M=""):M+=y;return b},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},f={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},h={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(p){var d=p.font,x=h.Unicode[d.postScriptName];x&&(d.metadata.Unicode={},d.metadata.Unicode.widths=x.widths,d.metadata.Unicode.kerning=x.kerning);var g=f.Unicode[d.postScriptName];g&&(d.metadata.Unicode.encoding=g,d.encoding=g.codePages[0])}])}(St.API),function(e){var t=function(r){for(var n=r.length,a=new Uint8Array(n),i=0;i<n;i++)a[i]=r.charCodeAt(i);return a};e.API.events.push(["addFont",function(r){var n=void 0,a=r.font,i=r.instance;if(!a.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(n=i.existsFileInVFS(a.postScriptName)===!1?i.loadFile(a.postScriptName):i.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(s,o){o=/^\x00\x01\x00\x00/.test(o)?t(o):t(Th(o)),s.metadata=e.API.TTFFont.open(o),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(a,n)}}])}(St),St.API.addSvgAsImage=function(e,t,r,n,a,i,s,o){if(isNaN(t)||isNaN(r))throw vr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(a))throw vr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var l=document.createElement("canvas");l.width=n,l.height=a;var c=l.getContext("2d");c.fillStyle="#fff",c.fillRect(0,0,l.width,l.height);var f={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},h=this;return(Ct.canvg?Promise.resolve(Ct.canvg):ym(()=>import("./index.es-2Eur94l8.js"),__vite__mapDeps([0,1,2,3]))).catch(function(p){return Promise.reject(new Error("Could not load canvg: "+p))}).then(function(p){return p.default?p.default:p}).then(function(p){return p.fromString(c,e,f)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(p){return p.render(f)}).then(function(){h.addImage(l.toDataURL("image/jpeg",1),t,r,n,a,s,o)})},St.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var a=0;a<this.internal.pages[n].length;a++)this.internal.pages[n][a]=this.internal.pages[n][a].replace(t,r);return this},St.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,a,i,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(s),l=[],c=0,f=0,h=0;function p(x,g){var y,b=!1;for(y=0;y<x.length;y+=1)x[y]===g&&(b=!0);return b}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var d=o.length;for(h=0;h<d;h+=1)r[o[h]].value=r[o[h]].defaultValue,r[o[h]].explicitSet=!1}if(fr(e)==="object"){for(a in e)if(i=e[a],p(o,a)&&i!==void 0){if(r[a].type==="boolean"&&typeof i=="boolean")r[a].value=i;else if(r[a].type==="name"&&p(r[a].valueSet,i))r[a].value=i;else if(r[a].type==="integer"&&Number.isInteger(i))r[a].value=i;else if(r[a].type==="array"){for(c=0;c<i.length;c+=1)if(n=!0,i[c].length===1&&typeof i[c][0]=="number")l.push(String(i[c]-1));else if(i[c].length>1){for(f=0;f<i[c].length;f+=1)typeof i[c][f]!="number"&&(n=!1);n===!0&&l.push([i[c][0]-1,i[c][1]-1].join(" "))}r[a].value="["+l.join(" ")+"]"}else r[a].value=r[a].defaultValue;r[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var x,g=[];for(x in r)r[x].explicitSet===!0&&(r[x].type==="name"?g.push("/"+x+" /"+r[x].value):g.push("/"+x+" "+r[x].value));g.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+g.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',a=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(n)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),l=unescape(encodeURIComponent("</x:xmpmeta>")),c=i.length+s.length+o.length+a.length+l.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+c+" >>"),this.internal.write("stream"),this.internal.write(a+i+s+o+l),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,a){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:a||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(St.API),function(e){var t=e.API,r=t.pdfEscape16=function(i,s){for(var o,l=s.metadata.Unicode.widths,c=["","0","00","000","0000"],f=[""],h=0,p=i.length;h<p;++h){if(o=s.metadata.characterToGlyph(i.charCodeAt(h)),s.metadata.glyIdsUsed.push(o),s.metadata.toUnicode[o]=i.charCodeAt(h),l.indexOf(o)==-1&&(l.push(o),l.push([parseInt(s.metadata.widthOfGlyph(o),10)])),o=="0")return f.join("");o=o.toString(16),f.push(c[4-o.length],o)}return f.join("")},n=function(i){var s,o,l,c,f,h,p;for(f=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,l=[],h=0,p=(o=Object.keys(i).sort(function(d,x){return d-x})).length;h<p;h++)s=o[h],l.length>=100&&(f+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar`,l=[]),i[s]!==void 0&&i[s]!==null&&typeof i[s].toString=="function"&&(c=("0000"+i[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),l.push("<"+s+"><"+c+">"));return l.length&&(f+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar
`),f+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(i){(function(s){var o=s.font,l=s.out,c=s.newObject,f=s.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="Identity-H"){for(var h=o.metadata.Unicode.widths,p=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),d="",x=0;x<p.length;x++)d+=String.fromCharCode(p[x]);var g=c();f({data:d,addLength1:!0,objectId:g}),l("endobj");var y=c();f({data:n(o.metadata.toUnicode),addLength1:!0,objectId:y}),l("endobj");var b=c();l("<<"),l("/Type /FontDescriptor"),l("/FontName /"+xc(o.fontName)),l("/FontFile2 "+g+" 0 R"),l("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),l("/Flags "+o.metadata.flags),l("/StemV "+o.metadata.stemV),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l(">>"),l("endobj");var T=c();l("<<"),l("/Type /Font"),l("/BaseFont /"+xc(o.fontName)),l("/FontDescriptor "+b+" 0 R"),l("/W "+e.API.PDFObject.convert(h)),l("/CIDToGIDMap /Identity"),l("/DW 1000"),l("/Subtype /CIDFontType2"),l("/CIDSystemInfo"),l("<<"),l("/Supplement 0"),l("/Registry (Adobe)"),l("/Ordering ("+o.encoding+")"),l(">>"),l(">>"),l("endobj"),o.objectNumber=c(),l("<<"),l("/Type /Font"),l("/Subtype /Type0"),l("/ToUnicode "+y+" 0 R"),l("/BaseFont /"+xc(o.fontName)),l("/Encoding /"+o.encoding),l("/DescendantFonts ["+T+" 0 R]"),l(">>"),l("endobj"),o.isAlreadyPutted=!0}})(i)}]),t.events.push(["putFont",function(i){(function(s){var o=s.font,l=s.out,c=s.newObject,f=s.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var h=o.metadata.rawData,p="",d=0;d<h.length;d++)p+=String.fromCharCode(h[d]);var x=c();f({data:p,addLength1:!0,objectId:x}),l("endobj");var g=c();f({data:n(o.metadata.toUnicode),addLength1:!0,objectId:g}),l("endobj");var y=c();l("<<"),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l("/StemV "+o.metadata.stemV),l("/Type /FontDescriptor"),l("/FontFile2 "+x+" 0 R"),l("/Flags 96"),l("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),l("/FontName /"+xc(o.fontName)),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l(">>"),l("endobj"),o.objectNumber=c();for(var b=0;b<o.metadata.hmtx.widths.length;b++)o.metadata.hmtx.widths[b]=parseInt(o.metadata.hmtx.widths[b]*(1e3/o.metadata.head.unitsPerEm));l("<</Subtype/TrueType/Type/Font/ToUnicode "+g+" 0 R/BaseFont/"+xc(o.fontName)+"/FontDescriptor "+y+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),l("endobj"),o.isAlreadyPutted=!0}})(i)}]);var a=function(i){var s,o=i.text||"",l=i.x,c=i.y,f=i.options||{},h=i.mutex||{},p=h.pdfEscape,d=h.activeFontKey,x=h.fonts,g=d,y="",b=0,T="",S=x[g].encoding;if(x[g].encoding!=="Identity-H")return{text:o,x:l,y:c,options:f,mutex:h};for(T=o,g=d,Array.isArray(o)&&(T=o[0]),b=0;b<T.length;b+=1)x[g].metadata.hasOwnProperty("cmap")&&(s=x[g].metadata.cmap.unicode.codeMap[T[b].charCodeAt(0)]),s||T[b].charCodeAt(0)<256&&x[g].metadata.hasOwnProperty("Unicode")?y+=T[b]:y+="";var k="";return parseInt(g.slice(1))<14||S==="WinAnsiEncoding"?k=p(y,g).split("").map(function(A){return A.charCodeAt(0).toString(16)}).join(""):S==="Identity-H"&&(k=r(y,x[g])),h.isHex=!0,{text:k,x:l,y:c,options:f,mutex:h}};t.events.push(["postProcessText",function(i){var s=i.text||"",o=[],l={text:s,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(s)){var c=0;for(c=0;c<s.length;c+=1)Array.isArray(s[c])&&s[c].length===3?o.push([a(Object.assign({},l,{text:s[c][0]})).text,s[c][1],s[c][2]]):o.push(a(Object.assign({},l,{text:s[c]})).text);i.text=o}else i.text=a(Object.assign({},l,{text:s})).text}])}(St),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(St.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var a,i,s,o,l,c,f,h=t,p=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],d=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],x={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},g={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},y=["(",")","(","<",">","<","[","]","[","{","}","{","¬´","¬ª","¬´","‚Äπ","‚Ä∫","‚Äπ","‚ÅÖ","‚ÅÜ","‚ÅÖ","‚ÅΩ","‚Åæ","‚ÅΩ","‚Çç","‚Çé","‚Çç","‚â§","‚â•","‚â§","‚å©","‚å™","‚å©","Ôπô","Ôπö","Ôπô","Ôπõ","Ôπú","Ôπõ","Ôπù","Ôπû","Ôπù","Ôπ§","Ôπ•","Ôπ§"],b=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),T=!1,S=0;this.__bidiEngine__={};var k=function(E){var C=E.charCodeAt(),G=C>>8,Z=g[G];return Z!==void 0?h[256*Z+(255&C)]:G===252||G===253?"AL":b.test(G)?"L":G===8?"R":"N"},A=function(E){for(var C,G=0;G<E.length;G++){if((C=k(E.charAt(G)))==="L")return!1;if(C==="R")return!0}return!1},M=function(E,C,G,Z){var he,oe,me,pe,ge=C[Z];switch(ge){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":T=!1;break;case"N":case"AN":break;case"EN":T&&(ge="AN");break;case"AL":T=!0,ge="R";break;case"WS":case"BN":ge="N";break;case"CS":Z<1||Z+1>=C.length||(he=G[Z-1])!=="EN"&&he!=="AN"||(oe=C[Z+1])!=="EN"&&oe!=="AN"?ge="N":T&&(oe="AN"),ge=oe===he?oe:"N";break;case"ES":ge=(he=Z>0?G[Z-1]:"B")==="EN"&&Z+1<C.length&&C[Z+1]==="EN"?"EN":"N";break;case"ET":if(Z>0&&G[Z-1]==="EN"){ge="EN";break}if(T){ge="N";break}for(me=Z+1,pe=C.length;me<pe&&C[me]==="ET";)me++;ge=me<pe&&C[me]==="EN"?"EN":"N";break;case"NSM":if(s&&!o){for(pe=C.length,me=Z+1;me<pe&&C[me]==="NSM";)me++;if(me<pe){var Le=E[Z],Se=Le>=1425&&Le<=2303||Le===64286;if(he=C[me],Se&&(he==="R"||he==="AL")){ge="R";break}}}ge=Z<1||(he=C[Z-1])==="B"?"N":G[Z-1];break;case"B":T=!1,a=!0,ge=S;break;case"S":i=!0,ge="N"}return ge},O=function(E,C,G){var Z=E.split("");return G&&I(Z,G,{hiLevel:S}),Z.reverse(),C&&C.reverse(),Z.join("")},I=function(E,C,G){var Z,he,oe,me,pe,ge=-1,Le=E.length,Se=0,N=[],D=S?d:p,L=[];for(T=!1,a=!1,i=!1,he=0;he<Le;he++)L[he]=k(E[he]);for(oe=0;oe<Le;oe++){if(pe=Se,N[oe]=M(E,L,N,oe),Z=240&(Se=D[pe][x[N[oe]]]),Se&=15,C[oe]=me=D[Se][5],Z>0)if(Z===16){for(he=ge;he<oe;he++)C[he]=1;ge=-1}else ge=-1;if(D[Se][6])ge===-1&&(ge=oe);else if(ge>-1){for(he=ge;he<oe;he++)C[he]=me;ge=-1}L[oe]==="B"&&(C[oe]=0),G.hiLevel|=me}i&&function(F,K,ce){for(var xe=0;xe<ce;xe++)if(F[xe]==="S"){K[xe]=S;for(var ee=xe-1;ee>=0&&F[ee]==="WS";ee--)K[ee]=S}}(L,C,Le)},j=function(E,C,G,Z,he){if(!(he.hiLevel<E)){if(E===1&&S===1&&!a)return C.reverse(),void(G&&G.reverse());for(var oe,me,pe,ge,Le=C.length,Se=0;Se<Le;){if(Z[Se]>=E){for(pe=Se+1;pe<Le&&Z[pe]>=E;)pe++;for(ge=Se,me=pe-1;ge<me;ge++,me--)oe=C[ge],C[ge]=C[me],C[me]=oe,G&&(oe=G[ge],G[ge]=G[me],G[me]=oe);Se=pe}Se++}}},W=function(E,C,G){var Z=E.split(""),he={hiLevel:S};return G||(G=[]),I(Z,G,he),function(oe,me,pe){if(pe.hiLevel!==0&&f)for(var ge,Le=0;Le<oe.length;Le++)me[Le]===1&&(ge=y.indexOf(oe[Le]))>=0&&(oe[Le]=y[ge+1])}(Z,G,he),j(2,Z,C,G,he),j(1,Z,C,G,he),Z.join("")};return this.__bidiEngine__.doBidiReorder=function(E,C,G){if(function(he,oe){if(oe)for(var me=0;me<he.length;me++)oe[me]=me;o===void 0&&(o=A(he)),c===void 0&&(c=A(he))}(E,C),s||!l||c)if(s&&l&&o^c)S=o?1:0,E=O(E,C,G);else if(!s&&l&&c)S=o?1:0,E=W(E,C,G),E=O(E,C);else if(!s||o||l||c){if(s&&!l&&o^c)E=O(E,C),o?(S=0,E=W(E,C,G)):(S=1,E=W(E,C,G),E=O(E,C));else if(s&&o&&!l&&c)S=1,E=W(E,C,G),E=O(E,C);else if(!s&&!l&&o^c){var Z=f;o?(S=1,E=W(E,C,G),S=0,f=!1,E=W(E,C,G),f=Z):(S=0,E=W(E,C,G),E=O(E,C),S=1,f=!1,E=W(E,C,G),f=Z,E=O(E,C))}}else S=0,E=W(E,C,G);else S=o?1:0,E=W(E,C,G);return E},this.__bidiEngine__.setOptions=function(E){E&&(s=E.isInputVisual,l=E.isOutputVisual,o=E.isInputRtl,c=E.isOutputRtl,f=E.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var a=n.text;n.x,n.y;var i=n.options||{};n.mutex,i.lang;var s=[];if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,r.setOptions(i),Object.prototype.toString.call(a)==="[object Array]"){var o=0;for(s=[],o=0;o<a.length;o+=1)Object.prototype.toString.call(a[o])==="[object Array]"?s.push([r.doBidiReorder(a[o][0]),a[o][1],a[o][2]]):s.push([r.doBidiReorder(a[o])]);n.text=s}else n.text=r.doBidiReorder(a);r.setOptions({isInputVisual:!0})}])}(St),St.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new Lo(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new eJ(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new UZ(this.contents),this.head=new zZ(this),this.name=new VZ(this),this.cmap=new wT(this),this.toUnicode={},this.hhea=new qZ(this),this.maxp=new KZ(this),this.hmtx=new YZ(this),this.post=new HZ(this),this.os2=new WZ(this),this.loca=new QZ(this),this.glyf=new XZ(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,a,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var s,o,l,c;for(c=[],s=0,o=(l=this.bbox).length;s<o;s++)t=l[s],c.push(Math.round(t*this.scaleFactor));return c}).call(this),this.stemV=0,this.post.exists?(n=255&(a=this.post.italic_angle),32768&(r=a>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var a,i,s,o;for(s=0,i=0,o=(t=""+t).length;0<=o?i<o:i>o;i=0<=o?++i:--i)a=t.charCodeAt(i),s+=this.widthOfGlyph(this.characterToGlyph(a))+n*(1e3/r)||0;return s*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var Bi,Lo=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,a;for(a=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)a.push(this.writeByte(t.charCodeAt(r)));return a},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,a,i,s,o,l;return t=this.readByte(),r=this.readByte(),n=this.readByte(),a=this.readByte(),i=this.readByte(),s=this.readByte(),o=this.readByte(),l=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^a)+16777216*(255^i)+65536*(255^s)+256*(255^o)+(255^l)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*a+16777216*i+65536*s+256*o+l},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,a,i;for(i=[],n=0,a=t.length;n<a;n++)r=t[n],i.push(this.writeByte(r));return i},e}(),UZ=function(){var e;function t(r){var n,a,i;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},a=0,i=this.tableCount;0<=i?a<i:a>i;a=0<=i?++a:--a)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,a,i,s,o,l,c,f,h,p,d,x,g;for(g in d=Object.keys(r).length,l=Math.log(2),h=16*Math.floor(Math.log(d)/l),s=Math.floor(h/l),f=16*d-h,(a=new Lo).writeInt(this.scalarType),a.writeShort(d),a.writeShort(h),a.writeShort(s),a.writeShort(f),i=16*d,c=a.pos+i,o=null,x=[],r)for(p=r[g],a.writeString(g),a.writeInt(e(p)),a.writeInt(c),a.writeInt(p.length),x=x.concat(p),g==="head"&&(o=c),c+=p.length;c%4;)x.push(0),c++;return a.write(x),n=2981146554-e(a.data),a.pos=o+8,a.writeUInt32(n),a.data},e=function(r){var n,a,i,s;for(r=_T.call(r);r.length%4;)r.push(0);for(i=new Lo(r),a=0,n=0,s=r.length;n<s;n=n+=4)a+=i.readUInt32();return 4294967295&a},t}(),$Z={}.hasOwnProperty,ls=function(e,t){for(var r in t)$Z.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};Bi=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var zZ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Bi),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new Lo).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e}(),K_=function(){function e(t,r){var n,a,i,s,o,l,c,f,h,p,d,x,g,y,b,T,S;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),h=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=t.readByte();break;case 4:for(d=t.readUInt16(),p=d/2,t.pos+=6,i=function(){var k,A;for(A=[],l=k=0;0<=p?k<p:k>p;l=0<=p?++k:--k)A.push(t.readUInt16());return A}(),t.pos+=2,g=function(){var k,A;for(A=[],l=k=0;0<=p?k<p:k>p;l=0<=p?++k:--k)A.push(t.readUInt16());return A}(),c=function(){var k,A;for(A=[],l=k=0;0<=p?k<p:k>p;l=0<=p?++k:--k)A.push(t.readUInt16());return A}(),f=function(){var k,A;for(A=[],l=k=0;0<=p?k<p:k>p;l=0<=p?++k:--k)A.push(t.readUInt16());return A}(),a=(this.length-t.pos+this.offset)/2,o=function(){var k,A;for(A=[],l=k=0;0<=a?k<a:k>a;l=0<=a?++k:--k)A.push(t.readUInt16());return A}(),l=b=0,S=i.length;b<S;l=++b)for(y=i[l],n=T=x=g[l];x<=y?T<=y:T>=y;n=x<=y?++T:--T)f[l]===0?s=n+c[l]:(s=o[f[l]/2+(n-x)-(p-l)]||0)!==0&&(s+=c[l]),this.codeMap[n]=65535&s}t.pos=h}return e.encode=function(t,r){var n,a,i,s,o,l,c,f,h,p,d,x,g,y,b,T,S,k,A,M,O,I,j,W,E,C,G,Z,he,oe,me,pe,ge,Le,Se,N,D,L,F,K,ce,xe,ee,fe,le,ue;switch(Z=new Lo,s=Object.keys(t).sort(function($e,ye){return $e-ye}),r){case"macroman":for(g=0,y=function(){var $e=[];for(x=0;x<256;++x)$e.push(0);return $e}(),T={0:0},i={},he=0,ge=s.length;he<ge;he++)T[ee=t[a=s[he]]]==null&&(T[ee]=++g),i[a]={old:t[a],new:T[t[a]]},y[a]=T[t[a]];return Z.writeUInt16(1),Z.writeUInt16(0),Z.writeUInt32(12),Z.writeUInt16(0),Z.writeUInt16(262),Z.writeUInt16(0),Z.write(y),{charMap:i,subtable:Z.data,maxGlyphID:g+1};case"unicode":for(C=[],h=[],S=0,T={},n={},b=c=null,oe=0,Le=s.length;oe<Le;oe++)T[A=t[a=s[oe]]]==null&&(T[A]=++S),n[a]={old:A,new:T[A]},o=T[A]-a,b!=null&&o===c||(b&&h.push(b),C.push(a),c=o),b=a;for(b&&h.push(b),h.push(65535),C.push(65535),W=2*(j=C.length),I=2*Math.pow(Math.log(j)/Math.LN2,2),p=Math.log(I/2)/Math.LN2,O=2*j-I,l=[],M=[],d=[],x=me=0,Se=C.length;me<Se;x=++me){if(E=C[x],f=h[x],E===65535){l.push(0),M.push(0);break}if(E-(G=n[E].new)>=32768)for(l.push(0),M.push(2*(d.length+j-x)),a=pe=E;E<=f?pe<=f:pe>=f;a=E<=f?++pe:--pe)d.push(n[a].new);else l.push(G-E),M.push(0)}for(Z.writeUInt16(3),Z.writeUInt16(1),Z.writeUInt32(12),Z.writeUInt16(4),Z.writeUInt16(16+8*j+2*d.length),Z.writeUInt16(0),Z.writeUInt16(W),Z.writeUInt16(I),Z.writeUInt16(p),Z.writeUInt16(O),ce=0,N=h.length;ce<N;ce++)a=h[ce],Z.writeUInt16(a);for(Z.writeUInt16(0),xe=0,D=C.length;xe<D;xe++)a=C[xe],Z.writeUInt16(a);for(fe=0,L=l.length;fe<L;fe++)o=l[fe],Z.writeUInt16(o);for(le=0,F=M.length;le<F;le++)k=M[le],Z.writeUInt16(k);for(ue=0,K=d.length;ue<K;ue++)g=d[ue],Z.writeUInt16(g);return{charMap:n,subtable:Z.data,maxGlyphID:S+1}}},e}(),wT=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Bi),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,n,a;for(t.pos=this.offset,this.version=t.readUInt16(),a=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=a?n<a:n>a;n=0<=a?++n:--n)r=new K_(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var n,a;return r==null&&(r="macroman"),n=K_.encode(t,r),(a=new Lo).writeUInt16(0),a.writeUInt16(1),n.table=a.data.concat(n.subtable),n},e}(),qZ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Bi),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),WZ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Bi),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(t.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(t.readInt());return n}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(t.readInt());return n}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),HZ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Bi),e.prototype.tag="post",e.prototype.parse=function(t){var r,n,a;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var i;for(n=t.readUInt16(),this.glyphNameIndex=[],i=0;0<=n?i<n:i>n;i=0<=n?++i:--i)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],a=[];t.pos<this.offset+this.length;)r=t.readByte(),a.push(this.names.push(t.readString(r)));return a;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 262144:return this.map=(function(){var s,o,l;for(l=[],i=s=0,o=this.file.maxp.numGlyphs;0<=o?s<o:s>o;i=0<=o?++s:--s)l.push(t.readUInt32());return l}).call(this)}},e}(),GZ=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},VZ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Bi),e.prototype.tag="name",e.prototype.parse=function(t){var r,n,a,i,s,o,l,c,f,h,p;for(t.pos=this.offset,t.readShort(),r=t.readShort(),o=t.readShort(),n=[],i=0;0<=r?i<r:i>r;i=0<=r?++i:--i)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+o+t.readShort()});for(l={},i=f=0,h=n.length;f<h;i=++f)a=n[i],t.pos=a.offset,c=t.readString(a.length),s=new GZ(c,a),l[p=a.nameID]==null&&(l[p]=[]),l[a.nameID].push(s);this.strings=l,this.copyright=l[0],this.fontFamily=l[1],this.fontSubfamily=l[2],this.uniqueSubfamily=l[3],this.fontName=l[4],this.version=l[5];try{this.postscriptName=l[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=l[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=l[7],this.manufacturer=l[8],this.designer=l[9],this.description=l[10],this.vendorUrl=l[11],this.designerUrl=l[12],this.license=l[13],this.licenseUrl=l[14],this.preferredFamily=l[15],this.preferredSubfamily=l[17],this.compatibleFull=l[18],this.sampleText=l[19]},e}(),KZ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Bi),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),YZ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Bi),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,n,a,i,s,o,l;for(t.pos=this.offset,this.metrics=[],r=0,o=this.file.hhea.numberOfMetrics;0<=o?r<o:r>o;r=0<=o?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(a=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var c,f;for(f=[],r=c=0;0<=a?c<a:c>a;r=0<=a?++c:--c)f.push(t.readInt16());return f}(),this.widths=(function(){var c,f,h,p;for(p=[],c=0,f=(h=this.metrics).length;c<f;c++)i=h[c],p.push(i.advance);return p}).call(this),n=this.widths[this.widths.length-1],l=[],r=s=0;0<=a?s<a:s>a;r=0<=a?++s:--s)l.push(this.widths.push(n));return l},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),_T=[].slice,XZ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Bi),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,n,a,i,s,o,l,c,f,h;return t in this.cache?this.cache[t]:(i=this.file.loca,r=this.file.contents,n=i.indexOf(t),(a=i.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+n,s=(o=new Lo(r.read(a))).readShort(),c=o.readShort(),h=o.readShort(),l=o.readShort(),f=o.readShort(),this.cache[t]=s===-1?new JZ(o,c,h,l,f):new ZZ(o,s,c,h,l,f),this.cache[t]))},e.prototype.encode=function(t,r,n){var a,i,s,o,l;for(s=[],i=[],o=0,l=r.length;o<l;o++)a=t[r[o]],i.push(s.length),a&&(s=s.concat(a.encode(n)));return i.push(s.length),{table:s,offsets:i}},e}(),ZZ=function(){function e(t,r,n,a,i,s){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=a,this.xMax=i,this.yMax=s,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),JZ=function(){function e(t,r,n,a,i){var s,o;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=a,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;o=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&o;)s.pos+=1&o?4:2,128&o?s.pos+=8:64&o?s.pos+=4:8&o&&(s.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new Lo(_T.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),QZ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ls(e,Bi),e.prototype.tag="loca",e.prototype.parse=function(t){var r,n;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var a,i;for(i=[],n=0,a=this.length;n<a;n+=2)i.push(2*t.readUInt16());return i}).call(this):(function(){var a,i;for(i=[],n=0,a=this.length;n<a;n+=4)i.push(t.readUInt32());return i}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var n=new Uint32Array(this.offsets.length),a=0,i=0,s=0;s<n.length;++s)if(n[s]=a,i<r.length&&r[i]==s){++i,n[s]=a;var o=this.offsets[s],l=this.offsets[s+1]-o;l>0&&(a+=l)}for(var c=new Array(4*n.length),f=0;f<n.length;++f)c[4*f+3]=255&n[f],c[4*f+2]=(65280&n[f])>>8,c[4*f+1]=(16711680&n[f])>>16,c[4*f]=(4278190080&n[f])>>24;return c},e}(),eJ=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,a,i;for(r in a=this.font.cmap.tables[0].codeMap,t={},i=this.subset)n=i[r],t[r]=a[n];return t},e.prototype.glyphsFor=function(t){var r,n,a,i,s,o,l;for(a={},s=0,o=t.length;s<o;s++)a[i=t[s]]=this.font.glyf.glyphFor(i);for(i in r=[],a)(n=a[i])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(i in l=this.glyphsFor(r))n=l[i],a[i]=n;return a},e.prototype.encode=function(t,r){var n,a,i,s,o,l,c,f,h,p,d,x,g,y,b;for(a in n=wT.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(t),d={0:0},b=n.charMap)d[(l=b[a]).old]=l.new;for(x in p=n.maxGlyphID,s)x in d||(d[x]=p++);return f=function(T){var S,k;for(S in k={},T)k[T[S]]=S;return k}(d),h=Object.keys(f).sort(function(T,S){return T-S}),g=function(){var T,S,k;for(k=[],T=0,S=h.length;T<S;T++)o=h[T],k.push(f[o]);return k}(),i=this.font.glyf.encode(s,g,d),c=this.font.loca.encode(i.offsets,g),y={cmap:this.font.cmap.raw(),glyf:i.table,loca:c,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(y["OS/2"]=this.font.os2.raw()),this.font.directory.encode(y)},e}();St.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,a,i,s;if(Array.isArray(r))return"["+function(){var o,l,c;for(c=[],o=0,l=r.length;o<l;o++)n=r[o],c.push(t.convert(n));return c}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(a in i=["<<"],r)s=r[a],i.push("/"+a+" "+t.convert(s));return i.push(">>"),i.join(`
`)}return""+r},t}();const tJ=()=>{const{user:e}=ha(),[t,r]=U.useState({totalPurchases:0,totalPayments:0,totalGives:0,totalTakes:0,netOutstanding:0,supplierBreakdown:[],personBreakdown:[],pieChartData:[],categoryFilter:"suppliers"}),[n,a]=U.useState([]),[i,s]=U.useState([]),[o,l]=U.useState(!0),[c,f]=U.useState(""),[h,p]=U.useState(""),[d,x]=U.useState(!1);U.useEffect(()=>{const A=new Date,M=new Date(A);M.setDate(A.getDate()-30),f(M.toISOString().split("T")[0]),p(A.toISOString().split("T")[0])},[]),U.useEffect(()=>{c&&h&&g()},[e,c,h]),U.useEffect(()=>{const A=()=>{d&&x(!1)};return document.addEventListener("mousedown",A),()=>{document.removeEventListener("mousedown",A)}},[d]);const g=async A=>{if(!e)return;const M=t.categoryFilter;try{l(!0);const{data:O,error:I}=await Ye.from("transactions").select(`
          *,
          supplier:suppliers(name)
        `).eq("user_id",e.id).gte("created_at",c).lte("created_at",h+"T23:59:59").order("created_at",{ascending:!1});if(I)throw I;const{data:j,error:W}=await Ye.from("loan_transactions").select(`
          *,
          person:persons(name)
        `).eq("user_id",e.id).gte("created_at",c).lte("created_at",h+"T23:59:59").order("created_at",{ascending:!1});if(W)throw W;a(O||[]),s(j||[]);const E=new Map;let C=0,G=0;O==null||O.forEach(L=>{var xe;const F=((xe=L.supplier)==null?void 0:xe.name)||"Unknown",K=parseFloat(L.amount.toString());E.has(F)||E.set(F,{supplier:F,purchases:0,payments:0,outstanding:0});const ce=E.get(F);L.type==="new_purchase"?(ce.purchases+=K,C+=K,L.is_paid||(ce.outstanding+=K)):(L.type==="pay_due"||L.type==="settle_bill")&&(ce.payments+=K,G+=K,ce.outstanding-=K),E.set(F,ce)});const Z=new Map;let he=0,oe=0;j==null||j.forEach(L=>{var xe;const F=((xe=L.person)==null?void 0:xe.name)||"Unknown",K=parseFloat(L.amount.toString());Z.has(F)||Z.set(F,{person:F,gives:0,takes:0,outstanding:0});const ce=Z.get(F);L.type==="Gives"?(ce.gives+=K,he+=K,ce.outstanding+=K):L.type==="Takes"&&(ce.takes+=K,oe+=K,ce.outstanding-=K),Z.set(F,ce)});const me=Array.from(E.values()).sort((L,F)=>F.purchases-L.purchases),pe=Array.from(Z.values()).sort((L,F)=>F.gives-L.gives),ge=me.reduce((L,F)=>L+F.outstanding,0),Le=pe.reduce((L,F)=>L+F.outstanding,0),Se=ge+Le,N=["#3B82F6","#EF4444","#10B981","#F59E0B","#8B5CF6","#EC4899","#14B8A6","#F97316","#6366F1","#84CC16"];let D=[];M==="suppliers"?D=me.filter(L=>L.purchases>0).slice(0,5).map((L,F)=>({name:L.supplier,value:L.purchases,color:N[F%N.length]})):M==="persons"&&(D=pe.filter(L=>L.gives>0).slice(0,5).map((L,F)=>({name:L.person,value:L.gives,color:N[F%N.length]}))),r({totalPurchases:C,totalPayments:G,totalGives:he,totalTakes:oe,netOutstanding:Math.max(0,Se),supplierBreakdown:me,personBreakdown:pe,pieChartData:D,categoryFilter:M})}catch(O){console.error("Error fetching report data:",O)}finally{l(!1)}},y=()=>{const A=t.categoryFilter,M=["Date","Entity","Type","Description","Amount","Status","Transaction Type"];let O=[];if(A==="suppliers"){const C=n.map(G=>{var Z;return[new Date(G.created_at).toLocaleDateString("en-IN"),((Z=G.supplier)==null?void 0:Z.name)||"Unknown",S(G.type),G.description,parseFloat(G.amount.toString()),G.is_paid?"Paid":"Unpaid","Supplier"]});O=[...O,...C]}if(A==="persons"){const C=i.map(G=>{var Z;return[new Date(G.created_at).toLocaleDateString("en-IN"),((Z=G.person)==null?void 0:Z.name)||"Unknown",G.type,G.description||"",parseFloat(G.amount.toString()),"Completed","Person"]});O=[...O,...C]}const I=[M.join(","),...O.map(C=>C.map(G=>`"${G}"`).join(","))].join(`
`),j=new Blob([I],{type:"text/csv;charset=utf-8;"}),W=document.createElement("a"),E=URL.createObjectURL(j);W.setAttribute("href",E),W.setAttribute("download",`transactions-report-${c}-to-${h}.csv`),W.style.visibility="hidden",document.body.appendChild(W),W.click(),document.body.removeChild(W)},b=()=>{const A=t.categoryFilter;let M=[];if(A==="suppliers"){const W=n.map(E=>{var C;return{Date:new Date(E.created_at).toLocaleDateString("en-IN"),Entity:((C=E.supplier)==null?void 0:C.name)||"Unknown",Type:S(E.type),Description:E.description,Amount:parseFloat(E.amount.toString()),Status:E.is_paid?"Paid":"Unpaid","Transaction Type":"Supplier"}});M=[...M,...W]}if(A==="persons"){const W=i.map(E=>{var C;return{Date:new Date(E.created_at).toLocaleDateString("en-IN"),Entity:((C=E.person)==null?void 0:C.name)||"Unknown",Type:E.type,Description:E.description||"",Amount:parseFloat(E.amount.toString()),Status:"Completed","Transaction Type":"Person"}});M=[...M,...W]}const O=Qu.book_new();Qu.book_append_sheet(O,Qu.json_to_sheet(M),"Transactions");const I=[];A==="suppliers"&&I.push({Metric:"Total Purchases",Value:t.totalPurchases},{Metric:"Total Payments",Value:t.totalPayments}),A==="persons"&&I.push({Metric:"Total Gives",Value:t.totalGives},{Metric:"Total Takes",Value:t.totalTakes}),I.push({Metric:"Net Outstanding",Value:t.netOutstanding});const j=Qu.json_to_sheet(I);Qu.book_append_sheet(O,j,"Summary"),$V(O,`transactions-report-${c}-to-${h}.xlsx`)},T=()=>{const A=t.categoryFilter,M=new St;M.setFontSize(20),M.text(`${A==="suppliers"?"Supplier":"Person"} Transaction Report`,20,20),M.setFontSize(12),M.text(`Period: ${c} to ${h}`,20,35),M.setFontSize(14),M.text("Summary",20,55),M.setFontSize(10);let O=70;A==="suppliers"&&(M.text(`Total Purchases: ‚Çπ${t.totalPurchases.toLocaleString()}`,20,O),O+=10,M.text(`Total Payments: ‚Çπ${t.totalPayments.toLocaleString()}`,20,O),O+=10),A==="persons"&&(M.text(`Total Gives: ‚Çπ${t.totalGives.toLocaleString()}`,20,O),O+=10,M.text(`Total Takes: ‚Çπ${t.totalTakes.toLocaleString()}`,20,O),O+=10),M.text(`Net Outstanding: ‚Çπ${t.netOutstanding.toLocaleString()}`,20,O),O+=20,A==="suppliers"&&t.supplierBreakdown.length>0?(M.setFontSize(14),M.text("Top Suppliers by Purchases",20,O),M.setFontSize(10),O+=15,t.supplierBreakdown.slice(0,10).forEach((I,j)=>{O>270&&(M.addPage(),O=20),M.text(`${j+1}. ${I.supplier}: ‚Çπ${I.purchases.toLocaleString()}`,20,O),O+=10})):A==="persons"&&t.personBreakdown.length>0&&(M.setFontSize(14),M.text("Top Persons by Loans Given",20,O),M.setFontSize(10),O+=15,t.personBreakdown.slice(0,10).forEach((I,j)=>{O>270&&(M.addPage(),O=20),M.text(`${j+1}. ${I.person}: ‚Çπ${I.gives.toLocaleString()}`,20,O),O+=10})),M.save(`${A==="suppliers"?"supplier":"person"}-transaction-report-${c}-to-${h}.pdf`)},S=A=>{switch(A){case"new_purchase":return"New Purchase";case"pay_due":return"Payment";case"settle_bill":return"Settlement";default:return A}},k=A=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(A);return u.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Reports"}),u.jsx("p",{className:"text-gray-600 mt-1",children:"Analyze your supplier transactions and purchases"})]}),u.jsxs("div",{className:"relative export-dropdown",children:[u.jsxs("button",{onClick:()=>x(!d),disabled:n.length===0,className:"w-full sm:w-auto bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed",children:[u.jsx(Mc,{className:"h-4 w-4 mr-2"}),"Export"]}),d&&u.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-20",children:u.jsxs("div",{className:"py-2",children:[u.jsxs("button",{onClick:()=>{y(),x(!1)},className:"w-full text-left px-4 py-2 hover:bg-gray-50 flex items-center text-gray-700",children:[u.jsx(Nf,{className:"h-4 w-4 mr-3 text-green-600"}),"Export as CSV"]}),u.jsxs("button",{onClick:()=>{b(),x(!1)},className:"w-full text-left px-4 py-2 hover:bg-gray-50 flex items-center text-gray-700",children:[u.jsx(x8,{className:"h-4 w-4 mr-3 text-blue-600"}),"Export as Excel"]}),u.jsxs("button",{onClick:()=>{T(),x(!1)},className:"w-full text-left px-4 py-2 hover:bg-gray-50 flex items-center text-gray-700",children:[u.jsx(Mc,{className:"h-4 w-4 mr-3 text-red-600"}),"Export as PDF"]})]})})]})]}),u.jsx("div",{className:"border-b border-gray-200 mb-6",children:u.jsxs("nav",{className:"-mb-px flex space-x-8",children:[u.jsxs("button",{onClick:()=>{r(A=>({...A,categoryFilter:"suppliers"})),setTimeout(()=>g(),100)},className:`py-2 px-1 border-b-2 font-medium text-sm ${t.categoryFilter==="suppliers"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[u.jsx(wa,{className:"h-4 w-4 inline mr-2"}),"Suppliers"]}),u.jsxs("button",{onClick:()=>{r(A=>({...A,categoryFilter:"persons"})),setTimeout(()=>g(),100)},className:`py-2 px-1 border-b-2 font-medium text-sm ${t.categoryFilter==="persons"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[u.jsx(Sn,{className:"h-4 w-4 inline mr-2"}),"Persons"]})]})}),u.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:u.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:items-center sm:space-y-0 sm:space-x-4",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(e4,{className:"h-5 w-5 text-gray-400"}),u.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Filters"})]}),u.jsxs("div",{className:"flex flex-col space-y-3 sm:flex-row sm:items-center sm:space-y-0 sm:space-x-4",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(xl,{className:"h-4 w-4 text-gray-400"}),u.jsx("label",{className:"text-sm font-medium text-gray-700 min-w-max",children:"From:"}),u.jsx("input",{type:"date",value:c,onChange:A=>f(A.target.value),className:"flex-1 border border-gray-300 rounded-lg px-3 py-1.5 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("label",{className:"text-sm font-medium text-gray-700 min-w-max",children:"To:"}),u.jsx("input",{type:"date",value:h,onChange:A=>p(A.target.value),className:"flex-1 border border-gray-300 rounded-lg px-3 py-1.5 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]})}),o?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:[t.categoryFilter==="suppliers"&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:u.jsxs("div",{className:"flex items-center",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Purchases"}),u.jsx("p",{className:"text-xl sm:text-2xl font-bold text-blue-600",children:k(t.totalPurchases)})]}),u.jsx(I1,{className:"h-6 w-6 sm:h-8 sm:w-8 text-blue-600"})]})}),u.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:u.jsxs("div",{className:"flex items-center",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Payments"}),u.jsx("p",{className:"text-xl sm:text-2xl font-bold text-green-600",children:k(t.totalPayments)})]}),u.jsx(ly,{className:"h-6 w-6 sm:h-8 sm:w-8 text-green-600"})]})})]}),t.categoryFilter==="persons"&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:u.jsxs("div",{className:"flex items-center",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Gives"}),u.jsx("p",{className:"text-xl sm:text-2xl font-bold text-red-600",children:k(t.totalGives)})]}),u.jsx(I1,{className:"h-6 w-6 sm:h-8 sm:w-8 text-red-600"})]})}),u.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:u.jsxs("div",{className:"flex items-center",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Takes"}),u.jsx("p",{className:"text-xl sm:text-2xl font-bold text-green-600",children:k(t.totalTakes)})]}),u.jsx(ly,{className:"h-6 w-6 sm:h-8 sm:w-8 text-green-600"})]})})]}),u.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6 sm:col-span-2 lg:col-span-1",children:u.jsxs("div",{className:"flex items-center",children:[u.jsxs("div",{className:"flex-1",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Outstanding Amount"}),u.jsx("p",{className:"text-xl sm:text-2xl font-bold text-red-600",children:k(t.netOutstanding)})]}),u.jsx(Nc,{className:"h-6 w-6 sm:h-8 sm:w-8 text-red-600"})]})})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-4 sm:mb-6",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:t.categoryFilter==="suppliers"?"Purchase Distribution by Suppliers":"Loan Distribution by Persons"}),u.jsx("p",{className:"text-gray-600 mt-1 text-sm sm:text-base",children:t.categoryFilter==="suppliers"?"Shows purchase amounts from each supplier":"Shows loan amounts given to each person"})]}),u.jsx(cy,{className:"h-6 w-6 text-gray-400 mt-2 sm:mt-0"})]}),t.pieChartData.length>0?u.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-4 sm:gap-6",children:[u.jsx("div",{className:"h-64 sm:h-80",children:u.jsx(ZM,{width:"100%",height:"100%",children:u.jsxs(uU,{children:[u.jsx(N6,{data:t.pieChartData,cx:"50%",cy:"50%",outerRadius:80,fill:"#8884d8",dataKey:"value",children:t.pieChartData.map((A,M)=>u.jsx(Tp,{fill:A.color},`cell-${M}`))}),u.jsx(HM,{formatter:A=>[k(Number(A)),t.categoryFilter==="suppliers"?"Purchases":"Loans Given"],labelFormatter:A=>`${A}`})]})})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:t.categoryFilter==="suppliers"?"Top Suppliers":"Top Persons"}),u.jsx("div",{className:"space-y-3",children:t.pieChartData.slice(0,8).map(A=>u.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"w-4 h-4 rounded-full mr-3",style:{backgroundColor:A.color}}),u.jsx("span",{className:"font-medium text-gray-900",children:A.name})]}),u.jsx("span",{className:"text-gray-600 font-semibold",children:k(A.value)})]},A.name))})]})]}):u.jsxs("div",{className:"text-center py-12",children:[u.jsx(cy,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),u.jsx("p",{className:"text-gray-500",children:t.categoryFilter==="suppliers"?"No purchase data available for the selected period":"No loan data available for the selected period"})]})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-4 sm:mb-6",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Detailed Supplier Breakdown"}),u.jsx(Nc,{className:"h-5 w-5 text-gray-400 mt-2 sm:mt-0"})]}),t.supplierBreakdown.length>0?u.jsx("div",{className:"space-y-3 sm:space-y-4",children:t.supplierBreakdown.map((A,M)=>u.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 sm:p-4",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-3",children:[u.jsx("h3",{className:"font-medium text-gray-900 text-sm sm:text-base",children:A.supplier}),u.jsxs("span",{className:"text-xs sm:text-sm font-medium text-blue-600 mt-1 sm:mt-0",children:["Outstanding: ",k(A.outstanding)]})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-3 sm:gap-4 text-xs sm:text-sm",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-600",children:"Total Purchases"}),u.jsx("p",{className:"font-medium text-red-600",children:k(A.purchases)})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-gray-600",children:"Total Payments"}),u.jsx("p",{className:"font-medium text-green-600",children:k(A.payments)})]})]})]},M))}):u.jsxs("div",{className:"text-center py-6 sm:py-8",children:[u.jsx(Nc,{className:"h-10 w-10 sm:h-12 sm:w-12 text-gray-400 mx-auto mb-4"}),u.jsx("p",{className:"text-gray-500 text-sm sm:text-base",children:"No data available for the selected period"})]})]})]})]})};class pl{constructor(){this.isAuthenticated=!1,this.userEmail=""}static getInstance(){return pl.instance||(pl.instance=new pl),pl.instance}async initializeGoogleDrive(){console.log("Initializing Google Drive API...")}async authenticate(){try{return new Promise(t=>{setTimeout(()=>{this.isAuthenticated=!0,this.userEmail="user@gmail.com",t({success:!0,userEmail:this.userEmail})},2e3)})}catch(t){return console.error("Google Drive authentication failed:",t),{success:!1,userEmail:""}}}isConnected(){return this.isAuthenticated}getConnectedEmail(){return this.userEmail}async createBackup(t){try{return console.log("Creating backup on Google Drive...",t),new Promise(r=>{setTimeout(()=>{r({success:!0,fileId:`shopsynk-backup-${Date.now()}`})},3e3)})}catch(r){return console.error("Backup creation failed:",r),{success:!1}}}async scheduleAutoBackup(t){console.log("Auto backup scheduled for midnight daily");const r=new Date,n=new Date;n.setHours(24,0,0,0);const a=n.getTime()-r.getTime();setTimeout(()=>{t(),setInterval(t,24*60*60*1e3)},a)}disconnect(){this.isAuthenticated=!1,this.userEmail=""}}class ml{constructor(){this.googleDriveService=pl.getInstance()}static getInstance(){return ml.instance||(ml.instance=new ml),ml.instance}async exportUserData(t,r){try{const{data:n,error:a}=await Ye.from("suppliers").select("*").eq("user_id",t);if(a)throw a;const{data:i,error:s}=await Ye.from("transactions").select(`
          *,
          supplier:suppliers(name, contact_person, phone, email)
        `).eq("user_id",t);if(s)throw s;return{suppliers:n||[],transactions:i||[],exportDate:new Date().toISOString(),userEmail:r}}catch(n){return console.error("Error exporting user data:",n),null}}async createBackup(t,r){try{if(!this.googleDriveService.isConnected())return{success:!1,message:"Google Drive not connected. Please connect first."};const n=await this.exportUserData(t,r);if(!n)return{success:!1,message:"Failed to export user data."};const a=await this.googleDriveService.createBackup(n);return a.success?(await this.recordBackup(t,a.fileId||"",n),{success:!0,message:"Backup created successfully on Google Drive!"}):{success:!1,message:"Failed to upload backup to Google Drive."}}catch(n){return console.error("Backup creation error:",n),{success:!1,message:"An error occurred during backup creation."}}}async recordBackup(t,r,n){try{await Ye.from("user_backups").insert([{user_id:t,backup_date:new Date().toISOString(),google_drive_file_id:r,suppliers_count:n.suppliers.length,transactions_count:n.transactions.length,backup_size:JSON.stringify(n).length,status:"completed"}])}catch(a){console.error("Error recording backup:",a)}}async setupAutoBackup(t,r){const n=async()=>{console.log("Running automatic backup...");const a=await this.createBackup(t,r);console.log("Auto backup result:",a.message),await this.sendBackupNotification(r,a.success)};await this.googleDriveService.scheduleAutoBackup(n)}async sendBackupNotification(t,r){console.log(`Backup notification sent to ${t}: ${r?"Success":"Failed"}`)}async getBackupHistory(t){try{const{data:r,error:n}=await Ye.from("user_backups").select("*").eq("user_id",t).order("backup_date",{ascending:!1}).limit(10);if(n)throw n;return r||[]}catch(r){return console.error("Error fetching backup history:",r),[]}}downloadBackupFile(t){const r=JSON.stringify(t,null,2),n=new Blob([r],{type:"application/json"}),a=URL.createObjectURL(n),i=document.createElement("a");i.href=a,i.download=`shopsynk-backup-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(a)}}const rJ=()=>{const{user:e}=ha(),[t,r]=U.useState(null),[n,a]=U.useState(!0),[i,s]=U.useState("pdf"),[o,l]=U.useState(!1),[c,f]=U.useState(!1),[h,p]=U.useState("");U.useEffect(()=>{d()},[e]);const d=async()=>{if(e)try{a(!0);const{count:A}=await Ye.from("transactions").select("*",{count:"exact",head:!0}).eq("user_id",e.id),{count:M}=await Ye.from("suppliers").select("*",{count:"exact",head:!0}).eq("user_id",e.id),{count:O}=await Ye.from("business_owners").select("*",{count:"exact",head:!0}).eq("user_id",e.id),{data:I}=await Ye.from("user_backups").select("created_at").eq("user_id",e.id).order("created_at",{ascending:!1}).limit(1).single(),j=.5,W=.3,E=.2,C=.1,G=(A||0)*j,Z=(M||0)*W,he=(O||0)*E,oe=G+Z+he+C;r({totalTransactions:A||0,totalSuppliers:M||0,totalOwners:O||0,estimatedSizeKB:oe,lastBackup:(I==null?void 0:I.created_at)||null,dataBreakdown:{transactions:{count:A||0,sizeKB:G},suppliers:{count:M||0,sizeKB:Z},owners:{count:O||0,sizeKB:he},settings:{count:1,sizeKB:C}}})}catch(A){console.error("Error fetching storage stats:",A)}finally{a(!1)}},x=async A=>{if(e)try{l(!0);const[M,O,I]=await Promise.all([Ye.from("transactions").select("*, supplier:suppliers(name), owner:business_owners(owner_name)").eq("user_id",e.id).order("created_at",{ascending:!1}),Ye.from("suppliers").select("*").eq("user_id",e.id).order("name"),Ye.from("business_owners").select("*").eq("user_id",e.id).order("owner_name")]),j={exportDate:new Date().toISOString(),user:{id:e.id,email:e.email},summary:t,data:{transactions:M.data||[],suppliers:O.data||[],businessOwners:I.data||[]}};A==="json"?g(j):A==="csv"?y(j):A==="pdf"&&b(j)}catch(M){console.error("Error downloading data:",M),alert("Error downloading data. Please try again.")}finally{l(!1)}},g=A=>{const M=new Blob([JSON.stringify(A,null,2)],{type:"application/json"}),O=URL.createObjectURL(M),I=document.createElement("a");I.href=O,I.download=`shopsynk-data-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(I),I.click(),document.body.removeChild(I),URL.revokeObjectURL(O)},y=A=>{let M="Type,Supplier,Amount,Description,Date,Due Date,Status,Handled By\\n";A.data.transactions.forEach(W=>{var E,C;M+=`${W.type},"${((E=W.supplier)==null?void 0:E.name)||"Unknown"}",${W.amount},"${W.description}",${W.created_at},${W.due_date||""},${W.is_paid?"Paid":"Unpaid"},"${((C=W.owner)==null?void 0:C.owner_name)||"Unknown"}"\\n`});const O=new Blob([M],{type:"text/csv"}),I=URL.createObjectURL(O),j=document.createElement("a");j.href=I,j.download=`shopsynk-transactions-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(j),j.click(),document.body.removeChild(j),URL.revokeObjectURL(I)},b=A=>{const M=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Shopsynk Data Export</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 20px; }
          h1, h2 { color: #2563eb; }
          table { width: 100%; border-collapse: collapse; margin: 20px 0; }
          th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
          th { background-color: #f8f9fa; }
          .summary { background-color: #f0f9ff; padding: 15px; border-radius: 5px; margin: 20px 0; }
        </style>
      </head>
      <body>
        <h1>Shopsynk Data Export</h1>
        <p><strong>Export Date:</strong> ${new Date().toLocaleDateString()}</p>
        <p><strong>User:</strong> ${(e==null?void 0:e.email)||"Unknown"}</p>
        
        <div class="summary">
          <h2>Summary</h2>
          <p><strong>Total Transactions:</strong> ${t==null?void 0:t.totalTransactions}</p>
          <p><strong>Total Suppliers:</strong> ${t==null?void 0:t.totalSuppliers}</p>
          <p><strong>Total Owners:</strong> ${t==null?void 0:t.totalOwners}</p>
          <p><strong>Estimated Size:</strong> ${((t==null?void 0:t.estimatedSizeKB)||0).toFixed(2)} KB</p>
        </div>

        <h2>Recent Transactions</h2>
        <table>
          <tr>
            <th>Date</th>
            <th>Type</th>
            <th>Supplier</th>
            <th>Amount</th>
            <th>Status</th>
            <th>Handled By</th>
          </tr>
          ${A.data.transactions.slice(0,50).map(W=>{var E,C;return`
            <tr>
              <td>${new Date(W.created_at).toLocaleDateString()}</td>
              <td>${W.type}</td>
              <td>${((E=W.supplier)==null?void 0:E.name)||"Unknown"}</td>
              <td>‚Çπ${W.amount}</td>
              <td>${W.is_paid?"Paid":"Unpaid"}</td>
              <td>${((C=W.owner)==null?void 0:C.owner_name)||"Unknown"}</td>
            </tr>
          `}).join("")}
        </table>
      </body>
      </html>
    `,O=new Blob([M],{type:"text/html"}),I=URL.createObjectURL(O),j=document.createElement("a");j.href=I,j.download=`shopsynk-report-${new Date().toISOString().split("T")[0]}.html`,document.body.appendChild(j),j.click(),document.body.removeChild(j),URL.revokeObjectURL(I)},T=async()=>{if(e)try{f(!0),p("Preparing backup...");const A=ml.getInstance();p("Creating backup..."),await A.createBackup(e.id,e.email||"unknown@email.com"),p("Backup completed successfully!"),setTimeout(()=>p(""),3e3),await d()}catch(A){console.error("Error creating manual backup:",A),p("Backup failed. Please try again."),setTimeout(()=>p(""),3e3)}finally{f(!1)}},S=A=>A<1?`${(A*1024).toFixed(0)} bytes`:A<1024?`${A.toFixed(2)} KB`:`${(A/1024).toFixed(2)} MB`,k=A=>A?new Date(A).toLocaleString():"Never";return n?u.jsxs("div",{className:"flex items-center justify-center h-64",children:[u.jsx(Ss,{className:"h-8 w-8 animate-spin text-blue-500"}),u.jsx("span",{className:"ml-2 text-gray-600",children:"Loading storage information..."})]}):u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Data Storage & Export"}),u.jsxs("button",{onClick:d,className:"flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:[u.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[u.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx(O1,{className:"h-8 w-8 text-blue-500"}),u.jsxs("div",{className:"ml-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Storage"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:S((t==null?void 0:t.estimatedSizeKB)||0)})]})]})}),u.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx(Un,{className:"h-8 w-8 text-green-500"}),u.jsxs("div",{className:"ml-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Transactions"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t==null?void 0:t.totalTransactions})]})]})}),u.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx(uy,{className:"h-8 w-8 text-purple-500"}),u.jsxs("div",{className:"ml-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Suppliers"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t==null?void 0:t.totalSuppliers})]})]})}),u.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:u.jsxs("div",{className:"flex items-center",children:[u.jsx(wa,{className:"h-8 w-8 text-orange-500"}),u.jsxs("div",{className:"ml-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Business Owners"}),u.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t==null?void 0:t.totalOwners})]})]})})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Storage Breakdown"}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(Un,{className:"h-5 w-5 text-green-500 mr-3"}),u.jsx("span",{className:"font-medium",children:"Transactions Data"})]}),u.jsxs("div",{className:"text-right",children:[u.jsxs("p",{className:"font-medium",children:[t==null?void 0:t.dataBreakdown.transactions.count," records"]}),u.jsx("p",{className:"text-sm text-gray-500",children:S((t==null?void 0:t.dataBreakdown.transactions.sizeKB)||0)})]})]}),u.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(uy,{className:"h-5 w-5 text-purple-500 mr-3"}),u.jsx("span",{className:"font-medium",children:"Suppliers Data"})]}),u.jsxs("div",{className:"text-right",children:[u.jsxs("p",{className:"font-medium",children:[t==null?void 0:t.dataBreakdown.suppliers.count," records"]}),u.jsx("p",{className:"text-sm text-gray-500",children:S((t==null?void 0:t.dataBreakdown.suppliers.sizeKB)||0)})]})]}),u.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(wa,{className:"h-5 w-5 text-orange-500 mr-3"}),u.jsx("span",{className:"font-medium",children:"Business Owners"})]}),u.jsxs("div",{className:"text-right",children:[u.jsxs("p",{className:"font-medium",children:[t==null?void 0:t.dataBreakdown.owners.count," records"]}),u.jsx("p",{className:"text-sm text-gray-500",children:S((t==null?void 0:t.dataBreakdown.owners.sizeKB)||0)})]})]})]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Export Data"}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Export Format"}),u.jsxs("select",{value:i,onChange:A=>s(A.target.value),className:"w-full md:w-64 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[u.jsx("option",{value:"pdf",children:"PDF Report"}),u.jsx("option",{value:"csv",children:"CSV (Spreadsheet)"}),u.jsx("option",{value:"json",children:"JSON (Raw Data)"})]})]}),u.jsx("div",{className:"flex flex-wrap gap-3",children:u.jsxs("button",{onClick:()=>x(i),disabled:o,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[o?u.jsx(Ss,{className:"h-4 w-4 mr-2 animate-spin"}):u.jsx(Mc,{className:"h-4 w-4 mr-2"}),o?"Preparing...":`Download ${i.toUpperCase()}`]})}),u.jsxs("div",{className:"text-sm text-gray-500",children:[u.jsx("p",{children:"‚Ä¢ PDF: Formatted report with summary and recent transactions"}),u.jsx("p",{children:"‚Ä¢ CSV: Spreadsheet format for analysis and import"}),u.jsx("p",{children:"‚Ä¢ JSON: Complete raw data for technical use"})]})]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Backup Management"}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 rounded-lg border border-blue-200",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(Sc,{className:"h-6 w-6 text-blue-500 mr-3"}),u.jsxs("div",{children:[u.jsx("p",{className:"font-medium text-blue-900",children:"Last Backup"}),u.jsx("p",{className:"text-sm text-blue-700",children:k((t==null?void 0:t.lastBackup)||null)})]})]}),u.jsxs("button",{onClick:T,disabled:c,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[c?u.jsx(Ss,{className:"h-4 w-4 mr-2 animate-spin"}):u.jsx(v8,{className:"h-4 w-4 mr-2"}),c?"Creating Backup...":"Create Backup Now"]})]}),h&&u.jsxs("div",{className:`flex items-center p-3 rounded-lg ${h.includes("failed")?"bg-red-50 border border-red-200 text-red-700":h.includes("success")?"bg-green-50 border border-green-200 text-green-700":"bg-yellow-50 border border-yellow-200 text-yellow-700"}`,children:[h.includes("failed")?u.jsx(No,{className:"h-5 w-5 mr-2"}):h.includes("success")?u.jsx(ba,{className:"h-5 w-5 mr-2"}):u.jsx(Ss,{className:"h-5 w-5 mr-2 animate-spin"}),h]}),u.jsxs("div",{className:"text-sm text-gray-500",children:[u.jsx("p",{children:"‚Ä¢ Automatic backups run daily when configured"}),u.jsx("p",{children:"‚Ä¢ Manual backups are stored in your connected Google Drive"}),u.jsx("p",{children:"‚Ä¢ Configure automatic backups in your Profile settings"})]})]})]})]})},NT=[{id:"v1.3.2",version:"1.3.2",name:"Mobile Logout Enhancement",date:"September 24, 2025",type:"minor",color:"red",current:!0,description:"Enhanced mobile user experience with logout functionality accessible from the mobile navigation menu.",features:[{category:"Mobile User Experience",icon:ol,color:"red",items:["Added logout button to mobile More menu","Easy access to sign out functionality on mobile devices","Improved mobile navigation completeness","Consistent logout experience across all platforms","Enhanced mobile security and session management"]}],impact:"This minor update improves the mobile user experience by providing easy access to logout functionality. Users can now securely sign out of their account directly from the mobile navigation, ensuring better session management and security on mobile devices.",breaking:!1,migration:[]},{id:"v1.3",version:"1.3",name:"Person Money Tracking",date:"September 23, 2025",type:"major",color:"green",current:!1,description:"Introducing comprehensive person-to-person money tracking alongside supplier management for complete financial relationship management.",features:[{category:"Person Money Tracking",icon:Sn,color:"green",items:["Complete person-to-person money tracking system",'Track money given to persons ("Gives") and received from persons ("Takes")',"Personal loan and debt management capabilities","Outstanding balance tracking for each person","Comprehensive person transaction history"]},{category:"Enhanced Reports",icon:Nc,color:"blue",items:["Dual reporting system for suppliers and persons","Person transaction analytics and insights","Combined financial overview across all relationships","Export functionality for person transactions","Visual charts and breakdowns for personal finances"]},{category:"Navigation Improvements",icon:ol,color:"purple",items:["Added profile button to mobile more menu","Fixed person tab switching in reports","Improved navigation consistency across all sections","Enhanced mobile user experience","Better accessibility and touch targets"]}],impact:"This major update expands Shopsynk beyond supplier management to include comprehensive person-to-person financial tracking. Users can now manage both business supplier relationships and personal financial transactions in one unified platform, providing complete visibility into all financial relationships.",breaking:!1,migration:[]},{id:"v1.2",version:"1.2",name:"The Navigation Update",date:"September 5, 2025",type:"major",color:"purple",current:!1,description:"Complete mobile navigation redesign with enhanced user experience and comprehensive documentation.",features:[{category:"Mobile Navigation",icon:ol,color:"purple",items:["Complete mobile navigation redesign with bottom navigation bar","Replaced hamburger menu with thumb-friendly bottom navigation","Enhanced touch targets and gesture support","Improved mobile responsiveness across all pages","Optimized PWA experience for mobile devices"]},{category:"Documentation System",icon:r4,color:"blue",items:["Card-based documentation system with dedicated pages","Enhanced mobile experience guide","Comprehensive version history tracking","Interactive documentation navigation","Improved accessibility and user experience"]},{category:"User Experience",icon:hf,color:"green",items:["Mobile-first design philosophy implementation","Improved navigation patterns for better usability","Enhanced visual feedback and transitions","Better content organization and discovery","Responsive design improvements across all components"]}],impact:"This major update transforms Shopsynk into a truly mobile-first application with modern navigation patterns and comprehensive documentation. Users can now enjoy a seamless experience across all devices with improved accessibility and usability.",breaking:!1,migration:[]},{id:"v1.0",version:"1.00",name:"Initial Release",date:"September 1, 2025",type:"major",color:"blue",current:!1,description:"First stable release of Shopsynk with core supplier management functionality.",features:[{category:"Core Features",icon:i4,color:"blue",items:["Complete supplier management system","Transaction tracking with CRUD operations","Comprehensive reporting and analytics","Data backup and export functionality","PWA support with offline capabilities"]},{category:"User Interface",icon:_8,color:"green",items:["Clean and intuitive dashboard design","Responsive layout for desktop and mobile","Professional business-focused styling","Accessible form controls and navigation","Modern Material Design principles"]},{category:"Technical Foundation",icon:Gg,color:"orange",items:["React + TypeScript architecture","Supabase backend integration","Tailwind CSS styling system","Vite build tooling","Progressive Web App configuration"]}],impact:"Established the foundation for modern supplier management with essential features for tracking suppliers, managing transactions, and generating reports. Set the technical architecture for future enhancements.",breaking:!1,migration:[]},{id:"v0.9",version:"0.9",name:"Beta Release",date:"August 25, 2025",type:"minor",color:"orange",current:!1,description:"Feature-complete beta with testing and optimization focus.",features:[{category:"Testing & Quality",icon:ba,color:"green",items:["Comprehensive testing suite implementation","Performance optimization and profiling","Cross-browser compatibility testing","Security audit and vulnerability fixes","User acceptance testing completion"]},{category:"Documentation",icon:Nf,color:"blue",items:["Initial documentation structure","API documentation for developers","User guide and tutorials","Installation and setup instructions","FAQ and troubleshooting guides"]}],impact:"Finalized core functionality and ensured application stability through extensive testing. Prepared the foundation for public release.",breaking:!1,migration:[]},{id:"v0.5",version:"0.5",name:"Alpha Release",date:"August 15, 2025",type:"minor",color:"yellow",current:!1,description:"Initial alpha release with basic supplier management functionality.",features:[{category:"Basic Features",icon:Sn,color:"blue",items:["Basic supplier CRUD operations","Simple transaction recording","Basic reporting capabilities","User authentication system","Data persistence with Supabase"]},{category:"Development Setup",icon:a4,color:"gray",items:["Initial React application setup","TypeScript configuration","Basic styling with Tailwind CSS","Development tooling configuration","Version control and repository setup"]}],impact:"Established the basic foundation for supplier management with essential CRUD operations and user authentication.",breaking:!0,migration:["Initial setup required","Database schema creation"]}],nJ=({onVersionSelect:e,onBackToMain:t})=>u.jsxs("div",{className:"space-y-8",children:[u.jsxs("div",{className:"mb-8",children:[u.jsxs("button",{onClick:t,className:"flex items-center text-blue-600 hover:text-blue-800 mb-4",children:[u.jsx(_o,{className:"h-4 w-4 mr-2"}),"Back to Documentation"]}),u.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Version History & Updates"}),u.jsx("p",{className:"text-xl text-gray-600",children:"Complete changelog and development timeline"})]}),u.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 border border-blue-200 rounded-xl p-6 mb-8",children:[u.jsxs("div",{className:"flex items-center mb-3",children:[u.jsx(t4,{className:"h-6 w-6 text-blue-600 mr-3"}),u.jsxs("span",{className:"text-2xl font-bold text-gray-900",children:["Current Version: ",Bc()]}),u.jsx("span",{className:"ml-3 bg-green-500 text-white text-sm px-3 py-1 rounded-full",children:"LATEST"})]}),u.jsxs("p",{className:"text-gray-700",children:["Welcome to Shopsynk ",Bc()," - ",f4,"! This version introduces enhanced mobile navigation, improved user experience, and comprehensive documentation."]})]}),u.jsx("div",{className:"grid gap-6",children:NT.map(r=>{const n=i=>({purple:"bg-purple-500",blue:"bg-blue-500",orange:"bg-orange-500",yellow:"bg-yellow-500",green:"bg-green-500"})[i]||"bg-gray-500",a=i=>({purple:"border-purple-200 hover:border-purple-300",blue:"border-blue-200 hover:border-blue-300",orange:"border-orange-200 hover:border-orange-300",yellow:"border-yellow-200 hover:border-yellow-300",green:"border-green-200 hover:border-green-300"})[i]||"border-gray-200 hover:border-gray-300";return u.jsxs("div",{onClick:()=>e(r.id),className:`
                bg-white border-2 ${a(r.color)} rounded-xl p-6 
                cursor-pointer transition-all duration-200 hover:shadow-lg transform hover:scale-105
              `,children:[u.jsxs("div",{className:"flex items-center justify-between mb-4",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsxs("div",{className:`${n(r.color)} text-white text-sm font-semibold px-3 py-1 rounded-full mr-3`,children:["v",r.version]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:r.name}),u.jsx("p",{className:"text-sm text-gray-500",children:r.date})]})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[r.current&&u.jsx("span",{className:"bg-green-500 text-white text-xs px-2 py-1 rounded-full",children:"CURRENT"}),u.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${r.type==="major"?"bg-red-100 text-red-700":"bg-blue-100 text-blue-700"}`,children:r.type.toUpperCase()}),r.breaking&&u.jsx("span",{className:"bg-orange-100 text-orange-700 text-xs px-2 py-1 rounded-full",children:"BREAKING"})]})]}),u.jsx("p",{className:"text-gray-600 mb-4",children:r.description}),u.jsxs("div",{className:"space-y-3",children:[r.features.slice(0,2).map((i,s)=>u.jsxs("div",{className:"flex items-start space-x-3",children:[u.jsx(i.icon,{className:"h-5 w-5 text-gray-500 mt-0.5 flex-shrink-0"}),u.jsxs("div",{children:[u.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:i.category}),u.jsxs("p",{className:"text-xs text-gray-600",children:[i.items.length," updates"]})]})]},s)),r.features.length>2&&u.jsxs("div",{className:"text-sm text-blue-600 font-medium",children:["+",r.features.length-2," more categories"]})]}),u.jsxs("div",{className:"mt-4 flex items-center text-blue-600 font-semibold",children:[u.jsx("span",{children:"View Details"}),u.jsx(Zf,{className:"h-4 w-4 ml-2"})]})]},r.id)})})]}),aJ=({versionId:e,onBack:t})=>{const r=NT.find(a=>a.id===e);if(!r)return u.jsxs("div",{className:"text-center py-12",children:[u.jsxs("button",{onClick:t,className:"flex items-center text-blue-600 hover:text-blue-800 mb-4",children:[u.jsx(_o,{className:"h-4 w-4 mr-2"}),"Back to Version History"]}),u.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Version Not Found"}),u.jsx("p",{className:"text-gray-600",children:"The requested version could not be found."})]});const n=a=>({purple:"bg-purple-500",blue:"bg-blue-500",orange:"bg-orange-500",yellow:"bg-yellow-500",green:"bg-green-500"})[a]||"bg-gray-500";return u.jsxs("div",{className:"space-y-8",children:[u.jsxs("div",{className:"mb-8",children:[u.jsxs("button",{onClick:t,className:"flex items-center text-blue-600 hover:text-blue-800 mb-4",children:[u.jsx(_o,{className:"h-4 w-4 mr-2"}),"Back to Version History"]}),u.jsxs("div",{className:"flex items-center mb-4",children:[u.jsxs("div",{className:`${n(r.color)} text-white text-lg font-bold px-4 py-2 rounded-full mr-4`,children:["v",r.version]}),u.jsxs("div",{children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:r.name}),u.jsx("p",{className:"text-lg text-gray-600",children:r.date})]}),r.current&&u.jsx("span",{className:"ml-4 bg-green-500 text-white text-sm px-3 py-1 rounded-full",children:"CURRENT"})]}),u.jsx("p",{className:"text-xl text-gray-700 mb-6",children:r.description}),u.jsxs("div",{className:"flex items-center space-x-4",children:[u.jsxs("span",{className:`text-sm px-3 py-1 rounded-full ${r.type==="major"?"bg-red-100 text-red-700":"bg-blue-100 text-blue-700"}`,children:[r.type.toUpperCase()," RELEASE"]}),r.breaking&&u.jsx("span",{className:"bg-orange-100 text-orange-700 text-sm px-3 py-1 rounded-full",children:"BREAKING CHANGES"})]})]}),u.jsxs("div",{className:"space-y-6",children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"What's New in This Version"}),r.features.map((a,i)=>u.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[u.jsxs("div",{className:"flex items-center mb-4",children:[u.jsx(a.icon,{className:"h-8 w-8 text-blue-600 mr-3"}),u.jsx("h3",{className:"text-xl font-bold text-gray-900",children:a.category})]}),u.jsx("ul",{className:"space-y-2",children:a.items.map((s,o)=>u.jsxs("li",{className:"flex items-start",children:[u.jsx(ba,{className:"h-5 w-5 text-green-500 mr-3 mt-0.5 flex-shrink-0"}),u.jsx("span",{className:"text-gray-700",children:s})]},o))})]},i))]}),u.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-xl p-6",children:[u.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-3 flex items-center",children:[u.jsx(hf,{className:"h-6 w-6 text-blue-600 mr-3"}),"Impact & Benefits"]}),u.jsx("p",{className:"text-gray-700",children:r.impact})]}),r.breaking&&r.migration.length>0&&u.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-6",children:[u.jsxs("h3",{className:"text-xl font-bold text-orange-900 mb-3 flex items-center",children:[u.jsx(No,{className:"h-6 w-6 text-orange-600 mr-3"}),"Migration Guide"]}),u.jsx("ul",{className:"space-y-2",children:r.migration.map((a,i)=>u.jsxs("li",{className:"flex items-start",children:[u.jsx(Zf,{className:"h-5 w-5 text-orange-600 mr-3 mt-0.5 flex-shrink-0"}),u.jsx("span",{className:"text-orange-800",children:a})]},i))})]})]})},iJ=()=>{const[e,t]=U.useState(null),r=[{id:"overview",title:"Getting Started",description:"Learn the basics and get started with Shopsynk",icon:ff,color:"blue",topics:["Introduction","Key Features","System Requirements","Quick Setup"]},{id:"user-guide",title:"User Guide",description:"Complete step-by-step instructions for all features",icon:Nf,color:"green",topics:["Dashboard","Suppliers","Transactions","Reports","Data Management"]},{id:"mobile-guide",title:"Mobile Experience",description:"Using Shopsynk on mobile devices and PWA features",icon:ol,color:"purple",topics:["Mobile Navigation","PWA Installation","Offline Features","Touch Gestures"]},{id:"rules",title:"Policies & Rules",description:"Terms of service, privacy policy, and usage guidelines",icon:n4,color:"red",topics:["Privacy Policy","Terms of Service","Usage Guidelines","Data Security"]},{id:"contribute",title:"Developer Guide",description:"Contribute to the project and technical documentation",icon:a4,color:"indigo",topics:["Setup Environment","Code Standards","Pull Requests","API Reference"]},{id:"updates",title:"Version History",description:"Complete changelog and update history",icon:Oh,color:"orange",topics:["Recent Updates","Version Timeline","Breaking Changes","Migration Guide"]},{id:"about",title:"About & Support",description:"Learn about the developer and get support",icon:Sn,color:"teal",topics:["Developer Info","Contact Support","Community","Feedback"]}],n=(i,s="light")=>{var l;const o={blue:{light:"bg-blue-50 text-blue-700",dark:"bg-blue-600 text-white",border:"border-blue-200",hover:"hover:bg-blue-100 hover:border-blue-300"},green:{light:"bg-green-50 text-green-700",dark:"bg-green-600 text-white",border:"border-green-200",hover:"hover:bg-green-100 hover:border-green-300"},purple:{light:"bg-purple-50 text-purple-700",dark:"bg-purple-600 text-white",border:"border-purple-200",hover:"hover:bg-purple-100 hover:border-purple-300"},red:{light:"bg-red-50 text-red-700",dark:"bg-red-600 text-white",border:"border-red-200",hover:"hover:bg-red-100 hover:border-red-300"},indigo:{light:"bg-indigo-50 text-indigo-700",dark:"bg-indigo-600 text-white",border:"border-indigo-200",hover:"hover:bg-indigo-100 hover:border-indigo-300"},orange:{light:"bg-orange-50 text-orange-700",dark:"bg-orange-600 text-white",border:"border-orange-200",hover:"hover:bg-orange-100 hover:border-orange-300"},teal:{light:"bg-teal-50 text-teal-700",dark:"bg-teal-600 text-white",border:"border-teal-200",hover:"hover:bg-teal-100 hover:border-teal-300"}};return((l=o[i])==null?void 0:l[s])||o.blue[s]},a=i=>{switch(i){case"overview":return u.jsxs("div",{className:"space-y-8",children:[u.jsxs("div",{className:"mb-8",children:[u.jsxs("button",{onClick:()=>t(null),className:"flex items-center text-blue-600 hover:text-blue-800 mb-4",children:[u.jsx(_o,{className:"h-4 w-4 mr-2"}),"Back to Documentation"]}),u.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Getting Started with Shopsynk"}),u.jsx("p",{className:"text-xl text-gray-600",children:"Welcome to Shopsynk - your comprehensive supplier management solution"})]}),u.jsxs("div",{className:"grid gap-6",children:[u.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6",children:[u.jsxs("div",{className:"flex items-center mb-4",children:[u.jsx(hf,{className:"h-8 w-8 text-blue-600 mr-3"}),u.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"What is Shopsynk?"})]}),u.jsx("p",{className:"text-gray-700 mb-4",children:"Shopsynk is a modern, comprehensive supplier dues management system designed to help businesses efficiently track, manage, and maintain their supplier relationships and financial obligations. Built with cutting-edge web technologies, it offers a seamless experience across all devices."}),u.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[u.jsxs("div",{className:"bg-white/50 rounded-lg p-4",children:[u.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"üéØ Purpose"}),u.jsx("p",{className:"text-sm text-blue-800",children:"Streamline supplier relationship management and financial tracking"})]}),u.jsxs("div",{className:"bg-white/50 rounded-lg p-4",children:[u.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"‚ö° Performance"}),u.jsx("p",{className:"text-sm text-blue-800",children:"Fast, responsive PWA with offline capabilities"})]})]})]}),u.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[u.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-4 flex items-center",children:[u.jsx(pc,{className:"h-6 w-6 text-yellow-500 mr-3"}),"Key Features"]}),u.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:[{icon:i4,title:"Supplier Management",desc:"Complete supplier profiles and contact management"},{icon:I1,title:"Transaction Tracking",desc:"Record and monitor all financial transactions"},{icon:Nc,title:"Advanced Reports",desc:"Comprehensive analytics and reporting tools"},{icon:Sc,title:"Data Backup",desc:"Secure cloud backup and data export options"},{icon:ol,title:"Mobile PWA",desc:"Full mobile experience with app-like features"},{icon:Gg,title:"Customizable",desc:"Flexible settings and personalization options"}].map((s,o)=>u.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[u.jsx(s.icon,{className:"h-8 w-8 text-blue-600 mb-3"}),u.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:s.title}),u.jsx("p",{className:"text-sm text-gray-600",children:s.desc})]},o))})]}),u.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-6",children:[u.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-4 flex items-center",children:[u.jsx(ba,{className:"h-6 w-6 text-green-600 mr-3"}),"System Requirements"]}),u.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold text-green-900 mb-3",children:"Minimum Requirements"}),u.jsxs("ul",{className:"space-y-2 text-green-800",children:[u.jsxs("li",{className:"flex items-center",children:[u.jsx(ba,{className:"h-4 w-4 mr-2"}),"Modern web browser (Chrome 90+, Firefox 88+, Safari 14+)"]}),u.jsxs("li",{className:"flex items-center",children:[u.jsx(ba,{className:"h-4 w-4 mr-2"}),"Internet connection for sync and backup"]}),u.jsxs("li",{className:"flex items-center",children:[u.jsx(ba,{className:"h-4 w-4 mr-2"}),"JavaScript enabled"]}),u.jsxs("li",{className:"flex items-center",children:[u.jsx(ba,{className:"h-4 w-4 mr-2"}),"Local storage support (5MB+)"]})]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold text-green-900 mb-3",children:"Recommended Setup"}),u.jsxs("ul",{className:"space-y-2 text-green-800",children:[u.jsxs("li",{className:"flex items-center",children:[u.jsx(pc,{className:"h-4 w-4 mr-2"}),"Desktop/laptop for data entry"]}),u.jsxs("li",{className:"flex items-center",children:[u.jsx(pc,{className:"h-4 w-4 mr-2"}),"Mobile device for PWA installation"]}),u.jsxs("li",{className:"flex items-center",children:[u.jsx(pc,{className:"h-4 w-4 mr-2"}),"Stable internet for real-time sync"]}),u.jsxs("li",{className:"flex items-center",children:[u.jsx(pc,{className:"h-4 w-4 mr-2"}),"Regular backup schedule"]})]})]})]})]}),u.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-xl p-6",children:[u.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-4 flex items-center",children:[u.jsx(w8,{className:"h-6 w-6 text-purple-600 mr-3"}),"Quick Setup Guide"]}),u.jsx("div",{className:"space-y-4",children:[{step:1,title:"Create Account",desc:"Sign up with your email and create a secure password"},{step:2,title:"Complete Profile",desc:"Fill in your business information and preferences"},{step:3,title:"Add First Supplier",desc:"Create your first supplier profile with contact details"},{step:4,title:"Record Transaction",desc:"Add your first transaction to get familiar with the system"},{step:5,title:"Explore Features",desc:"Browse reports, settings, and advanced features"}].map(s=>u.jsxs("div",{className:"flex items-start space-x-4 bg-white rounded-lg p-4",children:[u.jsx("div",{className:"bg-purple-600 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm font-bold",children:s.step}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold text-gray-900",children:s.title}),u.jsx("p",{className:"text-gray-600 text-sm",children:s.desc})]})]},s.step))})]})]})]});case"mobile-guide":return u.jsxs("div",{className:"space-y-8",children:[u.jsxs("div",{className:"mb-8",children:[u.jsxs("button",{onClick:()=>t(null),className:"flex items-center text-blue-600 hover:text-blue-800 mb-4",children:[u.jsx(_o,{className:"h-4 w-4 mr-2"}),"Back to Documentation"]}),u.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Mobile Experience Guide"}),u.jsx("p",{className:"text-xl text-gray-600",children:"Get the most out of Shopsynk on mobile devices"})]}),u.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 border border-purple-200 rounded-xl p-6 mb-6",children:[u.jsxs("div",{className:"flex items-center mb-4",children:[u.jsx(ol,{className:"h-8 w-8 text-purple-600 mr-3"}),u.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Person Money Tracking v1.3"}),u.jsx("span",{className:"ml-3 bg-purple-500 text-white text-xs px-2 py-1 rounded-full",children:"NEW"})]}),u.jsx("p",{className:"text-gray-700 mb-4",children:'Version 1.3 introduces comprehensive person-to-person money tracking alongside supplier management. Track money given to persons ("Gives") and received from persons ("Takes") with complete transaction history, outstanding balance management, and integrated reporting. replacing the traditional hamburger menu with a modern bottom navigation bar for easier thumb-friendly access.'}),u.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[u.jsxs("div",{className:"bg-white/50 rounded-lg p-4",children:[u.jsx("h3",{className:"font-semibold text-purple-900 mb-2",children:"üéØ Bottom Navigation"}),u.jsx("p",{className:"text-sm text-purple-800",children:"Quick access to Dashboard, Suppliers, Transactions, and Reports"})]}),u.jsxs("div",{className:"bg-white/50 rounded-lg p-4",children:[u.jsx("h3",{className:"font-semibold text-purple-900 mb-2",children:"üì± Touch Optimized"}),u.jsx("p",{className:"text-sm text-purple-800",children:"Large touch targets and gesture-friendly interface design"})]})]})]}),u.jsxs("div",{className:"grid gap-6",children:[u.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6",children:[u.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-4 flex items-center",children:[u.jsx(Mc,{className:"h-6 w-6 text-blue-600 mr-3"}),"PWA Installation"]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"bg-white rounded-lg p-4",children:[u.jsx("h3",{className:"font-semibold mb-2",children:"üì± iOS Installation"}),u.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-sm text-gray-700",children:[u.jsx("li",{children:"Open Shopsynk in Safari browser"}),u.jsx("li",{children:"Tap the Share button (square with arrow)"}),u.jsx("li",{children:'Scroll down and tap "Add to Home Screen"'}),u.jsx("li",{children:'Customize the name and tap "Add"'})]})]}),u.jsxs("div",{className:"bg-white rounded-lg p-4",children:[u.jsx("h3",{className:"font-semibold mb-2",children:"ü§ñ Android Installation"}),u.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-sm text-gray-700",children:[u.jsx("li",{children:"Open Shopsynk in Chrome browser"}),u.jsx("li",{children:"Tap the menu (three dots) in the top right"}),u.jsx("li",{children:'Select "Add to Home screen"'}),u.jsx("li",{children:"Confirm the installation"})]})]})]})]}),u.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-6",children:[u.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-4 flex items-center",children:[u.jsx(y8,{className:"h-6 w-6 text-green-600 mr-3"}),"Offline Features"]}),u.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold text-green-900 mb-3",children:"Available Offline"}),u.jsxs("ul",{className:"space-y-2 text-green-800",children:[u.jsxs("li",{className:"flex items-center",children:[u.jsx(ba,{className:"h-4 w-4 mr-2"}),"View existing suppliers and transactions"]}),u.jsxs("li",{className:"flex items-center",children:[u.jsx(ba,{className:"h-4 w-4 mr-2"}),"Access cached reports and data"]}),u.jsxs("li",{className:"flex items-center",children:[u.jsx(ba,{className:"h-4 w-4 mr-2"}),"Browse documentation"]})]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold text-green-900 mb-3",children:"Requires Internet"}),u.jsxs("ul",{className:"space-y-2 text-green-800",children:[u.jsxs("li",{className:"flex items-center",children:[u.jsx(No,{className:"h-4 w-4 mr-2"}),"Adding new data"]}),u.jsxs("li",{className:"flex items-center",children:[u.jsx(No,{className:"h-4 w-4 mr-2"}),"Real-time sync"]}),u.jsxs("li",{className:"flex items-center",children:[u.jsx(No,{className:"h-4 w-4 mr-2"}),"Data backup"]})]})]})]})]}),u.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-6",children:[u.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-4 flex items-center",children:[u.jsx(hf,{className:"h-6 w-6 text-orange-600 mr-3"}),"Mobile Best Practices"]}),u.jsx("div",{className:"space-y-4",children:[{title:"Portrait Mode",tip:"Use portrait orientation for optimal experience"},{title:"Touch Gestures",tip:"Swipe left/right to navigate between sections"},{title:"Quick Actions",tip:"Long press on items for context menus"},{title:"Voice Input",tip:"Use voice input for faster data entry"},{title:"Auto-Save",tip:"Data is automatically saved as you type"}].map((s,o)=>u.jsxs("div",{className:"bg-white rounded-lg p-4 flex items-start space-x-3",children:[u.jsx(b8,{className:"h-5 w-5 text-orange-600 mt-0.5 flex-shrink-0"}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold text-orange-900",children:s.title}),u.jsx("p",{className:"text-sm text-orange-800",children:s.tip})]})]},o))})]})]})]});case"updates":return u.jsx(nJ,{onVersionSelect:s=>t(`version-detail-${s}`),onBackToMain:()=>t(null)});default:if(e&&e.startsWith("version-detail-")){const s=e.split("-")[2];return u.jsx(aJ,{versionId:s,onBack:()=>t("updates")})}return u.jsxs("div",{className:"text-center py-12",children:[u.jsx("div",{className:"mb-8",children:u.jsxs("button",{onClick:()=>t(null),className:"flex items-center text-blue-600 hover:text-blue-800 mb-4",children:[u.jsx(_o,{className:"h-4 w-4 mr-2"}),"Back to Documentation"]})}),u.jsx(ff,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),u.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Coming Soon"}),u.jsx("p",{className:"text-gray-600",children:"This section is under development."})]})}};return e?u.jsx("div",{className:"min-h-screen bg-gray-50 pb-20 md:pb-8",children:u.jsx("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:a(e)})}):u.jsx("div",{className:"min-h-screen bg-gray-50 pb-20 md:pb-8",children:u.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[u.jsxs("div",{className:"text-center mb-12",children:[u.jsxs("div",{className:"flex items-center justify-center mb-6",children:[u.jsx(ff,{className:"h-12 w-12 text-blue-600 mr-4"}),u.jsxs("div",{children:[u.jsx("h1",{className:"text-4xl font-bold text-gray-900",children:"Shopsynk Documentation"}),u.jsxs("p",{className:"text-xl text-gray-600 mt-2",children:["Complete guide for Shopsynk ",Bc()," - ",f4]})]})]}),u.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-xl p-6 mb-8",children:[u.jsxs("div",{className:"flex items-center justify-center mb-3",children:[u.jsx(t4,{className:"h-6 w-6 text-blue-600 mr-3"}),u.jsxs("span",{className:"text-2xl font-bold text-gray-900",children:["Version ",Bc()]}),u.jsx("span",{className:"ml-3 bg-green-500 text-white text-sm px-3 py-1 rounded-full",children:"LATEST"})]}),u.jsx("p",{className:"text-gray-700 max-w-3xl mx-auto",children:"Welcome to the comprehensive documentation for Shopsynk, your modern supplier management system. This version introduces enhanced mobile navigation, improved user experience, and complete documentation coverage."})]})]}),u.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12",children:r.map(i=>{const s=i.icon;return u.jsxs("div",{onClick:()=>t(i.id),className:`
                    bg-white border-2 ${n(i.color,"border")} rounded-xl p-6 
                    cursor-pointer transition-all duration-200 transform hover:scale-105 
                    hover:shadow-lg ${n(i.color,"hover")}
                  `,children:[u.jsxs("div",{className:"flex items-center mb-4",children:[u.jsx("div",{className:`${n(i.color,"dark")} rounded-lg p-3 mr-4`,children:u.jsx(s,{className:"h-6 w-6"})}),u.jsx("h3",{className:"text-xl font-bold text-gray-900",children:i.title})]}),u.jsx("p",{className:"text-gray-600 mb-4",children:i.description}),u.jsx("div",{className:"space-y-2",children:i.topics.map((o,l)=>u.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[u.jsx("div",{className:"w-1.5 h-1.5 bg-gray-400 rounded-full mr-3"}),o]},l))}),u.jsxs("div",{className:"mt-4 flex items-center text-blue-600 font-semibold",children:[u.jsx("span",{children:"Explore"}),u.jsx(Zf,{className:"h-4 w-4 ml-2"})]})]},i.id)})}),u.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-8",children:[u.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6 text-center",children:"Documentation Overview"}),u.jsxs("div",{className:"grid md:grid-cols-4 gap-6",children:[u.jsxs("div",{className:"text-center",children:[u.jsx(r4,{className:"h-8 w-8 text-blue-600 mx-auto mb-2"}),u.jsx("div",{className:"text-2xl font-bold text-gray-900",children:"7"}),u.jsx("div",{className:"text-sm text-gray-600",children:"Documentation Sections"})]}),u.jsxs("div",{className:"text-center",children:[u.jsx(hf,{className:"h-8 w-8 text-green-600 mx-auto mb-2"}),u.jsx("div",{className:"text-2xl font-bold text-gray-900",children:"25+"}),u.jsx("div",{className:"text-sm text-gray-600",children:"Topics Covered"})]}),u.jsxs("div",{className:"text-center",children:[u.jsx(ol,{className:"h-8 w-8 text-purple-600 mx-auto mb-2"}),u.jsx("div",{className:"text-2xl font-bold text-gray-900",children:"NEW"}),u.jsx("div",{className:"text-sm text-gray-600",children:"Mobile Logout"})]}),u.jsxs("div",{className:"text-center",children:[u.jsx(Oh,{className:"h-8 w-8 text-orange-600 mx-auto mb-2"}),u.jsx("div",{className:"text-2xl font-bold text-gray-900",children:"v1.3.2"}),u.jsx("div",{className:"text-sm text-gray-600",children:"Current Version"})]})]})]})]})})},sJ=()=>{const[e,t]=U.useState({total:0,read:0,unread:0,readPercentage:0}),[r,n]=U.useState(!1),[a,i]=U.useState(null);U.useEffect(()=>{s();const h=localStorage.getItem("last_notification_cleanup");h&&i(h)},[]);const s=async()=>{const h=await Ac.getNotificationStats();t(h)},o=async()=>{n(!0);try{await Ac.performFullCleanup();const h=new Date().toLocaleString();localStorage.setItem("last_notification_cleanup",h),i(h),setTimeout(s,1e3),alert("‚úÖ Database cleanup completed successfully!")}catch(h){console.error("Cleanup error:",h),alert("‚ùå Cleanup failed. Please try again.")}finally{n(!1)}},l=async()=>{n(!0);try{await Ac.cleanupReadNotifications(),setTimeout(s,1e3),alert("‚úÖ Quick cleanup completed!")}catch(h){console.error("Quick cleanup error:",h),alert("‚ùå Quick cleanup failed.")}finally{n(!1)}},f=e.total>500?{level:"high",message:"High storage usage detected. Recommend immediate cleanup.",color:"text-red-600 bg-red-50 border-red-200"}:e.total>200?{level:"medium",message:"Moderate storage usage. Consider cleanup.",color:"text-yellow-600 bg-yellow-50 border-yellow-200"}:{level:"low",message:"Storage usage is optimal.",color:"text-green-600 bg-green-50 border-green-200"};return u.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:u.jsx(Sc,{className:"w-5 h-5 text-blue-600"})}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Notification Storage"}),u.jsx("p",{className:"text-sm text-gray-500",children:"Manage database efficiency"})]})]}),u.jsx("button",{onClick:s,className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors",title:"Refresh stats",children:u.jsx(Ss,{className:"w-4 h-4"})})]}),u.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[u.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx(Nc,{className:"w-4 h-4 text-gray-500"}),u.jsx("span",{className:"text-sm text-gray-500",children:"Total"})]}),u.jsx("div",{className:"text-2xl font-bold text-gray-900 mt-1",children:e.total})]}),u.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),u.jsx("span",{className:"text-sm text-blue-600",children:"Unread"})]}),u.jsx("div",{className:"text-2xl font-bold text-blue-700 mt-1",children:e.unread})]}),u.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),u.jsx("span",{className:"text-sm text-green-600",children:"Read"})]}),u.jsx("div",{className:"text-2xl font-bold text-green-700 mt-1",children:e.read})]}),u.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),u.jsx("span",{className:"text-sm text-purple-600",children:"Read %"})]}),u.jsxs("div",{className:"text-2xl font-bold text-purple-700 mt-1",children:[e.readPercentage,"%"]})]})]}),u.jsxs("div",{className:`rounded-lg border p-4 mb-6 ${f.color}`,children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("div",{className:"w-2 h-2 rounded-full bg-current"}),u.jsx("span",{className:"font-medium",children:"Storage Status"})]}),u.jsx("p",{className:"text-sm mt-1",children:f.message})]}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h4",{className:"font-medium text-gray-900",children:"Full Cleanup"}),u.jsx("p",{className:"text-sm text-gray-500",children:"Remove old notifications, keep latest 100 per user"})]}),u.jsxs("button",{onClick:o,disabled:r,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2 transition-colors",children:[u.jsx(Sl,{className:"w-4 h-4"}),u.jsx("span",{children:r?"Cleaning...":"Full Cleanup"})]})]}),u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("h4",{className:"font-medium text-gray-900",children:"Quick Cleanup"}),u.jsx("p",{className:"text-sm text-gray-500",children:"Remove only read notifications older than 3 days"})]}),u.jsxs("button",{onClick:l,disabled:r,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2 transition-colors",children:[u.jsx(Oh,{className:"w-4 h-4"}),u.jsx("span",{children:r?"Cleaning...":"Quick Cleanup"})]})]})]}),a&&u.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:u.jsxs("p",{className:"text-xs text-gray-500",children:["Last cleanup: ",a]})}),u.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),u.jsx("span",{className:"text-sm text-gray-600",children:"Auto-cleanup active"})]}),u.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["‚Ä¢ Read notifications auto-deleted after 5 seconds",u.jsx("br",{}),"‚Ä¢ User notifications limited to 50 per user",u.jsx("br",{}),"‚Ä¢ Cleanup runs every 30 minutes"]})]})]})},oJ=({className:e=""})=>{const{user:t}=ha(),[r,n]=U.useState({supported:!1,permission:"default",subscribed:!1}),[a,i]=U.useState(!1);U.useEffect(()=>{s()},[]);const s=async()=>{const c=await mo.getSubscriptionStatus();n(c)},o=async()=>{if(t!=null&&t.id){i(!0);try{if(!await mo.initialize())throw new Error("Push notifications not supported");if(!await mo.requestPermission())throw new Error("Permission denied");if(!await mo.subscribe(t.id))throw new Error("Failed to subscribe");await s()}catch(c){console.error("Failed to enable push notifications:",c),alert("Failed to enable push notifications. Please try again.")}i(!1)}},l=async()=>{if(t!=null&&t.id){i(!0);try{if(!await mo.unsubscribe(t.id))throw new Error("Failed to unsubscribe");await s()}catch(c){console.error("Failed to disable push notifications:",c),alert("Failed to disable push notifications. Please try again.")}i(!1)}};return r.supported?u.jsxs("div",{className:`bg-white border border-gray-200 rounded-lg p-4 ${e}`,children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"flex-shrink-0",children:r.subscribed?u.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:u.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{d:"M10 2a6 6 0 00-6 6v3.586l-.707.707A1 1 0 004 14h12a1 1 0 00.707-1.707L16 11.586V8a6 6 0 00-6-6zM10 18a3 3 0 01-3-3h6a3 3 0 01-3 3z"})})}):u.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center",children:u.jsxs("svg",{className:"w-5 h-5 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:[u.jsx("path",{fillRule:"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM15.657 6.343a1 1 0 011.414 0A9.972 9.972 0 0119 12a9.972 9.972 0 01-1.929 5.657 1 1 0 11-1.414-1.414A7.971 7.971 0 0017 12a7.971 7.971 0 00-1.343-4.243 1 1 0 010-1.414z",clipRule:"evenodd"}),u.jsx("path",{fillRule:"evenodd",d:"M13.828 8.172a1 1 0 011.414 0A5.983 5.983 0 0117 12a5.983 5.983 0 01-1.758 3.828 1 1 0 11-1.414-1.414A3.987 3.987 0 0015 12a3.987 3.987 0 00-1.172-2.828 1 1 0 010-1.414z",clipRule:"evenodd"})]})})}),u.jsxs("div",{className:"ml-3",children:[u.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Push Notifications"}),u.jsx("p",{className:"text-sm text-gray-600",children:r.subscribed?"Get notified even when the app is closed":"Enable to receive notifications when app is closed"}),u.jsxs("div",{className:"mt-1 flex items-center space-x-4 text-xs text-gray-500",children:[u.jsxs("span",{children:["Permission: ",r.permission]}),u.jsxs("span",{children:["Status: ",r.subscribed?"Active":"Inactive"]})]})]})]}),u.jsx("div",{className:"flex-shrink-0",children:r.permission==="denied"?u.jsxs("div",{className:"text-xs text-red-600 text-right",children:[u.jsx("p",{children:"Permission denied."}),u.jsx("p",{children:"Please enable in browser settings."})]}):u.jsxs("button",{onClick:r.subscribed?l:o,disabled:a,className:`inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 ${r.subscribed?"text-red-700 bg-red-100 hover:bg-red-200 focus:ring-red-500":"text-white bg-amber-600 hover:bg-amber-700 focus:ring-amber-500"} disabled:opacity-50 disabled:cursor-not-allowed transition-colors`,children:[a?u.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-current",fill:"none",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"m4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):null,r.subscribed?"Disable":"Enable"]})})]}),r.subscribed&&u.jsx("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded-md",children:u.jsxs("div",{className:"flex",children:[u.jsx("div",{className:"flex-shrink-0",children:u.jsx("svg",{className:"h-5 w-5 text-green-400",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),u.jsx("div",{className:"ml-3",children:u.jsx("p",{className:"text-sm text-green-800",children:"‚ú® You'll receive notifications for new transactions, payments, and supplier updates even when the app is closed!"})})]})})]}):u.jsx("div",{className:`bg-gray-50 border border-gray-200 rounded-lg p-4 ${e}`,children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"flex-shrink-0",children:u.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:u.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),u.jsxs("div",{className:"ml-3",children:[u.jsx("h3",{className:"text-sm font-medium text-gray-800",children:"Push notifications not supported"}),u.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Your browser doesn't support push notifications."})]})]})})},lJ=()=>{const{user:e}=ha(),[t,r]=U.useState({suppliersCount:0,transactionsCount:0,totalOutstanding:0,lastLogin:""}),[n,a]=U.useState(!0),[i,s]=U.useState({isConnected:!1,userEmail:"",lastBackup:"",autoBackupEnabled:!0}),[o,l]=U.useState([]),[c,f]=U.useState(!1),[h,p]=U.useState(!1),[d,x]=U.useState(""),g=ml.getInstance(),y=pl.getInstance(),b=Ts.getInstance(),[T,S]=U.useState([]),[k,A]=U.useState([]),[M,O]=U.useState(!1),[I,j]=U.useState(null),[W,E]=U.useState({owner_name:"",role:"Owner"}),[C,G]=U.useState("");U.useEffect(()=>{xe(),he(),oe(),Z()},[e]);const Z=async()=>{var le;if(e)try{await b.ensurePrimaryOwner(e.id,e.email,(le=e.user_metadata)==null?void 0:le.full_name);const ue=await b.getBusinessOwners(e.id);S(ue);const $e=await b.getOwnerStats(e.id);A($e)}catch(ue){console.error("Error loading business owners:",ue),G("Error loading business owners.")}},he=async()=>{if(e)try{const{data:le,error:ue}=await Ye.from("user_settings").select("*").eq("user_id",e.id).single();if(ue&&ue.code!=="PGRST116")throw ue;le&&s({isConnected:le.google_drive_connected||!1,userEmail:le.google_drive_email||"",lastBackup:le.last_backup_date||"",autoBackupEnabled:le.auto_backup_enabled||!0})}catch(le){console.error("Error loading Google Drive settings:",le)}},oe=async()=>{if(e)try{const le=await g.getBackupHistory(e.id);l(le)}catch(le){console.error("Error loading backup history:",le)}},me=async()=>{f(!0),x("");try{const le=await y.authenticate();le.success?(await Ye.from("user_settings").upsert({user_id:e==null?void 0:e.id,google_drive_connected:!0,google_drive_email:le.userEmail,updated_at:new Date().toISOString()}),s(ue=>({...ue,isConnected:!0,userEmail:le.userEmail})),x("Successfully connected to Google Drive!"),await g.setupAutoBackup(e.id,e.email)):x("Failed to connect to Google Drive. Please try again.")}catch(le){console.error("Google Drive connection error:",le),x("An error occurred while connecting to Google Drive.")}finally{f(!1)}},pe=async()=>{try{y.disconnect(),await Ye.from("user_settings").upsert({user_id:e==null?void 0:e.id,google_drive_connected:!1,google_drive_email:null,updated_at:new Date().toISOString()}),s(le=>({...le,isConnected:!1,userEmail:""})),x("Disconnected from Google Drive.")}catch(le){console.error("Error disconnecting Google Drive:",le),x("Error disconnecting from Google Drive.")}},ge=async()=>{if(e){p(!0),x("");try{const le=await g.createBackup(e.id,e.email);x(le.message),le.success&&(await oe(),await he())}catch(le){console.error("Manual backup error:",le),x("An error occurred during backup.")}finally{p(!1)}}},Le=async()=>{if(e)try{const le=await g.exportUserData(e.id,e.email);le?(g.downloadBackupFile(le),x("Backup file downloaded successfully!")):x("Failed to create backup file.")}catch(le){console.error("Download backup error:",le),x("Error creating backup file.")}},Se=async()=>{if(e)try{const le=!i.autoBackupEnabled;await Ye.from("user_settings").upsert({user_id:e.id,auto_backup_enabled:le,updated_at:new Date().toISOString()}),s(ue=>({...ue,autoBackupEnabled:le})),x(`Auto backup ${le?"enabled":"disabled"}.`)}catch(le){console.error("Error toggling auto backup:",le),x("Error updating auto backup setting.")}},N=async le=>{if(le.preventDefault(),!!e)try{const ue=await b.createBusinessOwner(e.id,W);ue.success?(G("Owner added successfully!"),await Z(),K()):G(`Error: ${ue.error}`)}catch(ue){console.error("Error adding owner:",ue),G("An error occurred while adding the owner.")}},D=le=>{j(le),E({owner_name:le.owner_name,role:le.role}),O(!0)},L=async le=>{if(le.preventDefault(),!!I)try{const ue=await b.updateBusinessOwner(I.id,W);ue.success?(G("Owner updated successfully!"),await Z(),K()):G(`Error: ${ue.error}`)}catch(ue){console.error("Error updating owner:",ue),G("An error occurred while updating the owner.")}},F=async le=>{if(confirm("Are you sure you want to remove this owner? This action cannot be undone."))try{const ue=await b.deactivateBusinessOwner(le);ue.success?(G("Owner removed successfully."),await Z()):G(`Error: ${ue.error}`)}catch(ue){console.error("Error removing owner:",ue),G("An error occurred while removing the owner.")}},K=()=>{E({owner_name:"",role:"Owner"}),j(null),O(!1)},ce=le=>k.find(ue=>ue.owner_id===le)||{total_transactions:0,total_purchases:0,total_payments:0,total_purchase_amount:0,total_payment_amount:0},xe=async()=>{if(e)try{const{count:le}=await Ye.from("suppliers").select("*",{count:"exact",head:!0}).eq("user_id",e.id),{count:ue}=await Ye.from("transactions").select("*",{count:"exact",head:!0}).eq("user_id",e.id),{data:$e}=await Ye.from("transactions").select("type, amount, is_paid").eq("user_id",e.id);let ye=0;$e==null||$e.forEach(Q=>{Q.type==="new_purchase"&&!Q.is_paid?ye+=parseFloat(Q.amount.toString()):(Q.type==="pay_due"||Q.type==="settle_bill")&&(ye-=parseFloat(Q.amount.toString()))}),r({suppliersCount:le||0,transactionsCount:ue||0,totalOutstanding:Math.max(0,ye),lastLogin:e.last_sign_in_at||e.created_at||""})}catch(le){console.error("Error fetching user stats:",le)}finally{a(!1)}},ee=le=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(le),fe=le=>new Date(le).toLocaleDateString("en-IN",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return n?u.jsx("div",{className:"flex items-center justify-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Profile"}),u.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your account settings and view activity"})]}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Account Information"}),u.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:u.jsx(Sn,{className:"h-6 w-6 text-blue-600"})})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[u.jsx(Al,{className:"h-5 w-5 text-gray-400"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-600",children:"Email Address"}),u.jsx("p",{className:"font-medium text-gray-900",children:e==null?void 0:e.email})]})]}),u.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[u.jsx(n4,{className:"h-5 w-5 text-gray-400"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-600",children:"Account Status"}),u.jsx("p",{className:"font-medium text-green-600",children:"Active"})]})]}),u.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[u.jsx(xl,{className:"h-5 w-5 text-gray-400"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-600",children:"Account Created"}),u.jsx("p",{className:"font-medium text-gray-900",children:e!=null&&e.created_at?fe(e.created_at):"N/A"})]})]}),t.lastLogin&&u.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[u.jsx(xl,{className:"h-5 w-5 text-gray-400"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-600",children:"Last Sign In"}),u.jsx("p",{className:"font-medium text-gray-900",children:fe(t.lastLogin)})]})]})]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Activity Summary"}),u.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:u.jsx(Sc,{className:"h-6 w-6 text-green-600"})})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsx("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"Total Suppliers"}),u.jsx("p",{className:"text-2xl font-bold text-blue-700",children:t.suppliersCount})]})}),u.jsx("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-green-600 font-medium",children:"Total Transactions"}),u.jsx("p",{className:"text-2xl font-bold text-green-700",children:t.transactionsCount})]})}),u.jsx("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-lg",children:u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-red-600 font-medium",children:"Outstanding Amount"}),u.jsx("p",{className:"text-2xl font-bold text-red-700",children:ee(t.totalOutstanding)})]})})]})]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center",children:u.jsx(wa,{className:"h-6 w-6 text-purple-600"})}),u.jsxs("div",{children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Business Owners"}),u.jsx("p",{className:"text-sm text-gray-600",children:"Manage owners and track their activities"})]})]}),u.jsxs("button",{onClick:()=>O(!0),className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors flex items-center",children:[u.jsx(N8,{className:"h-4 w-4 mr-2"}),"Add Owner"]})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:T.map(le=>{const ue=ce(le.id);return u.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[u.jsxs("div",{className:"flex items-start justify-between mb-3",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:le.is_primary?u.jsx(pc,{className:"h-5 w-5 text-yellow-500"}):u.jsx(Sn,{className:"h-5 w-5 text-purple-600"})}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-semibold text-gray-900",children:le.owner_name}),u.jsx("p",{className:"text-sm text-gray-600",children:le.role}),le.is_primary&&u.jsx("span",{className:"text-xs bg-yellow-100 text-yellow-700 px-2 py-1 rounded-full",children:"Primary"})]})]}),!le.is_primary&&u.jsxs("div",{className:"flex space-x-1",children:[u.jsx("button",{onClick:()=>D(le),className:"p-1 text-gray-400 hover:text-blue-600 rounded",title:"Edit owner",children:u.jsx(vc,{className:"h-4 w-4"})}),u.jsx("button",{onClick:()=>F(le.id),className:"p-1 text-gray-400 hover:text-red-600 rounded",title:"Remove owner",children:u.jsx(Sl,{className:"h-4 w-4"})})]})]}),u.jsx("div",{className:"mt-4 pt-3 border-t border-gray-200",children:u.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[u.jsxs("div",{className:"text-center",children:[u.jsx("p",{className:"text-blue-600 font-medium",children:ue.total_purchases}),u.jsx("p",{className:"text-gray-500",children:"Purchases"})]}),u.jsxs("div",{className:"text-center",children:[u.jsx("p",{className:"text-green-600 font-medium",children:ue.total_payments}),u.jsx("p",{className:"text-gray-500",children:"Payments"})]}),u.jsxs("div",{className:"col-span-2 text-center",children:[u.jsx("p",{className:"text-purple-600 font-medium",children:ee(ue.total_purchase_amount-ue.total_payment_amount)}),u.jsx("p",{className:"text-gray-500",children:"Net Activity"})]})]})})]},le.id)})}),T.length===0&&u.jsxs("div",{className:"text-center py-8",children:[u.jsx(wa,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),u.jsx("p",{className:"text-gray-500",children:"No business owners found"}),u.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Add owners to track who handles transactions"})]})]}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Google Drive Backup"}),u.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:u.jsx(fy,{className:"h-6 w-6 text-blue-600"})})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[i.isConnected?u.jsx(ba,{className:"h-5 w-5 text-green-500"}):u.jsx(wm,{className:"h-5 w-5 text-red-500"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-600",children:"Connection Status"}),u.jsx("p",{className:`font-medium ${i.isConnected?"text-green-600":"text-red-600"}`,children:i.isConnected?"Connected":"Not Connected"}),i.isConnected&&i.userEmail&&u.jsx("p",{className:"text-xs text-gray-500",children:i.userEmail})]})]}),i.isConnected&&u.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx(Oh,{className:"h-5 w-5 text-gray-400"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-600",children:"Auto Backup"}),u.jsx("p",{className:"text-xs text-gray-500",children:"Daily at midnight"})]})]}),u.jsx("button",{onClick:Se,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${i.autoBackupEnabled?"bg-blue-600":"bg-gray-200"}`,children:u.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${i.autoBackupEnabled?"translate-x-6":"translate-x-1"}`})})]}),i.lastBackup&&u.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[u.jsx(xl,{className:"h-5 w-5 text-gray-400"}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm text-gray-600",children:"Last Backup"}),u.jsx("p",{className:"font-medium text-gray-900",children:fe(i.lastBackup)})]})]}),u.jsx("div",{className:"flex space-x-3",children:i.isConnected?u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:ge,disabled:h,className:"flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors disabled:bg-green-400 flex items-center justify-center",children:h?u.jsxs(u.Fragment,{children:[u.jsx(Ss,{className:"h-4 w-4 mr-2 animate-spin"}),"Backing up..."]}):u.jsxs(u.Fragment,{children:[u.jsx(Sc,{className:"h-4 w-4 mr-2"}),"Backup Now"]})}),u.jsx("button",{onClick:pe,className:"px-4 py-2 border border-red-300 text-red-600 rounded-lg hover:bg-red-50 transition-colors",children:"Disconnect"})]}):u.jsx("button",{onClick:me,disabled:c,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors disabled:bg-blue-400 flex items-center justify-center",children:c?u.jsxs(u.Fragment,{children:[u.jsx(Ss,{className:"h-4 w-4 mr-2 animate-spin"}),"Connecting..."]}):u.jsxs(u.Fragment,{children:[u.jsx(fy,{className:"h-4 w-4 mr-2"}),"Connect Google Drive"]})})}),u.jsxs("button",{onClick:Le,className:"w-full bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 transition-colors flex items-center justify-center",children:[u.jsx(Mc,{className:"h-4 w-4 mr-2"}),"Download Local Backup"]})]})]}),u.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[u.jsxs("div",{className:"flex items-center justify-between mb-6",children:[u.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Backup History"}),u.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:u.jsx(Gg,{className:"h-6 w-6 text-green-600"})})]}),u.jsx("div",{className:"space-y-3",children:o.length>0?o.slice(0,5).map(le=>u.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[u.jsxs("div",{className:"flex items-center space-x-3",children:[u.jsx("div",{className:`w-3 h-3 rounded-full ${le.status==="completed"?"bg-green-500":le.status==="failed"?"bg-red-500":"bg-yellow-500"}`}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium text-gray-900",children:fe(le.backup_date)}),u.jsxs("p",{className:"text-xs text-gray-500",children:[le.suppliers_count," suppliers, ",le.transactions_count," transactions"]})]})]}),u.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${le.status==="completed"?"bg-green-100 text-green-700":le.status==="failed"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:le.status})]},le.id)):u.jsxs("div",{className:"text-center py-8",children:[u.jsx(Sc,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),u.jsx("p",{className:"text-gray-500",children:"No backups yet"}),u.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Connect Google Drive to start automatic backups"})]})})]})]}),d&&u.jsx("div",{className:`border rounded-lg p-4 ${d.includes("Success")||d.includes("successfully")?"bg-green-50 border-green-200":d.includes("Error")||d.includes("Failed")?"bg-red-50 border-red-200":"bg-blue-50 border-blue-200"}`,children:u.jsxs("div",{className:"flex items-start space-x-3",children:[d.includes("Success")||d.includes("successfully")?u.jsx(ba,{className:"h-5 w-5 text-green-600 mt-0.5"}):d.includes("Error")||d.includes("Failed")?u.jsx(wm,{className:"h-5 w-5 text-red-600 mt-0.5"}):u.jsx(No,{className:"h-5 w-5 text-blue-600 mt-0.5"}),u.jsx("div",{children:u.jsx("p",{className:`text-sm font-medium ${d.includes("Success")||d.includes("successfully")?"text-green-800":d.includes("Error")||d.includes("Failed")?"text-red-800":"text-blue-800"}`,children:d})})]})}),C&&u.jsx("div",{className:`border rounded-lg p-4 ${C.includes("Success")||C.includes("successfully")?"bg-green-50 border-green-200":C.includes("Error")||C.includes("Failed")?"bg-red-50 border-red-200":"bg-blue-50 border-blue-200"}`,children:u.jsxs("div",{className:"flex items-start space-x-3",children:[C.includes("Success")||C.includes("successfully")?u.jsx(ba,{className:"h-5 w-5 text-green-600 mt-0.5"}):C.includes("Error")||C.includes("Failed")?u.jsx(wm,{className:"h-5 w-5 text-red-600 mt-0.5"}):u.jsx(No,{className:"h-5 w-5 text-blue-600 mt-0.5"}),u.jsx("div",{children:u.jsx("p",{className:`text-sm font-medium ${C.includes("Success")||C.includes("successfully")?"text-green-800":C.includes("Error")||C.includes("Failed")?"text-red-800":"text-blue-800"}`,children:C})})]})}),M&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:u.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:I?"Edit Owner":"Add New Owner"}),u.jsxs("form",{onSubmit:I?L:N,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Owner Name *"}),u.jsx("input",{type:"text",required:!0,value:W.owner_name,onChange:le=>E({...W,owner_name:le.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",placeholder:"Enter owner's full name"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role/Title"}),u.jsx("input",{type:"text",value:W.role,onChange:le=>E({...W,role:le.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",placeholder:"e.g., Owner, Partner, Manager"})]}),u.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[u.jsx("button",{type:"button",onClick:K,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:I?"Update Owner":"Add Owner"})]})]})]})}),u.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[u.jsxs("div",{children:[u.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[u.jsx(k1,{className:"h-5 w-5 mr-2 text-amber-600"}),"Push Notifications"]}),u.jsx(oJ,{})]}),u.jsx(sJ,{})]}),u.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:u.jsxs("div",{className:"flex items-start space-x-3",children:[u.jsx(No,{className:"h-5 w-5 text-yellow-600 mt-0.5"}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Security Notice"}),u.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:"Your data is securely stored and encrypted. Always sign out when using shared devices. If you notice any unusual activity, please contact support immediately."})]})]})})]})};function cJ(){const[e,t]=U.useState(!1);return U.useEffect(()=>{(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0||document.referrer.includes("android-app://")||window.location.search.includes("utm_source=pwa")||localStorage.getItem("shopsynk_first_launch")===null||window.location.search.includes("show_splash=true"))&&(t(!0),localStorage.setItem("shopsynk_first_launch","false")),M1.requestNotificationPermission()},[]),e?u.jsx(Oj,{onComplete:()=>t(!1)}):u.jsx(O8,{children:u.jsx(F8,{children:u.jsx(f8,{children:u.jsxs("div",{className:"App",children:[u.jsx(Lj,{}),u.jsxs(ay,{children:[u.jsx(va,{path:"/login",element:u.jsx(Fj,{})}),u.jsx(va,{path:"/register",element:u.jsx(Dj,{})}),u.jsx(va,{path:"/*",element:u.jsx(D8,{children:u.jsx(Cj,{children:u.jsxs(ay,{children:[u.jsx(va,{path:"/",element:u.jsx(Ij,{})}),u.jsx(va,{path:"/suppliers",element:u.jsx(Mj,{})}),u.jsx(va,{path:"/suppliers/:id",element:u.jsx(Rj,{})}),u.jsx(va,{path:"/persons",element:u.jsx(Bj,{})}),u.jsx(va,{path:"/persons/:id",element:u.jsx(Uj,{})}),u.jsx(va,{path:"/transactions",element:u.jsx(zj,{})}),u.jsx(va,{path:"/reports",element:u.jsx(tJ,{})}),u.jsx(va,{path:"/data-storage",element:u.jsx(rJ,{})}),u.jsx(va,{path:"/documentation",element:u.jsx(iJ,{})}),u.jsx(va,{path:"/profile",element:u.jsx(lJ,{})}),u.jsx(va,{path:"*",element:u.jsx(X_,{to:"/",replace:!0})})]})})})})]})]})})})})}l4(document.getElementById("root")).render(u.jsx(U.StrictMode,{children:u.jsx(cJ,{})}));export{fr as _};
