const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.es-Cl1hG9Dw.js","assets/vendor-Dl7uvwRy.js","assets/supabase-BEcQKNCL.js","assets/ui-BxLAJkfX.js"])))=>i.map(i=>d[i]);
var uT=Object.defineProperty;var fT=(e,t,r)=>t in e?uT(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var rr=(e,t,r)=>fT(e,typeof t!="symbol"?t+"":t,r);import{r as M,a as e4,N as t4,u as Hs,b as Mh,R as dT,L as r4,d as n4,e as zo,f as hT,B as pT,h as cy,i as In}from"./vendor-Dl7uvwRy.js";import{c as mT,_ as Nm}from"./supabase-BEcQKNCL.js";import{X as Fo,D as zc,R as ts,B as I1,C as gT,T as Do,F as _o,a as _l,H as hf,b as ma,c as Sc,U as Wn,d as qr,e as en,E as Sd,S as uy,L as fy,P as Li,f as xT,g as M1,h as a4,i as Jf,j as is,k as ea,M as Cl,l as R1,m as B1,n as U1,A as Io,o as Yg,p as li,q as Nl,r as No,s as Sm,t as Af,u as Ef,v as Xg,w as Sl,x as qc,y as To,z as dy,G as Ac,I as Po,J as vT,K as Fd,N as Zg,O as yT,Q as bT,V as Am,W as hy,Y as py,Z as wT,_ as i4,$ as s4,a0 as pf,a1 as Dd,a2 as $1,a3 as _T,a4 as NT,a5 as bc,a6 as o4,a7 as ST,a8 as my,a9 as AT,aa as ET,ab as gy,ac as Em,ad as jT}from"./ui-BxLAJkfX.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(a){if(a.ep)return;a.ep=!0;const i=r(a);fetch(a.href,i)}})();var l4={exports:{}},Rh={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TT=M,PT=Symbol.for("react.element"),kT=Symbol.for("react.fragment"),CT=Object.prototype.hasOwnProperty,OT=TT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,LT={key:!0,ref:!0,__self:!0,__source:!0};function c4(e,t,r){var n,a={},i=null,s=null;r!==void 0&&(i=""+r),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(s=t.ref);for(n in t)CT.call(t,n)&&!LT.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:PT,type:e,key:i,ref:s,props:a,_owner:OT.current}}Rh.Fragment=kT;Rh.jsx=c4;Rh.jsxs=c4;l4.exports=Rh;var l=l4.exports,u4,xy=e4;u4=xy.createRoot,xy.hydrateRoot;const FT="https://gxgiqmmlvdgrzvbgmgfp.supabase.co",DT="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd4Z2lxbW1sdmRncnp2YmdtZ2ZwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYwOTA4OTEsImV4cCI6MjA3MTY2Njg5MX0.VzO5yGWCFpN6ZU7d76tK9ADFPNwukuQ96RD3iILpAg0",Ke=mT(FT,DT),f4=M.createContext(void 0),aa=()=>{const e=M.useContext(f4);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e},jm=e=>{switch(e.message){case"Invalid login credentials":return"Invalid email or password. Please check your credentials and try again.";case"Email not confirmed":return"Please check your email and click the verification link before signing in.";case"User already registered":return"An account with this email already exists. Please sign in instead.";case"Password should be at least 6 characters":return"Password must be at least 6 characters long.";case"Invalid email":return"Please enter a valid email address.";case"Too many requests":return"Too many login attempts. Please wait a few minutes before trying again.";case"Signup is disabled":return"New account registration is currently disabled. Please contact support.";default:return e.message||"An unexpected error occurred. Please try again."}},IT=({children:e})=>{const[t,r]=M.useState(null),[n,a]=M.useState(!0);M.useEffect(()=>{Ke.auth.getUser().then(({data:{user:d}})=>{r(d),a(!1)});const{data:{subscription:f}}=Ke.auth.onAuthStateChange((d,p)=>{r((p==null?void 0:p.user)??null),a(!1)});return()=>f.unsubscribe()},[]);const u={user:t,loading:n,signUp:async(f,d)=>{try{const{data:p,error:h}=await Ke.auth.signUp({email:f,password:d,options:{emailRedirectTo:`${window.location.origin}/dashboard`}});return h?{data:null,error:jm(h)}:{data:p,error:null}}catch{return{data:null,error:"An unexpected error occurred. Please try again."}}},signIn:async(f,d)=>{try{const{data:p,error:h}=await Ke.auth.signInWithPassword({email:f,password:d});return h?{data:null,error:jm(h)}:{data:p,error:null}}catch{return{data:null,error:"An unexpected error occurred. Please try again."}}},signOut:async()=>{const{error:f}=await Ke.auth.signOut();if(f)throw f},resendVerification:async f=>{try{const{error:d}=await Ke.auth.resend({type:"signup",email:f});return d?{error:jm(d)}:{error:null}}catch{return{error:"Failed to resend verification email. Please try again."}}}};return l.jsx(f4.Provider,{value:u,children:e})};class kc{static async cleanupOldNotifications(){try{const t=new Date;t.setDate(t.getDate()-7);const{error:r}=await Ke.from("notifications").delete().lt("created_at",t.toISOString());if(r)throw r;console.log("‚úÖ Old notifications cleaned up successfully")}catch(t){console.error("‚ùå Error cleaning up old notifications:",t)}}static async cleanupReadNotifications(){try{const t=new Date;t.setDate(t.getDate()-3);const{error:r}=await Ke.from("notifications").delete().eq("read",!0).lt("created_at",t.toISOString());if(r)throw r;console.log("‚úÖ Read notifications cleaned up successfully")}catch(t){console.error("‚ùå Error cleaning up read notifications:",t)}}static async limitNotificationsPerUser(t,r=50){try{const{data:n,error:a}=await Ke.from("notifications").select("id, created_at").eq("user_id",t).order("created_at",{ascending:!1});if(a)throw a;if(!n||n.length<=r)return;const s=n.slice(r).map(c=>c.id),{error:o}=await Ke.from("notifications").delete().in("id",s);if(o)throw o;console.log(`‚úÖ Kept latest ${r} notifications, removed ${s.length} old ones`)}catch(n){console.error("‚ùå Error limiting notifications per user:",n)}}static async limitAllUsersNotifications(){try{const{data:t,error:r}=await Ke.from("notifications").select("user_id");if(r)throw r;if(!t)return;const n=[...new Set(t.map(a=>a.user_id))];for(const a of n)typeof a=="string"&&await this.limitNotificationsPerUser(a,100)}catch(t){console.error("‚ùå Error limiting notifications for all users:",t)}}static async performFullCleanup(){console.log("üßπ Starting notification database cleanup..."),await this.cleanupOldNotifications(),await this.cleanupReadNotifications(),await this.limitAllUsersNotifications(),console.log("‚úÖ Full notification cleanup completed")}static async deleteReadNotification(t){try{setTimeout(async()=>{const{error:r}=await Ke.from("notifications").delete().eq("id",t).eq("read",!0);r?console.error("Error auto-deleting read notification:",r):console.log("‚úÖ Auto-deleted read notification")},5e3)}catch(r){console.error("Error in auto-delete process:",r)}}static async getNotificationStats(){try{const{count:t,error:r}=await Ke.from("notifications").select("*",{count:"exact",head:!0});if(r)throw r;const{count:n,error:a}=await Ke.from("notifications").select("*",{count:"exact",head:!0}).eq("read",!0);if(a)throw a;const{count:i,error:s}=await Ke.from("notifications").select("*",{count:"exact",head:!0}).eq("read",!1);if(s)throw s;const o=t||0,c=n||0,u=i||0,f=o>0?Math.round(c/o*100):0;return{total:o,read:c,unread:u,readPercentage:f}}catch(t){return console.error("Error getting notification stats:",t),{total:0,read:0,unread:0,readPercentage:0}}}}class Ec{constructor(){this.registration=null}static getInstance(){return Ec.instance||(Ec.instance=new Ec),Ec.instance}async initialize(){try{return!("serviceWorker"in navigator)||!("PushManager"in window)?(console.warn("Push notifications are not supported in this browser"),!1):(this.registration=await navigator.serviceWorker.register("/sw.js"),console.log("Service Worker registered successfully"),await navigator.serviceWorker.ready,!0)}catch(t){return console.error("Failed to initialize push notifications:",t),!1}}async requestPermission(){if(!("Notification"in window))return console.warn("This browser does not support notifications"),!1;let t=Notification.permission;return t==="default"&&(t=await Notification.requestPermission()),t==="granted"?(console.log("Notification permission granted"),!0):(console.warn("Notification permission denied"),!1)}async subscribe(t){try{if(this.registration||await this.initialize(),!this.registration)throw new Error("Service worker registration failed");const r=await this.registration.pushManager.getSubscription();if(r)return await this.saveSubscription(r,t),!0;const n=await this.registration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:this.urlBase64ToUint8Array("BEl62iUYgUivxIkv69yViEuiBIa40HI80YS_qZfKsRBF2uMi85KZJw-q9_-k9Q_nM8F1jQk2dGvQQQ6VDNt-3hc")});return await this.saveSubscription(n,t),console.log("Push notification subscription successful"),!0}catch(r){return console.error("Failed to subscribe to push notifications:",r),!1}}async unsubscribe(t){try{if(!this.registration)return!1;const r=await this.registration.pushManager.getSubscription();return r?(await r.unsubscribe(),await this.removeSubscription(t),console.log("Push notification unsubscribed successfully"),!0):!1}catch(r){return console.error("Failed to unsubscribe from push notifications:",r),!1}}async saveSubscription(t,r){const n=t.getKey?{p256dh:this.arrayBufferToBase64(t.getKey("p256dh")),auth:this.arrayBufferToBase64(t.getKey("auth"))}:{p256dh:"",auth:""},a={user_id:r,endpoint:t.endpoint,p256dh:n.p256dh,auth:n.auth,user_agent:navigator.userAgent},{error:i}=await Ke.from("push_subscriptions").upsert(a,{onConflict:"user_id"});if(i)throw new Error(`Failed to save push subscription: ${i.message}`)}async removeSubscription(t){const{error:r}=await Ke.from("push_subscriptions").delete().eq("user_id",t);r&&console.error("Failed to remove push subscription:",r)}async isSubscribed(){try{return this.registration?await this.registration.pushManager.getSubscription()!==null:!1}catch(t){return console.error("Failed to check subscription status:",t),!1}}async getSubscriptionStatus(){const t="serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window,r=t?Notification.permission:"denied",n=t?await this.isSubscribed():!1;return{supported:t,permission:r,subscribed:n}}urlBase64ToUint8Array(t){const r="=".repeat((4-t.length%4)%4),n=(t+r).replace(/-/g,"+").replace(/_/g,"/"),a=window.atob(n),i=new Uint8Array(a.length);for(let s=0;s<a.length;++s)i[s]=a.charCodeAt(s);return i}arrayBufferToBase64(t){if(!t)return"";const r=new Uint8Array(t);let n="";for(let a=0;a<r.byteLength;a++)n+=String.fromCharCode(r[a]);return window.btoa(n)}}const vo=Ec.getInstance(),d4=M.createContext(void 0),MT=()=>{const e=M.useContext(d4);if(!e)throw new Error("useNotifications must be used within a NotificationProvider");return e},RT=({children:e})=>{const[t,r]=M.useState([]),{user:n}=aa(),a=t.filter(x=>!x.read).length;M.useEffect(()=>{if(!(n!=null&&n.id))return;s(),o(),i(),kc.limitNotificationsPerUser(n.id,50);const x=setInterval(()=>{kc.limitNotificationsPerUser(n.id,50)},30*60*1e3);return()=>{clearInterval(x)}},[n==null?void 0:n.id]);const i=async()=>{if(n!=null&&n.id)try{if(!await vo.initialize()){console.warn("Push notifications not supported or failed to initialize");return}if(!await vo.requestPermission()){console.warn("Push notification permission denied");return}await vo.subscribe(n.id)?console.log("Push notifications enabled successfully"):console.warn("Failed to subscribe to push notifications"),"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",b=>{var E;if(((E=b.data)==null?void 0:E.type)==="MARK_NOTIFICATION_READ"){const A=b.data.notificationId;u(A)}})}catch(x){console.error("Push notification initialization failed:",x)}},s=async()=>{if(n!=null&&n.id)try{const{data:x,error:g}=await Ke.from("notifications").select("*").eq("user_id",n.id).order("created_at",{ascending:!1}).limit(50);if(g)throw g;const y=x.map(b=>({id:b.id,userId:b.user_id,type:b.type,title:b.title,message:b.message,data:b.data,read:b.read,createdAt:b.created_at,updatedAt:b.updated_at}));r(y)}catch(x){console.error("Error loading notifications:",x)}},o=()=>{if(!(n!=null&&n.id))return;const x=Ke.channel("notifications").on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`user_id=eq.${n.id}`},g=>{const y={id:g.new.id,userId:g.new.user_id,type:g.new.type,title:g.new.title,message:g.new.message,data:g.new.data,read:g.new.read,createdAt:g.new.created_at,updatedAt:g.new.updated_at};r(b=>[y,...b]),"Notification"in window&&window.Notification.permission==="granted"&&new window.Notification(y.title,{body:y.message,icon:"/pwa opning/SHOP.png",tag:y.id})}).subscribe();return()=>{x.unsubscribe()}},c=async x=>{if(n!=null&&n.id)try{const{data:g,error:y}=await Ke.from("notifications").insert({user_id:n.id,type:x.type,title:x.title,message:x.message,data:x.data,read:!1}).select().single();if(y)throw y;const b={id:g.id,userId:g.user_id,type:g.type,title:g.title,message:g.message,data:g.data,read:g.read,createdAt:g.created_at,updatedAt:g.updated_at};r(E=>[b,...E])}catch(g){console.error("Error adding notification:",g)}},u=async x=>{try{const{error:g}=await Ke.from("notifications").update({read:!0,updated_at:new Date().toISOString()}).eq("id",x);if(g)throw g;r(y=>y.map(b=>b.id===x?{...b,read:!0}:b)),kc.deleteReadNotification(x)}catch(g){console.error("Error marking notification as read:",g)}},h={notifications:t,unreadCount:a,addNotification:c,markAsRead:u,markAllAsRead:async()=>{if(n!=null&&n.id)try{const{error:x}=await Ke.from("notifications").update({read:!0,updated_at:new Date().toISOString()}).eq("user_id",n.id).eq("read",!1);if(x)throw x;r(g=>g.map(y=>({...y,read:!0})))}catch(x){console.error("Error marking all notifications as read:",x)}},clearNotification:async x=>{try{const{error:g}=await Ke.from("notifications").delete().eq("id",x);if(g)throw g;r(y=>y.filter(b=>b.id!==x))}catch(g){console.error("Error clearing notification:",g)}},clearAllNotifications:async()=>{if(n!=null&&n.id)try{const{error:x}=await Ke.from("notifications").delete().eq("user_id",n.id);if(x)throw x;r([])}catch(x){console.error("Error clearing all notifications:",x)}}};return l.jsx(d4.Provider,{value:h,children:e})};class z1{static async sendNotificationToAccountOwners(t,r){var n;try{const{data:a,error:i}=await Ke.from("profiles").select("id").neq("id",t);if(i)throw i;if(!a||a.length===0)return;const s=a.map(f=>({user_id:f.id,type:r.type,title:r.title,message:r.message,data:r.data,read:!1,created_at:new Date().toISOString(),updated_at:new Date().toISOString()})),{data:o,error:c}=await Ke.from("notifications").insert(s).select("id");if(c)throw c;console.log(`Notifications sent to ${a.length} users`);const u=a.map(f=>f.id);try{await this.sendPushNotification({title:r.title,body:r.message,userIds:u,url:this.getNotificationUrl(r.type,r.data),tag:r.type,notificationId:(n=o==null?void 0:o[0])==null?void 0:n.id})}catch(f){console.warn("Push notification failed:",f)}}catch(a){console.error("Error sending notifications:",a)}}static async notifyTransactionCreated(t,r,n,a,i,s){await this.sendNotificationToAccountOwners(t,{type:"transaction_created",title:"New Transaction Added",message:`${r} purchased ‚Çπ${n.toLocaleString()} supplies from ${a}`,data:{transactionId:i,supplierId:s,amount:n,supplierName:a,userAction:"created",userName:r}})}static async notifyTransactionUpdated(t,r,n,a,i,s){await this.sendNotificationToAccountOwners(t,{type:"transaction_updated",title:"Transaction Updated",message:`${r} updated transaction with ${a} (‚Çπ${n.toLocaleString()})`,data:{transactionId:i,supplierId:s,amount:n,supplierName:a,userAction:"updated",userName:r}})}static async notifyTransactionDeleted(t,r,n,a,i){await this.sendNotificationToAccountOwners(t,{type:"transaction_deleted",title:"Transaction Deleted",message:`${r} deleted transaction with ${a} (‚Çπ${n.toLocaleString()})`,data:{supplierId:i,amount:n,supplierName:a,userAction:"deleted",userName:r}})}static async notifyPaymentMade(t,r,n,a,i){await this.sendNotificationToAccountOwners(t,{type:"payment_made",title:"Payment Made",message:`${r} made payment of ‚Çπ${n.toLocaleString()} to ${a}`,data:{supplierId:i,amount:n,supplierName:a,userAction:"payment",userName:r}})}static async notifySupplierAdded(t,r,n,a){await this.sendNotificationToAccountOwners(t,{type:"supplier_added",title:"New Supplier Added",message:`${r} added new supplier: ${n}`,data:{supplierId:a,supplierName:n,userAction:"added",userName:r}})}static async requestNotificationPermission(){return"Notification"in window&&window.Notification.permission==="default"?await window.Notification.requestPermission()==="granted":window.Notification.permission==="granted"}static async sendPushNotification(t){try{const{data:r,error:n}=await Ke.functions.invoke("send-push-notification",{body:t});if(n)throw console.error("Push notification error:",n),n;return console.log("Push notification result:",r),r}catch(r){throw console.error("Failed to send push notification:",r),r}}static getNotificationUrl(t,r){switch(t){case"transaction_created":case"transaction_updated":return r!=null&&r.supplierId?`/suppliers/${r.supplierId}`:"/transactions";case"payment_made":return r!=null&&r.supplierId?`/suppliers/${r.supplierId}`:"/suppliers";case"supplier_added":return r!=null&&r.supplierId?`/suppliers/${r.supplierId}`:"/suppliers";default:return"/dashboard"}}}const BT=({children:e})=>{const{user:t,loading:r}=aa();return r?l.jsx("div",{className:"min-h-screen flex items-center justify-center",children:l.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):t?l.jsx(l.Fragment,{children:e}):l.jsx(t4,{to:"/login",replace:!0})},UT="1.4.3",h4="The opening page update",Wc=()=>`v${UT}`,$T=()=>{const[e,t]=M.useState(null),[r,n]=M.useState(!1),[a,i]=M.useState(!1),[s,o]=M.useState(!1);M.useEffect(()=>{const f=/iPad|iPhone|iPod/.test(navigator.userAgent);i(f);const d=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://");o(d);const p=h=>{h.preventDefault(),t(h),n(!0)};return window.addEventListener("beforeinstallprompt",p),()=>{window.removeEventListener("beforeinstallprompt",p)}},[]);const c=async()=>{if(!e)return;e.prompt();const{outcome:f}=await e.userChoice;console.log(f==="accepted"?"User accepted the install prompt":"User dismissed the install prompt"),t(null),n(!1)},u=()=>{n(!1),sessionStorage.setItem("installPromptDismissed","true")};return s||sessionStorage.getItem("installPromptDismissed")==="true"?null:a&&!s?l.jsx("div",{className:"fixed bottom-4 left-4 right-4 z-50 bg-blue-600 text-white p-4 rounded-lg shadow-lg border border-blue-500",children:l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("h3",{className:"font-semibold text-sm",children:"Install Shopsynk"}),l.jsxs("p",{className:"text-xs mt-1 opacity-90",children:["Install this app on your iPhone: tap ",l.jsx("span",{className:"font-bold",children:"Share"})," and then ",l.jsx("span",{className:"font-bold",children:"Add to Home Screen"})]})]}),l.jsx("button",{onClick:u,className:"ml-2 p-1 hover:bg-blue-700 rounded",children:l.jsx(Fo,{className:"h-4 w-4"})})]})}):r&&e?l.jsx("div",{className:"fixed bottom-4 left-4 right-4 z-50 bg-gradient-to-r from-blue-600 to-purple-600 text-white p-4 rounded-lg shadow-lg border border-blue-500",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center flex-1",children:[l.jsx(zc,{className:"h-5 w-5 mr-3 flex-shrink-0"}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-sm",children:"Install Shopsynk App"}),l.jsx("p",{className:"text-xs mt-1 opacity-90",children:"Get the full app experience with offline access and notifications"})]})]}),l.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[l.jsx("button",{onClick:c,className:"bg-white text-blue-600 px-3 py-1 rounded text-xs font-medium hover:bg-gray-100 transition-colors",children:"Install"}),l.jsx("button",{onClick:u,className:"p-1 hover:bg-blue-700 rounded",children:l.jsx(Fo,{className:"h-4 w-4"})})]})]})}):null},zT=()=>{const[e,t]=M.useState(!1),[r,n]=M.useState(null);M.useEffect(()=>{"serviceWorker"in navigator&&(navigator.serviceWorker.ready.then(s=>{s.waiting&&(n(s.waiting),t(!0)),s.addEventListener("updatefound",()=>{const o=s.installing;o&&o.addEventListener("statechange",()=>{o.state==="installed"&&navigator.serviceWorker.controller&&(n(o),t(!0))})})}),navigator.serviceWorker.addEventListener("controllerchange",()=>{window.location.reload()}))},[]);const a=()=>{r&&(r.postMessage({type:"SKIP_WAITING"}),t(!1))},i=()=>{t(!1)};return e?l.jsx("div",{className:"fixed top-4 left-4 right-4 z-50 bg-green-600 text-white p-4 rounded-lg shadow-lg border border-green-500",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center flex-1",children:[l.jsx(ts,{className:"h-5 w-5 mr-3 flex-shrink-0"}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-sm",children:"App Update Available"}),l.jsx("p",{className:"text-xs mt-1 opacity-90",children:"A new version of Shopsynk is ready to install"})]})]}),l.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[l.jsx("button",{onClick:a,className:"bg-white text-green-600 px-3 py-1 rounded text-xs font-medium hover:bg-gray-100 transition-colors",children:"Update"}),l.jsx("button",{onClick:i,className:"p-1 hover:bg-green-700 rounded",children:l.jsx(Fo,{className:"h-4 w-4"})})]})]})}):null},G0=43200,vy=1440,yy=Symbol.for("constructDateFrom");function Jg(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&yy in e?e[yy](t):e instanceof Date?new e.constructor(t):new Date(t)}function Mo(e,t){return Jg(e,e)}let qT={};function WT(){return qT}function by(e){const t=Mo(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function Qg(e,...t){const r=Jg.bind(null,e||t.find(n=>typeof n=="object"));return t.map(r)}function Ad(e,t){const r=+Mo(e)-+Mo(t);return r<0?-1:r>0?1:r}function HT(e){return Jg(e,Date.now())}function GT(e,t,r){const[n,a]=Qg(r==null?void 0:r.in,e,t),i=n.getFullYear()-a.getFullYear(),s=n.getMonth()-a.getMonth();return i*12+s}function VT(e){return t=>{const n=(e?Math[e]:Math.trunc)(t);return n===0?0:n}}function KT(e,t){return+Mo(e)-+Mo(t)}function YT(e,t){const r=Mo(e);return r.setHours(23,59,59,999),r}function XT(e,t){const r=Mo(e),n=r.getMonth();return r.setFullYear(r.getFullYear(),n+1,0),r.setHours(23,59,59,999),r}function ZT(e,t){const r=Mo(e);return+YT(r)==+XT(r)}function JT(e,t,r){const[n,a,i]=Qg(r==null?void 0:r.in,e,e,t),s=Ad(a,i),o=Math.abs(GT(a,i));if(o<1)return 0;a.getMonth()===1&&a.getDate()>27&&a.setDate(30),a.setMonth(a.getMonth()-s*o);let c=Ad(a,i)===-s;ZT(n)&&o===1&&Ad(n,i)===1&&(c=!1);const u=s*(o-+c);return u===0?0:u}function QT(e,t,r){const n=KT(e,t)/1e3;return VT(r==null?void 0:r.roundingMethod)(n)}const e8={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},t8=(e,t,r)=>{let n;const a=e8[e];return typeof a=="string"?n=a:t===1?n=a.one:n=a.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function Tm(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const r8={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},n8={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},a8={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},i8={date:Tm({formats:r8,defaultWidth:"full"}),time:Tm({formats:n8,defaultWidth:"full"}),dateTime:Tm({formats:a8,defaultWidth:"full"})},s8={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},o8=(e,t,r,n)=>s8[e];function Vu(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let a;if(n==="formatting"&&e.formattingValues){const s=e.defaultFormattingWidth||e.defaultWidth,o=r!=null&&r.width?String(r.width):s;a=e.formattingValues[o]||e.formattingValues[s]}else{const s=e.defaultWidth,o=r!=null&&r.width?String(r.width):e.defaultWidth;a=e.values[o]||e.values[s]}const i=e.argumentCallback?e.argumentCallback(t):t;return a[i]}}const l8={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},c8={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},u8={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},f8={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},d8={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},h8={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},p8=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},m8={ordinalNumber:p8,era:Vu({values:l8,defaultWidth:"wide"}),quarter:Vu({values:c8,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Vu({values:u8,defaultWidth:"wide"}),day:Vu({values:f8,defaultWidth:"wide"}),dayPeriod:Vu({values:d8,defaultWidth:"wide",formattingValues:h8,defaultFormattingWidth:"wide"})};function Ku(e){return(t,r={})=>{const n=r.width,a=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],i=t.match(a);if(!i)return null;const s=i[0],o=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(o)?x8(o,d=>d.test(s)):g8(o,d=>d.test(s));let u;u=e.valueCallback?e.valueCallback(c):c,u=r.valueCallback?r.valueCallback(u):u;const f=t.slice(s.length);return{value:u,rest:f}}}function g8(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function x8(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function v8(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const a=n[0],i=t.match(e.parsePattern);if(!i)return null;let s=e.valueCallback?e.valueCallback(i[0]):i[0];s=r.valueCallback?r.valueCallback(s):s;const o=t.slice(a.length);return{value:s,rest:o}}}const y8=/^(\d+)(th|st|nd|rd)?/i,b8=/\d+/i,w8={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},_8={any:[/^b/i,/^(a|c)/i]},N8={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},S8={any:[/1/i,/2/i,/3/i,/4/i]},A8={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},E8={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},j8={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},T8={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},P8={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},k8={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},C8={ordinalNumber:v8({matchPattern:y8,parsePattern:b8,valueCallback:e=>parseInt(e,10)}),era:Ku({matchPatterns:w8,defaultMatchWidth:"wide",parsePatterns:_8,defaultParseWidth:"any"}),quarter:Ku({matchPatterns:N8,defaultMatchWidth:"wide",parsePatterns:S8,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Ku({matchPatterns:A8,defaultMatchWidth:"wide",parsePatterns:E8,defaultParseWidth:"any"}),day:Ku({matchPatterns:j8,defaultMatchWidth:"wide",parsePatterns:T8,defaultParseWidth:"any"}),dayPeriod:Ku({matchPatterns:P8,defaultMatchWidth:"any",parsePatterns:k8,defaultParseWidth:"any"})},O8={code:"en-US",formatDistance:t8,formatLong:i8,formatRelative:o8,localize:m8,match:C8,options:{weekStartsOn:0,firstWeekContainsDate:1}};function L8(e,t,r){const n=WT(),a=(r==null?void 0:r.locale)??n.locale??O8,i=2520,s=Ad(e,t);if(isNaN(s))throw new RangeError("Invalid time value");const o=Object.assign({},r,{addSuffix:r==null?void 0:r.addSuffix,comparison:s}),[c,u]=Qg(r==null?void 0:r.in,...s>0?[t,e]:[e,t]),f=QT(u,c),d=(by(u)-by(c))/1e3,p=Math.round((f-d)/60);let h;if(p<2)return r!=null&&r.includeSeconds?f<5?a.formatDistance("lessThanXSeconds",5,o):f<10?a.formatDistance("lessThanXSeconds",10,o):f<20?a.formatDistance("lessThanXSeconds",20,o):f<40?a.formatDistance("halfAMinute",0,o):f<60?a.formatDistance("lessThanXMinutes",1,o):a.formatDistance("xMinutes",1,o):p===0?a.formatDistance("lessThanXMinutes",1,o):a.formatDistance("xMinutes",p,o);if(p<45)return a.formatDistance("xMinutes",p,o);if(p<90)return a.formatDistance("aboutXHours",1,o);if(p<vy){const x=Math.round(p/60);return a.formatDistance("aboutXHours",x,o)}else{if(p<i)return a.formatDistance("xDays",1,o);if(p<G0){const x=Math.round(p/vy);return a.formatDistance("xDays",x,o)}else if(p<G0*2)return h=Math.round(p/G0),a.formatDistance("aboutXMonths",h,o)}if(h=JT(u,c),h<12){const x=Math.round(p/G0);return a.formatDistance("xMonths",x,o)}else{const x=h%12,g=Math.trunc(h/12);return x<3?a.formatDistance("aboutXYears",g,o):x<9?a.formatDistance("overXYears",g,o):a.formatDistance("almostXYears",g+1,o)}}function F8(e,t){return L8(e,HT(e),t)}const wy=()=>{const[e,t]=M.useState(!1),{notifications:r,unreadCount:n,markAsRead:a,markAllAsRead:i,clearNotification:s,clearAllNotifications:o}=MT(),c=d=>{var p,h;d.read||a(d.id),(p=d.data)!=null&&p.transactionId||(h=d.data)!=null&&h.supplierId},u=d=>{switch(d){case"transaction_created":return"üí∞";case"transaction_updated":return"‚úèÔ∏è";case"transaction_deleted":return"üóëÔ∏è";case"supplier_added":return"üè™";case"payment_made":return"üí≥";default:return"üì¢"}},f=d=>{try{return F8(new Date(d),{addSuffix:!0})}catch{return"Recently"}};return l.jsxs("div",{className:"relative",children:[l.jsxs("button",{onClick:()=>t(!e),className:"relative p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-full transition-colors",children:[l.jsx(I1,{className:"w-6 h-6"}),n>0&&l.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center font-bold",children:n>99?"99+":n})]}),e&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>t(!1)}),l.jsxs("div",{className:"absolute right-0 top-full mt-2 w-80 bg-white rounded-lg shadow-xl border border-gray-200 z-20 max-h-96 overflow-hidden",children:[l.jsx("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Notifications",n>0&&l.jsxs("span",{className:"ml-2 text-sm bg-red-100 text-red-600 px-2 py-1 rounded-full",children:[n," new"]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[n>0&&l.jsx("button",{onClick:i,className:"text-sm text-blue-600 hover:text-blue-800 flex items-center",title:"Mark all as read",children:l.jsx(gT,{className:"w-4 h-4"})}),l.jsx("button",{onClick:()=>t(!1),className:"text-gray-400 hover:text-gray-600",children:l.jsx(Fo,{className:"w-4 h-4"})})]})]})}),l.jsx("div",{className:"max-h-64 overflow-y-auto",children:r.length===0?l.jsxs("div",{className:"p-8 text-center text-gray-500",children:[l.jsx(I1,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),l.jsx("p",{className:"text-sm",children:"No notifications yet"})]}):r.map(d=>l.jsx("div",{className:`p-4 border-b border-gray-100 cursor-pointer hover:bg-gray-50 transition-colors ${d.read?"":"bg-blue-50 border-l-4 border-l-blue-500"}`,onClick:()=>c(d),children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx("div",{className:"text-2xl flex-shrink-0",children:u(d.type)}),l.jsx("div",{className:"flex-1 min-w-0",children:l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:`text-sm font-medium ${d.read?"text-gray-700":"text-gray-900"}`,children:d.title}),l.jsx("p",{className:`text-sm mt-1 ${d.read?"text-gray-500":"text-gray-700"}`,children:d.message}),l.jsx("p",{className:"text-xs text-gray-400 mt-2",children:f(d.createdAt)})]}),l.jsx("button",{onClick:p=>{p.stopPropagation(),s(d.id)},className:"text-gray-400 hover:text-gray-600 ml-2 flex-shrink-0",title:"Remove notification",children:l.jsx(Fo,{className:"w-4 h-4"})})]})})]})},d.id))}),r.length>0&&l.jsx("div",{className:"p-3 border-t border-gray-200 bg-gray-50",children:l.jsxs("button",{onClick:o,className:"w-full text-center text-sm text-red-600 hover:text-red-800 flex items-center justify-center space-x-1",children:[l.jsx(Do,{className:"w-4 h-4"}),l.jsx("span",{children:"Clear all notifications"})]})})]})]})]})},D8=({children:e})=>{const{user:t,signOut:r}=aa(),n=Hs(),a=Mh(),[i,s]=M.useState(!1),[o,c]=M.useState(!1),[u,f]=M.useState(!1),[d,p]=M.useState({suppliers:!0,spends:!0,persons:!0}),[h,x]=M.useState({suppliers:"reports",spends:"transactions",persons:"data-storage"});M.useEffect(()=>{const le=()=>{const S=localStorage.getItem("shopsynk_settings");if(S)try{const L=JSON.parse(S);L.features&&p(L.features),L.replacements&&x(L.replacements)}catch(L){console.error("Error loading feature settings:",L)}};le();const ke=S=>{S.key==="shopsynk_settings"&&le()},ve=()=>{le()};return window.addEventListener("storage",ke),window.addEventListener("settingsChanged",ve),()=>{window.removeEventListener("storage",ke),window.removeEventListener("settingsChanged",ve)}},[]);const g=M.useMemo(()=>le=>{const ke=[...le],ve=new Set;return ke.map(S=>{if(S.path==="/spends"&&!d.spends){const L=h.spends;if(ve.has(`/${L}`)){const D=b(L,ve);if(D)return ve.add(`/${D}`),y(D);{const X=["transactions","reports","data-storage","documentation"].find(de=>!ve.has(`/${de}`));return y(X||"reports")}}else return ve.add(`/${L}`),y(L)}if(S.path==="/suppliers"&&!d.suppliers){const L=h.suppliers;if(ve.has(`/${L}`)){const D=b(L,ve);if(D)return ve.add(`/${D}`),y(D);{const X=["transactions","reports","data-storage","documentation"].find(de=>!ve.has(`/${de}`));return y(X||"transactions")}}else return ve.add(`/${L}`),y(L)}if(S.path==="/persons"&&!d.persons){const L=h.persons;if(ve.has(`/${L}`)){const D=b(L,ve);if(D)return ve.add(`/${D}`),y(D);{const X=["transactions","reports","data-storage","documentation"].find(de=>!ve.has(`/${de}`));return y(X||"data-storage")}}else return ve.add(`/${L}`),y(L)}return S})},[d,h]),y=le=>{switch(le){case"transactions":return{name:"Transactions",path:"/transactions",icon:ma};case"reports":return{name:"Reports",path:"/reports",icon:_o};case"data-storage":return{name:"Data Storage",path:"/data-storage",icon:hf};case"documentation":return{name:"Documentation",path:"/documentation",icon:_l};default:return{name:"Reports",path:"/reports",icon:_o}}},b=(le,ke)=>{const ve=["transactions","reports","data-storage","documentation"];for(const S of ve)if(S!==le&&!ke.has(`/${S}`))return S;return null},E=async()=>{try{await r(),n("/login")}catch(le){console.error("Error signing out:",le)}},A=a.pathname==="/suppliers",C=a.pathname.startsWith("/suppliers/")&&a.pathname!=="/suppliers",N=a.pathname==="/persons",F=a.pathname.startsWith("/persons/")&&a.pathname!=="/persons",O=a.pathname==="/spends",I=()=>{A?n("/suppliers?add=true"):C?s(!0):N?n("/persons?add=true"):O&&n("/spends?add=true")},P=()=>{s(!1);const le=new CustomEvent("openPurchaseModal");window.dispatchEvent(le)},H=()=>{s(!1);const le=new CustomEvent("openPaymentModal");window.dispatchEvent(le)},T=()=>{f(!1);const le=new CustomEvent("openPurchaseModal");window.dispatchEvent(le)},j=()=>{f(!1);const le=new CustomEvent("openPaymentModal");window.dispatchEvent(le)},z=M.useMemo(()=>g([{name:"Dashboard",path:"/dashboard",icon:Sc},{name:"Suppliers",path:"/suppliers",icon:Wn},{name:"Persons",path:"/persons",icon:qr},{name:"Spends",path:"/spends",icon:en},{name:"Reports",path:"/reports",icon:_o},{name:"Data Storage",path:"/data-storage",icon:hf},{name:"Documentation",path:"/documentation",icon:_l}]),[g]),K=le=>le==="/dashboard"?a.pathname==="/dashboard":a.pathname.startsWith(le),be=M.useMemo(()=>{const le=g([{name:"Dashboard",path:"/dashboard",icon:Sc},{name:"Spends",path:"/spends",icon:en},{name:"Suppliers",path:"/suppliers",icon:Wn},{name:"Persons",path:"/persons",icon:qr},{name:"More",path:"#",icon:Sd}]);return O?g([{name:"Dashboard",path:"/dashboard",icon:Sc},{name:"Suppliers",path:"/suppliers",icon:Wn},{name:"Spends",path:"/spends",icon:en},{name:"Persons",path:"/persons",icon:qr},{name:"More",path:"#",icon:Sd}]):N?g([{name:"Dashboard",path:"/dashboard",icon:Sc},{name:"Spends",path:"/spends",icon:en},{name:"Persons",path:"/persons",icon:qr},{name:"Suppliers",path:"/suppliers",icon:Wn},{name:"More",path:"#",icon:Sd}]):le},[g,O,N,A]);let we=-1,Q="";return A||C?(we=2,Q="Add Supplier"):N?(we=2,Q="Add Person"):F?(we=2,Q="Add Transaction"):O&&(we=2,Q="Add Spend"),dT.useEffect(()=>{const le=ke=>{o&&(ke.target.closest("[data-more-menu]")||c(!1))};if(o)return document.addEventListener("mousedown",le),()=>document.removeEventListener("mousedown",le)},[o]),l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"hidden lg:block fixed inset-y-0 left-0 z-40 w-64 bg-white shadow-lg border-r border-gray-200",children:l.jsxs("div",{className:"flex flex-col h-full",children:[l.jsxs("div",{className:"flex flex-col items-center justify-center h-16 bg-blue-600 text-white",children:[l.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[l.jsx(uy,{className:"h-8 w-8 text-white"}),l.jsx("h1",{className:"text-xl font-bold",children:"Shopsynk"})]}),l.jsx("p",{className:"text-xs text-blue-200",children:Wc()})]}),l.jsx("nav",{className:"flex-1 px-4 py-6 space-y-2",children:z.map(le=>{const ke=le.icon;return l.jsxs("button",{onClick:()=>n(le.path),className:`w-full flex items-center px-4 py-3 text-left rounded-lg transition-colors ${K(le.path)?"bg-blue-50 text-blue-700 border border-blue-200":"text-gray-700 hover:bg-gray-50 hover:text-gray-900"}`,children:[l.jsx(ke,{className:"h-5 w-5 mr-3"}),le.name]},le.name)})}),l.jsxs("div",{className:"p-4 border-t border-gray-200",children:[l.jsx("button",{onClick:()=>n("/profile"),className:"w-full flex items-center justify-between p-3 rounded-lg hover:bg-gray-50 transition-colors mb-3",children:l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx(qr,{className:"h-4 w-4 text-blue-600"})}),l.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[l.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:"Profile Settings"}),l.jsx("p",{className:"text-xs text-gray-500 truncate",children:t==null?void 0:t.email})]})]})}),l.jsxs("button",{onClick:E,className:"w-full flex items-center justify-center p-3 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[l.jsx(fy,{className:"h-4 w-4 mr-2"}),"Sign Out"]})]})]})}),l.jsx("div",{className:"lg:hidden fixed bottom-0 left-0 right-0 z-50 bg-white border-t border-gray-200 shadow-lg safe-area-pb",children:l.jsx("div",{className:"flex items-center justify-around px-1 py-3",children:be.map((le,ke)=>{const ve=K(le.path);if(ke===we){if(Q==="Add Supplier")return l.jsx("button",{onClick:I,className:"flex items-center justify-center p-4 rounded-full transition-all duration-200 bg-blue-600 text-white transform scale-110 shadow-lg hover:scale-125",title:"Add Supplier",children:l.jsx(Li,{className:"h-7 w-7 text-white"})},`plus-${ke}`);if(Q==="Add Person")return l.jsx("button",{onClick:()=>n("/persons?add=true"),className:"flex items-center justify-center p-4 rounded-full transition-all duration-200 bg-blue-600 text-white transform scale-110 shadow-lg hover:scale-125",title:"Add Person",children:l.jsx(Li,{className:"h-7 w-7 text-white"})},`plus-${ke}`);if(Q==="Add Spend")return l.jsx("button",{onClick:()=>n("/spends?add=true"),className:"flex items-center justify-center p-4 rounded-full transition-all duration-200 bg-blue-600 text-white transform scale-110 shadow-lg hover:scale-125",title:"Add Spend",children:l.jsx(Li,{className:"h-7 w-7 text-white"})},`plus-${ke}`);if(Q==="Add Transaction")return l.jsx("button",{onClick:()=>f(!u),className:"flex items-center justify-center p-4 rounded-full transition-all duration-200 bg-blue-600 text-white transform scale-110 shadow-lg hover:scale-125",title:"Add Transaction",children:l.jsx(Li,{className:"h-7 w-7 text-white"})},`plus-${ke}`)}if(le.name==="More")return l.jsx("button",{onClick:()=>c(!o),className:`flex items-center justify-center p-3 rounded-xl transition-all duration-200 ${o?"text-blue-600 bg-blue-50 transform scale-110":"text-gray-500 hover:text-gray-700 hover:bg-gray-50 active:scale-95"}`,title:le.name,children:l.jsx("i",{className:`bi bi-grid-1x2 ${o?"text-blue-600":"text-gray-500"}`,style:{fontSize:"1.5rem"}})},le.name);const S=le.icon;return l.jsx("button",{onClick:()=>n(le.path),className:`flex items-center justify-center p-3 rounded-xl transition-all duration-200 ${ve?"text-blue-600 bg-blue-50 transform scale-110":"text-gray-500 hover:text-gray-700 hover:bg-gray-50 active:scale-95"}`,title:le.name,children:l.jsx(S,{className:`h-6 w-6 ${ve?"text-blue-600":"text-gray-500"}`})},le.name)})})}),i&&C&&l.jsx("div",{className:"lg:hidden fixed inset-0 bg-black bg-opacity-50 z-[60] flex items-end justify-center",children:l.jsxs("div",{className:"bg-white rounded-t-2xl w-full p-6 animate-slide-up",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Quick Actions"}),l.jsx("button",{onClick:()=>s(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:l.jsx(Fo,{className:"h-5 w-5 text-gray-500"})})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("button",{onClick:P,className:"flex flex-col items-center p-6 bg-red-50 border border-red-200 rounded-xl hover:bg-red-100 transition-colors",children:[l.jsx("div",{className:"w-12 h-12 bg-red-500 rounded-full flex items-center justify-center mb-3",children:l.jsx(xT,{className:"h-6 w-6 text-white"})}),l.jsx("span",{className:"text-red-700 font-medium",children:"Add Purchase"}),l.jsx("span",{className:"text-red-600 text-sm mt-1",children:"Record new purchase"})]}),l.jsxs("button",{onClick:H,className:"flex flex-col items-center p-6 bg-green-50 border border-green-200 rounded-xl hover:bg-green-100 transition-colors",children:[l.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-full flex items-center justify-center mb-3",children:l.jsx(M1,{className:"h-6 w-6 text-white"})}),l.jsx("span",{className:"text-green-700 font-medium",children:"Pay Due"}),l.jsx("span",{className:"text-green-600 text-sm mt-1",children:"Make payment"})]})]})]})}),u&&l.jsx("div",{className:"lg:hidden fixed inset-0 bg-black bg-opacity-50 z-[60] flex items-end justify-center",children:l.jsxs("div",{className:"bg-white rounded-t-2xl w-full p-6 animate-slide-up",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Add Transaction"}),l.jsx("button",{onClick:()=>f(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:l.jsx(Fo,{className:"h-5 w-5 text-gray-500"})})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[l.jsxs("button",{onClick:T,className:"flex flex-col items-center p-6 bg-red-50 border border-red-200 rounded-xl hover:bg-red-100 transition-colors",children:[l.jsx("div",{className:"w-12 h-12 bg-red-500 rounded-full flex items-center justify-center mb-3",children:l.jsx(a4,{className:"h-6 w-6 text-white"})}),l.jsx("span",{className:"text-red-700 font-medium",children:"Gives"}),l.jsx("span",{className:"text-red-600 text-sm mt-1",children:"Record loan given"})]}),l.jsxs("button",{onClick:j,className:"flex flex-col items-center p-6 bg-green-50 border border-green-200 rounded-xl hover:bg-green-100 transition-colors",children:[l.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-full flex items-center justify-center mb-3",children:l.jsx(en,{className:"h-6 w-6 text-white"})}),l.jsx("span",{className:"text-green-700 font-medium",children:"Takes"}),l.jsx("span",{className:"text-green-600 text-sm mt-1",children:"Record payment received"})]})]})]})}),o&&l.jsx("div",{"data-more-menu":!0,className:"lg:hidden fixed bottom-16 right-4 bg-white border border-gray-200 rounded-xl shadow-lg z-[60] min-w-48 animate-fade-in",children:l.jsxs("div",{className:"py-2",children:[l.jsxs("button",{onClick:()=>{n("/profile"),c(!1)},className:"w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-gray-50 flex items-center transition-colors",children:[l.jsx(qr,{className:"h-4 w-4 mr-3 text-gray-500"}),"Profile"]}),l.jsxs("button",{onClick:()=>{n("/data-storage"),c(!1)},className:"w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-gray-50 flex items-center transition-colors",children:[l.jsx(hf,{className:"h-4 w-4 mr-3 text-gray-500"}),"Data Storage"]}),l.jsxs("button",{onClick:()=>{n("/reports"),c(!1)},className:"w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-gray-50 flex items-center transition-colors",children:[l.jsx(_o,{className:"h-4 w-4 mr-3 text-gray-500"}),"Reports"]}),l.jsxs("button",{onClick:()=>{n("/transactions"),c(!1)},className:"w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-gray-50 flex items-center transition-colors",children:[l.jsx(ma,{className:"h-4 w-4 mr-3 text-gray-500"}),"Transactions"]}),l.jsxs("button",{onClick:()=>{n("/documentation"),c(!1)},className:"w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-gray-50 flex items-center transition-colors",children:[l.jsx(_l,{className:"h-4 w-4 mr-3 text-gray-500"}),"Documentation"]}),l.jsxs("button",{onClick:()=>{n("/settings"),c(!1)},className:"w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-gray-50 flex items-center transition-colors",children:[l.jsx(Jf,{className:"h-4 w-4 mr-3 text-gray-500"}),"Settings"]}),l.jsx("div",{className:"border-t border-gray-200 my-1"}),l.jsxs("button",{onClick:()=>{E(),c(!1)},className:"w-full text-left px-4 py-3 text-sm text-red-600 hover:bg-red-50 flex items-center transition-colors",children:[l.jsx(fy,{className:"h-4 w-4 mr-3 text-red-500"}),"Sign Out"]})]})}),l.jsx("div",{className:"lg:hidden bg-white border-b border-gray-200 px-4 py-3 sticky top-0 z-40",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(uy,{className:"h-6 w-6 text-blue-600"}),l.jsx("h1",{className:"text-lg font-bold text-blue-600",children:"Shopsynk"}),l.jsx("span",{className:"ml-2 text-xs text-gray-500",children:Wc()})]}),l.jsxs("div",{className:"flex items-center space-x-1",children:[l.jsx(wy,{}),l.jsx("button",{onClick:()=>n("/profile"),className:`p-2 rounded-lg transition-colors ${K("/profile")?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-100"}`,title:"Profile",children:l.jsx(qr,{className:"h-5 w-5"})})]})]})}),l.jsxs("div",{className:"lg:pl-64",children:[l.jsx("div",{className:"hidden lg:block bg-white border-b border-gray-200 px-6 py-4 lg:px-8",children:l.jsx("div",{className:"flex items-center justify-end",children:l.jsx(wy,{})})}),l.jsx("main",{className:"p-4 lg:p-8 pb-20 lg:pb-8 pt-4 lg:pt-0",children:e})]}),l.jsx($T,{}),l.jsx(zT,{})]})},I8=({onComplete:e})=>{const[t,r]=M.useState(!0);return M.useEffect(()=>{const n=setTimeout(()=>{r(!1),setTimeout(e,300)},2500);return()=>clearTimeout(n)},[e]),t?l.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-yellow-100 to-orange-200 flex items-center justify-center z-50 transition-opacity duration-300",children:l.jsxs("div",{className:"text-center animate-bounce-slow",children:[l.jsx("img",{src:"/pwa opning/SHOP.png",alt:"Shopsynk",className:"w-48 h-48 mx-auto mb-6 drop-shadow-lg object-contain",onError:n=>{var i;n.currentTarget.style.display="none";const a=document.createElement("div");a.className="w-48 h-48 mx-auto mb-6 bg-orange-400 rounded-3xl flex items-center justify-center text-white text-6xl font-bold shadow-lg",a.textContent="S",(i=n.currentTarget.parentNode)==null||i.insertBefore(a,n.currentTarget)}}),l.jsx("div",{className:"text-2xl font-bold text-orange-600 mb-2 animate-pulse",children:"Shopsynk"}),l.jsx("div",{className:"text-orange-500 animate-fade-in-delayed",children:"Supplier Management"}),l.jsxs("div",{className:"mt-8 flex justify-center space-x-1",children:[l.jsx("div",{className:"w-2 h-2 bg-orange-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),l.jsx("div",{className:"w-2 h-2 bg-orange-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),l.jsx("div",{className:"w-2 h-2 bg-orange-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})]})}):l.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-yellow-100 to-orange-200 flex items-center justify-center z-50 opacity-0 transition-opacity duration-300 pointer-events-none",children:l.jsxs("div",{className:"text-center animate-fade-out",children:[l.jsx("img",{src:"/pwa opning/SHOP.png",alt:"Shopsynk",className:"w-48 h-48 mx-auto mb-6 animate-pulse object-contain",onError:n=>{n.currentTarget.style.display="none"}}),l.jsx("div",{className:"text-2xl font-bold text-orange-600 mb-2",children:"Shopsynk"}),l.jsx("div",{className:"text-orange-500",children:"Supplier Management"})]})})},M8=()=>{const[e,t]=M.useState(!1),[r,n]=M.useState(!1);M.useEffect(()=>{const s=localStorage.getItem("icon-update-v1-seen"),o=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0;if(!s&&o){const c=setTimeout(()=>{t(!0)},3e3);return()=>clearTimeout(c)}},[]);const a=()=>{n(!0),t(!1),localStorage.setItem("icon-update-v1-seen","true")},i=()=>{a(),alert(`To see our new logo:
1. Remove Shopsynk from your home screen
2. Visit shopsynk.netlify.app in your browser
3. Add to Home Screen again
4. Enjoy the updated branding!`)};return!e||r?null:l.jsx("div",{className:"fixed top-4 right-4 bg-gradient-to-r from-blue-500 to-purple-600 text-white p-4 rounded-lg shadow-xl z-50 max-w-sm",children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx("div",{className:"bg-white/20 rounded-full p-2",children:l.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("h4",{className:"font-semibold text-sm",children:"üéâ New Logo Available!"}),l.jsx("p",{className:"text-xs mt-1 opacity-90",children:"We've updated our branding! Reinstall the app to see our new logo on your home screen."}),l.jsxs("div",{className:"flex space-x-2 mt-3",children:[l.jsx("button",{onClick:i,className:"bg-white/20 text-xs px-3 py-1 rounded-full hover:bg-white/30 transition-colors",children:"How to Update"}),l.jsx("button",{onClick:a,className:"text-xs px-3 py-1 rounded-full hover:bg-white/10 transition-colors",children:"Later"})]})]}),l.jsx("button",{onClick:a,className:"text-white/70 hover:text-white transition-colors",children:l.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})},R8=()=>{const[e,t]=M.useState(""),[r,n]=M.useState(""),[a,i]=M.useState(!1),[s,o]=M.useState(!1),[c,u]=M.useState(""),[f,d]=M.useState(""),[p,h]=M.useState(!1),{signIn:x,resendVerification:g}=aa(),y=Hs(),b=C=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(C),E=async C=>{if(C.preventDefault(),o(!0),u(""),d(""),!e.trim()){u("Email address is required"),o(!1);return}if(!b(e)){u("Please enter a valid email address"),o(!1);return}if(!r.trim()){u("Password is required"),o(!1);return}try{const{error:N}=await x(e,r);if(N){u(N);return}d("Sign in successful! Redirecting..."),setTimeout(()=>y("/dashboard"),1e3)}catch{u("An unexpected error occurred. Please try again.")}finally{o(!1)}},A=async()=>{if(!e.trim()||!b(e)){u("Please enter a valid email address first");return}h(!0),u(""),d("");try{const{error:C}=await g(e);if(C){u(C);return}d("Verification email sent! Please check your inbox.")}catch{u("Failed to resend verification email. Please try again.")}finally{h(!1)}};return l.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:l.jsx("div",{className:"max-w-md w-full",children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("div",{className:"w-16 h-16 rounded-2xl flex items-center justify-center mx-auto mb-4",children:l.jsx("img",{src:"/pwa opning/shopsynk.png",alt:"Shopsynk Logo",className:"w-16 h-16 object-contain"})}),l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Welcome Back"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Sign in to manage your supplier dues"})]}),c&&l.jsx("div",{className:"mb-4 p-4 rounded-lg bg-red-50 border border-red-200",children:l.jsxs("div",{className:"flex items-start",children:[l.jsx(is,{className:"h-5 w-5 text-red-400 mt-0.5 mr-3 flex-shrink-0"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-red-800 font-medium text-sm",children:"Sign In Failed"}),l.jsx("p",{className:"text-red-700 text-sm mt-1",children:c}),c.includes("verification")&&e&&l.jsx("button",{onClick:A,disabled:p,className:"mt-2 text-sm text-red-600 hover:text-red-800 underline disabled:opacity-50 flex items-center",children:p?l.jsxs(l.Fragment,{children:[l.jsx(ts,{className:"h-3 w-3 mr-1 animate-spin"}),"Sending..."]}):"Resend verification email"})]})]})}),f&&l.jsx("div",{className:"mb-4 p-4 rounded-lg bg-green-50 border border-green-200",children:l.jsxs("div",{className:"flex items-start",children:[l.jsx(ea,{className:"h-5 w-5 text-green-400 mt-0.5 mr-3 flex-shrink-0"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-green-800 font-medium text-sm",children:"Success"}),l.jsx("p",{className:"text-green-700 text-sm mt-1",children:f})]})]})}),l.jsxs("form",{onSubmit:E,className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),l.jsxs("div",{className:"relative",children:[l.jsx(Cl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"email",value:e,onChange:C=>t(C.target.value),className:`w-full pl-10 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${c&&!e?"border-red-300":"border-gray-300"}`,placeholder:"Enter your email",required:!0,disabled:s})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),l.jsxs("div",{className:"relative",children:[l.jsx(R1,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:a?"text":"password",value:r,onChange:C=>n(C.target.value),className:`w-full pl-10 pr-12 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${c&&!r?"border-red-300":"border-gray-300"}`,placeholder:"Enter your password",required:!0,disabled:s}),l.jsx("button",{type:"button",onClick:()=>i(!a),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 disabled:opacity-50",disabled:s,children:a?l.jsx(B1,{className:"h-5 w-5"}):l.jsx(U1,{className:"h-5 w-5"})})]})]}),l.jsx("button",{type:"submit",disabled:s,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:s?l.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):l.jsxs(l.Fragment,{children:["Sign In",l.jsx(Io,{className:"ml-2 h-4 w-4"})]})})]}),l.jsx("div",{className:"mt-6 text-center",children:l.jsxs("p",{className:"text-gray-600",children:["Don't have an account?"," ",l.jsx(r4,{to:"/register",className:"text-blue-600 hover:text-blue-700 font-medium",children:"Create one"})]})})]})})})},B8=()=>{const[e,t]=M.useState(""),[r,n]=M.useState(""),[a,i]=M.useState(""),[s,o]=M.useState(!1),[c,u]=M.useState(!1),[f,d]=M.useState(!1),[p,h]=M.useState(""),[x,g]=M.useState(""),[y,b]=M.useState(""),{signUp:E}=aa(),A=P=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(P),C=P=>P.length<6?"weak":P.length<8?"fair":/[A-Z]/.test(P)&&/[a-z]/.test(P)&&/[0-9]/.test(P)?"strong":"good",N=P=>{n(P),b(P?C(P):"")},F=P=>{switch(P){case"weak":return"text-red-600 bg-red-100";case"fair":return"text-yellow-600 bg-yellow-100";case"good":return"text-blue-600 bg-blue-100";case"strong":return"text-green-600 bg-green-100";default:return"text-gray-600 bg-gray-100"}},O=P=>{switch(P){case"weak":return"Weak - Use at least 6 characters";case"fair":return"Fair - Consider adding numbers and uppercase";case"good":return"Good - Add uppercase letters for better security";case"strong":return"Strong password!";default:return""}},I=async P=>{if(P.preventDefault(),d(!0),h(""),g(""),!e.trim()){h("Email address is required"),d(!1);return}if(!A(e)){h("Please enter a valid email address"),d(!1);return}if(!r.trim()){h("Password is required"),d(!1);return}if(r.length<6){h("Password must be at least 6 characters long"),d(!1);return}if(r!==a){h("Passwords do not match"),d(!1);return}if(y==="weak"){h("Please choose a stronger password"),d(!1);return}try{const{error:H}=await E(e,r);if(H){h(H);return}g("Account created successfully! Please check your email and click the verification link to complete your registration.")}catch{h("An unexpected error occurred. Please try again.")}finally{d(!1)}};return l.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:l.jsx("div",{className:"max-w-md w-full",children:l.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[l.jsxs("div",{className:"text-center mb-8",children:[l.jsx("div",{className:"w-16 h-16 bg-blue-600 rounded-2xl flex items-center justify-center mx-auto mb-4",children:l.jsx(Yg,{className:"h-8 w-8 text-white"})}),l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Create Account"}),l.jsx("p",{className:"text-gray-600 mt-2",children:"Start managing your supplier dues today"})]}),p&&l.jsx("div",{className:"mb-4 p-4 rounded-lg bg-red-50 border border-red-200",children:l.jsxs("div",{className:"flex items-start",children:[l.jsx(is,{className:"h-5 w-5 text-red-400 mt-0.5 mr-3 flex-shrink-0"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-red-800 font-medium text-sm",children:"Registration Failed"}),l.jsx("p",{className:"text-red-700 text-sm mt-1",children:p})]})]})}),x&&l.jsx("div",{className:"mb-4 p-4 rounded-lg bg-green-50 border border-green-200",children:l.jsxs("div",{className:"flex items-start",children:[l.jsx(ea,{className:"h-5 w-5 text-green-400 mt-0.5 mr-3 flex-shrink-0"}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-green-800 font-medium text-sm",children:"Account Created!"}),l.jsx("p",{className:"text-green-700 text-sm mt-1",children:x})]})]})}),l.jsxs("form",{onSubmit:I,className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),l.jsxs("div",{className:"relative",children:[l.jsx(Cl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"email",value:e,onChange:P=>t(P.target.value),className:`w-full pl-10 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${p&&!e?"border-red-300":"border-gray-300"}`,placeholder:"Enter your email",required:!0,disabled:f})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),l.jsxs("div",{className:"relative",children:[l.jsx(R1,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:s?"text":"password",value:r,onChange:P=>N(P.target.value),className:`w-full pl-10 pr-12 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${p&&!r?"border-red-300":"border-gray-300"}`,placeholder:"Create a password",required:!0,minLength:6,disabled:f}),l.jsx("button",{type:"button",onClick:()=>o(!s),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 disabled:opacity-50",disabled:f,children:s?l.jsx(B1,{className:"h-5 w-5"}):l.jsx(U1,{className:"h-5 w-5"})})]}),r&&y&&l.jsx("div",{className:`mt-2 text-xs px-2 py-1 rounded-full inline-block ${F(y)}`,children:O(y)})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password"}),l.jsxs("div",{className:"relative",children:[l.jsx(R1,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:c?"text":"password",value:a,onChange:P=>i(P.target.value),className:`w-full pl-10 pr-12 py-3 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors ${p&&r!==a?"border-red-300":"border-gray-300"}`,placeholder:"Confirm your password",required:!0,minLength:6,disabled:f}),l.jsx("button",{type:"button",onClick:()=>u(!c),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 disabled:opacity-50",disabled:f,children:c?l.jsx(B1,{className:"h-5 w-5"}):l.jsx(U1,{className:"h-5 w-5"})})]})]}),l.jsx("button",{type:"submit",disabled:f,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:f?l.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):l.jsxs(l.Fragment,{children:["Create Account",l.jsx(Io,{className:"ml-2 h-4 w-4"})]})})]}),l.jsx("div",{className:"mt-6 text-center",children:l.jsxs("p",{className:"text-gray-600",children:["Already have an account?"," ",l.jsx(r4,{to:"/login",className:"text-blue-600 hover:text-blue-700 font-medium",children:"Sign in"})]})})]})})})},U8=()=>{const e=Hs(),t=[{icon:Wn,title:"Supplier Management",description:"Complete supplier dues tracking with purchase history, payment management, and outstanding balance monitoring.",color:"blue"},{icon:qr,title:"Person Money Tracking",description:"Track money given to and received from individuals with comprehensive loan and debt management.",color:"green"},{icon:en,title:"Personal Spends",description:"Monitor personal expenses with categorized spending, budget tracking, and spending analytics.",color:"purple"},{icon:li,title:"Advanced Reports",description:"Generate detailed financial reports with charts, export capabilities, and comprehensive analytics.",color:"orange"},{icon:Nl,title:"Secure Data Storage",description:"Cloud-based data storage with backup and restore functionality for all your financial data.",color:"indigo"},{icon:No,title:"PWA Support",description:"Install as a Progressive Web App for offline access and native app-like experience.",color:"pink"}],r=[{number:"100%",label:"Data Security"},{number:"24/7",label:"Access"},{number:"Free",label:"Forever"},{number:"v1.4.2",label:"Latest Version"}];return l.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-orange-50",children:[l.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex justify-between items-center py-4",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("img",{src:"/pwa opning/SHOP.png",alt:"Shopsynk Logo",className:"h-10 w-10"}),l.jsx("span",{className:"text-2xl font-bold text-gray-900",children:"Shopsynk"})]}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("button",{onClick:()=>e("/login"),className:"text-gray-600 hover:text-gray-900 px-3 py-2 rounded-md text-sm font-medium",children:"Sign In"}),l.jsx("button",{onClick:()=>e("/register"),className:"bg-blue-600 text-white px-4 py-2 rounded-md text-sm font-medium hover:bg-blue-700 transition-colors",children:"Get Started"})]})]})})}),l.jsx("section",{className:"relative py-20 sm:py-24 lg:py-32",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"flex justify-center mb-8",children:l.jsx("img",{src:"/pwa opning/shopsynk.png",alt:"Shopsynk",className:"h-24 w-24 sm:h-32 sm:w-32 lg:h-40 lg:w-40 object-contain"})}),l.jsxs("h1",{className:"text-4xl sm:text-5xl lg:text-6xl font-bold text-gray-900 mb-6",children:["Complete Money",l.jsx("span",{className:"text-blue-600",children:" Management"})]}),l.jsx("p",{className:"text-xl sm:text-2xl text-gray-600 mb-8 max-w-3xl mx-auto",children:"The ultimate solution for managing supplier dues, personal loans, and expenses. Track, analyze, and control your financial relationships with ease."}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[l.jsxs("button",{onClick:()=>e("/register"),className:"bg-blue-600 text-white px-8 py-4 rounded-lg text-lg font-semibold hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2",children:[l.jsx("span",{children:"Get Started Free"}),l.jsx(Io,{className:"h-5 w-5"})]}),l.jsx("button",{onClick:()=>e("/documentation"),className:"border-2 border-gray-300 text-gray-700 px-8 py-4 rounded-lg text-lg font-semibold hover:border-gray-400 hover:bg-gray-50 transition-colors",children:"Learn More"})]})]})})}),l.jsx("section",{className:"py-16 bg-white",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-8",children:r.map((n,a)=>l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-3xl sm:text-4xl font-bold text-blue-600 mb-2",children:n.number}),l.jsx("div",{className:"text-gray-600 font-medium",children:n.label})]},a))})})}),l.jsx("section",{className:"py-20 bg-gray-50",children:l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[l.jsxs("div",{className:"text-center mb-16",children:[l.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-gray-900 mb-4",children:"Powerful Features for Complete Financial Control"}),l.jsx("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Everything you need to manage your business finances and personal expenses in one place."})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:t.map((n,a)=>{const i=n.icon;return l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 hover:shadow-md transition-shadow",children:[l.jsx("div",{className:`inline-flex items-center justify-center w-12 h-12 rounded-lg bg-${n.color}-100 mb-4`,children:l.jsx(i,{className:`h-6 w-6 text-${n.color}-600`})}),l.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-3",children:n.title}),l.jsx("p",{className:"text-gray-600",children:n.description})]},a)})})]})}),l.jsx("section",{className:"py-20 bg-blue-600",children:l.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[l.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-white mb-6",children:"Ready to Take Control of Your Finances?"}),l.jsx("p",{className:"text-xl text-blue-100 mb-8",children:"Join thousands of users who trust Shopsynk for their financial management needs."}),l.jsxs("button",{onClick:()=>e("/register"),className:"bg-white text-blue-600 px-8 py-4 rounded-lg text-lg font-semibold hover:bg-gray-50 transition-colors inline-flex items-center space-x-2",children:[l.jsx("span",{children:"Start Managing Your Money"}),l.jsx(Io,{className:"h-5 w-5"})]})]})}),l.jsx("footer",{className:"bg-gray-900 text-white py-12",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center",children:[l.jsxs("div",{className:"flex items-center space-x-3 mb-4 md:mb-0",children:[l.jsx("img",{src:"/pwa opning/SHOP.png",alt:"Shopsynk Logo",className:"h-8 w-8"}),l.jsx("span",{className:"text-xl font-bold",children:"Shopsynk"})]}),l.jsxs("div",{className:"flex items-center space-x-6 text-sm text-gray-400",children:[l.jsx("span",{children:"Version 1.4.2 - Bugs Fixed"}),l.jsx("span",{children:"‚Ä¢"}),l.jsx("span",{children:"¬© 2025 Shopsynk"})]})]})})})]})},$8=()=>{const{user:e}=aa(),t=Hs(),[r,n]=M.useState({totalDues:0,totalSuppliers:0,totalTransactions:0,pendingPayments:0,recentTransactions:[],upcomingDues:[]}),[a,i]=M.useState(!0),[s,o]=M.useState({suppliers:!0,spends:!0,persons:!0,reports:!0,dataStorage:!0,documentation:!0});M.useEffect(()=>{const d=localStorage.getItem("shopsynk_settings");if(d)try{const p=JSON.parse(d);o(p.features||s)}catch(p){console.error("Error loading feature settings:",p)}},[]),M.useEffect(()=>{c()},[e]);const c=async()=>{if(e)try{const{count:d}=await Ke.from("suppliers").select("*",{count:"exact",head:!0}).eq("user_id",e.id),{count:p}=await Ke.from("transactions").select("*",{count:"exact",head:!0}).eq("user_id",e.id),{data:h}=await Ke.from("transactions").select("*").eq("user_id",e.id),x=new Map;h==null||h.forEach(N=>{const F=N.supplier_id;x.has(F)||x.set(F,0),N.type==="new_purchase"?x.set(F,x.get(F)+parseFloat(N.amount)):(N.type==="pay_due"||N.type==="settle_bill")&&x.set(F,x.get(F)-parseFloat(N.amount))});let g=0,y=0;x.forEach(N=>{N>.01&&(g+=N,y++)});const{data:b}=await Ke.from("transactions").select(`
          *,
          supplier:suppliers(name),
          owner:business_owners(owner_name)
        `).eq("user_id",e.id).order("created_at",{ascending:!1}).limit(5),{data:E}=await Ke.from("transactions").select(`
          *,
          supplier:suppliers(name),
          owner:business_owners(owner_name)
        `).eq("user_id",e.id).order("created_at",{ascending:!1}),A=new Map;E==null||E.forEach(N=>{var P;const F=N.supplier_id,O=(P=N.supplier)==null?void 0:P.name;A.has(F)||A.set(F,{supplier_id:F,supplier_name:O,balance:0,lastTransaction:N,dueDate:null});const I=A.get(F);N.type==="new_purchase"?(I.balance+=parseFloat(N.amount),N.due_date&&(!I.dueDate||N.due_date<I.dueDate)&&(I.dueDate=N.due_date)):(N.type==="pay_due"||N.type==="settle_bill")&&(I.balance-=parseFloat(N.amount))});const C=Array.from(A.values()).filter(N=>N.balance>.01).map(N=>({id:`outstanding-${N.supplier_id}`,supplier_id:N.supplier_id,supplier:{name:N.supplier_name},amount:N.balance.toFixed(2),description:"Outstanding balance",due_date:N.dueDate,type:"outstanding"})).sort((N,F)=>N.due_date&&!F.due_date?-1:!N.due_date&&F.due_date?1:N.due_date&&F.due_date&&N.due_date!==F.due_date?N.due_date.localeCompare(F.due_date):parseFloat(F.amount)-parseFloat(N.amount)).slice(0,10);n({totalDues:Math.max(0,g),totalSuppliers:d||0,totalTransactions:p||0,pendingPayments:y,recentTransactions:b||[],upcomingDues:C||[]})}catch(d){console.error("Error fetching dashboard data:",d)}finally{i(!1)}},u=d=>{switch(d){case"new_purchase":return l.jsx(Ef,{className:"h-4 w-4 text-red-500"});case"pay_due":case"settle_bill":return l.jsx(Af,{className:"h-4 w-4 text-green-500"});default:return l.jsx(ma,{className:"h-4 w-4 text-gray-500"})}},f=d=>{switch(d){case"new_purchase":return"Purchase";case"pay_due":return"Payment";case"settle_bill":return"Settlement";default:return d}};return a?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):l.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[l.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Dashboard"}),l.jsx("p",{className:"text-gray-600 text-sm",children:"Your business overview"})]})}),l.jsxs("div",{className:`grid gap-3 sm:gap-4 ${s.suppliers?"grid-cols-2 lg:grid-cols-4":"grid-cols-2 lg:grid-cols-3"}`,children:[l.jsx("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:l.jsxs("div",{className:"text-center",children:[l.jsx(en,{className:"h-6 w-6 text-red-500 mx-auto mb-2"}),l.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Outstanding"}),l.jsxs("p",{className:"text-lg font-bold text-red-600",children:["‚Çπ",Math.round(r.totalDues).toLocaleString()]})]})}),s.suppliers&&l.jsx("button",{onClick:()=>t("/suppliers"),className:"bg-white rounded-lg p-4 border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-colors w-full",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Wn,{className:"h-6 w-6 text-blue-500 mx-auto mb-2"}),l.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Suppliers"}),l.jsx("p",{className:"text-lg font-bold text-blue-600",children:r.totalSuppliers})]})}),l.jsx("button",{onClick:()=>t("/transactions"),className:"bg-white rounded-lg p-4 border border-gray-200 hover:border-green-300 hover:bg-green-50 transition-colors w-full",children:l.jsxs("div",{className:"text-center",children:[l.jsx(ma,{className:"h-6 w-6 text-green-500 mx-auto mb-2"}),l.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Transactions"}),l.jsx("p",{className:"text-lg font-bold text-green-600",children:r.totalTransactions})]})}),l.jsx("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:l.jsxs("div",{className:"text-center",children:[l.jsx(Sm,{className:"h-6 w-6 text-orange-500 mx-auto mb-2"}),l.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Pending"}),l.jsx("p",{className:"text-lg font-bold text-orange-600",children:r.pendingPayments})]})})]}),l.jsxs("div",{className:"space-y-4 lg:grid lg:grid-cols-2 lg:gap-6 lg:space-y-0",children:[l.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Recent Activity"}),l.jsx("button",{onClick:()=>t("/transactions"),className:"text-blue-600 text-sm font-medium",children:"View All"})]}),l.jsx("div",{className:"space-y-3",children:r.recentTransactions.length>0?r.recentTransactions.slice(0,4).map(d=>{var p;return l.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[u(d.type),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("p",{className:"font-medium text-gray-900 truncate",children:(p=d.supplier)==null?void 0:p.name}),l.jsx("p",{className:"text-sm text-gray-500",children:f(d.type)})]})]}),l.jsx("div",{className:"text-right",children:l.jsxs("p",{className:`font-medium ${d.type==="new_purchase"?"text-red-600":"text-green-600"}`,children:[d.type==="new_purchase"?"+":"-","‚Çπ",Math.round(parseFloat(d.amount)).toLocaleString()]})})]},d.id)}):l.jsx("p",{className:"text-gray-500 text-center py-6 text-sm",children:"No transactions yet"})})]}),l.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Payments Due"}),l.jsx(Sm,{className:"h-5 w-5 text-orange-400"})]}),l.jsx("div",{className:"space-y-3",children:r.upcomingDues.length>0?r.upcomingDues.slice(0,4).map(d=>{var p;return l.jsxs("div",{className:"flex items-center justify-between p-3 bg-orange-50 rounded-lg border border-orange-100",onClick:()=>t(`/suppliers/${d.supplier_id}`),children:[l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("p",{className:"font-medium text-gray-900 truncate",children:(p=d.supplier)==null?void 0:p.name}),l.jsx("p",{className:"text-sm text-gray-500",children:"Outstanding balance"})]}),l.jsx("div",{className:"text-right",children:l.jsxs("p",{className:"font-medium text-red-600",children:["‚Çπ",Math.round(parseFloat(d.amount)).toLocaleString()]})})]},d.id)}):l.jsxs("div",{className:"text-center py-6",children:[l.jsx(Sm,{className:"h-8 w-8 text-green-500 mx-auto mb-2 opacity-50"}),l.jsx("p",{className:"text-green-600 text-sm font-medium",children:"All payments up to date!"})]})})]})]})]})},z8=()=>{const{user:e}=aa(),t=Hs(),r=Mh(),[n,a]=M.useState([]),[i,s]=M.useState(!0),[o,c]=M.useState(""),[u,f]=M.useState("dues_desc"),[d,p]=M.useState("all"),[h,x]=M.useState(!1),[g,y]=M.useState({name:"",contact_person:"",phone:"",email:"",address:""});M.useEffect(()=>{b()},[e]),M.useEffect(()=>{new URLSearchParams(r.search).get("add")==="true"&&(x(!0),t("/suppliers",{replace:!0}))},[r.search,t]);const b=async()=>{if(e)try{const{data:N,error:F}=await Ke.from("suppliers").select("*").eq("user_id",e.id);if(F)throw F;const{data:O,error:I}=await Ke.from("transactions").select("*").eq("user_id",e.id);if(I)throw I;const P=new Map;O==null||O.forEach(T=>{const j=T.supplier_id;P.has(j)||P.set(j,0),T.type==="new_purchase"?P.set(j,P.get(j)+parseFloat(T.amount)):(T.type==="pay_due"||T.type==="settle_bill")&&P.set(j,P.get(j)-parseFloat(T.amount))});const H=(N||[]).map(T=>({...T,dueAmount:Math.max(0,P.get(T.id)||0)}));a(H)}catch(N){console.error("Error fetching suppliers:",N)}finally{s(!1)}},E=async N=>{if(N.preventDefault(),!!e)try{const{error:F}=await Ke.from("suppliers").insert([{...g,user_id:e.id}]);if(F)throw F;await b(),A()}catch(F){console.error("Error adding supplier:",F)}},A=()=>{y({name:"",contact_person:"",phone:"",email:"",address:""}),x(!1)},C=n.filter(N=>{var I,P,H;const F=N.name.toLowerCase().includes(o.toLowerCase())||((I=N.contact_person)==null?void 0:I.toLowerCase().includes(o.toLowerCase()))||((P=N.phone)==null?void 0:P.includes(o))||((H=N.email)==null?void 0:H.toLowerCase().includes(o.toLowerCase())),O=d==="all"||d==="with_dues"&&N.dueAmount>0||d==="no_dues"&&N.dueAmount===0||d==="high_dues"&&N.dueAmount>1e4||d==="medium_dues"&&N.dueAmount>1e3&&N.dueAmount<=1e4||d==="low_dues"&&N.dueAmount>0&&N.dueAmount<=1e3;return F&&O}).sort((N,F)=>{switch(u){case"dues_desc":return F.dueAmount-N.dueAmount;case"dues_asc":return N.dueAmount-F.dueAmount;case"name_asc":return N.name.localeCompare(F.name);case"name_desc":return F.name.localeCompare(N.name);default:return F.dueAmount-N.dueAmount}});return i?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):l.jsxs("div",{className:"min-h-screen bg-gray-50 p-4 sm:p-6 max-w-7xl mx-auto",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 mb-4 sm:mb-6",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[l.jsxs("div",{className:"text-center sm:text-left",children:[l.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-1",children:"Suppliers"}),l.jsx("p",{className:"text-gray-600 text-sm sm:text-base",children:"Manage your business relationships"})]}),l.jsx("div",{className:"hidden sm:flex items-center",children:l.jsxs("button",{onClick:()=>x(!0),className:"flex items-center justify-center bg-gradient-to-r from-blue-500 to-blue-600 text-white px-5 py-3 rounded-xl hover:from-blue-600 hover:to-blue-700 font-semibold shadow-md transition-all duration-200",children:[l.jsx(Li,{className:"h-5 w-5 mr-2"}),"Add New Supplier"]})})]}),l.jsx("div",{className:"mt-6",children:l.jsxs("div",{className:"relative",children:[l.jsx(Xg,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"Search by name, contact, phone, or email...",value:o,onChange:N=>c(N.target.value),className:"w-full pl-12 pr-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-base"})]})}),l.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row gap-3",children:[l.jsx("div",{className:"flex-1",children:l.jsxs("select",{value:d,onChange:N=>p(N.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white text-base",children:[l.jsx("option",{value:"all",children:"üè¢ All Suppliers"}),l.jsx("option",{value:"with_dues",children:"üí∞ With Dues"}),l.jsx("option",{value:"no_dues",children:"‚úÖ No Dues"}),l.jsxs("option",{value:"high_dues",children:["üî• High Dues (",">","‚Çπ10K)"]}),l.jsx("option",{value:"medium_dues",children:"‚ö†Ô∏è Medium Dues (‚Çπ1K-‚Çπ10K)"}),l.jsxs("option",{value:"low_dues",children:["üìä Low Dues (","<","‚Çπ1K)"]})]})}),l.jsx("div",{className:"flex-1",children:l.jsxs("select",{value:u,onChange:N=>f(N.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white text-base",children:[l.jsx("option",{value:"dues_desc",children:"üìà Highest Dues First"}),l.jsx("option",{value:"dues_asc",children:"üìâ Lowest Dues First"}),l.jsx("option",{value:"name_asc",children:"üî§ Name A to Z"}),l.jsx("option",{value:"name_desc",children:"üî§ Name Z to A"})]})})]}),l.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 mt-6",children:[l.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 p-4 rounded-xl text-center",children:[l.jsx("p",{className:"text-2xl font-bold text-blue-600",children:n.length}),l.jsx("p",{className:"text-xs font-medium text-blue-700",children:"Total Suppliers"})]}),l.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-red-100 p-4 rounded-xl text-center",children:[l.jsx("p",{className:"text-2xl font-bold text-red-600",children:n.filter(N=>N.dueAmount>0).length}),l.jsx("p",{className:"text-xs font-medium text-red-700",children:"With Dues"})]}),l.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 p-4 rounded-xl text-center",children:[l.jsx("p",{className:"text-2xl font-bold text-green-600",children:n.filter(N=>N.dueAmount===0).length}),l.jsx("p",{className:"text-xs font-medium text-green-700",children:"All Clear"})]}),l.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 p-4 rounded-xl text-center",children:[l.jsxs("p",{className:"text-lg font-bold text-purple-600",children:["‚Çπ",Math.round(n.reduce((N,F)=>N+F.dueAmount,0)).toLocaleString()]}),l.jsx("p",{className:"text-xs font-medium text-purple-700",children:"Total Dues"})]})]})]}),l.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:C.length===0?l.jsxs("div",{className:"col-span-full text-center py-16 bg-white rounded-xl shadow-sm",children:[l.jsx("div",{className:"w-20 h-20 mx-auto mb-6 bg-gray-100 rounded-full flex items-center justify-center",children:l.jsx(Wn,{className:"h-10 w-10 text-gray-400"})}),l.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No suppliers found"}),l.jsx("p",{className:"text-gray-500 mb-6",children:o?"Try adjusting your search or filters":"Use the + button below to add your first supplier"})]}):C.map(N=>l.jsxs("div",{onClick:()=>t(`/suppliers/${N.id}`),className:"bg-white rounded-xl border border-gray-200 p-5 hover:border-blue-300 hover:shadow-lg transition-all duration-200 cursor-pointer group transform hover:scale-105",children:[l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("h3",{className:"font-semibold text-gray-900 text-lg truncate group-hover:text-blue-600 transition-colors",children:N.name}),N.contact_person&&l.jsx("p",{className:"text-sm text-gray-600 truncate mt-1",children:N.contact_person})]}),l.jsxs("div",{className:"ml-4 text-right",children:[l.jsxs("div",{className:`px-3 py-1 rounded-full text-sm font-bold ${N.dueAmount>0?N.dueAmount>1e4?"bg-red-100 text-red-700":N.dueAmount>1e3?"bg-yellow-100 text-yellow-700":"bg-orange-100 text-orange-700":"bg-green-100 text-green-700"}`,children:["‚Çπ",Math.round(N.dueAmount).toLocaleString()]}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:N.dueAmount>0?"Due Amount":"All Clear"})]})]}),l.jsxs("div",{className:"flex space-x-2",children:[N.phone&&l.jsx("div",{className:"flex items-center text-sm text-gray-600",children:l.jsx("div",{className:"w-8 h-8 bg-blue-50 rounded-lg flex items-center justify-center",children:l.jsx(Sl,{className:"h-4 w-4 text-blue-500"})})}),N.email&&l.jsx("div",{className:"flex items-center text-sm text-gray-600",children:l.jsx("div",{className:"w-8 h-8 bg-green-50 rounded-lg flex items-center justify-center",children:l.jsx(Cl,{className:"h-4 w-4 text-green-500"})})}),N.address&&l.jsx("div",{className:"flex items-center text-sm text-gray-600",children:l.jsx("div",{className:"w-8 h-8 bg-purple-50 rounded-lg flex items-center justify-center",children:l.jsx(qc,{className:"h-4 w-4 text-purple-500"})})})]}),l.jsx("div",{className:"mt-4 pt-3 border-t border-gray-100",children:l.jsx("p",{className:"text-xs text-gray-400 text-center group-hover:text-blue-400 transition-colors",children:"Tap to view details & manage"})})]},N.id))}),l.jsx("button",{onClick:()=>x(!0),className:"fixed bottom-6 right-6 sm:hidden w-14 h-14 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-full shadow-2xl hover:from-blue-600 hover:to-blue-700 flex items-center justify-center z-40 transform hover:scale-110 transition-all duration-200",style:{boxShadow:"0 10px 25px rgba(59, 130, 246, 0.5)"},children:l.jsx(Li,{className:"h-6 w-6"})}),h&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-50 flex items-end sm:items-center justify-center",children:l.jsxs("div",{className:"bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-lg max-h-[95vh] sm:max-h-[90vh] overflow-y-auto shadow-2xl",children:[l.jsx("div",{className:"sticky top-0 bg-white rounded-t-2xl sm:rounded-t-2xl z-10",children:l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Add New Supplier"}),l.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Fill in the supplier details"})]}),l.jsx("button",{onClick:A,className:"w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center transition-colors",children:l.jsx("span",{className:"text-xl text-gray-500",children:"√ó"})})]})}),l.jsxs("form",{onSubmit:E,className:"p-6 space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Supplier Name *"}),l.jsx("input",{type:"text",value:g.name,onChange:N=>y({...g,name:N.target.value}),required:!0,className:"w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-base transition-colors",placeholder:"Enter supplier or company name"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Contact Person"}),l.jsxs("div",{className:"relative",children:[l.jsx(Wn,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"text",value:g.contact_person,onChange:N=>y({...g,contact_person:N.target.value}),className:"w-full pl-12 pr-4 py-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-base",placeholder:"Primary contact person"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Phone Number"}),l.jsxs("div",{className:"relative",children:[l.jsx(Sl,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"tel",value:g.phone,onChange:N=>y({...g,phone:N.target.value}),className:"w-full pl-12 pr-4 py-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-base",placeholder:"Mobile or landline number"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Email Address"}),l.jsxs("div",{className:"relative",children:[l.jsx(Cl,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"email",value:g.email,onChange:N=>y({...g,email:N.target.value}),className:"w-full pl-12 pr-4 py-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-base",placeholder:"contact@supplier.com"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Business Address"}),l.jsxs("div",{className:"relative",children:[l.jsx(qc,{className:"absolute left-4 top-4 h-5 w-5 text-gray-400"}),l.jsx("textarea",{value:g.address,onChange:N=>y({...g,address:N.target.value}),rows:4,className:"w-full pl-12 pr-4 py-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-base resize-none",placeholder:"Complete business address including city and state"})]})]}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-4",children:[l.jsx("button",{type:"button",onClick:A,className:"order-2 sm:order-1 flex-1 px-6 py-4 text-gray-700 bg-gray-100 rounded-xl hover:bg-gray-200 font-medium transition-colors",children:"Cancel"}),l.jsx("button",{type:"submit",className:"order-1 sm:order-2 flex-1 px-6 py-4 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl hover:from-blue-600 hover:to-blue-700 font-medium shadow-lg transition-all duration-200",children:"Add Supplier"})]})]})]})})]})};class Ps{static getInstance(){return Ps.instance||(Ps.instance=new Ps),Ps.instance}async getBusinessOwners(t){try{const{data:r,error:n}=await Ke.from("business_owners").select("*").eq("user_id",t).eq("is_active",!0).order("is_primary",{ascending:!1}).order("created_at",{ascending:!0});if(n)throw n;return r||[]}catch(r){return console.error("Error fetching business owners:",r),[]}}async getPrimaryOwner(t){try{const{data:r,error:n}=await Ke.from("business_owners").select("*").eq("user_id",t).eq("is_primary",!0).eq("is_active",!0).single();if(n&&n.code!=="PGRST116")throw n;return r||null}catch(r){return console.error("Error fetching primary owner:",r),null}}async createBusinessOwner(t,r){try{const{data:n,error:a}=await Ke.from("business_owners").insert([{user_id:t,owner_name:r.owner_name,role:r.role||"Owner",is_primary:!1,is_active:!0}]).select().single();if(a)throw a;return{success:!0,data:n}}catch(n){return console.error("Error creating business owner:",n),{success:!1,error:n.message||"Failed to create business owner"}}}async updateBusinessOwner(t,r){try{const{data:n,error:a}=await Ke.from("business_owners").update({owner_name:r.owner_name,role:r.role,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(a)throw a;return{success:!0,data:n}}catch(n){return console.error("Error updating business owner:",n),{success:!1,error:n.message||"Failed to update business owner"}}}async deactivateBusinessOwner(t){try{const{data:r,error:n}=await Ke.from("business_owners").select("is_primary").eq("id",t).single();if(n)throw n;if(r.is_primary)return{success:!1,error:"Cannot deactivate the primary owner"};const{error:a}=await Ke.from("business_owners").update({is_active:!1,updated_at:new Date().toISOString()}).eq("id",t);if(a)throw a;return{success:!0}}catch(r){return console.error("Error deactivating business owner:",r),{success:!1,error:r.message||"Failed to deactivate business owner"}}}async getOwnerStats(t){try{const{data:r,error:n}=await Ke.from("owner_transaction_stats").select("*").eq("user_id",t);if(n)throw n;return r||[]}catch(r){return console.error("Error fetching owner stats:",r),[]}}async ensurePrimaryOwner(t,r,n){try{const a=await this.getPrimaryOwner(t);if(a)return a;const i=await this.createBusinessOwner(t,{owner_name:n||r.split("@")[0],role:"Primary Owner",is_primary:!0});return i.success?i.data:null}catch(a){return console.error("Error ensuring primary owner:",a),null}}async updateTransactionOwner(t,r){try{const{error:n}=await Ke.from("transactions").update({owner_id:r}).eq("id",t);if(n)throw n;return{success:!0}}catch(n){return console.error("Error updating transaction owner:",n),{success:!1,error:n.message||"Failed to update transaction owner"}}}async updateSupplierOwner(t,r){try{const{error:n}=await Ke.from("suppliers").update({added_by_owner_id:r}).eq("id",t);if(n)throw n;return{success:!0}}catch(n){return console.error("Error updating supplier owner:",n),{success:!1,error:n.message||"Failed to update supplier owner"}}}}const q8=()=>{const{id:e}=n4(),{user:t}=aa(),r=Hs(),[n,a]=M.useState(null),[i,s]=M.useState([]),[o,c]=M.useState([]),[u,f]=M.useState(!0),[d,p]=M.useState(!1),[h,x]=M.useState(!1),[g,y]=M.useState(!1),[b,E]=M.useState(""),[A,C]=M.useState(""),[N,F]=M.useState(""),[O,I]=M.useState(""),[P,H]=M.useState(""),[T,j]=M.useState(""),[z,K]=M.useState(""),[he,be]=M.useState(0),[we,Q]=M.useState(!1),[le,ke]=M.useState({name:"",contact_person:"",phone:"",email:"",address:""}),[ve,S]=M.useState({totalPurchases:0,totalPaid:0,totalDue:0,transactionCount:0}),[L,D]=M.useState(!1),[R,X]=M.useState({show:!1,x:0,y:0,transaction:null}),[de,me]=M.useState(!1),[Y,oe]=M.useState(null),[ue,fe]=M.useState(""),[Ue,xe]=M.useState(""),te=Pe=>{localStorage.setItem("shopsynk_last_selected_owner",Pe)},nt=()=>localStorage.getItem("shopsynk_last_selected_owner")||"";M.useEffect(()=>{e&&Re()},[e,t]),M.useEffect(()=>{const Pe=()=>{R.show&&Fe()};if(R.show)return document.addEventListener("mousedown",Pe),()=>{document.removeEventListener("mousedown",Pe)}},[R.show]),M.useEffect(()=>{const Pe=()=>{y(!0)},tt=()=>{x(!0)};return window.addEventListener("openPurchaseModal",Pe),window.addEventListener("openPaymentModal",tt),()=>{window.removeEventListener("openPurchaseModal",Pe),window.removeEventListener("openPaymentModal",tt)}},[]);const Re=async()=>{if(!(!t||!e))try{const{data:Pe,error:tt}=await Ke.from("suppliers").select("*").eq("id",e).eq("user_id",t.id).single();if(tt)throw tt;const{data:bt,error:Xt}=await Ke.from("transactions").select(`
          *,
          owner:business_owners(owner_name)
        `).eq("supplier_id",e).eq("user_id",t.id).order("created_at",{ascending:!1});if(Xt)throw Xt;const Wt=await Ps.getInstance().getBusinessOwners(t.id);a(Pe),s(bt||[]),c(Wt||[]);const _t=nt();_t&&Wt&&Wt.some(dn=>dn.id===_t)&&(C(_t),I(_t));let Ut=0,ir=0,Dr=0;bt==null||bt.forEach(dn=>{const Cn=parseFloat(dn.amount.toString());dn.type==="new_purchase"?(Ut+=Cn,dn.is_paid||(Dr+=Cn)):(dn.type==="pay_due"||dn.type==="settle_bill")&&(ir+=Cn,Dr-=Cn)}),be(Math.max(0,Dr)),S({totalPurchases:Ut,totalPaid:ir,totalDue:Math.max(0,Dr),transactionCount:(bt==null?void 0:bt.length)||0})}catch(Pe){console.error("Error fetching supplier data:",Pe)}finally{f(!1)}},ot=async Pe=>{if(Pe.preventDefault(),!(!t||!e||!b||!A||d)){p(!0);try{te(A);const{error:tt}=await Ke.from("transactions").insert([{user_id:t.id,supplier_id:e,type:"pay_due",amount:parseFloat(b),description:z||"Payment made",is_paid:!0,owner_id:A}]);if(tt)throw tt;await Re(),x(!1),E(""),K("")}catch(tt){console.error("Error processing payment:",tt)}finally{p(!1)}}},ze=async Pe=>{if(Pe.preventDefault(),!(!t||!e||!N||!O||d)){p(!0);try{te(O);const{error:tt}=await Ke.from("transactions").insert([{user_id:t.id,supplier_id:e,type:"new_purchase",amount:parseFloat(N),description:P||"New purchase",due_date:T||null,is_paid:!1,owner_id:O}]);if(tt)throw tt;await Re(),y(!1),F(""),H(""),j("")}catch(tt){console.error("Error adding purchase:",tt)}finally{p(!1)}}},lt=async Pe=>{if(Pe.preventDefault(),!(!t||!e))try{const{error:tt}=await Ke.from("suppliers").update(le).eq("id",e).eq("user_id",t.id);if(tt)throw tt;await Re(),Q(!1)}catch(tt){console.error("Error updating supplier:",tt)}},Qe=async()=>{if(!(!t||!e||!window.confirm(`Are you sure you want to delete ${n==null?void 0:n.name}? This will also delete all associated transactions. This action cannot be undone.`)))try{await Ke.from("transactions").delete().eq("supplier_id",e).eq("user_id",t.id);const{error:tt}=await Ke.from("suppliers").delete().eq("id",e).eq("user_id",t.id);if(tt)throw tt;r("/suppliers")}catch(tt){console.error("Error deleting supplier:",tt)}},jt=()=>{n&&(ke({name:n.name,contact_person:n.contact_person||"",phone:n.phone||"",email:n.email||"",address:n.address||""}),Q(!0))},ft=(Pe,tt)=>{Pe.preventDefault(),X({show:!0,x:Pe.clientX,y:Pe.clientY,transaction:tt})},Ot=Pe=>{X({show:!0,x:window.innerWidth/2,y:window.innerHeight/2,transaction:Pe})},Fe=()=>{X({show:!1,x:0,y:0,transaction:null})},Xe=()=>{R.transaction&&(oe(R.transaction),fe(R.transaction.amount.toString()),xe(R.transaction.description||""),me(!0),Fe())},At=async()=>{if(!R.transaction||!t)return;if(!window.confirm("Are you sure you want to delete this transaction? This action cannot be undone.")){Fe();return}try{const{error:tt}=await Ke.from("transactions").delete().eq("id",R.transaction.id).eq("user_id",t.id);if(tt)throw tt;await Re(),Fe()}catch(tt){console.error("Error deleting transaction:",tt)}},xt=(Pe,tt=500)=>{const[bt,Xt]=M.useState(!1),wr=M.useRef(),Wt=M.useRef(),_t=M.useCallback(ir=>{ir.type==="mousedown"&&ir.button!==0||(wr.current=setTimeout(()=>{Pe(),Xt(!0)},tt),Wt.current=ir.target)},[Pe,tt]),Ut=M.useCallback(ir=>{wr.current&&clearTimeout(wr.current),bt&&(ir.preventDefault(),ir.stopPropagation()),Xt(!1)},[bt]);return{onMouseDown:ir=>_t(ir),onTouchStart:ir=>_t(ir),onMouseUp:ir=>Ut(ir),onTouchEnd:ir=>Ut(ir),onMouseLeave:ir=>Ut(ir)}},st=async Pe=>{if(Pe.preventDefault(),!(!Y||!t||!ue))try{const{error:tt}=await Ke.from("transactions").update({amount:parseFloat(ue),description:Ue||null}).eq("id",Y.id).eq("user_id",t.id);if(tt)throw tt;await Re(),me(!1),oe(null),fe(""),xe("")}catch(tt){console.error("Error updating transaction:",tt)}},pt=Pe=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(Pe),dt=Pe=>new Date(Pe).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"}),Qt=Pe=>{switch(Pe){case"new_purchase":return l.jsx(Ef,{className:"h-5 w-5 text-red-500"});case"pay_due":case"settle_bill":return l.jsx(Af,{className:"h-5 w-5 text-green-500"});default:return l.jsx(ma,{className:"h-5 w-5 text-gray-500"})}},$t=Pe=>{switch(Pe){case"new_purchase":return"Purchase";case"pay_due":return"Payment";case"settle_bill":return"Settlement";default:return Pe}},mt=Pe=>{switch(Pe){case"new_purchase":return"text-red-600";case"pay_due":case"settle_bill":return"text-green-600";default:return"text-gray-600"}},Tt=()=>{n!=null&&n.phone&&(window.location.href=`tel:${n.phone}`)};if(u)return l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});if(!n)return l.jsxs("div",{className:"text-center py-12",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Supplier not found"}),l.jsx("button",{onClick:()=>r("/suppliers"),className:"text-blue-600 hover:text-blue-700",children:"Back to Suppliers"})]});const er=({transaction:Pe})=>{var bt;const tt=xt(()=>Ot(Pe));return l.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors cursor-pointer select-none",onContextMenu:Xt=>ft(Xt,Pe),...tt,children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[Qt(Pe.type),l.jsxs("div",{children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("span",{className:"font-medium text-gray-900",children:$t(Pe.type)}),!Pe.is_paid&&Pe.type==="new_purchase"&&l.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-red-100 text-red-700 rounded-full",children:"Unpaid"})]}),l.jsx("p",{className:"text-gray-600 text-sm",children:Pe.description}),((bt=Pe.owner)==null?void 0:bt.owner_name)&&l.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:[Pe.type==="new_purchase"?"Purchased by: ":"Paid by: ",Pe.owner.owner_name]}),l.jsxs("div",{className:"flex items-center space-x-4 mt-1 text-xs text-gray-500",children:[l.jsxs("span",{className:"flex items-center",children:[l.jsx(Po,{className:"h-3 w-3 mr-1"}),dt(Pe.created_at)]}),Pe.due_date&&l.jsxs("span",{children:["Due: ",dt(Pe.due_date)]})]})]})]}),l.jsx("div",{className:"text-right",children:l.jsxs("p",{className:`text-lg font-semibold ${mt(Pe.type)}`,children:[Pe.type==="new_purchase"?"+":"-",pt(parseFloat(Pe.amount.toString()))]})})]})},Pe.id)};return l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white shadow-sm sticky top-0 z-30",children:l.jsxs("div",{className:"flex items-center px-4 py-3",children:[l.jsx("button",{onClick:()=>r("/suppliers"),className:"p-2 hover:bg-gray-100 rounded-full transition-colors mr-2",children:l.jsx(To,{className:"h-5 w-5 text-gray-600"})}),l.jsxs("button",{onClick:()=>D(!0),className:"flex items-center space-x-3 flex-1 text-left hover:bg-gray-50 p-2 rounded-lg transition-colors",children:[l.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white font-semibold",children:n.name.charAt(0).toUpperCase()}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("h1",{className:"text-lg font-semibold text-gray-900 truncate",children:n.name}),l.jsx("p",{className:"text-sm text-gray-500 truncate",children:n.contact_person?`Contact: ${n.contact_person}`:"Business Supplier"})]})]}),l.jsx("button",{onClick:n.phone?Tt:void 0,className:`p-3 rounded-full transition-colors ${n.phone?"hover:bg-green-100 text-green-600 cursor-pointer":"text-gray-300 cursor-not-allowed"}`,disabled:!n.phone,title:n.phone?`Call ${n.phone}`:"No phone number available",children:l.jsx(Sl,{className:"h-5 w-5"})})]})}),L&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[60] flex items-center justify-center p-4",children:l.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md max-h-[90vh] overflow-hidden",children:[l.jsxs("div",{className:"bg-blue-500 text-white p-6 text-center",children:[l.jsx("div",{className:"w-24 h-24 bg-white bg-opacity-20 rounded-full flex items-center justify-center text-3xl font-bold mx-auto mb-3",children:n.name.charAt(0).toUpperCase()}),l.jsx("h2",{className:"text-xl font-semibold",children:n.name}),n.contact_person&&l.jsx("p",{className:"text-blue-100 text-sm mt-1",children:n.contact_person})]}),l.jsxs("div",{className:"p-4 space-y-4",children:[n.phone&&l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:l.jsx(Sl,{className:"h-5 w-5 text-green-600"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"font-medium text-gray-900",children:n.phone}),l.jsx("p",{className:"text-sm text-gray-500",children:"Mobile"})]}),l.jsx("button",{onClick:Tt,className:"bg-green-500 text-white px-4 py-2 rounded-full hover:bg-green-600 transition-colors",children:"Call"})]}),n.email&&l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx(Cl,{className:"h-5 w-5 text-blue-600"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"font-medium text-gray-900",children:n.email}),l.jsx("p",{className:"text-sm text-gray-500",children:"Email"})]})]}),n.address&&l.jsxs("div",{className:"flex items-start space-x-4",children:[l.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:l.jsx(qc,{className:"h-5 w-5 text-purple-600"})}),l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"font-medium text-gray-900",children:n.address}),l.jsx("p",{className:"text-sm text-gray-500",children:"Address"})]})]}),l.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Outstanding Amount"}),l.jsx("p",{className:`text-2xl font-bold ${ve.totalDue>0?"text-red-600":"text-green-600"}`,children:pt(ve.totalDue)})]})]}),l.jsxs("div",{className:"p-4 border-t border-gray-200 space-y-3",children:[l.jsxs("div",{className:"flex space-x-3",children:[l.jsxs("button",{onClick:()=>{D(!1),jt()},className:"flex-1 bg-blue-500 text-white py-3 rounded-lg hover:bg-blue-600 transition-colors flex items-center justify-center",children:[l.jsx(qr,{className:"h-4 w-4 mr-2"}),"Edit Profile"]}),l.jsxs("button",{onClick:()=>{D(!1),Qe()},className:"flex-1 bg-red-500 text-white py-3 rounded-lg hover:bg-red-600 transition-colors flex items-center justify-center",children:[l.jsx(Do,{className:"h-4 w-4 mr-2"}),"Delete Profile"]})]}),l.jsx("button",{onClick:()=>D(!1),className:"w-full bg-gray-100 text-gray-700 py-3 rounded-lg hover:bg-gray-200 transition-colors",children:"Close"})]})]})}),l.jsxs("div",{className:"max-w-4xl mx-auto p-4 space-y-6",children:[l.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6",children:l.jsxs("div",{className:"flex flex-col sm:flex-row items-center justify-center sm:justify-between gap-4 w-full",children:[l.jsxs("div",{className:"text-center sm:text-left",children:[l.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Outstanding Amount"}),l.jsx("p",{className:`text-4xl font-bold ${ve.totalDue>0?"text-red-600":"text-green-600"}`,children:pt(ve.totalDue)})]}),l.jsxs("div",{className:"hidden sm:flex items-center space-x-3",children:[l.jsxs("button",{onClick:()=>y(!0),className:"flex items-center justify-center bg-red-500 text-white px-5 py-3 rounded-xl hover:bg-red-600 font-semibold shadow-md transition-all",children:[l.jsx(dy,{className:"h-5 w-5 mr-2"}),"Add Purchase"]}),l.jsxs("button",{onClick:()=>x(!0),className:"flex items-center justify-center bg-green-500 text-white px-5 py-3 rounded-xl hover:bg-green-600 font-semibold shadow-md transition-all",children:[l.jsx(M1,{className:"h-5 w-5 mr-2"}),"Pay Due"]})]})]})}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:l.jsx(M1,{className:"h-6 w-6 text-green-600"})}),l.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Total Paid"}),l.jsx("p",{className:"text-2xl font-bold text-green-600",children:pt(ve.totalPaid)})]})}),l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:l.jsx(dy,{className:"h-6 w-6 text-blue-600"})}),l.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Total Purchases"}),l.jsx("p",{className:"text-2xl font-bold text-blue-600",children:pt(ve.totalPurchases)})]})}),l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:l.jsx(ma,{className:"h-6 w-6 text-gray-600"})}),l.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Total Transactions"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ve.transactionCount})]})})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[l.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[l.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:l.jsx(qr,{className:"h-6 w-6 text-blue-600"})}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:n.name}),n.contact_person&&l.jsx("p",{className:"text-gray-600",children:n.contact_person})]})]}),l.jsxs("div",{className:"space-y-4",children:[n.phone&&l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(Sl,{className:"h-5 w-5 text-gray-400"}),l.jsx("span",{className:"text-gray-700",children:n.phone})]}),n.email&&l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(Cl,{className:"h-5 w-5 text-gray-400"}),l.jsx("span",{className:"text-gray-700",children:n.email})]}),n.address&&l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx(qc,{className:"h-5 w-5 text-gray-400 mt-0.5"}),l.jsx("span",{className:"text-gray-700",children:n.address})]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Payment Status"}),l.jsx(en,{className:"h-5 w-5 text-gray-400"})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-sm text-gray-600",children:"Payment Rate"}),l.jsx("span",{className:"text-sm font-medium",children:ve.totalPurchases>0?`${Math.round(ve.totalPaid/ve.totalPurchases*100)}%`:"0%"})]}),l.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:l.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:ve.totalPurchases>0?`${Math.min(ve.totalPaid/ve.totalPurchases*100,100)}%`:"0%"}})}),l.jsxs("div",{className:"text-center pt-2",children:[l.jsx("p",{className:`text-2xl font-bold ${ve.totalDue>0?"text-red-600":"text-green-600"}`,children:ve.totalDue>0?pt(ve.totalDue):"All Clear!"}),l.jsx("p",{className:"text-sm text-gray-600 mt-1",children:ve.totalDue>0?"Outstanding Balance":"No pending dues"})]})]})]})]}),l.jsx("div",{className:"lg:col-span-2",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[l.jsx("div",{className:"p-6 border-b border-gray-200",children:l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Transaction History"})}),l.jsx("div",{className:"p-6",children:i.length>0?l.jsx("div",{className:"space-y-4",children:i.map(Pe=>l.jsx(er,{transaction:Pe},Pe.id))}):l.jsxs("div",{className:"text-center py-8",children:[l.jsx(ma,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500",children:"No transactions yet with this supplier"})]})})]})})]}),h&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[60]",children:l.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[l.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:["Pay Due to ",n.name]}),l.jsxs("form",{onSubmit:ot,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Amount *"}),l.jsxs("div",{className:"relative",children:[l.jsx(en,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"number",step:"0.01",required:!0,value:b,onChange:Pe=>E(Pe.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Enter payment amount"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),l.jsx("input",{type:"text",value:z,onChange:Pe=>K(Pe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Payment description (optional)"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Made By *"}),l.jsxs("select",{value:A,onChange:Pe=>C(Pe.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",children:[l.jsx("option",{value:"",children:"Select who made this payment"}),o.map(Pe=>l.jsxs("option",{value:Pe.id,children:[Pe.owner_name," ",Pe.is_primary&&"(Primary)"," - ",Pe.role]},Pe.id))]})]}),l.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:l.jsxs("p",{className:"text-sm text-green-700",children:["Current outstanding: ",l.jsx("span",{className:"font-medium",children:pt(he)})]})}),l.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[l.jsx("button",{type:"button",onClick:()=>x(!1),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),l.jsx("button",{type:"submit",disabled:d,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:bg-green-400",children:d?"Processing...":"Process Payment"})]})]})]})}),g&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[60]",children:l.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[l.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:["New Purchase from ",n.name]}),l.jsxs("form",{onSubmit:ze,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Purchase Amount *"}),l.jsxs("div",{className:"relative",children:[l.jsx(en,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"number",step:"0.01",required:!0,value:N,onChange:Pe=>F(Pe.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter purchase amount"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),l.jsx("input",{type:"text",value:P,onChange:Pe=>H(Pe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Purchase description (optional)"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Purchase Made By *"}),l.jsxs("select",{value:O,onChange:Pe=>I(Pe.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"",children:"Select who made this purchase"}),o.map(Pe=>l.jsxs("option",{value:Pe.id,children:[Pe.owner_name," ",Pe.is_primary&&"(Primary)"," - ",Pe.role]},Pe.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Due Date"}),l.jsx("input",{type:"date",value:T,onChange:Pe=>j(Pe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),l.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[l.jsx("button",{type:"button",onClick:()=>y(!1),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),l.jsx("button",{type:"submit",disabled:d,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:bg-blue-400",children:d?"Adding...":"Add Purchase"})]})]})]})}),we&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[60] flex items-end sm:items-center justify-center p-4",children:l.jsxs("div",{className:"bg-white rounded-t-xl sm:rounded-xl w-full sm:max-w-md max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Edit Supplier"}),l.jsx("button",{onClick:()=>Q(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:"√ó"})]}),l.jsxs("form",{onSubmit:lt,className:"p-4 space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supplier Name *"}),l.jsx("input",{type:"text",value:le.name,onChange:Pe=>ke({...le,name:Pe.target.value}),required:!0,className:"w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Person"}),l.jsx("input",{type:"text",value:le.contact_person,onChange:Pe=>ke({...le,contact_person:Pe.target.value}),className:"w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),l.jsx("input",{type:"tel",value:le.phone,onChange:Pe=>ke({...le,phone:Pe.target.value}),className:"w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),l.jsx("input",{type:"email",value:le.email,onChange:Pe=>ke({...le,email:Pe.target.value}),className:"w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),l.jsx("textarea",{value:le.address,onChange:Pe=>ke({...le,address:Pe.target.value}),rows:3,className:"w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),l.jsxs("div",{className:"flex space-x-3 pt-2",children:[l.jsx("button",{type:"button",onClick:()=>Q(!1),className:"flex-1 px-4 py-2.5 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Cancel"}),l.jsx("button",{type:"submit",className:"flex-1 px-4 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Update Supplier"})]})]})]})}),R.show&&l.jsxs("div",{className:"fixed z-[70] bg-white rounded-lg shadow-lg border border-gray-200 py-2 min-w-32",style:{left:Math.min(R.x,window.innerWidth-160),top:Math.min(R.y,window.innerHeight-100)},children:[l.jsxs("button",{onClick:Xe,className:"w-full text-left px-4 py-2 hover:bg-gray-50 flex items-center text-gray-700",children:[l.jsx(Ac,{className:"h-4 w-4 mr-3 text-blue-600"}),"Edit Transaction"]}),l.jsxs("button",{onClick:At,className:"w-full text-left px-4 py-2 hover:bg-gray-50 flex items-center text-gray-700",children:[l.jsx(Do,{className:"h-4 w-4 mr-3 text-red-600"}),"Delete Transaction"]})]}),de&&Y&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[60]",children:l.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Edit Transaction"}),l.jsxs("form",{onSubmit:st,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount *"}),l.jsxs("div",{className:"relative",children:[l.jsx(en,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"number",step:"0.01",required:!0,value:ue,onChange:Pe=>fe(Pe.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter amount"})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),l.jsx("input",{type:"text",value:Ue,onChange:Pe=>xe(Pe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Transaction description"})]}),l.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[l.jsxs("p",{className:"text-sm text-blue-700",children:["Type: ",l.jsx("span",{className:"font-medium",children:$t(Y.type)})]}),l.jsxs("p",{className:"text-sm text-blue-700",children:["Date: ",l.jsx("span",{className:"font-medium",children:dt(Y.created_at)})]})]}),l.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[l.jsx("button",{type:"button",onClick:()=>me(!1),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),l.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Update Transaction"})]})]})]})})]})]})},W8=()=>{const{user:e}=aa(),t=Hs(),r=Mh(),[n,a]=M.useState([]),[i,s]=M.useState(!0),[o,c]=M.useState(""),[u,f]=M.useState("loans_desc"),[d,p]=M.useState("all"),[h,x]=M.useState(!1),[g,y]=M.useState({name:"",company:"",phone:"",address:""});M.useEffect(()=>{b()},[e]),M.useEffect(()=>{new URLSearchParams(r.search).get("add")==="true"&&(x(!0),t("/persons",{replace:!0}))},[r.search,t]);const b=async()=>{if(e)try{const{data:N,error:F}=await Ke.from("persons").select("*").eq("user_id",e.id);if(F)throw F;const{data:O,error:I}=await Ke.from("loan_transactions").select("*").eq("user_id",e.id);if(I)throw I;const P=new Map;O==null||O.forEach(T=>{const j=T.person_id;P.has(j)||P.set(j,0),T.type==="Gives"?P.set(j,P.get(j)+parseFloat(T.amount)):T.type==="Takes"&&P.set(j,P.get(j)-parseFloat(T.amount))});const H=(N||[]).map(T=>({...T,loanAmount:P.get(T.id)||0}));a(H)}catch(N){console.error("Error fetching persons:",N)}finally{s(!1)}},E=async N=>{if(N.preventDefault(),!!e)try{const{error:F}=await Ke.from("persons").insert([{...g,user_id:e.id}]);if(F)throw F;await b(),A()}catch(F){console.error("Error adding person:",F)}},A=()=>{y({name:"",company:"",phone:"",address:""}),x(!1)},C=n.filter(N=>{var I,P,H;const F=N.name.toLowerCase().includes(o.toLowerCase())||((I=N.company)==null?void 0:I.toLowerCase().includes(o.toLowerCase()))||((P=N.phone)==null?void 0:P.includes(o))||((H=N.address)==null?void 0:H.toLowerCase().includes(o.toLowerCase())),O=d==="all"||d==="gives_outstanding"&&N.loanAmount>0||d==="takes_outstanding"&&N.loanAmount<0||d==="settled"&&N.loanAmount===0||d==="high_amount"&&Math.abs(N.loanAmount)>1e4||d==="medium_amount"&&Math.abs(N.loanAmount)>1e3&&Math.abs(N.loanAmount)<=1e4||d==="low_amount"&&Math.abs(N.loanAmount)>0&&Math.abs(N.loanAmount)<=1e3;return F&&O}).sort((N,F)=>{switch(u){case"loans_desc":return F.loanAmount-N.loanAmount;case"loans_asc":return N.loanAmount-F.loanAmount;case"name_asc":return N.name.localeCompare(F.name);case"name_desc":return F.name.localeCompare(N.name);default:return F.loanAmount-N.loanAmount}});return i?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):l.jsxs("div",{className:"min-h-screen bg-gray-50 p-4 sm:p-6 max-w-7xl mx-auto",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 mb-4 sm:mb-6",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[l.jsxs("div",{className:"text-center sm:text-left",children:[l.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900 mb-1",children:"Persons"}),l.jsx("p",{className:"text-gray-600 text-sm sm:text-base",children:"Manage your loan relationships"})]}),l.jsx("div",{className:"hidden sm:flex items-center",children:l.jsxs("button",{onClick:()=>x(!0),className:"flex items-center justify-center bg-gradient-to-r from-green-500 to-green-600 text-white px-5 py-3 rounded-xl hover:from-green-600 hover:to-green-700 font-semibold shadow-md transition-all duration-200",children:[l.jsx(Li,{className:"h-5 w-5 mr-2"}),"Add New Person"]})})]}),l.jsx("div",{className:"mt-6",children:l.jsxs("div",{className:"relative",children:[l.jsx(Xg,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"Search by name, company, phone, or address...",value:o,onChange:N=>c(N.target.value),className:"w-full pl-12 pr-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-gray-50 text-base"})]})}),l.jsxs("div",{className:"mt-4 flex flex-col sm:flex-row gap-3",children:[l.jsx("div",{className:"flex-1",children:l.jsxs("select",{value:d,onChange:N=>p(N.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-white text-base",children:[l.jsx("option",{value:"all",children:"üè¢ All Persons"}),l.jsx("option",{value:"gives_outstanding",children:"ÔøΩ Gives Outstanding"}),l.jsx("option",{value:"takes_outstanding",children:"ÔøΩ Takes Outstanding"}),l.jsx("option",{value:"settled",children:"‚úÖ All Settled"}),l.jsxs("option",{value:"high_amount",children:["üî• High Amount (",">","‚Çπ10K)"]}),l.jsx("option",{value:"medium_amount",children:"‚ö†Ô∏è Medium Amount (‚Çπ1K-‚Çπ10K)"}),l.jsxs("option",{value:"low_amount",children:["üìä Low Amount (","<","‚Çπ1K)"]})]})}),l.jsx("div",{className:"flex-1",children:l.jsxs("select",{value:u,onChange:N=>f(N.target.value),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-white text-base",children:[l.jsx("option",{value:"loans_desc",children:"üìà Highest Amount First"}),l.jsx("option",{value:"loans_asc",children:"üìâ Lowest Amount First"}),l.jsx("option",{value:"name_asc",children:"üî§ Name A to Z"}),l.jsx("option",{value:"name_desc",children:"üî§ Name Z to A"})]})})]}),l.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 mt-6",children:[l.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 p-4 rounded-xl text-center",children:[l.jsx("p",{className:"text-2xl font-bold text-green-600",children:n.length}),l.jsx("p",{className:"text-xs font-medium text-green-700",children:"Total Persons"})]}),l.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 p-4 rounded-xl text-center",children:[l.jsx("p",{className:"text-2xl font-bold text-blue-600",children:n.filter(N=>N.loanAmount>0).length}),l.jsx("p",{className:"text-xs font-medium text-blue-700",children:"Gives Outstanding"})]}),l.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 p-4 rounded-xl text-center",children:[l.jsx("p",{className:"text-2xl font-bold text-green-600",children:n.filter(N=>N.loanAmount<0).length}),l.jsx("p",{className:"text-xs font-medium text-green-700",children:"Takes Outstanding"})]}),l.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 p-4 rounded-xl text-center",children:[l.jsxs("p",{className:"text-lg font-bold text-purple-600",children:["‚Çπ",Math.round(n.reduce((N,F)=>N+Math.abs(F.loanAmount),0)).toLocaleString()]}),l.jsx("p",{className:"text-xs font-medium text-purple-700",children:"Total Amount"})]})]})]}),l.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:C.length===0?l.jsxs("div",{className:"col-span-full text-center py-16 bg-white rounded-xl shadow-sm",children:[l.jsx("div",{className:"w-20 h-20 mx-auto mb-6 bg-gray-100 rounded-full flex items-center justify-center",children:l.jsx(Wn,{className:"h-10 w-10 text-gray-400"})}),l.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No persons found"}),l.jsx("p",{className:"text-gray-500 mb-6",children:o?"Try adjusting your search or filters":"Use the + button below to add your first person"})]}):C.map(N=>l.jsxs("div",{onClick:()=>t(`/persons/${N.id}`),className:"bg-white rounded-xl border border-gray-200 p-5 hover:border-green-300 hover:shadow-lg transition-all duration-200 cursor-pointer group transform hover:scale-105",children:[l.jsxs("div",{className:"flex items-start justify-between mb-4",children:[l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsx("h3",{className:"font-semibold text-gray-900 text-lg truncate group-hover:text-green-600 transition-colors",children:N.name}),N.company&&l.jsx("p",{className:"text-sm text-gray-600 truncate mt-1",children:N.company})]}),l.jsxs("div",{className:"ml-4 text-right",children:[l.jsxs("div",{className:`px-3 py-1 rounded-full text-sm font-bold ${N.loanAmount>0?N.loanAmount>1e4?"bg-red-100 text-red-700":N.loanAmount>1e3?"bg-yellow-100 text-yellow-700":"bg-orange-100 text-orange-700":N.loanAmount<0?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:["‚Çπ",Math.round(Math.abs(N.loanAmount)).toLocaleString()]}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:N.loanAmount>0?"Gives Outstanding":N.loanAmount<0?"Takes Outstanding":"All Settled"})]})]}),l.jsxs("div",{className:"flex space-x-2",children:[N.phone&&l.jsx("div",{className:"flex items-center text-sm text-gray-600",children:l.jsx("div",{className:"w-8 h-8 bg-blue-50 rounded-lg flex items-center justify-center",children:l.jsx(Sl,{className:"h-4 w-4 text-blue-500"})})}),N.address&&l.jsx("div",{className:"flex items-center text-sm text-gray-600",children:l.jsx("div",{className:"w-8 h-8 bg-purple-50 rounded-lg flex items-center justify-center",children:l.jsx(qc,{className:"h-4 w-4 text-purple-500"})})})]}),l.jsx("div",{className:"mt-4 pt-3 border-t border-gray-100",children:l.jsx("p",{className:"text-xs text-gray-400 text-center group-hover:text-green-400 transition-colors",children:"Tap to view details & manage"})})]},N.id))}),l.jsx("button",{onClick:()=>x(!0),className:"fixed bottom-6 right-6 sm:hidden w-14 h-14 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-full shadow-2xl hover:from-green-600 hover:to-green-700 flex items-center justify-center z-40 transform hover:scale-110 transition-all duration-200",style:{boxShadow:"0 10px 25px rgba(34, 197, 94, 0.5)"},children:l.jsx(Li,{className:"h-6 w-6"})}),h&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-50 flex items-end sm:items-center justify-center",children:l.jsxs("div",{className:"bg-white rounded-t-2xl sm:rounded-2xl w-full sm:max-w-lg max-h-[95vh] sm:max-h-[90vh] overflow-y-auto shadow-2xl",children:[l.jsx("div",{className:"sticky top-0 bg-white rounded-t-2xl sm:rounded-t-2xl z-10",children:l.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Add New Person"}),l.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Fill in the person details"})]}),l.jsx("button",{onClick:A,className:"w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center transition-colors",children:l.jsx("span",{className:"text-xl text-gray-500",children:"√ó"})})]})}),l.jsxs("form",{onSubmit:E,className:"p-6 space-y-6",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Person Name *"}),l.jsx("input",{type:"text",value:g.name,onChange:N=>y({...g,name:N.target.value}),required:!0,className:"w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-gray-50 text-base transition-colors",placeholder:"Enter person's full name"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Company"}),l.jsx("input",{type:"text",value:g.company,onChange:N=>y({...g,company:N.target.value}),className:"w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-gray-50 text-base transition-colors",placeholder:"Enter company name (optional)"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Phone Number"}),l.jsx("input",{type:"tel",value:g.phone,onChange:N=>y({...g,phone:N.target.value}),className:"w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-gray-50 text-base transition-colors",placeholder:"Enter phone number"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Address"}),l.jsx("textarea",{value:g.address,onChange:N=>y({...g,address:N.target.value}),rows:3,className:"w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-gray-50 text-base transition-colors resize-none",placeholder:"Enter address"})]}),l.jsxs("div",{className:"flex gap-3 pt-4",children:[l.jsx("button",{type:"button",onClick:A,className:"flex-1 py-3 px-4 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors font-semibold",children:"Cancel"}),l.jsx("button",{type:"submit",className:"flex-1 py-3 px-4 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-xl hover:from-green-600 hover:to-green-700 font-semibold transition-all duration-200",children:"Add Person"})]})]})]})})]})},H8=()=>{const{id:e}=n4(),{user:t}=aa(),r=Hs(),[n,a]=M.useState(null),[i,s]=M.useState([]),[o,c]=M.useState([]),[u,f]=M.useState(!0),[d,p]=M.useState(!1),[h,x]=M.useState(!1),[g,y]=M.useState(!1),[b,E]=M.useState(""),[A,C]=M.useState(""),[N,F]=M.useState(""),[O,I]=M.useState(""),[P,H]=M.useState(""),[T,j]=M.useState(""),[z,K]=M.useState(""),[he,be]=M.useState(0),[we,Q]=M.useState(!1),[le,ke]=M.useState({name:"",company:"",phone:"",address:""}),[ve,S]=M.useState({totalLoansGiven:0,totalPaymentsReceived:0,totalOutstanding:0,transactionCount:0}),[L,D]=M.useState({show:!1,x:0,y:0,transaction:null}),[R,X]=M.useState(!1),[de,me]=M.useState(null),[Y,oe]=M.useState(""),[ue,fe]=M.useState(""),Ue=Fe=>{localStorage.setItem("shopsynk_last_selected_owner",Fe)},xe=()=>localStorage.getItem("shopsynk_last_selected_owner")||"";M.useEffect(()=>{e&&te()},[e,t]),M.useEffect(()=>{const Fe=()=>{L.show&&ft()};if(L.show)return document.addEventListener("mousedown",Fe),()=>{document.removeEventListener("mousedown",Fe)}},[L.show]),M.useEffect(()=>{const Fe=()=>x(!0),Xe=()=>y(!0);return window.addEventListener("openPurchaseModal",Fe),window.addEventListener("openPaymentModal",Xe),()=>{window.removeEventListener("openPurchaseModal",Fe),window.removeEventListener("openPaymentModal",Xe)}},[]);const te=M.useCallback(async()=>{if(!(!t||!e))try{f(!0);const{data:Fe,error:Xe}=await Ke.from("persons").select("*").eq("id",e).eq("user_id",t.id).single();if(Xe)throw Xe;a(Fe);const{data:At,error:xt}=await Ke.from("loan_transactions").select(`
          *,
          owner:owner_id (
            owner_name
          )
        `).eq("person_id",e).eq("user_id",t.id).order("created_at",{ascending:!1});if(xt)throw xt;s(At||[]);const st=await Ps.getInstance().getBusinessOwners(t.id);console.log("Fetched business owners:",st),c(st);const pt=xe();pt&&st.find(dt=>dt.id===pt)?(C(pt),I(pt)):st.length>0&&(C(st[0].id),I(st[0].id)),nt(At||[])}catch(Fe){console.error("Error fetching person data:",Fe)}finally{f(!1)}},[e,t]),nt=Fe=>{let Xe=0,At=0,xt=0;Fe.forEach(st=>{st.type==="Gives"?(Xe+=parseFloat(st.amount.toString()),At+=parseFloat(st.amount.toString())):st.type==="Takes"&&(Xe-=parseFloat(st.amount.toString()),xt+=parseFloat(st.amount.toString()))}),be(Xe),S({totalLoansGiven:At,totalPaymentsReceived:xt,totalOutstanding:Math.abs(Xe),transactionCount:Fe.length})},Re=async Fe=>{if(Fe.preventDefault(),console.log("User:",t),console.log("Person:",n),console.log("Loan Amount:",b),console.log("Loan Owner ID:",A),console.log("Business Owners:",o),!t||!n||!b||!A){alert("Please fill in all required fields");return}const Xe=parseFloat(b);if(isNaN(Xe)||Xe<=0){alert("Please enter a valid amount greater than 0");return}p(!0);try{const At={user_id:t.id,person_id:n.id,owner_id:A,type:"Gives",amount:Xe,description:P||"Gives",due_date:z||null};console.log("Inserting transaction:",At);const{error:xt}=await Ke.from("loan_transactions").insert([At]);if(xt)throw console.error("Supabase error:",xt),xt;console.log("Transaction inserted successfully"),E(""),H(""),K(""),x(!1),await te()}catch(At){console.error("Error giving loan:",At),alert("Error creating transaction: "+At.message)}finally{p(!1)}},ot=async Fe=>{if(Fe.preventDefault(),!t||!n||!N||!O){alert("Please fill in all required fields");return}const Xe=parseFloat(N);if(isNaN(Xe)||Xe<=0){alert("Please enter a valid amount greater than 0");return}p(!0);try{const{error:At}=await Ke.from("loan_transactions").insert([{user_id:t.id,person_id:n.id,owner_id:O,type:"Takes",amount:Xe,description:T||"Takes"}]);if(At)throw At;F(""),j(""),y(!1),await te()}catch(At){console.error("Error receiving payment:",At),alert("Error creating transaction: "+At.message)}finally{p(!1)}},ze=async Fe=>{if(Fe.preventDefault(),!!n)try{const{error:Xe}=await Ke.from("persons").update({name:le.name,company:le.company,phone:le.phone,address:le.address}).eq("id",n.id);if(Xe)throw Xe;Q(!1),await te()}catch(Xe){console.error("Error updating person:",Xe)}},lt=async Fe=>{if(confirm("Are you sure you want to delete this transaction?"))try{const{error:Xe}=await Ke.from("loan_transactions").delete().eq("id",Fe);if(Xe)throw Xe;await te(),ft()}catch(Xe){console.error("Error deleting transaction:",Xe)}},Qe=async Fe=>{if(Fe.preventDefault(),!!de)try{const{error:Xe}=await Ke.from("loan_transactions").update({amount:parseFloat(Y),description:ue}).eq("id",de.id);if(Xe)throw Xe;X(!1),me(null),await te()}catch(Xe){console.error("Error updating transaction:",Xe)}},jt=(Fe,Xe)=>{Fe.preventDefault(),D({show:!0,x:Fe.clientX,y:Fe.clientY,transaction:Xe})},ft=()=>{D({show:!1,x:0,y:0,transaction:null})},Ot=()=>{L.transaction&&(me(L.transaction),oe(L.transaction.amount.toString()),fe(L.transaction.description||""),X(!0),ft())};return u?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})}):n?l.jsxs("div",{className:"min-h-screen bg-gray-50",children:[l.jsx("div",{className:"bg-white shadow-sm border-b border-gray-200",children:l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between py-4 sm:h-16 gap-4",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("button",{onClick:()=>r("/persons"),className:"flex items-center text-gray-600 hover:text-gray-900 transition-colors",children:[l.jsx(To,{className:"h-5 w-5 mr-2"}),l.jsx("span",{className:"hidden sm:inline",children:"Back to Persons"})]}),l.jsx("div",{className:"h-6 w-px bg-gray-300 hidden sm:block"}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:n.name}),n.company&&l.jsx("p",{className:"text-sm text-gray-600",children:n.company})]})]}),l.jsx("div",{className:"flex items-center space-x-2 sm:space-x-3 flex-wrap",children:l.jsxs("button",{onClick:()=>{ke({name:n.name,company:n.company||"",phone:n.phone||"",address:n.address||""}),Q(!0)},className:"flex items-center px-3 sm:px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:[l.jsx(Ac,{className:"h-4 w-4 mr-1 sm:mr-2"}),l.jsx("span",{className:"hidden sm:inline",children:"Edit"})]})})]})})}),l.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[l.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[l.jsx(qr,{className:"h-5 w-5 mr-2 text-green-600"}),"Person Information"]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center text-sm",children:[l.jsx(qr,{className:"h-4 w-4 text-gray-400 mr-3 flex-shrink-0"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:n.name}),l.jsx("p",{className:"text-gray-500",children:"Full Name"})]})]}),n.company&&l.jsxs("div",{className:"flex items-center text-sm",children:[l.jsx(vT,{className:"h-4 w-4 text-gray-400 mr-3 flex-shrink-0"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:n.company}),l.jsx("p",{className:"text-gray-500",children:"Company"})]})]}),n.phone&&l.jsxs("div",{className:"flex items-center text-sm",children:[l.jsx("div",{className:"w-8 h-8 bg-blue-50 rounded-lg flex items-center justify-center mr-3",children:l.jsx(Sl,{className:"h-4 w-4 text-blue-500"})}),l.jsx("div",{children:l.jsx("p",{className:"text-gray-500",children:"Phone"})})]}),n.address&&l.jsxs("div",{className:"flex items-center text-sm",children:[l.jsx("div",{className:"w-8 h-8 bg-purple-50 rounded-lg flex items-center justify-center mr-3",children:l.jsx(qc,{className:"h-4 w-4 text-purple-500"})}),l.jsx("div",{children:l.jsx("p",{className:"text-gray-500",children:"Address"})})]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-6 flex items-center",children:[l.jsx(en,{className:"h-5 w-5 mr-2 text-green-600"}),"Loan Summary"]}),l.jsx("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100 rounded-xl p-6 mb-6 border border-gray-200",children:l.jsxs("div",{className:"text-center",children:[l.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Outstanding Amount"}),l.jsx("div",{className:"flex items-center justify-center mb-2",children:l.jsxs("div",{className:`px-6 py-3 rounded-full text-lg font-bold ${he>0?he>1e4?"bg-red-100 text-red-700":he>1e3?"bg-yellow-100 text-yellow-700":"bg-orange-100 text-orange-700":he<0?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700"}`,children:["‚Çπ",Math.abs(he).toLocaleString()]})}),l.jsx("p",{className:"text-sm text-gray-600 font-medium",children:he>0?"Gives Outstanding":he<0?"Takes Outstanding":"All Settled"}),l.jsx("p",{className:"text-xs text-gray-500 mt-1",children:he>0?"Person owes you this amount":he<0?"You owe the person this amount":"No outstanding balance"})]})}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-sm text-gray-600",children:"Total Gives"}),l.jsxs("span",{className:"font-semibold text-red-600",children:["‚Çπ",ve.totalLoansGiven.toLocaleString()]})]}),l.jsxs("div",{className:"flex justify-between items-center",children:[l.jsx("span",{className:"text-sm text-gray-600",children:"Total Takes"}),l.jsxs("span",{className:"font-semibold text-green-600",children:["‚Çπ",ve.totalPaymentsReceived.toLocaleString()]})]}),l.jsxs("div",{className:"flex justify-between items-center text-sm text-gray-500 pt-2 border-t border-gray-200",children:[l.jsx("span",{children:"Total Transactions"}),l.jsx("span",{children:ve.transactionCount})]})]})]})]}),l.jsx("div",{className:"lg:col-span-2",children:l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[l.jsx("div",{className:"p-6 border-b border-gray-200",children:l.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[l.jsx(ma,{className:"h-5 w-5 mr-2 text-green-600"}),"Transaction History"]})}),l.jsx("div",{className:"divide-y divide-gray-200",children:i.length===0?l.jsxs("div",{className:"p-8 text-center",children:[l.jsx(ma,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),l.jsx("h3",{className:"text-sm font-medium text-gray-900 mb-2",children:"No transactions yet"}),l.jsx("p",{className:"text-sm text-gray-500",children:"Start by giving a loan or recording a payment."})]}):i.map(Fe=>l.jsx("div",{className:"p-6 hover:bg-gray-50 transition-colors cursor-pointer",onContextMenu:Xe=>jt(Xe,Fe),children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${Fe.type==="Gives"?"bg-green-100 text-green-600":"bg-blue-100 text-blue-600"}`,children:Fe.type==="Gives"?l.jsx(Ef,{className:"h-5 w-5"}):l.jsx(Af,{className:"h-5 w-5"})}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:Fe.type==="Gives"?"Gives":"Takes"}),l.jsx("p",{className:"text-sm text-gray-600",children:Fe.description}),l.jsxs("div",{className:"flex items-center space-x-4 mt-1",children:[l.jsxs("p",{className:"text-xs text-gray-500 flex items-center",children:[l.jsx(Po,{className:"h-3 w-3 mr-1"}),new Date(Fe.created_at).toLocaleDateString()]}),Fe.owner&&l.jsxs("p",{className:"text-xs text-gray-500 flex items-center",children:[l.jsx(qr,{className:"h-3 w-3 mr-1"}),Fe.owner.owner_name]})]})]})]}),l.jsx("div",{className:"text-right",children:l.jsxs("p",{className:`font-semibold ${Fe.type==="Gives"?"text-green-600":"text-blue-600"}`,children:[Fe.type==="Gives"?"+":"-","‚Çπ",Fe.amount.toLocaleString()]})})]})},Fe.id))})]})})]})}),L.show&&l.jsxs("div",{className:"fixed z-50 bg-white border border-gray-200 rounded-lg shadow-lg py-2 min-w-48",style:{left:L.x,top:L.y},children:[l.jsxs("button",{onClick:Ot,className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center",children:[l.jsx(Ac,{className:"h-4 w-4 mr-2"}),"Edit Transaction"]}),l.jsxs("button",{onClick:()=>lt(L.transaction.id),className:"w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 flex items-center",children:[l.jsx(Do,{className:"h-4 w-4 mr-2"}),"Delete Transaction"]})]}),h&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:l.jsx("div",{className:"bg-white rounded-xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:l.jsxs("div",{className:"p-6",children:[l.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[l.jsx(a4,{className:"h-5 w-5 mr-2 text-green-600"}),"Gives"]}),l.jsxs("form",{onSubmit:Re,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Amount *"}),l.jsx("input",{type:"number",step:"0.01",value:b,onChange:Fe=>E(Fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Enter loan amount",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Business Owner *"}),l.jsx("select",{value:A,onChange:Fe=>{C(Fe.target.value),Ue(Fe.target.value)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",required:!0,children:o.map(Fe=>l.jsx("option",{value:Fe.id,children:Fe.owner_name},Fe.id))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),l.jsx("input",{type:"text",value:P,onChange:Fe=>H(Fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Loan description (optional)"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Due Date"}),l.jsx("input",{type:"date",value:z,onChange:Fe=>K(Fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})]}),l.jsxs("div",{className:"flex space-x-3 pt-4",children:[l.jsx("button",{type:"button",onClick:()=>x(!1),className:"flex-1 py-2 px-4 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),l.jsx("button",{type:"submit",disabled:d,className:"flex-1 py-2 px-4 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg hover:from-green-600 hover:to-green-700 disabled:opacity-50 transition-colors",children:d?"Processing...":"Gives"})]})]})]})})}),g&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:l.jsx("div",{className:"bg-white rounded-xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:l.jsxs("div",{className:"p-6",children:[l.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[l.jsx(en,{className:"h-5 w-5 mr-2 text-blue-600"}),"Takes"]}),l.jsxs("form",{onSubmit:ot,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Amount *"}),l.jsx("input",{type:"number",step:"0.01",value:N,onChange:Fe=>F(Fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter payment amount",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Business Owner *"}),l.jsx("select",{value:O,onChange:Fe=>{I(Fe.target.value),Ue(Fe.target.value)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:o.map(Fe=>l.jsx("option",{value:Fe.id,children:Fe.owner_name},Fe.id))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),l.jsx("input",{type:"text",value:T,onChange:Fe=>j(Fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Payment description (optional)"})]}),l.jsxs("div",{className:"flex space-x-3 pt-4",children:[l.jsx("button",{type:"button",onClick:()=>y(!1),className:"flex-1 py-2 px-4 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),l.jsx("button",{type:"submit",disabled:d,className:"flex-1 py-2 px-4 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg hover:from-blue-600 hover:to-blue-700 disabled:opacity-50 transition-colors",children:d?"Processing...":"Takes"})]})]})]})})}),we&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:l.jsx("div",{className:"bg-white rounded-xl max-w-md w-full max-h-[90vh] overflow-y-auto",children:l.jsxs("div",{className:"p-6",children:[l.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[l.jsx(Ac,{className:"h-5 w-5 mr-2 text-green-600"}),"Edit Person"]}),l.jsxs("form",{onSubmit:ze,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Name *"}),l.jsx("input",{type:"text",value:le.name,onChange:Fe=>ke({...le,name:Fe.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company"}),l.jsx("input",{type:"text",value:le.company,onChange:Fe=>ke({...le,company:Fe.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone"}),l.jsx("input",{type:"tel",value:le.phone,onChange:Fe=>ke({...le,phone:Fe.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),l.jsx("textarea",{value:le.address,onChange:Fe=>ke({...le,address:Fe.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500 resize-none"})]}),l.jsxs("div",{className:"flex space-x-3 pt-4",children:[l.jsx("button",{type:"button",onClick:()=>Q(!1),className:"flex-1 py-2 px-4 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),l.jsx("button",{type:"submit",className:"flex-1 py-2 px-4 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg hover:from-green-600 hover:to-green-700 transition-colors",children:"Update"})]})]})]})})}),R&&de&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:l.jsx("div",{className:"bg-white rounded-xl max-w-md w-full",children:l.jsxs("div",{className:"p-6",children:[l.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-4 flex items-center",children:[l.jsx(Ac,{className:"h-5 w-5 mr-2 text-green-600"}),"Edit Transaction"]}),l.jsxs("form",{onSubmit:Qe,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Amount *"}),l.jsx("input",{type:"number",step:"0.01",value:Y,onChange:Fe=>oe(Fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",required:!0})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),l.jsx("input",{type:"text",value:ue,onChange:Fe=>fe(Fe.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})]}),l.jsxs("div",{className:"flex space-x-3 pt-4",children:[l.jsx("button",{type:"button",onClick:()=>{X(!1),me(null)},className:"flex-1 py-2 px-4 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),l.jsx("button",{type:"submit",className:"flex-1 py-2 px-4 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-lg hover:from-green-600 hover:to-green-700 transition-colors",children:"Update"})]})]})]})})})]}):l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsxs("div",{className:"text-center",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Person not found"}),l.jsx("button",{onClick:()=>r("/persons"),className:"text-green-600 hover:text-green-700",children:"Back to Persons"})]})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Id={};Id.version="0.18.5";var p4=1252,G8=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],m4=function(e){G8.indexOf(e)!=-1&&(p4=e)};function V8(){m4(1252)}var jf=function(e){m4(e)};function K8(){jf(1200),V8()}var V0=function(t){return String.fromCharCode(t)},_y=function(t){return String.fromCharCode(t)},fl,So="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Tf(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0,c=0,u=0;u<e.length;)r=e.charCodeAt(u++),i=r>>2,n=e.charCodeAt(u++),s=(r&3)<<4|n>>4,a=e.charCodeAt(u++),o=(n&15)<<2|a>>6,c=a&63,isNaN(n)?o=c=64:isNaN(a)&&(c=64),t+=So.charAt(i)+So.charAt(s)+So.charAt(o)+So.charAt(c);return t}function Ms(e){var t="",r=0,n=0,a=0,i=0,s=0,o=0,c=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)i=So.indexOf(e.charAt(u++)),s=So.indexOf(e.charAt(u++)),r=i<<2|s>>4,t+=String.fromCharCode(r),o=So.indexOf(e.charAt(u++)),n=(s&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),c=So.indexOf(e.charAt(u++)),a=(o&3)<<6|c,c!==64&&(t+=String.fromCharCode(a));return t}var ar=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Gs=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Ol(e){return ar?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function Ny(e){return ar?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var ki=function(t){return ar?Gs(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function Bh(e){if(typeof ArrayBuffer>"u")return ki(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function Qf(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function Y8(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var zn=ar?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Gs(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function X8(e){for(var t=[],r=0,n=e.length+250,a=Ol(e.length+255),i=0;i<e.length;++i){var s=e.charCodeAt(i);if(s<128)a[r++]=s;else if(s<2048)a[r++]=192|s>>6&31,a[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++i)&1023;a[r++]=240|s>>8&7,a[r++]=128|s>>2&63,a[r++]=128|o>>6&15|(s&3)<<4,a[r++]=128|o&63}else a[r++]=224|s>>12&15,a[r++]=128|s>>6&63,a[r++]=128|s&63;r>n&&(t.push(a.slice(0,r)),r=0,a=Ol(65535),n=65530)}return t.push(a.slice(0,r)),zn(t)}var mf=/\u0000/g,K0=/[\u0001-\u0006]/g;function Cc(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Fi(e,t){var r=""+e;return r.length>=t?r:$r("0",t-r.length)+r}function ex(e,t){var r=""+e;return r.length>=t?r:$r(" ",t-r.length)+r}function Md(e,t){var r=""+e;return r.length>=t?r:r+$r(" ",t-r.length)}function Z8(e,t){var r=""+Math.round(e);return r.length>=t?r:$r("0",t-r.length)+r}function J8(e,t){var r=""+e;return r.length>=t?r:$r("0",t-r.length)+r}var Sy=Math.pow(2,32);function dc(e,t){if(e>Sy||e<-Sy)return Z8(e,t);var r=Math.round(e);return J8(r,t)}function Rd(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var Ay=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Pm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Q8(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"‰∏äÂçà/‰∏ãÂçà "hh"ÊôÇ"mm"ÂàÜ"ss"Áßí "',e}var Wr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"‰∏äÂçà/‰∏ãÂçà "hh"ÊôÇ"mm"ÂàÜ"ss"Áßí "'},Ey={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},eP={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Bd(e,t,r){for(var n=e<0?-1:1,a=e*n,i=0,s=1,o=0,c=1,u=0,f=0,d=Math.floor(a);u<t&&(d=Math.floor(a),o=d*s+i,f=d*u+c,!(a-d<5e-8));)a=1/(a-d),i=s,s=o,c=u,u=f;if(f>t&&(u>t?(f=c,o=i):(f=u,o=s)),!r)return[0,n*o,f];var p=Math.floor(n*o/f);return[p,n*o-p*f,f]}function Y0(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),i=0,s=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)s=r?[1317,10,29]:[1900,2,29],i=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],i=6;else{n>60&&--n;var c=new Date(1900,0,1);c.setDate(c.getDate()+n-1),s=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),n<60&&(i=(i+6)%7),r&&(i=oP(c,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=i,o}var g4=new Date(1899,11,31,0,0,0),tP=g4.getTime(),rP=new Date(1900,2,1,0,0,0);function x4(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=rP&&(r+=24*60*60*1e3),(r-(tP+(e.getTimezoneOffset()-g4.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function tx(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function nP(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function aP(e){var t=e<0?12:11,r=tx(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function iP(e){var t=tx(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function sP(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=aP(e):t===10?r=e.toFixed(10).substr(0,12):r=iP(e),tx(nP(r.toUpperCase()))}function q1(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):sP(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Ro(14,x4(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function oP(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function lP(e,t,r,n){var a="",i=0,s=0,o=r.y,c,u=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:c=o%100,u=2;break;default:c=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:c=r.m,u=t.length;break;case 3:return Pm[r.m-1][1];case 5:return Pm[r.m-1][0];default:return Pm[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:c=r.d,u=t.length;break;case 3:return Ay[r.q][0];default:return Ay[r.q][1]}break;case 104:switch(t.length){case 1:case 2:c=1+(r.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:c=r.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:c=r.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Fi(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,i=Math.round(s*(r.S+r.u)),i>=60*s&&(i=0),t==="s"?i===0?"0":""+i/s:(a=Fi(i,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":c=r.D*24+r.H;break;case"[m]":case"[mm]":c=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":c=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:c=o,u=1;break}var f=u>0?Fi(c,u):"";return f}function Ao(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var v4=/%/g;function cP(e,t,r){var n=t.replace(v4,""),a=t.length-n.length;return Os(e,n,r*Math.pow(10,2*a))+$r("%",a)}function uP(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Os(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function y4(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+y4(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,f){return c+u+f.substr(0,(a+i)%a)+"."+f.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var b4=/# (\?+)( ?)\/( ?)(\d+)/;function fP(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),i=Math.floor(a/n),s=a-i*n,o=n;return r+(i===0?"":""+i)+" "+(s===0?$r(" ",e[1].length+1+e[4].length):ex(s,e[1].length)+e[2]+"/"+e[3]+Fi(o,e[4].length))}function dP(e,t,r){return r+(t===0?"":""+t)+$r(" ",e[1].length+2+e[4].length)}var w4=/^#*0*\.([0#]+)/,_4=/\).*[0#]/,N4=/\(###\) ###\\?-####/;function fa(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function jy(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function Ty(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function hP(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function pP(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function si(e,t,r){if(e.charCodeAt(0)===40&&!t.match(_4)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?si("n",n,r):"("+si("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return uP(e,t,r);if(t.indexOf("%")!==-1)return cP(e,t,r);if(t.indexOf("E")!==-1)return y4(t,r);if(t.charCodeAt(0)===36)return"$"+si(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+dc(c,t.length);if(t.match(/^[#?]+$/))return a=dc(r,0),a==="0"&&(a=""),a.length>t.length?a:fa(t.substr(0,t.length-a.length))+a;if(i=t.match(b4))return fP(i,c,u);if(t.match(/^#+0+$/))return u+dc(c,t.length-t.indexOf("0"));if(i=t.match(w4))return a=jy(r,i[1].length).replace(/^([^\.]+)$/,"$1."+fa(i[1])).replace(/\.$/,"."+fa(i[1])).replace(/\.(\d*)$/,function(x,g){return"."+g+$r("0",fa(i[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+jy(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+Ao(dc(c,0));if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+si(e,t,-r):Ao(""+(Math.floor(r)+hP(r,i[1].length)))+"."+Fi(Ty(r,i[1].length),i[1].length);if(i=t.match(/^#,#*,#0/))return si(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Cc(si(e,t.replace(/[\\-]/g,""),r)),s=0,Cc(Cc(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return s<a.length?a.charAt(s++):x==="0"?"0":""}));if(t.match(N4))return a=si(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Bd(c,Math.pow(10,s)-1,!1),a=""+u,f=Os("n",i[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+i[2]+"/"+i[3],f=Md(o[2],s),f.length<i[4].length&&(f=fa(i[4].substr(i[4].length-f.length))+f),a+=f,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=Bd(c,Math.pow(10,s)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?ex(o[1],s)+i[2]+"/"+i[3]+Md(o[2],s):$r(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=dc(r,0),t.length<=a.length?a:fa(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var d=t.indexOf(".")-s,p=t.length-a.length-d;return fa(t.substr(0,d)+a+t.substr(t.length-p))}if(i=t.match(/^00,000\.([#0]*0)$/))return s=Ty(r,i[1].length),r<0?"-"+si(e,t,-r):Ao(pP(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Fi(0,3-x.length):"")+x})+"."+Fi(s,i[1].length);switch(t){case"###,##0.00":return si(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var h=Ao(dc(c,0));return h!=="0"?u+h:"";case"###,###.00":return si(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return si(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function mP(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return Os(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function gP(e,t,r){var n=t.replace(v4,""),a=t.length-n.length;return Os(e,n,r*Math.pow(10,2*a))+$r("%",a)}function S4(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+S4(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var i=Math.floor(Math.log(t)*Math.LOG10E)%a;if(i<0&&(i+=a),r=(t/Math.pow(10,i)).toPrecision(n+1+(a+i)%a),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+i):r+="E+"+(s-i),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,c,u,f){return c+u+f.substr(0,(a+i)%a)+"."+f.substr(i)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Ji(e,t,r){if(e.charCodeAt(0)===40&&!t.match(_4)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Ji("n",n,r):"("+Ji("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return mP(e,t,r);if(t.indexOf("%")!==-1)return gP(e,t,r);if(t.indexOf("E")!==-1)return S4(t,r);if(t.charCodeAt(0)===36)return"$"+Ji(e,t.substr(t.charAt(1)==" "?2:1),r);var a,i,s,o,c=Math.abs(r),u=r<0?"-":"";if(t.match(/^00+$/))return u+Fi(c,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:fa(t.substr(0,t.length-a.length))+a;if(i=t.match(b4))return dP(i,c,u);if(t.match(/^#+0+$/))return u+Fi(c,t.length-t.indexOf("0"));if(i=t.match(w4))return a=(""+r).replace(/^([^\.]+)$/,"$1."+fa(i[1])).replace(/\.$/,"."+fa(i[1])),a=a.replace(/\.(\d*)$/,function(x,g){return"."+g+$r("0",fa(i[1]).length-g.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),i=t.match(/^(0*)\.(#*)$/))return u+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=t.match(/^#{1,3},##0(\.?)$/))return u+Ao(""+c);if(i=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Ji(e,t,-r):Ao(""+r)+"."+$r("0",i[1].length);if(i=t.match(/^#,#*,#0/))return Ji(e,t.replace(/^#,#*,/,""),r);if(i=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Cc(Ji(e,t.replace(/[\\-]/g,""),r)),s=0,Cc(Cc(t.replace(/\\/g,"")).replace(/[0#]/g,function(x){return s<a.length?a.charAt(s++):x==="0"?"0":""}));if(t.match(N4))return a=Ji(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(i=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(i[4].length,7),o=Bd(c,Math.pow(10,s)-1,!1),a=""+u,f=Os("n",i[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+i[2]+"/"+i[3],f=Md(o[2],s),f.length<i[4].length&&(f=fa(i[4].substr(i[4].length-f.length))+f),a+=f,a;if(i=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(i[1].length,i[4].length),7),o=Bd(c,Math.pow(10,s)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?ex(o[1],s)+i[2]+"/"+i[3]+Md(o[2],s):$r(" ",2*s+1+i[2].length+i[3].length));if(i=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:fa(t.substr(0,t.length-a.length))+a;if(i=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),s=a.indexOf(".");var d=t.indexOf(".")-s,p=t.length-a.length-d;return fa(t.substr(0,d)+a+t.substr(t.length-p))}if(i=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Ji(e,t,-r):Ao(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(x){return"00,"+(x.length<3?Fi(0,3-x.length):"")+x})+"."+Fi(0,i[1].length);switch(t){case"###,###":case"##,###":case"#,###":var h=Ao(""+c);return h!=="0"?u+h:"";default:if(t.match(/\.[0#?]*$/))return Ji(e,t.slice(0,t.lastIndexOf(".")),r)+fa(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Os(e,t,r){return(r|0)===r?Ji(e,t,r):si(e,t,r)}function xP(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var A4=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function E4(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":Rd(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"‰∏ä":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="‰∏äÂçà/‰∏ãÂçà")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(A4))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function vP(e,t,r,n){for(var a=[],i="",s=0,o="",c="t",u,f,d,p="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!Rd(e,s))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},s+=7;break;case'"':for(i="";(d=e.charCodeAt(++s))!==34&&s<e.length;)i+=String.fromCharCode(d);a[a.length]={t:"t",v:i},++s;break;case"\\":var h=e.charAt(++s),x=h==="("||h===")"?h:"t";a[a.length]={t:x,v:h},++s;break;case"_":a[a.length]={t:"t",v:" "},s+=2;break;case"@":a[a.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(u==null&&(u=Y0(t,r,e.charAt(s+1)==="2"),u==null))return"";a[a.length]={t:"X",v:e.substr(s,2)},c=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=Y0(t,r),u==null))return"";for(i=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)i+=o;o==="m"&&c.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=p),a[a.length]={t:o,v:i},c=o;break;case"A":case"a":case"‰∏ä":var g={t:o,v:o};if(u==null&&(u=Y0(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(u!=null&&(g.v=u.H>=12?"P":"A"),g.t="T",p="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(u!=null&&(g.v=u.H>=12?"PM":"AM"),g.t="T",s+=5,p="h"):e.substr(s,5).toUpperCase()==="‰∏äÂçà/‰∏ãÂçà"?(u!=null&&(g.v=u.H>=12?"‰∏ãÂçà":"‰∏äÂçà"),g.t="T",s+=5,p="h"):(g.t="t",++s),u==null&&g.t==="T")return"";a[a.length]=g,c=o;break;case"[":for(i=o;e.charAt(s++)!=="]"&&s<e.length;)i+=e.charAt(s);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(A4)){if(u==null&&(u=Y0(t,r),u==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",E4(e)||(a[a.length]={t:"t",v:i}));break;case".":if(u!=null){for(i=o;++s<e.length&&(o=e.charAt(s))==="0";)i+=o;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)i+=o;a[a.length]={t:"n",v:i};break;case"?":for(i=o;e.charAt(++s)===o;)i+=o;a[a.length]={t:o,v:i},c=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)i+=e.charAt(s);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:o,v:o},++s;break;case"$":a[a.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=‚Ç¨acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++s;break}var y=0,b=0,E;for(s=a.length-1,c="t";s>=0;--s)switch(a[s].t){case"h":case"H":a[s].t=p,c="h",y<1&&(y=1);break;case"s":(E=a[s].v.match(/\.0+$/))&&(b=Math.max(b,E[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":c=a[s].t;break;case"m":c==="s"&&(a[s].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&a[s].v.match(/[Hh]/)&&(y=1),y<2&&a[s].v.match(/[Mm]/)&&(y=2),y<3&&a[s].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var A="",C;for(s=0;s<a.length;++s)switch(a[s].t){case"t":case"T":case" ":case"D":break;case"X":a[s].v="",a[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[s].v=lP(a[s].t.charCodeAt(0),a[s].v,u,b),a[s].t="t";break;case"n":case"?":for(C=s+1;a[C]!=null&&((o=a[C].t)==="?"||o==="D"||(o===" "||o==="t")&&a[C+1]!=null&&(a[C+1].t==="?"||a[C+1].t==="t"&&a[C+1].v==="/")||a[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[C].v==="/"||a[C].v===" "&&a[C+1]!=null&&a[C+1].t=="?"));)a[s].v+=a[C].v,a[C]={v:"",t:";"},++C;A+=a[s].v,s=C-1;break;case"G":a[s].t="t",a[s].v=q1(t,r);break}var N="",F,O;if(A.length>0){A.charCodeAt(0)==40?(F=t<0&&A.charCodeAt(0)===45?-t:t,O=Os("n",A,F)):(F=t<0&&n>1?-t:t,O=Os("n",A,F),F<0&&a[0]&&a[0].t=="t"&&(O=O.substr(1),a[0].v="-"+a[0].v)),C=O.length-1;var I=a.length;for(s=0;s<a.length;++s)if(a[s]!=null&&a[s].t!="t"&&a[s].v.indexOf(".")>-1){I=s;break}var P=a.length;if(I===a.length&&O.indexOf("E")===-1){for(s=a.length-1;s>=0;--s)a[s]==null||"n?".indexOf(a[s].t)===-1||(C>=a[s].v.length-1?(C-=a[s].v.length,a[s].v=O.substr(C+1,a[s].v.length)):C<0?a[s].v="":(a[s].v=O.substr(0,C+1),C=-1),a[s].t="t",P=s);C>=0&&P<a.length&&(a[P].v=O.substr(0,C+1)+a[P].v)}else if(I!==a.length&&O.indexOf("E")===-1){for(C=O.indexOf(".")-1,s=I;s>=0;--s)if(!(a[s]==null||"n?".indexOf(a[s].t)===-1)){for(f=a[s].v.indexOf(".")>-1&&s===I?a[s].v.indexOf(".")-1:a[s].v.length-1,N=a[s].v.substr(f+1);f>=0;--f)C>=0&&(a[s].v.charAt(f)==="0"||a[s].v.charAt(f)==="#")&&(N=O.charAt(C--)+N);a[s].v=N,a[s].t="t",P=s}for(C>=0&&P<a.length&&(a[P].v=O.substr(0,C+1)+a[P].v),C=O.indexOf(".")+1,s=I;s<a.length;++s)if(!(a[s]==null||"n?(".indexOf(a[s].t)===-1&&s!==I)){for(f=a[s].v.indexOf(".")>-1&&s===I?a[s].v.indexOf(".")+1:0,N=a[s].v.substr(0,f);f<a[s].v.length;++f)C<O.length&&(N+=O.charAt(C++));a[s].v=N,a[s].t="t",P=s}}}for(s=0;s<a.length;++s)a[s]!=null&&"n?".indexOf(a[s].t)>-1&&(F=n>1&&t<0&&s>0&&a[s-1].v==="-"?-t:t,a[s].v=Os(a[s].t,a[s].v,F),a[s].t="t");var H="";for(s=0;s!==a.length;++s)a[s]!=null&&(H+=a[s].v);return H}var Py=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function ky(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function yP(e,t){var r=xP(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var i=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,i];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(Py),o=r[1].match(Py);return ky(t,s)?[n,r[0]]:ky(t,o)?[n,r[1]]:[n,r[s!=null&&o!=null?2:1]]}return[n,i]}function Ro(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:Wr)[e],n==null&&(n=r.table&&r.table[Ey[e]]||Wr[Ey[e]]),n==null&&(n=eP[e]||"General");break}if(Rd(n,0))return q1(t,r);t instanceof Date&&(t=x4(t,r.date1904));var a=yP(n,t);if(Rd(a[1]))return q1(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return vP(a[1],t,r,a[0])}function j4(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(Wr[r]==null){t<0&&(t=r);continue}if(Wr[r]==e){t=r;break}}t<0&&(t=391)}return Wr[t]=e,t}function Uh(e){for(var t=0;t!=392;++t)e[t]!==void 0&&j4(e[t],t)}function $h(){Wr=Q8()}var T4=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function bP(e){var t=typeof e=="number"?Wr[e]:e;return t=t.replace(T4,"(\\d+)"),new RegExp("^"+t+"$")}function wP(e,t,r){var n=-1,a=-1,i=-1,s=-1,o=-1,c=-1;(t.match(T4)||[]).forEach(function(d,p){var h=parseInt(r[p+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=h;break;case"d":i=h;break;case"h":s=h;break;case"s":c=h;break;case"m":s>=0?o=h:a=h;break}}),c>=0&&o==-1&&a>=0&&(o=a,a=-1);var u=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var f=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return s==-1&&o==-1&&c==-1?u:n==-1&&a==-1&&i==-1?f:u+"T"+f}var _P=function(){var e={};e.version="1.2.0";function t(){for(var O=0,I=new Array(256),P=0;P!=256;++P)O=P,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,O=O&1?-306674912^O>>>1:O>>>1,I[P]=O;return typeof Int32Array<"u"?new Int32Array(I):I}var r=t();function n(O){var I=0,P=0,H=0,T=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(H=0;H!=256;++H)T[H]=O[H];for(H=0;H!=256;++H)for(P=O[H],I=256+H;I<4096;I+=256)P=T[I]=P>>>8^O[P&255];var j=[];for(H=1;H!=16;++H)j[H-1]=typeof Int32Array<"u"?T.subarray(H*256,H*256+256):T.slice(H*256,H*256+256);return j}var a=n(r),i=a[0],s=a[1],o=a[2],c=a[3],u=a[4],f=a[5],d=a[6],p=a[7],h=a[8],x=a[9],g=a[10],y=a[11],b=a[12],E=a[13],A=a[14];function C(O,I){for(var P=I^-1,H=0,T=O.length;H<T;)P=P>>>8^r[(P^O.charCodeAt(H++))&255];return~P}function N(O,I){for(var P=I^-1,H=O.length-15,T=0;T<H;)P=A[O[T++]^P&255]^E[O[T++]^P>>8&255]^b[O[T++]^P>>16&255]^y[O[T++]^P>>>24]^g[O[T++]]^x[O[T++]]^h[O[T++]]^p[O[T++]]^d[O[T++]]^f[O[T++]]^u[O[T++]]^c[O[T++]]^o[O[T++]]^s[O[T++]]^i[O[T++]]^r[O[T++]];for(H+=15;T<H;)P=P>>>8^r[(P^O[T++])&255];return~P}function F(O,I){for(var P=I^-1,H=0,T=O.length,j=0,z=0;H<T;)j=O.charCodeAt(H++),j<128?P=P>>>8^r[(P^j)&255]:j<2048?(P=P>>>8^r[(P^(192|j>>6&31))&255],P=P>>>8^r[(P^(128|j&63))&255]):j>=55296&&j<57344?(j=(j&1023)+64,z=O.charCodeAt(H++)&1023,P=P>>>8^r[(P^(240|j>>8&7))&255],P=P>>>8^r[(P^(128|j>>2&63))&255],P=P>>>8^r[(P^(128|z>>6&15|(j&3)<<4))&255],P=P>>>8^r[(P^(128|z&63))&255]):(P=P>>>8^r[(P^(224|j>>12&15))&255],P=P>>>8^r[(P^(128|j>>6&63))&255],P=P>>>8^r[(P^(128|j&63))&255]);return~P}return e.table=r,e.bstr=C,e.buf=N,e.str=F,e}(),gr=function(){var t={};t.version="1.2.1";function r(q,ae){for(var Z=q.split("/"),ee=ae.split("/"),ie=0,ce=0,Se=Math.min(Z.length,ee.length);ie<Se;++ie){if(ce=Z[ie].length-ee[ie].length)return ce;if(Z[ie]!=ee[ie])return Z[ie]<ee[ie]?-1:1}return Z.length-ee.length}function n(q){if(q.charAt(q.length-1)=="/")return q.slice(0,-1).indexOf("/")===-1?q:n(q.slice(0,-1));var ae=q.lastIndexOf("/");return ae===-1?q:q.slice(0,ae+1)}function a(q){if(q.charAt(q.length-1)=="/")return a(q.slice(0,-1));var ae=q.lastIndexOf("/");return ae===-1?q:q.slice(ae+1)}function i(q,ae){typeof ae=="string"&&(ae=new Date(ae));var Z=ae.getHours();Z=Z<<6|ae.getMinutes(),Z=Z<<5|ae.getSeconds()>>>1,q.write_shift(2,Z);var ee=ae.getFullYear()-1980;ee=ee<<4|ae.getMonth()+1,ee=ee<<5|ae.getDate(),q.write_shift(2,ee)}function s(q){var ae=q.read_shift(2)&65535,Z=q.read_shift(2)&65535,ee=new Date,ie=Z&31;Z>>>=5;var ce=Z&15;Z>>>=4,ee.setMilliseconds(0),ee.setFullYear(Z+1980),ee.setMonth(ce-1),ee.setDate(ie);var Se=ae&31;ae>>>=5;var Le=ae&63;return ae>>>=6,ee.setHours(ae),ee.setMinutes(Le),ee.setSeconds(Se<<1),ee}function o(q){Ua(q,0);for(var ae={},Z=0;q.l<=q.length-4;){var ee=q.read_shift(2),ie=q.read_shift(2),ce=q.l+ie,Se={};switch(ee){case 21589:Z=q.read_shift(1),Z&1&&(Se.mtime=q.read_shift(4)),ie>5&&(Z&2&&(Se.atime=q.read_shift(4)),Z&4&&(Se.ctime=q.read_shift(4))),Se.mtime&&(Se.mt=new Date(Se.mtime*1e3));break}q.l=ce,ae[ee]=Se}return ae}var c;function u(){return c||(c={})}function f(q,ae){if(q[0]==80&&q[1]==75)return Xt(q,ae);if((q[0]|32)==109&&(q[1]|32)==105)return Et(q,ae);if(q.length<512)throw new Error("CFB file size "+q.length+" < 512");var Z=3,ee=512,ie=0,ce=0,Se=0,Le=0,Ae=0,Ee=[],Ce=q.slice(0,512);Ua(Ce,0);var Ge=d(Ce);switch(Z=Ge[0],Z){case 3:ee=512;break;case 4:ee=4096;break;case 0:if(Ge[1]==0)return Xt(q,ae);default:throw new Error("Major Version: Expected 3 or 4 saw "+Z)}ee!==512&&(Ce=q.slice(0,ee),Ua(Ce,28));var Ze=q.slice(0,ee);p(Ce,Z);var it=Ce.read_shift(4,"i");if(Z===3&&it!==0)throw new Error("# Directory Sectors: Expected 0 saw "+it);Ce.l+=4,Se=Ce.read_shift(4,"i"),Ce.l+=4,Ce.chk("00100000","Mini Stream Cutoff Size: "),Le=Ce.read_shift(4,"i"),ie=Ce.read_shift(4,"i"),Ae=Ce.read_shift(4,"i"),ce=Ce.read_shift(4,"i");for(var Ye=-1,at=0;at<109&&(Ye=Ce.read_shift(4,"i"),!(Ye<0));++at)Ee[at]=Ye;var Pt=h(q,ee);y(Ae,ce,Pt,ee,Ee);var pr=E(Pt,Se,Ee,ee);pr[Se].name="!Directory",ie>0&&Le!==z&&(pr[Le].name="!MiniFAT"),pr[Ee[0]].name="!FAT",pr.fat_addrs=Ee,pr.ssz=ee;var zt={},Mr=[],zi=[],wi=[];A(Se,pr,Pt,Mr,ie,zt,zi,Le),x(zi,wi,Mr),Mr.shift();var qi={FileIndex:zi,FullPaths:wi};return ae&&ae.raw&&(qi.raw={header:Ze,sectors:Pt}),qi}function d(q){if(q[q.l]==80&&q[q.l+1]==75)return[0,0];q.chk(K,"Header Signature: "),q.l+=16;var ae=q.read_shift(2,"u");return[q.read_shift(2,"u"),ae]}function p(q,ae){var Z=9;switch(q.l+=2,Z=q.read_shift(2)){case 9:if(ae!=3)throw new Error("Sector Shift: Expected 9 saw "+Z);break;case 12:if(ae!=4)throw new Error("Sector Shift: Expected 12 saw "+Z);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+Z)}q.chk("0600","Mini Sector Shift: "),q.chk("000000000000","Reserved: ")}function h(q,ae){for(var Z=Math.ceil(q.length/ae)-1,ee=[],ie=1;ie<Z;++ie)ee[ie-1]=q.slice(ie*ae,(ie+1)*ae);return ee[Z-1]=q.slice(Z*ae),ee}function x(q,ae,Z){for(var ee=0,ie=0,ce=0,Se=0,Le=0,Ae=Z.length,Ee=[],Ce=[];ee<Ae;++ee)Ee[ee]=Ce[ee]=ee,ae[ee]=Z[ee];for(;Le<Ce.length;++Le)ee=Ce[Le],ie=q[ee].L,ce=q[ee].R,Se=q[ee].C,Ee[ee]===ee&&(ie!==-1&&Ee[ie]!==ie&&(Ee[ee]=Ee[ie]),ce!==-1&&Ee[ce]!==ce&&(Ee[ee]=Ee[ce])),Se!==-1&&(Ee[Se]=ee),ie!==-1&&ee!=Ee[ee]&&(Ee[ie]=Ee[ee],Ce.lastIndexOf(ie)<Le&&Ce.push(ie)),ce!==-1&&ee!=Ee[ee]&&(Ee[ce]=Ee[ee],Ce.lastIndexOf(ce)<Le&&Ce.push(ce));for(ee=1;ee<Ae;++ee)Ee[ee]===ee&&(ce!==-1&&Ee[ce]!==ce?Ee[ee]=Ee[ce]:ie!==-1&&Ee[ie]!==ie&&(Ee[ee]=Ee[ie]));for(ee=1;ee<Ae;++ee)if(q[ee].type!==0){if(Le=ee,Le!=Ee[Le])do Le=Ee[Le],ae[ee]=ae[Le]+"/"+ae[ee];while(Le!==0&&Ee[Le]!==-1&&Le!=Ee[Le]);Ee[ee]=-1}for(ae[0]+="/",ee=1;ee<Ae;++ee)q[ee].type!==2&&(ae[ee]+="/")}function g(q,ae,Z){for(var ee=q.start,ie=q.size,ce=[],Se=ee;Z&&ie>0&&Se>=0;)ce.push(ae.slice(Se*j,Se*j+j)),ie-=j,Se=dl(Z,Se*4);return ce.length===0?De(0):zn(ce).slice(0,q.size)}function y(q,ae,Z,ee,ie){var ce=z;if(q===z){if(ae!==0)throw new Error("DIFAT chain shorter than expected")}else if(q!==-1){var Se=Z[q],Le=(ee>>>2)-1;if(!Se)return;for(var Ae=0;Ae<Le&&(ce=dl(Se,Ae*4))!==z;++Ae)ie.push(ce);y(dl(Se,ee-4),ae-1,Z,ee,ie)}}function b(q,ae,Z,ee,ie){var ce=[],Se=[];ie||(ie=[]);var Le=ee-1,Ae=0,Ee=0;for(Ae=ae;Ae>=0;){ie[Ae]=!0,ce[ce.length]=Ae,Se.push(q[Ae]);var Ce=Z[Math.floor(Ae*4/ee)];if(Ee=Ae*4&Le,ee<4+Ee)throw new Error("FAT boundary crossed: "+Ae+" 4 "+ee);if(!q[Ce])break;Ae=dl(q[Ce],Ee)}return{nodes:ce,data:Ry([Se])}}function E(q,ae,Z,ee){var ie=q.length,ce=[],Se=[],Le=[],Ae=[],Ee=ee-1,Ce=0,Ge=0,Ze=0,it=0;for(Ce=0;Ce<ie;++Ce)if(Le=[],Ze=Ce+ae,Ze>=ie&&(Ze-=ie),!Se[Ze]){Ae=[];var Ye=[];for(Ge=Ze;Ge>=0;){Ye[Ge]=!0,Se[Ge]=!0,Le[Le.length]=Ge,Ae.push(q[Ge]);var at=Z[Math.floor(Ge*4/ee)];if(it=Ge*4&Ee,ee<4+it)throw new Error("FAT boundary crossed: "+Ge+" 4 "+ee);if(!q[at]||(Ge=dl(q[at],it),Ye[Ge]))break}ce[Ze]={nodes:Le,data:Ry([Ae])}}return ce}function A(q,ae,Z,ee,ie,ce,Se,Le){for(var Ae=0,Ee=ee.length?2:0,Ce=ae[q].data,Ge=0,Ze=0,it;Ge<Ce.length;Ge+=128){var Ye=Ce.slice(Ge,Ge+128);Ua(Ye,64),Ze=Ye.read_shift(2),it=sx(Ye,0,Ze-Ee),ee.push(it);var at={name:it,type:Ye.read_shift(1),color:Ye.read_shift(1),L:Ye.read_shift(4,"i"),R:Ye.read_shift(4,"i"),C:Ye.read_shift(4,"i"),clsid:Ye.read_shift(16),state:Ye.read_shift(4,"i"),start:0,size:0},Pt=Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2);Pt!==0&&(at.ct=C(Ye,Ye.l-8));var pr=Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2)+Ye.read_shift(2);pr!==0&&(at.mt=C(Ye,Ye.l-8)),at.start=Ye.read_shift(4,"i"),at.size=Ye.read_shift(4,"i"),at.size<0&&at.start<0&&(at.size=at.type=0,at.start=z,at.name=""),at.type===5?(Ae=at.start,ie>0&&Ae!==z&&(ae[Ae].name="!StreamData")):at.size>=4096?(at.storage="fat",ae[at.start]===void 0&&(ae[at.start]=b(Z,at.start,ae.fat_addrs,ae.ssz)),ae[at.start].name=at.name,at.content=ae[at.start].data.slice(0,at.size)):(at.storage="minifat",at.size<0?at.size=0:Ae!==z&&at.start!==z&&ae[Ae]&&(at.content=g(at,ae[Ae].data,(ae[Le]||{}).data))),at.content&&Ua(at.content,0),ce[it]=at,Se.push(at)}}function C(q,ae){return new Date((qa(q,ae+4)/1e7*Math.pow(2,32)+qa(q,ae)/1e7-11644473600)*1e3)}function N(q,ae){return u(),f(c.readFileSync(q),ae)}function F(q,ae){var Z=ae&&ae.type;switch(Z||ar&&Buffer.isBuffer(q)&&(Z="buffer"),Z||"base64"){case"file":return N(q,ae);case"base64":return f(ki(Ms(q)),ae);case"binary":return f(ki(q),ae)}return f(q,ae)}function O(q,ae){var Z=ae||{},ee=Z.root||"Root Entry";if(q.FullPaths||(q.FullPaths=[]),q.FileIndex||(q.FileIndex=[]),q.FullPaths.length!==q.FileIndex.length)throw new Error("inconsistent CFB structure");q.FullPaths.length===0&&(q.FullPaths[0]=ee+"/",q.FileIndex[0]={name:ee,type:5}),Z.CLSID&&(q.FileIndex[0].clsid=Z.CLSID),I(q)}function I(q){var ae="Sh33tJ5";if(!gr.find(q,"/"+ae)){var Z=De(4);Z[0]=55,Z[1]=Z[3]=50,Z[2]=54,q.FileIndex.push({name:ae,type:2,content:Z,size:4,L:69,R:69,C:69}),q.FullPaths.push(q.FullPaths[0]+ae),P(q)}}function P(q,ae){O(q);for(var Z=!1,ee=!1,ie=q.FullPaths.length-1;ie>=0;--ie){var ce=q.FileIndex[ie];switch(ce.type){case 0:ee?Z=!0:(q.FileIndex.pop(),q.FullPaths.pop());break;case 1:case 2:case 5:ee=!0,isNaN(ce.R*ce.L*ce.C)&&(Z=!0),ce.R>-1&&ce.L>-1&&ce.R==ce.L&&(Z=!0);break;default:Z=!0;break}}if(!(!Z&&!ae)){var Se=new Date(1987,1,19),Le=0,Ae=Object.create?Object.create(null):{},Ee=[];for(ie=0;ie<q.FullPaths.length;++ie)Ae[q.FullPaths[ie]]=!0,q.FileIndex[ie].type!==0&&Ee.push([q.FullPaths[ie],q.FileIndex[ie]]);for(ie=0;ie<Ee.length;++ie){var Ce=n(Ee[ie][0]);ee=Ae[Ce],ee||(Ee.push([Ce,{name:a(Ce).replace("/",""),type:1,clsid:be,ct:Se,mt:Se,content:null}]),Ae[Ce]=!0)}for(Ee.sort(function(it,Ye){return r(it[0],Ye[0])}),q.FullPaths=[],q.FileIndex=[],ie=0;ie<Ee.length;++ie)q.FullPaths[ie]=Ee[ie][0],q.FileIndex[ie]=Ee[ie][1];for(ie=0;ie<Ee.length;++ie){var Ge=q.FileIndex[ie],Ze=q.FullPaths[ie];if(Ge.name=a(Ze).replace("/",""),Ge.L=Ge.R=Ge.C=-(Ge.color=1),Ge.size=Ge.content?Ge.content.length:0,Ge.start=0,Ge.clsid=Ge.clsid||be,ie===0)Ge.C=Ee.length>1?1:-1,Ge.size=0,Ge.type=5;else if(Ze.slice(-1)=="/"){for(Le=ie+1;Le<Ee.length&&n(q.FullPaths[Le])!=Ze;++Le);for(Ge.C=Le>=Ee.length?-1:Le,Le=ie+1;Le<Ee.length&&n(q.FullPaths[Le])!=n(Ze);++Le);Ge.R=Le>=Ee.length?-1:Le,Ge.type=1}else n(q.FullPaths[ie+1]||"")==n(Ze)&&(Ge.R=ie+1),Ge.type=2}}}function H(q,ae){var Z=ae||{};if(Z.fileType=="mad")return yi(q,Z);switch(P(q),Z.fileType){case"zip":return Wt(q,Z)}var ee=function(it){for(var Ye=0,at=0,Pt=0;Pt<it.FileIndex.length;++Pt){var pr=it.FileIndex[Pt];if(pr.content){var zt=pr.content.length;zt>0&&(zt<4096?Ye+=zt+63>>6:at+=zt+511>>9)}}for(var Mr=it.FullPaths.length+3>>2,zi=Ye+7>>3,wi=Ye+127>>7,qi=zi+at+Mr+wi,ei=qi+127>>7,Zs=ei<=109?0:Math.ceil((ei-109)/127);qi+ei+Zs+127>>7>ei;)Zs=++ei<=109?0:Math.ceil((ei-109)/127);var Kn=[1,Zs,ei,wi,Mr,at,Ye,0];return it.FileIndex[0].size=Ye<<6,Kn[7]=(it.FileIndex[0].start=Kn[0]+Kn[1]+Kn[2]+Kn[3]+Kn[4]+Kn[5])+(Kn[6]+7>>3),Kn}(q),ie=De(ee[7]<<9),ce=0,Se=0;{for(ce=0;ce<8;++ce)ie.write_shift(1,he[ce]);for(ce=0;ce<8;++ce)ie.write_shift(2,0);for(ie.write_shift(2,62),ie.write_shift(2,3),ie.write_shift(2,65534),ie.write_shift(2,9),ie.write_shift(2,6),ce=0;ce<3;++ce)ie.write_shift(2,0);for(ie.write_shift(4,0),ie.write_shift(4,ee[2]),ie.write_shift(4,ee[0]+ee[1]+ee[2]+ee[3]-1),ie.write_shift(4,0),ie.write_shift(4,4096),ie.write_shift(4,ee[3]?ee[0]+ee[1]+ee[2]-1:z),ie.write_shift(4,ee[3]),ie.write_shift(-4,ee[1]?ee[0]-1:z),ie.write_shift(4,ee[1]),ce=0;ce<109;++ce)ie.write_shift(-4,ce<ee[2]?ee[1]+ce:-1)}if(ee[1])for(Se=0;Se<ee[1];++Se){for(;ce<236+Se*127;++ce)ie.write_shift(-4,ce<ee[2]?ee[1]+ce:-1);ie.write_shift(-4,Se===ee[1]-1?z:Se+1)}var Le=function(it){for(Se+=it;ce<Se-1;++ce)ie.write_shift(-4,ce+1);it&&(++ce,ie.write_shift(-4,z))};for(Se=ce=0,Se+=ee[1];ce<Se;++ce)ie.write_shift(-4,we.DIFSECT);for(Se+=ee[2];ce<Se;++ce)ie.write_shift(-4,we.FATSECT);Le(ee[3]),Le(ee[4]);for(var Ae=0,Ee=0,Ce=q.FileIndex[0];Ae<q.FileIndex.length;++Ae)Ce=q.FileIndex[Ae],Ce.content&&(Ee=Ce.content.length,!(Ee<4096)&&(Ce.start=Se,Le(Ee+511>>9)));for(Le(ee[6]+7>>3);ie.l&511;)ie.write_shift(-4,we.ENDOFCHAIN);for(Se=ce=0,Ae=0;Ae<q.FileIndex.length;++Ae)Ce=q.FileIndex[Ae],Ce.content&&(Ee=Ce.content.length,!(!Ee||Ee>=4096)&&(Ce.start=Se,Le(Ee+63>>6)));for(;ie.l&511;)ie.write_shift(-4,we.ENDOFCHAIN);for(ce=0;ce<ee[4]<<2;++ce){var Ge=q.FullPaths[ce];if(!Ge||Ge.length===0){for(Ae=0;Ae<17;++Ae)ie.write_shift(4,0);for(Ae=0;Ae<3;++Ae)ie.write_shift(4,-1);for(Ae=0;Ae<12;++Ae)ie.write_shift(4,0);continue}Ce=q.FileIndex[ce],ce===0&&(Ce.start=Ce.size?Ce.start-1:z);var Ze=ce===0&&Z.root||Ce.name;if(Ee=2*(Ze.length+1),ie.write_shift(64,Ze,"utf16le"),ie.write_shift(2,Ee),ie.write_shift(1,Ce.type),ie.write_shift(1,Ce.color),ie.write_shift(-4,Ce.L),ie.write_shift(-4,Ce.R),ie.write_shift(-4,Ce.C),Ce.clsid)ie.write_shift(16,Ce.clsid,"hex");else for(Ae=0;Ae<4;++Ae)ie.write_shift(4,0);ie.write_shift(4,Ce.state||0),ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(4,0),ie.write_shift(4,Ce.start),ie.write_shift(4,Ce.size),ie.write_shift(4,0)}for(ce=1;ce<q.FileIndex.length;++ce)if(Ce=q.FileIndex[ce],Ce.size>=4096)if(ie.l=Ce.start+1<<9,ar&&Buffer.isBuffer(Ce.content))Ce.content.copy(ie,ie.l,0,Ce.size),ie.l+=Ce.size+511&-512;else{for(Ae=0;Ae<Ce.size;++Ae)ie.write_shift(1,Ce.content[Ae]);for(;Ae&511;++Ae)ie.write_shift(1,0)}for(ce=1;ce<q.FileIndex.length;++ce)if(Ce=q.FileIndex[ce],Ce.size>0&&Ce.size<4096)if(ar&&Buffer.isBuffer(Ce.content))Ce.content.copy(ie,ie.l,0,Ce.size),ie.l+=Ce.size+63&-64;else{for(Ae=0;Ae<Ce.size;++Ae)ie.write_shift(1,Ce.content[Ae]);for(;Ae&63;++Ae)ie.write_shift(1,0)}if(ar)ie.l=ie.length;else for(;ie.l<ie.length;)ie.write_shift(1,0);return ie}function T(q,ae){var Z=q.FullPaths.map(function(Ae){return Ae.toUpperCase()}),ee=Z.map(function(Ae){var Ee=Ae.split("/");return Ee[Ee.length-(Ae.slice(-1)=="/"?2:1)]}),ie=!1;ae.charCodeAt(0)===47?(ie=!0,ae=Z[0].slice(0,-1)+ae):ie=ae.indexOf("/")!==-1;var ce=ae.toUpperCase(),Se=ie===!0?Z.indexOf(ce):ee.indexOf(ce);if(Se!==-1)return q.FileIndex[Se];var Le=!ce.match(K0);for(ce=ce.replace(mf,""),Le&&(ce=ce.replace(K0,"!")),Se=0;Se<Z.length;++Se)if((Le?Z[Se].replace(K0,"!"):Z[Se]).replace(mf,"")==ce||(Le?ee[Se].replace(K0,"!"):ee[Se]).replace(mf,"")==ce)return q.FileIndex[Se];return null}var j=64,z=-2,K="d0cf11e0a1b11ae1",he=[208,207,17,224,161,177,26,225],be="00000000000000000000000000000000",we={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:z,FREESECT:-1,HEADER_SIGNATURE:K,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:be,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Q(q,ae,Z){u();var ee=H(q,Z);c.writeFileSync(ae,ee)}function le(q){for(var ae=new Array(q.length),Z=0;Z<q.length;++Z)ae[Z]=String.fromCharCode(q[Z]);return ae.join("")}function ke(q,ae){var Z=H(q,ae);switch(ae&&ae.type||"buffer"){case"file":return u(),c.writeFileSync(ae.filename,Z),Z;case"binary":return typeof Z=="string"?Z:le(Z);case"base64":return Tf(typeof Z=="string"?Z:le(Z));case"buffer":if(ar)return Buffer.isBuffer(Z)?Z:Gs(Z);case"array":return typeof Z=="string"?ki(Z):Z}return Z}var ve;function S(q){try{var ae=q.InflateRaw,Z=new ae;if(Z._processChunk(new Uint8Array([3,0]),Z._finishFlushFlag),Z.bytesRead)ve=q;else throw new Error("zlib does not expose bytesRead")}catch(ee){console.error("cannot use native zlib: "+(ee.message||ee))}}function L(q,ae){if(!ve)return tt(q,ae);var Z=ve.InflateRaw,ee=new Z,ie=ee._processChunk(q.slice(q.l),ee._finishFlushFlag);return q.l+=ee.bytesRead,ie}function D(q){return ve?ve.deflateRawSync(q):pt(q)}var R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],X=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],de=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function me(q){var ae=(q<<1|q<<11)&139536|(q<<5|q<<15)&558144;return(ae>>16|ae>>8|ae)&255}for(var Y=typeof Uint8Array<"u",oe=Y?new Uint8Array(256):[],ue=0;ue<256;++ue)oe[ue]=me(ue);function fe(q,ae){var Z=oe[q&255];return ae<=8?Z>>>8-ae:(Z=Z<<8|oe[q>>8&255],ae<=16?Z>>>16-ae:(Z=Z<<8|oe[q>>16&255],Z>>>24-ae))}function Ue(q,ae){var Z=ae&7,ee=ae>>>3;return(q[ee]|(Z<=6?0:q[ee+1]<<8))>>>Z&3}function xe(q,ae){var Z=ae&7,ee=ae>>>3;return(q[ee]|(Z<=5?0:q[ee+1]<<8))>>>Z&7}function te(q,ae){var Z=ae&7,ee=ae>>>3;return(q[ee]|(Z<=4?0:q[ee+1]<<8))>>>Z&15}function nt(q,ae){var Z=ae&7,ee=ae>>>3;return(q[ee]|(Z<=3?0:q[ee+1]<<8))>>>Z&31}function Re(q,ae){var Z=ae&7,ee=ae>>>3;return(q[ee]|(Z<=1?0:q[ee+1]<<8))>>>Z&127}function ot(q,ae,Z){var ee=ae&7,ie=ae>>>3,ce=(1<<Z)-1,Se=q[ie]>>>ee;return Z<8-ee||(Se|=q[ie+1]<<8-ee,Z<16-ee)||(Se|=q[ie+2]<<16-ee,Z<24-ee)||(Se|=q[ie+3]<<24-ee),Se&ce}function ze(q,ae,Z){var ee=ae&7,ie=ae>>>3;return ee<=5?q[ie]|=(Z&7)<<ee:(q[ie]|=Z<<ee&255,q[ie+1]=(Z&7)>>8-ee),ae+3}function lt(q,ae,Z){var ee=ae&7,ie=ae>>>3;return Z=(Z&1)<<ee,q[ie]|=Z,ae+1}function Qe(q,ae,Z){var ee=ae&7,ie=ae>>>3;return Z<<=ee,q[ie]|=Z&255,Z>>>=8,q[ie+1]=Z,ae+8}function jt(q,ae,Z){var ee=ae&7,ie=ae>>>3;return Z<<=ee,q[ie]|=Z&255,Z>>>=8,q[ie+1]=Z&255,q[ie+2]=Z>>>8,ae+16}function ft(q,ae){var Z=q.length,ee=2*Z>ae?2*Z:ae+5,ie=0;if(Z>=ae)return q;if(ar){var ce=Ny(ee);if(q.copy)q.copy(ce);else for(;ie<q.length;++ie)ce[ie]=q[ie];return ce}else if(Y){var Se=new Uint8Array(ee);if(Se.set)Se.set(q);else for(;ie<Z;++ie)Se[ie]=q[ie];return Se}return q.length=ee,q}function Ot(q){for(var ae=new Array(q),Z=0;Z<q;++Z)ae[Z]=0;return ae}function Fe(q,ae,Z){var ee=1,ie=0,ce=0,Se=0,Le=0,Ae=q.length,Ee=Y?new Uint16Array(32):Ot(32);for(ce=0;ce<32;++ce)Ee[ce]=0;for(ce=Ae;ce<Z;++ce)q[ce]=0;Ae=q.length;var Ce=Y?new Uint16Array(Ae):Ot(Ae);for(ce=0;ce<Ae;++ce)Ee[ie=q[ce]]++,ee<ie&&(ee=ie),Ce[ce]=0;for(Ee[0]=0,ce=1;ce<=ee;++ce)Ee[ce+16]=Le=Le+Ee[ce-1]<<1;for(ce=0;ce<Ae;++ce)Le=q[ce],Le!=0&&(Ce[ce]=Ee[Le+16]++);var Ge=0;for(ce=0;ce<Ae;++ce)if(Ge=q[ce],Ge!=0)for(Le=fe(Ce[ce],ee)>>ee-Ge,Se=(1<<ee+4-Ge)-1;Se>=0;--Se)ae[Le|Se<<Ge]=Ge&15|ce<<4;return ee}var Xe=Y?new Uint16Array(512):Ot(512),At=Y?new Uint16Array(32):Ot(32);if(!Y){for(var xt=0;xt<512;++xt)Xe[xt]=0;for(xt=0;xt<32;++xt)At[xt]=0}(function(){for(var q=[],ae=0;ae<32;ae++)q.push(5);Fe(q,At,32);var Z=[];for(ae=0;ae<=143;ae++)Z.push(8);for(;ae<=255;ae++)Z.push(9);for(;ae<=279;ae++)Z.push(7);for(;ae<=287;ae++)Z.push(8);Fe(Z,Xe,288)})();var st=function(){for(var ae=Y?new Uint8Array(32768):[],Z=0,ee=0;Z<de.length-1;++Z)for(;ee<de[Z+1];++ee)ae[ee]=Z;for(;ee<32768;++ee)ae[ee]=29;var ie=Y?new Uint8Array(259):[];for(Z=0,ee=0;Z<X.length-1;++Z)for(;ee<X[Z+1];++ee)ie[ee]=Z;function ce(Le,Ae){for(var Ee=0;Ee<Le.length;){var Ce=Math.min(65535,Le.length-Ee),Ge=Ee+Ce==Le.length;for(Ae.write_shift(1,+Ge),Ae.write_shift(2,Ce),Ae.write_shift(2,~Ce&65535);Ce-- >0;)Ae[Ae.l++]=Le[Ee++]}return Ae.l}function Se(Le,Ae){for(var Ee=0,Ce=0,Ge=Y?new Uint16Array(32768):[];Ce<Le.length;){var Ze=Math.min(65535,Le.length-Ce);if(Ze<10){for(Ee=ze(Ae,Ee,+(Ce+Ze==Le.length)),Ee&7&&(Ee+=8-(Ee&7)),Ae.l=Ee/8|0,Ae.write_shift(2,Ze),Ae.write_shift(2,~Ze&65535);Ze-- >0;)Ae[Ae.l++]=Le[Ce++];Ee=Ae.l*8;continue}Ee=ze(Ae,Ee,+(Ce+Ze==Le.length)+2);for(var it=0;Ze-- >0;){var Ye=Le[Ce];it=(it<<5^Ye)&32767;var at=-1,Pt=0;if((at=Ge[it])&&(at|=Ce&-32768,at>Ce&&(at-=32768),at<Ce))for(;Le[at+Pt]==Le[Ce+Pt]&&Pt<250;)++Pt;if(Pt>2){Ye=ie[Pt],Ye<=22?Ee=Qe(Ae,Ee,oe[Ye+1]>>1)-1:(Qe(Ae,Ee,3),Ee+=5,Qe(Ae,Ee,oe[Ye-23]>>5),Ee+=3);var pr=Ye<8?0:Ye-4>>2;pr>0&&(jt(Ae,Ee,Pt-X[Ye]),Ee+=pr),Ye=ae[Ce-at],Ee=Qe(Ae,Ee,oe[Ye]>>3),Ee-=3;var zt=Ye<4?0:Ye-2>>1;zt>0&&(jt(Ae,Ee,Ce-at-de[Ye]),Ee+=zt);for(var Mr=0;Mr<Pt;++Mr)Ge[it]=Ce&32767,it=(it<<5^Le[Ce])&32767,++Ce;Ze-=Pt-1}else Ye<=143?Ye=Ye+48:Ee=lt(Ae,Ee,1),Ee=Qe(Ae,Ee,oe[Ye]),Ge[it]=Ce&32767,++Ce}Ee=Qe(Ae,Ee,0)-1}return Ae.l=(Ee+7)/8|0,Ae.l}return function(Ae,Ee){return Ae.length<8?ce(Ae,Ee):Se(Ae,Ee)}}();function pt(q){var ae=De(50+Math.floor(q.length*1.1)),Z=st(q,ae);return ae.slice(0,Z)}var dt=Y?new Uint16Array(32768):Ot(32768),Qt=Y?new Uint16Array(32768):Ot(32768),$t=Y?new Uint16Array(128):Ot(128),mt=1,Tt=1;function er(q,ae){var Z=nt(q,ae)+257;ae+=5;var ee=nt(q,ae)+1;ae+=5;var ie=te(q,ae)+4;ae+=4;for(var ce=0,Se=Y?new Uint8Array(19):Ot(19),Le=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Ae=1,Ee=Y?new Uint8Array(8):Ot(8),Ce=Y?new Uint8Array(8):Ot(8),Ge=Se.length,Ze=0;Ze<ie;++Ze)Se[R[Ze]]=ce=xe(q,ae),Ae<ce&&(Ae=ce),Ee[ce]++,ae+=3;var it=0;for(Ee[0]=0,Ze=1;Ze<=Ae;++Ze)Ce[Ze]=it=it+Ee[Ze-1]<<1;for(Ze=0;Ze<Ge;++Ze)(it=Se[Ze])!=0&&(Le[Ze]=Ce[it]++);var Ye=0;for(Ze=0;Ze<Ge;++Ze)if(Ye=Se[Ze],Ye!=0){it=oe[Le[Ze]]>>8-Ye;for(var at=(1<<7-Ye)-1;at>=0;--at)$t[it|at<<Ye]=Ye&7|Ze<<3}var Pt=[];for(Ae=1;Pt.length<Z+ee;)switch(it=$t[Re(q,ae)],ae+=it&7,it>>>=3){case 16:for(ce=3+Ue(q,ae),ae+=2,it=Pt[Pt.length-1];ce-- >0;)Pt.push(it);break;case 17:for(ce=3+xe(q,ae),ae+=3;ce-- >0;)Pt.push(0);break;case 18:for(ce=11+Re(q,ae),ae+=7;ce-- >0;)Pt.push(0);break;default:Pt.push(it),Ae<it&&(Ae=it);break}var pr=Pt.slice(0,Z),zt=Pt.slice(Z);for(Ze=Z;Ze<286;++Ze)pr[Ze]=0;for(Ze=ee;Ze<30;++Ze)zt[Ze]=0;return mt=Fe(pr,dt,286),Tt=Fe(zt,Qt,30),ae}function Pe(q,ae){if(q[0]==3&&!(q[1]&3))return[Ol(ae),2];for(var Z=0,ee=0,ie=Ny(ae||1<<18),ce=0,Se=ie.length>>>0,Le=0,Ae=0;!(ee&1);){if(ee=xe(q,Z),Z+=3,ee>>>1)ee>>1==1?(Le=9,Ae=5):(Z=er(q,Z),Le=mt,Ae=Tt);else{Z&7&&(Z+=8-(Z&7));var Ee=q[Z>>>3]|q[(Z>>>3)+1]<<8;if(Z+=32,Ee>0)for(!ae&&Se<ce+Ee&&(ie=ft(ie,ce+Ee),Se=ie.length);Ee-- >0;)ie[ce++]=q[Z>>>3],Z+=8;continue}for(;;){!ae&&Se<ce+32767&&(ie=ft(ie,ce+32767),Se=ie.length);var Ce=ot(q,Z,Le),Ge=ee>>>1==1?Xe[Ce]:dt[Ce];if(Z+=Ge&15,Ge>>>=4,!(Ge>>>8&255))ie[ce++]=Ge;else{if(Ge==256)break;Ge-=257;var Ze=Ge<8?0:Ge-4>>2;Ze>5&&(Ze=0);var it=ce+X[Ge];Ze>0&&(it+=ot(q,Z,Ze),Z+=Ze),Ce=ot(q,Z,Ae),Ge=ee>>>1==1?At[Ce]:Qt[Ce],Z+=Ge&15,Ge>>>=4;var Ye=Ge<4?0:Ge-2>>1,at=de[Ge];for(Ye>0&&(at+=ot(q,Z,Ye),Z+=Ye),!ae&&Se<it&&(ie=ft(ie,it+100),Se=ie.length);ce<it;)ie[ce]=ie[ce-at],++ce}}}return ae?[ie,Z+7>>>3]:[ie.slice(0,ce),Z+7>>>3]}function tt(q,ae){var Z=q.slice(q.l||0),ee=Pe(Z,ae);return q.l+=ee[1],ee[0]}function bt(q,ae){if(q)typeof console<"u"&&console.error(ae);else throw new Error(ae)}function Xt(q,ae){var Z=q;Ua(Z,0);var ee=[],ie=[],ce={FileIndex:ee,FullPaths:ie};O(ce,{root:ae.root});for(var Se=Z.length-4;(Z[Se]!=80||Z[Se+1]!=75||Z[Se+2]!=5||Z[Se+3]!=6)&&Se>=0;)--Se;Z.l=Se+4,Z.l+=4;var Le=Z.read_shift(2);Z.l+=6;var Ae=Z.read_shift(4);for(Z.l=Ae,Se=0;Se<Le;++Se){Z.l+=20;var Ee=Z.read_shift(4),Ce=Z.read_shift(4),Ge=Z.read_shift(2),Ze=Z.read_shift(2),it=Z.read_shift(2);Z.l+=8;var Ye=Z.read_shift(4),at=o(Z.slice(Z.l+Ge,Z.l+Ge+Ze));Z.l+=Ge+Ze+it;var Pt=Z.l;Z.l=Ye+4,wr(Z,Ee,Ce,ce,at),Z.l=Pt}return ce}function wr(q,ae,Z,ee,ie){q.l+=2;var ce=q.read_shift(2),Se=q.read_shift(2),Le=s(q);if(ce&8257)throw new Error("Unsupported ZIP encryption");for(var Ae=q.read_shift(4),Ee=q.read_shift(4),Ce=q.read_shift(4),Ge=q.read_shift(2),Ze=q.read_shift(2),it="",Ye=0;Ye<Ge;++Ye)it+=String.fromCharCode(q[q.l++]);if(Ze){var at=o(q.slice(q.l,q.l+Ze));(at[21589]||{}).mt&&(Le=at[21589].mt),((ie||{})[21589]||{}).mt&&(Le=ie[21589].mt)}q.l+=Ze;var Pt=q.slice(q.l,q.l+Ee);switch(Se){case 8:Pt=L(q,Ce);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Se)}var pr=!1;ce&8&&(Ae=q.read_shift(4),Ae==134695760&&(Ae=q.read_shift(4),pr=!0),Ee=q.read_shift(4),Ce=q.read_shift(4)),Ee!=ae&&bt(pr,"Bad compressed size: "+ae+" != "+Ee),Ce!=Z&&bt(pr,"Bad uncompressed size: "+Z+" != "+Ce),Vn(ee,it,Pt,{unsafe:!0,mt:Le})}function Wt(q,ae){var Z=ae||{},ee=[],ie=[],ce=De(1),Se=Z.compression?8:0,Le=0,Ae=0,Ee=0,Ce=0,Ge=0,Ze=q.FullPaths[0],it=Ze,Ye=q.FileIndex[0],at=[],Pt=0;for(Ae=1;Ae<q.FullPaths.length;++Ae)if(it=q.FullPaths[Ae].slice(Ze.length),Ye=q.FileIndex[Ae],!(!Ye.size||!Ye.content||it=="Sh33tJ5")){var pr=Ce,zt=De(it.length);for(Ee=0;Ee<it.length;++Ee)zt.write_shift(1,it.charCodeAt(Ee)&127);zt=zt.slice(0,zt.l),at[Ge]=_P.buf(Ye.content,0);var Mr=Ye.content;Se==8&&(Mr=D(Mr)),ce=De(30),ce.write_shift(4,67324752),ce.write_shift(2,20),ce.write_shift(2,Le),ce.write_shift(2,Se),Ye.mt?i(ce,Ye.mt):ce.write_shift(4,0),ce.write_shift(-4,at[Ge]),ce.write_shift(4,Mr.length),ce.write_shift(4,Ye.content.length),ce.write_shift(2,zt.length),ce.write_shift(2,0),Ce+=ce.length,ee.push(ce),Ce+=zt.length,ee.push(zt),Ce+=Mr.length,ee.push(Mr),ce=De(46),ce.write_shift(4,33639248),ce.write_shift(2,0),ce.write_shift(2,20),ce.write_shift(2,Le),ce.write_shift(2,Se),ce.write_shift(4,0),ce.write_shift(-4,at[Ge]),ce.write_shift(4,Mr.length),ce.write_shift(4,Ye.content.length),ce.write_shift(2,zt.length),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(4,0),ce.write_shift(4,pr),Pt+=ce.l,ie.push(ce),Pt+=zt.length,ie.push(zt),++Ge}return ce=De(22),ce.write_shift(4,101010256),ce.write_shift(2,0),ce.write_shift(2,0),ce.write_shift(2,Ge),ce.write_shift(2,Ge),ce.write_shift(4,Pt),ce.write_shift(4,Ce),ce.write_shift(2,0),zn([zn(ee),zn(ie),ce])}var _t={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ut(q,ae){if(q.ctype)return q.ctype;var Z=q.name||"",ee=Z.match(/\.([^\.]+)$/);return ee&&_t[ee[1]]||ae&&(ee=(Z=ae).match(/[\.\\]([^\.\\])+$/),ee&&_t[ee[1]])?_t[ee[1]]:"application/octet-stream"}function ir(q){for(var ae=Tf(q),Z=[],ee=0;ee<ae.length;ee+=76)Z.push(ae.slice(ee,ee+76));return Z.join(`\r
`)+`\r
`}function Dr(q){var ae=q.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ee){var Ce=Ee.charCodeAt(0).toString(16).toUpperCase();return"="+(Ce.length==1?"0"+Ce:Ce)});ae=ae.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),ae.charAt(0)==`
`&&(ae="=0D"+ae.slice(1)),ae=ae.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var Z=[],ee=ae.split(`\r
`),ie=0;ie<ee.length;++ie){var ce=ee[ie];if(ce.length==0){Z.push("");continue}for(var Se=0;Se<ce.length;){var Le=76,Ae=ce.slice(Se,Se+Le);Ae.charAt(Le-1)=="="?Le--:Ae.charAt(Le-2)=="="?Le-=2:Ae.charAt(Le-3)=="="&&(Le-=3),Ae=ce.slice(Se,Se+Le),Se+=Le,Se<ce.length&&(Ae+="="),Z.push(Ae)}}return Z.join(`\r
`)}function dn(q){for(var ae=[],Z=0;Z<q.length;++Z){for(var ee=q[Z];Z<=q.length&&ee.charAt(ee.length-1)=="=";)ee=ee.slice(0,ee.length-1)+q[++Z];ae.push(ee)}for(var ie=0;ie<ae.length;++ie)ae[ie]=ae[ie].replace(/[=][0-9A-Fa-f]{2}/g,function(ce){return String.fromCharCode(parseInt(ce.slice(1),16))});return ki(ae.join(`\r
`))}function Cn(q,ae,Z){for(var ee="",ie="",ce="",Se,Le=0;Le<10;++Le){var Ae=ae[Le];if(!Ae||Ae.match(/^\s*$/))break;var Ee=Ae.match(/^(.*?):\s*([^\s].*)$/);if(Ee)switch(Ee[1].toLowerCase()){case"content-location":ee=Ee[2].trim();break;case"content-type":ce=Ee[2].trim();break;case"content-transfer-encoding":ie=Ee[2].trim();break}}switch(++Le,ie.toLowerCase()){case"base64":Se=ki(Ms(ae.slice(Le).join("")));break;case"quoted-printable":Se=dn(ae.slice(Le));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ie)}var Ce=Vn(q,ee.slice(Z.length),Se,{unsafe:!0});ce&&(Ce.ctype=ce)}function Et(q,ae){if(le(q.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var Z=ae&&ae.root||"",ee=(ar&&Buffer.isBuffer(q)?q.toString("binary"):le(q)).split(`\r
`),ie=0,ce="";for(ie=0;ie<ee.length;++ie)if(ce=ee[ie],!!/^Content-Location:/i.test(ce)&&(ce=ce.slice(ce.indexOf("file")),Z||(Z=ce.slice(0,ce.lastIndexOf("/")+1)),ce.slice(0,Z.length)!=Z))for(;Z.length>0&&(Z=Z.slice(0,Z.length-1),Z=Z.slice(0,Z.lastIndexOf("/")+1),ce.slice(0,Z.length)!=Z););var Se=(ee[1]||"").match(/boundary="(.*?)"/);if(!Se)throw new Error("MAD cannot find boundary");var Le="--"+(Se[1]||""),Ae=[],Ee=[],Ce={FileIndex:Ae,FullPaths:Ee};O(Ce);var Ge,Ze=0;for(ie=0;ie<ee.length;++ie){var it=ee[ie];it!==Le&&it!==Le+"--"||(Ze++&&Cn(Ce,ee.slice(Ge,ie),Z),Ge=ie)}return Ce}function yi(q,ae){var Z=ae||{},ee=Z.boundary||"SheetJS";ee="------="+ee;for(var ie=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+ee.slice(2)+'"',"","",""],ce=q.FullPaths[0],Se=ce,Le=q.FileIndex[0],Ae=1;Ae<q.FullPaths.length;++Ae)if(Se=q.FullPaths[Ae].slice(ce.length),Le=q.FileIndex[Ae],!(!Le.size||!Le.content||Se=="Sh33tJ5")){Se=Se.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Pt){return"_x"+Pt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Pt){return"_u"+Pt.charCodeAt(0).toString(16)+"_"});for(var Ee=Le.content,Ce=ar&&Buffer.isBuffer(Ee)?Ee.toString("binary"):le(Ee),Ge=0,Ze=Math.min(1024,Ce.length),it=0,Ye=0;Ye<=Ze;++Ye)(it=Ce.charCodeAt(Ye))>=32&&it<128&&++Ge;var at=Ge>=Ze*4/5;ie.push(ee),ie.push("Content-Location: "+(Z.root||"file:///C:/SheetJS/")+Se),ie.push("Content-Transfer-Encoding: "+(at?"quoted-printable":"base64")),ie.push("Content-Type: "+Ut(Le,Se)),ie.push(""),ie.push(at?Dr(Ce):ir(Ce))}return ie.push(ee+`--\r
`),ie.join(`\r
`)}function bi(q){var ae={};return O(ae,q),ae}function Vn(q,ae,Z,ee){var ie=ee&&ee.unsafe;ie||O(q);var ce=!ie&&gr.find(q,ae);if(!ce){var Se=q.FullPaths[0];ae.slice(0,Se.length)==Se?Se=ae:(Se.slice(-1)!="/"&&(Se+="/"),Se=(Se+ae).replace("//","/")),ce={name:a(ae),type:2},q.FileIndex.push(ce),q.FullPaths.push(Se),ie||gr.utils.cfb_gc(q)}return ce.content=Z,ce.size=Z?Z.length:0,ee&&(ee.CLSID&&(ce.clsid=ee.CLSID),ee.mt&&(ce.mt=ee.mt),ee.ct&&(ce.ct=ee.ct)),ce}function xa(q,ae){O(q);var Z=gr.find(q,ae);if(Z){for(var ee=0;ee<q.FileIndex.length;++ee)if(q.FileIndex[ee]==Z)return q.FileIndex.splice(ee,1),q.FullPaths.splice(ee,1),!0}return!1}function Cr(q,ae,Z){O(q);var ee=gr.find(q,ae);if(ee){for(var ie=0;ie<q.FileIndex.length;++ie)if(q.FileIndex[ie]==ee)return q.FileIndex[ie].name=a(Z),q.FullPaths[ie]=Z,!0}return!1}function rn(q){P(q,!0)}return t.find=T,t.read=F,t.parse=f,t.write=ke,t.writeFile=Q,t.utils={cfb_new:bi,cfb_add:Vn,cfb_del:xa,cfb_mov:Cr,cfb_gc:rn,ReadShift:xf,CheckField:G4,prep_blob:Ua,bconcat:zn,use_zlib:S,_deflateRaw:pt,_inflateRaw:tt,consts:we},t}();function NP(e){return typeof e=="string"?Bh(e):Array.isArray(e)?Y8(e):e}function e0(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=Bh(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?kf(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var a=new Blob([NP(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,e);if(typeof saveAs<"u")return saveAs(a,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=i,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Qf(t)),o.write(t),o.close(),t}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+e)}function Gn(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function Cy(e,t){for(var r=[],n=Gn(e),a=0;a!==n.length;++a)r[e[n[a]][t]]==null&&(r[e[n[a]][t]]=n[a]);return r}function rx(e){for(var t=[],r=Gn(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function zh(e){for(var t=[],r=Gn(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function SP(e){for(var t=[],r=Gn(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var Ud=new Date(1899,11,30,0,0,0);function Ea(e,t){var r=e.getTime(),n=Ud.getTime()+(e.getTimezoneOffset()-Ud.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var P4=new Date,AP=Ud.getTime()+(P4.getTimezoneOffset()-Ud.getTimezoneOffset())*6e4,Oy=P4.getTimezoneOffset();function k4(e){var t=new Date;return t.setTime(e*24*60*60*1e3+AP),t.getTimezoneOffset()!==Oy&&t.setTime(t.getTime()+(t.getTimezoneOffset()-Oy)*6e4),t}var Ly=new Date("2017-02-19T19:06:09.000Z"),C4=isNaN(Ly.getFullYear())?new Date("2/19/17"):Ly,EP=C4.getFullYear()==2017;function ga(e,t){var r=new Date(e);if(EP)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(C4.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function qh(e,t){if(ar&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"‚Ç¨":"¬Ä","‚Äö":"¬Ç",∆í:"¬É","‚Äû":"¬Ñ","‚Ä¶":"¬Ö","‚Ä†":"¬Ü","‚Ä°":"¬á","ÀÜ":"¬à","‚Ä∞":"¬â",≈†:"¬ä","‚Äπ":"¬ã",≈í:"¬å",≈Ω:"¬é","‚Äò":"¬ë","‚Äô":"¬í","‚Äú":"¬ì","‚Äù":"¬î","‚Ä¢":"¬ï","‚Äì":"¬ñ","‚Äî":"¬ó","Àú":"¬ò","‚Ñ¢":"¬ô",≈°:"¬ö","‚Ä∫":"¬õ",≈ì:"¬ú",≈æ:"¬û",≈∏:"¬ü"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[‚Ç¨‚Äö∆í‚Äû‚Ä¶‚Ä†‚Ä°ÀÜ‚Ä∞≈†‚Äπ≈í≈Ω‚Äò‚Äô‚Äú‚Äù‚Ä¢‚Äì‚ÄîÀú‚Ñ¢≈°‚Ä∫≈ì≈æ≈∏]/g,function(i){return r[i]||i})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function ja(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=ja(e[r]));return t}function $r(e,t){for(var r="";r.length<t;)r+=e;return r}function Ls(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,i){return r=-r,i}),!isNaN(t=Number(n)))?t/r:t}var jP=["january","february","march","april","may","june","july","august","september","october","november","december"];function Pf(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),i=t.getDate();if(isNaN(i))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&jP.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||i>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function Bt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return ar?n=Gs(r):n=X8(r),gr.utils.cfb_add(e,t,n)}gr.utils.cfb_add(e,t,r)}else e.file(t,r)}function nx(){return gr.utils.cfb_new()}var fn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,TP={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},ax=rx(TP),ix=/[&<>'"]/g,PP=/[\u0000-\u0008\u000b-\u001f]/g;function dr(e){var t=e+"";return t.replace(ix,function(r){return ax[r]}).replace(PP,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Fy(e){return dr(e).replace(/ /g,"_x0020_")}var O4=/[\u0000-\u001f]/g;function kP(e){var t=e+"";return t.replace(ix,function(r){return ax[r]}).replace(/\n/g,"<br/>").replace(O4,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function CP(e){var t=e+"";return t.replace(ix,function(r){return ax[r]}).replace(O4,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function OP(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function LP(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function km(e){for(var t="",r=0,n=0,a=0,i=0,s=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=a&63,t+=String.fromCharCode(s);continue}if(i=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|i&63);continue}s=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(i&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Dy(e){var t=Ol(2*e.length),r,n,a=1,i=0,s=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[i++]=s&255,t[i++]=s>>>8,s=0),t[i++]=r%256,t[i++]=r>>>8;return t.slice(0,i).toString("ucs2")}function Iy(e){return Gs(e,"binary").toString("utf8")}var X0="foo bar baz√¢¬ò¬É√∞¬ü¬ç¬£",gf=ar&&(Iy(X0)==km(X0)&&Iy||Dy(X0)==km(X0)&&Dy)||km,kf=ar?function(e){return Gs(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},FP=function(){var e=[["nbsp"," "],["middot","¬∑"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),L4=/(^\s|\s$|\n)/;function qn(e,t){return"<"+e+(t.match(L4)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Cf(e){return Gn(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Je(e,t,r){return"<"+e+(r!=null?Cf(r):"")+(t!=null?(t.match(L4)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function W1(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function DP(e,t){switch(typeof e){case"string":var r=Je("vt:lpwstr",dr(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Je((e|0)==e?"vt:i4":"vt:r8",dr(String(e)));case"boolean":return Je("vt:bool",e?"true":"false")}if(e instanceof Date)return Je("vt:filetime",W1(e));throw new Error("Unable to serialize "+e)}var En={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},au=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],za={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function IP(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,i=5;i>=0;--i)a=a*256+e[t+i];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function MP(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,i=0,s=n?-t:t;isFinite(s)?s==0?a=i=0:(a=Math.floor(Math.log(s)/Math.LN2),i=s*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(t)?26985:0);for(var o=0;o<=5;++o,i/=256)e[r+o]=i&255;e[r+6]=(a&15)<<4|i&15,e[r+7]=a>>4|n}var My=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,i=e[0][n].length;a<i;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},Ry=ar?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Gs(t)})):My(e)}:My,By=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(of(e,a)));return n.join("").replace(mf,"")},sx=ar?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(mf,""):By(e,t,r)}:By,Uy=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},F4=ar?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Uy(e,t,r)}:Uy,$y=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(wc(e,a)));return n.join("")},t0=ar?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):$y(t,r,n)}:$y,D4=function(e,t){var r=qa(e,t);return r>0?t0(e,t+4,t+4+r-1):""},I4=D4,M4=function(e,t){var r=qa(e,t);return r>0?t0(e,t+4,t+4+r-1):""},R4=M4,B4=function(e,t){var r=2*qa(e,t);return r>0?t0(e,t+4,t+4+r-1):""},U4=B4,$4=function(t,r){var n=qa(t,r);return n>0?sx(t,r+4,r+4+n):""},z4=$4,q4=function(e,t){var r=qa(e,t);return r>0?t0(e,t+4,t+4+r):""},W4=q4,H4=function(e,t){return IP(e,t)},$d=H4,ox=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};ar&&(I4=function(t,r){if(!Buffer.isBuffer(t))return D4(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},R4=function(t,r){if(!Buffer.isBuffer(t))return M4(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},U4=function(t,r){if(!Buffer.isBuffer(t))return B4(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},z4=function(t,r){if(!Buffer.isBuffer(t))return $4(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},W4=function(t,r){if(!Buffer.isBuffer(t))return q4(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},$d=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):H4(t,r)},ox=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var wc=function(e,t){return e[t]},of=function(e,t){return e[t+1]*256+e[t]},RP=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},qa=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},dl=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},BP=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function xf(e,t){var r="",n,a,i=[],s,o,c,u;switch(t){case"dbcs":if(u=this.l,ar&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(c=0;c<e;++c)r+=String.fromCharCode(of(this,u)),u+=2;e*=2;break;case"utf8":r=t0(this,this.l,this.l+e);break;case"utf16le":e*=2,r=sx(this,this.l,this.l+e);break;case"wstr":return xf.call(this,e,"dbcs");case"lpstr-ansi":r=I4(this,this.l),e=4+qa(this,this.l);break;case"lpstr-cp":r=R4(this,this.l),e=4+qa(this,this.l);break;case"lpwstr":r=U4(this,this.l),e=4+2*qa(this,this.l);break;case"lpp4":e=4+qa(this,this.l),r=z4(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+qa(this,this.l),r=W4(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=wc(this,this.l+e++))!==0;)i.push(V0(s));r=i.join("");break;case"_wstr":for(e=0,r="";(s=of(this,this.l+e))!==0;)i.push(V0(s)),e+=2;e+=2,r=i.join("");break;case"dbcs-cont":for(r="",u=this.l,c=0;c<e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return s=wc(this,u),this.l=u+1,o=xf.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(V0(of(this,u))),u+=2}r=i.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",u=this.l,c=0;c!=e;++c){if(this.lens&&this.lens.indexOf(u)!==-1)return s=wc(this,u),this.l=u+1,o=xf.call(this,e-c,s?"dbcs-cont":"sbcs-cont"),i.join("")+o;i.push(V0(wc(this,u))),u+=1}r=i.join("");break;default:switch(e){case 1:return n=wc(this,this.l),this.l++,n;case 2:return n=(t==="i"?RP:of)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?dl:BP)(this,this.l),this.l+=4,n):(a=qa(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=$d(this,this.l):a=$d([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=F4(this,this.l,e);break}}return this.l+=e,r}var UP=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},$P=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},zP=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function qP(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)zP(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var i=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var s=t.charCodeAt(a);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,UP(this,t,this.l);break;case 8:if(n=8,r==="f"){MP(this,t,this.l);break}case 16:break;case-4:n=4,$P(this,t,this.l);break}return this.l+=n,this}function G4(e,t){var r=F4(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Ua(e,t){e.l=t,e.read_shift=xf,e.chk=G4,e.write_shift=qP}function us(e,t){e.l+=t}function De(e){var t=Ol(e);return Ua(t,0),t}function Aa(){var e=[],t=ar?256:2048,r=function(u){var f=De(u);return Ua(f,0),f},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},i=function(u){return n&&u<n.length-n.l?n:(a(),n=r(Math.max(u+1,t)))},s=function(){return a(),zn(e)},o=function(u){a(),n=u,n.l==null&&(n.l=n.length),i(t)};return{next:i,push:o,end:s,_bufs:e}}function qe(e,t,r,n){var a=+t,i;if(!isNaN(a)){n||(n=IF[a].p||(r||[]).length||0),i=1+(a>=128?1:0)+1,n>=128&&++i,n>=16384&&++i,n>=2097152&&++i;var s=e.next(i);a<=127?s.write_shift(1,a):(s.write_shift(1,(a&127)+128),s.write_shift(1,a>>7));for(var o=0;o!=4;++o)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&ox(r)&&e.push(r)}}function vf(e,t,r){var n=ja(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function zy(e,t,r){var n=ja(e);return n.s=vf(n.s,t.s,r),n.e=vf(n.e,t.s,r),n}function yf(e,t){if(e.cRel&&e.c<0)for(e=ja(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=ja(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=hr(e);return!e.cRel&&e.cRel!=null&&(r=GP(r)),!e.rRel&&e.rRel!=null&&(r=WP(r)),r}function Cm(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+ra(e.s.c)+":"+(e.e.cRel?"":"$")+ra(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Hn(e.s.r)+":"+(e.e.rRel?"":"$")+Hn(e.e.r):yf(e.s,t.biff)+":"+yf(e.e,t.biff)}function lx(e){return parseInt(HP(e),10)-1}function Hn(e){return""+(e+1)}function WP(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function HP(e){return e.replace(/\$(\d+)$/,"$1")}function cx(e){for(var t=VP(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function ra(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function GP(e){return e.replace(/^([A-Z])/,"$$$1")}function VP(e){return e.replace(/^\$([A-Z])/,"$1")}function KP(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function jn(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function hr(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function Ya(e){var t=e.indexOf(":");return t==-1?{s:jn(e),e:jn(e)}:{s:jn(e.slice(0,t)),e:jn(e.slice(t+1))}}function cn(e,t){return typeof t>"u"||typeof t=="number"?cn(e.s,e.e):(typeof e!="string"&&(e=hr(e)),typeof t!="string"&&(t=hr(t)),e==t?e:e+":"+t)}function kr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,i=e.length;for(r=0;n<i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===i||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=i&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=i&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function qy(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Ro(e.z,r?Ea(t):t)}catch{}try{return e.w=Ro((e.XF||{}).numFmtId||(r?14:0),r?Ea(t):t)}catch{return""+t}}function Rs(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?r0[e.v]||e.v:t==null?qy(e,e.v):qy(e,t))}function zl(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function V4(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,i=e||(a?[]:{}),s=0,o=0;if(i&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?jn(n.origin):n.origin;s=c.r,o=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var f=kr(i["!ref"]);u.s.c=f.s.c,u.s.r=f.s.r,u.e.c=Math.max(u.e.c,f.e.c),u.e.r=Math.max(u.e.r,f.e.r),s==-1&&(u.e.r=s=f.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=t[d].length;++p)if(!(typeof t[d][p]>"u")){var h={v:t[d][p]},x=s+d,g=o+p;if(u.s.r>x&&(u.s.r=x),u.s.c>g&&(u.s.c=g),u.e.r<x&&(u.e.r=x),u.e.c<g&&(u.e.c=g),t[d][p]&&typeof t[d][p]=="object"&&!Array.isArray(t[d][p])&&!(t[d][p]instanceof Date))h=t[d][p];else if(Array.isArray(h.v)&&(h.f=t[d][p][1],h.v=h.v[0]),h.v===null)if(h.f)h.t="n";else if(n.nullError)h.t="e",h.v=0;else if(n.sheetStubs)h.t="z";else continue;else typeof h.v=="number"?h.t="n":typeof h.v=="boolean"?h.t="b":h.v instanceof Date?(h.z=n.dateNF||Wr[14],n.cellDates?(h.t="d",h.w=Ro(h.z,Ea(h.v))):(h.t="n",h.v=Ea(h.v),h.w=Ro(h.z,h.v))):h.t="s";if(a)i[x]||(i[x]=[]),i[x][g]&&i[x][g].z&&(h.z=i[x][g].z),i[x][g]=h;else{var y=hr({c:g,r:x});i[y]&&i[y].z&&(h.z=i[y].z),i[y]=h}}}return u.s.c<1e7&&(i["!ref"]=cn(u)),i}function iu(e,t){return V4(null,e,t)}function YP(e){return e.read_shift(4,"i")}function Di(e,t){return t||(t=De(4)),t.write_shift(4,e),t}function na(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Tn(e,t){var r=!1;return t==null&&(r=!0,t=De(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function XP(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function ZP(e,t){return t||(t=De(4)),t.write_shift(2,0),t.write_shift(2,0),t}function ux(e,t){var r=e.l,n=e.read_shift(1),a=na(e),i=[],s={t:a,h:a};if(n&1){for(var o=e.read_shift(4),c=0;c!=o;++c)i.push(XP(e));s.r=i}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}function JP(e,t){var r=!1;return t==null&&(r=!0,t=De(15+4*e.t.length)),t.write_shift(1,0),Tn(e.t,t),r?t.slice(0,t.l):t}var QP=ux;function ek(e,t){var r=!1;return t==null&&(r=!0,t=De(23+4*e.t.length)),t.write_shift(1,1),Tn(e.t,t),t.write_shift(4,1),ZP({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function gi(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function ql(e,t){return t==null&&(t=De(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Wl(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Hl(e,t){return t==null&&(t=De(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var tk=na,K4=Tn;function fx(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function zd(e,t){var r=!1;return t==null&&(r=!0,t=De(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var rk=na,H1=fx,dx=zd;function Y4(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?$d([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):dl(t,0)>>2;return r?a/100:a}function X4(e,t){t==null&&(t=De(4));var r=0,n=0,a=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?n=1:a==(a|0)&&a>=-(1<<29)&&a<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?a:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function Z4(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function nk(e,t){return t||(t=De(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Gl=Z4,su=nk;function ou(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Ll(e,t){return(t||De(8)).write_shift(8,e,"f")}function ak(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),i=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),c=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var u=hk[a];u&&(t.rgb=eb(u));break;case 2:t.rgb=eb([s,o,c]);break;case 3:t.theme=a;break}return i!=0&&(t.tint=i>0?i/32767:i/32768),t}function qd(e,t){if(t||(t=De(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function ik(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function sk(e,t){t||(t=De(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var J4=2,Ba=3,Z0=11,Wd=19,J0=64,ok=65,lk=71,ck=4108,uk=4126,Un=80,Wy={1:{n:"CodePage",t:J4},2:{n:"Category",t:Un},3:{n:"PresentationFormat",t:Un},4:{n:"ByteCount",t:Ba},5:{n:"LineCount",t:Ba},6:{n:"ParagraphCount",t:Ba},7:{n:"SlideCount",t:Ba},8:{n:"NoteCount",t:Ba},9:{n:"HiddenCount",t:Ba},10:{n:"MultimediaClipCount",t:Ba},11:{n:"ScaleCrop",t:Z0},12:{n:"HeadingPairs",t:ck},13:{n:"TitlesOfParts",t:uk},14:{n:"Manager",t:Un},15:{n:"Company",t:Un},16:{n:"LinksUpToDate",t:Z0},17:{n:"CharacterCount",t:Ba},19:{n:"SharedDoc",t:Z0},22:{n:"HyperlinksChanged",t:Z0},23:{n:"AppVersion",t:Ba,p:"version"},24:{n:"DigSig",t:ok},26:{n:"ContentType",t:Un},27:{n:"ContentStatus",t:Un},28:{n:"Language",t:Un},29:{n:"Version",t:Un},255:{},2147483648:{n:"Locale",t:Wd},2147483651:{n:"Behavior",t:Wd},1919054434:{}},Hy={1:{n:"CodePage",t:J4},2:{n:"Title",t:Un},3:{n:"Subject",t:Un},4:{n:"Author",t:Un},5:{n:"Keywords",t:Un},6:{n:"Comments",t:Un},7:{n:"Template",t:Un},8:{n:"LastAuthor",t:Un},9:{n:"RevNumber",t:Un},10:{n:"EditTime",t:J0},11:{n:"LastPrinted",t:J0},12:{n:"CreatedDate",t:J0},13:{n:"ModifiedDate",t:J0},14:{n:"PageCount",t:Ba},15:{n:"WordCount",t:Ba},16:{n:"CharCount",t:Ba},17:{n:"Thumbnail",t:lk},18:{n:"Application",t:Un},19:{n:"DocSecurity",t:Ba},255:{},2147483648:{n:"Locale",t:Wd},2147483651:{n:"Behavior",t:Wd},1919054434:{}};function fk(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var dk=fk([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),hk=ja(dk),r0={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},pk={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Q0={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function Q4(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function e3(e,t){var r=SP(pk),n=[],a;n[n.length]=fn,n[n.length]=Je("Types",null,{xmlns:En.CT,"xmlns:xsd":En.xsd,"xmlns:xsi":En.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return Je("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){e[c]&&e[c].length>0&&(a=e[c][0],n[n.length]=Je("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:Q0[c][t.bookType]||Q0[c].xlsx}))},s=function(c){(e[c]||[]).forEach(function(u){n[n.length]=Je("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Q0[c][t.bookType]||Q0[c].xlsx})})},o=function(c){(e[c]||[]).forEach(function(u){n[n.length]=Je("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:r[c][0]})})};return i("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Zt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function t3(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Oc(e){var t=[fn,Je("Relationships",null,{xmlns:En.RELS})];return Gn(e["!id"]).forEach(function(r){t[t.length]=Je("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function cr(e,t,r,n,a,i){if(a||(a={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,a.Id="rId"+t,a.Type=n,a.Target=r,[Zt.HLINK,Zt.XPATH,Zt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),e["!id"][a.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][a.Id]=a,e[("/"+a.Target).replace("//","/")]=a,t}function mk(e){var t=[fn];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function Gy(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function gk(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function xk(e){var t=[fn];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(Gy(e[r][0],e[r][1])),t.push(gk("",e[r][0]));return t.push(Gy("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function r3(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Id.version+"</meta:generator></office:meta></office:document-meta>"}var Al=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Om(e,t,r,n,a){a[e]!=null||t==null||t===""||(a[e]=t,t=dr(t),n[n.length]=r?Je(e,t,r):qn(e,t))}function n3(e,t){var r=t||{},n=[fn,Je("cp:coreProperties",null,{"xmlns:cp":En.CORE_PROPS,"xmlns:dc":En.dc,"xmlns:dcterms":En.dcterms,"xmlns:dcmitype":En.dcmitype,"xmlns:xsi":En.xsi})],a={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&Om("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:W1(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a),e.ModifiedDate!=null&&Om("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:W1(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,a));for(var i=0;i!=Al.length;++i){var s=Al[i],o=r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:e?e[s[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&Om(s[0],o,null,n,a)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var Lc=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],a3=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function i3(e){var t=[],r=Je;return e||(e={}),e.Application="SheetJS",t[t.length]=fn,t[t.length]=Je("Properties",null,{xmlns:En.EXT_PROPS,"xmlns:vt":En.vt}),Lc.forEach(function(n){if(e[n[1]]!==void 0){var a;switch(n[2]){case"string":a=dr(String(e[n[1]]));break;case"bool":a=e[n[1]]?"true":"false";break}a!==void 0&&(t[t.length]=r(n[0],a))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+dr(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function s3(e){var t=[fn,Je("Properties",null,{xmlns:En.CUST_PROPS,"xmlns:vt":En.vt})];if(!e)return t.join("");var r=1;return Gn(e).forEach(function(a){++r,t[t.length]=Je("property",DP(e[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:dr(a)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Vy={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function vk(e,t){var r=[];return Gn(Vy).map(function(n){for(var a=0;a<Al.length;++a)if(Al[a][1]==n)return Al[a];for(a=0;a<Lc.length;++a)if(Lc[a][1]==n)return Lc[a];throw n}).forEach(function(n){if(e[n[1]]!=null){var a=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),r.push(qn(Vy[n[1]]||n[1],a))}}),Je("DocumentProperties",r.join(""),{xmlns:za.o})}function yk(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",a=[];return e&&Gn(e).forEach(function(i){if(Object.prototype.hasOwnProperty.call(e,i)){for(var s=0;s<Al.length;++s)if(i==Al[s][1])return;for(s=0;s<Lc.length;++s)if(i==Lc[s][1])return;for(s=0;s<r.length;++s)if(i==r[s])return;var o=e[i],c="string";typeof o=="number"?(c="float",o=String(o)):o===!0||o===!1?(c="boolean",o=o?"1":"0"):o=String(o),a.push(Je(Fy(i),o,{"dt:dt":c}))}}),t&&Gn(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)&&!(e&&Object.prototype.hasOwnProperty.call(e,i))){var s=t[i],o="string";typeof s=="number"?(o="float",s=String(s)):s===!0||s===!1?(o="boolean",s=s?"1":"0"):s instanceof Date?(o="dateTime.tz",s=s.toISOString()):s=String(s),a.push(Je(Fy(i),s,{"dt:dt":o}))}}),"<"+n+' xmlns="'+za.o+'">'+a.join("")+"</"+n+">"}function bk(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),a=(r-n)/Math.pow(2,32);n*=1e7,a*=1e7;var i=n/Math.pow(2,32)|0;i>0&&(n=n%Math.pow(2,32),a+=i);var s=De(8);return s.write_shift(4,n),s.write_shift(4,a),s}function Ky(e,t){var r=De(4),n=De(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=De(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=bk(t);break;case 31:case 80:for(n=De(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return zn([r,n])}var o3=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function wk(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function Yy(e,t,r){var n=De(8),a=[],i=[],s=8,o=0,c=De(8),u=De(8);if(c.write_shift(4,2),c.write_shift(4,1200),u.write_shift(4,1),i.push(c),a.push(u),s+=8+c.length,!t){u=De(8),u.write_shift(4,0),a.unshift(u);var f=[De(4)];for(f[0].write_shift(4,e.length),o=0;o<e.length;++o){var d=e[o][0];for(c=De(8+2*(d.length+1)+(d.length%2?0:2)),c.write_shift(4,o+2),c.write_shift(4,d.length+1),c.write_shift(0,d,"dbcs");c.l!=c.length;)c.write_shift(1,0);f.push(c)}c=zn(f),i.unshift(c),s+=8+c.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(o3.indexOf(e[o][0])>-1||a3.indexOf(e[o][0])>-1)&&e[o][1]!=null){var p=e[o][1],h=0;if(t){h=+t[e[o][0]];var x=r[h];if(x.p=="version"&&typeof p=="string"){var g=p.split(".");p=(+g[0]<<16)+(+g[1]||0)}c=Ky(x.t,p)}else{var y=wk(p);y==-1&&(y=31,p=String(p)),c=Ky(y,p)}i.push(c),u=De(8),u.write_shift(4,t?h:2+o),a.push(u),s+=8+c.length}var b=8*(i.length+1);for(o=0;o<i.length;++o)a[o].write_shift(4,b),b+=i[o].length;return n.write_shift(4,s),n.write_shift(4,i.length),zn([n].concat(a).concat(i))}function Xy(e,t,r,n,a,i){var s=De(a?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,gr.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,a?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,a?68:48);var c=Yy(e,r,n);if(o.push(c),a){var u=Yy(a,null,null);s.write_shift(16,i,"hex"),s.write_shift(4,68+c.length),o.push(u)}return zn(o)}function _k(e,t){t||(t=De(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function Nk(e,t){return e.read_shift(t)===1}function da(e,t){return t||(t=De(2)),t.write_shift(2,+!!e),t}function l3(e){return e.read_shift(2,"u")}function ci(e,t){return t||(t=De(2)),t.write_shift(2,e),t}function c3(e,t,r){return r||(r=De(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function u3(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var i=e.read_shift(1);i&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var s=n?e.read_shift(n,a):"";return s}function Sk(e){var t=e.t||"",r=De(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=De(2*t.length);n.write_shift(2*t.length,t,"utf16le");var a=[r,n];return zn(a)}function Ak(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Ek(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):Ak(e,n,r)}function jk(e,t,r){if(r.biff>5)return Ek(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function f3(e,t,r){return r||(r=De(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function Zy(e,t){t||(t=De(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function Tk(e){var t=De(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var a=n.indexOf("#"),i=a>-1?31:23;switch(n.charAt(0)){case"#":i=28;break;case".":i&=-3;break}t.write_shift(4,2),t.write_shift(4,i);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)t.write_shift(4,s[r]);if(i==28)n=n.slice(1),Zy(n,t);else if(i&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));var o=a>-1?n.slice(0,a):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),i&8&&Zy(a>-1?n.slice(a+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));for(var c=0;n.slice(c*3,c*3+3)=="../"||n.slice(c*3,c*3+3)=="..\\";)++c;for(t.write_shift(2,c),t.write_shift(4,n.length-3*c+1),r=0;r<n.length-3*c;++r)t.write_shift(1,n.charCodeAt(r+3*c)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Fl(e,t,r,n){return n||(n=De(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function Pk(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),i=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[a,i,s]}function kk(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function d3(e,t){return t||(t=De(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function hx(e,t,r){var n=1536,a=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,a=8;break;case"biff4":n=4,a=6;break;case"biff3":n=3,a=6;break;case"biff2":n=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=De(a);return i.write_shift(2,n),i.write_shift(2,t),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function Ck(e,t){var r=!t||t.biff==8,n=De(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function Ok(e,t){var r=!t||t.biff>=8?2:1,n=De(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var a=n.slice(0,n.l);return a.l=n.l,a}function Lk(e,t){var r=De(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],a=0;a<e.length;++a)n[a]=Sk(e[a]);var i=zn([r].concat(n));return i.parts=[r.length].concat(n.map(function(s){return s.length})),i}function Fk(){var e=De(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Dk(e){var t=De(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function Ik(e,t){var r=e.name||"Arial",n=t&&t.biff==5,a=n?15+r.length:16+2*r.length,i=De(a);return i.write_shift(2,(e.sz||12)*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,r.length),n||i.write_shift(1,1),i.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),i}function Mk(e,t,r,n){var a=De(10);return Fl(e,t,n,a),a.write_shift(4,r),a}function Rk(e,t,r,n,a){var i=!a||a.biff==8,s=De(8+ +i+(1+i)*r.length);return Fl(e,t,n,s),s.write_shift(2,r.length),i&&s.write_shift(1,1),s.write_shift((1+i)*r.length,r,i?"utf16le":"sbcs"),s}function Bk(e,t,r,n){var a=r&&r.biff==5;n||(n=De(a?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(a?1:2,t.length),a||n.write_shift(1,1),n.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le");var i=n.length>n.l?n.slice(0,n.l):n;return i.l==null&&(i.l=i.length),i}function Uk(e,t){var r=t.biff==8||!t.biff?4:2,n=De(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function Jy(e,t,r,n){var a=r&&r.biff==5;n||(n=De(a?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var i=0;return e.numFmtId>0&&a&&(i|=1024),n.write_shift(4,i),n.write_shift(4,0),a||n.write_shift(4,0),n.write_shift(2,0),n}function $k(e){var t=De(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function zk(e,t,r,n,a,i){var s=De(8);return Fl(e,t,n,s),c3(r,i,s),s}function qk(e,t,r,n){var a=De(14);return Fl(e,t,n,a),Ll(r,a),a}function Wk(e,t,r){if(r.biff<8)return Hk(e,t,r);for(var n=[],a=e.l+t,i=e.read_shift(r.biff>8?4:2);i--!==0;)n.push(Pk(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function Hk(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=u3(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function Gk(e){var t=De(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)d3(e[r],t);return t}function Vk(e){var t=De(24),r=jn(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)t.write_shift(1,parseInt(n[a],16));return zn([t,Tk(e[1])])}function Kk(e){var t=e[1].Tooltip,r=De(10+2*(t.length+1));r.write_shift(2,2048);var n=jn(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var a=0;a<t.length;++a)r.write_shift(2,t.charCodeAt(a));return r.write_shift(2,0),r}function Yk(e){return e||(e=De(4)),e.write_shift(2,1),e.write_shift(2,1),e}function Xk(e,t,r){if(!r.cellStyles)return us(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),i=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),c=e.read_shift(2);n==2&&(e.l+=2);var u={s:a,e:i,w:s,ixfe:o,flags:c};return(r.biff>=5||!r.biff)&&(u.level=c>>8&7),u}function Zk(e,t){var r=De(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function Jk(e){for(var t=De(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function Qk(e,t,r){var n=De(15);return a0(n,e,t),n.write_shift(8,r,"f"),n}function eC(e,t,r){var n=De(9);return a0(n,e,t),n.write_shift(2,r),n}var tC=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=rx({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,c){var u=[],f=Ol(1);switch(c.type){case"base64":f=ki(Ms(o));break;case"binary":f=ki(o);break;case"buffer":case"array":f=o;break}Ua(f,0);var d=f.read_shift(1),p=!!(d&136),h=!1,x=!1;switch(d){case 2:break;case 3:break;case 48:h=!0,p=!0;break;case 49:h=!0,p=!0;break;case 131:break;case 139:break;case 140:x=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var g=0,y=521;d==2&&(g=f.read_shift(2)),f.l+=3,d!=2&&(g=f.read_shift(4)),g>1048576&&(g=1e6),d!=2&&(y=f.read_shift(2));var b=f.read_shift(2),E=c.codepage||1252;d!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(E=e[f[f.l]]),f.l+=1,f.l+=2),x&&(f.l+=36);for(var A=[],C={},N=Math.min(f.length,d==2?521:y-10-(h?264:0)),F=x?32:11;f.l<N&&f[f.l]!=13;)switch(C={},C.name=fl.utils.decode(E,f.slice(f.l,f.l+F)).replace(/[\u0000\r\n].*$/g,""),f.l+=F,C.type=String.fromCharCode(f.read_shift(1)),d!=2&&!x&&(C.offset=f.read_shift(4)),C.len=f.read_shift(1),d==2&&(C.offset=f.read_shift(2)),C.dec=f.read_shift(1),C.name.length&&A.push(C),d!=2&&(f.l+=x?13:14),C.type){case"B":(!h||C.len!=8)&&c.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+C.name+":"+C.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+C.type)}if(f[f.l]!==13&&(f.l=y-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=y;var O=0,I=0;for(u[0]=[],I=0;I!=A.length;++I)u[0][I]=A[I].name;for(;g-- >0;){if(f[f.l]===42){f.l+=b;continue}for(++f.l,u[++O]=[],I=0,I=0;I!=A.length;++I){var P=f.slice(f.l,f.l+A[I].len);f.l+=A[I].len,Ua(P,0);var H=fl.utils.decode(E,P);switch(A[I].type){case"C":H.trim().length&&(u[O][I]=H.replace(/\s+$/,""));break;case"D":H.length===8?u[O][I]=new Date(+H.slice(0,4),+H.slice(4,6)-1,+H.slice(6,8)):u[O][I]=H;break;case"F":u[O][I]=parseFloat(H.trim());break;case"+":case"I":u[O][I]=x?P.read_shift(-4,"i")^2147483648:P.read_shift(4,"i");break;case"L":switch(H.trim().toUpperCase()){case"Y":case"T":u[O][I]=!0;break;case"N":case"F":u[O][I]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+H+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));u[O][I]="##MEMO##"+(x?parseInt(H.trim(),10):P.read_shift(4));break;case"N":H=H.replace(/\u0000/g,"").trim(),H&&H!="."&&(u[O][I]=+H||0);break;case"@":u[O][I]=new Date(P.read_shift(-8,"f")-621356832e5);break;case"T":u[O][I]=new Date((P.read_shift(4)-2440588)*864e5+P.read_shift(4));break;case"Y":u[O][I]=P.read_shift(4,"i")/1e4+P.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[O][I]=-P.read_shift(-8,"f");break;case"B":if(h&&A[I].len==8){u[O][I]=P.read_shift(8,"f");break}case"G":case"P":P.l+=A[I].len;break;case"0":if(A[I].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+A[I].type)}}}if(d!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return c&&c.sheetRows&&(u=u.slice(0,c.sheetRows)),c.DBF=A,u}function n(o,c){var u=c||{};u.dateNF||(u.dateNF="yyyymmdd");var f=iu(r(o,u),u);return f["!cols"]=u.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete u.DBF,f}function a(o,c){try{return zl(n(o,c),c)}catch(u){if(c&&c.WTF)throw u}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,c){var u=c||{};if(+u.codepage>=0&&jf(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var f=Aa(),d=Yd(o,{header:1,raw:!0,cellDates:!0}),p=d[0],h=d.slice(1),x=o["!cols"]||[],g=0,y=0,b=0,E=1;for(g=0;g<p.length;++g){if(((x[g]||{}).DBF||{}).name){p[g]=x[g].DBF.name,++b;continue}if(p[g]!=null){if(++b,typeof p[g]=="number"&&(p[g]=p[g].toString(10)),typeof p[g]!="string")throw new Error("DBF Invalid column name "+p[g]+" |"+typeof p[g]+"|");if(p.indexOf(p[g])!==g){for(y=0;y<1024;++y)if(p.indexOf(p[g]+"_"+y)==-1){p[g]+="_"+y;break}}}}var A=kr(o["!ref"]),C=[],N=[],F=[];for(g=0;g<=A.e.c-A.s.c;++g){var O="",I="",P=0,H=[];for(y=0;y<h.length;++y)h[y][g]!=null&&H.push(h[y][g]);if(H.length==0||p[g]==null){C[g]="?";continue}for(y=0;y<H.length;++y){switch(typeof H[y]){case"number":I="B";break;case"string":I="C";break;case"boolean":I="L";break;case"object":I=H[y]instanceof Date?"D":"C";break;default:I="C"}P=Math.max(P,String(H[y]).length),O=O&&O!=I?"C":I}P>250&&(P=250),I=((x[g]||{}).DBF||{}).type,I=="C"&&x[g].DBF.len>P&&(P=x[g].DBF.len),O=="B"&&I=="N"&&(O="N",F[g]=x[g].DBF.dec,P=x[g].DBF.len),N[g]=O=="C"||I=="N"?P:i[O]||0,E+=N[g],C[g]=O}var T=f.next(32);for(T.write_shift(4,318902576),T.write_shift(4,h.length),T.write_shift(2,296+32*b),T.write_shift(2,E),g=0;g<4;++g)T.write_shift(4,0);for(T.write_shift(4,0|(+t[p4]||3)<<8),g=0,y=0;g<p.length;++g)if(p[g]!=null){var j=f.next(32),z=(p[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);j.write_shift(1,z,"sbcs"),j.write_shift(1,C[g]=="?"?"C":C[g],"sbcs"),j.write_shift(4,y),j.write_shift(1,N[g]||i[C[g]]||0),j.write_shift(1,F[g]||0),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(1,0),j.write_shift(4,0),j.write_shift(4,0),y+=N[g]||i[C[g]]||0}var K=f.next(264);for(K.write_shift(4,13),g=0;g<65;++g)K.write_shift(4,0);for(g=0;g<h.length;++g){var he=f.next(E);for(he.write_shift(1,0),y=0;y<p.length;++y)if(p[y]!=null)switch(C[y]){case"L":he.write_shift(1,h[g][y]==null?63:h[g][y]?84:70);break;case"B":he.write_shift(8,h[g][y]||0,"f");break;case"N":var be="0";for(typeof h[g][y]=="number"&&(be=h[g][y].toFixed(F[y]||0)),b=0;b<N[y]-be.length;++b)he.write_shift(1,32);he.write_shift(1,be,"sbcs");break;case"D":h[g][y]?(he.write_shift(4,("0000"+h[g][y].getFullYear()).slice(-4),"sbcs"),he.write_shift(2,("00"+(h[g][y].getMonth()+1)).slice(-2),"sbcs"),he.write_shift(2,("00"+h[g][y].getDate()).slice(-2),"sbcs")):he.write_shift(8,"00000000","sbcs");break;case"C":var we=String(h[g][y]!=null?h[g][y]:"").slice(0,N[y]);for(he.write_shift(1,we,"sbcs"),b=0;b<N[y]-we.length;++b)he.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:a,to_sheet:n,from_sheet:s}}(),rC=function(){var e={AA:"√Ä",BA:"√Å",CA:"√Ç",DA:195,HA:"√Ñ",JA:197,AE:"√à",BE:"√â",CE:"√ä",HE:"√ã",AI:"√å",BI:"√ç",CI:"√é",HI:"√è",AO:"√í",BO:"√ì",CO:"√î",DO:213,HO:"√ñ",AU:"√ô",BU:"√ö",CU:"√õ",HU:"√ú",Aa:"√†",Ba:"√°",Ca:"√¢",Da:227,Ha:"√§",Ja:229,Ae:"√®",Be:"√©",Ce:"√™",He:"√´",Ai:"√¨",Bi:"√≠",Ci:"√Æ",Hi:"√Ø",Ao:"√≤",Bo:"√≥",Co:"√¥",Do:245,Ho:"√∂",Au:"√π",Bu:"√∫",Cu:"√ª",Hu:"√º",KC:"√á",Kc:"√ß",q:"√¶",z:"≈ì",a:"√Ü",j:"≈í",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Gn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,h){var x=e[h];return typeof x=="number"?_y(x):x},n=function(p,h,x){var g=h.charCodeAt(0)-32<<4|x.charCodeAt(0)-48;return g==59?p:_y(g)};e["|"]=254;function a(p,h){switch(h.type){case"base64":return i(Ms(p),h);case"binary":return i(p,h);case"buffer":return i(ar&&Buffer.isBuffer(p)?p.toString("binary"):Qf(p),h);case"array":return i(qh(p),h)}throw new Error("Unrecognized type "+h.type)}function i(p,h){var x=p.split(/[\n\r]+/),g=-1,y=-1,b=0,E=0,A=[],C=[],N=null,F={},O=[],I=[],P=[],H=0,T;for(+h.codepage>=0&&jf(+h.codepage);b!==x.length;++b){H=0;var j=x[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),z=j.replace(/;;/g,"\0").split(";").map(function(R){return R.replace(/\u0000/g,";")}),K=z[0],he;if(j.length>0)switch(K){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":z[1].charAt(0)=="P"&&C.push(j.slice(3).replace(/;;/g,";"));break;case"C":var be=!1,we=!1,Q=!1,le=!1,ke=-1,ve=-1;for(E=1;E<z.length;++E)switch(z[E].charAt(0)){case"A":break;case"X":y=parseInt(z[E].slice(1))-1,we=!0;break;case"Y":for(g=parseInt(z[E].slice(1))-1,we||(y=0),T=A.length;T<=g;++T)A[T]=[];break;case"K":he=z[E].slice(1),he.charAt(0)==='"'?he=he.slice(1,he.length-1):he==="TRUE"?he=!0:he==="FALSE"?he=!1:isNaN(Ls(he))?isNaN(Pf(he).getDate())||(he=ga(he)):(he=Ls(he),N!==null&&E4(N)&&(he=k4(he))),be=!0;break;case"E":le=!0;var S=eO(z[E].slice(1),{r:g,c:y});A[g][y]=[A[g][y],S];break;case"S":Q=!0,A[g][y]=[A[g][y],"S5S"];break;case"G":break;case"R":ke=parseInt(z[E].slice(1))-1;break;case"C":ve=parseInt(z[E].slice(1))-1;break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+j)}if(be&&(A[g][y]&&A[g][y].length==2?A[g][y][0]=he:A[g][y]=he,N=null),Q){if(le)throw new Error("SYLK shared formula cannot have own formula");var L=ke>-1&&A[ke][ve];if(!L||!L[1])throw new Error("SYLK shared formula cannot find base");A[g][y][1]=tO(L[1],{r:g-ke,c:y-ve})}break;case"F":var D=0;for(E=1;E<z.length;++E)switch(z[E].charAt(0)){case"X":y=parseInt(z[E].slice(1))-1,++D;break;case"Y":for(g=parseInt(z[E].slice(1))-1,T=A.length;T<=g;++T)A[T]=[];break;case"M":H=parseInt(z[E].slice(1))/20;break;case"F":break;case"G":break;case"P":N=C[parseInt(z[E].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(P=z[E].slice(1).split(" "),T=parseInt(P[0],10);T<=parseInt(P[1],10);++T)H=parseInt(P[2],10),I[T-1]=H===0?{hidden:!0}:{wch:H},px(I[T-1]);break;case"C":y=parseInt(z[E].slice(1))-1,I[y]||(I[y]={});break;case"R":g=parseInt(z[E].slice(1))-1,O[g]||(O[g]={}),H>0?(O[g].hpt=H,O[g].hpx=x3(H)):H===0&&(O[g].hidden=!0);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+j)}D<1&&(N=null);break;default:if(h&&h.WTF)throw new Error("SYLK bad record "+j)}}return O.length>0&&(F["!rows"]=O),I.length>0&&(F["!cols"]=I),h&&h.sheetRows&&(A=A.slice(0,h.sheetRows)),[A,F]}function s(p,h){var x=a(p,h),g=x[0],y=x[1],b=iu(g,h);return Gn(y).forEach(function(E){b[E]=y[E]}),b}function o(p,h){return zl(s(p,h),h)}function c(p,h,x,g){var y="C;Y"+(x+1)+";X"+(g+1)+";K";switch(p.t){case"n":y+=p.v||0,p.f&&!p.F&&(y+=";E"+gx(p.f,{r:x,c:g}));break;case"b":y+=p.v?"TRUE":"FALSE";break;case"e":y+=p.w||p.v;break;case"d":y+='"'+(p.w||p.v)+'"';break;case"s":y+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function u(p,h){h.forEach(function(x,g){var y="F;W"+(g+1)+" "+(g+1)+" ";x.hidden?y+="0":(typeof x.width=="number"&&!x.wpx&&(x.wpx=Hd(x.width)),typeof x.wpx=="number"&&!x.wch&&(x.wch=Gd(x.wpx)),typeof x.wch=="number"&&(y+=Math.round(x.wch))),y.charAt(y.length-1)!=" "&&p.push(y)})}function f(p,h){h.forEach(function(x,g){var y="F;";x.hidden?y+="M0;":x.hpt?y+="M"+20*x.hpt+";":x.hpx&&(y+="M"+20*Vd(x.hpx)+";"),y.length>2&&p.push(y+"R"+(g+1))})}function d(p,h){var x=["ID;PWXL;N;E"],g=[],y=kr(p["!ref"]),b,E=Array.isArray(p),A=`\r
`;x.push("P;PGeneral"),x.push("F;P0;DG0G8;M255"),p["!cols"]&&u(x,p["!cols"]),p["!rows"]&&f(x,p["!rows"]),x.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var C=y.s.r;C<=y.e.r;++C)for(var N=y.s.c;N<=y.e.c;++N){var F=hr({r:C,c:N});b=E?(p[C]||[])[N]:p[F],!(!b||b.v==null&&(!b.f||b.F))&&g.push(c(b,p,C,N))}return x.join(A)+A+g.join(A)+A+"E"+A}return{to_workbook:o,to_sheet:s,from_sheet:d}}(),nC=function(){function e(i,s){switch(s.type){case"base64":return t(Ms(i),s);case"binary":return t(i,s);case"buffer":return t(ar&&Buffer.isBuffer(i)?i.toString("binary"):Qf(i),s);case"array":return t(qh(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){for(var o=i.split(`
`),c=-1,u=-1,f=0,d=[];f!==o.length;++f){if(o[f].trim()==="BOT"){d[++c]=[],u=0;continue}if(!(c<0)){var p=o[f].trim().split(","),h=p[0],x=p[1];++f;for(var g=o[f]||"";(g.match(/["]/g)||[]).length&1&&f<o.length-1;)g+=`
`+o[++f];switch(g=g.trim(),+h){case-1:if(g==="BOT"){d[++c]=[],u=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?d[c][u]=!0:g==="FALSE"?d[c][u]=!1:isNaN(Ls(x))?isNaN(Pf(x).getDate())?d[c][u]=x:d[c][u]=ga(x):d[c][u]=Ls(x),++u;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),d[c][u++]=g!==""?g:null;break}if(g==="EOD")break}}return s&&s.sheetRows&&(d=d.slice(0,s.sheetRows)),d}function r(i,s){return iu(e(i,s),s)}function n(i,s){return zl(r(i,s),s)}var a=function(){var i=function(c,u,f,d,p){c.push(u),c.push(f+","+d),c.push('"'+p.replace(/"/g,'""')+'"')},s=function(c,u,f,d){c.push(u+","+f),c.push(u==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(c){var u=[],f=kr(c["!ref"]),d,p=Array.isArray(c);i(u,"TABLE",0,1,"sheetjs"),i(u,"VECTORS",0,f.e.r-f.s.r+1,""),i(u,"TUPLES",0,f.e.c-f.s.c+1,""),i(u,"DATA",0,0,"");for(var h=f.s.r;h<=f.e.r;++h){s(u,-1,0,"BOT");for(var x=f.s.c;x<=f.e.c;++x){var g=hr({r:h,c:x});if(d=p?(c[h]||[])[x]:c[g],!d){s(u,1,0,"");continue}switch(d.t){case"n":var y=d.w;!y&&d.v!=null&&(y=d.v),y==null?d.f&&!d.F?s(u,1,0,"="+d.f):s(u,1,0,""):s(u,0,y,"V");break;case"b":s(u,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":s(u,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=Ro(d.z||Wr[14],Ea(ga(d.v)))),s(u,0,d.w,"V");break;default:s(u,1,0,"")}}}s(u,-1,0,"EOD");var b=`\r
`,E=u.join(b);return E}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),h3=function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,p){for(var h=d.split(`
`),x=-1,g=-1,y=0,b=[];y!==h.length;++y){var E=h[y].trim().split(":");if(E[0]==="cell"){var A=jn(E[1]);if(b.length<=A.r)for(x=b.length;x<=A.r;++x)b[x]||(b[x]=[]);switch(x=A.r,g=A.c,E[2]){case"t":b[x][g]=e(E[3]);break;case"v":b[x][g]=+E[3];break;case"vtf":var C=E[E.length-1];case"vtc":switch(E[3]){case"nl":b[x][g]=!!+E[4];break;default:b[x][g]=+E[4];break}E[2]=="vtf"&&(b[x][g]=[b[x][g],C])}}}return p&&p.sheetRows&&(b=b.slice(0,p.sheetRows)),b}function n(d,p){return iu(r(d,p),p)}function a(d,p){return zl(n(d,p),p)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function u(d){if(!d||!d["!ref"])return"";for(var p=[],h=[],x,g="",y=Ya(d["!ref"]),b=Array.isArray(d),E=y.s.r;E<=y.e.r;++E)for(var A=y.s.c;A<=y.e.c;++A)if(g=hr({r:E,c:A}),x=b?(d[E]||[])[A]:d[g],!(!x||x.v==null||x.t==="z")){switch(h=["cell",g,"t"],x.t){case"s":case"str":h.push(t(x.v));break;case"n":x.f?(h[2]="vtf",h[3]="n",h[4]=x.v,h[5]=t(x.f)):(h[2]="v",h[3]=x.v);break;case"b":h[2]="vt"+(x.f?"f":"c"),h[3]="nl",h[4]=x.v?"1":"0",h[5]=t(x.f||(x.v?"TRUE":"FALSE"));break;case"d":var C=Ea(ga(x.v));h[2]="vtc",h[3]="nd",h[4]=""+C,h[5]=x.w||Ro(x.z||Wr[14],C);break;case"e":continue}p.push(h.join(":"))}return p.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function f(d){return[i,s,o,s,u(d),c].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:f}}(),aC=function(){function e(f,d,p,h,x){x.raw?d[p][h]=f:f===""||(f==="TRUE"?d[p][h]=!0:f==="FALSE"?d[p][h]=!1:isNaN(Ls(f))?isNaN(Pf(f).getDate())?d[p][h]=f:d[p][h]=ga(f):d[p][h]=Ls(f))}function t(f,d){var p=d||{},h=[];if(!f||f.length===0)return h;for(var x=f.split(/[\r\n]/),g=x.length-1;g>=0&&x[g].length===0;)--g;for(var y=10,b=0,E=0;E<=g;++E)b=x[E].indexOf(" "),b==-1?b=x[E].length:b++,y=Math.max(y,b);for(E=0;E<=g;++E){h[E]=[];var A=0;for(e(x[E].slice(0,y).trim(),h,E,A,p),A=1;A<=(x[E].length-y)/10+1;++A)e(x[E].slice(y+(A-1)*10,y+A*10).trim(),h,E,A,p)}return p.sheetRows&&(h=h.slice(0,p.sheetRows)),h}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(f){for(var d={},p=!1,h=0,x=0;h<f.length;++h)(x=f.charCodeAt(h))==34?p=!p:!p&&x in r&&(d[x]=(d[x]||0)+1);x=[];for(h in d)Object.prototype.hasOwnProperty.call(d,h)&&x.push([d[h],h]);if(!x.length){d=n;for(h in d)Object.prototype.hasOwnProperty.call(d,h)&&x.push([d[h],h])}return x.sort(function(g,y){return g[0]-y[0]||n[g[1]]-n[y[1]]}),r[x.pop()[1]]||44}function i(f,d){var p=d||{},h="",x=p.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(h=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(h=f.charAt(4),f=f.slice(6)):h=a(f.slice(0,1024)):p&&p.FS?h=p.FS:h=a(f.slice(0,1024));var y=0,b=0,E=0,A=0,C=0,N=h.charCodeAt(0),F=!1,O=0,I=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var P=p.dateNF!=null?bP(p.dateNF):null;function H(){var T=f.slice(A,C),j={};if(T.charAt(0)=='"'&&T.charAt(T.length-1)=='"'&&(T=T.slice(1,-1).replace(/""/g,'"')),T.length===0)j.t="z";else if(p.raw)j.t="s",j.v=T;else if(T.trim().length===0)j.t="s",j.v=T;else if(T.charCodeAt(0)==61)T.charCodeAt(1)==34&&T.charCodeAt(T.length-1)==34?(j.t="s",j.v=T.slice(2,-1).replace(/""/g,'"')):rO(T)?(j.t="n",j.f=T.slice(1)):(j.t="s",j.v=T);else if(T=="TRUE")j.t="b",j.v=!0;else if(T=="FALSE")j.t="b",j.v=!1;else if(!isNaN(E=Ls(T)))j.t="n",p.cellText!==!1&&(j.w=T),j.v=E;else if(!isNaN(Pf(T).getDate())||P&&T.match(P)){j.z=p.dateNF||Wr[14];var z=0;P&&T.match(P)&&(T=wP(T,p.dateNF,T.match(P)||[]),z=1),p.cellDates?(j.t="d",j.v=ga(T,z)):(j.t="n",j.v=Ea(ga(T,z))),p.cellText!==!1&&(j.w=Ro(j.z,j.v instanceof Date?Ea(j.v):j.v)),p.cellNF||delete j.z}else j.t="s",j.v=T;if(j.t=="z"||(p.dense?(x[y]||(x[y]=[]),x[y][b]=j):x[hr({c:b,r:y})]=j),A=C+1,I=f.charCodeAt(A),g.e.c<b&&(g.e.c=b),g.e.r<y&&(g.e.r=y),O==N)++b;else if(b=0,++y,p.sheetRows&&p.sheetRows<=y)return!0}e:for(;C<f.length;++C)switch(O=f.charCodeAt(C)){case 34:I===34&&(F=!F);break;case N:case 10:case 13:if(!F&&H())break e;break}return C-A>0&&H(),x["!ref"]=cn(g),x}function s(f,d){return!(d&&d.PRN)||d.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?i(f,d):iu(t(f,d),d)}function o(f,d){var p="",h=d.type=="string"?[0,0,0,0]:gD(f,d);switch(d.type){case"base64":p=Ms(f);break;case"binary":p=f;break;case"buffer":d.codepage==65001?p=f.toString("utf8"):d.codepage&&typeof fl<"u"?p=fl.utils.decode(d.codepage,f):p=ar&&Buffer.isBuffer(f)?f.toString("binary"):Qf(f);break;case"array":p=qh(f);break;case"string":p=f;break;default:throw new Error("Unrecognized type "+d.type)}return h[0]==239&&h[1]==187&&h[2]==191?p=gf(p.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?p=gf(p):d.type=="binary"&&typeof fl<"u"&&d.codepage&&(p=fl.utils.decode(d.codepage,fl.utils.encode(28591,p))),p.slice(0,19)=="socialcalc:version:"?h3.to_sheet(d.type=="string"?p:gf(p),d):s(p,d)}function c(f,d){return zl(o(f,d),d)}function u(f){for(var d=[],p=kr(f["!ref"]),h,x=Array.isArray(f),g=p.s.r;g<=p.e.r;++g){for(var y=[],b=p.s.c;b<=p.e.c;++b){var E=hr({r:g,c:b});if(h=x?(f[g]||[])[b]:f[E],!h||h.v==null){y.push("          ");continue}for(var A=(h.w||(Rs(h),h.w)||"").slice(0,10);A.length<10;)A+=" ";y.push(A+(b===0?" ":""))}d.push(y.join(""))}return d.join(`
`)}return{to_workbook:c,to_sheet:o,from_sheet:u}}(),Qy=function(){function e(S,L,D){if(S){Ua(S,S.l||0);for(var R=D.Enum||ke;S.l<S.length;){var X=S.read_shift(2),de=R[X]||R[65535],me=S.read_shift(2),Y=S.l+me,oe=de.f&&de.f(S,me,D);if(S.l=Y,L(oe,de,X))return}}}function t(S,L){switch(L.type){case"base64":return r(ki(Ms(S)),L);case"binary":return r(ki(S),L);case"buffer":case"array":return r(S,L)}throw"Unsupported type "+L.type}function r(S,L){if(!S)return S;var D=L||{},R=D.dense?[]:{},X="Sheet1",de="",me=0,Y={},oe=[],ue=[],fe={s:{r:0,c:0},e:{r:0,c:0}},Ue=D.sheetRows||0;if(S[2]==0&&(S[3]==8||S[3]==9)&&S.length>=16&&S[14]==5&&S[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(S[2]==2)D.Enum=ke,e(S,function(Re,ot,ze){switch(ze){case 0:D.vers=Re,Re>=4096&&(D.qpro=!0);break;case 6:fe=Re;break;case 204:Re&&(de=Re);break;case 222:de=Re;break;case 15:case 51:D.qpro||(Re[1].v=Re[1].v.slice(1));case 13:case 14:case 16:ze==14&&(Re[2]&112)==112&&(Re[2]&15)>1&&(Re[2]&15)<15&&(Re[1].z=D.dateNF||Wr[14],D.cellDates&&(Re[1].t="d",Re[1].v=k4(Re[1].v))),D.qpro&&Re[3]>me&&(R["!ref"]=cn(fe),Y[X]=R,oe.push(X),R=D.dense?[]:{},fe={s:{r:0,c:0},e:{r:0,c:0}},me=Re[3],X=de||"Sheet"+(me+1),de="");var lt=D.dense?(R[Re[0].r]||[])[Re[0].c]:R[hr(Re[0])];if(lt){lt.t=Re[1].t,lt.v=Re[1].v,Re[1].z!=null&&(lt.z=Re[1].z),Re[1].f!=null&&(lt.f=Re[1].f);break}D.dense?(R[Re[0].r]||(R[Re[0].r]=[]),R[Re[0].r][Re[0].c]=Re[1]):R[hr(Re[0])]=Re[1];break}},D);else if(S[2]==26||S[2]==14)D.Enum=ve,S[2]==14&&(D.qpro=!0,S.l=0),e(S,function(Re,ot,ze){switch(ze){case 204:X=Re;break;case 22:Re[1].v=Re[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Re[3]>me&&(R["!ref"]=cn(fe),Y[X]=R,oe.push(X),R=D.dense?[]:{},fe={s:{r:0,c:0},e:{r:0,c:0}},me=Re[3],X="Sheet"+(me+1)),Ue>0&&Re[0].r>=Ue)break;D.dense?(R[Re[0].r]||(R[Re[0].r]=[]),R[Re[0].r][Re[0].c]=Re[1]):R[hr(Re[0])]=Re[1],fe.e.c<Re[0].c&&(fe.e.c=Re[0].c),fe.e.r<Re[0].r&&(fe.e.r=Re[0].r);break;case 27:Re[14e3]&&(ue[Re[14e3][0]]=Re[14e3][1]);break;case 1537:ue[Re[0]]=Re[1],Re[0]==me&&(X=Re[1]);break}},D);else throw new Error("Unrecognized LOTUS BOF "+S[2]);if(R["!ref"]=cn(fe),Y[de||X]=R,oe.push(de||X),!ue.length)return{SheetNames:oe,Sheets:Y};for(var xe={},te=[],nt=0;nt<ue.length;++nt)Y[oe[nt]]?(te.push(ue[nt]||oe[nt]),xe[ue[nt]]=Y[ue[nt]]||Y[oe[nt]]):(te.push(ue[nt]),xe[ue[nt]]={"!ref":"A1"});return{SheetNames:te,Sheets:xe}}function n(S,L){var D=L||{};if(+D.codepage>=0&&jf(+D.codepage),D.type=="string")throw new Error("Cannot write WK1 to JS string");var R=Aa(),X=kr(S["!ref"]),de=Array.isArray(S),me=[];et(R,0,i(1030)),et(R,6,c(X));for(var Y=Math.min(X.e.r,8191),oe=X.s.r;oe<=Y;++oe)for(var ue=Hn(oe),fe=X.s.c;fe<=X.e.c;++fe){oe===X.s.r&&(me[fe]=ra(fe));var Ue=me[fe]+ue,xe=de?(S[oe]||[])[fe]:S[Ue];if(!(!xe||xe.t=="z"))if(xe.t=="n")(xe.v|0)==xe.v&&xe.v>=-32768&&xe.v<=32767?et(R,13,h(oe,fe,xe.v)):et(R,14,g(oe,fe,xe.v));else{var te=Rs(xe);et(R,15,d(oe,fe,te.slice(0,239)))}}return et(R,1),R.end()}function a(S,L){var D=L||{};if(+D.codepage>=0&&jf(+D.codepage),D.type=="string")throw new Error("Cannot write WK3 to JS string");var R=Aa();et(R,0,s(S));for(var X=0,de=0;X<S.SheetNames.length;++X)(S.Sheets[S.SheetNames[X]]||{})["!ref"]&&et(R,27,le(S.SheetNames[X],de++));var me=0;for(X=0;X<S.SheetNames.length;++X){var Y=S.Sheets[S.SheetNames[X]];if(!(!Y||!Y["!ref"])){for(var oe=kr(Y["!ref"]),ue=Array.isArray(Y),fe=[],Ue=Math.min(oe.e.r,8191),xe=oe.s.r;xe<=Ue;++xe)for(var te=Hn(xe),nt=oe.s.c;nt<=oe.e.c;++nt){xe===oe.s.r&&(fe[nt]=ra(nt));var Re=fe[nt]+te,ot=ue?(Y[xe]||[])[nt]:Y[Re];if(!(!ot||ot.t=="z"))if(ot.t=="n")et(R,23,H(xe,nt,me,ot.v));else{var ze=Rs(ot);et(R,22,O(xe,nt,me,ze.slice(0,239)))}}++me}}return et(R,1),R.end()}function i(S){var L=De(2);return L.write_shift(2,S),L}function s(S){var L=De(26);L.write_shift(2,4096),L.write_shift(2,4),L.write_shift(4,0);for(var D=0,R=0,X=0,de=0;de<S.SheetNames.length;++de){var me=S.SheetNames[de],Y=S.Sheets[me];if(!(!Y||!Y["!ref"])){++X;var oe=Ya(Y["!ref"]);D<oe.e.r&&(D=oe.e.r),R<oe.e.c&&(R=oe.e.c)}}return D>8191&&(D=8191),L.write_shift(2,D),L.write_shift(1,X),L.write_shift(1,R),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(1,1),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(4,0),L}function o(S,L,D){var R={s:{c:0,r:0},e:{c:0,r:0}};return L==8&&D.qpro?(R.s.c=S.read_shift(1),S.l++,R.s.r=S.read_shift(2),R.e.c=S.read_shift(1),S.l++,R.e.r=S.read_shift(2),R):(R.s.c=S.read_shift(2),R.s.r=S.read_shift(2),L==12&&D.qpro&&(S.l+=2),R.e.c=S.read_shift(2),R.e.r=S.read_shift(2),L==12&&D.qpro&&(S.l+=2),R.s.c==65535&&(R.s.c=R.e.c=R.s.r=R.e.r=0),R)}function c(S){var L=De(8);return L.write_shift(2,S.s.c),L.write_shift(2,S.s.r),L.write_shift(2,S.e.c),L.write_shift(2,S.e.r),L}function u(S,L,D){var R=[{c:0,r:0},{t:"n",v:0},0,0];return D.qpro&&D.vers!=20768?(R[0].c=S.read_shift(1),R[3]=S.read_shift(1),R[0].r=S.read_shift(2),S.l+=2):(R[2]=S.read_shift(1),R[0].c=S.read_shift(2),R[0].r=S.read_shift(2)),R}function f(S,L,D){var R=S.l+L,X=u(S,L,D);if(X[1].t="s",D.vers==20768){S.l++;var de=S.read_shift(1);return X[1].v=S.read_shift(de,"utf8"),X}return D.qpro&&S.l++,X[1].v=S.read_shift(R-S.l,"cstr"),X}function d(S,L,D){var R=De(7+D.length);R.write_shift(1,255),R.write_shift(2,L),R.write_shift(2,S),R.write_shift(1,39);for(var X=0;X<R.length;++X){var de=D.charCodeAt(X);R.write_shift(1,de>=128?95:de)}return R.write_shift(1,0),R}function p(S,L,D){var R=u(S,L,D);return R[1].v=S.read_shift(2,"i"),R}function h(S,L,D){var R=De(7);return R.write_shift(1,255),R.write_shift(2,L),R.write_shift(2,S),R.write_shift(2,D,"i"),R}function x(S,L,D){var R=u(S,L,D);return R[1].v=S.read_shift(8,"f"),R}function g(S,L,D){var R=De(13);return R.write_shift(1,255),R.write_shift(2,L),R.write_shift(2,S),R.write_shift(8,D,"f"),R}function y(S,L,D){var R=S.l+L,X=u(S,L,D);if(X[1].v=S.read_shift(8,"f"),D.qpro)S.l=R;else{var de=S.read_shift(2);C(S.slice(S.l,S.l+de),X),S.l+=de}return X}function b(S,L,D){var R=L&32768;return L&=-32769,L=(R?S:0)+(L>=8192?L-16384:L),(R?"":"$")+(D?ra(L):Hn(L))}var E={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},A=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function C(S,L){Ua(S,0);for(var D=[],R=0,X="",de="",me="",Y="";S.l<S.length;){var oe=S[S.l++];switch(oe){case 0:D.push(S.read_shift(8,"f"));break;case 1:de=b(L[0].c,S.read_shift(2),!0),X=b(L[0].r,S.read_shift(2),!1),D.push(de+X);break;case 2:{var ue=b(L[0].c,S.read_shift(2),!0),fe=b(L[0].r,S.read_shift(2),!1);de=b(L[0].c,S.read_shift(2),!0),X=b(L[0].r,S.read_shift(2),!1),D.push(ue+fe+":"+de+X)}break;case 3:if(S.l<S.length){console.error("WK1 premature formula end");return}break;case 4:D.push("("+D.pop()+")");break;case 5:D.push(S.read_shift(2));break;case 6:{for(var Ue="";oe=S[S.l++];)Ue+=String.fromCharCode(oe);D.push('"'+Ue.replace(/"/g,'""')+'"')}break;case 8:D.push("-"+D.pop());break;case 23:D.push("+"+D.pop());break;case 22:D.push("NOT("+D.pop()+")");break;case 20:case 21:Y=D.pop(),me=D.pop(),D.push(["AND","OR"][oe-20]+"("+me+","+Y+")");break;default:if(oe<32&&A[oe])Y=D.pop(),me=D.pop(),D.push(me+A[oe]+Y);else if(E[oe]){if(R=E[oe][1],R==69&&(R=S[S.l++]),R>D.length){console.error("WK1 bad formula parse 0x"+oe.toString(16)+":|"+D.join("|")+"|");return}var xe=D.slice(-R);D.length-=R,D.push(E[oe][0]+"("+xe.join(",")+")")}else return oe<=7?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=24?console.error("WK1 unsupported op "+oe.toString(16)):oe<=30?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=115?console.error("WK1 unsupported function opcode "+oe.toString(16)):console.error("WK1 unrecognized opcode "+oe.toString(16))}}D.length==1?L[1].f=""+D[0]:console.error("WK1 bad formula parse |"+D.join("|")+"|")}function N(S){var L=[{c:0,r:0},{t:"n",v:0},0];return L[0].r=S.read_shift(2),L[3]=S[S.l++],L[0].c=S[S.l++],L}function F(S,L){var D=N(S);return D[1].t="s",D[1].v=S.read_shift(L-4,"cstr"),D}function O(S,L,D,R){var X=De(6+R.length);X.write_shift(2,S),X.write_shift(1,D),X.write_shift(1,L),X.write_shift(1,39);for(var de=0;de<R.length;++de){var me=R.charCodeAt(de);X.write_shift(1,me>=128?95:me)}return X.write_shift(1,0),X}function I(S,L){var D=N(S);D[1].v=S.read_shift(2);var R=D[1].v>>1;if(D[1].v&1)switch(R&7){case 0:R=(R>>3)*5e3;break;case 1:R=(R>>3)*500;break;case 2:R=(R>>3)/20;break;case 3:R=(R>>3)/200;break;case 4:R=(R>>3)/2e3;break;case 5:R=(R>>3)/2e4;break;case 6:R=(R>>3)/16;break;case 7:R=(R>>3)/64;break}return D[1].v=R,D}function P(S,L){var D=N(S),R=S.read_shift(4),X=S.read_shift(4),de=S.read_shift(2);if(de==65535)return R===0&&X===3221225472?(D[1].t="e",D[1].v=15):R===0&&X===3489660928?(D[1].t="e",D[1].v=42):D[1].v=0,D;var me=de&32768;return de=(de&32767)-16446,D[1].v=(1-me*2)*(X*Math.pow(2,de+32)+R*Math.pow(2,de)),D}function H(S,L,D,R){var X=De(14);if(X.write_shift(2,S),X.write_shift(1,D),X.write_shift(1,L),R==0)return X.write_shift(4,0),X.write_shift(4,0),X.write_shift(2,65535),X;var de=0,me=0,Y=0,oe=0;return R<0&&(de=1,R=-R),me=Math.log2(R)|0,R/=Math.pow(2,me-31),oe=R>>>0,oe&2147483648||(R/=2,++me,oe=R>>>0),R-=oe,oe|=2147483648,oe>>>=0,R*=Math.pow(2,32),Y=R>>>0,X.write_shift(4,Y),X.write_shift(4,oe),me+=16383+(de?32768:0),X.write_shift(2,me),X}function T(S,L){var D=P(S);return S.l+=L-14,D}function j(S,L){var D=N(S),R=S.read_shift(4);return D[1].v=R>>6,D}function z(S,L){var D=N(S),R=S.read_shift(8,"f");return D[1].v=R,D}function K(S,L){var D=z(S);return S.l+=L-10,D}function he(S,L){return S[S.l+L-1]==0?S.read_shift(L,"cstr"):""}function be(S,L){var D=S[S.l++];D>L-1&&(D=L-1);for(var R="";R.length<D;)R+=String.fromCharCode(S[S.l++]);return R}function we(S,L,D){if(!(!D.qpro||L<21)){var R=S.read_shift(1);S.l+=17,S.l+=1,S.l+=2;var X=S.read_shift(L-21,"cstr");return[R,X]}}function Q(S,L){for(var D={},R=S.l+L;S.l<R;){var X=S.read_shift(2);if(X==14e3){for(D[X]=[0,""],D[X][0]=S.read_shift(2);S[S.l];)D[X][1]+=String.fromCharCode(S[S.l]),S.l++;S.l++}}return D}function le(S,L){var D=De(5+S.length);D.write_shift(2,14e3),D.write_shift(2,L);for(var R=0;R<S.length;++R){var X=S.charCodeAt(R);D[D.l++]=X>127?95:X}return D[D.l++]=0,D}var ke={0:{n:"BOF",f:l3},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:x},15:{n:"LABEL",f},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:he},222:{n:"SHEETNAMELP",f:be},65535:{n:""}},ve={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:F},23:{n:"NUMBER17",f:P},24:{n:"NUMBER18",f:I},25:{n:"FORMULA19",f:T},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Q},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:j},38:{n:"??"},39:{n:"NUMBER27",f:z},40:{n:"FORMULA28",f:K},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:he},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:we},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}(),iC=/^\s|\s$|[\t\n\r]/;function p3(e,t){if(!t.bookSST)return"";var r=[fn];r[r.length]=Je("sst",null,{xmlns:au[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var a=e[n],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(iC)&&(i+=' xml:space="preserve"'),i+=">"+dr(a.t)+"</t>"),i+="</si>",r[r.length]=i}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function sC(e){return[e.read_shift(4),e.read_shift(4)]}function oC(e,t){return t||(t=De(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var lC=JP;function cC(e){var t=Aa();qe(t,159,oC(e));for(var r=0;r<e.length;++r)qe(t,19,lC(e[r]));return qe(t,160),t.end()}function uC(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function m3(e){var t=0,r,n=uC(e),a=n.length+1,i,s,o,c,u;for(r=Ol(a),r[0]=n.length,i=1;i!=a;++i)r[i]=n[i-1];for(i=a-1;i>=0;--i)s=r[i],o=t&16384?1:0,c=t<<1&32767,u=o|c,t=u^s;return t^52811}var fC=function(){function e(a,i){switch(i.type){case"base64":return t(Ms(a),i);case"binary":return t(a,i);case"buffer":return t(ar&&Buffer.isBuffer(a)?a.toString("binary"):Qf(a),i);case"array":return t(qh(a),i)}throw new Error("Unrecognized type "+i.type)}function t(a,i){var s=i||{},o=s.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(f,d){Array.isArray(o)&&(o[d]=[]);for(var p=/\\\w+\b/g,h=0,x,g=-1;x=p.exec(f);){switch(x[0]){case"\\cell":var y=f.slice(h,p.lastIndex-x[0].length);if(y[0]==" "&&(y=y.slice(1)),++g,y.length){var b={v:y,t:"s"};Array.isArray(o)?o[d][g]=b:o[hr({r:d,c:g})]=b}break}h=p.lastIndex}g>u.e.c&&(u.e.c=g)}),o["!ref"]=cn(u),o}function r(a,i){return zl(e(a,i),i)}function n(a){for(var i=["{\\rtf1\\ansi"],s=kr(a["!ref"]),o,c=Array.isArray(a),u=s.s.r;u<=s.e.r;++u){i.push("\\trowd\\trautofit1");for(var f=s.s.c;f<=s.e.c;++f)i.push("\\cellx"+(f+1));for(i.push("\\pard\\intbl"),f=s.s.c;f<=s.e.c;++f){var d=hr({r:u,c:f});o=c?(a[u]||[])[f]:a[d],!(!o||o.v==null&&(!o.f||o.F))&&(i.push(" "+(o.w||(Rs(o),o.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function eb(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var dC=6,Fs=dC;function Hd(e){return Math.floor((e+Math.round(128/Fs)/256)*Fs)}function Gd(e){return Math.floor((e-5)/Fs*100+.5)/100}function G1(e){return Math.round((e*Fs+5)/Fs*256)/256}function px(e){e.width?(e.wpx=Hd(e.width),e.wch=Gd(e.wpx),e.MDW=Fs):e.wpx?(e.wch=Gd(e.wpx),e.width=G1(e.wch),e.MDW=Fs):typeof e.wch=="number"&&(e.width=G1(e.wch),e.wpx=Hd(e.width),e.MDW=Fs),e.customWidth&&delete e.customWidth}var hC=96,g3=hC;function Vd(e){return e*96/g3}function x3(e){return e*g3/96}function pC(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Je("numFmt",null,{numFmtId:n,formatCode:dr(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Je("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function mC(e){var t=[];return t[t.length]=Je("cellXfs",null),e.forEach(function(r){t[t.length]=Je("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Je("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function v3(e,t){var r=[fn,Je("styleSheet",null,{xmlns:au[0],"xmlns:vt":En.vt})],n;return e.SSF&&(n=pC(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=mC(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function gC(e,t){var r=e.read_shift(2),n=na(e);return[r,n]}function xC(e,t,r){r||(r=De(6+4*t.length)),r.write_shift(2,e),Tn(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function vC(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=ik(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var i=e.read_shift(2);switch(i===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var o=e.read_shift(1);o>0&&(n.family=o);var c=e.read_shift(1);switch(c>0&&(n.charset=c),e.l++,n.color=ak(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=na(e),n}function yC(e,t){t||(t=De(25+4*32)),t.write_shift(2,e.sz*20),sk(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),qd(e.color,t);var n=0;return e.scheme=="major"&&(n=1),e.scheme=="minor"&&(n=2),t.write_shift(1,n),Tn(e.name,t),t.length>t.l?t.slice(0,t.l):t}var bC=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Lm,wC=us;function tb(e,t){t||(t=De(4*3+8*7+16*1)),Lm||(Lm=rx(bC));var r=Lm[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(qd({auto:1},t),qd({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function _C(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}function y3(e,t,r){r||(r=De(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Yu(e,t){return t||(t=De(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var NC=us;function SC(e,t){return t||(t=De(51)),t.write_shift(1,0),Yu(null,t),Yu(null,t),Yu(null,t),Yu(null,t),Yu(null,t),t.length>t.l?t.slice(0,t.l):t}function AC(e,t){return t||(t=De(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),zd(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function EC(e,t,r){var n=De(2052);return n.write_shift(4,e),zd(t,n),zd(r,n),n.length>n.l?n.slice(0,n.l):n}function jC(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&++r}),r!=0&&(qe(e,615,Di(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&qe(e,44,xC(a,t[a]))}),qe(e,616))}}function TC(e){var t=1;qe(e,611,Di(t)),qe(e,43,yC({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),qe(e,612)}function PC(e){var t=2;qe(e,603,Di(t)),qe(e,45,tb({patternType:"none"})),qe(e,45,tb({patternType:"gray125"})),qe(e,604)}function kC(e){var t=1;qe(e,613,Di(t)),qe(e,46,SC()),qe(e,614)}function CC(e){var t=1;qe(e,626,Di(t)),qe(e,47,y3({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),qe(e,627)}function OC(e,t){qe(e,617,Di(t.length)),t.forEach(function(r){qe(e,47,y3(r,0))}),qe(e,618)}function LC(e){var t=1;qe(e,619,Di(t)),qe(e,48,AC({xfId:0,builtinId:0,name:"Normal"})),qe(e,620)}function FC(e){var t=0;qe(e,505,Di(t)),qe(e,506)}function DC(e){var t=0;qe(e,508,EC(t,"TableStyleMedium9","PivotStyleMedium4")),qe(e,509)}function IC(e,t){var r=Aa();return qe(r,278),jC(r,e.SSF),TC(r),PC(r),kC(r),CC(r),OC(r,t.cellXfs),LC(r),FC(r),DC(r),qe(r,279),r.end()}function b3(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[fn];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="Ôº≠Ôº≥ Ôº∞„Ç¥„Ç∑„ÉÉ„ÇØ"/>',r[r.length]='<a:font script="Hang" typeface="ÎßëÏùÄ Í≥†Îîï"/>',r[r.length]='<a:font script="Hans" typeface="ÂÆã‰Ωì"/>',r[r.length]='<a:font script="Hant" typeface="Êñ∞Á¥∞ÊòéÈ´î"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="Ôº≠Ôº≥ Ôº∞„Ç¥„Ç∑„ÉÉ„ÇØ"/>',r[r.length]='<a:font script="Hang" typeface="ÎßëÏùÄ Í≥†Îîï"/>',r[r.length]='<a:font script="Hans" typeface="ÂÆã‰Ωì"/>',r[r.length]='<a:font script="Hant" typeface="Êñ∞Á¥∞ÊòéÈ´î"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function MC(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:na(e)}}function RC(e){var t=De(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Tn(e.name,t),t.slice(0,t.l)}function BC(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function UC(e){var t=De(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function $C(e,t){var r=De(8+2*t.length);return r.write_shift(4,e),Tn(t,r),r.slice(0,r.l)}function zC(e){return e.l+=4,e.read_shift(4)!=0}function qC(e,t){var r=De(8);return r.write_shift(4,e),r.write_shift(4,1),r}function WC(){var e=Aa();return qe(e,332),qe(e,334,Di(1)),qe(e,335,RC({name:"XLDAPR",version:12e4,flags:3496657072})),qe(e,336),qe(e,339,$C(1,"XLDAPR")),qe(e,52),qe(e,35,Di(514)),qe(e,4096,Di(0)),qe(e,4097,ci(1)),qe(e,36),qe(e,53),qe(e,340),qe(e,337,qC(1)),qe(e,51,UC([[1,0]])),qe(e,338),qe(e,333),e.end()}function w3(){var e=[fn];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function HC(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=hr(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var jc=1024;function _3(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),a=[Je("xml",null,{"xmlns:v":za.v,"xmlns:o":za.o,"xmlns:x":za.x,"xmlns:mv":za.mv}).replace(/\/>/,">"),Je("o:shapelayout",Je("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Je("v:shapetype",[Je("v:stroke",null,{joinstyle:"miter"}),Je("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];jc<e*1e3;)jc+=1e3;return t.forEach(function(i){var s=jn(i[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var c=o.type=="gradient"?Je("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Je("v:fill",c,o),f={on:"t",obscured:"t"};++jc,a=a.concat(["<v:shape"+Cf({id:"_x0000_s"+jc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Je("v:shadow",null,f),Je("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",qn("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),qn("x:AutoFill","False"),qn("x:Row",String(s.r)),qn("x:Column",String(s.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function N3(e){var t=[fn,Je("comments",null,{xmlns:au[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(a){var i=dr(a.a);r.indexOf(i)==-1&&(r.push(i),t.push("<author>"+i+"</author>")),a.T&&a.ID&&r.indexOf("tc="+a.ID)==-1&&(r.push("tc="+a.ID),t.push("<author>tc="+a.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var a=0,i=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?a=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(c){c.a&&(a=r.indexOf(dr(c.a))),i.push(c.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+a+'"><text>'),i.length<=1)t.push(qn("t",dr(i[0]||"")));else{for(var s=`Comment:
    `+i[0]+`
`,o=1;o<i.length;++o)s+=`Reply:
    `+i[o]+`
`;t.push(qn("t",dr(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function GC(e,t,r){var n=[fn,Je("ThreadedComments",null,{xmlns:En.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(a){var i="";(a[1]||[]).forEach(function(s,o){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?i=c.id:c.parentId=i,s.ID=c.id,s.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(Je("threadedComment",qn("text",s.t||""),c))})}),n.push("</ThreadedComments>"),n.join("")}function VC(e){var t=[fn,Je("personList",null,{xmlns:En.TCMNT,"xmlns:x":au[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Je("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function KC(e){var t={};t.iauthor=e.read_shift(4);var r=Gl(e);return t.rfx=r.s,t.ref=hr(r.s),e.l+=16,t}function YC(e,t){return t==null&&(t=De(36)),t.write_shift(4,e[1].iauthor),su(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var XC=na;function ZC(e){return Tn(e.slice(0,54))}function JC(e){var t=Aa(),r=[];return qe(t,628),qe(t,630),e.forEach(function(n){n[1].forEach(function(a){r.indexOf(a.a)>-1||(r.push(a.a.slice(0,54)),qe(t,632,ZC(a.a)))})}),qe(t,631),qe(t,633),e.forEach(function(n){n[1].forEach(function(a){a.iauthor=r.indexOf(a.a);var i={s:jn(n[0]),e:jn(n[0])};qe(t,635,YC([i,a])),a.t&&a.t.length>0&&qe(t,637,ek(a)),qe(t,636),delete a.iauthor})}),qe(t,634),qe(t,629),t.end()}function QC(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var a=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&gr.utils.cfb_add(e,a,t.FileIndex[n].content)}})}var S3=["xlsb","xlsm","xlam","biff8","xla"],eO=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,i,s){var o=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var u=i.length>0?parseInt(i,10)|0:0,f=s.length>0?parseInt(s,10)|0:0;return o?f+=t.c:--f,c?u+=t.r:--u,a+(o?"":"$")+ra(f)+(c?"":"$")+Hn(u)}return function(a,i){return t=i,a.replace(e,r)}}(),mx=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,gx=function(){return function(t,r){return t.replace(mx,function(n,a,i,s,o,c){var u=cx(s)-(i?0:r.c),f=lx(c)-(o?0:r.r),d=f==0?"":o?f+1:"["+f+"]",p=u==0?"":i?u+1:"["+u+"]";return a+"R"+d+"C"+p})}}();function tO(e,t){return e.replace(mx,function(r,n,a,i,s,o){return n+(a=="$"?a+i:ra(cx(i)+t.c))+(s=="$"?s+o:Hn(lx(o)+t.r))})}function rO(e){return e.length!=1}function on(e){e.l+=1}function Bo(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function A3(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return E3(e);r.biff==12&&(n=4)}var a=e.read_shift(n),i=e.read_shift(n),s=Bo(e),o=Bo(e);return{s:{r:a,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:o[0],cRel:o[1],rRel:o[2]}}}function E3(e){var t=Bo(e),r=Bo(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function nO(e,t,r){if(r.biff<8)return E3(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),i=Bo(e),s=Bo(e);return{s:{r:n,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:s[0],cRel:s[1],rRel:s[2]}}}function j3(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return aO(e);var n=e.read_shift(r&&r.biff==12?4:2),a=Bo(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function aO(e){var t=Bo(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function iO(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function sO(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return oO(e);var a=e.read_shift(n>=12?4:2),i=e.read_shift(2),s=(i&16384)>>14,o=(i&32768)>>15;if(i&=16383,o==1)for(;a>524287;)a-=1048576;if(s==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:s,rRel:o}}function oO(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function lO(e,t,r){var n=(e[e.l++]&96)>>5,a=A3(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function cO(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}var s=A3(e,i,r);return[n,a,s]}function uO(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function fO(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=8;if(r)switch(r.biff){case 5:e.l+=12,i=6;break;case 12:i=12;break}return e.l+=i,[n,a]}function dO(e,t,r){var n=(e[e.l++]&96)>>5,a=nO(e,t-1,r);return[n,a]}function hO(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function rb(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function pO(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],i=0;i<=n;++i)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function mO(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function gO(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function xO(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function vO(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function T3(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function yO(e){return e.read_shift(2),T3(e)}function bO(e){return e.read_shift(2),T3(e)}function wO(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=j3(e,0,r);return[n,a]}function _O(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=sO(e,0,r);return[n,a]}function NO(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var i=j3(e,0,r);return[n,a,i]}function SO(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[S7[a],C3[a],n]}function AO(e,t,r){var n=e[e.l++],a=e.read_shift(1),i=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:EO(e);return[a,(i[0]===0?C3:N7)[i[1]]]}function EO(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function jO(e,t,r){e.l+=r&&r.biff==2?3:4}function TO(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function PO(e){return e.l++,r0[e.read_shift(1)]}function kO(e){return e.l++,e.read_shift(2)}function CO(e){return e.l++,e.read_shift(1)!==0}function OO(e){return e.l++,ou(e)}function LO(e,t,r){return e.l++,u3(e,t-1,r)}function FO(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Nk(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=r0[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=ou(e);break;case 2:r[1]=jk(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function DO(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],i=0;i!=n;++i)a.push((r.biff==12?Gl:kk)(e));return a}function IO(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var i=0,s=[];i!=n&&(s[i]=[]);++i)for(var o=0;o!=a;++o)s[i][o]=FO(e,r.biff);return s}function MO(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,i=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,i]}function RO(e,t,r){if(r.biff==5)return BO(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),i=e.read_shift(4);return[n,a,i]}function BO(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function UO(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function $O(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function zO(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function qO(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),i=4;if(r)switch(r.biff){case 5:i=15;break;case 12:i=6;break}return e.l+=i,[n,a]}var WO=us,HO=us,GO=us;function n0(e,t,r){return e.l+=2,[iO(e)]}function xx(e){return e.l+=6,[]}var VO=n0,KO=xx,YO=xx,XO=n0;function P3(e){return e.l+=2,[l3(e),e.read_shift(2)&1]}var ZO=n0,JO=P3,QO=xx,e7=n0,t7=n0,r7=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function n7(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),i=e.read_shift(2),s=r7[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:a,C:i}}function a7(e){return e.l+=2,[e.read_shift(4)]}function i7(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function s7(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function o7(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function l7(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function c7(e){return e.l+=4,[0,0]}var nb={1:{n:"PtgExp",f:TO},2:{n:"PtgTbl",f:GO},3:{n:"PtgAdd",f:on},4:{n:"PtgSub",f:on},5:{n:"PtgMul",f:on},6:{n:"PtgDiv",f:on},7:{n:"PtgPower",f:on},8:{n:"PtgConcat",f:on},9:{n:"PtgLt",f:on},10:{n:"PtgLe",f:on},11:{n:"PtgEq",f:on},12:{n:"PtgGe",f:on},13:{n:"PtgGt",f:on},14:{n:"PtgNe",f:on},15:{n:"PtgIsect",f:on},16:{n:"PtgUnion",f:on},17:{n:"PtgRange",f:on},18:{n:"PtgUplus",f:on},19:{n:"PtgUminus",f:on},20:{n:"PtgPercent",f:on},21:{n:"PtgParen",f:on},22:{n:"PtgMissArg",f:on},23:{n:"PtgStr",f:LO},26:{n:"PtgSheet",f:i7},27:{n:"PtgEndSheet",f:s7},28:{n:"PtgErr",f:PO},29:{n:"PtgBool",f:CO},30:{n:"PtgInt",f:kO},31:{n:"PtgNum",f:OO},32:{n:"PtgArray",f:hO},33:{n:"PtgFunc",f:SO},34:{n:"PtgFuncVar",f:AO},35:{n:"PtgName",f:MO},36:{n:"PtgRef",f:wO},37:{n:"PtgArea",f:lO},38:{n:"PtgMemArea",f:UO},39:{n:"PtgMemErr",f:WO},40:{n:"PtgMemNoMem",f:HO},41:{n:"PtgMemFunc",f:$O},42:{n:"PtgRefErr",f:zO},43:{n:"PtgAreaErr",f:uO},44:{n:"PtgRefN",f:_O},45:{n:"PtgAreaN",f:dO},46:{n:"PtgMemAreaN",f:o7},47:{n:"PtgMemNoMemN",f:l7},57:{n:"PtgNameX",f:RO},58:{n:"PtgRef3d",f:NO},59:{n:"PtgArea3d",f:cO},60:{n:"PtgRefErr3d",f:qO},61:{n:"PtgAreaErr3d",f:fO},255:{}},u7={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},f7={1:{n:"PtgElfLel",f:P3},2:{n:"PtgElfRw",f:e7},3:{n:"PtgElfCol",f:VO},6:{n:"PtgElfRwV",f:t7},7:{n:"PtgElfColV",f:XO},10:{n:"PtgElfRadical",f:ZO},11:{n:"PtgElfRadicalS",f:QO},13:{n:"PtgElfColS",f:KO},15:{n:"PtgElfColSV",f:YO},16:{n:"PtgElfRadicalLel",f:JO},25:{n:"PtgList",f:n7},29:{n:"PtgSxName",f:a7},255:{}},d7={0:{n:"PtgAttrNoop",f:c7},1:{n:"PtgAttrSemi",f:vO},2:{n:"PtgAttrIf",f:gO},4:{n:"PtgAttrChoose",f:pO},8:{n:"PtgAttrGoto",f:mO},16:{n:"PtgAttrSum",f:jO},32:{n:"PtgAttrBaxcel",f:rb},33:{n:"PtgAttrBaxcel",f:rb},64:{n:"PtgAttrSpace",f:yO},65:{n:"PtgAttrSpaceSemi",f:bO},128:{n:"PtgAttrIfError",f:xO},255:{}};function h7(e,t,r,n){if(n.biff<8)return us(e,t);for(var a=e.l+t,i=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=IO(e,0,n),i.push(r[s][1]);break;case"PtgMemArea":r[s][2]=DO(e,r[s][1],n),i.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),i.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=a-e.l,t!==0&&i.push(us(e,t)),i}function p7(e,t,r){for(var n=e.l+t,a,i,s=[];n!=e.l;)t=n-e.l,i=e[e.l],a=nb[i]||nb[u7[i]],(i===24||i===25)&&(a=(i===24?f7:d7)[e[e.l+1]]),!a||!a.f?us(e,t):s.push([a.n,a.f(e,t,r)]);return s}function m7(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],i=0;i<n.length;++i){var s=n[i];if(s)switch(s[0]){case 2:a.push('"'+s[1].replace(/"/g,'""')+'"');break;default:a.push(s[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var g7={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function x7(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function k3(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function ab(e,t,r){var n=k3(e,t,r);return n=="#REF"?n:x7(n,r)}function Hc(e,t,r,n,a){var i=a&&a.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},o=[],c,u,f,d=0,p=0,h,x="";if(!e[0]||!e[0][0])return"";for(var g=-1,y="",b=0,E=e[0].length;b<E;++b){var A=e[0][b];switch(A[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=o.pop(),u=o.pop(),g>=0){switch(e[0][g][1][0]){case 0:y=$r(" ",e[0][g][1][1]);break;case 1:y=$r("\r",e[0][g][1][1]);break;default:if(y="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}u=u+y,g=-1}o.push(u+g7[A[0]]+c);break;case"PtgIsect":c=o.pop(),u=o.pop(),o.push(u+" "+c);break;case"PtgUnion":c=o.pop(),u=o.pop(),o.push(u+","+c);break;case"PtgRange":c=o.pop(),u=o.pop(),o.push(u+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=vf(A[1][1],s,a),o.push(yf(f,i));break;case"PtgRefN":f=r?vf(A[1][1],r,a):A[1][1],o.push(yf(f,i));break;case"PtgRef3d":d=A[1][1],f=vf(A[1][2],s,a),x=ab(n,d,a),o.push(x+"!"+yf(f,i));break;case"PtgFunc":case"PtgFuncVar":var C=A[1][0],N=A[1][1];C||(C=0),C&=127;var F=C==0?[]:o.slice(-C);o.length-=C,N==="User"&&(N=F.shift()),o.push(N+"("+F.join(",")+")");break;case"PtgBool":o.push(A[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(A[1]);break;case"PtgNum":o.push(String(A[1]));break;case"PtgStr":o.push('"'+A[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(A[1]);break;case"PtgAreaN":h=zy(A[1][1],r?{s:r}:s,a),o.push(Cm(h,a));break;case"PtgArea":h=zy(A[1][1],s,a),o.push(Cm(h,a));break;case"PtgArea3d":d=A[1][1],h=A[1][2],x=ab(n,d,a),o.push(x+"!"+Cm(h,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=A[1][2];var O=(n.names||[])[p-1]||(n[0]||[])[p],I=O?O.Name:"SH33TJSNAME"+String(p);I&&I.slice(0,6)=="_xlfn."&&!a.xlfn&&(I=I.slice(6)),o.push(I);break;case"PtgNameX":var P=A[1][1];p=A[1][2];var H;if(a.biff<=5)P<0&&(P=-P),n[P]&&(H=n[P][p]);else{var T="";if(((n[P]||[])[0]||[])[0]==14849||(((n[P]||[])[0]||[])[0]==1025?n[P][p]&&n[P][p].itab>0&&(T=n.SheetNames[n[P][p].itab-1]+"!"):T=n.SheetNames[p-1]+"!"),n[P]&&n[P][p])T+=n[P][p].Name;else if(n[0]&&n[0][p])T+=n[0][p].Name;else{var j=(k3(n,P,a)||"").split(";;");j[p-1]?T=j[p-1]:T+="SH33TJSERRX"}o.push(T);break}H||(H={Name:"SH33TJSERRY"}),o.push(H.Name);break;case"PtgParen":var z="(",K=")";if(g>=0){switch(y="",e[0][g][1][0]){case 2:z=$r(" ",e[0][g][1][1])+z;break;case 3:z=$r("\r",e[0][g][1][1])+z;break;case 4:K=$r(" ",e[0][g][1][1])+K;break;case 5:K=$r("\r",e[0][g][1][1])+K;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}o.push(z+o.pop()+K);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:A[1][1],r:A[1][0]};var he={c:r.c,r:r.r};if(n.sharedf[hr(f)]){var be=n.sharedf[hr(f)];o.push(Hc(be,s,he,n,a))}else{var we=!1;for(c=0;c!=n.arrayf.length;++c)if(u=n.arrayf[c],!(f.c<u[0].s.c||f.c>u[0].e.c)&&!(f.r<u[0].s.r||f.r>u[0].e.r)){o.push(Hc(u[1],s,he,n,a)),we=!0;break}we||o.push(A[1])}break;case"PtgArray":o.push("{"+m7(A[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+A[1].idx+"[#"+A[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(A));default:throw new Error("Unrecognized Formula Token: "+String(A))}var Q=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&g>=0&&Q.indexOf(e[0][b][0])==-1){A=e[0][g];var le=!0;switch(A[1][0]){case 4:le=!1;case 0:y=$r(" ",A[1][1]);break;case 5:le=!1;case 1:y=$r("\r",A[1][1]);break;default:if(y="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+A[1][0])}o.push((le?y:"")+o.pop()+(le?"":y)),g=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function v7(e){if(e==null){var t=De(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Ll(e);return Ll(0)}function y7(e,t,r,n,a){var i=Fl(t,r,a),s=v7(e.v),o=De(6),c=33;o.write_shift(2,c),o.write_shift(4,0);for(var u=De(e.bf.length),f=0;f<e.bf.length;++f)u[f]=e.bf[f];var d=zn([i,s,o,u]);return d}function Wh(e,t,r){var n=e.read_shift(4),a=p7(e,n,r),i=e.read_shift(4),s=i>0?h7(e,i,a,r):null;return[a,s]}var b7=Wh,Hh=Wh,w7=Wh,_7=Wh,N7={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},C3={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},S7={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function A7(e){var t="of:="+e.replace(mx,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function E7(e){return e.replace(/\./,"!")}var bf=typeof Map<"u";function vx(e,t,r){var n=0,a=e.length;if(r){if(bf?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var i=bf?r.get(t):r[t];n<i.length;++n)if(e[i[n]].t===t)return e.Count++,i[n]}}else for(;n<a;++n)if(e[n].t===t)return e.Count++,n;return e[a]={t},e.Count++,e.Unique++,r&&(bf?(r.has(t)||r.set(t,[]),r.get(t).push(a)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(a))),a}function Gh(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Fs=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=Gd(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=G1(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function O3(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function qo(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],a=60,i=e.length;if(n==null&&r.ssf){for(;a<392;++a)if(r.ssf[a]==null){j4(t.z,a),r.ssf[a]=t.z,r.revssf[t.z]=n=a;break}}for(a=0;a!=i;++a)if(e[a].numFmtId===n)return a;return e[i]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function j7(e,t,r){if(e&&e["!ref"]){var n=kr(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function T7(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+cn(e[r])+'"/>';return t+"</mergeCells>"}function P7(e,t,r,n,a){var i=!1,s={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var c=t.SheetNames[r];try{t.Workbook&&(c=t.Workbook.Sheets[r].CodeName||c)}catch{}i=!0,s.codeName=kf(dr(c))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+Je("outlinePr",null,u)}!i&&!o||(a[a.length]=Je("sheetPr",o,s))}var k7=["objects","scenarios","selectLockedCells","selectUnlockedCells"],C7=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function O7(e){var t={sheet:1};return k7.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),C7.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=m3(e.password).toString(16).toUpperCase()),Je("sheetProtection",null,t)}function L7(e){return O3(e),Je("pageMargins",null,e)}function F7(e,t){for(var r=["<cols>"],n,a=0;a!=t.length;++a)(n=t[a])&&(r[r.length]=Je("col",null,Gh(a,n)));return r[r.length]="</cols>",r.join("")}function D7(e,t,r,n){var a=typeof e.ref=="string"?e.ref:cn(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var i=r.Workbook.Names,s=Ya(a);s.s.r==s.e.r&&(s.e.r=Ya(t["!ref"]).e.r,a=cn(s));for(var o=0;o<i.length;++o){var c=i[o];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+a;break}}return o==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),Je("autoFilter",null,{ref:a})}function I7(e,t,r,n){var a={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Je("sheetViews",Je("sheetView",null,a),{})}function M7(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var a="",i=e.t,s=e.v;if(e.t!=="z")switch(e.t){case"b":a=e.v?"1":"0";break;case"n":a=""+e.v;break;case"e":a=r0[e.v];break;case"d":n&&n.cellDates?a=ga(e.v,-1).toISOString():(e=ja(e),e.t="n",a=""+(e.v=Ea(ga(e.v)))),typeof e.z>"u"&&(e.z=Wr[14]);break;default:a=e.v;break}var o=qn("v",dr(a)),c={r:t},u=qo(n.cellXfs,e,n);switch(u!==0&&(c.s=u),e.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=qn("v",""+vx(n.Strings,e.v,n.revStrings)),c.t="s";break}c.t="str";break}if(e.t!=i&&(e.t=i,e.v=s),typeof e.f=="string"&&e.f){var f=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Je("f",dr(e.f),f)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(c.cm=1),Je("c",o,c)}function R7(e,t,r,n){var a=[],i=[],s=kr(e["!ref"]),o="",c,u="",f=[],d=0,p=0,h=e["!rows"],x=Array.isArray(e),g={r:u},y,b=-1;for(p=s.s.c;p<=s.e.c;++p)f[p]=ra(p);for(d=s.s.r;d<=s.e.r;++d){for(i=[],u=Hn(d),p=s.s.c;p<=s.e.c;++p){c=f[p]+u;var E=x?(e[d]||[])[p]:e[c];E!==void 0&&(o=M7(E,c,e,t))!=null&&i.push(o)}(i.length>0||h&&h[d])&&(g={r:u},h&&h[d]&&(y=h[d],y.hidden&&(g.hidden=1),b=-1,y.hpx?b=Vd(y.hpx):y.hpt&&(b=y.hpt),b>-1&&(g.ht=b,g.customHeight=1),y.level&&(g.outlineLevel=y.level)),a[a.length]=Je("row",i.join(""),g))}if(h)for(;d<h.length;++d)h&&h[d]&&(g={r:d+1},y=h[d],y.hidden&&(g.hidden=1),b=-1,y.hpx?b=Vd(y.hpx):y.hpt&&(b=y.hpt),b>-1&&(g.ht=b,g.customHeight=1),y.level&&(g.outlineLevel=y.level),a[a.length]=Je("row","",g));return a.join("")}function L3(e,t,r,n){var a=[fn,Je("worksheet",null,{xmlns:au[0],"xmlns:r":En.r})],i=r.SheetNames[e],s=0,o="",c=r.Sheets[i];c==null&&(c={});var u=c["!ref"]||"A1",f=kr(u);if(f.e.c>16383||f.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");f.e.c=Math.min(f.e.c,16383),f.e.r=Math.min(f.e.c,1048575),u=cn(f)}n||(n={}),c["!comments"]=[];var d=[];P7(c,r,e,t,a),a[a.length]=Je("dimension",null,{ref:u}),a[a.length]=I7(c,t,e,r),t.sheetFormat&&(a[a.length]=Je("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=F7(c,c["!cols"])),a[s=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(o=R7(c,t),o.length>0&&(a[a.length]=o)),a.length>s+1&&(a[a.length]="</sheetData>",a[s]=a[s].replace("/>",">")),c["!protect"]&&(a[a.length]=O7(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=D7(c["!autofilter"],c,r,e)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=T7(c["!merges"]));var p=-1,h,x=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(g){g[1].Target&&(h={ref:g[0]},g[1].Target.charAt(0)!="#"&&(x=cr(n,-1,dr(g[1].Target).replace(/#.*$/,""),Zt.HLINK),h["r:id"]="rId"+x),(p=g[1].Target.indexOf("#"))>-1&&(h.location=dr(g[1].Target.slice(p+1))),g[1].Tooltip&&(h.tooltip=dr(g[1].Tooltip)),a[a.length]=Je("hyperlink",null,h))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=L7(c["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(a[a.length]=qn("ignoredErrors",Je("ignoredError",null,{numberStoredAsText:1,sqref:u}))),d.length>0&&(x=cr(n,-1,"../drawings/drawing"+(e+1)+".xml",Zt.DRAW),a[a.length]=Je("drawing",null,{"r:id":"rId"+x}),c["!drawing"]=d),c["!comments"].length>0&&(x=cr(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Zt.VML),a[a.length]=Je("legacyDrawing",null,{"r:id":"rId"+x}),c["!legacy"]=x),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function B7(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var i=e.read_shift(1);return e.l=n,i&7&&(r.level=i&7),i&16&&(r.hidden=!0),i&32&&(r.hpt=a/20),r}function U7(e,t,r){var n=De(145),a=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var i=320;a.hpx?i=Vd(a.hpx)*20:a.hpt&&(i=a.hpt*20),n.write_shift(2,i),n.write_shift(1,0);var s=0;a.level&&(s|=a.level),a.hidden&&(s|=16),(a.hpx||a.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var o=0,c=n.l;n.l+=4;for(var u={r:e,c:0},f=0;f<16;++f)if(!(t.s.c>f+1<<10||t.e.c<f<<10)){for(var d=-1,p=-1,h=f<<10;h<f+1<<10;++h){u.c=h;var x=Array.isArray(r)?(r[u.r]||[])[u.c]:r[hr(u)];x&&(d<0&&(d=h),p=h)}d<0||(++o,n.write_shift(4,d),n.write_shift(4,p))}var g=n.l;return n.l=c,n.write_shift(4,o),n.l=g,n.length>n.l?n.slice(0,n.l):n}function $7(e,t,r,n){var a=U7(n,r,t);(a.length>17||(t["!rows"]||[])[n])&&qe(e,0,a)}var z7=Gl,q7=su;function W7(){}function H7(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=tk(e),r}function G7(e,t,r){r==null&&(r=De(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var a=1;a<3;++a)r.write_shift(1,0);return qd({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),K4(e,r),r.slice(0,r.l)}function V7(e){var t=gi(e);return[t]}function K7(e,t,r){return r==null&&(r=De(8)),ql(t,r)}function Y7(e){var t=Wl(e);return[t]}function X7(e,t,r){return r==null&&(r=De(4)),Hl(t,r)}function Z7(e){var t=gi(e),r=e.read_shift(1);return[t,r,"b"]}function J7(e,t,r){return r==null&&(r=De(9)),ql(t,r),r.write_shift(1,e.v?1:0),r}function Q7(e){var t=Wl(e),r=e.read_shift(1);return[t,r,"b"]}function eL(e,t,r){return r==null&&(r=De(5)),Hl(t,r),r.write_shift(1,e.v?1:0),r}function tL(e){var t=gi(e),r=e.read_shift(1);return[t,r,"e"]}function rL(e,t,r){return r==null&&(r=De(9)),ql(t,r),r.write_shift(1,e.v),r}function nL(e){var t=Wl(e),r=e.read_shift(1);return[t,r,"e"]}function aL(e,t,r){return r==null&&(r=De(8)),Hl(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function iL(e){var t=gi(e),r=e.read_shift(4);return[t,r,"s"]}function sL(e,t,r){return r==null&&(r=De(12)),ql(t,r),r.write_shift(4,t.v),r}function oL(e){var t=Wl(e),r=e.read_shift(4);return[t,r,"s"]}function lL(e,t,r){return r==null&&(r=De(8)),Hl(t,r),r.write_shift(4,t.v),r}function cL(e){var t=gi(e),r=ou(e);return[t,r,"n"]}function uL(e,t,r){return r==null&&(r=De(16)),ql(t,r),Ll(e.v,r),r}function fL(e){var t=Wl(e),r=ou(e);return[t,r,"n"]}function dL(e,t,r){return r==null&&(r=De(12)),Hl(t,r),Ll(e.v,r),r}function hL(e){var t=gi(e),r=Y4(e);return[t,r,"n"]}function pL(e,t,r){return r==null&&(r=De(12)),ql(t,r),X4(e.v,r),r}function mL(e){var t=Wl(e),r=Y4(e);return[t,r,"n"]}function gL(e,t,r){return r==null&&(r=De(8)),Hl(t,r),X4(e.v,r),r}function xL(e){var t=gi(e),r=ux(e);return[t,r,"is"]}function vL(e){var t=gi(e),r=na(e);return[t,r,"str"]}function yL(e,t,r){return r==null&&(r=De(12+4*e.v.length)),ql(t,r),Tn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function bL(e){var t=Wl(e),r=na(e);return[t,r,"str"]}function wL(e,t,r){return r==null&&(r=De(8+4*e.v.length)),Hl(t,r),Tn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function _L(e,t,r){var n=e.l+t,a=gi(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"b"];if(r.cellFormula){e.l+=2;var o=Hh(e,n-e.l,r);s[3]=Hc(o,null,a,r.supbooks,r)}else e.l=n;return s}function NL(e,t,r){var n=e.l+t,a=gi(e);a.r=r["!row"];var i=e.read_shift(1),s=[a,i,"e"];if(r.cellFormula){e.l+=2;var o=Hh(e,n-e.l,r);s[3]=Hc(o,null,a,r.supbooks,r)}else e.l=n;return s}function SL(e,t,r){var n=e.l+t,a=gi(e);a.r=r["!row"];var i=ou(e),s=[a,i,"n"];if(r.cellFormula){e.l+=2;var o=Hh(e,n-e.l,r);s[3]=Hc(o,null,a,r.supbooks,r)}else e.l=n;return s}function AL(e,t,r){var n=e.l+t,a=gi(e);a.r=r["!row"];var i=na(e),s=[a,i,"str"];if(r.cellFormula){e.l+=2;var o=Hh(e,n-e.l,r);s[3]=Hc(o,null,a,r.supbooks,r)}else e.l=n;return s}var EL=Gl,jL=su;function TL(e,t){return t==null&&(t=De(4)),t.write_shift(4,e),t}function PL(e,t){var r=e.l+t,n=Gl(e),a=fx(e),i=na(e),s=na(e),o=na(e);e.l=r;var c={rfx:n,relId:a,loc:i,display:o};return s&&(c.Tooltip=s),c}function kL(e,t){var r=De(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));su({s:jn(e[0]),e:jn(e[0])},r),dx("rId"+t,r);var n=e[1].Target.indexOf("#"),a=n==-1?"":e[1].Target.slice(n+1);return Tn(a||"",r),Tn(e[1].Tooltip||"",r),Tn("",r),r.slice(0,r.l)}function CL(){}function OL(e,t,r){var n=e.l+t,a=Z4(e),i=e.read_shift(1),s=[a];if(s[2]=i,r.cellFormula){var o=b7(e,n-e.l,r);s[1]=o}else e.l=n;return s}function LL(e,t,r){var n=e.l+t,a=Gl(e),i=[a];if(r.cellFormula){var s=_7(e,n-e.l,r);i[1]=s,e.l=n}else e.l=n;return i}function FL(e,t,r){r==null&&(r=De(18));var n=Gh(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var a=0;return t.hidden&&(a|=1),typeof n.width=="number"&&(a|=2),t.level&&(a|=t.level<<8),r.write_shift(2,a),r}var F3=["left","right","top","bottom","header","footer"];function DL(e){var t={};return F3.forEach(function(r){t[r]=ou(e)}),t}function IL(e,t){return t==null&&(t=De(6*8)),O3(e),F3.forEach(function(r){Ll(e[r],t)}),t}function ML(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function RL(e,t,r){r==null&&(r=De(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function BL(e){var t=De(24);return t.write_shift(4,4),t.write_shift(4,1),su(e,t),t}function UL(e,t){return t==null&&(t=De(16*4+2)),t.write_shift(2,e.password?m3(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function $L(){}function zL(){}function qL(e,t,r,n,a,i,s){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=ja(t),t.z=t.z||Wr[14],t.v=Ea(ga(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var c={r,c:n};switch(c.s=qo(a.cellXfs,t,a),t.l&&i["!links"].push([hr(c),t.l]),t.c&&i["!comments"].push([hr(c),t.c]),t.t){case"s":case"str":return a.bookSST?(o=vx(a.Strings,t.v,a.revStrings),c.t="s",c.v=o,s?qe(e,18,lL(t,c)):qe(e,7,sL(t,c))):(c.t="str",s?qe(e,17,wL(t,c)):qe(e,6,yL(t,c))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?s?qe(e,13,gL(t,c)):qe(e,2,pL(t,c)):s?qe(e,16,dL(t,c)):qe(e,5,uL(t,c)),!0;case"b":return c.t="b",s?qe(e,15,eL(t,c)):qe(e,4,J7(t,c)),!0;case"e":return c.t="e",s?qe(e,14,aL(t,c)):qe(e,3,rL(t,c)),!0}return s?qe(e,12,X7(t,c)):qe(e,1,K7(t,c)),!0}function WL(e,t,r,n){var a=kr(t["!ref"]||"A1"),i,s="",o=[];qe(e,145);var c=Array.isArray(t),u=a.e.r;t["!rows"]&&(u=Math.max(a.e.r,t["!rows"].length-1));for(var f=a.s.r;f<=u;++f){s=Hn(f),$7(e,t,a,f);var d=!1;if(f<=a.e.r)for(var p=a.s.c;p<=a.e.c;++p){f===a.s.r&&(o[p]=ra(p)),i=o[p]+s;var h=c?(t[f]||[])[p]:t[i];if(!h){d=!1;continue}d=qL(e,h,f,p,n,t,d)}}qe(e,146)}function HL(e,t){!t||!t["!merges"]||(qe(e,177,TL(t["!merges"].length)),t["!merges"].forEach(function(r){qe(e,176,jL(r))}),qe(e,178))}function GL(e,t){!t||!t["!cols"]||(qe(e,390),t["!cols"].forEach(function(r,n){r&&qe(e,60,FL(n,r))}),qe(e,391))}function VL(e,t){!t||!t["!ref"]||(qe(e,648),qe(e,649,BL(kr(t["!ref"]))),qe(e,650))}function KL(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var a=cr(r,-1,n[1].Target.replace(/#.*$/,""),Zt.HLINK);qe(e,494,kL(n,a))}}),delete t["!links"]}function YL(e,t,r,n){if(t["!comments"].length>0){var a=cr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Zt.VML);qe(e,551,dx("rId"+a)),t["!legacy"]=a}}function XL(e,t,r,n){if(t["!autofilter"]){var a=t["!autofilter"],i=typeof a.ref=="string"?a.ref:cn(a.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=Ya(i);o.s.r==o.e.r&&(o.e.r=Ya(t["!ref"]).e.r,i=cn(o));for(var c=0;c<s.length;++c){var u=s[c];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==n){u.Ref="'"+r.SheetNames[n]+"'!"+i;break}}c==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),qe(e,161,su(kr(i))),qe(e,162)}}function ZL(e,t,r){qe(e,133),qe(e,137,RL(t,r)),qe(e,138),qe(e,134)}function JL(e,t){t["!protect"]&&qe(e,535,UL(t["!protect"]))}function QL(e,t,r,n){var a=Aa(),i=r.SheetNames[e],s=r.Sheets[i]||{},o=i;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var c=kr(s["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],qe(a,129),(r.vbaraw||s["!outline"])&&qe(a,147,G7(o,s["!outline"])),qe(a,148,q7(c)),ZL(a,s,r.Workbook),GL(a,s),WL(a,s,e,t),JL(a,s),XL(a,s,r,e),HL(a,s),KL(a,s,n),s["!margins"]&&qe(a,476,IL(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&VL(a,s),YL(a,s,e,n),qe(a,130),a.end()}function eF(e,t){e.l+=10;var r=na(e);return{name:r}}var tF=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function rF(e){return!e.Workbook||!e.Workbook.WBProps?"false":LP(e.Workbook.WBProps.date1904)?"true":"false"}var nF="][*?/\\".split("");function D3(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return nF.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function aF(e,t,r){e.forEach(function(n,a){D3(n);for(var i=0;i<a;++i)if(n==e[i])throw new Error("Duplicate Sheet Name: "+n);if(r){var s=t&&t[a]&&t[a].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function iF(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];aF(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)j7(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function I3(e){var t=[fn];t[t.length]=Je("workbook",null,{xmlns:au[0],"xmlns:r":En.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(tF.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Je("workbookPr",null,n);var a=e.Workbook&&e.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(t[t.length]="<bookViews>",i=0;i!=e.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==e.SheetNames.length&&(i=0),t[t.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",i=0;i!=e.SheetNames.length;++i){var s={name:dr(e.SheetNames[i].slice(0,31))};if(s.sheetId=""+(i+1),s["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=Je("sheet",null,s)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var c={name:o.Name};o.Comment&&(c.comment=o.Comment),o.Sheet!=null&&(c.localSheetId=""+o.Sheet),o.Hidden&&(c.hidden="1"),o.Ref&&(t[t.length]=Je("definedName",dr(o.Ref),c))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function sF(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=H1(e),r.name=na(e),r}function oF(e,t){return t||(t=De(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),dx(e.strRelID,t),Tn(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function lF(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?na(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function cF(e,t){t||(t=De(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),K4(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function uF(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),i=rk(e),s=w7(e,0,r),o=fx(e);e.l=n;var c={Name:i,Ptg:s};return a<268435455&&(c.Sheet=a),o&&(c.Comment=o),c}function fF(e,t){qe(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,a={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};qe(e,156,oF(a))}qe(e,144)}function dF(e,t){t||(t=De(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Tn("SheetJS",t),Tn(Id.version,t),Tn(Id.version,t),Tn("7262",t),t.length>t.l?t.slice(0,t.l):t}function hF(e,t){t||(t=De(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function pF(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,a=-1,i=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&a==-1?a=n:r[n].Hidden==1&&i==-1&&(i=n);i>a||(qe(e,135),qe(e,158,hF(a)),qe(e,136))}}function mF(e,t){var r=Aa();return qe(r,131),qe(r,128,dF()),qe(r,153,cF(e.Workbook&&e.Workbook.WBProps||null)),pF(r,e),fF(r,e),qe(r,132),r.end()}function gF(e,t,r){return(t.slice(-4)===".bin"?mF:I3)(e)}function xF(e,t,r,n,a){return(t.slice(-4)===".bin"?QL:L3)(e,r,n,a)}function vF(e,t,r){return(t.slice(-4)===".bin"?IC:v3)(e,r)}function yF(e,t,r){return(t.slice(-4)===".bin"?cC:p3)(e,r)}function bF(e,t,r){return(t.slice(-4)===".bin"?JC:N3)(e)}function wF(e){return(e.slice(-4)===".bin"?WC:w3)()}function _F(e,t){var r=[];return e.Props&&r.push(vk(e.Props,t)),e.Custprops&&r.push(yk(e.Props,e.Custprops)),r.join("")}function NF(){return""}function SF(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,a){var i=[];i.push(Je("NumberFormat",null,{"ss:Format":dr(Wr[n.numFmtId])}));var s={"ss:ID":"s"+(21+a)};r.push(Je("Style",i.join(""),s))}),Je("Styles",r.join(""))}function M3(e){return Je("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+gx(e.Ref,{r:0,c:0})})}function AF(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var a=t[n];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||r.push(M3(a)))}return Je("Names",r.join(""))}function EF(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var a=n.Workbook.Names,i=[],s=0;s<a.length;++s){var o=a[s];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||i.push(M3(o)))}return i.join("")}function jF(e,t,r,n){if(!e)return"";var a=[];if(e["!margins"]&&(a.push("<PageSetup>"),e["!margins"].header&&a.push(Je("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&a.push(Je("Footer",null,{"x:Margin":e["!margins"].footer})),a.push(Je("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),a.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)a.push(Je("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<r&&!(n.Workbook.Sheets[i]&&!n.Workbook.Sheets[i].Hidden);++i);i==r&&a.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),e["!protect"]&&(a.push(qn("ProtectContents","True")),e["!protect"].objects&&a.push(qn("ProtectObjects","True")),e["!protect"].scenarios&&a.push(qn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?a.push(qn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&a.push(qn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&a.push("<"+s[1]+"/>")})),a.length==0?"":Je("WorksheetOptions",a.join(""),{xmlns:za.x})}function TF(e){return e.map(function(t){var r=OP(t.t||""),n=Je("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Je("Comment",n,{"ss:Author":t.a})}).join("")}function PF(e,t,r,n,a,i,s){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+dr(gx(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var c=jn(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(c.r==s.r?"":"["+(c.r-s.r)+"]")+"C"+(c.c==s.c?"":"["+(c.c-s.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=dr(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=dr(e.l.Tooltip))),r["!merges"])for(var u=r["!merges"],f=0;f!=u.length;++f)u[f].s.c!=s.c||u[f].s.r!=s.r||(u[f].e.c>u[f].s.c&&(o["ss:MergeAcross"]=u[f].e.c-u[f].s.c),u[f].e.r>u[f].s.r&&(o["ss:MergeDown"]=u[f].e.r-u[f].s.r));var d="",p="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":d="Number",p=String(e.v);break;case"b":d="Boolean",p=e.v?"1":"0";break;case"e":d="Error",p=r0[e.v];break;case"d":d="DateTime",p=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||Wr[14]);break;case"s":d="String",p=CP(e.v||"");break}var h=qo(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+h),o["ss:Index"]=s.c+1;var x=e.v!=null?p:"",g=e.t=="z"?"":'<Data ss:Type="'+d+'">'+x+"</Data>";return(e.c||[]).length>0&&(g+=TF(e.c)),Je("Cell",g,o)}function kF(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=x3(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function CF(e,t,r,n){if(!e["!ref"])return"";var a=kr(e["!ref"]),i=e["!merges"]||[],s=0,o=[];e["!cols"]&&e["!cols"].forEach(function(y,b){px(y);var E=!!y.width,A=Gh(b,y),C={"ss:Index":b+1};E&&(C["ss:Width"]=Hd(A.width)),y.hidden&&(C["ss:Hidden"]="1"),o.push(Je("Column",null,C))});for(var c=Array.isArray(e),u=a.s.r;u<=a.e.r;++u){for(var f=[kF(u,(e["!rows"]||[])[u])],d=a.s.c;d<=a.e.c;++d){var p=!1;for(s=0;s!=i.length;++s)if(!(i[s].s.c>d)&&!(i[s].s.r>u)&&!(i[s].e.c<d)&&!(i[s].e.r<u)){(i[s].s.c!=d||i[s].s.r!=u)&&(p=!0);break}if(!p){var h={r:u,c:d},x=hr(h),g=c?(e[u]||[])[d]:e[x];f.push(PF(g,x,e,t,r,n,h))}}f.push("</Row>"),f.length>2&&o.push(f.join(""))}return o.join("")}function OF(e,t,r){var n=[],a=r.SheetNames[e],i=r.Sheets[a],s=i?EF(i,t,e,r):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=i?CF(i,t,e,r):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(jF(i,t,e,r)),n.join("")}function LF(e,t){t||(t={}),e.SSF||(e.SSF=ja(Wr)),e.SSF&&($h(),Uh(e.SSF),t.revssf=zh(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],qo(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(_F(e,t)),r.push(NF()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Je("Worksheet",OF(n,t,e),{"ss:Name":dr(e.SheetNames[n])}));return r[2]=SF(e,t),r[3]=AF(e),fn+Je("Workbook",r.join(""),{xmlns:za.ss,"xmlns:o":za.o,"xmlns:x":za.x,"xmlns:ss":za.ss,"xmlns:dt":za.dt,"xmlns:html":za.html})}var Fm={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function FF(e,t){var r=[],n=[],a=[],i=0,s,o=Cy(Wy,"n"),c=Cy(Hy,"n");if(e.Props)for(s=Gn(e.Props),i=0;i<s.length;++i)(Object.prototype.hasOwnProperty.call(o,s[i])?r:Object.prototype.hasOwnProperty.call(c,s[i])?n:a).push([s[i],e.Props[s[i]]]);if(e.Custprops)for(s=Gn(e.Custprops),i=0;i<s.length;++i)Object.prototype.hasOwnProperty.call(e.Props||{},s[i])||(Object.prototype.hasOwnProperty.call(o,s[i])?r:Object.prototype.hasOwnProperty.call(c,s[i])?n:a).push([s[i],e.Custprops[s[i]]]);var u=[];for(i=0;i<a.length;++i)o3.indexOf(a[i][0])>-1||a3.indexOf(a[i][0])>-1||a[i][1]!=null&&u.push(a[i]);n.length&&gr.utils.cfb_add(t,"/SummaryInformation",Xy(n,Fm.SI,c,Hy)),(r.length||u.length)&&gr.utils.cfb_add(t,"/DocumentSummaryInformation",Xy(r,Fm.DSI,o,Wy,u.length?u:null,Fm.UDI))}function DF(e,t){var r=t||{},n=gr.utils.cfb_new({root:"R"}),a="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":a="/Workbook",r.biff=8;break;case"biff5":a="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return gr.utils.cfb_add(n,a,R3(e,r)),r.biff==8&&(e.Props||e.Custprops)&&FF(e,n),r.biff==8&&e.vbaraw&&QC(n,gr.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var IF={0:{f:B7},1:{f:V7},2:{f:hL},3:{f:tL},4:{f:Z7},5:{f:cL},6:{f:vL},7:{f:iL},8:{f:AL},9:{f:SL},10:{f:_L},11:{f:NL},12:{f:Y7},13:{f:mL},14:{f:nL},15:{f:Q7},16:{f:fL},17:{f:bL},18:{f:oL},19:{f:ux},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:uF},40:{},42:{},43:{f:vC},44:{f:gC},45:{f:wC},46:{f:NC},47:{f:_C},48:{},49:{f:YP},50:{},51:{f:BC},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Xk},62:{f:xL},63:{f:HC},64:{f:$L},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:us,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:ML},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:H7},148:{f:z7,p:16},151:{f:CL},152:{},153:{f:lF},154:{},155:{},156:{f:sF},157:{},158:{},159:{T:1,f:sC},160:{T:-1},161:{T:1,f:Gl},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:EL},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:MC},336:{T:-1},337:{f:zC,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:H1},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Wk},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:OL},427:{f:LL},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:DL},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:W7},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:PL},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:H1},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:XC},633:{T:1},634:{T:-1},635:{T:1,f:KC},636:{T:-1},637:{f:QP},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:eF},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:zL},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function et(e,t,r,n){var a=t;if(!isNaN(a)){var i=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,a),s.write_shift(2,i),i>0&&ox(r)&&e.push(r)}}function MF(e,t,r,n){var a=(r||[]).length||0;if(a<=8224)return et(e,t,r,a);var i=t;if(!isNaN(i)){for(var s=r.parts||[],o=0,c=0,u=0;u+(s[o]||8224)<=8224;)u+=s[o]||8224,o++;var f=e.next(4);for(f.write_shift(2,i),f.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u;c<a;){for(f=e.next(4),f.write_shift(2,60),u=0;u+(s[o]||8224)<=8224;)u+=s[o]||8224,o++;f.write_shift(2,u),e.push(r.slice(c,c+u)),c+=u}}}function a0(e,t,r){return e||(e=De(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function RF(e,t,r,n){var a=De(9);return a0(a,e,t),c3(r,n||"b",a),a}function BF(e,t,r){var n=De(8+2*r.length);return a0(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function UF(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var a=t.t=="d"?Ea(ga(t.v)):t.v;a==(a|0)&&a>=0&&a<65536?et(e,2,eC(r,n,a)):et(e,3,Qk(r,n,a));return;case"b":case"e":et(e,5,RF(r,n,t.v,t.t));return;case"s":case"str":et(e,4,BF(r,n,(t.v||"").slice(0,255)));return}et(e,1,a0(null,r,n))}function $F(e,t,r,n){var a=Array.isArray(t),i=kr(t["!ref"]||"A1"),s,o="",c=[];if(i.e.c>255||i.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),s=cn(i)}for(var u=i.s.r;u<=i.e.r;++u){o=Hn(u);for(var f=i.s.c;f<=i.e.c;++f){u===i.s.r&&(c[f]=ra(f)),s=c[f]+o;var d=a?(t[u]||[])[f]:t[s];d&&UF(e,d,u,f)}}}function zF(e,t){for(var r=t||{},n=Aa(),a=0,i=0;i<e.SheetNames.length;++i)e.SheetNames[i]==r.sheet&&(a=i);if(a==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return et(n,r.biff==4?1033:r.biff==3?521:9,hx(e,16,r)),$F(n,e.Sheets[e.SheetNames[a]],a,r),et(n,10),n.end()}function qF(e,t,r){et(e,49,Ik({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function WF(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var a=n[0];a<=n[1];++a)t[a]!=null&&et(e,1054,Bk(a,t[a],r))})}function HF(e,t){var r=De(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),et(e,2151,r),r=De(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),d3(kr(t["!ref"]||"A1"),r),r.write_shift(4,4),et(e,2152,r)}function GF(e,t){for(var r=0;r<16;++r)et(e,224,Jy({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){et(e,224,Jy(n,0,t))})}function VF(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];et(e,440,Vk(n)),n[1].Tooltip&&et(e,2048,Kk(n))}delete t["!links"]}function KF(e,t){if(t){var r=0;t.forEach(function(n,a){++r<=256&&n&&et(e,125,Zk(Gh(a,n),a))})}}function YF(e,t,r,n,a){var i=16+qo(a.cellXfs,t,a);if(t.v==null&&!t.bf){et(e,513,Fl(r,n,i));return}if(t.bf)et(e,6,y7(t,r,n,a,i));else switch(t.t){case"d":case"n":var s=t.t=="d"?Ea(ga(t.v)):t.v;et(e,515,qk(r,n,s,i));break;case"b":case"e":et(e,517,zk(r,n,t.v,i,a,t.t));break;case"s":case"str":if(a.bookSST){var o=vx(a.Strings,t.v,a.revStrings);et(e,253,Mk(r,n,o,i))}else et(e,516,Rk(r,n,(t.v||"").slice(0,255),i,a));break;default:et(e,513,Fl(r,n,i))}}function XF(e,t,r){var n=Aa(),a=r.SheetNames[e],i=r.Sheets[a]||{},s=(r||{}).Workbook||{},o=(s.Sheets||[])[e]||{},c=Array.isArray(i),u=t.biff==8,f,d="",p=[],h=kr(i["!ref"]||"A1"),x=u?65536:16384;if(h.e.c>255||h.e.r>=x){if(t.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");h.e.c=Math.min(h.e.c,255),h.e.r=Math.min(h.e.c,x-1)}et(n,2057,hx(r,16,t)),et(n,13,ci(1)),et(n,12,ci(100)),et(n,15,da(!0)),et(n,17,da(!1)),et(n,16,Ll(.001)),et(n,95,da(!0)),et(n,42,da(!1)),et(n,43,da(!1)),et(n,130,ci(1)),et(n,128,$k()),et(n,131,da(!1)),et(n,132,da(!1)),u&&KF(n,i["!cols"]),et(n,512,Uk(h,t)),u&&(i["!links"]=[]);for(var g=h.s.r;g<=h.e.r;++g){d=Hn(g);for(var y=h.s.c;y<=h.e.c;++y){g===h.s.r&&(p[y]=ra(y)),f=p[y]+d;var b=c?(i[g]||[])[y]:i[f];b&&(YF(n,b,g,y,t),u&&b.l&&i["!links"].push([f,b.l]))}}var E=o.CodeName||o.name||a;return u&&et(n,574,Dk((s.Views||[])[0])),u&&(i["!merges"]||[]).length&&et(n,229,Gk(i["!merges"])),u&&VF(n,i),et(n,442,f3(E)),u&&HF(n,i),et(n,10),n.end()}function ZF(e,t,r){var n=Aa(),a=(e||{}).Workbook||{},i=a.Sheets||[],s=a.WBProps||{},o=r.biff==8,c=r.biff==5;if(et(n,2057,hx(e,5,r)),r.bookType=="xla"&&et(n,135),et(n,225,o?ci(1200):null),et(n,193,_k(2)),c&&et(n,191),c&&et(n,192),et(n,226),et(n,92,Ck("SheetJS",r)),et(n,66,ci(o?1200:1252)),o&&et(n,353,ci(0)),o&&et(n,448),et(n,317,Jk(e.SheetNames.length)),o&&e.vbaraw&&et(n,211),o&&e.vbaraw){var u=s.CodeName||"ThisWorkbook";et(n,442,f3(u))}et(n,156,ci(17)),et(n,25,da(!1)),et(n,18,da(!1)),et(n,19,ci(0)),o&&et(n,431,da(!1)),o&&et(n,444,ci(0)),et(n,61,Fk()),et(n,64,da(!1)),et(n,141,ci(0)),et(n,34,da(rF(e)=="true")),et(n,14,da(!0)),o&&et(n,439,da(!1)),et(n,218,ci(0)),qF(n,e,r),WF(n,e.SSF,r),GF(n,r),o&&et(n,352,da(!1));var f=n.end(),d=Aa();o&&et(d,140,Yk()),o&&r.Strings&&MF(d,252,Lk(r.Strings)),et(d,10);var p=d.end(),h=Aa(),x=0,g=0;for(g=0;g<e.SheetNames.length;++g)x+=(o?12:11)+(o?2:1)*e.SheetNames[g].length;var y=f.length+x+p.length;for(g=0;g<e.SheetNames.length;++g){var b=i[g]||{};et(h,133,Ok({pos:y,hs:b.Hidden||0,dt:0,name:e.SheetNames[g]},r)),y+=t[g].length}var E=h.end();if(x!=E.length)throw new Error("BS8 "+x+" != "+E.length);var A=[];return f.length&&A.push(f),E.length&&A.push(E),p.length&&A.push(p),zn(A)}function JF(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=ja(Wr)),e&&e.SSF&&($h(),Uh(e.SSF),r.revssf=zh(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,yx(r),r.cellXfs=[],qo(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var a=0;a<e.SheetNames.length;++a)n[n.length]=XF(a,r,e);return n.unshift(ZF(e,n,r)),zn(n)}function R3(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var a=Ya(n["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var i=t||{};switch(i.biff||2){case 8:case 5:return JF(e,t);case 4:case 3:case 2:return zF(e,t)}throw new Error("invalid type "+i.bookType+" for BIFF")}function QF(e,t,r,n){for(var a=e["!merges"]||[],i=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,c=0,u=0;u<a.length;++u)if(!(a[u].s.r>r||a[u].s.c>s)&&!(a[u].e.r<r||a[u].e.c<s)){if(a[u].s.r<r||a[u].s.c<s){o=-1;break}o=a[u].e.r-a[u].s.r+1,c=a[u].e.c-a[u].s.c+1;break}if(!(o<0)){var f=hr({r,c:s}),d=n.dense?(e[r]||[])[s]:e[f],p=d&&d.v!=null&&(d.h||kP(d.w||(Rs(d),d.w)||""))||"",h={};o>1&&(h.rowspan=o),c>1&&(h.colspan=c),n.editable?p='<span contenteditable="true">'+p+"</span>":d&&(h["data-t"]=d&&d.t||"z",d.v!=null&&(h["data-v"]=d.v),d.z!=null&&(h["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+d.l.Target+'">'+p+"</a>")),h.id=(n.id||"sjs")+"-"+f,i.push(Je("td",p,h))}}var x="<tr>";return x+i.join("")+"</tr>"}var eD='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',tD="</body></html>";function rD(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function B3(e,t){var r=t||{},n=r.header!=null?r.header:eD,a=r.footer!=null?r.footer:tD,i=[n],s=Ya(e["!ref"]);r.dense=Array.isArray(e),i.push(rD(e,s,r));for(var o=s.s.r;o<=s.e.r;++o)i.push(QF(e,s,o,r));return i.push("</table>"+a),i.join("")}function U3(e,t,r){var n=r||{},a=0,i=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var s=typeof n.origin=="string"?jn(n.origin):n.origin;a=s.r,i=s.c}var o=t.getElementsByTagName("tr"),c=Math.min(n.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:a,c:i}};if(e["!ref"]){var f=Ya(e["!ref"]);u.s.r=Math.min(u.s.r,f.s.r),u.s.c=Math.min(u.s.c,f.s.c),u.e.r=Math.max(u.e.r,f.e.r),u.e.c=Math.max(u.e.c,f.e.c),a==-1&&(u.e.r=a=f.e.r+1)}var d=[],p=0,h=e["!rows"]||(e["!rows"]=[]),x=0,g=0,y=0,b=0,E=0,A=0;for(e["!cols"]||(e["!cols"]=[]);x<o.length&&g<c;++x){var C=o[x];if(ib(C)){if(n.display)continue;h[g]={hidden:!0}}var N=C.children;for(y=b=0;y<N.length;++y){var F=N[y];if(!(n.display&&ib(F))){var O=F.hasAttribute("data-v")?F.getAttribute("data-v"):F.hasAttribute("v")?F.getAttribute("v"):FP(F.innerHTML),I=F.getAttribute("data-z")||F.getAttribute("z");for(p=0;p<d.length;++p){var P=d[p];P.s.c==b+i&&P.s.r<g+a&&g+a<=P.e.r&&(b=P.e.c+1-i,p=-1)}A=+F.getAttribute("colspan")||1,((E=+F.getAttribute("rowspan")||1)>1||A>1)&&d.push({s:{r:g+a,c:b+i},e:{r:g+a+(E||1)-1,c:b+i+(A||1)-1}});var H={t:"s",v:O},T=F.getAttribute("data-t")||F.getAttribute("t")||"";O!=null&&(O.length==0?H.t=T||"z":n.raw||O.trim().length==0||T=="s"||(O==="TRUE"?H={t:"b",v:!0}:O==="FALSE"?H={t:"b",v:!1}:isNaN(Ls(O))?isNaN(Pf(O).getDate())||(H={t:"d",v:ga(O)},n.cellDates||(H={t:"n",v:Ea(H.v)}),H.z=n.dateNF||Wr[14]):H={t:"n",v:Ls(O)})),H.z===void 0&&I!=null&&(H.z=I);var j="",z=F.getElementsByTagName("A");if(z&&z.length)for(var K=0;K<z.length&&!(z[K].hasAttribute("href")&&(j=z[K].getAttribute("href"),j.charAt(0)!="#"));++K);j&&j.charAt(0)!="#"&&(H.l={Target:j}),n.dense?(e[g+a]||(e[g+a]=[]),e[g+a][b+i]=H):e[hr({c:b+i,r:g+a})]=H,u.e.c<b+i&&(u.e.c=b+i),b+=A}}++g}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),u.e.r=Math.max(u.e.r,g-1+a),e["!ref"]=cn(u),g>=c&&(e["!fullref"]=cn((u.e.r=o.length-x+g-1+a,u))),e}function $3(e,t){var r=t||{},n=r.dense?[]:{};return U3(n,e,t)}function nD(e,t){return zl($3(e,t),t)}function ib(e){var t="",r=aD(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function aD(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var iD=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Cf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return fn+t}}(),sb=function(){var e=function(i){return dr(i).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(i,s,o){var c=[];c.push('      <table:table table:name="'+dr(s.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,f=0,d=Ya(i["!ref"]||"A1"),p=i["!merges"]||[],h=0,x=Array.isArray(i);if(i["!cols"])for(f=0;f<=d.e.c;++f)c.push("        <table:table-column"+(i["!cols"][f]?' table:style-name="co'+i["!cols"][f].ods+'"':"")+`></table:table-column>
`);var g="",y=i["!rows"]||[];for(u=0;u<d.s.r;++u)g=y[u]?' table:style-name="ro'+y[u].ods+'"':"",c.push("        <table:table-row"+g+`></table:table-row>
`);for(;u<=d.e.r;++u){for(g=y[u]?' table:style-name="ro'+y[u].ods+'"':"",c.push("        <table:table-row"+g+`>
`),f=0;f<d.s.c;++f)c.push(t);for(;f<=d.e.c;++f){var b=!1,E={},A="";for(h=0;h!=p.length;++h)if(!(p[h].s.c>f)&&!(p[h].s.r>u)&&!(p[h].e.c<f)&&!(p[h].e.r<u)){(p[h].s.c!=f||p[h].s.r!=u)&&(b=!0),E["table:number-columns-spanned"]=p[h].e.c-p[h].s.c+1,E["table:number-rows-spanned"]=p[h].e.r-p[h].s.r+1;break}if(b){c.push(r);continue}var C=hr({r:u,c:f}),N=x?(i[u]||[])[f]:i[C];if(N&&N.f&&(E["table:formula"]=dr(A7(N.f)),N.F&&N.F.slice(0,C.length)==C)){var F=Ya(N.F);E["table:number-matrix-columns-spanned"]=F.e.c-F.s.c+1,E["table:number-matrix-rows-spanned"]=F.e.r-F.s.r+1}if(!N){c.push(t);continue}switch(N.t){case"b":A=N.v?"TRUE":"FALSE",E["office:value-type"]="boolean",E["office:boolean-value"]=N.v?"true":"false";break;case"n":A=N.w||String(N.v||0),E["office:value-type"]="float",E["office:value"]=N.v||0;break;case"s":case"str":A=N.v==null?"":N.v,E["office:value-type"]="string";break;case"d":A=N.w||ga(N.v).toISOString(),E["office:value-type"]="date",E["office:date-value"]=ga(N.v).toISOString(),E["table:style-name"]="ce1";break;default:c.push(t);continue}var O=e(A);if(N.l&&N.l.Target){var I=N.l.Target;I=I.charAt(0)=="#"?"#"+E7(I.slice(1)):I,I.charAt(0)!="#"&&!I.match(/^\w+:/)&&(I="../"+I),O=Je("text:a",O,{"xlink:href":I.replace(/&/g,"&amp;")})}c.push("          "+Je("table:table-cell",Je("text:p",O,{}),E)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},a=function(i,s){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var o=0;s.SheetNames.map(function(u){return s.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var f=0;f<u["!cols"].length;++f)if(u["!cols"][f]){var d=u["!cols"][f];if(d.width==null&&d.wpx==null&&d.wch==null)continue;px(d),d.ods=o;var p=u["!cols"][f].wpx+"px";i.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),i.push(`  </style:style>
`),++o}}});var c=0;s.SheetNames.map(function(u){return s.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var f=0;f<u["!rows"].length;++f)if(u["!rows"][f]){u["!rows"][f].ods=c;var d=u["!rows"][f].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+d+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(s,o){var c=[fn],u=Cf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),f=Cf({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(c.push("<office:document"+u+f+`>
`),c.push(r3().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+u+`>
`),a(c,s),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var d=0;d!=s.SheetNames.length;++d)c.push(n(s.Sheets[s.SheetNames[d]],s,d));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),o.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function z3(e,t){if(t.bookType=="fods")return sb(e,t);var r=nx(),n="",a=[],i=[];return n="mimetype",Bt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Bt(r,n,sb(e,t)),a.push([n,"text/xml"]),i.push([n,"ContentFile"]),n="styles.xml",Bt(r,n,iD(e,t)),a.push([n,"text/xml"]),i.push([n,"StylesFile"]),n="meta.xml",Bt(r,n,fn+r3()),a.push([n,"text/xml"]),i.push([n,"MetadataFile"]),n="manifest.rdf",Bt(r,n,xk(i)),a.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Bt(r,n,mk(a)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Kd(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function sD(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):ki(kf(e))}function oD(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Uo(e){var t=e.reduce(function(a,i){return a+i.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function lD(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,a=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var i=0;a>=1;++i,a/=256)e[t+i]=a&255;e[t+15]|=r>=0?0:128}function Of(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function lr(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Fc(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function vn(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=Of(e,r),i=a&7;a=Math.floor(a/8);var s=0,o;if(a==0)break;switch(i){case 0:{for(var c=r[0];e[r[0]++]>=128;);o=e.slice(c,r[0])}break;case 5:s=4,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=Of(e,r),o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(n))}var u={data:o,type:i};t[a]==null?t[a]=[u]:t[a].push(u)}return t}function Mn(e){var t=[];return e.forEach(function(r,n){r.forEach(function(a){a.data&&(t.push(lr(n*8+a.type)),a.type==2&&t.push(lr(a.data.length)),t.push(a.data))})}),Uo(t)}function ji(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=Of(e,n),i=vn(e.slice(n[0],n[0]+a));n[0]+=a;var s={id:Fc(i[1][0].data),messages:[]};i[2].forEach(function(o){var c=vn(o.data),u=Fc(c[3][0].data);s.messages.push({meta:c,data:e.slice(n[0],n[0]+u)}),n[0]+=u}),(t=i[3])!=null&&t[0]&&(s.merge=Fc(i[3][0].data)>>>0>0),r.push(s)}return r}function hc(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:lr(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:lr(+!!r.merge),type:0}]);var a=[];r.messages.forEach(function(s){a.push(s.data),s.meta[3]=[{type:0,data:lr(s.data.length)}],n[2].push({data:Mn(s.meta),type:2})});var i=Mn(n);t.push(lr(i.length)),t.push(i),a.forEach(function(s){return t.push(s)})}),Uo(t)}function cD(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Of(t,r),a=[];r[0]<t.length;){var i=t[r[0]]&3;if(i==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var o=s-59;s=t[r[0]],o>1&&(s|=t[r[0]+1]<<8),o>2&&(s|=t[r[0]+2]<<16),o>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=o}a.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var c=0,u=0;if(i==1?(u=(t[r[0]]>>2&7)+4,c=(t[r[0]++]&224)<<3,c|=t[r[0]++]):(u=(t[r[0]++]>>2)+1,i==2?(c=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(c=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[Uo(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(u>=c)for(a.push(a[0].slice(-c)),u-=c;u>=a[a.length-1].length;)a.push(a[a.length-1]),u-=a[a.length-1].length;a.push(a[0].slice(-c,-c+u))}}var f=Uo(a);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function Ti(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(cD(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Uo(t)}function pc(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),a=new Uint8Array(4);t.push(a);var i=lr(n),s=i.length;t.push(i),n<=60?(s++,t.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),s+=n,a[0]=0,a[1]=s&255,a[2]=s>>8&255,a[3]=s>>16&255,r+=n}return Uo(t)}function Dm(e,t){var r=new Uint8Array(32),n=Kd(r),a=12,i=0;switch(r[0]=5,e.t){case"n":r[1]=2,lD(r,a,e.v),i|=1,a+=16;break;case"b":r[1]=6,n.setFloat64(a,e.v?1:0,!0),i|=2,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,i,!0),r.slice(0,a)}function Im(e,t){var r=new Uint8Array(32),n=Kd(r),a=12,i=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(a,e.v,!0),i|=32,a+=8;break;case"b":r[2]=6,n.setFloat64(a,e.v?1:0,!0),i|=32,a+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(a,t.indexOf(e.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,i,!0),r.slice(0,a)}function fo(e){var t=vn(e);return Of(t[1][0].data)}function uD(e,t,r){var n,a,i,s;if(!((n=e[6])!=null&&n[0])||!((a=e[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var o=((s=(i=e[8])==null?void 0:i[0])==null?void 0:s.data)&&Fc(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var c=0,u=Kd(e[7][0].data),f=0,d=[],p=Kd(e[4][0].data),h=0,x=[],g=0;g<t.length;++g){if(t[g]==null){u.setUint16(g*2,65535,!0),p.setUint16(g*2,65535);continue}u.setUint16(g*2,f,!0),p.setUint16(g*2,h,!0);var y,b;switch(typeof t[g]){case"string":y=Dm({t:"s",v:t[g]},r),b=Im({t:"s",v:t[g]},r);break;case"number":y=Dm({t:"n",v:t[g]},r),b=Im({t:"n",v:t[g]},r);break;case"boolean":y=Dm({t:"b",v:t[g]},r),b=Im({t:"b",v:t[g]},r);break;default:throw new Error("Unsupported value "+t[g])}d.push(y),f+=y.length,x.push(b),h+=b.length,++c}for(e[2][0].data=lr(c);g<e[7][0].data.length/2;++g)u.setUint16(g*2,65535,!0),p.setUint16(g*2,65535,!0);return e[6][0].data=Uo(d),e[3][0].data=Uo(x),c}function fD(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=Ya(r["!ref"]);n.s.r=n.s.c=0;var a=!1;n.e.c>9&&(a=!0,n.e.c=9),n.e.r>49&&(a=!0,n.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(cn(n)));var i=Yd(r,{range:n,header:1}),s=["~Sh33tJ5~"];i.forEach(function(L){return L.forEach(function(D){typeof D=="string"&&s.push(D)})});var o={},c=[],u=gr.read(t.numbers,{type:"base64"});u.FileIndex.map(function(L,D){return[L,u.FullPaths[D]]}).forEach(function(L){var D=L[0],R=L[1];if(D.type==2&&D.name.match(/\.iwa/)){var X=D.content,de=Ti(X),me=ji(de);me.forEach(function(Y){c.push(Y.id),o[Y.id]={deps:[],location:R,type:Fc(Y.messages[0].meta[1][0].data)}})}}),c.sort(function(L,D){return L-D});var f=c.filter(function(L){return L>1}).map(function(L){return[L,lr(L)]});u.FileIndex.map(function(L,D){return[L,u.FullPaths[D]]}).forEach(function(L){var D=L[0];if(L[1],!!D.name.match(/\.iwa/)){var R=ji(Ti(D.content));R.forEach(function(X){X.messages.forEach(function(de){f.forEach(function(me){X.messages.some(function(Y){return Fc(Y.meta[1][0].data)!=11006&&oD(Y.data,me[1])})&&o[me[0]].deps.push(X.id)})})})}});for(var d=gr.find(u,o[1].location),p=ji(Ti(d.content)),h,x=0;x<p.length;++x){var g=p[x];g.id==1&&(h=g)}var y=fo(vn(h.messages[0].data)[1][0].data);for(d=gr.find(u,o[y].location),p=ji(Ti(d.content)),x=0;x<p.length;++x)g=p[x],g.id==y&&(h=g);for(y=fo(vn(h.messages[0].data)[2][0].data),d=gr.find(u,o[y].location),p=ji(Ti(d.content)),x=0;x<p.length;++x)g=p[x],g.id==y&&(h=g);for(y=fo(vn(h.messages[0].data)[2][0].data),d=gr.find(u,o[y].location),p=ji(Ti(d.content)),x=0;x<p.length;++x)g=p[x],g.id==y&&(h=g);var b=vn(h.messages[0].data);{b[6][0].data=lr(n.e.r+1),b[7][0].data=lr(n.e.c+1);var E=fo(b[46][0].data),A=gr.find(u,o[E].location),C=ji(Ti(A.content));{for(var N=0;N<C.length&&C[N].id!=E;++N);if(C[N].id!=E)throw"Bad ColumnRowUIDMapArchive";var F=vn(C[N].messages[0].data);F[1]=[],F[2]=[],F[3]=[];for(var O=0;O<=n.e.c;++O){var I=[];I[1]=I[2]=[{type:0,data:lr(O+420690)}],F[1].push({type:2,data:Mn(I)}),F[2].push({type:0,data:lr(O)}),F[3].push({type:0,data:lr(O)})}F[4]=[],F[5]=[],F[6]=[];for(var P=0;P<=n.e.r;++P)I=[],I[1]=I[2]=[{type:0,data:lr(P+726270)}],F[4].push({type:2,data:Mn(I)}),F[5].push({type:0,data:lr(P)}),F[6].push({type:0,data:lr(P)});C[N].messages[0].data=Mn(F)}A.content=pc(hc(C)),A.size=A.content.length,delete b[46];var H=vn(b[4][0].data);{H[7][0].data=lr(n.e.r+1);var T=vn(H[1][0].data),j=fo(T[2][0].data);A=gr.find(u,o[j].location),C=ji(Ti(A.content));{if(C[0].id!=j)throw"Bad HeaderStorageBucket";var z=vn(C[0].messages[0].data);for(P=0;P<i.length;++P){var K=vn(z[2][0].data);K[1][0].data=lr(P),K[4][0].data=lr(i[P].length),z[2][P]={type:z[2][0].type,data:Mn(K)}}C[0].messages[0].data=Mn(z)}A.content=pc(hc(C)),A.size=A.content.length;var he=fo(H[2][0].data);A=gr.find(u,o[he].location),C=ji(Ti(A.content));{if(C[0].id!=he)throw"Bad HeaderStorageBucket";for(z=vn(C[0].messages[0].data),O=0;O<=n.e.c;++O)K=vn(z[2][0].data),K[1][0].data=lr(O),K[4][0].data=lr(n.e.r+1),z[2][O]={type:z[2][0].type,data:Mn(K)};C[0].messages[0].data=Mn(z)}A.content=pc(hc(C)),A.size=A.content.length;var be=fo(H[4][0].data);(function(){for(var L=gr.find(u,o[be].location),D=ji(Ti(L.content)),R,X=0;X<D.length;++X){var de=D[X];de.id==be&&(R=de)}var me=vn(R.messages[0].data);{me[3]=[];var Y=[];s.forEach(function(fe,Ue){Y[1]=[{type:0,data:lr(Ue)}],Y[2]=[{type:0,data:lr(1)}],Y[3]=[{type:2,data:sD(fe)}],me[3].push({type:2,data:Mn(Y)})})}R.messages[0].data=Mn(me);var oe=hc(D),ue=pc(oe);L.content=ue,L.size=L.content.length})();var we=vn(H[3][0].data);{var Q=we[1][0];delete we[2];var le=vn(Q.data);{var ke=fo(le[2][0].data);(function(){for(var L=gr.find(u,o[ke].location),D=ji(Ti(L.content)),R,X=0;X<D.length;++X){var de=D[X];de.id==ke&&(R=de)}var me=vn(R.messages[0].data);{delete me[6],delete we[7];var Y=new Uint8Array(me[5][0].data);me[5]=[];for(var oe=0,ue=0;ue<=n.e.r;++ue){var fe=vn(Y);oe+=uD(fe,i[ue],s),fe[1][0].data=lr(ue),me[5].push({data:Mn(fe),type:2})}me[1]=[{type:0,data:lr(n.e.c+1)}],me[2]=[{type:0,data:lr(n.e.r+1)}],me[3]=[{type:0,data:lr(oe)}],me[4]=[{type:0,data:lr(n.e.r+1)}]}R.messages[0].data=Mn(me);var Ue=hc(D),xe=pc(Ue);L.content=xe,L.size=L.content.length})()}Q.data=Mn(le)}H[3][0].data=Mn(we)}b[4][0].data=Mn(H)}h.messages[0].data=Mn(b);var ve=hc(p),S=pc(ve);return d.content=S,d.size=d.content.length,u}function dD(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function yx(e){dD([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function hD(e,t){return t.bookType=="ods"?z3(e,t):t.bookType=="numbers"?fD(e,t):t.bookType=="xlsb"?pD(e,t):mD(e,t)}function pD(e,t){jc=1024,e&&!e.SSF&&(e.SSF=ja(Wr)),e&&e.SSF&&($h(),Uh(e.SSF),t.revssf=zh(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,bf?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=S3.indexOf(t.bookType)>-1,a=Q4();yx(t=t||{});var i=nx(),s="",o=0;if(t.cellXfs=[],qo(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Bt(i,s,n3(e.Props,t)),a.coreprops.push(s),cr(t.rels,2,s,Zt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}for(e.Props.Worksheets=e.Props.SheetNames.length,Bt(i,s,i3(e.Props)),a.extprops.push(s),cr(t.rels,3,s,Zt.EXT_PROPS),e.Custprops!==e.Props&&Gn(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Bt(i,s,s3(e.Custprops)),a.custprops.push(s),cr(t.rels,4,s,Zt.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var f={"!id":{}},d=e.Sheets[e.SheetNames[o-1]],p=(d||{})["!type"]||"sheet";switch(p){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,Bt(i,s,xF(o-1,s,t,e,f)),a.sheets.push(s),cr(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Zt.WS[0])}if(d){var h=d["!comments"],x=!1,g="";h&&h.length>0&&(g="xl/comments"+o+"."+r,Bt(i,g,bF(h,g)),a.comments.push(g),cr(f,-1,"../comments"+o+"."+r,Zt.CMNT),x=!0),d["!legacy"]&&x&&Bt(i,"xl/drawings/vmlDrawing"+o+".vml",_3(o,d["!comments"])),delete d["!comments"],delete d["!legacy"]}f["!id"].rId1&&Bt(i,t3(s),Oc(f))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,Bt(i,s,yF(t.Strings,s,t)),a.strs.push(s),cr(t.wbrels,-1,"sharedStrings."+r,Zt.SST)),s="xl/workbook."+r,Bt(i,s,gF(e,s)),a.workbooks.push(s),cr(t.rels,1,s,Zt.WB),s="xl/theme/theme1.xml",Bt(i,s,b3(e.Themes,t)),a.themes.push(s),cr(t.wbrels,-1,"theme/theme1.xml",Zt.THEME),s="xl/styles."+r,Bt(i,s,vF(e,s,t)),a.styles.push(s),cr(t.wbrels,-1,"styles."+r,Zt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",Bt(i,s,e.vbaraw),a.vba.push(s),cr(t.wbrels,-1,"vbaProject.bin",Zt.VBA)),s="xl/metadata."+r,Bt(i,s,wF(s)),a.metadata.push(s),cr(t.wbrels,-1,"metadata."+r,Zt.XLMETA),Bt(i,"[Content_Types].xml",e3(a,t)),Bt(i,"_rels/.rels",Oc(t.rels)),Bt(i,"xl/_rels/workbook."+r+".rels",Oc(t.wbrels)),delete t.revssf,delete t.ssf,i}function mD(e,t){jc=1024,e&&!e.SSF&&(e.SSF=ja(Wr)),e&&e.SSF&&($h(),Uh(e.SSF),t.revssf=zh(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,bf?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=S3.indexOf(t.bookType)>-1,a=Q4();yx(t=t||{});var i=nx(),s="",o=0;if(t.cellXfs=[],qo(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Bt(i,s,n3(e.Props,t)),a.coreprops.push(s),cr(t.rels,2,s,Zt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var c=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&c.push(e.SheetNames[u]);e.Props.SheetNames=c}e.Props.Worksheets=e.Props.SheetNames.length,Bt(i,s,i3(e.Props)),a.extprops.push(s),cr(t.rels,3,s,Zt.EXT_PROPS),e.Custprops!==e.Props&&Gn(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Bt(i,s,s3(e.Custprops)),a.custprops.push(s),cr(t.rels,4,s,Zt.CUST_PROPS));var f=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var d={"!id":{}},p=e.Sheets[e.SheetNames[o-1]],h=(p||{})["!type"]||"sheet";switch(h){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,Bt(i,s,L3(o-1,t,e,d)),a.sheets.push(s),cr(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Zt.WS[0])}if(p){var x=p["!comments"],g=!1,y="";if(x&&x.length>0){var b=!1;x.forEach(function(E){E[1].forEach(function(A){A.T==!0&&(b=!0)})}),b&&(y="xl/threadedComments/threadedComment"+o+"."+r,Bt(i,y,GC(x,f,t)),a.threadedcomments.push(y),cr(d,-1,"../threadedComments/threadedComment"+o+"."+r,Zt.TCMNT)),y="xl/comments"+o+"."+r,Bt(i,y,N3(x)),a.comments.push(y),cr(d,-1,"../comments"+o+"."+r,Zt.CMNT),g=!0}p["!legacy"]&&g&&Bt(i,"xl/drawings/vmlDrawing"+o+".vml",_3(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}d["!id"].rId1&&Bt(i,t3(s),Oc(d))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,Bt(i,s,p3(t.Strings,t)),a.strs.push(s),cr(t.wbrels,-1,"sharedStrings."+r,Zt.SST)),s="xl/workbook."+r,Bt(i,s,I3(e)),a.workbooks.push(s),cr(t.rels,1,s,Zt.WB),s="xl/theme/theme1.xml",Bt(i,s,b3(e.Themes,t)),a.themes.push(s),cr(t.wbrels,-1,"theme/theme1.xml",Zt.THEME),s="xl/styles."+r,Bt(i,s,v3(e,t)),a.styles.push(s),cr(t.wbrels,-1,"styles."+r,Zt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",Bt(i,s,e.vbaraw),a.vba.push(s),cr(t.wbrels,-1,"vbaProject.bin",Zt.VBA)),s="xl/metadata."+r,Bt(i,s,w3()),a.metadata.push(s),cr(t.wbrels,-1,"metadata."+r,Zt.XLMETA),f.length>1&&(s="xl/persons/person.xml",Bt(i,s,VC(f)),a.people.push(s),cr(t.wbrels,-1,"persons/person.xml",Zt.PEOPLE)),Bt(i,"[Content_Types].xml",e3(a,t)),Bt(i,"_rels/.rels",Oc(t.rels)),Bt(i,"xl/_rels/workbook."+r+".rels",Oc(t.wbrels)),delete t.revssf,delete t.ssf,i}function gD(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Ms(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function q3(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return e0(t.file,gr.write(e,{type:ar?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return gr.write(e,t)}function xD(e,t){var r=ja(t||{}),n=hD(e,r);return vD(n,r)}function vD(e,t){var r={},n=ar?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var a=e.FullPaths?gr.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof a=="string"){if(t.type=="binary"||t.type=="base64")return a;a=new Uint8Array(Bh(a))}return t.password&&typeof encrypt_agile<"u"?q3(encrypt_agile(a,t.password),t):t.type==="file"?e0(t.file,a):t.type=="string"?gf(a):a}function yD(e,t){var r=t||{},n=DF(e,r);return q3(n,r)}function Qi(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Tf(kf(n));case"binary":return kf(n);case"string":return e;case"file":return e0(t.file,n,"utf8");case"buffer":return ar?Gs(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Qi(n,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function bD(e,t){switch(t.type){case"base64":return Tf(e);case"binary":return e;case"string":return e;case"file":return e0(t.file,e,"binary");case"buffer":return ar?Gs(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function ed(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Tf(r):t.type=="string"?gf(r):r;case"file":return e0(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function W3(e,t){K8(),iF(e);var r=ja(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=W3(e,r);return r.type="array",Bh(n)}var a=0;if(r.sheet&&(typeof r.sheet=="number"?a=r.sheet:a=e.SheetNames.indexOf(r.sheet),!e.SheetNames[a]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Qi(LF(e,r),r);case"slk":case"sylk":return Qi(rC.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"htm":case"html":return Qi(B3(e.Sheets[e.SheetNames[a]],r),r);case"txt":return bD(G3(e.Sheets[e.SheetNames[a]],r),r);case"csv":return Qi(bx(e.Sheets[e.SheetNames[a]],r),r,"\uFEFF");case"dif":return Qi(nC.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"dbf":return ed(tC.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"prn":return Qi(aC.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"rtf":return Qi(fC.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"eth":return Qi(h3.from_sheet(e.Sheets[e.SheetNames[a]],r),r);case"fods":return Qi(z3(e,r),r);case"wk1":return ed(Qy.sheet_to_wk1(e.Sheets[e.SheetNames[a]],r),r);case"wk3":return ed(Qy.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),ed(R3(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),yD(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return xD(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function wD(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function H3(e,t,r){var n={};return n.type="file",n.file=t,wD(n),W3(e,n)}function _D(e,t,r,n,a,i,s,o){var c=Hn(r),u=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,p=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!s||e[r])for(var h=t.s.c;h<=t.e.c;++h){var x=s?e[r][h]:e[n[h]+c];if(x===void 0||x.t===void 0){if(u===void 0)continue;i[h]!=null&&(p[i[h]]=u);continue}var g=x.v;switch(x.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(i[h]!=null){if(g==null)if(x.t=="e"&&g===null)p[i[h]]=null;else if(u!==void 0)p[i[h]]=u;else if(f&&g===null)p[i[h]]=null;else continue;else p[i[h]]=f&&(x.t!=="n"||x.t==="n"&&o.rawNumbers!==!1)?g:Rs(x,g,o);g!=null&&(d=!1)}}return{row:p,isempty:d}}function Yd(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,i=[],s=0,o="",c={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},f=u.range!=null?u.range:e["!ref"];switch(u.header===1?n=1:u.header==="A"?n=2:Array.isArray(u.header)?n=3:u.header==null&&(n=0),typeof f){case"string":c=kr(f);break;case"number":c=kr(e["!ref"]),c.s.r=f;break;default:c=f}n>0&&(a=0);var d=Hn(c.s.r),p=[],h=[],x=0,g=0,y=Array.isArray(e),b=c.s.r,E=0,A={};y&&!e[b]&&(e[b]=[]);var C=u.skipHidden&&e["!cols"]||[],N=u.skipHidden&&e["!rows"]||[];for(E=c.s.c;E<=c.e.c;++E)if(!(C[E]||{}).hidden)switch(p[E]=ra(E),r=y?e[b][E]:e[p[E]+d],n){case 1:i[E]=E-c.s.c;break;case 2:i[E]=p[E];break;case 3:i[E]=u.header[E-c.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=s=Rs(r,null,u),g=A[s]||0,!g)A[s]=1;else{do o=s+"_"+g++;while(A[o]);A[s]=g,A[o]=1}i[E]=o}for(b=c.s.r+a;b<=c.e.r;++b)if(!(N[b]||{}).hidden){var F=_D(e,c,b,p,n,i,y,u);(F.isempty===!1||(n===1?u.blankrows!==!1:u.blankrows))&&(h[x++]=F.row)}return h.length=x,h}var ob=/"/g;function ND(e,t,r,n,a,i,s,o){for(var c=!0,u=[],f="",d=Hn(r),p=t.s.c;p<=t.e.c;++p)if(n[p]){var h=o.dense?(e[r]||[])[p]:e[n[p]+d];if(h==null)f="";else if(h.v!=null){c=!1,f=""+(o.rawNumbers&&h.t=="n"?h.v:Rs(h,null,o));for(var x=0,g=0;x!==f.length;++x)if((g=f.charCodeAt(x))===a||g===i||g===34||o.forceQuotes){f='"'+f.replace(ob,'""')+'"';break}f=="ID"&&(f='"ID"')}else h.f!=null&&!h.F?(c=!1,f="="+h.f,f.indexOf(",")>=0&&(f='"'+f.replace(ob,'""')+'"')):f="";u.push(f)}return o.blankrows===!1&&c?null:u.join(s)}function bx(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=kr(e["!ref"]),i=n.FS!==void 0?n.FS:",",s=i.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,c=o.charCodeAt(0),u=new RegExp((i=="|"?"\\|":i)+"+$"),f="",d=[];n.dense=Array.isArray(e);for(var p=n.skipHidden&&e["!cols"]||[],h=n.skipHidden&&e["!rows"]||[],x=a.s.c;x<=a.e.c;++x)(p[x]||{}).hidden||(d[x]=ra(x));for(var g=0,y=a.s.r;y<=a.e.r;++y)(h[y]||{}).hidden||(f=ND(e,a,y,d,s,c,i,n),f!=null&&(n.strip&&(f=f.replace(u,"")),(f||n.blankrows!==!1)&&r.push((g++?o:"")+f)));return delete n.dense,r.join("")}function G3(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=bx(e,t);return r}function SD(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=kr(e["!ref"]),i="",s=[],o,c=[],u=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)s[o]=ra(o);for(var f=a.s.r;f<=a.e.r;++f)for(i=Hn(f),o=a.s.c;o<=a.e.c;++o)if(t=s[o]+i,r=u?(e[f]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}c[c.length]=t+"="+n}return c}function V3(e,t,r){var n=r||{},a=+!n.skipHeader,i=e||{},s=0,o=0;if(i&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var c=typeof n.origin=="string"?jn(n.origin):n.origin;s=c.r,o=c.c}var u,f={s:{c:0,r:0},e:{c:o,r:s+t.length-1+a}};if(i["!ref"]){var d=kr(i["!ref"]);f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),s==-1&&(s=d.e.r+1,f.e.r=s+t.length-1+a)}else s==-1&&(s=0,f.e.r=t.length-1+a);var p=n.header||[],h=0;t.forEach(function(g,y){Gn(g).forEach(function(b){(h=p.indexOf(b))==-1&&(p[h=p.length]=b);var E=g[b],A="z",C="",N=hr({c:o+h,r:s+y+a});u=Lf(i,N),E&&typeof E=="object"&&!(E instanceof Date)?i[N]=E:(typeof E=="number"?A="n":typeof E=="boolean"?A="b":typeof E=="string"?A="s":E instanceof Date?(A="d",n.cellDates||(A="n",E=Ea(E)),C=n.dateNF||Wr[14]):E===null&&n.nullError&&(A="e",E=0),u?(u.t=A,u.v=E,delete u.w,delete u.R,C&&(u.z=C)):i[N]=u={t:A,v:E},C&&(u.z=C))})}),f.e.c=Math.max(f.e.c,o+p.length-1);var x=Hn(s);if(a)for(h=0;h<p.length;++h)i[ra(h+o)+x]={t:"s",v:p[h]};return i["!ref"]=cn(f),i}function AD(e,t){return V3(null,e,t)}function Lf(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=jn(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Lf(e,hr(t)):Lf(e,hr({r:t,c:r||0}))}function ED(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function jD(){return{SheetNames:[],Sheets:{}}}function TD(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var i=r.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var s=i&&i[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=s+a)!=-1;++a);}if(D3(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function PD(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=ED(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function kD(e,t){return e.z=t,e}function K3(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function CD(e,t,r){return K3(e,"#"+t,r)}function OD(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function LD(e,t,r,n){for(var a=typeof t!="string"?t:kr(t),i=typeof t=="string"?t:cn(t),s=a.s.r;s<=a.e.r;++s)for(var o=a.s.c;o<=a.e.c;++o){var c=Lf(e,s,o);c.t="n",c.F=i,delete c.v,s==a.s.r&&o==a.s.c&&(c.f=r,n&&(c.D=!0))}return e}var yo={encode_col:ra,encode_row:Hn,encode_cell:hr,encode_range:cn,decode_col:cx,decode_row:lx,split_cell:KP,decode_cell:jn,decode_range:Ya,format_cell:Rs,sheet_add_aoa:V4,sheet_add_json:V3,sheet_add_dom:U3,aoa_to_sheet:iu,json_to_sheet:AD,table_to_sheet:$3,table_to_book:nD,sheet_to_csv:bx,sheet_to_txt:G3,sheet_to_json:Yd,sheet_to_html:B3,sheet_to_formulae:SD,sheet_to_row_object_array:Yd,sheet_get_cell:Lf,book_new:jD,book_append_sheet:TD,book_set_sheet_visibility:PD,cell_set_number_format:kD,cell_set_hyperlink:K3,cell_set_internal_link:CD,cell_add_comment:OD,sheet_set_array_formula:LD,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const FD=()=>{const{user:e}=aa(),t=Hs(),r=Mh(),[n,a]=M.useState([]),[i,s]=M.useState(!0),[o,c]=M.useState(""),[u,f]=M.useState("date_desc"),[d,p]=M.useState("all"),[h,x]=M.useState(!1),[g,y]=M.useState(!1),[b,E]=M.useState({description:"",amount:"",category:"General",date:new Date().toISOString().split("T")[0]}),A=["General","Food & Dining","Transportation","Entertainment","Shopping","Bills & Utilities","Healthcare","Education","Travel","Personal Care","Home & Garden","Other"];M.useEffect(()=>{C()},[e]),M.useEffect(()=>{new URLSearchParams(r.search).get("add")==="true"&&(x(!0),t("/spends",{replace:!0}))},[r.search,t]);const C=async()=>{if(e)try{s(!0);const{data:j,error:z}=await Ke.from("spends").select("*").eq("user_id",e.id).order("created_at",{ascending:!1});if(z)throw z;a(j||[])}catch(j){console.error("Error fetching spends:",j)}finally{s(!1)}},N=async j=>{if(j.preventDefault(),!(!e||g)){y(!0);try{const z={...b,amount:parseFloat(b.amount),user_id:e.id},{error:K}=await Ke.from("spends").insert([z]);if(K)throw K;await C(),F()}catch(z){console.error("Error adding spend:",z)}finally{y(!1)}}},F=()=>{E({description:"",amount:"",category:"General",date:new Date().toISOString().split("T")[0]}),x(!1)},O=async j=>{if(confirm("Are you sure you want to delete this spend?"))try{const{error:z}=await Ke.from("spends").delete().eq("id",j);if(z)throw z;await C()}catch(z){console.error("Error deleting spend:",z)}},I=j=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(j),P=n.filter(j=>{const z=j.description.toLowerCase().includes(o.toLowerCase())||j.category.toLowerCase().includes(o.toLowerCase()),K=d==="all"||j.category===d;return z&&K}).sort((j,z)=>{switch(u){case"date_desc":return new Date(z.date).getTime()-new Date(j.date).getTime();case"date_asc":return new Date(j.date).getTime()-new Date(z.date).getTime();case"amount_desc":return z.amount-j.amount;case"amount_asc":return j.amount-z.amount;case"category":return j.category.localeCompare(z.category);default:return 0}}),H=P.reduce((j,z)=>j+z.amount,0),T=()=>{const j=P.map(K=>({Date:new Date(K.date).toLocaleDateString("en-IN"),Description:K.description,Category:K.category,Amount:K.amount})),z=yo.book_new();yo.book_append_sheet(z,yo.json_to_sheet(j),"Spends"),H3(z,`personal-spends-${new Date().toISOString().split("T")[0]}.xlsx`)};return l.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Personal Spends"}),l.jsx("p",{className:"text-gray-600 mt-1",children:"Track your personal expenses and spending habits"})]}),l.jsx("div",{className:"flex gap-3",children:l.jsxs("button",{onClick:T,disabled:n.length===0,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors flex items-center disabled:opacity-50 disabled:cursor-not-allowed",children:[l.jsx(ma,{className:"h-4 w-4 mr-2"}),"Export"]})})]}),l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:[l.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:l.jsxs("div",{className:"flex items-center",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Spends"}),l.jsx("p",{className:"text-xl sm:text-2xl font-bold text-blue-600",children:I(H)})]}),l.jsx(en,{className:"h-6 w-6 sm:h-8 sm:w-8 text-blue-600"})]})}),l.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:l.jsxs("div",{className:"flex items-center",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"This Month"}),l.jsx("p",{className:"text-xl sm:text-2xl font-bold text-green-600",children:I(P.filter(j=>{const z=new Date(j.date),K=new Date;return z.getMonth()===K.getMonth()&&z.getFullYear()===K.getFullYear()}).reduce((j,z)=>j+z.amount,0))})]}),l.jsx(Po,{className:"h-6 w-6 sm:h-8 sm:w-8 text-green-600"})]})}),l.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:l.jsxs("div",{className:"flex items-center",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Average per Day"}),l.jsx("p",{className:"text-xl sm:text-2xl font-bold text-purple-600",children:I(H/Math.max(1,n.length))})]}),l.jsx(Fd,{className:"h-6 w-6 sm:h-8 sm:w-8 text-purple-600"})]})})]}),l.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:l.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:items-center sm:space-y-0 sm:space-x-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Zg,{className:"h-5 w-5 text-gray-400"}),l.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Filters"})]}),l.jsxs("div",{className:"flex flex-col space-y-3 sm:flex-row sm:items-center sm:space-y-0 sm:space-x-4 flex-1",children:[l.jsx("div",{className:"flex-1",children:l.jsx("input",{type:"text",placeholder:"Search spends...",value:o,onChange:j=>c(j.target.value),className:"w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})}),l.jsxs("div",{className:"flex space-x-2",children:[l.jsxs("select",{value:d,onChange:j=>p(j.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"all",children:"All Categories"}),A.map(j=>l.jsx("option",{value:j,children:j},j))]}),l.jsxs("select",{value:u,onChange:j=>f(j.target.value),className:"border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"date_desc",children:"Newest First"}),l.jsx("option",{value:"date_asc",children:"Oldest First"}),l.jsx("option",{value:"amount_desc",children:"Highest Amount"}),l.jsx("option",{value:"amount_asc",children:"Lowest Amount"}),l.jsx("option",{value:"category",children:"By Category"})]})]})]})]})}),i?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):l.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:P.length>0?l.jsx("div",{className:"divide-y divide-gray-200",children:P.map(j=>l.jsx("div",{className:"p-4 sm:p-6 hover:bg-gray-50 transition-colors",children:l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between",children:[l.jsx("div",{className:"flex-1 min-w-0",children:l.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:l.jsx(en,{className:"h-5 w-5 text-blue-600"})})}),l.jsxs("div",{className:"min-w-0 flex-1",children:[l.jsx("h3",{className:"text-sm font-medium text-gray-900 truncate",children:j.description}),l.jsxs("p",{className:"text-sm text-gray-500",children:[j.category," ‚Ä¢ ",new Date(j.date).toLocaleDateString("en-IN")]})]})]})}),l.jsxs("div",{className:"flex items-center space-x-4 mt-3 sm:mt-0",children:[l.jsx("div",{className:"text-right",children:l.jsx("p",{className:"text-lg font-semibold text-gray-900",children:I(j.amount)})}),l.jsx("div",{className:"flex space-x-2",children:l.jsx("button",{onClick:()=>O(j.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete spend",children:l.jsx(Do,{className:"h-4 w-4"})})})]})]})},j.id))}):l.jsxs("div",{className:"text-center py-12",children:[l.jsx(en,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No spends found"}),l.jsx("p",{className:"text-gray-500 mb-6",children:o||d!=="all"?"Try adjusting your filters or search terms.":"Start tracking your personal expenses by adding your first spend."}),!o&&d==="all"&&l.jsxs("button",{onClick:()=>x(!0),className:"inline-flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[l.jsx(Li,{className:"h-4 w-4 mr-2"}),"Add Your First Spend"]})]})}),h&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:l.jsx("div",{className:"bg-white rounded-2xl w-full max-w-md",children:l.jsxs("div",{className:"p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Add Personal Spend"}),l.jsx("button",{onClick:F,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:l.jsx(Li,{className:"h-5 w-5 text-gray-500 rotate-45"})})]}),l.jsxs("form",{onSubmit:N,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Description *"}),l.jsx("input",{type:"text",value:b.description,onChange:j=>E({...b,description:j.target.value}),disabled:g,required:!0,className:"w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 disabled:bg-gray-100 disabled:cursor-not-allowed text-base transition-colors",placeholder:"What did you spend on?"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Amount *"}),l.jsx("input",{type:"number",value:b.amount,onChange:j=>E({...b,amount:j.target.value}),disabled:g,required:!0,min:"0",step:"0.01",className:"w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 disabled:bg-gray-100 disabled:cursor-not-allowed text-base transition-colors",placeholder:"0.00"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Category"}),l.jsx("select",{value:b.category,onChange:j=>E({...b,category:j.target.value}),disabled:g,className:"w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 disabled:bg-gray-100 disabled:cursor-not-allowed text-base transition-colors",children:A.map(j=>l.jsx("option",{value:j,children:j},j))})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Date"}),l.jsx("input",{type:"date",value:b.date,onChange:j=>E({...b,date:j.target.value}),disabled:g,className:"w-full p-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 disabled:bg-gray-100 disabled:cursor-not-allowed text-base transition-colors"})]}),l.jsxs("div",{className:"flex gap-3 pt-4",children:[l.jsx("button",{type:"button",onClick:F,disabled:g,className:"flex-1 py-3 px-4 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed transition-colors font-semibold",children:"Cancel"}),l.jsx("button",{type:"submit",disabled:g,className:"flex-1 py-3 px-4 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl hover:from-blue-600 hover:to-blue-700 disabled:from-gray-400 disabled:to-gray-500 disabled:cursor-not-allowed font-semibold transition-all duration-200",children:g?"Adding...":"Add Spend"})]})]})]})})})]})},DD=({isOpen:e,onClose:t,onSubmit:r,suppliers:n,businessOwners:a,editingTransaction:i})=>{const[s,o]=M.useState({supplier_id:"",type:"new_purchase",amount:"",description:"",owner_id:""});M.useEffect(()=>{o(i?{supplier_id:i.supplier_id||"",type:i.type,amount:i.amount.toString(),description:i.description||"",owner_id:i.owner_id||""}:{supplier_id:"",type:"new_purchase",amount:"",description:"",owner_id:""})},[i,e]);const c=u=>{u.preventDefault(),r(s),i||o({supplier_id:"",type:"new_purchase",amount:"",description:"",owner_id:""})};return e?l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[60] flex items-end sm:items-center justify-center p-4",children:l.jsxs("div",{className:"bg-white rounded-t-xl sm:rounded-xl w-full sm:max-w-md max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:i?"Edit Transaction":"Add Transaction"}),l.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg",children:l.jsx(Fo,{className:"h-5 w-5"})})]}),l.jsxs("form",{onSubmit:c,className:"p-4 space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Transaction Type"}),l.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[l.jsxs("button",{type:"button",onClick:()=>o({...s,type:"new_purchase"}),className:`p-3 border rounded-lg text-center ${s.type==="new_purchase"?"border-red-500 bg-red-50 text-red-700":"border-gray-300 hover:bg-gray-50"}`,children:[l.jsx(Li,{className:"h-4 w-4 mx-auto mb-1"}),l.jsx("span",{className:"text-sm",children:"Purchase"})]}),l.jsxs("button",{type:"button",onClick:()=>o({...s,type:"pay_due"}),className:`p-3 border rounded-lg text-center ${s.type==="pay_due"?"border-green-500 bg-green-50 text-green-700":"border-gray-300 hover:bg-gray-50"}`,children:[l.jsx(en,{className:"h-4 w-4 mx-auto mb-1"}),l.jsx("span",{className:"text-sm",children:"Payment"})]})]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supplier"}),l.jsxs("select",{value:s.supplier_id,onChange:u=>o({...s,supplier_id:u.target.value}),required:!0,className:"w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"",children:"Select Supplier"}),n.map(u=>l.jsx("option",{value:u.id,children:u.name},u.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount (‚Çπ)"}),l.jsx("input",{type:"number",value:s.amount,onChange:u=>o({...s,amount:u.target.value}),required:!0,min:"0",step:"0.01",placeholder:"Enter amount",className:"w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s.type==="new_purchase"?"Purchased by":"Paid by"}),l.jsxs("select",{value:s.owner_id,onChange:u=>o({...s,owner_id:u.target.value}),className:"w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"",children:"Select person"}),a.map(u=>l.jsx("option",{value:u.id,children:u.owner_name},u.id))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description (Optional)"}),l.jsx("input",{type:"text",value:s.description,onChange:u=>o({...s,description:u.target.value}),placeholder:"Add description...",className:"w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),l.jsxs("div",{className:"flex space-x-3 pt-2",children:[l.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-2.5 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Cancel"}),l.jsx("button",{type:"submit",className:"flex-1 px-4 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:i?"Update Transaction":"Add Transaction"})]})]})]})}):null},ID=()=>{const{user:e}=aa(),[t,r]=M.useState([]),[n,a]=M.useState([]),[i,s]=M.useState([]),[o,c]=M.useState([]),[u,f]=M.useState([]),[d,p]=M.useState(!0),[h,x]=M.useState(""),[g,y]=M.useState("all"),[b,E]=M.useState("suppliers"),[A,C]=M.useState(!1),[N,F]=M.useState(null),[O,I]=M.useState(null);M.useEffect(()=>{P()},[e]),M.useEffect(()=>{const Q=le=>{O&&!le.target.closest(".dropdown-menu")&&I(null)};return document.addEventListener("mousedown",Q),()=>document.removeEventListener("mousedown",Q)},[O]);const P=async()=>{if(e)try{const{data:Q,error:le}=await Ke.from("transactions").select(`
          *,
          supplier:suppliers(name),
          owner:business_owners(owner_name)
        `).eq("user_id",e.id).order("created_at",{ascending:!1});if(le)throw le;const{data:ke,error:ve}=await Ke.from("loan_transactions").select(`
          *,
          person:persons(name),
          owner:business_owners(owner_name)
        `).eq("user_id",e.id).order("created_at",{ascending:!1});if(ve)throw ve;const{data:S,error:L}=await Ke.from("suppliers").select("*").eq("user_id",e.id).order("name");if(L)throw L;const R=await Ps.getInstance().getBusinessOwners(e.id),{data:X,error:de}=await Ke.from("spends").select("*").eq("user_id",e.id).order("date",{ascending:!1});if(de)throw de;r(Q||[]),a(ke||[]),s(X||[]),c(S||[]),f(R||[])}catch(Q){console.error("Error fetching data:",Q)}finally{p(!1)}},H=async Q=>{if(e)try{if(N){const{error:le}=await Ke.from("transactions").update({amount:parseFloat(Q.amount),description:Q.description,type:Q.type,supplier_id:Q.supplier_id,owner_id:Q.owner_id}).eq("id",N.id);if(le)throw le;F(null)}else{const{data:le,error:ke}=await Ke.from("transactions").insert([{...Q,user_id:e.id,amount:parseFloat(Q.amount)}]).select(`
            *,
            supplier:suppliers(name),
            owner:business_owners(owner_name)
          `).single();if(ke)throw ke;const ve=o.find(L=>L.id===Q.supplier_id),S=u.find(L=>L.id===Q.owner_id);if(ve&&S&&e.email){const L=parseFloat(Q.amount);Q.type==="new_purchase"?await z1.notifyTransactionCreated(e.id,S.owner_name,L,ve.name,le.id,ve.id):Q.type==="pay_due"&&await z1.notifyPaymentMade(e.id,S.owner_name,L,ve.name,ve.id)}}await P(),C(!1)}catch(le){console.error("Error saving transaction:",le)}},T=Q=>{F(Q),C(!0),I(null)},j=async Q=>{if(confirm("Are you sure you want to delete this transaction?"))try{const{error:le}=await Ke.from("transactions").delete().eq("id",Q);if(le)throw le;await P(),I(null)}catch(le){console.error("Error deleting transaction:",le)}},K=[...t.map(Q=>({...Q,transactionType:"supplier"})),...n.map(Q=>({...Q,transactionType:"person"})),...i.map(Q=>({...Q,transactionType:"spend",type:Q.category}))].filter(Q=>{var S,L,D,R,X,de,me,Y;const le=((S=Q.description)==null?void 0:S.toLowerCase().includes(h.toLowerCase()))||Q.transactionType==="supplier"&&((D=(L=Q.supplier)==null?void 0:L.name)==null?void 0:D.toLowerCase().includes(h.toLowerCase()))||Q.transactionType==="person"&&((X=(R=Q.person)==null?void 0:R.name)==null?void 0:X.toLowerCase().includes(h.toLowerCase()))||Q.transactionType==="spend"&&"category"in Q&&((de=Q.category)==null?void 0:de.toLowerCase().includes(h.toLowerCase()))||Q.transactionType!=="spend"&&((Y=(me=Q.owner)==null?void 0:me.owner_name)==null?void 0:Y.toLowerCase().includes(h.toLowerCase())),ke=b==="spends"?Q.transactionType==="spend":Q.transactionType===b.slice(0,-1),ve=g==="all"||(b==="spends"?"category"in Q&&Q.category===g:Q.type===g);return le&&ke&&ve}).sort((Q,le)=>{const ke=Q.transactionType==="spend"?new Date(Q.date):new Date(Q.created_at);return(le.transactionType==="spend"?new Date(le.date):new Date(le.created_at)).getTime()-ke.getTime()}),he=(Q,le)=>{if(le==="spend")return l.jsx(en,{className:"h-4 w-4 text-green-600"});if(le==="person")switch(Q){case"Gives":return l.jsx(Ef,{className:"h-4 w-4 text-red-500"});case"Takes":return l.jsx(Af,{className:"h-4 w-4 text-green-500"});default:return l.jsx(ma,{className:"h-4 w-4 text-gray-500"})}else switch(Q){case"new_purchase":return l.jsx(Ef,{className:"h-4 w-4 text-red-500"});case"pay_due":case"settle_bill":return l.jsx(Af,{className:"h-4 w-4 text-green-500"});default:return l.jsx(ma,{className:"h-4 w-4 text-gray-500"})}},be=(Q,le)=>{if(le==="spend")return Q;if(le==="person")switch(Q){case"Gives":return"Gives";case"Takes":return"Takes";default:return Q}else switch(Q){case"new_purchase":return"Purchase";case"pay_due":return"Payment";case"settle_bill":return"Settlement";default:return Q}},we=Q=>new Date(Q).toLocaleDateString("en-IN",{month:"short",day:"numeric",year:"numeric"});return d?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):l.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[l.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Transactions"}),l.jsx("p",{className:"text-gray-600 text-sm",children:"Track all your business transactions"})]})}),l.jsx("div",{className:"border-b border-gray-200 mb-6",children:l.jsxs("nav",{className:"-mb-px flex space-x-8",children:[l.jsxs("button",{onClick:()=>E("suppliers"),className:`py-2 px-1 border-b-2 font-medium text-sm ${b==="suppliers"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[l.jsx(Wn,{className:"h-4 w-4 inline mr-2"}),"Suppliers"]}),l.jsxs("button",{onClick:()=>E("persons"),className:`py-2 px-1 border-b-2 font-medium text-sm ${b==="persons"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[l.jsx(qr,{className:"h-4 w-4 inline mr-2"}),"Persons"]}),l.jsxs("button",{onClick:()=>E("spends"),className:`py-2 px-1 border-b-2 font-medium text-sm ${b==="spends"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[l.jsx(en,{className:"h-4 w-4 inline mr-2"}),"Spends"]})]})}),l.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[l.jsxs("div",{className:"relative flex-1",children:[l.jsx(Xg,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),l.jsx("input",{type:"text",placeholder:"Search transactions...",value:h,onChange:Q=>x(Q.target.value),className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),l.jsxs("div",{className:"relative",children:[l.jsx(Zg,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),l.jsxs("select",{value:g,onChange:Q=>y(Q.target.value),className:"pl-10 pr-8 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 appearance-none bg-white",children:[l.jsx("option",{value:"all",children:"All Types"}),b==="suppliers"?l.jsxs(l.Fragment,{children:[l.jsx("option",{value:"new_purchase",children:"Purchases"}),l.jsx("option",{value:"pay_due",children:"Payments"})]}):b==="persons"?l.jsxs(l.Fragment,{children:[l.jsx("option",{value:"Gives",children:"Gives"}),l.jsx("option",{value:"Takes",children:"Takes"})]}):l.jsxs(l.Fragment,{children:[l.jsx("option",{value:"General",children:"General"}),l.jsx("option",{value:"Food & Dining",children:"Food & Dining"}),l.jsx("option",{value:"Transportation",children:"Transportation"}),l.jsx("option",{value:"Entertainment",children:"Entertainment"}),l.jsx("option",{value:"Shopping",children:"Shopping"}),l.jsx("option",{value:"Bills & Utilities",children:"Bills & Utilities"}),l.jsx("option",{value:"Healthcare",children:"Healthcare"}),l.jsx("option",{value:"Education",children:"Education"}),l.jsx("option",{value:"Travel",children:"Travel"}),l.jsx("option",{value:"Personal Care",children:"Personal Care"}),l.jsx("option",{value:"Home & Garden",children:"Home & Garden"}),l.jsx("option",{value:"Other",children:"Other"})]})]})]})]}),l.jsx("div",{className:"space-y-3",children:K.length===0?l.jsxs("div",{className:"text-center py-12",children:[l.jsx(ma,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500 text-lg",children:"No transactions found"}),l.jsx("p",{className:"text-gray-400 text-sm",children:h?"Try adjusting your search":"Add your first transaction to get started"})]}):K.map(Q=>{var le,ke,ve;return l.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:l.jsxs("div",{className:"flex items-start justify-between",children:[l.jsxs("div",{className:"flex items-start space-x-3 flex-1 min-w-0",children:[l.jsx("div",{className:"flex-shrink-0 mt-1",children:he(Q.type,Q.transactionType)}),l.jsxs("div",{className:"flex-1 min-w-0",children:[l.jsxs("div",{className:"flex items-center justify-between mb-1",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("h3",{className:"font-medium text-gray-900 truncate",children:Q.transactionType==="supplier"?(le=Q.supplier)==null?void 0:le.name:Q.transactionType==="person"?(ke=Q.person)==null?void 0:ke.name:Q.description}),l.jsx("span",{className:`px-2 py-1 text-xs rounded-full font-medium ${Q.transactionType==="supplier"?"bg-blue-100 text-blue-700":Q.transactionType==="person"?"bg-green-100 text-green-700":"bg-purple-100 text-purple-700"}`,children:Q.transactionType==="supplier"?"Supplier":Q.transactionType==="person"?"Person":"Spend"})]}),l.jsxs("p",{className:`font-semibold text-lg ${Q.transactionType==="supplier"&&Q.type==="new_purchase"||Q.transactionType==="person"&&Q.type==="Gives"?"text-red-600":"text-green-600"}`,children:[Q.transactionType==="supplier"&&Q.type==="new_purchase"||Q.transactionType==="person"&&Q.type==="Gives"?"+":"-","‚Çπ",Math.round(Q.amount).toLocaleString()]})]}),l.jsx("p",{className:"text-sm text-gray-600 mb-1",children:be(Q.type,Q.transactionType)}),Q.description&&l.jsx("p",{className:"text-sm text-gray-500 mb-2 line-clamp-2",children:Q.description}),l.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx(Po,{className:"h-3 w-3 mr-1"}),Q.transactionType==="spend"?we(Q.date):we(Q.created_at)]}),Q.transactionType!=="spend"&&((ve=Q.owner)==null?void 0:ve.owner_name)&&l.jsxs("span",{className:"text-blue-600 font-medium",children:["by ",Q.owner.owner_name]})]})]})]}),Q.transactionType==="supplier"&&l.jsxs("div",{className:"relative ml-3",children:[l.jsx("button",{onClick:()=>I(O===Q.id?null:Q.id),className:"p-1 hover:bg-gray-100 rounded-full transition-colors",children:l.jsx(Sd,{className:"h-4 w-4 text-gray-500"})}),O===Q.id&&l.jsxs("div",{className:"dropdown-menu absolute right-0 top-8 w-36 bg-white border border-gray-200 rounded-lg shadow-lg z-10",children:[l.jsxs("button",{onClick:()=>T(Q),className:"w-full px-3 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center rounded-t-lg",children:[l.jsx(yT,{className:"h-4 w-4 mr-2"}),"Edit"]}),l.jsxs("button",{onClick:()=>j(Q.id),className:"w-full px-3 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center rounded-b-lg",children:[l.jsx(Do,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]})},Q.id)})}),l.jsx(DD,{isOpen:A,onClose:()=>{C(!1),F(null)},onSubmit:H,suppliers:o,businessOwners:u,editingTransaction:N})]})};function Y3(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(r=Y3(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function Pn(){for(var e,t,r=0,n="",a=arguments.length;r<a;r++)(e=arguments[r])&&(t=Y3(e))&&(n&&(n+=" "),n+=t);return n}var Vh={},X3={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(X3);var wx={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(wx);var _x={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var n;return typeof r=="string"||typeof r=="symbol"?r:Object.is((n=r==null?void 0:r.valueOf)==null?void 0:n.call(r),-0)?"-0":String(r)}e.toKey=t})(_x);var Kh={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){const n=[],a=r.length;if(a===0)return n;let i=0,s="",o="",c=!1;for(r.charCodeAt(0)===46&&(n.push(""),i++);i<a;){const u=r[i];o?u==="\\"&&i+1<a?(i++,s+=r[i]):u===o?o="":s+=u:c?u==='"'||u==="'"?o=u:u==="]"?(c=!1,n.push(s),s=""):s+=u:u==="["?(c=!0,s&&(n.push(s),s="")):u==="."?s&&(n.push(s),s=""):s+=u,i++}return s&&n.push(s),n}e.toPath=t})(Kh);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=X3,r=wx,n=_x,a=Kh;function i(o,c,u){if(o==null)return u;switch(typeof c){case"string":{if(t.isUnsafeProperty(c))return u;const f=o[c];return f===void 0?r.isDeepKey(c)?i(o,a.toPath(c),u):u:f}case"number":case"symbol":{typeof c=="number"&&(c=n.toKey(c));const f=o[c];return f===void 0?u:f}default:{if(Array.isArray(c))return s(o,c,u);if(Object.is(c==null?void 0:c.valueOf(),-0)?c="-0":c=String(c),t.isUnsafeProperty(c))return u;const f=o[c];return f===void 0?u:f}}}function s(o,c,u){if(c.length===0)return u;let f=o;for(let d=0;d<c.length;d++){if(f==null||t.isUnsafeProperty(c[d]))return u;f=f[c[d]]}return f===void 0?u:f}e.get=i})(Vh);var MD=Vh.get;const Gc=zo(MD);var Z3={exports:{}},br={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Nx=Symbol.for("react.transitional.element"),Sx=Symbol.for("react.portal"),Yh=Symbol.for("react.fragment"),Xh=Symbol.for("react.strict_mode"),Zh=Symbol.for("react.profiler"),Jh=Symbol.for("react.consumer"),Qh=Symbol.for("react.context"),ep=Symbol.for("react.forward_ref"),tp=Symbol.for("react.suspense"),rp=Symbol.for("react.suspense_list"),np=Symbol.for("react.memo"),ap=Symbol.for("react.lazy"),RD=Symbol.for("react.view_transition"),BD=Symbol.for("react.client.reference");function xi(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case Nx:switch(e=e.type,e){case Yh:case Zh:case Xh:case tp:case rp:case RD:return e;default:switch(e=e&&e.$$typeof,e){case Qh:case ep:case ap:case np:return e;case Jh:return e;default:return t}}case Sx:return t}}}br.ContextConsumer=Jh;br.ContextProvider=Qh;br.Element=Nx;br.ForwardRef=ep;br.Fragment=Yh;br.Lazy=ap;br.Memo=np;br.Portal=Sx;br.Profiler=Zh;br.StrictMode=Xh;br.Suspense=tp;br.SuspenseList=rp;br.isContextConsumer=function(e){return xi(e)===Jh};br.isContextProvider=function(e){return xi(e)===Qh};br.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===Nx};br.isForwardRef=function(e){return xi(e)===ep};br.isFragment=function(e){return xi(e)===Yh};br.isLazy=function(e){return xi(e)===ap};br.isMemo=function(e){return xi(e)===np};br.isPortal=function(e){return xi(e)===Sx};br.isProfiler=function(e){return xi(e)===Zh};br.isStrictMode=function(e){return xi(e)===Xh};br.isSuspense=function(e){return xi(e)===tp};br.isSuspenseList=function(e){return xi(e)===rp};br.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===Yh||e===Zh||e===Xh||e===tp||e===rp||typeof e=="object"&&e!==null&&(e.$$typeof===ap||e.$$typeof===np||e.$$typeof===Qh||e.$$typeof===Jh||e.$$typeof===ep||e.$$typeof===BD||e.getModuleId!==void 0)};br.typeOf=xi;Z3.exports=br;var UD=Z3.exports,Ha=e=>e===0?0:e>0?1:-1,Ii=e=>typeof e=="number"&&e!=+e,lf=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,Vt=e=>(typeof e=="number"||e instanceof Number)&&!Ii(e),Bs=e=>Vt(e)||typeof e=="string",$D=0,Xd=e=>{var t=++$D;return"".concat(e||"").concat(t)},ss=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Vt(t)&&typeof t!="string")return n;var i;if(lf(t)){if(r==null)return n;var s=t.indexOf("%");i=r*parseFloat(t.slice(0,s))/100}else i=+t;return Ii(i)&&(i=n),a&&r!=null&&i>r&&(i=r),i},J3=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[e[n]])r[e[n]]=!0;else return!0;return!1},lb=(e,t)=>Vt(e)&&Vt(t)?r=>e+r*(t-e):()=>t;function zD(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):Gc(n,t))===r)}var Dl=e=>e===null||typeof e>"u",i0=e=>Dl(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),qD=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function Ax(e){if(typeof e!="string")return!1;var t=qD;return t.includes(e)}var WD=["viewBox","children"],cb=["points","pathLength"],Mm={svg:WD,polygon:cb,polyline:cb},HD=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(M.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(a=>{Ax(a)&&(n[a]=i=>r[a](r,i))}),n},GD=(e,t,r)=>n=>(e(t,r,n),null),VD=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(a=>{var i=e[a];Ax(a)&&typeof i=="function"&&(n||(n={}),n[a]=GD(i,t,r))}),n},KD=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function Q3(e){if(typeof e!="string")return!1;var t=KD;return t.includes(e)}function ip(e){var t=Object.entries(e).filter(r=>{var[n]=r;return Q3(n)});return Object.fromEntries(t)}var ub=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",fb=null,Rm=null,eN=e=>{if(e===fb&&Array.isArray(Rm))return Rm;var t=[];return M.Children.forEach(e,r=>{Dl(r)||(UD.isFragment(r)?t=t.concat(eN(r.props.children)):t.push(r))}),Rm=t,fb=e,t};function tN(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(a=>ub(a)):n=[ub(t)],eN(e).forEach(a=>{var i=Gc(a,"type.displayName")||Gc(a,"type.name");n.indexOf(i)!==-1&&r.push(a)}),r}var YD=(e,t,r,n)=>{var a;if(typeof t=="symbol"||typeof t=="number")return!0;var i=(a=n&&(Mm==null?void 0:Mm[n]))!==null&&a!==void 0?a:[],s=t.startsWith("data-"),o=typeof e!="function"&&(!!n&&i.includes(t)||Q3(t)),c=!!r&&Ax(t);return s||o||c},Xa=(e,t,r)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(M.isValidElement(e)&&(n=e.props),typeof n!="object"&&typeof n!="function")return null;var a={};return Object.keys(n).forEach(i=>{var s;YD((s=n)===null||s===void 0?void 0:s[i],i,t,r)&&(a[i]=n[i])}),a},XD=["children","width","height","viewBox","className","style","title","desc"];function V1(){return V1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},V1.apply(null,arguments)}function ZD(e,t){if(e==null)return{};var r,n,a=JD(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function JD(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var rN=M.forwardRef((e,t)=>{var{children:r,width:n,height:a,viewBox:i,className:s,style:o,title:c,desc:u}=e,f=ZD(e,XD),d=i||{width:n,height:a,x:0,y:0},p=Pn("recharts-surface",s);return M.createElement("svg",V1({},Xa(f,!0,"svg"),{className:p,width:n,height:a,style:o,viewBox:"".concat(d.x," ").concat(d.y," ").concat(d.width," ").concat(d.height),ref:t}),M.createElement("title",null,c),M.createElement("desc",null,u),r)}),QD=["children","className"];function K1(){return K1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},K1.apply(null,arguments)}function eI(e,t){if(e==null)return{};var r,n,a=tI(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function tI(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Vc=M.forwardRef((e,t)=>{var{children:r,className:n}=e,a=eI(e,QD),i=Pn("recharts-layer",n);return M.createElement("g",K1({className:i},Xa(a,!0),{ref:t}),r)}),rI=M.createContext(null);function Ar(e){return function(){return e}}const nN=Math.cos,Zd=Math.sin,Bi=Math.sqrt,Jd=Math.PI,sp=2*Jd,Y1=Math.PI,X1=2*Y1,ol=1e-6,nI=X1-ol;function aN(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function aI(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return aN;const r=10**t;return function(n){this._+=n[0];for(let a=1,i=n.length;a<i;++a)this._+=Math.round(arguments[a]*r)/r+n[a]}}class iI{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?aN:aI(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,a){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+a}`}bezierCurveTo(t,r,n,a,i,s){this._append`C${+t},${+r},${+n},${+a},${this._x1=+i},${this._y1=+s}`}arcTo(t,r,n,a,i){if(t=+t,r=+r,n=+n,a=+a,i=+i,i<0)throw new Error(`negative radius: ${i}`);let s=this._x1,o=this._y1,c=n-t,u=a-r,f=s-t,d=o-r,p=f*f+d*d;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(p>ol)if(!(Math.abs(d*c-u*f)>ol)||!i)this._append`L${this._x1=t},${this._y1=r}`;else{let h=n-s,x=a-o,g=c*c+u*u,y=h*h+x*x,b=Math.sqrt(g),E=Math.sqrt(p),A=i*Math.tan((Y1-Math.acos((g+p-y)/(2*b*E)))/2),C=A/E,N=A/b;Math.abs(C-1)>ol&&this._append`L${t+C*f},${r+C*d}`,this._append`A${i},${i},0,0,${+(d*h>f*x)},${this._x1=t+N*c},${this._y1=r+N*u}`}}arc(t,r,n,a,i,s){if(t=+t,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(a),c=n*Math.sin(a),u=t+o,f=r+c,d=1^s,p=s?a-i:i-a;this._x1===null?this._append`M${u},${f}`:(Math.abs(this._x1-u)>ol||Math.abs(this._y1-f)>ol)&&this._append`L${u},${f}`,n&&(p<0&&(p=p%X1+X1),p>nI?this._append`A${n},${n},0,1,${d},${t-o},${r-c}A${n},${n},0,1,${d},${this._x1=u},${this._y1=f}`:p>ol&&this._append`A${n},${n},0,${+(p>=Y1)},${d},${this._x1=t+n*Math.cos(i)},${this._y1=r+n*Math.sin(i)}`)}rect(t,r,n,a){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+a}h${-n}Z`}toString(){return this._}}function Ex(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new iI(t)}function jx(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function iN(e){this._context=e}iN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function op(e){return new iN(e)}function sN(e){return e[0]}function oN(e){return e[1]}function lN(e,t){var r=Ar(!0),n=null,a=op,i=null,s=Ex(o);e=typeof e=="function"?e:e===void 0?sN:Ar(e),t=typeof t=="function"?t:t===void 0?oN:Ar(t);function o(c){var u,f=(c=jx(c)).length,d,p=!1,h;for(n==null&&(i=a(h=s())),u=0;u<=f;++u)!(u<f&&r(d=c[u],u,c))===p&&((p=!p)?i.lineStart():i.lineEnd()),p&&i.point(+e(d,u,c),+t(d,u,c));if(h)return i=null,h+""||null}return o.x=function(c){return arguments.length?(e=typeof c=="function"?c:Ar(+c),o):e},o.y=function(c){return arguments.length?(t=typeof c=="function"?c:Ar(+c),o):t},o.defined=function(c){return arguments.length?(r=typeof c=="function"?c:Ar(!!c),o):r},o.curve=function(c){return arguments.length?(a=c,n!=null&&(i=a(n)),o):a},o.context=function(c){return arguments.length?(c==null?n=i=null:i=a(n=c),o):n},o}function td(e,t,r){var n=null,a=Ar(!0),i=null,s=op,o=null,c=Ex(u);e=typeof e=="function"?e:e===void 0?sN:Ar(+e),t=typeof t=="function"?t:Ar(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?oN:Ar(+r);function u(d){var p,h,x,g=(d=jx(d)).length,y,b=!1,E,A=new Array(g),C=new Array(g);for(i==null&&(o=s(E=c())),p=0;p<=g;++p){if(!(p<g&&a(y=d[p],p,d))===b)if(b=!b)h=p,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),x=p-1;x>=h;--x)o.point(A[x],C[x]);o.lineEnd(),o.areaEnd()}b&&(A[p]=+e(y,p,d),C[p]=+t(y,p,d),o.point(n?+n(y,p,d):A[p],r?+r(y,p,d):C[p]))}if(E)return o=null,E+""||null}function f(){return lN().defined(a).curve(s).context(i)}return u.x=function(d){return arguments.length?(e=typeof d=="function"?d:Ar(+d),n=null,u):e},u.x0=function(d){return arguments.length?(e=typeof d=="function"?d:Ar(+d),u):e},u.x1=function(d){return arguments.length?(n=d==null?null:typeof d=="function"?d:Ar(+d),u):n},u.y=function(d){return arguments.length?(t=typeof d=="function"?d:Ar(+d),r=null,u):t},u.y0=function(d){return arguments.length?(t=typeof d=="function"?d:Ar(+d),u):t},u.y1=function(d){return arguments.length?(r=d==null?null:typeof d=="function"?d:Ar(+d),u):r},u.lineX0=u.lineY0=function(){return f().x(e).y(t)},u.lineY1=function(){return f().x(e).y(r)},u.lineX1=function(){return f().x(n).y(t)},u.defined=function(d){return arguments.length?(a=typeof d=="function"?d:Ar(!!d),u):a},u.curve=function(d){return arguments.length?(s=d,i!=null&&(o=s(i)),u):s},u.context=function(d){return arguments.length?(d==null?i=o=null:o=s(i=d),u):i},u}class cN{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function sI(e){return new cN(e,!0)}function oI(e){return new cN(e,!1)}const Tx={draw(e,t){const r=Bi(t/Jd);e.moveTo(r,0),e.arc(0,0,r,0,sp)}},lI={draw(e,t){const r=Bi(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},uN=Bi(1/3),cI=uN*2,uI={draw(e,t){const r=Bi(t/cI),n=r*uN;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},fI={draw(e,t){const r=Bi(t),n=-r/2;e.rect(n,n,r,r)}},dI=.8908130915292852,fN=Zd(Jd/10)/Zd(7*Jd/10),hI=Zd(sp/10)*fN,pI=-nN(sp/10)*fN,mI={draw(e,t){const r=Bi(t*dI),n=hI*r,a=pI*r;e.moveTo(0,-r),e.lineTo(n,a);for(let i=1;i<5;++i){const s=sp*i/5,o=nN(s),c=Zd(s);e.lineTo(c*r,-o*r),e.lineTo(o*n-c*a,c*n+o*a)}e.closePath()}},Bm=Bi(3),gI={draw(e,t){const r=-Bi(t/(Bm*3));e.moveTo(0,r*2),e.lineTo(-Bm*r,-r),e.lineTo(Bm*r,-r),e.closePath()}},ai=-.5,ii=Bi(3)/2,Z1=1/Bi(12),xI=(Z1/2+1)*3,vI={draw(e,t){const r=Bi(t/xI),n=r/2,a=r*Z1,i=n,s=r*Z1+r,o=-i,c=s;e.moveTo(n,a),e.lineTo(i,s),e.lineTo(o,c),e.lineTo(ai*n-ii*a,ii*n+ai*a),e.lineTo(ai*i-ii*s,ii*i+ai*s),e.lineTo(ai*o-ii*c,ii*o+ai*c),e.lineTo(ai*n+ii*a,ai*a-ii*n),e.lineTo(ai*i+ii*s,ai*s-ii*i),e.lineTo(ai*o+ii*c,ai*c-ii*o),e.closePath()}};function yI(e,t){let r=null,n=Ex(a);e=typeof e=="function"?e:Ar(e||Tx),t=typeof t=="function"?t:Ar(t===void 0?64:+t);function a(){let i;if(r||(r=i=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),i)return r=null,i+""||null}return a.type=function(i){return arguments.length?(e=typeof i=="function"?i:Ar(i),a):e},a.size=function(i){return arguments.length?(t=typeof i=="function"?i:Ar(+i),a):t},a.context=function(i){return arguments.length?(r=i??null,a):r},a}function Qd(){}function eh(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function dN(e){this._context=e}dN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:eh(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:eh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function bI(e){return new dN(e)}function hN(e){this._context=e}hN.prototype={areaStart:Qd,areaEnd:Qd,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:eh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function wI(e){return new hN(e)}function pN(e){this._context=e}pN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:eh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function _I(e){return new pN(e)}function mN(e){this._context=e}mN.prototype={areaStart:Qd,areaEnd:Qd,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function NI(e){return new mN(e)}function db(e){return e<0?-1:1}function hb(e,t,r){var n=e._x1-e._x0,a=t-e._x1,i=(e._y1-e._y0)/(n||a<0&&-0),s=(r-e._y1)/(a||n<0&&-0),o=(i*a+s*n)/(n+a);return(db(i)+db(s))*Math.min(Math.abs(i),Math.abs(s),.5*Math.abs(o))||0}function pb(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function Um(e,t,r){var n=e._x0,a=e._y0,i=e._x1,s=e._y1,o=(i-n)/3;e._context.bezierCurveTo(n+o,a+o*t,i-o,s-o*r,i,s)}function th(e){this._context=e}th.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Um(this,this._t0,pb(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Um(this,pb(this,r=hb(this,e,t)),r);break;default:Um(this,this._t0,r=hb(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function gN(e){this._context=new xN(e)}(gN.prototype=Object.create(th.prototype)).point=function(e,t){th.prototype.point.call(this,t,e)};function xN(e){this._context=e}xN.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,a,i){this._context.bezierCurveTo(t,e,n,r,i,a)}};function SI(e){return new th(e)}function AI(e){return new gN(e)}function vN(e){this._context=e}vN.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=mb(e),a=mb(t),i=0,s=1;s<r;++i,++s)this._context.bezierCurveTo(n[0][i],a[0][i],n[1][i],a[1][i],e[s],t[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function mb(e){var t,r=e.length-1,n,a=new Array(r),i=new Array(r),s=new Array(r);for(a[0]=0,i[0]=2,s[0]=e[0]+2*e[1],t=1;t<r-1;++t)a[t]=1,i[t]=4,s[t]=4*e[t]+2*e[t+1];for(a[r-1]=2,i[r-1]=7,s[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=a[t]/i[t-1],i[t]-=n,s[t]-=n*s[t-1];for(a[r-1]=s[r-1]/i[r-1],t=r-2;t>=0;--t)a[t]=(s[t]-a[t+1])/i[t];for(i[r-1]=(e[r]+a[r-1])/2,t=0;t<r-1;++t)i[t]=2*e[t+1]-a[t+1];return[a,i]}function EI(e){return new vN(e)}function lp(e,t){this._context=e,this._t=t}lp.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function jI(e){return new lp(e,.5)}function TI(e){return new lp(e,0)}function PI(e){return new lp(e,1)}function Kc(e,t){if((s=e.length)>1)for(var r=1,n,a,i=e[t[0]],s,o=i.length;r<s;++r)for(a=i,i=e[t[r]],n=0;n<o;++n)i[n][1]+=i[n][0]=isNaN(a[n][1])?a[n][0]:a[n][1]}function J1(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function kI(e,t){return e[t]}function CI(e){const t=[];return t.key=e,t}function OI(){var e=Ar([]),t=J1,r=Kc,n=kI;function a(i){var s=Array.from(e.apply(this,arguments),CI),o,c=s.length,u=-1,f;for(const d of i)for(o=0,++u;o<c;++o)(s[o][u]=[0,+n(d,s[o].key,u,i)]).data=d;for(o=0,f=jx(t(s));o<c;++o)s[f[o]].index=o;return r(s,f),s}return a.keys=function(i){return arguments.length?(e=typeof i=="function"?i:Ar(Array.from(i)),a):e},a.value=function(i){return arguments.length?(n=typeof i=="function"?i:Ar(+i),a):n},a.order=function(i){return arguments.length?(t=i==null?J1:typeof i=="function"?i:Ar(Array.from(i)),a):t},a.offset=function(i){return arguments.length?(r=i??Kc,a):r},a}function LI(e,t){if((n=e.length)>0){for(var r,n,a=0,i=e[0].length,s;a<i;++a){for(s=r=0;r<n;++r)s+=e[r][a][1]||0;if(s)for(r=0;r<n;++r)e[r][a][1]/=s}Kc(e,t)}}function FI(e,t){if((a=e.length)>0){for(var r=0,n=e[t[0]],a,i=n.length;r<i;++r){for(var s=0,o=0;s<a;++s)o+=e[s][r][1]||0;n[r][1]+=n[r][0]=-o/2}Kc(e,t)}}function DI(e,t){if(!(!((s=e.length)>0)||!((i=(a=e[t[0]]).length)>0))){for(var r=0,n=1,a,i,s;n<i;++n){for(var o=0,c=0,u=0;o<s;++o){for(var f=e[t[o]],d=f[n][1]||0,p=f[n-1][1]||0,h=(d-p)/2,x=0;x<o;++x){var g=e[t[x]],y=g[n][1]||0,b=g[n-1][1]||0;h+=y-b}c+=d,u+=h*d}a[n-1][1]+=a[n-1][0]=r,c&&(r-=u/c)}a[n-1][1]+=a[n-1][0]=r,Kc(e,t)}}var II=["type","size","sizeType"];function Q1(){return Q1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Q1.apply(null,arguments)}function gb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function xb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gb(Object(r),!0).forEach(function(n){MI(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function MI(e,t,r){return(t=RI(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function RI(e){var t=BI(e,"string");return typeof t=="symbol"?t:t+""}function BI(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function UI(e,t){if(e==null)return{};var r,n,a=$I(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function $I(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var yN={symbolCircle:Tx,symbolCross:lI,symbolDiamond:uI,symbolSquare:fI,symbolStar:mI,symbolTriangle:gI,symbolWye:vI},zI=Math.PI/180,qI=e=>{var t="symbol".concat(i0(e));return yN[t]||Tx},WI=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*zI;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},HI=(e,t)=>{yN["symbol".concat(i0(e))]=t},bN=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,a=UI(e,II),i=xb(xb({},a),{},{type:t,size:r,sizeType:n}),s=()=>{var d=qI(t),p=yI().type(d).size(WI(r,n,t));return p()},{className:o,cx:c,cy:u}=i,f=Xa(i,!0);return c===+c&&u===+u&&r===+r?M.createElement("path",Q1({},f,{className:Pn("recharts-symbols",o),transform:"translate(".concat(c,", ").concat(u,")"),d:s()})):null};bN.registerSymbol=HI;var wN={},_N={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const a=new Map;for(let i=0;i<r.length;i++){const s=r[i],o=n(s);a.has(o)||a.set(o,s)}return Array.from(a.values())}e.uniqBy=t})(_N);var Px={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(Px);var NN={},kx={},SN={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(SN);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=SN;function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r})(kx);var AN={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(AN);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=kx,r=AN;function n(a){return r.isObjectLike(a)&&t.isArrayLike(a)}e.isArrayLikeObject=n})(NN);var EN={},jN={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Vh;function r(n){return function(a){return t.get(a,n)}}e.property=r})(jN);var TN={},$m={},zm={},Cx={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(Cx);var Ox={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(Ox);var cp={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.eq=t})(cp);var vb;function GI(){return vb||(vb=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Lx(),r=Cx,n=Ox,a=cp;function i(d,p,h){return typeof h!="function"?t.isMatch(d,p):s(d,p,function x(g,y,b,E,A,C){const N=h(g,y,b,E,A,C);return N!==void 0?!!N:s(g,y,x,C)},new Map)}function s(d,p,h,x){if(p===d)return!0;switch(typeof p){case"object":return o(d,p,h,x);case"function":return Object.keys(p).length>0?s(d,{...p},h,x):a.eq(d,p);default:return r.isObject(d)?typeof p=="string"?p==="":!0:a.eq(d,p)}}function o(d,p,h,x){if(p==null)return!0;if(Array.isArray(p))return u(d,p,h,x);if(p instanceof Map)return c(d,p,h,x);if(p instanceof Set)return f(d,p,h,x);const g=Object.keys(p);if(d==null)return g.length===0;if(g.length===0)return!0;if(x&&x.has(p))return x.get(p)===d;x&&x.set(p,d);try{for(let y=0;y<g.length;y++){const b=g[y];if(!n.isPrimitive(d)&&!(b in d)||p[b]===void 0&&d[b]!==void 0||p[b]===null&&d[b]!==null||!h(d[b],p[b],b,d,p,x))return!1}return!0}finally{x&&x.delete(p)}}function c(d,p,h,x){if(p.size===0)return!0;if(!(d instanceof Map))return!1;for(const[g,y]of p.entries()){const b=d.get(g);if(h(b,y,g,d,p,x)===!1)return!1}return!0}function u(d,p,h,x){if(p.length===0)return!0;if(!Array.isArray(d))return!1;const g=new Set;for(let y=0;y<p.length;y++){const b=p[y];let E=!1;for(let A=0;A<d.length;A++){if(g.has(A))continue;const C=d[A];let N=!1;if(h(C,b,y,d,p,x)&&(N=!0),N){g.add(A),E=!0;break}}if(!E)return!1}return!0}function f(d,p,h,x){return p.size===0?!0:d instanceof Set?u([...d],[...p],h,x):!1}e.isMatchWith=i,e.isSetMatch=f}(zm)),zm}var yb;function Lx(){return yb||(yb=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=GI();function r(n,a){return t.isMatchWith(n,a,()=>{})}e.isMatch=r}($m)),$m}var PN={},Fx={},Dx={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t})(Dx);var up={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(up);var fp={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",a="[object Boolean]",i="[object Arguments]",s="[object Symbol]",o="[object Date]",c="[object Map]",u="[object Set]",f="[object Array]",d="[object Function]",p="[object ArrayBuffer]",h="[object Object]",x="[object Error]",g="[object DataView]",y="[object Uint8Array]",b="[object Uint8ClampedArray]",E="[object Uint16Array]",A="[object Uint32Array]",C="[object BigUint64Array]",N="[object Int8Array]",F="[object Int16Array]",O="[object Int32Array]",I="[object BigInt64Array]",P="[object Float32Array]",H="[object Float64Array]";e.argumentsTag=i,e.arrayBufferTag=p,e.arrayTag=f,e.bigInt64ArrayTag=I,e.bigUint64ArrayTag=C,e.booleanTag=a,e.dataViewTag=g,e.dateTag=o,e.errorTag=x,e.float32ArrayTag=P,e.float64ArrayTag=H,e.functionTag=d,e.int16ArrayTag=F,e.int32ArrayTag=O,e.int8ArrayTag=N,e.mapTag=c,e.numberTag=n,e.objectTag=h,e.regexpTag=t,e.setTag=u,e.stringTag=r,e.symbolTag=s,e.uint16ArrayTag=E,e.uint32ArrayTag=A,e.uint8ArrayTag=y,e.uint8ClampedArrayTag=b})(fp);var kN={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})(kN);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Dx,r=up,n=fp,a=Ox,i=kN;function s(f,d){return o(f,void 0,f,new Map,d)}function o(f,d,p,h=new Map,x=void 0){const g=x==null?void 0:x(f,d,p,h);if(g!==void 0)return g;if(a.isPrimitive(f))return f;if(h.has(f))return h.get(f);if(Array.isArray(f)){const y=new Array(f.length);h.set(f,y);for(let b=0;b<f.length;b++)y[b]=o(f[b],b,p,h,x);return Object.hasOwn(f,"index")&&(y.index=f.index),Object.hasOwn(f,"input")&&(y.input=f.input),y}if(f instanceof Date)return new Date(f.getTime());if(f instanceof RegExp){const y=new RegExp(f.source,f.flags);return y.lastIndex=f.lastIndex,y}if(f instanceof Map){const y=new Map;h.set(f,y);for(const[b,E]of f)y.set(b,o(E,b,p,h,x));return y}if(f instanceof Set){const y=new Set;h.set(f,y);for(const b of f)y.add(o(b,void 0,p,h,x));return y}if(typeof Buffer<"u"&&Buffer.isBuffer(f))return f.subarray();if(i.isTypedArray(f)){const y=new(Object.getPrototypeOf(f)).constructor(f.length);h.set(f,y);for(let b=0;b<f.length;b++)y[b]=o(f[b],b,p,h,x);return y}if(f instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&f instanceof SharedArrayBuffer)return f.slice(0);if(f instanceof DataView){const y=new DataView(f.buffer.slice(0),f.byteOffset,f.byteLength);return h.set(f,y),c(y,f,p,h,x),y}if(typeof File<"u"&&f instanceof File){const y=new File([f],f.name,{type:f.type});return h.set(f,y),c(y,f,p,h,x),y}if(f instanceof Blob){const y=new Blob([f],{type:f.type});return h.set(f,y),c(y,f,p,h,x),y}if(f instanceof Error){const y=new f.constructor;return h.set(f,y),y.message=f.message,y.name=f.name,y.stack=f.stack,y.cause=f.cause,c(y,f,p,h,x),y}if(typeof f=="object"&&u(f)){const y=Object.create(Object.getPrototypeOf(f));return h.set(f,y),c(y,f,p,h,x),y}return f}function c(f,d,p=f,h,x){const g=[...Object.keys(d),...t.getSymbols(d)];for(let y=0;y<g.length;y++){const b=g[y],E=Object.getOwnPropertyDescriptor(f,b);(E==null||E.writable)&&(f[b]=o(d[b],b,p,h,x))}}function u(f){switch(r.getTag(f)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=s,e.cloneDeepWithImpl=o,e.copyProperties=c})(Fx);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Fx;function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r})(PN);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Lx(),r=PN;function n(a){return a=r.cloneDeep(a),i=>t.isMatch(i,a)}e.matches=n})(TN);var CN={},ON={},LN={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Fx,r=fp;function n(a,i){return t.cloneDeepWith(a,(s,o,c,u)=>{const f=i==null?void 0:i(s,o,c,u);if(f!==void 0)return f;if(typeof a=="object")switch(Object.prototype.toString.call(a)){case r.numberTag:case r.stringTag:case r.booleanTag:{const d=new a.constructor(a==null?void 0:a.valueOf());return t.copyProperties(d,a),d}case r.argumentsTag:{const d={};return t.copyProperties(d,a),d.length=a.length,d[Symbol.iterator]=a[Symbol.iterator],d}default:return}})}e.cloneDeepWith=n})(LN);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=LN;function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r})(ON);var FN={},Ix={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,a=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<a;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r})(Ix);var DN={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=up;function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r})(DN);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=wx,r=Ix,n=DN,a=Kh;function i(s,o){let c;if(Array.isArray(o)?c=o:typeof o=="string"&&t.isDeepKey(o)&&(s==null?void 0:s[o])==null?c=a.toPath(o):c=[o],c.length===0)return!1;let u=s;for(let f=0;f<c.length;f++){const d=c[f];if((u==null||!Object.hasOwn(u,d))&&!((Array.isArray(u)||n.isArguments(u))&&r.isIndex(d)&&d<u.length))return!1;u=u[d]}return!0}e.has=i})(FN);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Lx(),r=_x,n=ON,a=Vh,i=FN;function s(o,c){switch(typeof o){case"object":{Object.is(o==null?void 0:o.valueOf(),-0)&&(o="-0");break}case"number":{o=r.toKey(o);break}}return c=n.cloneDeep(c),function(u){const f=a.get(u,o);return f===void 0?i.has(u,o):c===void 0?f===void 0:t.isMatch(f,c)}}e.matchesProperty=s})(CN);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Px,r=jN,n=TN,a=CN;function i(s){if(s==null)return t.identity;switch(typeof s){case"function":return s;case"object":return Array.isArray(s)&&s.length===2?a.matchesProperty(s[0],s[1]):n.matches(s);case"string":case"symbol":case"number":return r.property(s)}}e.iteratee=i})(EN);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=_N,r=Px,n=NN,a=EN;function i(s,o=r.identity){return n.isArrayLikeObject(s)?t.uniqBy(Array.from(s),a.iteratee(o)):[]}e.uniqBy=i})(wN);var VI=wN.uniqBy;const bb=zo(VI);function KI(e,t,r){return t===!0?bb(e,r):typeof t=="function"?bb(e,t):e}var IN={exports:{}},MN={},RN={exports:{}},BN={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yc=M;function YI(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var XI=typeof Object.is=="function"?Object.is:YI,ZI=Yc.useState,JI=Yc.useEffect,QI=Yc.useLayoutEffect,eM=Yc.useDebugValue;function tM(e,t){var r=t(),n=ZI({inst:{value:r,getSnapshot:t}}),a=n[0].inst,i=n[1];return QI(function(){a.value=r,a.getSnapshot=t,qm(a)&&i({inst:a})},[e,r,t]),JI(function(){return qm(a)&&i({inst:a}),e(function(){qm(a)&&i({inst:a})})},[e]),eM(r),r}function qm(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!XI(e,r)}catch{return!0}}function rM(e,t){return t()}var nM=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?rM:tM;BN.useSyncExternalStore=Yc.useSyncExternalStore!==void 0?Yc.useSyncExternalStore:nM;RN.exports=BN;var aM=RN.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dp=M,iM=aM;function sM(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var oM=typeof Object.is=="function"?Object.is:sM,lM=iM.useSyncExternalStore,cM=dp.useRef,uM=dp.useEffect,fM=dp.useMemo,dM=dp.useDebugValue;MN.useSyncExternalStoreWithSelector=function(e,t,r,n,a){var i=cM(null);if(i.current===null){var s={hasValue:!1,value:null};i.current=s}else s=i.current;i=fM(function(){function c(h){if(!u){if(u=!0,f=h,h=n(h),a!==void 0&&s.hasValue){var x=s.value;if(a(x,h))return d=x}return d=h}if(x=d,oM(f,h))return x;var g=n(h);return a!==void 0&&a(x,g)?(f=h,x):(f=h,d=g)}var u=!1,f,d,p=r===void 0?null:r;return[function(){return c(t())},p===null?void 0:function(){return c(p())}]},[t,r,n,a]);var o=lM(e,i[0],i[1]);return uM(function(){s.hasValue=!0,s.value=o},[o]),dM(o),o};IN.exports=MN;var hM=IN.exports,Mx=M.createContext(null),pM=e=>e,ia=()=>{var e=M.useContext(Mx);return e?e.store.dispatch:pM},Ed=()=>{},mM=()=>Ed,gM=(e,t)=>e===t;function qt(e){var t=M.useContext(Mx);return hM.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:mM,t?t.store.getState:Ed,t?t.store.getState:Ed,t?e:Ed,gM)}function xM(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function vM(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function yM(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var wb=e=>Array.isArray(e)?e:[e];function bM(e){const t=Array.isArray(e[0])?e[0]:e;return yM(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function wM(e,t){const r=[],{length:n}=e;for(let a=0;a<n;a++)r.push(e[a].apply(null,t));return r}var _M=class{constructor(e){this.value=e}deref(){return this.value}},NM=typeof WeakRef<"u"?WeakRef:_M,SM=0,_b=1;function rd(){return{s:SM,v:void 0,o:null,p:null}}function UN(e,t={}){let r=rd();const{resultEqualityCheck:n}=t;let a,i=0;function s(){var d;let o=r;const{length:c}=arguments;for(let p=0,h=c;p<h;p++){const x=arguments[p];if(typeof x=="function"||typeof x=="object"&&x!==null){let g=o.o;g===null&&(o.o=g=new WeakMap);const y=g.get(x);y===void 0?(o=rd(),g.set(x,o)):o=y}else{let g=o.p;g===null&&(o.p=g=new Map);const y=g.get(x);y===void 0?(o=rd(),g.set(x,o)):o=y}}const u=o;let f;if(o.s===_b)f=o.v;else if(f=e.apply(null,arguments),i++,n){const p=((d=a==null?void 0:a.deref)==null?void 0:d.call(a))??a;p!=null&&n(p,f)&&(f=p,i!==0&&i--),a=typeof f=="object"&&f!==null||typeof f=="function"?new NM(f):f}return u.s=_b,u.v=f,f}return s.clearCache=()=>{r=rd(),s.resetResultsCount()},s.resultsCount=()=>i,s.resetResultsCount=()=>{i=0},s}function AM(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...a)=>{let i=0,s=0,o,c={},u=a.pop();typeof u=="object"&&(c=u,u=a.pop()),xM(u,`createSelector expects an output function after the inputs, but received: [${typeof u}]`);const f={...r,...c},{memoize:d,memoizeOptions:p=[],argsMemoize:h=UN,argsMemoizeOptions:x=[],devModeChecks:g={}}=f,y=wb(p),b=wb(x),E=bM(a),A=d(function(){return i++,u.apply(null,arguments)},...y),C=h(function(){s++;const F=wM(E,arguments);return o=A.apply(null,F),o},...b);return Object.assign(C,{resultFunc:u,memoizedResultFunc:A,dependencies:E,dependencyRecomputations:()=>s,resetDependencyRecomputations:()=>{s=0},lastResult:()=>o,recomputations:()=>i,resetRecomputations:()=>{i=0},memoize:d,argsMemoize:h})};return Object.assign(n,{withTypes:()=>n}),n}var Oe=AM(UN),EM=Object.assign((e,t=Oe)=>{vM(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(i=>e[i]);return t(n,(...i)=>i.reduce((s,o,c)=>(s[r[c]]=o,s),{}))},{withTypes:()=>EM}),$N={},zN={},qN={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,a,i)=>{if(n!==a){const s=t(n),o=t(a);if(s===o&&s===0){if(n<a)return i==="desc"?1:-1;if(n>a)return i==="desc"?-1:1}return i==="desc"?o-s:s-o}return 0};e.compareValues=r})(qN);var WN={},Rx={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(Rx);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Rx,r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function a(i,s){return Array.isArray(i)?!1:typeof i=="number"||typeof i=="boolean"||i==null||t.isSymbol(i)?!0:typeof i=="string"&&(n.test(i)||!r.test(i))||s!=null&&Object.hasOwn(s,i)}e.isKey=a})(WN);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=qN,r=WN,n=Kh;function a(i,s,o,c){if(i==null)return[];o=c?void 0:o,Array.isArray(i)||(i=Object.values(i)),Array.isArray(s)||(s=s==null?[null]:[s]),s.length===0&&(s=[null]),Array.isArray(o)||(o=o==null?[]:[o]),o=o.map(h=>String(h));const u=(h,x)=>{let g=h;for(let y=0;y<x.length&&g!=null;++y)g=g[x[y]];return g},f=(h,x)=>x==null||h==null?x:typeof h=="object"&&"key"in h?Object.hasOwn(x,h.key)?x[h.key]:u(x,h.path):typeof h=="function"?h(x):Array.isArray(h)?u(x,h):typeof x=="object"?x[h]:x,d=s.map(h=>(Array.isArray(h)&&h.length===1&&(h=h[0]),h==null||typeof h=="function"||Array.isArray(h)||r.isKey(h)?h:{key:h,path:n.toPath(h)}));return i.map(h=>({original:h,criteria:d.map(x=>f(x,h))})).slice().sort((h,x)=>{for(let g=0;g<d.length;g++){const y=t.compareValues(h.criteria[g],x.criteria[g],o[g]);if(y!==0)return y}return 0}).map(h=>h.original)}e.orderBy=a})(zN);var HN={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const a=[],i=Math.floor(n),s=(o,c)=>{for(let u=0;u<o.length;u++){const f=o[u];Array.isArray(f)&&c<i?s(f,c+1):a.push(f)}};return s(r,0),a}e.flatten=t})(HN);var Bx={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Ix,r=kx,n=Cx,a=cp;function i(s,o,c){return n.isObject(c)&&(typeof o=="number"&&r.isArrayLike(c)&&t.isIndex(o)&&o<c.length||typeof o=="string"&&o in c)?a.eq(c[o],s):!1}e.isIterateeCall=i})(Bx);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=zN,r=HN,n=Bx;function a(i,...s){const o=s.length;return o>1&&n.isIterateeCall(i,s[0],s[1])?s=[]:o>2&&n.isIterateeCall(s[0],s[1],s[2])&&(s=[s[0]]),t.orderBy(i,r.flatten(s),["asc"])}e.sortBy=a})($N);var jM=$N.sortBy;const hp=zo(jM);var GN=e=>e.legend.settings,TM=e=>e.legend.size,PM=e=>e.legend.payload;Oe([PM,GN],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?hp(n,r):n});var nd=1;function kM(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=M.useState({height:0,left:0,top:0,width:0}),n=M.useCallback(a=>{if(a!=null){var i=a.getBoundingClientRect(),s={height:i.height,left:i.left,top:i.top,width:i.width};(Math.abs(s.height-t.height)>nd||Math.abs(s.left-t.left)>nd||Math.abs(s.top-t.top)>nd||Math.abs(s.width-t.width)>nd)&&r({height:s.height,left:s.left,top:s.top,width:s.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function Rn(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var CM=typeof Symbol=="function"&&Symbol.observable||"@@observable",Nb=CM,Wm=()=>Math.random().toString(36).substring(7).split("").join("."),OM={INIT:`@@redux/INIT${Wm()}`,REPLACE:`@@redux/REPLACE${Wm()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${Wm()}`},rh=OM;function Ux(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function VN(e,t,r){if(typeof e!="function")throw new Error(Rn(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Rn(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Rn(1));return r(VN)(e,t)}let n=e,a=t,i=new Map,s=i,o=0,c=!1;function u(){s===i&&(s=new Map,i.forEach((y,b)=>{s.set(b,y)}))}function f(){if(c)throw new Error(Rn(3));return a}function d(y){if(typeof y!="function")throw new Error(Rn(4));if(c)throw new Error(Rn(5));let b=!0;u();const E=o++;return s.set(E,y),function(){if(b){if(c)throw new Error(Rn(6));b=!1,u(),s.delete(E),i=null}}}function p(y){if(!Ux(y))throw new Error(Rn(7));if(typeof y.type>"u")throw new Error(Rn(8));if(typeof y.type!="string")throw new Error(Rn(17));if(c)throw new Error(Rn(9));try{c=!0,a=n(a,y)}finally{c=!1}return(i=s).forEach(E=>{E()}),y}function h(y){if(typeof y!="function")throw new Error(Rn(10));n=y,p({type:rh.REPLACE})}function x(){const y=d;return{subscribe(b){if(typeof b!="object"||b===null)throw new Error(Rn(11));function E(){const C=b;C.next&&C.next(f())}return E(),{unsubscribe:y(E)}},[Nb](){return this}}}return p({type:rh.INIT}),{dispatch:p,subscribe:d,getState:f,replaceReducer:h,[Nb]:x}}function LM(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:rh.INIT})>"u")throw new Error(Rn(12));if(typeof r(void 0,{type:rh.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Rn(13))})}function KN(e){const t=Object.keys(e),r={};for(let i=0;i<t.length;i++){const s=t[i];typeof e[s]=="function"&&(r[s]=e[s])}const n=Object.keys(r);let a;try{LM(r)}catch(i){a=i}return function(s={},o){if(a)throw a;let c=!1;const u={};for(let f=0;f<n.length;f++){const d=n[f],p=r[d],h=s[d],x=p(h,o);if(typeof x>"u")throw o&&o.type,new Error(Rn(14));u[d]=x,c=c||x!==h}return c=c||n.length!==Object.keys(s).length,c?u:s}}function nh(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function FM(...e){return t=>(r,n)=>{const a=t(r,n);let i=()=>{throw new Error(Rn(15))};const s={getState:a.getState,dispatch:(c,...u)=>i(c,...u)},o=e.map(c=>c(s));return i=nh(...o)(a.dispatch),{...a,dispatch:i}}}function YN(e){return Ux(e)&&"type"in e&&typeof e.type=="string"}var XN=Symbol.for("immer-nothing"),Sb=Symbol.for("immer-draftable"),Za=Symbol.for("immer-state");function Ci(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Xc=Object.getPrototypeOf;function Il(e){return!!e&&!!e[Za]}function Us(e){var t;return e?ZN(e)||Array.isArray(e)||!!e[Sb]||!!((t=e.constructor)!=null&&t[Sb])||mp(e)||gp(e):!1}var DM=Object.prototype.constructor.toString();function ZN(e){if(!e||typeof e!="object")return!1;const t=Xc(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===DM}function ah(e,t){pp(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function pp(e){const t=e[Za];return t?t.type_:Array.isArray(e)?1:mp(e)?2:gp(e)?3:0}function eg(e,t){return pp(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function JN(e,t,r){const n=pp(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function IM(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function mp(e){return e instanceof Map}function gp(e){return e instanceof Set}function ll(e){return e.copy_||e.base_}function tg(e,t){if(mp(e))return new Map(e);if(gp(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=ZN(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[Za];let a=Reflect.ownKeys(n);for(let i=0;i<a.length;i++){const s=a[i],o=n[s];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(n[s]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[s]})}return Object.create(Xc(e),n)}else{const n=Xc(e);if(n!==null&&r)return{...e};const a=Object.create(n);return Object.assign(a,e)}}function $x(e,t=!1){return xp(e)||Il(e)||!Us(e)||(pp(e)>1&&(e.set=e.add=e.clear=e.delete=MM),Object.freeze(e),t&&Object.entries(e).forEach(([r,n])=>$x(n,!0))),e}function MM(){Ci(2)}function xp(e){return Object.isFrozen(e)}var RM={};function Ml(e){const t=RM[e];return t||Ci(0,e),t}var Ff;function QN(){return Ff}function BM(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Ab(e,t){t&&(Ml("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function rg(e){ng(e),e.drafts_.forEach(UM),e.drafts_=null}function ng(e){e===Ff&&(Ff=e.parent_)}function Eb(e){return Ff=BM(Ff,e)}function UM(e){const t=e[Za];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function jb(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[Za].modified_&&(rg(t),Ci(4)),Us(e)&&(e=ih(t,e),t.parent_||sh(t,e)),t.patches_&&Ml("Patches").generateReplacementPatches_(r[Za].base_,e,t.patches_,t.inversePatches_)):e=ih(t,r,[]),rg(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==XN?e:void 0}function ih(e,t,r){if(xp(t))return t;const n=t[Za];if(!n)return ah(t,(a,i)=>Tb(e,n,t,a,i,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return sh(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const a=n.copy_;let i=a,s=!1;n.type_===3&&(i=new Set(a),a.clear(),s=!0),ah(i,(o,c)=>Tb(e,n,a,o,c,r,s)),sh(e,a,!1),r&&e.patches_&&Ml("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function Tb(e,t,r,n,a,i,s){if(Il(a)){const o=i&&t&&t.type_!==3&&!eg(t.assigned_,n)?i.concat(n):void 0,c=ih(e,a,o);if(JN(r,n,c),Il(c))e.canAutoFreeze_=!1;else return}else s&&r.add(a);if(Us(a)&&!xp(a)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;ih(e,a),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&sh(e,a)}}function sh(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&$x(t,r)}function $M(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:QN(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let a=n,i=zx;r&&(a=[n],i=Df);const{revoke:s,proxy:o}=Proxy.revocable(a,i);return n.draft_=o,n.revoke_=s,o}var zx={get(e,t){if(t===Za)return e;const r=ll(e);if(!eg(r,t))return zM(e,r,t);const n=r[t];return e.finalized_||!Us(n)?n:n===Hm(e.base_,t)?(Gm(e),e.copy_[t]=ig(n,e)):n},has(e,t){return t in ll(e)},ownKeys(e){return Reflect.ownKeys(ll(e))},set(e,t,r){const n=eS(ll(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const a=Hm(ll(e),t),i=a==null?void 0:a[Za];if(i&&i.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(IM(r,a)&&(r!==void 0||eg(e.base_,t)))return!0;Gm(e),ag(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return Hm(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,Gm(e),ag(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=ll(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){Ci(11)},getPrototypeOf(e){return Xc(e.base_)},setPrototypeOf(){Ci(12)}},Df={};ah(zx,(e,t)=>{Df[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Df.deleteProperty=function(e,t){return Df.set.call(this,e,t,void 0)};Df.set=function(e,t,r){return zx.set.call(this,e[0],t,r,e[0])};function Hm(e,t){const r=e[Za];return(r?ll(r):e)[t]}function zM(e,t,r){var a;const n=eS(t,r);return n?"value"in n?n.value:(a=n.get)==null?void 0:a.call(e.draft_):void 0}function eS(e,t){if(!(t in e))return;let r=Xc(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Xc(r)}}function ag(e){e.modified_||(e.modified_=!0,e.parent_&&ag(e.parent_))}function Gm(e){e.copy_||(e.copy_=tg(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var qM=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const i=r;r=t;const s=this;return function(c=i,...u){return s.produce(c,f=>r.call(this,f,...u))}}typeof r!="function"&&Ci(6),n!==void 0&&typeof n!="function"&&Ci(7);let a;if(Us(t)){const i=Eb(this),s=ig(t,void 0);let o=!0;try{a=r(s),o=!1}finally{o?rg(i):ng(i)}return Ab(i,n),jb(a,i)}else if(!t||typeof t!="object"){if(a=r(t),a===void 0&&(a=t),a===XN&&(a=void 0),this.autoFreeze_&&$x(a,!0),n){const i=[],s=[];Ml("Patches").generateReplacementPatches_(t,a,i,s),n(i,s)}return a}else Ci(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(s,...o)=>this.produceWithPatches(s,c=>t(c,...o));let n,a;return[this.produce(t,r,(s,o)=>{n=s,a=o}),n,a]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Us(e)||Ci(8),Il(e)&&(e=Ds(e));const t=Eb(this),r=ig(e,void 0);return r[Za].isManual_=!0,ng(t),r}finishDraft(e,t){const r=e&&e[Za];(!r||!r.isManual_)&&Ci(9);const{scope_:n}=r;return Ab(n,t),jb(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const a=t[r];if(a.path.length===0&&a.op==="replace"){e=a.value;break}}r>-1&&(t=t.slice(r+1));const n=Ml("Patches").applyPatches_;return Il(e)?n(e,t):this.produce(e,a=>n(a,t))}};function ig(e,t){const r=mp(e)?Ml("MapSet").proxyMap_(e,t):gp(e)?Ml("MapSet").proxySet_(e,t):$M(e,t);return(t?t.scope_:QN()).drafts_.push(r),r}function Ds(e){return Il(e)||Ci(10,e),tS(e)}function tS(e){if(!Us(e)||xp(e))return e;const t=e[Za];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=tg(e,t.scope_.immer_.useStrictShallowCopy_)}else r=tg(e,!0);return ah(r,(n,a)=>{JN(r,n,tS(a))}),t&&(t.finalized_=!1),r}var Ja=new qM,rS=Ja.produce;Ja.produceWithPatches.bind(Ja);Ja.setAutoFreeze.bind(Ja);Ja.setUseStrictShallowCopy.bind(Ja);Ja.applyPatches.bind(Ja);Ja.createDraft.bind(Ja);Ja.finishDraft.bind(Ja);function nS(e){return({dispatch:r,getState:n})=>a=>i=>typeof i=="function"?i(r,n,e):a(i)}var WM=nS(),HM=nS,GM=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?nh:nh.apply(null,arguments)};function hi(e,t){function r(...n){if(t){let a=t(...n);if(!a)throw new Error(Ka(0));return{type:e,payload:a.payload,..."meta"in a&&{meta:a.meta},..."error"in a&&{error:a.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>YN(n)&&n.type===e,r}var aS=class cf extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,cf.prototype)}static get[Symbol.species](){return cf}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new cf(...t[0].concat(this)):new cf(...t.concat(this))}};function Pb(e){return Us(e)?rS(e,()=>{}):e}function ad(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function VM(e){return typeof e=="boolean"}var KM=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:a=!0,actionCreatorCheck:i=!0}=t??{};let s=new aS;return r&&(VM(r)?s.push(WM):s.push(HM(r.extraArgument))),s},YM="RTK_autoBatch",kb=e=>t=>{setTimeout(t,e)},XM=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let a=!0,i=!1,s=!1;const o=new Set,c=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:kb(10):e.type==="callback"?e.queueNotification:kb(e.timeout),u=()=>{s=!1,i&&(i=!1,o.forEach(f=>f()))};return Object.assign({},n,{subscribe(f){const d=()=>a&&f(),p=n.subscribe(d);return o.add(f),()=>{p(),o.delete(f)}},dispatch(f){var d;try{return a=!((d=f==null?void 0:f.meta)!=null&&d[YM]),i=!a,i&&(s||(s=!0,c(u))),n.dispatch(f)}finally{a=!0}}})},ZM=e=>function(r){const{autoBatch:n=!0}=r??{};let a=new aS(e);return n&&a.push(XM(typeof n=="object"?n:void 0)),a};function JM(e){const t=KM(),{reducer:r=void 0,middleware:n,devTools:a=!0,duplicateMiddlewareCheck:i=!0,preloadedState:s=void 0,enhancers:o=void 0}=e||{};let c;if(typeof r=="function")c=r;else if(Ux(r))c=KN(r);else throw new Error(Ka(1));let u;typeof n=="function"?u=n(t):u=t();let f=nh;a&&(f=GM({trace:!1,...typeof a=="object"&&a}));const d=FM(...u),p=ZM(d);let h=typeof o=="function"?o(p):p();const x=f(...h);return VN(c,s,x)}function iS(e){const t={},r=[];let n;const a={addCase(i,s){const o=typeof i=="string"?i:i.type;if(!o)throw new Error(Ka(28));if(o in t)throw new Error(Ka(29));return t[o]=s,a},addMatcher(i,s){return r.push({matcher:i,reducer:s}),a},addDefaultCase(i){return n=i,a}};return e(a),[t,r,n]}function QM(e){return typeof e=="function"}function e9(e,t){let[r,n,a]=iS(t),i;if(QM(e))i=()=>Pb(e());else{const o=Pb(e);i=()=>o}function s(o=i(),c){let u=[r[c.type],...n.filter(({matcher:f})=>f(c)).map(({reducer:f})=>f)];return u.filter(f=>!!f).length===0&&(u=[a]),u.reduce((f,d)=>{if(d)if(Il(f)){const h=d(f,c);return h===void 0?f:h}else{if(Us(f))return rS(f,p=>d(p,c));{const p=d(f,c);if(p===void 0){if(f===null)return f;throw Error("A case reducer on a non-draftable value must not return undefined")}return p}}return f},o)}return s.getInitialState=i,s}var t9="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",r9=(e=21)=>{let t="",r=e;for(;r--;)t+=t9[Math.random()*64|0];return t},n9=Symbol.for("rtk-slice-createasyncthunk");function a9(e,t){return`${e}/${t}`}function i9({creators:e}={}){var r;const t=(r=e==null?void 0:e.asyncThunk)==null?void 0:r[n9];return function(a){const{name:i,reducerPath:s=i}=a;if(!i)throw new Error(Ka(11));typeof process<"u";const o=(typeof a.reducers=="function"?a.reducers(o9()):a.reducers)||{},c=Object.keys(o),u={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},f={addCase(C,N){const F=typeof C=="string"?C:C.type;if(!F)throw new Error(Ka(12));if(F in u.sliceCaseReducersByType)throw new Error(Ka(13));return u.sliceCaseReducersByType[F]=N,f},addMatcher(C,N){return u.sliceMatchers.push({matcher:C,reducer:N}),f},exposeAction(C,N){return u.actionCreators[C]=N,f},exposeCaseReducer(C,N){return u.sliceCaseReducersByName[C]=N,f}};c.forEach(C=>{const N=o[C],F={reducerName:C,type:a9(i,C),createNotation:typeof a.reducers=="function"};c9(N)?f9(F,N,f,t):l9(F,N,f)});function d(){const[C={},N=[],F=void 0]=typeof a.extraReducers=="function"?iS(a.extraReducers):[a.extraReducers],O={...C,...u.sliceCaseReducersByType};return e9(a.initialState,I=>{for(let P in O)I.addCase(P,O[P]);for(let P of u.sliceMatchers)I.addMatcher(P.matcher,P.reducer);for(let P of N)I.addMatcher(P.matcher,P.reducer);F&&I.addDefaultCase(F)})}const p=C=>C,h=new Map,x=new WeakMap;let g;function y(C,N){return g||(g=d()),g(C,N)}function b(){return g||(g=d()),g.getInitialState()}function E(C,N=!1){function F(I){let P=I[C];return typeof P>"u"&&N&&(P=ad(x,F,b)),P}function O(I=p){const P=ad(h,N,()=>new WeakMap);return ad(P,I,()=>{const H={};for(const[T,j]of Object.entries(a.selectors??{}))H[T]=s9(j,I,()=>ad(x,I,b),N);return H})}return{reducerPath:C,getSelectors:O,get selectors(){return O(F)},selectSlice:F}}const A={name:i,reducer:y,actions:u.actionCreators,caseReducers:u.sliceCaseReducersByName,getInitialState:b,...E(s),injectInto(C,{reducerPath:N,...F}={}){const O=N??s;return C.inject({reducerPath:O,reducer:y},F),{...A,...E(O,!0)}}};return A}}function s9(e,t,r,n){function a(i,...s){let o=t(i);return typeof o>"u"&&n&&(o=r()),e(o,...s)}return a.unwrapped=e,a}var Qa=i9();function o9(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function l9({type:e,reducerName:t,createNotation:r},n,a){let i,s;if("reducer"in n){if(r&&!u9(n))throw new Error(Ka(17));i=n.reducer,s=n.prepare}else i=n;a.addCase(e,i).exposeCaseReducer(t,i).exposeAction(t,s?hi(e,s):hi(e))}function c9(e){return e._reducerDefinitionType==="asyncThunk"}function u9(e){return e._reducerDefinitionType==="reducerWithPrepare"}function f9({type:e,reducerName:t},r,n,a){if(!a)throw new Error(Ka(18));const{payloadCreator:i,fulfilled:s,pending:o,rejected:c,settled:u,options:f}=r,d=a(e,i,f);n.exposeAction(t,d),s&&n.addCase(d.fulfilled,s),o&&n.addCase(d.pending,o),c&&n.addCase(d.rejected,c),u&&n.addMatcher(d.settled,u),n.exposeCaseReducer(t,{fulfilled:s||id,pending:o||id,rejected:c||id,settled:u||id})}function id(){}var d9="task",sS="listener",oS="completed",qx="cancelled",h9=`task-${qx}`,p9=`task-${oS}`,sg=`${sS}-${qx}`,m9=`${sS}-${oS}`,vp=class{constructor(e){rr(this,"name","TaskAbortError");rr(this,"message");this.code=e,this.message=`${d9} ${qx} (reason: ${e})`}},Wx=(e,t)=>{if(typeof e!="function")throw new TypeError(Ka(32))},oh=()=>{},lS=(e,t=oh)=>(e.catch(t),e),cS=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),El=(e,t)=>{const r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},jl=e=>{if(e.aborted){const{reason:t}=e;throw new vp(t)}};function uS(e,t){let r=oh;return new Promise((n,a)=>{const i=()=>a(new vp(e.reason));if(e.aborted){i();return}r=cS(e,i),t.finally(()=>r()).then(n,a)}).finally(()=>{r=oh})}var g9=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof vp?"cancelled":"rejected",error:r}}finally{t==null||t()}},lh=e=>t=>lS(uS(e,t).then(r=>(jl(e),r))),fS=e=>{const t=lh(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:Dc}=Object,Cb={},yp="listenerMiddleware",x9=(e,t)=>{const r=n=>cS(e,()=>El(n,e.reason));return(n,a)=>{Wx(n);const i=new AbortController;r(i);const s=g9(async()=>{jl(e),jl(i.signal);const o=await n({pause:lh(i.signal),delay:fS(i.signal),signal:i.signal});return jl(i.signal),o},()=>El(i,p9));return a!=null&&a.autoJoin&&t.push(s.catch(oh)),{result:lh(e)(s),cancel(){El(i,h9)}}}},v9=(e,t)=>{const r=async(n,a)=>{jl(t);let i=()=>{};const o=[new Promise((c,u)=>{let f=e({predicate:n,effect:(d,p)=>{p.unsubscribe(),c([d,p.getState(),p.getOriginalState()])}});i=()=>{f(),u()}})];a!=null&&o.push(new Promise(c=>setTimeout(c,a,null)));try{const c=await uS(t,Promise.race(o));return jl(t),c}finally{i()}};return(n,a)=>lS(r(n,a))},dS=e=>{let{type:t,actionCreator:r,matcher:n,predicate:a,effect:i}=e;if(t)a=hi(t).match;else if(r)t=r.type,a=r.match;else if(n)a=n;else if(!a)throw new Error(Ka(21));return Wx(i),{predicate:a,type:t,effect:i}},hS=Dc(e=>{const{type:t,predicate:r,effect:n}=dS(e);return{id:r9(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Ka(22))}}},{withTypes:()=>hS}),Ob=(e,t)=>{const{type:r,effect:n,predicate:a}=dS(t);return Array.from(e.values()).find(i=>(typeof r=="string"?i.type===r:i.predicate===a)&&i.effect===n)},og=e=>{e.pending.forEach(t=>{El(t,sg)})},y9=e=>()=>{e.forEach(og),e.clear()},Lb=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},pS=Dc(hi(`${yp}/add`),{withTypes:()=>pS}),b9=hi(`${yp}/removeAll`),mS=Dc(hi(`${yp}/remove`),{withTypes:()=>mS}),w9=(...e)=>{console.error(`${yp}/error`,...e)},s0=(e={})=>{const t=new Map,{extra:r,onError:n=w9}=e;Wx(n);const a=f=>(f.unsubscribe=()=>t.delete(f.id),t.set(f.id,f),d=>{f.unsubscribe(),d!=null&&d.cancelActive&&og(f)}),i=f=>{const d=Ob(t,f)??hS(f);return a(d)};Dc(i,{withTypes:()=>i});const s=f=>{const d=Ob(t,f);return d&&(d.unsubscribe(),f.cancelActive&&og(d)),!!d};Dc(s,{withTypes:()=>s});const o=async(f,d,p,h)=>{const x=new AbortController,g=v9(i,x.signal),y=[];try{f.pending.add(x),await Promise.resolve(f.effect(d,Dc({},p,{getOriginalState:h,condition:(b,E)=>g(b,E).then(Boolean),take:g,delay:fS(x.signal),pause:lh(x.signal),extra:r,signal:x.signal,fork:x9(x.signal,y),unsubscribe:f.unsubscribe,subscribe:()=>{t.set(f.id,f)},cancelActiveListeners:()=>{f.pending.forEach((b,E,A)=>{b!==x&&(El(b,sg),A.delete(b))})},cancel:()=>{El(x,sg),f.pending.delete(x)},throwIfCancelled:()=>{jl(x.signal)}})))}catch(b){b instanceof vp||Lb(n,b,{raisedBy:"effect"})}finally{await Promise.all(y),El(x,m9),f.pending.delete(x)}},c=y9(t);return{middleware:f=>d=>p=>{if(!YN(p))return d(p);if(pS.match(p))return i(p.payload);if(b9.match(p)){c();return}if(mS.match(p))return s(p.payload);let h=f.getState();const x=()=>{if(h===Cb)throw new Error(Ka(23));return h};let g;try{if(g=d(p),t.size>0){const y=f.getState(),b=Array.from(t.values());for(const E of b){let A=!1;try{A=E.predicate(p,y,h)}catch(C){A=!1,Lb(n,C,{raisedBy:"predicate"})}A&&o(E,p,f,x)}}}finally{h=Cb}return g},startListening:i,stopListening:s,clearListeners:c}};function Ka(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var _9={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},gS=Qa({name:"chartLayout",initialState:_9,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){e.margin.top=t.payload.top,e.margin.right=t.payload.right,e.margin.bottom=t.payload.bottom,e.margin.left=t.payload.left},setScale(e,t){e.scale=t.payload}}}),{setMargin:N9,setLayout:S9,setChartSize:A9,setScale:E9}=gS.actions,j9=gS.reducer;function Fb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Db(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Fb(Object(r),!0).forEach(function(n){T9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function T9(e,t,r){return(t=P9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function P9(e){var t=k9(e,"string");return typeof t=="symbol"?t:t+""}function k9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var ch=Math.PI/180,C9=e=>e*180/Math.PI,ta=(e,t,r,n)=>({x:e+Math.cos(-ch*n)*r,y:t+Math.sin(-ch*n)*r}),xS=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0,width:0,height:0,brushBottom:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},O9=(e,t)=>{var{x:r,y:n}=e,{x:a,y:i}=t;return Math.sqrt((r-a)**2+(n-i)**2)},L9=(e,t)=>{var{x:r,y:n}=e,{cx:a,cy:i}=t,s=O9({x:r,y:n},{x:a,y:i});if(s<=0)return{radius:s,angle:0};var o=(r-a)/s,c=Math.acos(o);return n>i&&(c=2*Math.PI-c),{radius:s,angle:C9(c),angleInRadian:c}},F9=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),a=Math.floor(r/360),i=Math.min(n,a);return{startAngle:t-i*360,endAngle:r-i*360}},D9=(e,t)=>{var{startAngle:r,endAngle:n}=t,a=Math.floor(r/360),i=Math.floor(n/360),s=Math.min(a,i);return e+s*360},I9=(e,t)=>{var{x:r,y:n}=e,{radius:a,angle:i}=L9({x:r,y:n},t),{innerRadius:s,outerRadius:o}=t;if(a<s||a>o||a===0)return null;var{startAngle:c,endAngle:u}=F9(t),f=i,d;if(c<=u){for(;f>u;)f-=360;for(;f<c;)f+=360;d=f>=c&&f<=u}else{for(;f>c;)f-=360;for(;f<u;)f+=360;d=f>=u&&f<=c}return d?Db(Db({},t),{},{radius:a,angle:D9(f,t)}):null};function vS(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function Ib(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ui(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ib(Object(r),!0).forEach(function(n){M9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ib(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function M9(e,t,r){return(t=R9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function R9(e){var t=B9(e,"string");return typeof t=="symbol"?t:t+""}function B9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ln(e,t,r){return Dl(e)||Dl(t)?r:Bs(t)?Gc(e,t,r):typeof t=="function"?t(e):r}var U9=(e,t,r,n,a)=>{var i,s=-1,o=(i=t==null?void 0:t.length)!==null&&i!==void 0?i:0;if(o<=1||e==null)return 0;if(n==="angleAxis"&&a!=null&&Math.abs(Math.abs(a[1]-a[0])-360)<=1e-6)for(var c=0;c<o;c++){var u=c>0?r[c-1].coordinate:r[o-1].coordinate,f=r[c].coordinate,d=c>=o-1?r[0].coordinate:r[c+1].coordinate,p=void 0;if(Ha(f-u)!==Ha(d-f)){var h=[];if(Ha(d-f)===Ha(a[1]-a[0])){p=d;var x=f+a[1]-a[0];h[0]=Math.min(x,(x+u)/2),h[1]=Math.max(x,(x+u)/2)}else{p=u;var g=d+a[1]-a[0];h[0]=Math.min(f,(g+f)/2),h[1]=Math.max(f,(g+f)/2)}var y=[Math.min(f,(p+f)/2),Math.max(f,(p+f)/2)];if(e>y[0]&&e<=y[1]||e>=h[0]&&e<=h[1]){({index:s}=r[c]);break}}else{var b=Math.min(u,d),E=Math.max(u,d);if(e>(b+f)/2&&e<=(E+f)/2){({index:s}=r[c]);break}}}else if(t){for(var A=0;A<o;A++)if(A===0&&e<=(t[A].coordinate+t[A+1].coordinate)/2||A>0&&A<o-1&&e>(t[A].coordinate+t[A-1].coordinate)/2&&e<=(t[A].coordinate+t[A+1].coordinate)/2||A===o-1&&e>(t[A].coordinate+t[A-1].coordinate)/2){({index:s}=t[A]);break}}return s},$9=(e,t,r)=>{if(t&&r){var{width:n,height:a}=r,{align:i,verticalAlign:s,layout:o}=t;if((o==="vertical"||o==="horizontal"&&s==="middle")&&i!=="center"&&Vt(e[i]))return ui(ui({},e),{},{[i]:e[i]+(n||0)});if((o==="horizontal"||o==="vertical"&&i==="center")&&s!=="middle"&&Vt(e[s]))return ui(ui({},e),{},{[s]:e[s]+(a||0)})}return e},Vl=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",Mb=1e-4,z9=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,n=e.range(),a=Math.min(n[0],n[1])-Mb,i=Math.max(n[0],n[1])+Mb,s=e(t[0]),o=e(t[r-1]);(s<a||s>i||o<a||o>i)&&e.domain([t[0],t[r-1]])}},q9=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,i=0,s=0;s<t;++s){var o=Ii(e[s][r][1])?e[s][r][0]:e[s][r][1];o>=0?(e[s][r][0]=a,e[s][r][1]=a+o,a=e[s][r][1]):(e[s][r][0]=i,e[s][r][1]=i+o,i=e[s][r][1])}},W9=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var a=0,i=0;i<t;++i){var s=Ii(e[i][r][1])?e[i][r][0]:e[i][r][1];s>=0?(e[i][r][0]=a,e[i][r][1]=a+s,a=e[i][r][1]):(e[i][r][0]=0,e[i][r][1]=0)}},H9={sign:q9,expand:LI,none:Kc,silhouette:FI,wiggle:DI,positive:W9},G9=(e,t,r)=>{var n=H9[r],a=OI().keys(t).value((i,s)=>+ln(i,s,0)).order(J1).offset(n);return a(e)},V9=e=>{var t=e.flat(2).filter(Vt);return[Math.min(...t),Math.max(...t)]},K9=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],Y9=(e,t,r)=>{if(e!=null)return K9(Object.keys(e).reduce((n,a)=>{var i=e[a],{stackedData:s}=i,o=s.reduce((c,u)=>{var f=vS(u,t,r),d=V9(f);return[Math.min(c[0],d[0]),Math.max(c[1],d[1])]},[1/0,-1/0]);return[Math.min(o[0],n[0]),Math.max(o[1],n[1])]},[1/0,-1/0]))},Rb=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,Bb=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,X9=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();return n}if(e&&t&&t.length>=2){for(var a=hp(t,f=>f.coordinate),i=1/0,s=1,o=a.length;s<o;s++){var c=a[s],u=a[s-1];i=Math.min((c.coordinate||0)-(u.coordinate||0),i)}return i===1/0?0:i}return 0};function Ub(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:a,name:i}=e;return ui(ui({},t),{},{dataKey:r,payload:n,value:a,name:i})}function yS(e,t){if(e)return String(e);if(typeof t=="string")return t}function Z9(e,t,r,n,a){if(r==="horizontal"||r==="vertical"){var i=e>=a.left&&e<=a.left+a.width&&t>=a.top&&t<=a.top+a.height;return i?{x:e,y:t}:null}return n?I9({x:e,y:t},n):null}var J9=(e,t,r,n)=>{var a=t.find(u=>u&&u.index===r);if(a){if(e==="horizontal")return{x:a.coordinate,y:n.y};if(e==="vertical")return{x:n.x,y:a.coordinate};if(e==="centric"){var i=a.coordinate,{radius:s}=n;return ui(ui(ui({},n),ta(n.cx,n.cy,s,i)),{},{angle:i,radius:s})}var o=a.coordinate,{angle:c}=n;return ui(ui(ui({},n),ta(n.cx,n.cy,o,c)),{},{angle:c,radius:o})}return{x:0,y:0}},Q9=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius,Vs=e=>e.layout.width,Ks=e=>e.layout.height,eR=e=>e.layout.scale,bS=e=>e.layout.margin,Hx=Oe(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),Gx=Oe(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),wS="data-recharts-item-index",_S="data-recharts-item-data-key",bp=60;function $b(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function ho(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$b(Object(r),!0).forEach(function(n){tR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$b(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tR(e,t,r){return(t=rR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rR(e){var t=nR(e,"string");return typeof t=="symbol"?t:t+""}function nR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aR=e=>e.brush.height,sa=Oe([Vs,Ks,bS,aR,Hx,Gx,GN,TM],(e,t,r,n,a,i,s,o)=>{var c=i.reduce((x,g)=>{var{orientation:y}=g;if(!g.mirror&&!g.hide){var b=typeof g.width=="number"?g.width:bp;return ho(ho({},x),{},{[y]:x[y]+b})}return x},{left:r.left||0,right:r.right||0}),u=a.reduce((x,g)=>{var{orientation:y}=g;return!g.mirror&&!g.hide?ho(ho({},x),{},{[y]:Gc(x,"".concat(y))+g.height}):x},{top:r.top||0,bottom:r.bottom||0}),f=ho(ho({},u),c),d=f.bottom;f.bottom+=n,f=$9(f,s,o);var p=e-f.left-f.right,h=t-f.top-f.bottom;return ho(ho({brushBottom:d},f),{},{width:Math.max(p,0),height:Math.max(h,0)})}),iR=Oe(sa,e=>({x:e.left,y:e.top,width:e.width,height:e.height}));Oe(Vs,Ks,(e,t)=>({x:0,y:0,width:e,height:t}));var sR=M.createContext(null),lu=()=>M.useContext(sR)!=null,wp=e=>e.brush,_p=Oe([wp,sa,bS],(e,t,r)=>({height:e.height,x:Vt(e.x)?e.x:t.left,y:Vt(e.y)?e.y:t.top+t.height+t.brushBottom-((r==null?void 0:r.bottom)||0),width:Vt(e.width)?e.width:t.width})),NS=()=>{var e,t=lu(),r=qt(iR),n=qt(_p),a=(e=qt(wp))===null||e===void 0?void 0:e.padding;return!t||!n||!a?r:{width:n.width-a.left-a.right,height:n.height-a.top-a.bottom,x:a.left,y:a.top}},oR={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},lR=()=>{var e;return(e=qt(sa))!==null&&e!==void 0?e:oR},cR=()=>qt(Vs),uR=()=>qt(Ks),Er=e=>e.layout.layoutType,SS=()=>qt(Er),fR={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},AS=Qa({name:"legend",initialState:fR,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload(e,t){e.payload.push(t.payload)},removeLegendPayload(e,t){var r=Ds(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)}}}),{setLegendSize:bJ,setLegendSettings:wJ,addLegendPayload:dR,removeLegendPayload:hR}=AS.actions,pR=AS.reducer;function lg(){return lg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},lg.apply(null,arguments)}function zb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Vm(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zb(Object(r),!0).forEach(function(n){mR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mR(e,t,r){return(t=gR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gR(e){var t=xR(e,"string");return typeof t=="symbol"?t:t+""}function xR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function vR(e){return Array.isArray(e)&&Bs(e[0])&&Bs(e[1])?e.join(" ~ "):e}var yR=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:n={},labelStyle:a={},payload:i,formatter:s,itemSorter:o,wrapperClassName:c,labelClassName:u,label:f,labelFormatter:d,accessibilityLayer:p=!1}=e,h=()=>{if(i&&i.length){var N={padding:0,margin:0},F=(o?hp(i,o):i).map((O,I)=>{if(O.type==="none")return null;var P=O.formatter||s||vR,{value:H,name:T}=O,j=H,z=T;if(P){var K=P(H,T,O,I,i);if(Array.isArray(K))[j,z]=K;else if(K!=null)j=K;else return null}var he=Vm({display:"block",paddingTop:4,paddingBottom:4,color:O.color||"#000"},n);return M.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(I),style:he},Bs(z)?M.createElement("span",{className:"recharts-tooltip-item-name"},z):null,Bs(z)?M.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,M.createElement("span",{className:"recharts-tooltip-item-value"},j),M.createElement("span",{className:"recharts-tooltip-item-unit"},O.unit||""))});return M.createElement("ul",{className:"recharts-tooltip-item-list",style:N},F)}return null},x=Vm({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),g=Vm({margin:0},a),y=!Dl(f),b=y?f:"",E=Pn("recharts-default-tooltip",c),A=Pn("recharts-tooltip-label",u);y&&d&&i!==void 0&&i!==null&&(b=d(f,i));var C=p?{role:"status","aria-live":"assertive"}:{};return M.createElement("div",lg({className:E,style:x},C),M.createElement("p",{className:A,style:g},M.isValidElement(b)?b:"".concat(b)),h())},Xu="recharts-tooltip-wrapper",bR={visibility:"hidden"};function wR(e){var{coordinate:t,translateX:r,translateY:n}=e;return Pn(Xu,{["".concat(Xu,"-right")]:Vt(r)&&t&&Vt(t.x)&&r>=t.x,["".concat(Xu,"-left")]:Vt(r)&&t&&Vt(t.x)&&r<t.x,["".concat(Xu,"-bottom")]:Vt(n)&&t&&Vt(t.y)&&n>=t.y,["".concat(Xu,"-top")]:Vt(n)&&t&&Vt(t.y)&&n<t.y})}function qb(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offsetTopLeft:a,position:i,reverseDirection:s,tooltipDimension:o,viewBox:c,viewBoxDimension:u}=e;if(i&&Vt(i[n]))return i[n];var f=r[n]-o-(a>0?a:0),d=r[n]+a;if(t[n])return s[n]?f:d;var p=c[n];if(p==null)return 0;if(s[n]){var h=f,x=p;return h<x?Math.max(d,p):Math.max(f,p)}if(u==null)return 0;var g=d+o,y=p+u;return g>y?Math.max(f,p):Math.max(d,p)}function _R(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function NR(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:n,position:a,reverseDirection:i,tooltipBox:s,useTranslate3d:o,viewBox:c}=e,u,f,d;return s.height>0&&s.width>0&&r?(f=qb({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.width,viewBox:c,viewBoxDimension:c.width}),d=qb({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:a,reverseDirection:i,tooltipDimension:s.height,viewBox:c,viewBoxDimension:c.height}),u=_R({translateX:f,translateY:d,useTranslate3d:o})):u=bR,{cssProperties:u,cssClasses:wR({translateX:f,translateY:d,coordinate:r})}}function Wb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function sd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Wb(Object(r),!0).forEach(function(n){cg(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Wb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function cg(e,t,r){return(t=SR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function SR(e){var t=AR(e,"string");return typeof t=="symbol"?t:t+""}function AR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class ER extends M.PureComponent{constructor(){super(...arguments),cg(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),cg(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,a,i;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(a=(i=this.props.coordinate)===null||i===void 0?void 0:i.y)!==null&&a!==void 0?a:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:a,children:i,coordinate:s,hasPayload:o,isAnimationActive:c,offset:u,position:f,reverseDirection:d,useTranslate3d:p,viewBox:h,wrapperStyle:x,lastBoundingBox:g,innerRef:y,hasPortalFromProps:b}=this.props,{cssClasses:E,cssProperties:A}=NR({allowEscapeViewBox:r,coordinate:s,offsetTopLeft:u,position:f,reverseDirection:d,tooltipBox:{height:g.height,width:g.width},useTranslate3d:p,viewBox:h}),C=b?{}:sd(sd({transition:c&&t?"transform ".concat(n,"ms ").concat(a):void 0},A),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&o?"visible":"hidden",position:"absolute",top:0,left:0}),N=sd(sd({},C),{},{visibility:!this.state.dismissed&&t&&o?"visible":"hidden"},x);return M.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:E,style:N,ref:y},i)}}var jR=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),Np={isSsr:jR()},ES=()=>qt(e=>e.rootProps.accessibilityLayer);function Mi(e){return Number.isFinite(e)}function uh(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function ug(){return ug=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ug.apply(null,arguments)}function Hb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Gb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Hb(Object(r),!0).forEach(function(n){TR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function TR(e,t,r){return(t=PR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function PR(e){var t=kR(e,"string");return typeof t=="symbol"?t:t+""}function kR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Vb={curveBasisClosed:wI,curveBasisOpen:_I,curveBasis:bI,curveBumpX:sI,curveBumpY:oI,curveLinearClosed:NI,curveLinear:op,curveMonotoneX:SI,curveMonotoneY:AI,curveNatural:EI,curveStep:jI,curveStepAfter:PI,curveStepBefore:TI},od=e=>Mi(e.x)&&Mi(e.y),Zu=e=>e.x,Ju=e=>e.y,CR=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(i0(e));return(r==="curveMonotone"||r==="curveBump")&&t?Vb["".concat(r).concat(t==="vertical"?"Y":"X")]:Vb[r]||op},OR=e=>{var{type:t="linear",points:r=[],baseLine:n,layout:a,connectNulls:i=!1}=e,s=CR(t,a),o=i?r.filter(od):r,c;if(Array.isArray(n)){var u=i?n.filter(d=>od(d)):n,f=o.map((d,p)=>Gb(Gb({},d),{},{base:u[p]}));return a==="vertical"?c=td().y(Ju).x1(Zu).x0(d=>d.base.x):c=td().x(Zu).y1(Ju).y0(d=>d.base.y),c.defined(od).curve(s),c(f)}return a==="vertical"&&Vt(n)?c=td().y(Ju).x1(Zu).x0(n):Vt(n)?c=td().x(Zu).y1(Ju).y0(n):c=lN().x(Zu).y(Ju),c.defined(od).curve(s),c(o)},jS=e=>{var{className:t,points:r,path:n,pathRef:a}=e;if((!r||!r.length)&&!n)return null;var i=r&&r.length?OR(e):n;return M.createElement("path",ug({},ip(e),HD(e),{className:Pn("recharts-curve",t),d:i===null?void 0:i,ref:a}))},LR=["x","y","top","left","width","height","className"];function fg(){return fg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},fg.apply(null,arguments)}function Kb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function FR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Kb(Object(r),!0).forEach(function(n){DR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Kb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function DR(e,t,r){return(t=IR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function IR(e){var t=MR(e,"string");return typeof t=="symbol"?t:t+""}function MR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function RR(e,t){if(e==null)return{};var r,n,a=BR(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function BR(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var UR=(e,t,r,n,a,i)=>"M".concat(e,",").concat(a,"v").concat(n,"M").concat(i,",").concat(t,"h").concat(r),$R=e=>{var{x:t=0,y:r=0,top:n=0,left:a=0,width:i=0,height:s=0,className:o}=e,c=RR(e,LR),u=FR({x:t,y:r,top:n,left:a,width:i,height:s},c);return!Vt(t)||!Vt(r)||!Vt(i)||!Vt(s)||!Vt(n)||!Vt(a)?null:M.createElement("path",fg({},Xa(u,!0),{className:Pn("recharts-cross",o),d:UR(t,r,i,s,n,a)}))};function zR(e,t,r,n){var a=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-a:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-a,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function Yb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function qR(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Yb(Object(r),!0).forEach(function(n){WR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function WR(e,t,r){return(t=HR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HR(e){var t=GR(e,"string");return typeof t=="symbol"?t:t+""}function GR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wo(e,t){var r=qR({},e),n=t,a=Object.keys(t),i=a.reduce((s,o)=>(s[o]===void 0&&n[o]!==void 0&&(s[o]=n[o]),s),r);return i}var TS={},PS={},kS={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(!r||typeof r!="object")return!1;const n=Object.getPrototypeOf(r);return n===null||n===Object.prototype||Object.getPrototypeOf(n)===null?Object.prototype.toString.call(r)==="[object Object]":!1}e.isPlainObject=t})(kS);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=kS,r=Dx,n=up,a=fp,i=cp;function s(u,f,d){return o(u,f,void 0,void 0,void 0,void 0,d)}function o(u,f,d,p,h,x,g){const y=g(u,f,d,p,h,x);if(y!==void 0)return y;if(typeof u==typeof f)switch(typeof u){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return u===f;case"number":return u===f||Object.is(u,f);case"function":return u===f;case"object":return c(u,f,x,g)}return c(u,f,x,g)}function c(u,f,d,p){if(Object.is(u,f))return!0;let h=n.getTag(u),x=n.getTag(f);if(h===a.argumentsTag&&(h=a.objectTag),x===a.argumentsTag&&(x=a.objectTag),h!==x)return!1;switch(h){case a.stringTag:return u.toString()===f.toString();case a.numberTag:{const b=u.valueOf(),E=f.valueOf();return i.eq(b,E)}case a.booleanTag:case a.dateTag:case a.symbolTag:return Object.is(u.valueOf(),f.valueOf());case a.regexpTag:return u.source===f.source&&u.flags===f.flags;case a.functionTag:return u===f}d=d??new Map;const g=d.get(u),y=d.get(f);if(g!=null&&y!=null)return g===f;d.set(u,f),d.set(f,u);try{switch(h){case a.mapTag:{if(u.size!==f.size)return!1;for(const[b,E]of u.entries())if(!f.has(b)||!o(E,f.get(b),b,u,f,d,p))return!1;return!0}case a.setTag:{if(u.size!==f.size)return!1;const b=Array.from(u.values()),E=Array.from(f.values());for(let A=0;A<b.length;A++){const C=b[A],N=E.findIndex(F=>o(C,F,void 0,u,f,d,p));if(N===-1)return!1;E.splice(N,1)}return!0}case a.arrayTag:case a.uint8ArrayTag:case a.uint8ClampedArrayTag:case a.uint16ArrayTag:case a.uint32ArrayTag:case a.bigUint64ArrayTag:case a.int8ArrayTag:case a.int16ArrayTag:case a.int32ArrayTag:case a.bigInt64ArrayTag:case a.float32ArrayTag:case a.float64ArrayTag:{if(typeof Buffer<"u"&&Buffer.isBuffer(u)!==Buffer.isBuffer(f)||u.length!==f.length)return!1;for(let b=0;b<u.length;b++)if(!o(u[b],f[b],b,u,f,d,p))return!1;return!0}case a.arrayBufferTag:return u.byteLength!==f.byteLength?!1:c(new Uint8Array(u),new Uint8Array(f),d,p);case a.dataViewTag:return u.byteLength!==f.byteLength||u.byteOffset!==f.byteOffset?!1:c(new Uint8Array(u),new Uint8Array(f),d,p);case a.errorTag:return u.name===f.name&&u.message===f.message;case a.objectTag:{if(!(c(u.constructor,f.constructor,d,p)||t.isPlainObject(u)&&t.isPlainObject(f)))return!1;const E=[...Object.keys(u),...r.getSymbols(u)],A=[...Object.keys(f),...r.getSymbols(f)];if(E.length!==A.length)return!1;for(let C=0;C<E.length;C++){const N=E[C],F=u[N];if(!Object.hasOwn(f,N))return!1;const O=f[N];if(!o(F,O,N,u,f,d,p))return!1}return!0}default:return!1}}finally{d.delete(u),d.delete(f)}}e.isEqualWith=s})(PS);var CS={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(){}e.noop=t})(CS);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=PS,r=CS;function n(a,i){return t.isEqualWith(a,i,r.noop)}e.isEqual=n})(TS);var VR=TS.isEqual;const KR=zo(VR);var fh=1e-4,OS=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],LS=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),Xb=(e,t)=>r=>{var n=OS(e,t);return LS(n,r)},YR=(e,t)=>r=>{var n=OS(e,t),a=[...n.map((i,s)=>i*s).slice(1),0];return LS(a,r)},Zb=function(){for(var t,r,n,a,i=arguments.length,s=new Array(i),o=0;o<i;o++)s[o]=arguments[o];if(s.length===1)switch(s[0]){case"linear":[t,n,r,a]=[0,0,1,1];break;case"ease":[t,n,r,a]=[.25,.1,.25,1];break;case"ease-in":[t,n,r,a]=[.42,0,1,1];break;case"ease-out":[t,n,r,a]=[.42,0,.58,1];break;case"ease-in-out":[t,n,r,a]=[0,0,.58,1];break;default:{var c=s[0].split("(");c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4&&([t,n,r,a]=c[1].split(")")[0].split(",").map(x=>parseFloat(x)))}}else s.length===4&&([t,n,r,a]=s);var u=Xb(t,r),f=Xb(n,a),d=YR(t,r),p=x=>x>1?1:x<0?0:x,h=x=>{for(var g=x>1?1:x,y=g,b=0;b<8;++b){var E=u(y)-g,A=d(y);if(Math.abs(E-g)<fh||A<fh)return f(y);y=p(y-E/A)}return f(y)};return h.isStepper=!1,h},XR=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:a=17}=t,i=(s,o,c)=>{var u=-(s-o)*r,f=c*n,d=c+(u-f)*a/1e3,p=c*a/1e3+s;return Math.abs(p-o)<fh&&Math.abs(d)<fh?[o,0]:[p,d]};return i.isStepper=!0,i.dt=a,i},FS=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return Zb(e);case"spring":return XR();default:if(e.split("(")[0]==="cubic-bezier")return Zb(e)}return typeof e=="function"?e:null};function Jb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Qb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Jb(Object(r),!0).forEach(function(n){ZR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Jb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZR(e,t,r){return(t=JR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JR(e){var t=QR(e,"string");return typeof t=="symbol"?t:t+""}function QR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eB=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),tB=(e,t,r)=>e.map(n=>"".concat(eB(n)," ").concat(t,"ms ").concat(r)).join(","),rB=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(a=>n.includes(a))),If=(e,t)=>Object.keys(t).reduce((r,n)=>Qb(Qb({},r),{},{[n]:e(n,t[n])}),{});function ew(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function $n(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ew(Object(r),!0).forEach(function(n){nB(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ew(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nB(e,t,r){return(t=aB(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aB(e){var t=iB(e,"string");return typeof t=="symbol"?t:t+""}function iB(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dh=(e,t,r)=>e+(t-e)*r,dg=e=>{var{from:t,to:r}=e;return t!==r},DS=(e,t,r)=>{var n=If((a,i)=>{if(dg(i)){var[s,o]=e(i.from,i.to,i.velocity);return $n($n({},i),{},{from:s,velocity:o})}return i},t);return r<1?If((a,i)=>dg(i)?$n($n({},i),{},{velocity:dh(i.velocity,n[a].velocity,r),from:dh(i.from,n[a].from,r)}):i,t):DS(e,n,r-1)};function sB(e,t,r,n,a,i){var s,o=n.reduce((p,h)=>$n($n({},p),{},{[h]:{from:e[h],velocity:0,to:t[h]}}),{}),c=()=>If((p,h)=>h.from,o),u=()=>!Object.values(o).filter(dg).length,f=null,d=p=>{s||(s=p);var h=p-s,x=h/r.dt;o=DS(r,o,x),a($n($n($n({},e),t),c())),s=p,u()||(f=i.setTimeout(d))};return()=>(f=i.setTimeout(d),()=>{f()})}function oB(e,t,r,n,a,i,s){var o=null,c=a.reduce((d,p)=>$n($n({},d),{},{[p]:[e[p],t[p]]}),{}),u,f=d=>{u||(u=d);var p=(d-u)/n,h=If((g,y)=>dh(...y,r(p)),c);if(i($n($n($n({},e),t),h)),p<1)o=s.setTimeout(f);else{var x=If((g,y)=>dh(...y,r(1)),c);i($n($n($n({},e),t),x))}};return()=>(o=s.setTimeout(f),()=>{o()})}const IS=(e,t,r,n,a,i)=>{var s=rB(e,t);return r.isStepper===!0?sB(e,t,r,s,a,i):oB(e,t,r,n,s,a,i)};function lB(e){var t,r=()=>null,n=!1,a=null,i=s=>{if(!n){if(Array.isArray(s)){if(!s.length)return;var o=s,[c,...u]=o;if(typeof c=="number"){a=e.setTimeout(i.bind(null,u),c);return}i(c),a=e.setTimeout(i.bind(null,u));return}typeof s=="string"&&(t=s,r(t)),typeof s=="object"&&(t=s,r(t)),typeof s=="function"&&s()}};return{stop:()=>{n=!0},start:s=>{n=!1,a&&(a(),a=null),i(s)},subscribe:s=>(r=s,()=>{r=()=>null}),getTimeoutController:()=>e}}class cB{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),a=null,i=s=>{s-n>=r?t(s):typeof requestAnimationFrame=="function"&&(a=requestAnimationFrame(i))};return a=requestAnimationFrame(i),()=>{cancelAnimationFrame(a)}}}function uB(){return lB(new cB)}var fB=M.createContext(uB);function MS(e,t){var r=M.useContext(fB);return M.useMemo(()=>t??r(e),[e,t,r])}var dB=["children","begin","duration","attributeName","easing","isActive","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart","animationManager"];function hg(){return hg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},hg.apply(null,arguments)}function hB(e,t){if(e==null)return{};var r,n,a=pB(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function pB(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function tw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function po(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tw(Object(r),!0).forEach(function(n){pl(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function pl(e,t,r){return(t=mB(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function mB(e){var t=gB(e,"string");return typeof t=="symbol"?t:t+""}function gB(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class Vx extends M.PureComponent{constructor(t,r){super(t,r),pl(this,"mounted",!1),pl(this,"manager",void 0),pl(this,"stopJSAnimation",null),pl(this,"unSubscribe",null);var{isActive:n,attributeName:a,from:i,to:s,children:o,duration:c,animationManager:u}=this.props;if(this.manager=u,this.handleStyleChange=this.handleStyleChange.bind(this),this.changeStyle=this.changeStyle.bind(this),!n||c<=0){this.state={style:{}},typeof o=="function"&&(this.state={style:s});return}if(i){if(typeof o=="function"){this.state={style:i};return}this.state={style:a?{[a]:i}:i}}else this.state={style:{}}}componentDidMount(){var{isActive:t,canBegin:r}=this.props;this.mounted=!0,!(!t||!r)&&this.runAnimation(this.props)}componentDidUpdate(t){var{isActive:r,canBegin:n,attributeName:a,shouldReAnimate:i,to:s,from:o}=this.props,{style:c}=this.state;if(n){if(!r){var u={style:a?{[a]:s}:s};this.state&&c&&(a&&c[a]!==s||!a&&c!==s)&&this.setState(u);return}if(!(KR(t.to,s)&&t.canBegin&&t.isActive)){var f=!t.canBegin||!t.isActive;this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var d=f||i?o:t.to;if(this.state&&c){var p={style:a?{[a]:d}:d};(a&&c[a]!==d||!a&&c!==d)&&this.setState(p)}this.runAnimation(po(po({},this.props),{},{from:d,begin:0}))}}}componentWillUnmount(){this.mounted=!1;var{onAnimationEnd:t}=this.props;this.unSubscribe&&this.unSubscribe(),this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation(),t&&t()}handleStyleChange(t){this.changeStyle(t)}changeStyle(t){this.mounted&&this.setState({style:t})}runJSAnimation(t){var{from:r,to:n,duration:a,easing:i,begin:s,onAnimationEnd:o,onAnimationStart:c}=t,u=IS(r,n,FS(i),a,this.changeStyle,this.manager.getTimeoutController()),f=()=>{this.stopJSAnimation=u()};this.manager.start([c,s,f,a,o])}runAnimation(t){var{begin:r,duration:n,attributeName:a,to:i,easing:s,onAnimationStart:o,onAnimationEnd:c,children:u}=t;if(this.unSubscribe=this.manager.subscribe(this.handleStyleChange),typeof s=="function"||typeof u=="function"||s==="spring"){this.runJSAnimation(t);return}var f=a?{[a]:i}:i,d=tB(Object.keys(f),n,s);this.manager.start([o,r,po(po({},f),{},{transition:d}),n,c])}render(){var t=this.props,{children:r,begin:n,duration:a,attributeName:i,easing:s,isActive:o,from:c,to:u,canBegin:f,onAnimationEnd:d,shouldReAnimate:p,onAnimationReStart:h,animationManager:x}=t,g=hB(t,dB),y=M.Children.count(r),b=this.state.style;if(typeof r=="function")return r(b);if(!o||y===0||a<=0)return r;var E=A=>{var{style:C={},className:N}=A.props,F=M.cloneElement(A,po(po({},g),{},{style:po(po({},C),b),className:N}));return F};return y===1?E(M.Children.only(r)):M.createElement("div",null,M.Children.map(r,A=>E(A)))}}pl(Vx,"displayName","Animate");pl(Vx,"defaultProps",{begin:0,duration:1e3,attributeName:"",easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}});function hh(e){var t,r=MS((t=e.attributeName)!==null&&t!==void 0?t:Object.keys(e.to).join(","),e.animationManager);return M.createElement(Vx,hg({},e,{animationManager:r}))}function ph(){return ph=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ph.apply(null,arguments)}var rw=(e,t,r,n,a)=>{var i=Math.min(Math.abs(r)/2,Math.abs(n)/2),s=n>=0?1:-1,o=r>=0?1:-1,c=n>=0&&r>=0||n<0&&r<0?1:0,u;if(i>0&&a instanceof Array){for(var f=[0,0,0,0],d=0,p=4;d<p;d++)f[d]=a[d]>i?i:a[d];u="M".concat(e,",").concat(t+s*f[0]),f[0]>0&&(u+="A ".concat(f[0],",").concat(f[0],",0,0,").concat(c,",").concat(e+o*f[0],",").concat(t)),u+="L ".concat(e+r-o*f[1],",").concat(t),f[1]>0&&(u+="A ".concat(f[1],",").concat(f[1],",0,0,").concat(c,`,
        `).concat(e+r,",").concat(t+s*f[1])),u+="L ".concat(e+r,",").concat(t+n-s*f[2]),f[2]>0&&(u+="A ".concat(f[2],",").concat(f[2],",0,0,").concat(c,`,
        `).concat(e+r-o*f[2],",").concat(t+n)),u+="L ".concat(e+o*f[3],",").concat(t+n),f[3]>0&&(u+="A ".concat(f[3],",").concat(f[3],",0,0,").concat(c,`,
        `).concat(e,",").concat(t+n-s*f[3])),u+="Z"}else if(i>0&&a===+a&&a>0){var h=Math.min(i,a);u="M ".concat(e,",").concat(t+s*h,`
            A `).concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+o*h,",").concat(t,`
            L `).concat(e+r-o*h,",").concat(t,`
            A `).concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+r,",").concat(t+s*h,`
            L `).concat(e+r,",").concat(t+n-s*h,`
            A `).concat(h,",").concat(h,",0,0,").concat(c,",").concat(e+r-o*h,",").concat(t+n,`
            L `).concat(e+o*h,",").concat(t+n,`
            A `).concat(h,",").concat(h,",0,0,").concat(c,",").concat(e,",").concat(t+n-s*h," Z")}else u="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return u},xB={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},RS=e=>{var t=Wo(e,xB),r=M.useRef(null),[n,a]=M.useState(-1);M.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var b=r.current.getTotalLength();b&&a(b)}catch{}},[]);var{x:i,y:s,width:o,height:c,radius:u,className:f}=t,{animationEasing:d,animationDuration:p,animationBegin:h,isAnimationActive:x,isUpdateAnimationActive:g}=t;if(i!==+i||s!==+s||o!==+o||c!==+c||o===0||c===0)return null;var y=Pn("recharts-rectangle",f);return g?M.createElement(hh,{canBegin:n>0,from:{width:o,height:c,x:i,y:s},to:{width:o,height:c,x:i,y:s},duration:p,animationEasing:d,isActive:g},b=>{var{width:E,height:A,x:C,y:N}=b;return M.createElement(hh,{canBegin:n>0,from:"0px ".concat(n===-1?1:n,"px"),to:"".concat(n,"px 0px"),attributeName:"strokeDasharray",begin:h,duration:p,isActive:x,easing:d},M.createElement("path",ph({},Xa(t,!0),{className:y,d:rw(C,N,E,A,u),ref:r})))}):M.createElement("path",ph({},Xa(t,!0),{className:y,d:rw(i,s,o,c,u)}))};function BS(e){var{cx:t,cy:r,radius:n,startAngle:a,endAngle:i}=e,s=ta(t,r,n,a),o=ta(t,r,n,i);return{points:[s,o],cx:t,cy:r,radius:n,startAngle:a,endAngle:i}}function pg(){return pg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},pg.apply(null,arguments)}var vB=(e,t)=>{var r=Ha(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},ld=e=>{var{cx:t,cy:r,radius:n,angle:a,sign:i,isExternal:s,cornerRadius:o,cornerIsExternal:c}=e,u=o*(s?1:-1)+n,f=Math.asin(o/u)/ch,d=c?a:a+i*f,p=ta(t,r,u,d),h=ta(t,r,n,d),x=c?a-i*f:a,g=ta(t,r,u*Math.cos(f*ch),x);return{center:p,circleTangency:h,lineTangency:g,theta:f}},US=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:i,endAngle:s}=e,o=vB(i,s),c=i+o,u=ta(t,r,a,i),f=ta(t,r,a,c),d="M ".concat(u.x,",").concat(u.y,`
    A `).concat(a,",").concat(a,`,0,
    `).concat(+(Math.abs(o)>180),",").concat(+(i>c),`,
    `).concat(f.x,",").concat(f.y,`
  `);if(n>0){var p=ta(t,r,n,i),h=ta(t,r,n,c);d+="L ".concat(h.x,",").concat(h.y,`
            A `).concat(n,",").concat(n,`,0,
            `).concat(+(Math.abs(o)>180),",").concat(+(i<=c),`,
            `).concat(p.x,",").concat(p.y," Z")}else d+="L ".concat(t,",").concat(r," Z");return d},yB=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:a,cornerRadius:i,forceCornerRadius:s,cornerIsExternal:o,startAngle:c,endAngle:u}=e,f=Ha(u-c),{circleTangency:d,lineTangency:p,theta:h}=ld({cx:t,cy:r,radius:a,angle:c,sign:f,cornerRadius:i,cornerIsExternal:o}),{circleTangency:x,lineTangency:g,theta:y}=ld({cx:t,cy:r,radius:a,angle:u,sign:-f,cornerRadius:i,cornerIsExternal:o}),b=o?Math.abs(c-u):Math.abs(c-u)-h-y;if(b<0)return s?"M ".concat(p.x,",").concat(p.y,`
        a`).concat(i,",").concat(i,",0,0,1,").concat(i*2,`,0
        a`).concat(i,",").concat(i,",0,0,1,").concat(-i*2,`,0
      `):US({cx:t,cy:r,innerRadius:n,outerRadius:a,startAngle:c,endAngle:u});var E="M ".concat(p.x,",").concat(p.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(f<0),",").concat(d.x,",").concat(d.y,`
    A`).concat(a,",").concat(a,",0,").concat(+(b>180),",").concat(+(f<0),",").concat(x.x,",").concat(x.y,`
    A`).concat(i,",").concat(i,",0,0,").concat(+(f<0),",").concat(g.x,",").concat(g.y,`
  `);if(n>0){var{circleTangency:A,lineTangency:C,theta:N}=ld({cx:t,cy:r,radius:n,angle:c,sign:f,isExternal:!0,cornerRadius:i,cornerIsExternal:o}),{circleTangency:F,lineTangency:O,theta:I}=ld({cx:t,cy:r,radius:n,angle:u,sign:-f,isExternal:!0,cornerRadius:i,cornerIsExternal:o}),P=o?Math.abs(c-u):Math.abs(c-u)-N-I;if(P<0&&i===0)return"".concat(E,"L").concat(t,",").concat(r,"Z");E+="L".concat(O.x,",").concat(O.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(f<0),",").concat(F.x,",").concat(F.y,`
      A`).concat(n,",").concat(n,",0,").concat(+(P>180),",").concat(+(f>0),",").concat(A.x,",").concat(A.y,`
      A`).concat(i,",").concat(i,",0,0,").concat(+(f<0),",").concat(C.x,",").concat(C.y,"Z")}else E+="L".concat(t,",").concat(r,"Z");return E},bB={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},$S=e=>{var t=Wo(e,bB),{cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:s,forceCornerRadius:o,cornerIsExternal:c,startAngle:u,endAngle:f,className:d}=t;if(i<a||u===f)return null;var p=Pn("recharts-sector",d),h=i-a,x=ss(s,h,0,!0),g;return x>0&&Math.abs(u-f)<360?g=yB({cx:r,cy:n,innerRadius:a,outerRadius:i,cornerRadius:Math.min(x,h/2),forceCornerRadius:o,cornerIsExternal:c,startAngle:u,endAngle:f}):g=US({cx:r,cy:n,innerRadius:a,outerRadius:i,startAngle:u,endAngle:f}),M.createElement("path",pg({},Xa(t,!0),{className:p,d:g}))};function wB(e,t,r){var n,a,i,s;if(e==="horizontal")n=t.x,i=n,a=r.top,s=r.top+r.height;else if(e==="vertical")a=t.y,s=a,n=r.left,i=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:o,cy:c,innerRadius:u,outerRadius:f,angle:d}=t,p=ta(o,c,u,d),h=ta(o,c,f,d);n=p.x,a=p.y,i=h.x,s=h.y}else return BS(t);return[{x:n,y:a},{x:i,y:s}]}var zS={},qS={},WS={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Rx;function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r})(WS);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=WS;function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r})(qS);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Bx,r=qS;function n(a,i,s){s&&typeof s!="number"&&t.isIterateeCall(a,i,s)&&(i=s=void 0),a=r.toFinite(a),i===void 0?(i=a,a=0):i=r.toFinite(i),s=s===void 0?a<i?1:-1:r.toFinite(s);const o=Math.max(Math.ceil((i-a)/(s||1)),0),c=new Array(o);for(let u=0;u<o;u++)c[u]=a,a+=s;return c}e.range=n})(zS);var _B=zS.range;const HS=zo(_B);function ko(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function NB(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function Kx(e){let t,r,n;e.length!==2?(t=ko,r=(o,c)=>ko(e(o),c),n=(o,c)=>e(o)-c):(t=e===ko||e===NB?e:SB,r=e,n=e);function a(o,c,u=0,f=o.length){if(u<f){if(t(c,c)!==0)return f;do{const d=u+f>>>1;r(o[d],c)<0?u=d+1:f=d}while(u<f)}return u}function i(o,c,u=0,f=o.length){if(u<f){if(t(c,c)!==0)return f;do{const d=u+f>>>1;r(o[d],c)<=0?u=d+1:f=d}while(u<f)}return u}function s(o,c,u=0,f=o.length){const d=a(o,c,u,f-1);return d>u&&n(o[d-1],c)>-n(o[d],c)?d-1:d}return{left:a,center:s,right:i}}function SB(){return 0}function GS(e){return e===null?NaN:+e}function*AB(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const EB=Kx(ko),o0=EB.right;Kx(GS).center;class nw extends Map{constructor(t,r=PB){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,a]of t)this.set(n,a)}get(t){return super.get(aw(this,t))}has(t){return super.has(aw(this,t))}set(t,r){return super.set(jB(this,t),r)}delete(t){return super.delete(TB(this,t))}}function aw({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function jB({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function TB({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function PB(e){return e!==null&&typeof e=="object"?e.valueOf():e}function kB(e=ko){if(e===ko)return VS;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function VS(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const CB=Math.sqrt(50),OB=Math.sqrt(10),LB=Math.sqrt(2);function mh(e,t,r){const n=(t-e)/Math.max(0,r),a=Math.floor(Math.log10(n)),i=n/Math.pow(10,a),s=i>=CB?10:i>=OB?5:i>=LB?2:1;let o,c,u;return a<0?(u=Math.pow(10,-a)/s,o=Math.round(e*u),c=Math.round(t*u),o/u<e&&++o,c/u>t&&--c,u=-u):(u=Math.pow(10,a)*s,o=Math.round(e/u),c=Math.round(t/u),o*u<e&&++o,c*u>t&&--c),c<o&&.5<=r&&r<2?mh(e,t,r*2):[o,c,u]}function mg(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[a,i,s]=n?mh(t,e,r):mh(e,t,r);if(!(i>=a))return[];const o=i-a+1,c=new Array(o);if(n)if(s<0)for(let u=0;u<o;++u)c[u]=(i-u)/-s;else for(let u=0;u<o;++u)c[u]=(i-u)*s;else if(s<0)for(let u=0;u<o;++u)c[u]=(a+u)/-s;else for(let u=0;u<o;++u)c[u]=(a+u)*s;return c}function gg(e,t,r){return t=+t,e=+e,r=+r,mh(e,t,r)[2]}function xg(e,t,r){t=+t,e=+e,r=+r;const n=t<e,a=n?gg(t,e,r):gg(e,t,r);return(n?-1:1)*(a<0?1/-a:a)}function iw(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function sw(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function KS(e,t,r=0,n=1/0,a){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(a=a===void 0?VS:kB(a);n>r;){if(n-r>600){const c=n-r+1,u=t-r+1,f=Math.log(c),d=.5*Math.exp(2*f/3),p=.5*Math.sqrt(f*d*(c-d)/c)*(u-c/2<0?-1:1),h=Math.max(r,Math.floor(t-u*d/c+p)),x=Math.min(n,Math.floor(t+(c-u)*d/c+p));KS(e,t,h,x,a)}const i=e[t];let s=r,o=n;for(Qu(e,r,t),a(e[n],i)>0&&Qu(e,r,n);s<o;){for(Qu(e,s,o),++s,--o;a(e[s],i)<0;)++s;for(;a(e[o],i)>0;)--o}a(e[r],i)===0?Qu(e,r,o):(++o,Qu(e,o,n)),o<=t&&(r=o+1),t<=o&&(n=o-1)}return e}function Qu(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function FB(e,t,r){if(e=Float64Array.from(AB(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return sw(e);if(t>=1)return iw(e);var n,a=(n-1)*t,i=Math.floor(a),s=iw(KS(e,i).subarray(0,i+1)),o=sw(e.subarray(i+1));return s+(o-s)*(a-i)}}function DB(e,t,r=GS){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,a=(n-1)*t,i=Math.floor(a),s=+r(e[i],i,e),o=+r(e[i+1],i+1,e);return s+(o-s)*(a-i)}}function IB(e,t,r){e=+e,t=+t,r=(a=arguments.length)<2?(t=e,e=0,1):a<3?1:+r;for(var n=-1,a=Math.max(0,Math.ceil((t-e)/r))|0,i=new Array(a);++n<a;)i[n]=e+n*r;return i}function vi(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Ys(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const vg=Symbol("implicit");function Yx(){var e=new nw,t=[],r=[],n=vg;function a(i){let s=e.get(i);if(s===void 0){if(n!==vg)return n;e.set(i,s=t.push(i)-1)}return r[s%r.length]}return a.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new nw;for(const s of i)e.has(s)||e.set(s,t.push(s)-1);return a},a.range=function(i){return arguments.length?(r=Array.from(i),a):r.slice()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return Yx(t,r).unknown(n)},vi.apply(a,arguments),a}function Xx(){var e=Yx().unknown(void 0),t=e.domain,r=e.range,n=0,a=1,i,s,o=!1,c=0,u=0,f=.5;delete e.unknown;function d(){var p=t().length,h=a<n,x=h?a:n,g=h?n:a;i=(g-x)/Math.max(1,p-c+u*2),o&&(i=Math.floor(i)),x+=(g-x-i*(p-c))*f,s=i*(1-c),o&&(x=Math.round(x),s=Math.round(s));var y=IB(p).map(function(b){return x+i*b});return r(h?y.reverse():y)}return e.domain=function(p){return arguments.length?(t(p),d()):t()},e.range=function(p){return arguments.length?([n,a]=p,n=+n,a=+a,d()):[n,a]},e.rangeRound=function(p){return[n,a]=p,n=+n,a=+a,o=!0,d()},e.bandwidth=function(){return s},e.step=function(){return i},e.round=function(p){return arguments.length?(o=!!p,d()):o},e.padding=function(p){return arguments.length?(c=Math.min(1,u=+p),d()):c},e.paddingInner=function(p){return arguments.length?(c=Math.min(1,p),d()):c},e.paddingOuter=function(p){return arguments.length?(u=+p,d()):u},e.align=function(p){return arguments.length?(f=Math.max(0,Math.min(1,p)),d()):f},e.copy=function(){return Xx(t(),[n,a]).round(o).paddingInner(c).paddingOuter(u).align(f)},vi.apply(d(),arguments)}function YS(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return YS(t())},e}function MB(){return YS(Xx.apply(null,arguments).paddingInner(1))}function Zx(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function XS(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function l0(){}var Mf=.7,gh=1/Mf,Ic="\\s*([+-]?\\d+)\\s*",Rf="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",os="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",RB=/^#([0-9a-f]{3,8})$/,BB=new RegExp(`^rgb\\(${Ic},${Ic},${Ic}\\)$`),UB=new RegExp(`^rgb\\(${os},${os},${os}\\)$`),$B=new RegExp(`^rgba\\(${Ic},${Ic},${Ic},${Rf}\\)$`),zB=new RegExp(`^rgba\\(${os},${os},${os},${Rf}\\)$`),qB=new RegExp(`^hsl\\(${Rf},${os},${os}\\)$`),WB=new RegExp(`^hsla\\(${Rf},${os},${os},${Rf}\\)$`),ow={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Zx(l0,Bf,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:lw,formatHex:lw,formatHex8:HB,formatHsl:GB,formatRgb:cw,toString:cw});function lw(){return this.rgb().formatHex()}function HB(){return this.rgb().formatHex8()}function GB(){return ZS(this).formatHsl()}function cw(){return this.rgb().formatRgb()}function Bf(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=RB.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?uw(t):r===3?new Na(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?cd(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?cd(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=BB.exec(e))?new Na(t[1],t[2],t[3],1):(t=UB.exec(e))?new Na(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=$B.exec(e))?cd(t[1],t[2],t[3],t[4]):(t=zB.exec(e))?cd(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=qB.exec(e))?hw(t[1],t[2]/100,t[3]/100,1):(t=WB.exec(e))?hw(t[1],t[2]/100,t[3]/100,t[4]):ow.hasOwnProperty(e)?uw(ow[e]):e==="transparent"?new Na(NaN,NaN,NaN,0):null}function uw(e){return new Na(e>>16&255,e>>8&255,e&255,1)}function cd(e,t,r,n){return n<=0&&(e=t=r=NaN),new Na(e,t,r,n)}function VB(e){return e instanceof l0||(e=Bf(e)),e?(e=e.rgb(),new Na(e.r,e.g,e.b,e.opacity)):new Na}function yg(e,t,r,n){return arguments.length===1?VB(e):new Na(e,t,r,n??1)}function Na(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}Zx(Na,yg,XS(l0,{brighter(e){return e=e==null?gh:Math.pow(gh,e),new Na(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Mf:Math.pow(Mf,e),new Na(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Na(Tl(this.r),Tl(this.g),Tl(this.b),xh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:fw,formatHex:fw,formatHex8:KB,formatRgb:dw,toString:dw}));function fw(){return`#${ml(this.r)}${ml(this.g)}${ml(this.b)}`}function KB(){return`#${ml(this.r)}${ml(this.g)}${ml(this.b)}${ml((isNaN(this.opacity)?1:this.opacity)*255)}`}function dw(){const e=xh(this.opacity);return`${e===1?"rgb(":"rgba("}${Tl(this.r)}, ${Tl(this.g)}, ${Tl(this.b)}${e===1?")":`, ${e})`}`}function xh(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function Tl(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function ml(e){return e=Tl(e),(e<16?"0":"")+e.toString(16)}function hw(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Oi(e,t,r,n)}function ZS(e){if(e instanceof Oi)return new Oi(e.h,e.s,e.l,e.opacity);if(e instanceof l0||(e=Bf(e)),!e)return new Oi;if(e instanceof Oi)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,a=Math.min(t,r,n),i=Math.max(t,r,n),s=NaN,o=i-a,c=(i+a)/2;return o?(t===i?s=(r-n)/o+(r<n)*6:r===i?s=(n-t)/o+2:s=(t-r)/o+4,o/=c<.5?i+a:2-i-a,s*=60):o=c>0&&c<1?0:s,new Oi(s,o,c,e.opacity)}function YB(e,t,r,n){return arguments.length===1?ZS(e):new Oi(e,t,r,n??1)}function Oi(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}Zx(Oi,YB,XS(l0,{brighter(e){return e=e==null?gh:Math.pow(gh,e),new Oi(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Mf:Math.pow(Mf,e),new Oi(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,a=2*r-n;return new Na(Km(e>=240?e-240:e+120,a,n),Km(e,a,n),Km(e<120?e+240:e-120,a,n),this.opacity)},clamp(){return new Oi(pw(this.h),ud(this.s),ud(this.l),xh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=xh(this.opacity);return`${e===1?"hsl(":"hsla("}${pw(this.h)}, ${ud(this.s)*100}%, ${ud(this.l)*100}%${e===1?")":`, ${e})`}`}}));function pw(e){return e=(e||0)%360,e<0?e+360:e}function ud(e){return Math.max(0,Math.min(1,e||0))}function Km(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const Jx=e=>()=>e;function XB(e,t){return function(r){return e+r*t}}function ZB(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function JB(e){return(e=+e)==1?JS:function(t,r){return r-t?ZB(t,r,e):Jx(isNaN(t)?r:t)}}function JS(e,t){var r=t-e;return r?XB(e,r):Jx(isNaN(e)?t:e)}const mw=function e(t){var r=JB(t);function n(a,i){var s=r((a=yg(a)).r,(i=yg(i)).r),o=r(a.g,i.g),c=r(a.b,i.b),u=JS(a.opacity,i.opacity);return function(f){return a.r=s(f),a.g=o(f),a.b=c(f),a.opacity=u(f),a+""}}return n.gamma=e,n}(1);function QB(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),a;return function(i){for(a=0;a<r;++a)n[a]=e[a]*(1-i)+t[a]*i;return n}}function eU(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function tU(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,a=new Array(n),i=new Array(r),s;for(s=0;s<n;++s)a[s]=cu(e[s],t[s]);for(;s<r;++s)i[s]=t[s];return function(o){for(s=0;s<n;++s)i[s]=a[s](o);return i}}function rU(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function vh(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function nU(e,t){var r={},n={},a;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(a in t)a in e?r[a]=cu(e[a],t[a]):n[a]=t[a];return function(i){for(a in r)n[a]=r[a](i);return n}}var bg=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ym=new RegExp(bg.source,"g");function aU(e){return function(){return e}}function iU(e){return function(t){return e(t)+""}}function sU(e,t){var r=bg.lastIndex=Ym.lastIndex=0,n,a,i,s=-1,o=[],c=[];for(e=e+"",t=t+"";(n=bg.exec(e))&&(a=Ym.exec(t));)(i=a.index)>r&&(i=t.slice(r,i),o[s]?o[s]+=i:o[++s]=i),(n=n[0])===(a=a[0])?o[s]?o[s]+=a:o[++s]=a:(o[++s]=null,c.push({i:s,x:vh(n,a)})),r=Ym.lastIndex;return r<t.length&&(i=t.slice(r),o[s]?o[s]+=i:o[++s]=i),o.length<2?c[0]?iU(c[0].x):aU(t):(t=c.length,function(u){for(var f=0,d;f<t;++f)o[(d=c[f]).i]=d.x(u);return o.join("")})}function cu(e,t){var r=typeof t,n;return t==null||r==="boolean"?Jx(t):(r==="number"?vh:r==="string"?(n=Bf(t))?(t=n,mw):sU:t instanceof Bf?mw:t instanceof Date?rU:eU(t)?QB:Array.isArray(t)?tU:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?nU:vh)(e,t)}function Qx(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function oU(e,t){t===void 0&&(t=e,e=cu);for(var r=0,n=t.length-1,a=t[0],i=new Array(n<0?0:n);r<n;)i[r]=e(a,a=t[++r]);return function(s){var o=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return i[o](s-o)}}function lU(e){return function(){return e}}function yh(e){return+e}var gw=[0,1];function ha(e){return e}function wg(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:lU(isNaN(t)?NaN:.5)}function cU(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function uU(e,t,r){var n=e[0],a=e[1],i=t[0],s=t[1];return a<n?(n=wg(a,n),i=r(s,i)):(n=wg(n,a),i=r(i,s)),function(o){return i(n(o))}}function fU(e,t,r){var n=Math.min(e.length,t.length)-1,a=new Array(n),i=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<n;)a[s]=wg(e[s],e[s+1]),i[s]=r(t[s],t[s+1]);return function(o){var c=o0(e,o,1,n)-1;return i[c](a[c](o))}}function c0(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function Sp(){var e=gw,t=gw,r=cu,n,a,i,s=ha,o,c,u;function f(){var p=Math.min(e.length,t.length);return s!==ha&&(s=cU(e[0],e[p-1])),o=p>2?fU:uU,c=u=null,d}function d(p){return p==null||isNaN(p=+p)?i:(c||(c=o(e.map(n),t,r)))(n(s(p)))}return d.invert=function(p){return s(a((u||(u=o(t,e.map(n),vh)))(p)))},d.domain=function(p){return arguments.length?(e=Array.from(p,yh),f()):e.slice()},d.range=function(p){return arguments.length?(t=Array.from(p),f()):t.slice()},d.rangeRound=function(p){return t=Array.from(p),r=Qx,f()},d.clamp=function(p){return arguments.length?(s=p?!0:ha,f()):s!==ha},d.interpolate=function(p){return arguments.length?(r=p,f()):r},d.unknown=function(p){return arguments.length?(i=p,d):i},function(p,h){return n=p,a=h,f()}}function ev(){return Sp()(ha,ha)}function dU(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function bh(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Zc(e){return e=bh(Math.abs(e)),e?e[1]:NaN}function hU(e,t){return function(r,n){for(var a=r.length,i=[],s=0,o=e[0],c=0;a>0&&o>0&&(c+o+1>n&&(o=Math.max(1,n-c)),i.push(r.substring(a-=o,a+o)),!((c+=o+1)>n));)o=e[s=(s+1)%e.length];return i.reverse().join(t)}}function pU(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var mU=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Uf(e){if(!(t=mU.exec(e)))throw new Error("invalid format: "+e);var t;return new tv({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Uf.prototype=tv.prototype;function tv(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}tv.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function gU(e){e:for(var t=e.length,r=1,n=-1,a;r<t;++r)switch(e[r]){case".":n=a=r;break;case"0":n===0&&(n=r),a=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(a+1):e}var QS;function xU(e,t){var r=bh(e,t);if(!r)return e+"";var n=r[0],a=r[1],i=a-(QS=Math.max(-8,Math.min(8,Math.floor(a/3)))*3)+1,s=n.length;return i===s?n:i>s?n+new Array(i-s+1).join("0"):i>0?n.slice(0,i)+"."+n.slice(i):"0."+new Array(1-i).join("0")+bh(e,Math.max(0,t+i-1))[0]}function xw(e,t){var r=bh(e,t);if(!r)return e+"";var n=r[0],a=r[1];return a<0?"0."+new Array(-a).join("0")+n:n.length>a+1?n.slice(0,a+1)+"."+n.slice(a+1):n+new Array(a-n.length+2).join("0")}const vw={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:dU,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>xw(e*100,t),r:xw,s:xU,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function yw(e){return e}var bw=Array.prototype.map,ww=["y","z","a","f","p","n","¬µ","m","","k","M","G","T","P","E","Z","Y"];function vU(e){var t=e.grouping===void 0||e.thousands===void 0?yw:hU(bw.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",a=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?yw:pU(bw.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"‚àí":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(d){d=Uf(d);var p=d.fill,h=d.align,x=d.sign,g=d.symbol,y=d.zero,b=d.width,E=d.comma,A=d.precision,C=d.trim,N=d.type;N==="n"?(E=!0,N="g"):vw[N]||(A===void 0&&(A=12),C=!0,N="g"),(y||p==="0"&&h==="=")&&(y=!0,p="0",h="=");var F=g==="$"?r:g==="#"&&/[boxX]/.test(N)?"0"+N.toLowerCase():"",O=g==="$"?n:/[%p]/.test(N)?s:"",I=vw[N],P=/[defgprs%]/.test(N);A=A===void 0?6:/[gprs]/.test(N)?Math.max(1,Math.min(21,A)):Math.max(0,Math.min(20,A));function H(T){var j=F,z=O,K,he,be;if(N==="c")z=I(T)+z,T="";else{T=+T;var we=T<0||1/T<0;if(T=isNaN(T)?c:I(Math.abs(T),A),C&&(T=gU(T)),we&&+T==0&&x!=="+"&&(we=!1),j=(we?x==="("?x:o:x==="-"||x==="("?"":x)+j,z=(N==="s"?ww[8+QS/3]:"")+z+(we&&x==="("?")":""),P){for(K=-1,he=T.length;++K<he;)if(be=T.charCodeAt(K),48>be||be>57){z=(be===46?a+T.slice(K+1):T.slice(K))+z,T=T.slice(0,K);break}}}E&&!y&&(T=t(T,1/0));var Q=j.length+T.length+z.length,le=Q<b?new Array(b-Q+1).join(p):"";switch(E&&y&&(T=t(le+T,le.length?b-z.length:1/0),le=""),h){case"<":T=j+T+z+le;break;case"=":T=j+le+T+z;break;case"^":T=le.slice(0,Q=le.length>>1)+j+T+z+le.slice(Q);break;default:T=le+j+T+z;break}return i(T)}return H.toString=function(){return d+""},H}function f(d,p){var h=u((d=Uf(d),d.type="f",d)),x=Math.max(-8,Math.min(8,Math.floor(Zc(p)/3)))*3,g=Math.pow(10,-x),y=ww[8+x/3];return function(b){return h(g*b)+y}}return{format:u,formatPrefix:f}}var fd,rv,e6;yU({thousands:",",grouping:[3],currency:["$",""]});function yU(e){return fd=vU(e),rv=fd.format,e6=fd.formatPrefix,fd}function bU(e){return Math.max(0,-Zc(Math.abs(e)))}function wU(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Zc(t)/3)))*3-Zc(Math.abs(e)))}function _U(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Zc(t)-Zc(e))+1}function t6(e,t,r,n){var a=xg(e,t,r),i;switch(n=Uf(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(i=wU(a,s))&&(n.precision=i),e6(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(i=_U(a,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=i-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(i=bU(a))&&(n.precision=i-(n.type==="%")*2);break}}return rv(n)}function Ho(e){var t=e.domain;return e.ticks=function(r){var n=t();return mg(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var a=t();return t6(a[0],a[a.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),a=0,i=n.length-1,s=n[a],o=n[i],c,u,f=10;for(o<s&&(u=s,s=o,o=u,u=a,a=i,i=u);f-- >0;){if(u=gg(s,o,r),u===c)return n[a]=s,n[i]=o,t(n);if(u>0)s=Math.floor(s/u)*u,o=Math.ceil(o/u)*u;else if(u<0)s=Math.ceil(s*u)/u,o=Math.floor(o*u)/u;else break;c=u}return e},e}function r6(){var e=ev();return e.copy=function(){return c0(e,r6())},vi.apply(e,arguments),Ho(e)}function n6(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,yh),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return n6(e).unknown(t)},e=arguments.length?Array.from(e,yh):[0,1],Ho(r)}function a6(e,t){e=e.slice();var r=0,n=e.length-1,a=e[r],i=e[n],s;return i<a&&(s=r,r=n,n=s,s=a,a=i,i=s),e[r]=t.floor(a),e[n]=t.ceil(i),e}function _w(e){return Math.log(e)}function Nw(e){return Math.exp(e)}function NU(e){return-Math.log(-e)}function SU(e){return-Math.exp(-e)}function AU(e){return isFinite(e)?+("1e"+e):e<0?0:e}function EU(e){return e===10?AU:e===Math.E?Math.exp:t=>Math.pow(e,t)}function jU(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function Sw(e){return(t,r)=>-e(-t,r)}function nv(e){const t=e(_w,Nw),r=t.domain;let n=10,a,i;function s(){return a=jU(n),i=EU(n),r()[0]<0?(a=Sw(a),i=Sw(i),e(NU,SU)):e(_w,Nw),t}return t.base=function(o){return arguments.length?(n=+o,s()):n},t.domain=function(o){return arguments.length?(r(o),s()):r()},t.ticks=o=>{const c=r();let u=c[0],f=c[c.length-1];const d=f<u;d&&([u,f]=[f,u]);let p=a(u),h=a(f),x,g;const y=o==null?10:+o;let b=[];if(!(n%1)&&h-p<y){if(p=Math.floor(p),h=Math.ceil(h),u>0){for(;p<=h;++p)for(x=1;x<n;++x)if(g=p<0?x/i(-p):x*i(p),!(g<u)){if(g>f)break;b.push(g)}}else for(;p<=h;++p)for(x=n-1;x>=1;--x)if(g=p>0?x/i(-p):x*i(p),!(g<u)){if(g>f)break;b.push(g)}b.length*2<y&&(b=mg(u,f,y))}else b=mg(p,h,Math.min(h-p,y)).map(i);return d?b.reverse():b},t.tickFormat=(o,c)=>{if(o==null&&(o=10),c==null&&(c=n===10?"s":","),typeof c!="function"&&(!(n%1)&&(c=Uf(c)).precision==null&&(c.trim=!0),c=rv(c)),o===1/0)return c;const u=Math.max(1,n*o/t.ticks().length);return f=>{let d=f/i(Math.round(a(f)));return d*n<n-.5&&(d*=n),d<=u?c(f):""}},t.nice=()=>r(a6(r(),{floor:o=>i(Math.floor(a(o))),ceil:o=>i(Math.ceil(a(o)))})),t}function i6(){const e=nv(Sp()).domain([1,10]);return e.copy=()=>c0(e,i6()).base(e.base()),vi.apply(e,arguments),e}function Aw(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Ew(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function av(e){var t=1,r=e(Aw(t),Ew(t));return r.constant=function(n){return arguments.length?e(Aw(t=+n),Ew(t)):t},Ho(r)}function s6(){var e=av(Sp());return e.copy=function(){return c0(e,s6()).constant(e.constant())},vi.apply(e,arguments)}function jw(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function TU(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function PU(e){return e<0?-e*e:e*e}function iv(e){var t=e(ha,ha),r=1;function n(){return r===1?e(ha,ha):r===.5?e(TU,PU):e(jw(r),jw(1/r))}return t.exponent=function(a){return arguments.length?(r=+a,n()):r},Ho(t)}function sv(){var e=iv(Sp());return e.copy=function(){return c0(e,sv()).exponent(e.exponent())},vi.apply(e,arguments),e}function kU(){return sv.apply(null,arguments).exponent(.5)}function Tw(e){return Math.sign(e)*e*e}function CU(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function o6(){var e=ev(),t=[0,1],r=!1,n;function a(i){var s=CU(e(i));return isNaN(s)?n:r?Math.round(s):s}return a.invert=function(i){return e.invert(Tw(i))},a.domain=function(i){return arguments.length?(e.domain(i),a):e.domain()},a.range=function(i){return arguments.length?(e.range((t=Array.from(i,yh)).map(Tw)),a):t.slice()},a.rangeRound=function(i){return a.range(i).round(!0)},a.round=function(i){return arguments.length?(r=!!i,a):r},a.clamp=function(i){return arguments.length?(e.clamp(i),a):e.clamp()},a.unknown=function(i){return arguments.length?(n=i,a):n},a.copy=function(){return o6(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},vi.apply(a,arguments),Ho(a)}function l6(){var e=[],t=[],r=[],n;function a(){var s=0,o=Math.max(1,t.length);for(r=new Array(o-1);++s<o;)r[s-1]=DB(e,s/o);return i}function i(s){return s==null||isNaN(s=+s)?n:t[o0(r,s)]}return i.invertExtent=function(s){var o=t.indexOf(s);return o<0?[NaN,NaN]:[o>0?r[o-1]:e[0],o<r.length?r[o]:e[e.length-1]]},i.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let o of s)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(ko),a()},i.range=function(s){return arguments.length?(t=Array.from(s),a()):t.slice()},i.unknown=function(s){return arguments.length?(n=s,i):n},i.quantiles=function(){return r.slice()},i.copy=function(){return l6().domain(e).range(t).unknown(n)},vi.apply(i,arguments)}function c6(){var e=0,t=1,r=1,n=[.5],a=[0,1],i;function s(c){return c!=null&&c<=c?a[o0(n,c,0,r)]:i}function o(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return s}return s.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,o()):[e,t]},s.range=function(c){return arguments.length?(r=(a=Array.from(c)).length-1,o()):a.slice()},s.invertExtent=function(c){var u=a.indexOf(c);return u<0?[NaN,NaN]:u<1?[e,n[0]]:u>=r?[n[r-1],t]:[n[u-1],n[u]]},s.unknown=function(c){return arguments.length&&(i=c),s},s.thresholds=function(){return n.slice()},s.copy=function(){return c6().domain([e,t]).range(a).unknown(i)},vi.apply(Ho(s),arguments)}function u6(){var e=[.5],t=[0,1],r,n=1;function a(i){return i!=null&&i<=i?t[o0(e,i,0,n)]:r}return a.domain=function(i){return arguments.length?(e=Array.from(i),n=Math.min(e.length,t.length-1),a):e.slice()},a.range=function(i){return arguments.length?(t=Array.from(i),n=Math.min(e.length,t.length-1),a):t.slice()},a.invertExtent=function(i){var s=t.indexOf(i);return[e[s-1],e[s]]},a.unknown=function(i){return arguments.length?(r=i,a):r},a.copy=function(){return u6().domain(e).range(t).unknown(r)},vi.apply(a,arguments)}const Xm=new Date,Zm=new Date;function yn(e,t,r,n){function a(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return a.floor=i=>(e(i=new Date(+i)),i),a.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),a.round=i=>{const s=a(i),o=a.ceil(i);return i-s<o-i?s:o},a.offset=(i,s)=>(t(i=new Date(+i),s==null?1:Math.floor(s)),i),a.range=(i,s,o)=>{const c=[];if(i=a.ceil(i),o=o==null?1:Math.floor(o),!(i<s)||!(o>0))return c;let u;do c.push(u=new Date(+i)),t(i,o),e(i);while(u<i&&i<s);return c},a.filter=i=>yn(s=>{if(s>=s)for(;e(s),!i(s);)s.setTime(s-1)},(s,o)=>{if(s>=s)if(o<0)for(;++o<=0;)for(;t(s,-1),!i(s););else for(;--o>=0;)for(;t(s,1),!i(s););}),r&&(a.count=(i,s)=>(Xm.setTime(+i),Zm.setTime(+s),e(Xm),e(Zm),Math.floor(r(Xm,Zm))),a.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?a.filter(n?s=>n(s)%i===0:s=>a.count(0,s)%i===0):a)),a}const wh=yn(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);wh.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?yn(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):wh);wh.range;const ks=1e3,di=ks*60,Cs=di*60,$s=Cs*24,ov=$s*7,Pw=$s*30,Jm=$s*365,gl=yn(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*ks)},(e,t)=>(t-e)/ks,e=>e.getUTCSeconds());gl.range;const lv=yn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*ks)},(e,t)=>{e.setTime(+e+t*di)},(e,t)=>(t-e)/di,e=>e.getMinutes());lv.range;const cv=yn(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*di)},(e,t)=>(t-e)/di,e=>e.getUTCMinutes());cv.range;const uv=yn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*ks-e.getMinutes()*di)},(e,t)=>{e.setTime(+e+t*Cs)},(e,t)=>(t-e)/Cs,e=>e.getHours());uv.range;const fv=yn(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*Cs)},(e,t)=>(t-e)/Cs,e=>e.getUTCHours());fv.range;const u0=yn(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*di)/$s,e=>e.getDate()-1);u0.range;const Ap=yn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/$s,e=>e.getUTCDate()-1);Ap.range;const f6=yn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/$s,e=>Math.floor(e/$s));f6.range;function Kl(e){return yn(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*di)/ov)}const Ep=Kl(0),_h=Kl(1),OU=Kl(2),LU=Kl(3),Jc=Kl(4),FU=Kl(5),DU=Kl(6);Ep.range;_h.range;OU.range;LU.range;Jc.range;FU.range;DU.range;function Yl(e){return yn(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/ov)}const jp=Yl(0),Nh=Yl(1),IU=Yl(2),MU=Yl(3),Qc=Yl(4),RU=Yl(5),BU=Yl(6);jp.range;Nh.range;IU.range;MU.range;Qc.range;RU.range;BU.range;const dv=yn(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());dv.range;const hv=yn(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());hv.range;const zs=yn(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());zs.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:yn(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});zs.range;const qs=yn(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());qs.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:yn(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});qs.range;function d6(e,t,r,n,a,i){const s=[[gl,1,ks],[gl,5,5*ks],[gl,15,15*ks],[gl,30,30*ks],[i,1,di],[i,5,5*di],[i,15,15*di],[i,30,30*di],[a,1,Cs],[a,3,3*Cs],[a,6,6*Cs],[a,12,12*Cs],[n,1,$s],[n,2,2*$s],[r,1,ov],[t,1,Pw],[t,3,3*Pw],[e,1,Jm]];function o(u,f,d){const p=f<u;p&&([u,f]=[f,u]);const h=d&&typeof d.range=="function"?d:c(u,f,d),x=h?h.range(u,+f+1):[];return p?x.reverse():x}function c(u,f,d){const p=Math.abs(f-u)/d,h=Kx(([,,y])=>y).right(s,p);if(h===s.length)return e.every(xg(u/Jm,f/Jm,d));if(h===0)return wh.every(Math.max(xg(u,f,d),1));const[x,g]=s[p/s[h-1][2]<s[h][2]/p?h-1:h];return x.every(g)}return[o,c]}const[UU,$U]=d6(qs,hv,jp,f6,fv,cv),[zU,qU]=d6(zs,dv,Ep,u0,uv,lv);function Qm(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function e1(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function ef(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function WU(e){var t=e.dateTime,r=e.date,n=e.time,a=e.periods,i=e.days,s=e.shortDays,o=e.months,c=e.shortMonths,u=tf(a),f=rf(a),d=tf(i),p=rf(i),h=tf(s),x=rf(s),g=tf(o),y=rf(o),b=tf(c),E=rf(c),A={a:we,A:Q,b:le,B:ke,c:null,d:Dw,e:Dw,f:h$,g:N$,G:A$,H:u$,I:f$,j:d$,L:h6,m:p$,M:m$,p:ve,q:S,Q:Rw,s:Bw,S:g$,u:x$,U:v$,V:y$,w:b$,W:w$,x:null,X:null,y:_$,Y:S$,Z:E$,"%":Mw},C={a:L,A:D,b:R,B:X,c:null,d:Iw,e:Iw,f:k$,g:U$,G:z$,H:j$,I:T$,j:P$,L:m6,m:C$,M:O$,p:de,q:me,Q:Rw,s:Bw,S:L$,u:F$,U:D$,V:I$,w:M$,W:R$,x:null,X:null,y:B$,Y:$$,Z:q$,"%":Mw},N={a:H,A:T,b:j,B:z,c:K,d:Lw,e:Lw,f:s$,g:Ow,G:Cw,H:Fw,I:Fw,j:r$,L:i$,m:t$,M:n$,p:P,q:e$,Q:l$,s:c$,S:a$,u:YU,U:XU,V:ZU,w:KU,W:JU,x:he,X:be,y:Ow,Y:Cw,Z:QU,"%":o$};A.x=F(r,A),A.X=F(n,A),A.c=F(t,A),C.x=F(r,C),C.X=F(n,C),C.c=F(t,C);function F(Y,oe){return function(ue){var fe=[],Ue=-1,xe=0,te=Y.length,nt,Re,ot;for(ue instanceof Date||(ue=new Date(+ue));++Ue<te;)Y.charCodeAt(Ue)===37&&(fe.push(Y.slice(xe,Ue)),(Re=kw[nt=Y.charAt(++Ue)])!=null?nt=Y.charAt(++Ue):Re=nt==="e"?" ":"0",(ot=oe[nt])&&(nt=ot(ue,Re)),fe.push(nt),xe=Ue+1);return fe.push(Y.slice(xe,Ue)),fe.join("")}}function O(Y,oe){return function(ue){var fe=ef(1900,void 0,1),Ue=I(fe,Y,ue+="",0),xe,te;if(Ue!=ue.length)return null;if("Q"in fe)return new Date(fe.Q);if("s"in fe)return new Date(fe.s*1e3+("L"in fe?fe.L:0));if(oe&&!("Z"in fe)&&(fe.Z=0),"p"in fe&&(fe.H=fe.H%12+fe.p*12),fe.m===void 0&&(fe.m="q"in fe?fe.q:0),"V"in fe){if(fe.V<1||fe.V>53)return null;"w"in fe||(fe.w=1),"Z"in fe?(xe=e1(ef(fe.y,0,1)),te=xe.getUTCDay(),xe=te>4||te===0?Nh.ceil(xe):Nh(xe),xe=Ap.offset(xe,(fe.V-1)*7),fe.y=xe.getUTCFullYear(),fe.m=xe.getUTCMonth(),fe.d=xe.getUTCDate()+(fe.w+6)%7):(xe=Qm(ef(fe.y,0,1)),te=xe.getDay(),xe=te>4||te===0?_h.ceil(xe):_h(xe),xe=u0.offset(xe,(fe.V-1)*7),fe.y=xe.getFullYear(),fe.m=xe.getMonth(),fe.d=xe.getDate()+(fe.w+6)%7)}else("W"in fe||"U"in fe)&&("w"in fe||(fe.w="u"in fe?fe.u%7:"W"in fe?1:0),te="Z"in fe?e1(ef(fe.y,0,1)).getUTCDay():Qm(ef(fe.y,0,1)).getDay(),fe.m=0,fe.d="W"in fe?(fe.w+6)%7+fe.W*7-(te+5)%7:fe.w+fe.U*7-(te+6)%7);return"Z"in fe?(fe.H+=fe.Z/100|0,fe.M+=fe.Z%100,e1(fe)):Qm(fe)}}function I(Y,oe,ue,fe){for(var Ue=0,xe=oe.length,te=ue.length,nt,Re;Ue<xe;){if(fe>=te)return-1;if(nt=oe.charCodeAt(Ue++),nt===37){if(nt=oe.charAt(Ue++),Re=N[nt in kw?oe.charAt(Ue++):nt],!Re||(fe=Re(Y,ue,fe))<0)return-1}else if(nt!=ue.charCodeAt(fe++))return-1}return fe}function P(Y,oe,ue){var fe=u.exec(oe.slice(ue));return fe?(Y.p=f.get(fe[0].toLowerCase()),ue+fe[0].length):-1}function H(Y,oe,ue){var fe=h.exec(oe.slice(ue));return fe?(Y.w=x.get(fe[0].toLowerCase()),ue+fe[0].length):-1}function T(Y,oe,ue){var fe=d.exec(oe.slice(ue));return fe?(Y.w=p.get(fe[0].toLowerCase()),ue+fe[0].length):-1}function j(Y,oe,ue){var fe=b.exec(oe.slice(ue));return fe?(Y.m=E.get(fe[0].toLowerCase()),ue+fe[0].length):-1}function z(Y,oe,ue){var fe=g.exec(oe.slice(ue));return fe?(Y.m=y.get(fe[0].toLowerCase()),ue+fe[0].length):-1}function K(Y,oe,ue){return I(Y,t,oe,ue)}function he(Y,oe,ue){return I(Y,r,oe,ue)}function be(Y,oe,ue){return I(Y,n,oe,ue)}function we(Y){return s[Y.getDay()]}function Q(Y){return i[Y.getDay()]}function le(Y){return c[Y.getMonth()]}function ke(Y){return o[Y.getMonth()]}function ve(Y){return a[+(Y.getHours()>=12)]}function S(Y){return 1+~~(Y.getMonth()/3)}function L(Y){return s[Y.getUTCDay()]}function D(Y){return i[Y.getUTCDay()]}function R(Y){return c[Y.getUTCMonth()]}function X(Y){return o[Y.getUTCMonth()]}function de(Y){return a[+(Y.getUTCHours()>=12)]}function me(Y){return 1+~~(Y.getUTCMonth()/3)}return{format:function(Y){var oe=F(Y+="",A);return oe.toString=function(){return Y},oe},parse:function(Y){var oe=O(Y+="",!1);return oe.toString=function(){return Y},oe},utcFormat:function(Y){var oe=F(Y+="",C);return oe.toString=function(){return Y},oe},utcParse:function(Y){var oe=O(Y+="",!0);return oe.toString=function(){return Y},oe}}}var kw={"-":"",_:" ",0:"0"},kn=/^\s*\d+/,HU=/^%/,GU=/[\\^$*+?|[\]().{}]/g;function Jt(e,t,r){var n=e<0?"-":"",a=(n?-e:e)+"",i=a.length;return n+(i<r?new Array(r-i+1).join(t)+a:a)}function VU(e){return e.replace(GU,"\\$&")}function tf(e){return new RegExp("^(?:"+e.map(VU).join("|")+")","i")}function rf(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function KU(e,t,r){var n=kn.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function YU(e,t,r){var n=kn.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function XU(e,t,r){var n=kn.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function ZU(e,t,r){var n=kn.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function JU(e,t,r){var n=kn.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function Cw(e,t,r){var n=kn.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function Ow(e,t,r){var n=kn.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function QU(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function e$(e,t,r){var n=kn.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function t$(e,t,r){var n=kn.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function Lw(e,t,r){var n=kn.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function r$(e,t,r){var n=kn.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function Fw(e,t,r){var n=kn.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function n$(e,t,r){var n=kn.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function a$(e,t,r){var n=kn.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function i$(e,t,r){var n=kn.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function s$(e,t,r){var n=kn.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function o$(e,t,r){var n=HU.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function l$(e,t,r){var n=kn.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function c$(e,t,r){var n=kn.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function Dw(e,t){return Jt(e.getDate(),t,2)}function u$(e,t){return Jt(e.getHours(),t,2)}function f$(e,t){return Jt(e.getHours()%12||12,t,2)}function d$(e,t){return Jt(1+u0.count(zs(e),e),t,3)}function h6(e,t){return Jt(e.getMilliseconds(),t,3)}function h$(e,t){return h6(e,t)+"000"}function p$(e,t){return Jt(e.getMonth()+1,t,2)}function m$(e,t){return Jt(e.getMinutes(),t,2)}function g$(e,t){return Jt(e.getSeconds(),t,2)}function x$(e){var t=e.getDay();return t===0?7:t}function v$(e,t){return Jt(Ep.count(zs(e)-1,e),t,2)}function p6(e){var t=e.getDay();return t>=4||t===0?Jc(e):Jc.ceil(e)}function y$(e,t){return e=p6(e),Jt(Jc.count(zs(e),e)+(zs(e).getDay()===4),t,2)}function b$(e){return e.getDay()}function w$(e,t){return Jt(_h.count(zs(e)-1,e),t,2)}function _$(e,t){return Jt(e.getFullYear()%100,t,2)}function N$(e,t){return e=p6(e),Jt(e.getFullYear()%100,t,2)}function S$(e,t){return Jt(e.getFullYear()%1e4,t,4)}function A$(e,t){var r=e.getDay();return e=r>=4||r===0?Jc(e):Jc.ceil(e),Jt(e.getFullYear()%1e4,t,4)}function E$(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Jt(t/60|0,"0",2)+Jt(t%60,"0",2)}function Iw(e,t){return Jt(e.getUTCDate(),t,2)}function j$(e,t){return Jt(e.getUTCHours(),t,2)}function T$(e,t){return Jt(e.getUTCHours()%12||12,t,2)}function P$(e,t){return Jt(1+Ap.count(qs(e),e),t,3)}function m6(e,t){return Jt(e.getUTCMilliseconds(),t,3)}function k$(e,t){return m6(e,t)+"000"}function C$(e,t){return Jt(e.getUTCMonth()+1,t,2)}function O$(e,t){return Jt(e.getUTCMinutes(),t,2)}function L$(e,t){return Jt(e.getUTCSeconds(),t,2)}function F$(e){var t=e.getUTCDay();return t===0?7:t}function D$(e,t){return Jt(jp.count(qs(e)-1,e),t,2)}function g6(e){var t=e.getUTCDay();return t>=4||t===0?Qc(e):Qc.ceil(e)}function I$(e,t){return e=g6(e),Jt(Qc.count(qs(e),e)+(qs(e).getUTCDay()===4),t,2)}function M$(e){return e.getUTCDay()}function R$(e,t){return Jt(Nh.count(qs(e)-1,e),t,2)}function B$(e,t){return Jt(e.getUTCFullYear()%100,t,2)}function U$(e,t){return e=g6(e),Jt(e.getUTCFullYear()%100,t,2)}function $$(e,t){return Jt(e.getUTCFullYear()%1e4,t,4)}function z$(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Qc(e):Qc.ceil(e),Jt(e.getUTCFullYear()%1e4,t,4)}function q$(){return"+0000"}function Mw(){return"%"}function Rw(e){return+e}function Bw(e){return Math.floor(+e/1e3)}var mc,x6,v6;W$({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function W$(e){return mc=WU(e),x6=mc.format,mc.parse,v6=mc.utcFormat,mc.utcParse,mc}function H$(e){return new Date(e)}function G$(e){return e instanceof Date?+e:+new Date(+e)}function pv(e,t,r,n,a,i,s,o,c,u){var f=ev(),d=f.invert,p=f.domain,h=u(".%L"),x=u(":%S"),g=u("%I:%M"),y=u("%I %p"),b=u("%a %d"),E=u("%b %d"),A=u("%B"),C=u("%Y");function N(F){return(c(F)<F?h:o(F)<F?x:s(F)<F?g:i(F)<F?y:n(F)<F?a(F)<F?b:E:r(F)<F?A:C)(F)}return f.invert=function(F){return new Date(d(F))},f.domain=function(F){return arguments.length?p(Array.from(F,G$)):p().map(H$)},f.ticks=function(F){var O=p();return e(O[0],O[O.length-1],F??10)},f.tickFormat=function(F,O){return O==null?N:u(O)},f.nice=function(F){var O=p();return(!F||typeof F.range!="function")&&(F=t(O[0],O[O.length-1],F??10)),F?p(a6(O,F)):f},f.copy=function(){return c0(f,pv(e,t,r,n,a,i,s,o,c,u))},f}function V$(){return vi.apply(pv(zU,qU,zs,dv,Ep,u0,uv,lv,gl,x6).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function K$(){return vi.apply(pv(UU,$U,qs,hv,jp,Ap,fv,cv,gl,v6).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Tp(){var e=0,t=1,r,n,a,i,s=ha,o=!1,c;function u(d){return d==null||isNaN(d=+d)?c:s(a===0?.5:(d=(i(d)-r)*a,o?Math.max(0,Math.min(1,d)):d))}u.domain=function(d){return arguments.length?([e,t]=d,r=i(e=+e),n=i(t=+t),a=r===n?0:1/(n-r),u):[e,t]},u.clamp=function(d){return arguments.length?(o=!!d,u):o},u.interpolator=function(d){return arguments.length?(s=d,u):s};function f(d){return function(p){var h,x;return arguments.length?([h,x]=p,s=d(h,x),u):[s(0),s(1)]}}return u.range=f(cu),u.rangeRound=f(Qx),u.unknown=function(d){return arguments.length?(c=d,u):c},function(d){return i=d,r=d(e),n=d(t),a=r===n?0:1/(n-r),u}}function Go(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function y6(){var e=Ho(Tp()(ha));return e.copy=function(){return Go(e,y6())},Ys.apply(e,arguments)}function b6(){var e=nv(Tp()).domain([1,10]);return e.copy=function(){return Go(e,b6()).base(e.base())},Ys.apply(e,arguments)}function w6(){var e=av(Tp());return e.copy=function(){return Go(e,w6()).constant(e.constant())},Ys.apply(e,arguments)}function mv(){var e=iv(Tp());return e.copy=function(){return Go(e,mv()).exponent(e.exponent())},Ys.apply(e,arguments)}function Y$(){return mv.apply(null,arguments).exponent(.5)}function _6(){var e=[],t=ha;function r(n){if(n!=null&&!isNaN(n=+n))return t((o0(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let a of n)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(ko),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,a)=>t(a/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(a,i)=>FB(e,i/n))},r.copy=function(){return _6(t).domain(e)},Ys.apply(r,arguments)}function Pp(){var e=0,t=.5,r=1,n=1,a,i,s,o,c,u=ha,f,d=!1,p;function h(g){return isNaN(g=+g)?p:(g=.5+((g=+f(g))-i)*(n*g<n*i?o:c),u(d?Math.max(0,Math.min(1,g)):g))}h.domain=function(g){return arguments.length?([e,t,r]=g,a=f(e=+e),i=f(t=+t),s=f(r=+r),o=a===i?0:.5/(i-a),c=i===s?0:.5/(s-i),n=i<a?-1:1,h):[e,t,r]},h.clamp=function(g){return arguments.length?(d=!!g,h):d},h.interpolator=function(g){return arguments.length?(u=g,h):u};function x(g){return function(y){var b,E,A;return arguments.length?([b,E,A]=y,u=oU(g,[b,E,A]),h):[u(0),u(.5),u(1)]}}return h.range=x(cu),h.rangeRound=x(Qx),h.unknown=function(g){return arguments.length?(p=g,h):p},function(g){return f=g,a=g(e),i=g(t),s=g(r),o=a===i?0:.5/(i-a),c=i===s?0:.5/(s-i),n=i<a?-1:1,h}}function N6(){var e=Ho(Pp()(ha));return e.copy=function(){return Go(e,N6())},Ys.apply(e,arguments)}function S6(){var e=nv(Pp()).domain([.1,1,10]);return e.copy=function(){return Go(e,S6()).base(e.base())},Ys.apply(e,arguments)}function A6(){var e=av(Pp());return e.copy=function(){return Go(e,A6()).constant(e.constant())},Ys.apply(e,arguments)}function gv(){var e=iv(Pp());return e.copy=function(){return Go(e,gv()).exponent(e.exponent())},Ys.apply(e,arguments)}function X$(){return gv.apply(null,arguments).exponent(.5)}const uf=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Xx,scaleDiverging:N6,scaleDivergingLog:S6,scaleDivergingPow:gv,scaleDivergingSqrt:X$,scaleDivergingSymlog:A6,scaleIdentity:n6,scaleImplicit:vg,scaleLinear:r6,scaleLog:i6,scaleOrdinal:Yx,scalePoint:MB,scalePow:sv,scaleQuantile:l6,scaleQuantize:c6,scaleRadial:o6,scaleSequential:y6,scaleSequentialLog:b6,scaleSequentialPow:mv,scaleSequentialQuantile:_6,scaleSequentialSqrt:Y$,scaleSequentialSymlog:w6,scaleSqrt:kU,scaleSymlog:s6,scaleThreshold:u6,scaleTime:V$,scaleUtc:K$,tickFormat:t6},Symbol.toStringTag,{value:"Module"}));var Vo=e=>e.chartData,xv=Oe([Vo],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),E6=(e,t,r,n)=>n?xv(e):Vo(e);function eu(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(Mi(t)&&Mi(r))return!0}return!1}function Uw(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function Z$(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,a,i;if(Mi(r))a=r;else if(typeof r=="function")return;if(Mi(n))i=n;else if(typeof n=="function")return;var s=[a,i];if(eu(s))return s}}function J$(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if(eu(n))return Uw(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[a,i]=e,s,o;if(a==="auto")t!=null&&(s=Math.min(...t));else if(Vt(a))s=a;else if(typeof a=="function")try{t!=null&&(s=a(t==null?void 0:t[0]))}catch{}else if(typeof a=="string"&&Rb.test(a)){var c=Rb.exec(a);if(c==null||t==null)s=void 0;else{var u=+c[1];s=t[0]-u}}else s=t==null?void 0:t[0];if(i==="auto")t!=null&&(o=Math.max(...t));else if(Vt(i))o=i;else if(typeof i=="function")try{t!=null&&(o=i(t==null?void 0:t[1]))}catch{}else if(typeof i=="string"&&Bb.test(i)){var f=Bb.exec(i);if(f==null||t==null)o=void 0;else{var d=+f[1];o=t[1]+d}}else o=t==null?void 0:t[1];var p=[s,o];if(eu(p))return t==null?p:Uw(p,t,r)}}}var uu=1e9,Q$={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},yv,Lr=!0,pi="[DecimalError] ",Pl=pi+"Invalid argument: ",vv=pi+"Exponent out of range: ",fu=Math.floor,cl=Math.pow,ez=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Wa,Sn=1e7,Tr=7,j6=9007199254740991,Sh=fu(j6/Tr),ct={};ct.absoluteValue=ct.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};ct.comparedTo=ct.cmp=function(e){var t,r,n,a,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(n=i.d.length,a=e.d.length,t=0,r=n<a?n:a;t<r;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return n===a?0:n>a^i.s<0?1:-1};ct.decimalPlaces=ct.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*Tr;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};ct.dividedBy=ct.div=function(e){return Is(this,new this.constructor(e))};ct.dividedToIntegerBy=ct.idiv=function(e){var t=this,r=t.constructor;return yr(Is(t,new r(e),0,1),r.precision)};ct.equals=ct.eq=function(e){return!this.cmp(e)};ct.exponent=function(){return un(this)};ct.greaterThan=ct.gt=function(e){return this.cmp(e)>0};ct.greaterThanOrEqualTo=ct.gte=function(e){return this.cmp(e)>=0};ct.isInteger=ct.isint=function(){return this.e>this.d.length-2};ct.isNegative=ct.isneg=function(){return this.s<0};ct.isPositive=ct.ispos=function(){return this.s>0};ct.isZero=function(){return this.s===0};ct.lessThan=ct.lt=function(e){return this.cmp(e)<0};ct.lessThanOrEqualTo=ct.lte=function(e){return this.cmp(e)<1};ct.logarithm=ct.log=function(e){var t,r=this,n=r.constructor,a=n.precision,i=a+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Wa))throw Error(pi+"NaN");if(r.s<1)throw Error(pi+(r.s?"NaN":"-Infinity"));return r.eq(Wa)?new n(0):(Lr=!1,t=Is($f(r,i),$f(e,i),i),Lr=!0,yr(t,a))};ct.minus=ct.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?k6(t,e):T6(t,(e.s=-e.s,e))};ct.modulo=ct.mod=function(e){var t,r=this,n=r.constructor,a=n.precision;if(e=new n(e),!e.s)throw Error(pi+"NaN");return r.s?(Lr=!1,t=Is(r,e,0,1).times(e),Lr=!0,r.minus(t)):yr(new n(r),a)};ct.naturalExponential=ct.exp=function(){return P6(this)};ct.naturalLogarithm=ct.ln=function(){return $f(this)};ct.negated=ct.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};ct.plus=ct.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?T6(t,e):k6(t,(e.s=-e.s,e))};ct.precision=ct.sd=function(e){var t,r,n,a=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Pl+e);if(t=un(a)+1,n=a.d.length-1,r=n*Tr+1,n=a.d[n],n){for(;n%10==0;n/=10)r--;for(n=a.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};ct.squareRoot=ct.sqrt=function(){var e,t,r,n,a,i,s,o=this,c=o.constructor;if(o.s<1){if(!o.s)return new c(0);throw Error(pi+"NaN")}for(e=un(o),Lr=!1,a=Math.sqrt(+o),a==0||a==1/0?(t=ns(o.d),(t.length+e)%2==0&&(t+="0"),a=Math.sqrt(t),e=fu((e+1)/2)-(e<0||e%2),a==1/0?t="5e"+e:(t=a.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new c(t)):n=new c(a.toString()),r=c.precision,a=s=r+3;;)if(i=n,n=i.plus(Is(o,i,s+2)).times(.5),ns(i.d).slice(0,s)===(t=ns(n.d)).slice(0,s)){if(t=t.slice(s-3,s+1),a==s&&t=="4999"){if(yr(i,r+1,0),i.times(i).eq(o)){n=i;break}}else if(t!="9999")break;s+=4}return Lr=!0,yr(n,r)};ct.times=ct.mul=function(e){var t,r,n,a,i,s,o,c,u,f=this,d=f.constructor,p=f.d,h=(e=new d(e)).d;if(!f.s||!e.s)return new d(0);for(e.s*=f.s,r=f.e+e.e,c=p.length,u=h.length,c<u&&(i=p,p=h,h=i,s=c,c=u,u=s),i=[],s=c+u,n=s;n--;)i.push(0);for(n=u;--n>=0;){for(t=0,a=c+n;a>n;)o=i[a]+h[n]*p[a-n-1]+t,i[a--]=o%Sn|0,t=o/Sn|0;i[a]=(i[a]+t)%Sn|0}for(;!i[--s];)i.pop();return t?++r:i.shift(),e.d=i,e.e=r,Lr?yr(e,d.precision):e};ct.toDecimalPlaces=ct.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(fs(e,0,uu),t===void 0?t=n.rounding:fs(t,0,8),yr(r,e+un(r)+1,t))};ct.toExponential=function(e,t){var r,n=this,a=n.constructor;return e===void 0?r=Rl(n,!0):(fs(e,0,uu),t===void 0?t=a.rounding:fs(t,0,8),n=yr(new a(n),e+1,t),r=Rl(n,!0,e+1)),r};ct.toFixed=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?Rl(a):(fs(e,0,uu),t===void 0?t=i.rounding:fs(t,0,8),n=yr(new i(a),e+un(a)+1,t),r=Rl(n.abs(),!1,e+un(n)+1),a.isneg()&&!a.isZero()?"-"+r:r)};ct.toInteger=ct.toint=function(){var e=this,t=e.constructor;return yr(new t(e),un(e)+1,t.rounding)};ct.toNumber=function(){return+this};ct.toPower=ct.pow=function(e){var t,r,n,a,i,s,o=this,c=o.constructor,u=12,f=+(e=new c(e));if(!e.s)return new c(Wa);if(o=new c(o),!o.s){if(e.s<1)throw Error(pi+"Infinity");return o}if(o.eq(Wa))return o;if(n=c.precision,e.eq(Wa))return yr(o,n);if(t=e.e,r=e.d.length-1,s=t>=r,i=o.s,s){if((r=f<0?-f:f)<=j6){for(a=new c(Wa),t=Math.ceil(n/Tr+4),Lr=!1;r%2&&(a=a.times(o),zw(a.d,t)),r=fu(r/2),r!==0;)o=o.times(o),zw(o.d,t);return Lr=!0,e.s<0?new c(Wa).div(a):yr(a,n)}}else if(i<0)throw Error(pi+"NaN");return i=i<0&&e.d[Math.max(t,r)]&1?-1:1,o.s=1,Lr=!1,a=e.times($f(o,n+u)),Lr=!0,a=P6(a),a.s=i,a};ct.toPrecision=function(e,t){var r,n,a=this,i=a.constructor;return e===void 0?(r=un(a),n=Rl(a,r<=i.toExpNeg||r>=i.toExpPos)):(fs(e,1,uu),t===void 0?t=i.rounding:fs(t,0,8),a=yr(new i(a),e,t),r=un(a),n=Rl(a,e<=r||r<=i.toExpNeg,e)),n};ct.toSignificantDigits=ct.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(fs(e,1,uu),t===void 0?t=n.rounding:fs(t,0,8)),yr(new n(r),e,t)};ct.toString=ct.valueOf=ct.val=ct.toJSON=ct[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=un(e),r=e.constructor;return Rl(e,t<=r.toExpNeg||t>=r.toExpPos)};function T6(e,t){var r,n,a,i,s,o,c,u,f=e.constructor,d=f.precision;if(!e.s||!t.s)return t.s||(t=new f(e)),Lr?yr(t,d):t;if(c=e.d,u=t.d,s=e.e,a=t.e,c=c.slice(),i=s-a,i){for(i<0?(n=c,i=-i,o=u.length):(n=u,a=s,o=c.length),s=Math.ceil(d/Tr),o=s>o?s+1:o+1,i>o&&(i=o,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(o=c.length,i=u.length,o-i<0&&(i=o,n=u,u=c,c=n),r=0;i;)r=(c[--i]=c[i]+u[i]+r)/Sn|0,c[i]%=Sn;for(r&&(c.unshift(r),++a),o=c.length;c[--o]==0;)c.pop();return t.d=c,t.e=a,Lr?yr(t,d):t}function fs(e,t,r){if(e!==~~e||e<t||e>r)throw Error(Pl+e)}function ns(e){var t,r,n,a=e.length-1,i="",s=e[0];if(a>0){for(i+=s,t=1;t<a;t++)n=e[t]+"",r=Tr-n.length,r&&(i+=xo(r)),i+=n;s=e[t],n=s+"",r=Tr-n.length,r&&(i+=xo(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return i+s}var Is=function(){function e(n,a){var i,s=0,o=n.length;for(n=n.slice();o--;)i=n[o]*a+s,n[o]=i%Sn|0,s=i/Sn|0;return s&&n.unshift(s),n}function t(n,a,i,s){var o,c;if(i!=s)c=i>s?1:-1;else for(o=c=0;o<i;o++)if(n[o]!=a[o]){c=n[o]>a[o]?1:-1;break}return c}function r(n,a,i){for(var s=0;i--;)n[i]-=s,s=n[i]<a[i]?1:0,n[i]=s*Sn+n[i]-a[i];for(;!n[0]&&n.length>1;)n.shift()}return function(n,a,i,s){var o,c,u,f,d,p,h,x,g,y,b,E,A,C,N,F,O,I,P=n.constructor,H=n.s==a.s?1:-1,T=n.d,j=a.d;if(!n.s)return new P(n);if(!a.s)throw Error(pi+"Division by zero");for(c=n.e-a.e,O=j.length,N=T.length,h=new P(H),x=h.d=[],u=0;j[u]==(T[u]||0);)++u;if(j[u]>(T[u]||0)&&--c,i==null?E=i=P.precision:s?E=i+(un(n)-un(a))+1:E=i,E<0)return new P(0);if(E=E/Tr+2|0,u=0,O==1)for(f=0,j=j[0],E++;(u<N||f)&&E--;u++)A=f*Sn+(T[u]||0),x[u]=A/j|0,f=A%j|0;else{for(f=Sn/(j[0]+1)|0,f>1&&(j=e(j,f),T=e(T,f),O=j.length,N=T.length),C=O,g=T.slice(0,O),y=g.length;y<O;)g[y++]=0;I=j.slice(),I.unshift(0),F=j[0],j[1]>=Sn/2&&++F;do f=0,o=t(j,g,O,y),o<0?(b=g[0],O!=y&&(b=b*Sn+(g[1]||0)),f=b/F|0,f>1?(f>=Sn&&(f=Sn-1),d=e(j,f),p=d.length,y=g.length,o=t(d,g,p,y),o==1&&(f--,r(d,O<p?I:j,p))):(f==0&&(o=f=1),d=j.slice()),p=d.length,p<y&&d.unshift(0),r(g,d,y),o==-1&&(y=g.length,o=t(j,g,O,y),o<1&&(f++,r(g,O<y?I:j,y))),y=g.length):o===0&&(f++,g=[0]),x[u++]=f,o&&g[0]?g[y++]=T[C]||0:(g=[T[C]],y=1);while((C++<N||g[0]!==void 0)&&E--)}return x[0]||x.shift(),h.e=c,yr(h,s?i+un(h)+1:i)}}();function P6(e,t){var r,n,a,i,s,o,c=0,u=0,f=e.constructor,d=f.precision;if(un(e)>16)throw Error(vv+un(e));if(!e.s)return new f(Wa);for(t==null?(Lr=!1,o=d):o=t,s=new f(.03125);e.abs().gte(.1);)e=e.times(s),u+=5;for(n=Math.log(cl(2,u))/Math.LN10*2+5|0,o+=n,r=a=i=new f(Wa),f.precision=o;;){if(a=yr(a.times(e),o),r=r.times(++c),s=i.plus(Is(a,r,o)),ns(s.d).slice(0,o)===ns(i.d).slice(0,o)){for(;u--;)i=yr(i.times(i),o);return f.precision=d,t==null?(Lr=!0,yr(i,d)):i}i=s}}function un(e){for(var t=e.e*Tr,r=e.d[0];r>=10;r/=10)t++;return t}function t1(e,t,r){if(t>e.LN10.sd())throw Lr=!0,r&&(e.precision=r),Error(pi+"LN10 precision limit exceeded");return yr(new e(e.LN10),t)}function xo(e){for(var t="";e--;)t+="0";return t}function $f(e,t){var r,n,a,i,s,o,c,u,f,d=1,p=10,h=e,x=h.d,g=h.constructor,y=g.precision;if(h.s<1)throw Error(pi+(h.s?"NaN":"-Infinity"));if(h.eq(Wa))return new g(0);if(t==null?(Lr=!1,u=y):u=t,h.eq(10))return t==null&&(Lr=!0),t1(g,u);if(u+=p,g.precision=u,r=ns(x),n=r.charAt(0),i=un(h),Math.abs(i)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)h=h.times(e),r=ns(h.d),n=r.charAt(0),d++;i=un(h),n>1?(h=new g("0."+r),i++):h=new g(n+"."+r.slice(1))}else return c=t1(g,u+2,y).times(i+""),h=$f(new g(n+"."+r.slice(1)),u-p).plus(c),g.precision=y,t==null?(Lr=!0,yr(h,y)):h;for(o=s=h=Is(h.minus(Wa),h.plus(Wa),u),f=yr(h.times(h),u),a=3;;){if(s=yr(s.times(f),u),c=o.plus(Is(s,new g(a),u)),ns(c.d).slice(0,u)===ns(o.d).slice(0,u))return o=o.times(2),i!==0&&(o=o.plus(t1(g,u+2,y).times(i+""))),o=Is(o,new g(d),u),g.precision=y,t==null?(Lr=!0,yr(o,y)):o;o=c,a+=2}}function $w(e,t){var r,n,a;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(a=t.length;t.charCodeAt(a-1)===48;)--a;if(t=t.slice(n,a),t){if(a-=n,r=r-n-1,e.e=fu(r/Tr),e.d=[],n=(r+1)%Tr,r<0&&(n+=Tr),n<a){for(n&&e.d.push(+t.slice(0,n)),a-=Tr;n<a;)e.d.push(+t.slice(n,n+=Tr));t=t.slice(n),n=Tr-t.length}else n-=a;for(;n--;)t+="0";if(e.d.push(+t),Lr&&(e.e>Sh||e.e<-Sh))throw Error(vv+r)}else e.s=0,e.e=0,e.d=[0];return e}function yr(e,t,r){var n,a,i,s,o,c,u,f,d=e.d;for(s=1,i=d[0];i>=10;i/=10)s++;if(n=t-s,n<0)n+=Tr,a=t,u=d[f=0];else{if(f=Math.ceil((n+1)/Tr),i=d.length,f>=i)return e;for(u=i=d[f],s=1;i>=10;i/=10)s++;n%=Tr,a=n-Tr+s}if(r!==void 0&&(i=cl(10,s-a-1),o=u/i%10|0,c=t<0||d[f+1]!==void 0||u%i,c=r<4?(o||c)&&(r==0||r==(e.s<0?3:2)):o>5||o==5&&(r==4||c||r==6&&(n>0?a>0?u/cl(10,s-a):0:d[f-1])%10&1||r==(e.s<0?8:7))),t<1||!d[0])return c?(i=un(e),d.length=1,t=t-i-1,d[0]=cl(10,(Tr-t%Tr)%Tr),e.e=fu(-t/Tr)||0):(d.length=1,d[0]=e.e=e.s=0),e;if(n==0?(d.length=f,i=1,f--):(d.length=f+1,i=cl(10,Tr-n),d[f]=a>0?(u/cl(10,s-a)%cl(10,a)|0)*i:0),c)for(;;)if(f==0){(d[0]+=i)==Sn&&(d[0]=1,++e.e);break}else{if(d[f]+=i,d[f]!=Sn)break;d[f--]=0,i=1}for(n=d.length;d[--n]===0;)d.pop();if(Lr&&(e.e>Sh||e.e<-Sh))throw Error(vv+un(e));return e}function k6(e,t){var r,n,a,i,s,o,c,u,f,d,p=e.constructor,h=p.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new p(e),Lr?yr(t,h):t;if(c=e.d,d=t.d,n=t.e,u=e.e,c=c.slice(),s=u-n,s){for(f=s<0,f?(r=c,s=-s,o=d.length):(r=d,n=u,o=c.length),a=Math.max(Math.ceil(h/Tr),o)+2,s>a&&(s=a,r.length=1),r.reverse(),a=s;a--;)r.push(0);r.reverse()}else{for(a=c.length,o=d.length,f=a<o,f&&(o=a),a=0;a<o;a++)if(c[a]!=d[a]){f=c[a]<d[a];break}s=0}for(f&&(r=c,c=d,d=r,t.s=-t.s),o=c.length,a=d.length-o;a>0;--a)c[o++]=0;for(a=d.length;a>s;){if(c[--a]<d[a]){for(i=a;i&&c[--i]===0;)c[i]=Sn-1;--c[i],c[a]+=Sn}c[a]-=d[a]}for(;c[--o]===0;)c.pop();for(;c[0]===0;c.shift())--n;return c[0]?(t.d=c,t.e=n,Lr?yr(t,h):t):new p(0)}function Rl(e,t,r){var n,a=un(e),i=ns(e.d),s=i.length;return t?(r&&(n=r-s)>0?i=i.charAt(0)+"."+i.slice(1)+xo(n):s>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(a<0?"e":"e+")+a):a<0?(i="0."+xo(-a-1)+i,r&&(n=r-s)>0&&(i+=xo(n))):a>=s?(i+=xo(a+1-s),r&&(n=r-a-1)>0&&(i=i+"."+xo(n))):((n=a+1)<s&&(i=i.slice(0,n)+"."+i.slice(n)),r&&(n=r-s)>0&&(a+1===s&&(i+="."),i+=xo(n))),e.s<0?"-"+i:i}function zw(e,t){if(e.length>t)return e.length=t,!0}function C6(e){var t,r,n;function a(i){var s=this;if(!(s instanceof a))return new a(i);if(s.constructor=a,i instanceof a){s.s=i.s,s.e=i.e,s.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Pl+i);if(i>0)s.s=1;else if(i<0)i=-i,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(i===~~i&&i<1e7){s.e=0,s.d=[i];return}return $w(s,i.toString())}else if(typeof i!="string")throw Error(Pl+i);if(i.charCodeAt(0)===45?(i=i.slice(1),s.s=-1):s.s=1,ez.test(i))$w(s,i);else throw Error(Pl+i)}if(a.prototype=ct,a.ROUND_UP=0,a.ROUND_DOWN=1,a.ROUND_CEIL=2,a.ROUND_FLOOR=3,a.ROUND_HALF_UP=4,a.ROUND_HALF_DOWN=5,a.ROUND_HALF_EVEN=6,a.ROUND_HALF_CEIL=7,a.ROUND_HALF_FLOOR=8,a.clone=C6,a.config=a.set=tz,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return a.config(e),a}function tz(e){if(!e||typeof e!="object")throw Error(pi+"Object expected");var t,r,n,a=["precision",1,uu,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<a.length;t+=3)if((n=e[r=a[t]])!==void 0)if(fu(n)===n&&n>=a[t+1]&&n<=a[t+2])this[r]=n;else throw Error(Pl+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(Pl+r+": "+n);return this}var yv=C6(Q$);Wa=new yv(1);const ur=yv;var rz=e=>e,O6={"@@functional/placeholder":!0},L6=e=>e===O6,qw=e=>function t(){return arguments.length===0||arguments.length===1&&L6(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},F6=(e,t)=>e===1?t:qw(function(){for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];var i=n.filter(s=>s!==O6).length;return i>=e?t(...n):F6(e-i,qw(function(){for(var s=arguments.length,o=new Array(s),c=0;c<s;c++)o[c]=arguments[c];var u=n.map(f=>L6(f)?o.shift():f);return t(...u,...o)}))}),kp=e=>F6(e.length,e),_g=(e,t)=>{for(var r=[],n=e;n<t;++n)r[n-e]=n;return r},nz=kp((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),az=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return rz;var a=r.reverse(),i=a[0],s=a.slice(1);return function(){return s.reduce((o,c)=>c(o),i(...arguments))}},Ng=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),D6=e=>{var t=null,r=null;return function(){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return t&&a.every((s,o)=>{var c;return s===((c=t)===null||c===void 0?void 0:c[o])})||(t=a,r=e(...a)),r}};function I6(e){var t;return e===0?t=1:t=Math.floor(new ur(e).abs().log(10).toNumber())+1,t}function M6(e,t,r){for(var n=new ur(e),a=0,i=[];n.lt(t)&&a<1e5;)i.push(n.toNumber()),n=n.add(r),a++;return i}kp((e,t,r)=>{var n=+e,a=+t;return n+r*(a-n)});kp((e,t,r)=>{var n=t-+e;return n=n||1/0,(r-e)/n});kp((e,t,r)=>{var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});var R6=e=>{var[t,r]=e,[n,a]=[t,r];return t>r&&([n,a]=[r,t]),[n,a]},B6=(e,t,r)=>{if(e.lte(0))return new ur(0);var n=I6(e.toNumber()),a=new ur(10).pow(n),i=e.div(a),s=n!==1?.05:.1,o=new ur(Math.ceil(i.div(s).toNumber())).add(r).mul(s),c=o.mul(a);return t?new ur(c.toNumber()):new ur(Math.ceil(c.toNumber()))},iz=(e,t,r)=>{var n=new ur(1),a=new ur(e);if(!a.isint()&&r){var i=Math.abs(e);i<1?(n=new ur(10).pow(I6(e)-1),a=new ur(Math.floor(a.div(n).toNumber())).mul(n)):i>1&&(a=new ur(Math.floor(e)))}else e===0?a=new ur(Math.floor((t-1)/2)):r||(a=new ur(Math.floor(e)));var s=Math.floor((t-1)/2),o=az(nz(c=>a.add(new ur(c-s).mul(n)).toNumber()),_g);return o(0,t)},U6=function(t,r,n,a){var i=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new ur(0),tickMin:new ur(0),tickMax:new ur(0)};var s=B6(new ur(r).sub(t).div(n-1),a,i),o;t<=0&&r>=0?o=new ur(0):(o=new ur(t).add(r).div(2),o=o.sub(new ur(o).mod(s)));var c=Math.ceil(o.sub(t).div(s).toNumber()),u=Math.ceil(new ur(r).sub(o).div(s).toNumber()),f=c+u+1;return f>n?U6(t,r,n,a,i+1):(f<n&&(u=r>0?u+(n-f):u,c=r>0?c:c+(n-f)),{step:s,tickMin:o.sub(new ur(c).mul(s)),tickMax:o.add(new ur(u).mul(s))})};function sz(e){var[t,r]=e,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,i=Math.max(n,2),[s,o]=R6([t,r]);if(s===-1/0||o===1/0){var c=o===1/0?[s,..._g(0,n-1).map(()=>1/0)]:[..._g(0,n-1).map(()=>-1/0),o];return t>r?Ng(c):c}if(s===o)return iz(s,n,a);var{step:u,tickMin:f,tickMax:d}=U6(s,o,i,a,0),p=M6(f,d.add(new ur(.1).mul(u)),u);return t>r?Ng(p):p}function oz(e,t){var[r,n]=e,a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[i,s]=R6([r,n]);if(i===-1/0||s===1/0)return[r,n];if(i===s)return[i];var o=Math.max(t,2),c=B6(new ur(s).sub(i).div(o-1),a,0),u=[...M6(new ur(i),new ur(s),c),s];return a===!1&&(u=u.map(f=>Math.round(f))),r>n?Ng(u):u}var lz=D6(sz),cz=D6(oz),uz=e=>e.rootProps.barCategoryGap,f0=e=>e.rootProps.stackOffset,bv=e=>e.options.chartName,wv=e=>e.rootProps.syncId,$6=e=>e.rootProps.syncMethod,_v=e=>e.options.eventEmitter,Ts={allowDuplicatedCategory:!0,angleAxisId:0,axisLine:!0,cx:0,cy:0,orientation:"outer",reversed:!1,scale:"auto",tick:!0,tickLine:!0,tickSize:8,type:"category"},$a={allowDataOverflow:!1,allowDuplicatedCategory:!0,angle:0,axisLine:!0,cx:0,cy:0,orientation:"right",radiusAxisId:0,scale:"auto",stroke:"#ccc",tick:!0,tickCount:5,type:"number"},Cp=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},fz={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Ts.angleAxisId,includeHidden:!1,name:void 0,reversed:Ts.reversed,scale:Ts.scale,tick:Ts.tick,tickCount:void 0,ticks:void 0,type:Ts.type,unit:void 0},dz={allowDataOverflow:$a.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:$a.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:$a.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:$a.scale,tick:$a.tick,tickCount:$a.tickCount,ticks:void 0,type:$a.type,unit:void 0},hz={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Ts.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Ts.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Ts.scale,tick:Ts.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},pz={allowDataOverflow:$a.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:$a.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:$a.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:$a.scale,tick:$a.tick,tickCount:$a.tickCount,ticks:void 0,type:"category",unit:void 0},Nv=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?hz:fz,Sv=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?pz:dz,Op=e=>e.polarOptions,Av=Oe([Vs,Ks,sa],xS),z6=Oe([Op,Av],(e,t)=>{if(e!=null)return ss(e.innerRadius,t,0)}),q6=Oe([Op,Av],(e,t)=>{if(e!=null)return ss(e.outerRadius,t,t*.8)}),mz=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},W6=Oe([Op],mz);Oe([Nv,W6],Cp);var H6=Oe([Av,z6,q6],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});Oe([Sv,H6],Cp);var gz=Oe([Er,Op,z6,q6,Vs,Ks],(e,t,r,n,a,i)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:s,cy:o,startAngle:c,endAngle:u}=t;return{cx:ss(s,a,a/2),cy:ss(o,i,i/2),innerRadius:r,outerRadius:n,startAngle:c,endAngle:u,clockWise:!1}}}),Fr=(e,t)=>t,d0=(e,t,r)=>r;function G6(e){return e==null?void 0:e.id}var bn=e=>{var t=Er(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},du=e=>e.tooltip.settings.axisId,wn=e=>{var t=bn(e),r=du(e);return h0(e,t,r)};function V6(e,t,r){var{chartData:n=[]}=t,a=r==null?void 0:r.dataKey,i=new Map;return e.forEach(s=>{var o,c=(o=s.data)!==null&&o!==void 0?o:n;if(!(c==null||c.length===0)){var u=G6(s);c.forEach((f,d)=>{var p=a==null?d:String(ln(f,a,null)),h=ln(f,s.dataKey,0),x;i.has(p)?x=i.get(p):x={},Object.assign(x,{[u]:h}),i.set(p,x)})}}),Array.from(i.values())}function Ev(e){return e.stackId!=null&&e.dataKey!=null}function Ww(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ah(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ww(Object(r),!0).forEach(function(n){xz(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ww(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xz(e,t,r){return(t=vz(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vz(e){var t=yz(e,"string");return typeof t=="symbol"?t:t+""}function yz(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Sg=[0,"auto"],bz={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},hu=(e,t)=>{var r=e.cartesianAxis.xAxis[t];return r??bz},wz={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:Sg,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:bp},pu=(e,t)=>{var r=e.cartesianAxis.yAxis[t];return r??wz},_z={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},jv=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??_z},tn=(e,t,r)=>{switch(t){case"xAxis":return hu(e,r);case"yAxis":return pu(e,r);case"zAxis":return jv(e,r);case"angleAxis":return Nv(e,r);case"radiusAxis":return Sv(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},Nz=(e,t,r)=>{switch(t){case"xAxis":return hu(e,r);case"yAxis":return pu(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},h0=(e,t,r)=>{switch(t){case"xAxis":return hu(e,r);case"yAxis":return pu(e,r);case"angleAxis":return Nv(e,r);case"radiusAxis":return Sv(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},K6=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function Tv(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var Sz=e=>e.graphicalItems.cartesianItems,Az=Oe([Fr,d0],Tv),Pv=(e,t,r)=>e.filter(r).filter(n=>(t==null?void 0:t.includeHidden)===!0?!0:!n.hide),p0=Oe([Sz,tn,Az],Pv),Y6=Oe([p0],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(Ev)),X6=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),Z6=Oe([p0],X6),kv=e=>e.map(t=>t.data).filter(Boolean).flat(1),Ez=Oe([p0],kv),Cv=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:a}=t;return e.length>0?e:r.slice(n,a+1)},Ov=Oe([Ez,E6],Cv),Lv=(e,t,r)=>(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:ln(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(a=>({value:ln(a,n)}))):e.map(n=>({value:n})),Lp=Oe([Ov,tn,p0],Lv);function J6(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function Xl(e){return e.filter(t=>Bs(t)||t instanceof Date).map(Number).filter(t=>Ii(t)===!1)}function jz(e,t,r){return!r||typeof t!="number"||Ii(t)?[]:r.length?Xl(r.flatMap(n=>{var a=ln(e,n.dataKey),i,s;if(Array.isArray(a)?[i,s]=a:i=s=a,!(!Mi(i)||!Mi(s)))return[t-i,t+s]})):[]}var Tz=Oe([Y6,E6,wn],V6),Q6=(e,t,r)=>{var n={},a=t.reduce((i,s)=>(s.stackId==null||(i[s.stackId]==null&&(i[s.stackId]=[]),i[s.stackId].push(s)),i),n);return Object.fromEntries(Object.entries(a).map(i=>{var[s,o]=i,c=o.map(G6);return[s,{stackedData:G9(e,c,r),graphicalItems:o}]}))},Pz=Oe([Tz,Y6,f0],Q6),eA=(e,t,r)=>{var{dataStartIndex:n,dataEndIndex:a}=t;if(r!=="zAxis"){var i=Y9(e,n,a);if(!(i!=null&&i[0]===0&&i[1]===0))return i}},kz=Oe([Pz,Vo,Fr],eA),tA=(e,t,r,n,a)=>r.length>0?e.flatMap(i=>r.flatMap(s=>{var o,c,u=(o=n[s.id])===null||o===void 0?void 0:o.filter(d=>J6(a,d)),f=ln(i,(c=t.dataKey)!==null&&c!==void 0?c:s.dataKey);return{value:f,errorDomain:jz(i,f,u)}})).filter(Boolean):(t==null?void 0:t.dataKey)!=null?e.map(i=>({value:ln(i,t.dataKey),errorDomain:[]})):e.map(i=>({value:i,errorDomain:[]})),Fp=e=>e.errorBars,rA=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>J6(r,n));Oe([Z6,Fp,Fr],rA);var Cz=Oe([Ov,tn,Z6,Fp,Fr],tA);function Oz(e){var{value:t}=e;if(Bs(t)||t instanceof Date)return t}var Hw=e=>{var t=e.flatMap(n=>[n.value,n.errorDomain]).flat(1),r=Xl(t);if(r.length!==0)return[Math.min(...r),Math.max(...r)]},Lz=(e,t,r)=>{var n=e.map(Oz).filter(a=>a!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&J3(n))?HS(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},Fv=e=>{var t;if(e==null||!("domain"in e))return Sg;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=Xl(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e==null?void 0:e.domain)!==null&&t!==void 0?t:Sg},Eh=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var a=r.filter(Boolean);if(a.length!==0){var i=a.flat(),s=Math.min(...i),o=Math.max(...i);return[s,o]}},nA=e=>e.referenceElements.dots,mu=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),Fz=Oe([nA,Fr,d0],mu),aA=e=>e.referenceElements.areas,Dz=Oe([aA,Fr,d0],mu),iA=e=>e.referenceElements.lines,Iz=Oe([iA,Fr,d0],mu),sA=(e,t)=>{var r=Xl(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},Mz=Oe(Fz,Fr,sA),oA=(e,t)=>{var r=Xl(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},Rz=Oe([Dz,Fr],oA),lA=(e,t)=>{var r=Xl(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},Bz=Oe(Iz,Fr,lA),Uz=Oe(Mz,Bz,Rz,(e,t,r)=>Eh(e,r,t)),cA=Oe([tn],Fv),Dv=(e,t,r,n,a,i,s)=>{var o=Z$(t,e.allowDataOverflow);if(o!=null)return o;var c=i==="vertical"&&s==="xAxis"||i==="horizontal"&&s==="yAxis",u=c?Eh(r,a,Hw(n)):Eh(a,Hw(n));return J$(t,u,e.allowDataOverflow)},$z=Oe([tn,cA,kz,Cz,Uz,Er,Fr],Dv),zz=[0,1],Iv=(e,t,r,n,a,i,s)=>{if(!((e==null||r==null||r.length===0)&&s===void 0)){var{dataKey:o,type:c}=e,u=Vl(t,i);return u&&o==null?HS(0,r.length):c==="category"?Lz(n,e,u):a==="expand"?zz:s}},Mv=Oe([tn,Er,Ov,Lp,f0,Fr,$z],Iv),uA=(e,t,r,n,a)=>{if(e!=null){var{scale:i,type:s}=e;if(i==="auto")return t==="radial"&&a==="radiusAxis"?"band":t==="radial"&&a==="angleAxis"?"linear":s==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":s==="category"?"band":"linear";if(typeof i=="string"){var o="scale".concat(i0(i));return o in uf?o:"point"}}},gu=Oe([tn,Er,K6,bv,Fr],uA);function qz(e){if(e!=null){if(e in uf)return uf[e]();var t="scale".concat(i0(e));if(t in uf)return uf[t]()}}function Rv(e,t,r,n){if(!(r==null||n==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(n);var a=qz(t);if(a!=null){var i=a.domain(r).range(n);return z9(i),i}}}var Bv=(e,t,r)=>{var n=Fv(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&eu(e))return lz(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&eu(e))return cz(e,t.tickCount,t.allowDecimals)}},Uv=Oe([Mv,h0,gu],Bv),$v=(e,t,r,n)=>{if(n!=="angleAxis"&&(e==null?void 0:e.type)==="number"&&eu(t)&&Array.isArray(r)&&r.length>0){var a=t[0],i=r[0],s=t[1],o=r[r.length-1];return[Math.min(a,i),Math.max(s,o)]}return t},Wz=Oe([tn,Mv,Uv,Fr],$v),Hz=Oe(Lp,tn,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(Xl(e.map(o=>o.value))).sort((o,c)=>o-c);if(n.length<2)return 1/0;var a=n[n.length-1]-n[0];if(a===0)return 1/0;for(var i=0;i<n.length-1;i++){var s=n[i+1]-n[i];r=Math.min(r,s)}return r/a}}),fA=Oe(Hz,Er,uz,sa,(e,t,r,n)=>n,(e,t,r,n,a)=>{if(!Mi(e))return 0;var i=t==="vertical"?n.height:n.width;if(a==="gap")return e*i/2;if(a==="no-gap"){var s=ss(r,e*i),o=e*i/2;return o-s-(o-s)/i*s}return 0}),Gz=(e,t)=>{var r=hu(e,t);return r==null||typeof r.padding!="string"?0:fA(e,"xAxis",t,r.padding)},Vz=(e,t)=>{var r=pu(e,t);return r==null||typeof r.padding!="string"?0:fA(e,"yAxis",t,r.padding)},Kz=Oe(hu,Gz,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:a}=e;return typeof a=="string"?{left:t,right:t}:{left:((r=a.left)!==null&&r!==void 0?r:0)+t,right:((n=a.right)!==null&&n!==void 0?n:0)+t}}),Yz=Oe(pu,Vz,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:a}=e;return typeof a=="string"?{top:t,bottom:t}:{top:((r=a.top)!==null&&r!==void 0?r:0)+t,bottom:((n=a.bottom)!==null&&n!==void 0?n:0)+t}}),Xz=Oe([sa,Kz,_p,wp,(e,t,r)=>r],(e,t,r,n,a)=>{var{padding:i}=n;return a?[i.left,r.width-i.right]:[e.left+t.left,e.left+e.width-t.right]}),Zz=Oe([sa,Er,Yz,_p,wp,(e,t,r)=>r],(e,t,r,n,a,i)=>{var{padding:s}=a;return i?[n.height-s.bottom,s.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),m0=(e,t,r,n)=>{var a;switch(t){case"xAxis":return Xz(e,r,n);case"yAxis":return Zz(e,r,n);case"zAxis":return(a=jv(e,r))===null||a===void 0?void 0:a.range;case"angleAxis":return W6(e);case"radiusAxis":return H6(e,r);default:return}},dA=Oe([tn,m0],Cp),Dp=Oe([tn,gu,Wz,dA],Rv);Oe([p0,Fp,Fr],rA);function hA(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var Ip=(e,t)=>t,Mp=(e,t,r)=>r,Jz=Oe(Hx,Ip,Mp,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(hA)),Qz=Oe(Gx,Ip,Mp,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(hA)),pA=(e,t)=>({width:e.width,height:t.height}),eq=(e,t)=>{var r=typeof t.width=="number"?t.width:bp;return{width:r,height:e.height}};Oe(sa,hu,pA);var tq=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},rq=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}};Oe(Ks,sa,Jz,Ip,Mp,(e,t,r,n,a)=>{var i={},s;return r.forEach(o=>{var c=pA(t,o);s==null&&(s=tq(t,n,e));var u=n==="top"&&!a||n==="bottom"&&a;i[o.id]=s-Number(u)*c.height,s+=(u?-1:1)*c.height}),i});Oe(Vs,sa,Qz,Ip,Mp,(e,t,r,n,a)=>{var i={},s;return r.forEach(o=>{var c=eq(t,o);s==null&&(s=rq(t,n,e));var u=n==="left"&&!a||n==="right"&&a;i[o.id]=s-Number(u)*c.width,s+=(u?-1:1)*c.width}),i});Oe(sa,pu,(e,t)=>{var r=typeof t.width=="number"?t.width:bp;return{width:r,height:e.height}});var mA=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:a,type:i,dataKey:s}=r,o=Vl(e,n),c=t.map(u=>u.value);if(s&&o&&i==="category"&&a&&J3(c))return c}},zv=Oe([Er,Lp,tn,Fr],mA),gA=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:a,scale:i}=r,s=Vl(e,n);if(s&&(a==="number"||i!=="auto"))return t.map(o=>o.value)}},qv=Oe([Er,Lp,h0,Fr],gA);Oe([Er,Nz,gu,Dp,zv,qv,m0,Uv,Fr],(e,t,r,n,a,i,s,o,c)=>{if(t==null)return null;var u=Vl(e,c);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:c,categoricalDomain:i,duplicateDomain:a,isCategorical:u,niceTicks:o,range:s,realScaleType:r,scale:n}});var nq=(e,t,r,n,a,i,s,o,c)=>{if(!(t==null||n==null)){var u=Vl(e,c),{type:f,ticks:d,tickCount:p}=t,h=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,x=f==="category"&&n.bandwidth?n.bandwidth()/h:0;x=c==="angleAxis"&&i!=null&&i.length>=2?Ha(i[0]-i[1])*2*x:x;var g=d||a;if(g){var y=g.map((b,E)=>{var A=s?s.indexOf(b):b;return{index:E,coordinate:n(A)+x,value:b,offset:x}});return y.filter(b=>!Ii(b.coordinate))}return u&&o?o.map((b,E)=>({coordinate:n(b)+x,value:b,index:E,offset:x})):n.ticks?n.ticks(p).map(b=>({coordinate:n(b)+x,value:b,offset:x})):n.domain().map((b,E)=>({coordinate:n(b)+x,value:s?s[b]:b,index:E,offset:x}))}};Oe([Er,h0,gu,Dp,Uv,m0,zv,qv,Fr],nq);var aq=(e,t,r,n,a,i,s)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var o=Vl(e,s),{tickCount:c}=t,u=0;return u=s==="angleAxis"&&(n==null?void 0:n.length)>=2?Ha(n[0]-n[1])*2*u:u,o&&i?i.map((f,d)=>({coordinate:r(f)+u,value:f,index:d,offset:u})):r.ticks?r.ticks(c).map(f=>({coordinate:r(f)+u,value:f,offset:u})):r.domain().map((f,d)=>({coordinate:r(f)+u,value:a?a[f]:f,index:d,offset:u}))}};Oe([Er,h0,Dp,m0,zv,qv,Fr],aq);Oe(tn,Dp,(e,t)=>{if(!(e==null||t==null))return Ah(Ah({},e),{},{scale:t})});var iq=Oe([tn,gu,Mv,dA],Rv);Oe((e,t,r)=>jv(e,r),iq,(e,t)=>{if(!(e==null||t==null))return Ah(Ah({},e),{},{scale:t})});var sq=Oe([Er,Hx,Gx],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),xA=e=>e.options.defaultTooltipEventType,vA=e=>e.options.validateTooltipEventTypes;function yA(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function Wv(e,t){var r=xA(e),n=vA(e);return yA(t,r,n)}function oq(e){return qt(t=>Wv(t,e))}var bA=(e,t)=>{var r,n=Number(t);if(!(Ii(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},lq=e=>e.tooltip.settings,bo={active:!1,index:null,dataKey:void 0,coordinate:void 0},cq={itemInteraction:{click:bo,hover:bo},axisInteraction:{click:bo,hover:bo},keyboardInteraction:bo,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},wA=Qa({name:"tooltip",initialState:cq,reducers:{addTooltipEntrySettings(e,t){e.tooltipItemPayloads.push(t.payload)},removeTooltipEntrySettings(e,t){var r=Ds(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:uq,removeTooltipEntrySettings:fq,setTooltipSettingsState:dq,setActiveMouseOverItemIndex:_A,mouseLeaveItem:hq,mouseLeaveChart:NA,setActiveClickItemIndex:pq,setMouseOverAxisIndex:SA,setMouseClickAxisIndex:mq,setSyncInteraction:Ag,setKeyboardInteraction:Eg}=wA.actions,gq=wA.reducer;function Gw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function dd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Gw(Object(r),!0).forEach(function(n){xq(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Gw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xq(e,t,r){return(t=vq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vq(e){var t=yq(e,"string");return typeof t=="symbol"?t:t+""}function yq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function bq(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function wq(e){return e.index!=null}var AA=(e,t,r,n)=>{if(t==null)return bo;var a=bq(e,t,r);if(a==null)return bo;if(a.active)return a;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var i=e.settings.active===!0;if(wq(a)){if(i)return dd(dd({},a),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n};return dd(dd({},bo),{},{coordinate:a.coordinate})},Hv=(e,t)=>{var r=e==null?void 0:e.index;if(r==null)return null;var n=Number(r);if(!Mi(n))return r;var a=0,i=1/0;return t.length>0&&(i=t.length-1),String(Math.max(a,Math.min(n,i)))},EA=(e,t,r,n,a,i,s,o)=>{if(!(i==null||o==null)){var c=s[0],u=c==null?void 0:o(c.positions,i);if(u!=null)return u;var f=a==null?void 0:a[Number(i)];if(f)switch(r){case"horizontal":return{x:f.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:f.coordinate}}}},jA=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var a;return r==="hover"?a=e.itemInteraction.hover.dataKey:a=e.itemInteraction.click.dataKey,a==null&&n!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(i=>{var s;return((s=i.settings)===null||s===void 0?void 0:s.dataKey)===a})},g0=e=>e.options.tooltipPayloadSearcher,xu=e=>e.tooltip;function Vw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Kw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Vw(Object(r),!0).forEach(function(n){_q(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Vw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function _q(e,t,r){return(t=Nq(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Nq(e){var t=Sq(e,"string");return typeof t=="symbol"?t:t+""}function Sq(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Aq(e,t){return e??t}var TA=(e,t,r,n,a,i,s)=>{if(!(t==null||i==null)){var{chartData:o,computedData:c,dataStartIndex:u,dataEndIndex:f}=r,d=[];return e.reduce((p,h)=>{var x,{dataDefinedOnItem:g,settings:y}=h,b=Aq(g,o),E=Array.isArray(b)?vS(b,u,f):b,A=(x=y==null?void 0:y.dataKey)!==null&&x!==void 0?x:n==null?void 0:n.dataKey,C=y==null?void 0:y.nameKey,N;if(n!=null&&n.dataKey&&Array.isArray(E)&&!Array.isArray(E[0])&&s==="axis"?N=zD(E,n.dataKey,a):N=i(E,t,c,C),Array.isArray(N))N.forEach(O=>{var I=Kw(Kw({},y),{},{name:O.name,unit:O.unit,color:void 0,fill:void 0});p.push(Ub({tooltipEntrySettings:I,dataKey:O.dataKey,payload:O.payload,value:ln(O.payload,O.dataKey),name:O.name}))});else{var F;p.push(Ub({tooltipEntrySettings:y,dataKey:A,payload:N,value:ln(N,A),name:(F=ln(N,C))!==null&&F!==void 0?F:y==null?void 0:y.name}))}return p},d)}},Gv=Oe([wn,Er,K6,bv,bn],uA),Eq=Oe([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),jq=Oe([bn,du],Tv),x0=Oe([Eq,wn,jq],Pv),Tq=Oe([x0],e=>e.filter(Ev)),Pq=Oe([x0],kv),vu=Oe([Pq,Vo],Cv),kq=Oe([Tq,Vo,wn],V6),Vv=Oe([vu,wn,x0],Lv),Cq=Oe([wn],Fv),Oq=Oe([x0],e=>e.filter(Ev)),Lq=Oe([kq,Oq,f0],Q6),Fq=Oe([Lq,Vo,bn],eA),Dq=Oe([x0],X6),Iq=Oe([vu,wn,Dq,Fp,bn],tA),Mq=Oe([nA,bn,du],mu),Rq=Oe([Mq,bn],sA),Bq=Oe([aA,bn,du],mu),Uq=Oe([Bq,bn],oA),$q=Oe([iA,bn,du],mu),zq=Oe([$q,bn],lA),qq=Oe([Rq,zq,Uq],Eh),Wq=Oe([wn,Cq,Fq,Iq,qq,Er,bn],Dv),PA=Oe([wn,Er,vu,Vv,f0,bn,Wq],Iv),Hq=Oe([PA,wn,Gv],Bv),Gq=Oe([wn,PA,Hq,bn],$v),kA=e=>{var t=bn(e),r=du(e),n=!1;return m0(e,t,r,n)},CA=Oe([wn,kA],Cp),OA=Oe([wn,Gv,Gq,CA],Rv),Vq=Oe([Er,Vv,wn,bn],mA),Kq=Oe([Er,Vv,wn,bn],gA),Yq=(e,t,r,n,a,i,s,o)=>{if(t){var{type:c}=t,u=Vl(e,o);if(n){var f=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,d=c==="category"&&n.bandwidth?n.bandwidth()/f:0;return d=o==="angleAxis"&&a!=null&&(a==null?void 0:a.length)>=2?Ha(a[0]-a[1])*2*d:d,u&&s?s.map((p,h)=>({coordinate:n(p)+d,value:p,index:h,offset:d})):n.domain().map((p,h)=>({coordinate:n(p)+d,value:i?i[p]:p,index:h,offset:d}))}}},Xs=Oe([Er,wn,Gv,OA,kA,Vq,Kq,bn],Yq),Kv=Oe([xA,vA,lq],(e,t,r)=>yA(r.shared,e,t)),LA=e=>e.tooltip.settings.trigger,Yv=e=>e.tooltip.settings.defaultIndex,Rp=Oe([xu,Kv,LA,Yv],AA),zf=Oe([Rp,vu],Hv),FA=Oe([Xs,zf],bA),Xq=Oe([Rp],e=>{if(e)return e.dataKey}),DA=Oe([xu,Kv,LA,Yv],jA),Zq=Oe([Vs,Ks,Er,sa,Xs,Yv,DA,g0],EA),Jq=Oe([Rp,Zq],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),Qq=Oe([Rp],e=>e.active),eW=Oe([DA,zf,Vo,wn,FA,g0,Kv],TA);Oe([eW],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function Yw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Xw(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Yw(Object(r),!0).forEach(function(n){tW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function tW(e,t,r){return(t=rW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function rW(e){var t=nW(e,"string");return typeof t=="symbol"?t:t+""}function nW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aW=()=>qt(wn),iW=()=>{var e=aW(),t=qt(Xs),r=qt(OA);return X9(Xw(Xw({},e),{},{scale:r}),t)},sW=()=>qt(bv),Xv=(e,t)=>t,IA=(e,t,r)=>r,Zv=(e,t,r,n)=>n,oW=Oe(Xs,e=>hp(e,t=>t.coordinate)),Jv=Oe([xu,Xv,IA,Zv],AA),MA=Oe([Jv,vu],Hv),lW=(e,t,r)=>{if(t!=null){var n=xu(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},RA=Oe([xu,Xv,IA,Zv],jA),jh=Oe([Vs,Ks,Er,sa,Xs,Zv,RA,g0],EA),cW=Oe([Jv,jh],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),BA=Oe(Xs,MA,bA),uW=Oe([RA,MA,Vo,wn,BA,g0,Xv],TA),fW=Oe([Jv],e=>({isActive:e.active,activeIndex:e.index})),dW=(e,t,r,n,a,i,s,o)=>{if(!(!e||!t||!n||!a||!i)){var c=Z9(e.chartX,e.chartY,t,r,o);if(c){var u=Q9(c,t),f=U9(u,s,i,n,a),d=J9(t,i,f,c);return{activeIndex:String(f),activeCoordinate:d}}}};function jg(){return jg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},jg.apply(null,arguments)}function Zw(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function hd(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Zw(Object(r),!0).forEach(function(n){hW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zw(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function hW(e,t,r){return(t=pW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function pW(e){var t=mW(e,"string");return typeof t=="symbol"?t:t+""}function mW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gW(e){var{coordinate:t,payload:r,index:n,offset:a,tooltipAxisBandSize:i,layout:s,cursor:o,tooltipEventType:c,chartName:u}=e,f=t,d=r,p=n;if(!o||!f||u!=="ScatterChart"&&c!=="axis")return null;var h,x;if(u==="ScatterChart")h=f,x=$R;else if(u==="BarChart")h=zR(s,f,a,i),x=RS;else if(s==="radial"){var{cx:g,cy:y,radius:b,startAngle:E,endAngle:A}=BS(f);h={cx:g,cy:y,startAngle:E,endAngle:A,innerRadius:b,outerRadius:b},x=$S}else h={points:wB(s,f,a)},x=jS;var C=typeof o=="object"&&"className"in o?o.className:void 0,N=hd(hd(hd(hd({stroke:"#ccc",pointerEvents:"none"},a),h),Xa(o,!1)),{},{payload:d,payloadIndex:p,className:Pn("recharts-tooltip-cursor",C)});return M.isValidElement(o)?M.cloneElement(o,N):M.createElement(x,N)}function xW(e){var t=iW(),r=lR(),n=SS(),a=sW();return M.createElement(gW,jg({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:r,layout:n,tooltipAxisBandSize:t,chartName:a}))}var UA=M.createContext(null),vW=()=>M.useContext(UA),$A={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function a(c,u,f){this.fn=c,this.context=u,this.once=f||!1}function i(c,u,f,d,p){if(typeof f!="function")throw new TypeError("The listener must be a function");var h=new a(f,d||c,p),x=r?r+u:u;return c._events[x]?c._events[x].fn?c._events[x]=[c._events[x],h]:c._events[x].push(h):(c._events[x]=h,c._eventsCount++),c}function s(c,u){--c._eventsCount===0?c._events=new n:delete c._events[u]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var u=[],f,d;if(this._eventsCount===0)return u;for(d in f=this._events)t.call(f,d)&&u.push(r?d.slice(1):d);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(f)):u},o.prototype.listeners=function(u){var f=r?r+u:u,d=this._events[f];if(!d)return[];if(d.fn)return[d.fn];for(var p=0,h=d.length,x=new Array(h);p<h;p++)x[p]=d[p].fn;return x},o.prototype.listenerCount=function(u){var f=r?r+u:u,d=this._events[f];return d?d.fn?1:d.length:0},o.prototype.emit=function(u,f,d,p,h,x){var g=r?r+u:u;if(!this._events[g])return!1;var y=this._events[g],b=arguments.length,E,A;if(y.fn){switch(y.once&&this.removeListener(u,y.fn,void 0,!0),b){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,f),!0;case 3:return y.fn.call(y.context,f,d),!0;case 4:return y.fn.call(y.context,f,d,p),!0;case 5:return y.fn.call(y.context,f,d,p,h),!0;case 6:return y.fn.call(y.context,f,d,p,h,x),!0}for(A=1,E=new Array(b-1);A<b;A++)E[A-1]=arguments[A];y.fn.apply(y.context,E)}else{var C=y.length,N;for(A=0;A<C;A++)switch(y[A].once&&this.removeListener(u,y[A].fn,void 0,!0),b){case 1:y[A].fn.call(y[A].context);break;case 2:y[A].fn.call(y[A].context,f);break;case 3:y[A].fn.call(y[A].context,f,d);break;case 4:y[A].fn.call(y[A].context,f,d,p);break;default:if(!E)for(N=1,E=new Array(b-1);N<b;N++)E[N-1]=arguments[N];y[A].fn.apply(y[A].context,E)}}return!0},o.prototype.on=function(u,f,d){return i(this,u,f,d,!1)},o.prototype.once=function(u,f,d){return i(this,u,f,d,!0)},o.prototype.removeListener=function(u,f,d,p){var h=r?r+u:u;if(!this._events[h])return this;if(!f)return s(this,h),this;var x=this._events[h];if(x.fn)x.fn===f&&(!p||x.once)&&(!d||x.context===d)&&s(this,h);else{for(var g=0,y=[],b=x.length;g<b;g++)(x[g].fn!==f||p&&!x[g].once||d&&x[g].context!==d)&&y.push(x[g]);y.length?this._events[h]=y.length===1?y[0]:y:s(this,h)}return this},o.prototype.removeAllListeners=function(u){var f;return u?(f=r?r+u:u,this._events[f]&&s(this,f)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,e.exports=o})($A);var yW=$A.exports;const bW=zo(yW);var qf=new bW,Tg="recharts.syncEvent.tooltip",Jw="recharts.syncEvent.brush";function wW(e,t){if(t){var r=Number.parseInt(t,10);if(!Ii(r))return e==null?void 0:e[r]}}var _W={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},zA=Qa({name:"options",initialState:_W,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),NW=zA.reducer,{createEventEmitter:SW}=zA.actions;function AW(e){return e.tooltip.syncInteraction}var EW={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},qA=Qa({name:"chartData",initialState:EW,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:Qw,setDataStartEndIndexes:jW,setComputedData:_J}=qA.actions,TW=qA.reducer,WA=()=>{};function PW(){var e=qt(wv),t=qt(_v),r=ia(),n=qt($6),a=qt(Xs),i=SS(),s=NS(),o=qt(c=>c.rootProps.className);M.useEffect(()=>{if(e==null)return WA;var c=(u,f,d)=>{if(t!==d&&e===u){if(n==="index"){r(f);return}if(a!=null){var p;if(typeof n=="function"){var h={activeTooltipIndex:f.payload.index==null?void 0:Number(f.payload.index),isTooltipActive:f.payload.active,activeIndex:f.payload.index==null?void 0:Number(f.payload.index),activeLabel:f.payload.label,activeDataKey:f.payload.dataKey,activeCoordinate:f.payload.coordinate},x=n(a,h);p=a[x]}else n==="value"&&(p=a.find(F=>String(F.value)===f.payload.label));var{coordinate:g}=f.payload;if(p==null||f.payload.active===!1||g==null||s==null){r(Ag({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:y,y:b}=g,E=Math.min(y,s.x+s.width),A=Math.min(b,s.y+s.height),C={x:i==="horizontal"?p.coordinate:E,y:i==="horizontal"?A:p.coordinate},N=Ag({active:f.payload.active,coordinate:C,dataKey:f.payload.dataKey,index:String(p.index),label:f.payload.label});r(N)}}};return qf.on(Tg,c),()=>{qf.off(Tg,c)}},[o,r,t,e,n,a,i,s])}function kW(){var e=qt(wv),t=qt(_v),r=ia();M.useEffect(()=>{if(e==null)return WA;var n=(a,i,s)=>{t!==s&&e===a&&r(jW(i))};return qf.on(Jw,n),()=>{qf.off(Jw,n)}},[r,t,e])}function CW(){var e=ia();M.useEffect(()=>{e(SW())},[e]),PW(),kW()}function OW(e,t,r,n,a,i){var s=qt(p=>lW(p,e,t)),o=qt(_v),c=qt(wv),u=qt($6),f=qt(AW),d=f==null?void 0:f.active;M.useEffect(()=>{if(!d&&c!=null&&o!=null){var p=Ag({active:i,coordinate:r,dataKey:s,index:a,label:typeof n=="number"?String(n):n});qf.emit(Tg,c,p,o)}},[d,r,s,a,n,o,c,u,i])}function e5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function t5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?e5(Object(r),!0).forEach(function(n){LW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):e5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function LW(e,t,r){return(t=FW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function FW(e){var t=DW(e,"string");return typeof t=="symbol"?t:t+""}function DW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function IW(e){return e.dataKey}function MW(e,t){return M.isValidElement(e)?M.cloneElement(e,t):typeof e=="function"?M.createElement(e,t):M.createElement(yR,t)}var r5=[],RW={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!Np.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function BW(e){var t=Wo(e,RW),{active:r,allowEscapeViewBox:n,animationDuration:a,animationEasing:i,content:s,filterNull:o,isAnimationActive:c,offset:u,payloadUniqBy:f,position:d,reverseDirection:p,useTranslate3d:h,wrapperStyle:x,cursor:g,shared:y,trigger:b,defaultIndex:E,portal:A,axisId:C}=t,N=ia(),F=typeof E=="number"?String(E):E;M.useEffect(()=>{N(dq({shared:y,trigger:b,axisId:C,active:r,defaultIndex:F}))},[N,y,b,C,r,F]);var O=NS(),I=ES(),P=oq(y),{activeIndex:H,isActive:T}=qt(R=>fW(R,P,b,F)),j=qt(R=>uW(R,P,b,F)),z=qt(R=>BA(R,P,b,F)),K=qt(R=>cW(R,P,b,F)),he=j,be=vW(),we=r??T,[Q,le]=kM([he,we]),ke=P==="axis"?z:void 0;OW(P,b,K,ke,H,we);var ve=A??be;if(ve==null)return null;var S=he??r5;we||(S=r5),o&&S.length&&(S=KI(he.filter(R=>R.value!=null&&(R.hide!==!0||t.includeHidden)),f,IW));var L=S.length>0,D=M.createElement(ER,{allowEscapeViewBox:n,animationDuration:a,animationEasing:i,isAnimationActive:c,active:we,coordinate:K,hasPayload:L,offset:u,position:d,reverseDirection:p,useTranslate3d:h,viewBox:O,wrapperStyle:x,lastBoundingBox:Q,innerRef:le,hasPortalFromProps:!!A},MW(s,t5(t5({},t),{},{payload:S,label:ke,active:we,coordinate:K,accessibilityLayer:I})));return M.createElement(M.Fragment,null,e4.createPortal(D,ve),we&&M.createElement(xW,{cursor:g,tooltipEventType:P,coordinate:K,payload:he,index:H}))}var HA={},GA={},VA={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n,{signal:a,edges:i}={}){let s,o=null;const c=i!=null&&i.includes("leading"),u=i==null||i.includes("trailing"),f=()=>{o!==null&&(r.apply(s,o),s=void 0,o=null)},d=()=>{u&&f(),g()};let p=null;const h=()=>{p!=null&&clearTimeout(p),p=setTimeout(()=>{p=null,d()},n)},x=()=>{p!==null&&(clearTimeout(p),p=null)},g=()=>{x(),s=void 0,o=null},y=()=>{f()},b=function(...E){if(a!=null&&a.aborted)return;s=this,o=E;const A=p==null;h(),c&&A&&f()};return b.schedule=h,b.cancel=g,b.flush=y,a==null||a.addEventListener("abort",g,{once:!0}),b}e.debounce=t})(VA);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=VA;function r(n,a=0,i={}){typeof i!="object"&&(i={});const{leading:s=!1,trailing:o=!0,maxWait:c}=i,u=Array(2);s&&(u[0]="leading"),o&&(u[1]="trailing");let f,d=null;const p=t.debounce(function(...g){f=n.apply(this,g),d=null},a,{edges:u}),h=function(...g){return c!=null&&(d===null&&(d=Date.now()),Date.now()-d>=c)?(f=n.apply(this,g),d=Date.now(),p.cancel(),p.schedule(),f):(p.apply(this,g),f)},x=()=>(p.flush(),f);return h.cancel=p.cancel,h.flush=x,h}e.debounce=r})(GA);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=GA;function r(n,a=0,i={}){const{leading:s=!0,trailing:o=!0}=i;return t.debounce(n,a,{leading:s,maxWait:a,trailing:o})}e.throttle=r})(HA);var UW=HA.throttle;const $W=zo(UW);var r1=function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),i=2;i<n;i++)a[i-2]=arguments[i]};function n5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function n1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?n5(Object(r),!0).forEach(function(n){zW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function zW(e,t,r){return(t=qW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qW(e){var t=WW(e,"string");return typeof t=="symbol"?t:t+""}function WW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var HW=M.forwardRef((e,t)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:a="100%",height:i="100%",minWidth:s=0,minHeight:o,maxHeight:c,children:u,debounce:f=0,id:d,className:p,onResize:h,style:x={}}=e,g=M.useRef(null),y=M.useRef();y.current=h,M.useImperativeHandle(t,()=>g.current);var[b,E]=M.useState({containerWidth:n.width,containerHeight:n.height}),A=M.useCallback((N,F)=>{E(O=>{var I=Math.round(N),P=Math.round(F);return O.containerWidth===I&&O.containerHeight===P?O:{containerWidth:I,containerHeight:P}})},[]);M.useEffect(()=>{var N=P=>{var H,{width:T,height:j}=P[0].contentRect;A(T,j),(H=y.current)===null||H===void 0||H.call(y,T,j)};f>0&&(N=$W(N,f,{trailing:!0,leading:!1}));var F=new ResizeObserver(N),{width:O,height:I}=g.current.getBoundingClientRect();return A(O,I),F.observe(g.current),()=>{F.disconnect()}},[A,f]);var C=M.useMemo(()=>{var{containerWidth:N,containerHeight:F}=b;if(N<0||F<0)return null;r1(lf(a)||lf(i),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,a,i),r1(!r||r>0,"The aspect(%s) must be greater than zero.",r);var O=lf(a)?N:a,I=lf(i)?F:i;return r&&r>0&&(O?I=O/r:I&&(O=I*r),c&&I>c&&(I=c)),r1(O>0||I>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,O,I,a,i,s,o,r),M.Children.map(u,P=>M.cloneElement(P,{width:O,height:I,style:n1({width:O,height:I},P.props.style)}))},[r,u,i,c,o,s,b,a]);return M.createElement("div",{id:d?"".concat(d):void 0,className:Pn("recharts-responsive-container",p),style:n1(n1({},x),{},{width:a,height:i,minWidth:s,minHeight:o,maxHeight:c}),ref:g},M.createElement("div",{style:{width:0,height:0,overflow:"visible"}},C))}),Bp=e=>null;Bp.displayName="Cell";function GW(e,t,r){return(t=VW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function VW(e){var t=KW(e,"string");return typeof t=="symbol"?t:t+""}function KW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class YW{constructor(t){GW(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function a5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function XW(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?a5(Object(r),!0).forEach(function(n){ZW(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function ZW(e,t,r){return(t=JW(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function JW(e){var t=QW(e,"string");return typeof t=="symbol"?t:t+""}function QW(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var eH={cacheSize:2e3,enableCache:!0},KA=XW({},eH),i5=new YW(KA.cacheSize),tH={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},s5="recharts_measurement_span";function rH(e,t){var r=t.fontSize||"",n=t.fontFamily||"",a=t.fontWeight||"",i=t.fontStyle||"",s=t.letterSpacing||"",o=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(a,"|").concat(i,"|").concat(s,"|").concat(o)}var o5=(e,t)=>{try{var r=document.getElementById(s5);r||(r=document.createElement("span"),r.setAttribute("id",s5),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,tH,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},l5=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Np.isSsr)return{width:0,height:0};if(!KA.enableCache)return o5(t,r);var n=rH(t,r),a=i5.get(n);if(a)return a;var i=o5(t,r);return i5.set(n,i),i},c5=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,u5=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,nH=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,aH=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,YA={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},iH=Object.keys(YA),Tc="NaN";function sH(e,t){return e*YA[t]}class _a{static parse(t){var r,[,n,a]=(r=aH.exec(t))!==null&&r!==void 0?r:[];return new _a(parseFloat(n),a??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,Ii(t)&&(this.unit=""),r!==""&&!nH.test(r)&&(this.num=NaN,this.unit=""),iH.includes(r)&&(this.num=sH(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new _a(NaN,""):new _a(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new _a(NaN,""):new _a(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new _a(NaN,""):new _a(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new _a(NaN,""):new _a(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Ii(this.num)}}function XA(e){if(e.includes(Tc))return Tc;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,a,i]=(r=c5.exec(t))!==null&&r!==void 0?r:[],s=_a.parse(n??""),o=_a.parse(i??""),c=a==="*"?s.multiply(o):s.divide(o);if(c.isNaN())return Tc;t=t.replace(c5,c.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var u,[,f,d,p]=(u=u5.exec(t))!==null&&u!==void 0?u:[],h=_a.parse(f??""),x=_a.parse(p??""),g=d==="+"?h.add(x):h.subtract(x);if(g.isNaN())return Tc;t=t.replace(u5,g.toString())}return t}var f5=/\(([^()]*)\)/;function oH(e){for(var t=e,r;(r=f5.exec(t))!=null;){var[,n]=r;t=t.replace(f5,XA(n))}return t}function lH(e){var t=e.replace(/\s+/g,"");return t=oH(t),t=XA(t),t}function cH(e){try{return lH(e)}catch{return Tc}}function a1(e){var t=cH(e.slice(5,-1));return t===Tc?"":t}var uH=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],fH=["dx","dy","angle","className","breakAll"];function Pg(){return Pg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Pg.apply(null,arguments)}function d5(e,t){if(e==null)return{};var r,n,a=dH(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function dH(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var ZA=/[ \f\n\r\t\v\u2028\u2029]+/,JA=e=>{var{children:t,breakAll:r,style:n}=e;try{var a=[];Dl(t)||(r?a=t.toString().split(""):a=t.toString().split(ZA));var i=a.map(o=>({word:o,width:l5(o,n).width})),s=r?0:l5("¬†",n).width;return{wordsWithComputedWidth:i,spaceWidth:s}}catch{return null}},hH=(e,t,r,n,a)=>{var{maxLines:i,children:s,style:o,breakAll:c}=e,u=Vt(i),f=s,d=function(){var T=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return T.reduce((j,z)=>{var{word:K,width:he}=z,be=j[j.length-1];if(be&&(n==null||a||be.width+he+r<Number(n)))be.words.push(K),be.width+=he+r;else{var we={words:[K],width:he};j.push(we)}return j},[])},p=d(t),h=H=>H.reduce((T,j)=>T.width>j.width?T:j);if(!u||a)return p;var x=p.length>i||h(p).width>Number(n);if(!x)return p;for(var g="‚Ä¶",y=H=>{var T=f.slice(0,H),j=JA({breakAll:c,style:o,children:T+g}).wordsWithComputedWidth,z=d(j),K=z.length>i||h(z).width>Number(n);return[K,z]},b=0,E=f.length-1,A=0,C;b<=E&&A<=f.length-1;){var N=Math.floor((b+E)/2),F=N-1,[O,I]=y(F),[P]=y(N);if(!O&&!P&&(b=N+1),O&&P&&(E=N-1),!O&&P){C=I;break}A++}return C||p},h5=e=>{var t=Dl(e)?[]:e.toString().split(ZA);return[{words:t}]},pH=e=>{var{width:t,scaleToFit:r,children:n,style:a,breakAll:i,maxLines:s}=e;if((t||r)&&!Np.isSsr){var o,c,u=JA({breakAll:i,children:n,style:a});if(u){var{wordsWithComputedWidth:f,spaceWidth:d}=u;o=f,c=d}else return h5(n);return hH({breakAll:i,children:n,maxLines:s,style:a},o,c,t,r)}return h5(n)},p5="#808080",QA=M.forwardRef((e,t)=>{var{x:r=0,y:n=0,lineHeight:a="1em",capHeight:i="0.71em",scaleToFit:s=!1,textAnchor:o="start",verticalAnchor:c="end",fill:u=p5}=e,f=d5(e,uH),d=M.useMemo(()=>pH({breakAll:f.breakAll,children:f.children,maxLines:f.maxLines,scaleToFit:s,style:f.style,width:f.width}),[f.breakAll,f.children,f.maxLines,s,f.style,f.width]),{dx:p,dy:h,angle:x,className:g,breakAll:y}=f,b=d5(f,fH);if(!Bs(r)||!Bs(n))return null;var E=r+(Vt(p)?p:0),A=n+(Vt(h)?h:0),C;switch(c){case"start":C=a1("calc(".concat(i,")"));break;case"middle":C=a1("calc(".concat((d.length-1)/2," * -").concat(a," + (").concat(i," / 2))"));break;default:C=a1("calc(".concat(d.length-1," * -").concat(a,")"));break}var N=[];if(s){var F=d[0].width,{width:O}=f;N.push("scale(".concat(Vt(O)?O/F:1,")"))}return x&&N.push("rotate(".concat(x,", ").concat(E,", ").concat(A,")")),N.length&&(b.transform=N.join(" ")),M.createElement("text",Pg({},Xa(b,!0),{ref:t,x:E,y:A,className:Pn("recharts-text",g),textAnchor:o,fill:u.includes("url")?p5:u}),d.map((I,P)=>{var H=I.words.join(y?"":" ");return M.createElement("tspan",{x:E,dy:P===0?C:a,key:"".concat(H,"-").concat(P)},H)}))});QA.displayName="Text";var eE=e=>e.graphicalItems.polarItems,mH=Oe([Fr,d0],Tv),Qv=Oe([eE,tn,mH],Pv),gH=Oe([Qv],kv),e2=Oe([gH,xv],Cv),xH=Oe([e2,tn,Qv],Lv),vH=Oe([e2,tn,Qv],(e,t,r)=>r.length>0?e.flatMap(n=>r.flatMap(a=>{var i,s=ln(n,(i=t.dataKey)!==null&&i!==void 0?i:a.dataKey);return{value:s,errorDomain:[]}})).filter(Boolean):(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:ln(n,t.dataKey),errorDomain:[]})):e.map(n=>({value:n,errorDomain:[]}))),m5=()=>{},yH=Oe([tn,cA,m5,vH,m5,Er,Fr],Dv),tE=Oe([tn,Er,e2,xH,f0,Fr,yH],Iv),bH=Oe([tE,tn,gu],Bv);Oe([tn,tE,bH,Fr],$v);var wH={radiusAxis:{},angleAxis:{}},_H=Qa({name:"polarAxis",initialState:wH,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),NH=_H.reducer;function g5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function x5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?g5(Object(r),!0).forEach(function(n){SH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function SH(e,t,r){return(t=AH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function AH(e){var t=EH(e,"string");return typeof t=="symbol"?t:t+""}function EH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var jH=(e,t)=>t,t2=Oe([eE,jH],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),TH=[],r2=(e,t,r)=>(r==null?void 0:r.length)===0?TH:r,rE=Oe([xv,t2,r2],(e,t,r)=>{var{chartData:n}=e;if(t!=null){var a;if((t==null?void 0:t.data)!=null&&t.data.length>0?a=t.data:a=n,(!a||!a.length)&&r!=null&&(a=r.map(i=>x5(x5({},t.presentationProps),i.props))),a!=null)return a}}),PH=Oe([rE,t2,r2],(e,t,r)=>{if(!(e==null||t==null))return e.map((n,a)=>{var i,s=ln(n,t.nameKey,t.name),o;return r!=null&&(i=r[a])!==null&&i!==void 0&&(i=i.props)!==null&&i!==void 0&&i.fill?o=r[a].props.fill:typeof n=="object"&&n!=null&&"fill"in n?o=n.fill:o=t.fill,{value:yS(s,t.dataKey),color:o,payload:n,type:t.legendType}})}),kH=Oe([rE,t2,r2,sa],(e,t,r,n)=>{if(!(t==null||e==null))return jG({offset:n,pieSettings:t,displayedData:e,cells:r})}),nE={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var a;if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const i=r[Symbol.toStringTag];return i==null||!((a=Object.getOwnPropertyDescriptor(r,Symbol.toStringTag))!=null&&a.writable)?!1:r.toString()===`[object ${i}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}e.isPlainObject=t})(nE);var CH=nE.isPlainObject;const OH=zo(CH);function Th(){return Th=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Th.apply(null,arguments)}var v5=(e,t,r,n,a)=>{var i=r-n,s;return s="M ".concat(e,",").concat(t),s+="L ".concat(e+r,",").concat(t),s+="L ".concat(e+r-i/2,",").concat(t+a),s+="L ".concat(e+r-i/2-n,",").concat(t+a),s+="L ".concat(e,",").concat(t," Z"),s},LH={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},FH=e=>{var t=Wo(e,LH),r=M.useRef(),[n,a]=M.useState(-1);M.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var y=r.current.getTotalLength();y&&a(y)}catch{}},[]);var{x:i,y:s,upperWidth:o,lowerWidth:c,height:u,className:f}=t,{animationEasing:d,animationDuration:p,animationBegin:h,isUpdateAnimationActive:x}=t;if(i!==+i||s!==+s||o!==+o||c!==+c||u!==+u||o===0&&c===0||u===0)return null;var g=Pn("recharts-trapezoid",f);return x?M.createElement(hh,{canBegin:n>0,from:{upperWidth:0,lowerWidth:0,height:u,x:i,y:s},to:{upperWidth:o,lowerWidth:c,height:u,x:i,y:s},duration:p,animationEasing:d,isActive:x},y=>{var{upperWidth:b,lowerWidth:E,height:A,x:C,y:N}=y;return M.createElement(hh,{canBegin:n>0,from:"0px ".concat(n===-1?1:n,"px"),to:"".concat(n,"px 0px"),attributeName:"strokeDasharray",begin:h,duration:p,easing:d},M.createElement("path",Th({},Xa(t,!0),{className:g,d:v5(C,N,b,E,A),ref:r})))}):M.createElement("g",null,M.createElement("path",Th({},Xa(t,!0),{className:g,d:v5(i,s,o,c,u)})))},DH=["option","shapeType","propTransformer","activeClassName","isActive"];function IH(e,t){if(e==null)return{};var r,n,a=MH(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function MH(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function y5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function Ph(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?y5(Object(r),!0).forEach(function(n){RH(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function RH(e,t,r){return(t=BH(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BH(e){var t=UH(e,"string");return typeof t=="symbol"?t:t+""}function UH(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $H(e,t){return Ph(Ph({},t),e)}function zH(e,t){return e==="symbols"}function b5(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return M.createElement(RS,r);case"trapezoid":return M.createElement(FH,r);case"sector":return M.createElement($S,r);case"symbols":if(zH(t))return M.createElement(bN,r);break;default:return null}}function qH(e){return M.isValidElement(e)?e.props:e}function WH(e){var{option:t,shapeType:r,propTransformer:n=$H,activeClassName:a="recharts-active-shape",isActive:i}=e,s=IH(e,DH),o;if(M.isValidElement(t))o=M.cloneElement(t,Ph(Ph({},s),qH(t)));else if(typeof t=="function")o=t(s);else if(OH(t)&&typeof t!="boolean"){var c=n(t,s);o=M.createElement(b5,{shapeType:r,elementProps:c})}else{var u=s;o=M.createElement(b5,{shapeType:r,elementProps:u})}return i?M.createElement(Vc,{className:a},o):o}var HH=(e,t)=>{var r=ia();return(n,a)=>i=>{e==null||e(n,a,i),r(_A({activeIndex:String(a),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}},GH=e=>{var t=ia();return(r,n)=>a=>{e==null||e(r,n,a),t(hq())}},VH=(e,t)=>{var r=ia();return(n,a)=>i=>{e==null||e(n,a,i),r(pq({activeIndex:String(a),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}};function KH(e){var{fn:t,args:r}=e,n=ia(),a=lu();return M.useEffect(()=>{if(!a){var i=t(r);return n(uq(i)),()=>{n(fq(i))}}},[t,r,n,a]),null}var YH=()=>{};function XH(e){var{legendPayload:t}=e,r=ia(),n=qt(Er);return M.useEffect(()=>n!=="centric"&&n!=="radial"?YH:(r(dR(t)),()=>{r(hR(t))}),[r,n,t]),null}function ZH(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=M.useRef(Xd(t)),n=M.useRef(e);return n.current!==e&&(r.current=Xd(t),n.current=e),r.current}var i1,JH=()=>{var[e]=M.useState(()=>Xd("uid-"));return e},QH=(i1=hT.useId)!==null&&i1!==void 0?i1:JH;function eG(e,t){var r=QH();return t||(e?"".concat(e,"-").concat(r):r)}var tG=M.createContext(void 0),rG=e=>{var{id:t,type:r,children:n}=e,a=eG("recharts-".concat(r),t);return M.createElement(tG.Provider,{value:a},n(a))},nG={cartesianItems:[],polarItems:[]},aE=Qa({name:"graphicalItems",initialState:nG,reducers:{addCartesianGraphicalItem(e,t){e.cartesianItems.push(t.payload)},replaceCartesianGraphicalItem(e,t){var{prev:r,next:n}=t.payload,a=Ds(e).cartesianItems.indexOf(r);a>-1&&(e.cartesianItems[a]=n)},removeCartesianGraphicalItem(e,t){var r=Ds(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},addPolarGraphicalItem(e,t){e.polarItems.push(t.payload)},removePolarGraphicalItem(e,t){var r=Ds(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)}}}),{addCartesianGraphicalItem:NJ,replaceCartesianGraphicalItem:SJ,removeCartesianGraphicalItem:AJ,addPolarGraphicalItem:aG,removePolarGraphicalItem:iG}=aE.actions,sG=aE.reducer;function oG(e){var t=ia();return M.useEffect(()=>(t(aG(e)),()=>{t(iG(e))}),[t,e]),null}function lG(){}var cG={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},w5={t:0},s1={t:1};function uG(e){var t=Wo(e,cG),{isActive:r,canBegin:n,duration:a,easing:i,begin:s,onAnimationEnd:o,onAnimationStart:c,children:u}=t,f=MS("JavascriptAnimate",t.animationManager),[d,p]=M.useState(r?w5:s1),h=M.useRef(null);return M.useEffect(()=>{r||p(s1)},[r]),M.useEffect(()=>{if(!r||!n)return lG;var x=IS(w5,s1,FS(i),a,p,f.getTimeoutController()),g=()=>{h.current=x()};return f.start([c,s,g,a,o]),()=>{f.stop(),h.current&&h.current(),o()}},[r,n,a,i,s,c,o,f]),u(d.t)}var fG=["onMouseEnter","onClick","onMouseLeave"],dG=["id"],hG=["id"];function n2(e,t){if(e==null)return{};var r,n,a=pG(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function pG(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function _5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function zr(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_5(Object(r),!0).forEach(function(n){mG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function mG(e,t,r){return(t=gG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function gG(e){var t=xG(e,"string");return typeof t=="symbol"?t:t+""}function xG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ws(){return Ws=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ws.apply(null,arguments)}function vG(e){var t=M.useMemo(()=>tN(e.children,Bp),[e.children]),r=qt(n=>PH(n,e.id,t));return r==null?null:M.createElement(XH,{legendPayload:r})}function yG(e){var{dataKey:t,nameKey:r,sectors:n,stroke:a,strokeWidth:i,fill:s,name:o,hide:c,tooltipType:u}=e;return{dataDefinedOnItem:n==null?void 0:n.map(f=>f.tooltipPayload),positions:n==null?void 0:n.map(f=>f.tooltipPosition),settings:{stroke:a,strokeWidth:i,fill:s,dataKey:t,nameKey:r,name:yS(o,t),hide:c,type:u,color:s,unit:""}}}var bG=(e,t)=>e>t?"start":e<t?"end":"middle",wG=(e,t,r)=>typeof t=="function"?t(e):ss(t,r,r*.8),_G=(e,t,r)=>{var{top:n,left:a,width:i,height:s}=t,o=xS(i,s),c=a+ss(e.cx,i,i/2),u=n+ss(e.cy,s,s/2),f=ss(e.innerRadius,o,0),d=wG(r,e.outerRadius,o),p=e.maxRadius||Math.sqrt(i*i+s*s)/2;return{cx:c,cy:u,innerRadius:f,outerRadius:d,maxRadius:p}},NG=(e,t)=>{var r=Ha(t-e),n=Math.min(Math.abs(t-e),360);return r*n},SG=(e,t)=>{if(M.isValidElement(e))return M.cloneElement(e,t);if(typeof e=="function")return e(t);var r=Pn("recharts-pie-label-line",typeof e!="boolean"?e.className:"");return M.createElement(jS,Ws({},t,{type:"linear",className:r}))},AG=(e,t,r)=>{if(M.isValidElement(e))return M.cloneElement(e,t);var n=r;if(typeof e=="function"&&(n=e(t),M.isValidElement(n)))return n;var a=Pn("recharts-pie-label-text",typeof e!="boolean"&&typeof e!="function"?e.className:"");return M.createElement(QA,Ws({},t,{alignmentBaseline:"middle",className:a}),n)};function EG(e){var{sectors:t,props:r,showLabels:n}=e,{label:a,labelLine:i,dataKey:s}=r;if(!n||!a||!t)return null;var o=ip(r),c=Xa(a,!1),u=Xa(i,!1),f=typeof a=="object"&&"offsetRadius"in a&&a.offsetRadius||20,d=t.map((p,h)=>{var x=(p.startAngle+p.endAngle)/2,g=ta(p.cx,p.cy,p.outerRadius+f,x),y=zr(zr(zr(zr({},o),p),{},{stroke:"none"},c),{},{index:h,textAnchor:bG(g.x,p.cx)},g),b=zr(zr(zr(zr({},o),p),{},{fill:"none",stroke:p.fill},u),{},{index:h,points:[ta(p.cx,p.cy,p.outerRadius,x),g],key:"line"});return M.createElement(Vc,{key:"label-".concat(p.startAngle,"-").concat(p.endAngle,"-").concat(p.midAngle,"-").concat(h)},i&&SG(i,b),AG(a,y,ln(p,s)))});return M.createElement(Vc,{className:"recharts-pie-labels"},d)}function iE(e){var{sectors:t,activeShape:r,inactiveShape:n,allOtherPieProps:a,showLabels:i}=e,s=qt(zf),{onMouseEnter:o,onClick:c,onMouseLeave:u}=a,f=n2(a,fG),d=HH(o,a.dataKey),p=GH(u),h=VH(c,a.dataKey);return t==null?null:M.createElement(M.Fragment,null,t.map((x,g)=>{if((x==null?void 0:x.startAngle)===0&&(x==null?void 0:x.endAngle)===0&&t.length!==1)return null;var y=r&&String(g)===s,b=s?n:null,E=y?r:b,A=zr(zr({},x),{},{stroke:x.stroke,tabIndex:-1,[wS]:g,[_S]:a.dataKey});return M.createElement(Vc,Ws({tabIndex:-1,className:"recharts-pie-sector"},VD(f,x,g),{onMouseEnter:d(x,g),onMouseLeave:p(x,g),onClick:h(x,g),key:"sector-".concat(x==null?void 0:x.startAngle,"-").concat(x==null?void 0:x.endAngle,"-").concat(x.midAngle,"-").concat(g)}),M.createElement(WH,Ws({option:E,isActive:y,shapeType:"sector"},A)))}),M.createElement(EG,{sectors:t,props:a,showLabels:i}))}function jG(e){var t,{pieSettings:r,displayedData:n,cells:a,offset:i}=e,{cornerRadius:s,startAngle:o,endAngle:c,dataKey:u,nameKey:f,tooltipType:d}=r,p=Math.abs(r.minAngle),h=NG(o,c),x=Math.abs(h),g=n.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,y=n.filter(F=>ln(F,u,0)!==0).length,b=(x>=360?y:y-1)*g,E=x-y*p-b,A=n.reduce((F,O)=>{var I=ln(O,u,0);return F+(Vt(I)?I:0)},0),C;if(A>0){var N;C=n.map((F,O)=>{var I=ln(F,u,0),P=ln(F,f,O),H=_G(r,i,F),T=(Vt(I)?I:0)/A,j,z=zr(zr({},F),a&&a[O]&&a[O].props);O?j=N.endAngle+Ha(h)*g*(I!==0?1:0):j=o;var K=j+Ha(h)*((I!==0?p:0)+T*E),he=(j+K)/2,be=(H.innerRadius+H.outerRadius)/2,we=[{name:P,value:I,payload:z,dataKey:u,type:d}],Q=ta(H.cx,H.cy,be,he);return N=zr(zr(zr(zr({},r.presentationProps),{},{percent:T,cornerRadius:s,name:P,tooltipPayload:we,midAngle:he,middleRadius:be,tooltipPosition:Q},z),H),{},{value:ln(F,u),startAngle:j,endAngle:K,payload:z,paddingAngle:Ha(h)*g}),N})}return C}function TG(e){var{props:t,previousSectorsRef:r}=e,{sectors:n,isAnimationActive:a,animationBegin:i,animationDuration:s,animationEasing:o,activeShape:c,inactiveShape:u,onAnimationStart:f,onAnimationEnd:d}=t,p=ZH(t,"recharts-pie-"),h=r.current,[x,g]=M.useState(!0),y=M.useCallback(()=>{typeof d=="function"&&d(),g(!1)},[d]),b=M.useCallback(()=>{typeof f=="function"&&f(),g(!0)},[f]);return M.createElement(uG,{begin:i,duration:s,isActive:a,easing:o,onAnimationStart:b,onAnimationEnd:y,key:p},E=>{var A=[],C=n&&n[0],N=C.startAngle;return n.forEach((F,O)=>{var I=h&&h[O],P=O>0?Gc(F,"paddingAngle",0):0;if(I){var H=lb(I.endAngle-I.startAngle,F.endAngle-F.startAngle),T=zr(zr({},F),{},{startAngle:N+P,endAngle:N+H(E)+P});A.push(T),N=T.endAngle}else{var{endAngle:j,startAngle:z}=F,K=lb(0,j-z),he=K(E),be=zr(zr({},F),{},{startAngle:N+P,endAngle:N+he+P});A.push(be),N=be.endAngle}}),r.current=A,M.createElement(Vc,null,M.createElement(iE,{sectors:A,activeShape:c,inactiveShape:u,allOtherPieProps:t,showLabels:!x}))})}function PG(e){var{sectors:t,isAnimationActive:r,activeShape:n,inactiveShape:a}=e,i=M.useRef(null),s=i.current;return r&&t&&t.length&&(!s||s!==t)?M.createElement(TG,{props:e,previousSectorsRef:i}):M.createElement(iE,{sectors:t,activeShape:n,inactiveShape:a,allOtherPieProps:e,showLabels:!0})}function kG(e){var{hide:t,className:r,rootTabIndex:n}=e,a=Pn("recharts-pie",r);return t?null:M.createElement(Vc,{tabIndex:n,className:a},M.createElement(PG,e))}var CG={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!Np.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff"};function OG(e){var{id:t}=e,r=n2(e,dG),n=M.useMemo(()=>tN(e.children,Bp),[e.children]),a=qt(i=>kH(i,t,n));return M.createElement(M.Fragment,null,M.createElement(KH,{fn:yG,args:zr(zr({},e),{},{sectors:a})}),M.createElement(kG,Ws({},r,{sectors:a})))}function sE(e){var t=Wo(e,CG),{id:r}=t,n=n2(t,hG),a=ip(n);return M.createElement(rG,{id:r,type:"pie"},i=>M.createElement(M.Fragment,null,M.createElement(oG,{type:"pie",id:i,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:a}),M.createElement(vG,Ws({},n,{id:i})),M.createElement(OG,Ws({},n,{id:i})),n.children))}sE.displayName="Pie";var LG=Oe([sa],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),FG=Oe([LG,Vs,Ks],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),DG=()=>qt(FG),IG={},MG=Qa({name:"errorBars",initialState:IG,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(a=>a.dataKey!==n.dataKey||a.direction!==n.direction))}}}),RG=MG.reducer,BG=e=>{var{chartData:t}=e,r=ia(),n=lu();return M.useEffect(()=>n?()=>{}:(r(Qw(t)),()=>{r(Qw(void 0))}),[t,r,n]),null},N5={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},UG=Qa({name:"brush",initialState:N5,reducers:{setBrushSettings(e,t){return t.payload==null?N5:t.payload}}}),$G=UG.reducer,zG={dots:[],areas:[],lines:[]},qG=Qa({name:"referenceElements",initialState:zG,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=Ds(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=Ds(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=Ds(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),WG=qG.reducer,HG=M.createContext(void 0),GG=e=>{var{children:t}=e,[r]=M.useState("".concat(Xd("recharts"),"-clip")),n=DG();if(n==null)return null;var{x:a,y:i,width:s,height:o}=n;return M.createElement(HG.Provider,{value:r},M.createElement("defs",null,M.createElement("clipPath",{id:r},M.createElement("rect",{x:a,y:i,height:o,width:s}))),t)};function S5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function A5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?S5(Object(r),!0).forEach(function(n){VG(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VG(e,t,r){return(t=KG(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KG(e){var t=YG(e,"string");return typeof t=="symbol"?t:t+""}function YG(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var XG={xAxis:{},yAxis:{},zAxis:{}},ZG=Qa({name:"cartesianAxis",initialState:XG,reducers:{addXAxis(e,t){e.xAxis[t.payload.id]=t.payload},removeXAxis(e,t){delete e.xAxis[t.payload.id]},addYAxis(e,t){e.yAxis[t.payload.id]=t.payload},removeYAxis(e,t){delete e.yAxis[t.payload.id]},addZAxis(e,t){e.zAxis[t.payload.id]=t.payload},removeZAxis(e,t){delete e.zAxis[t.payload.id]},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload;e.yAxis[r]&&(e.yAxis[r]=A5(A5({},e.yAxis[r]),{},{width:n}))}}}),JG=ZG.reducer,QG={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var v0=M;function eV(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var tV=typeof Object.is=="function"?Object.is:eV,rV=v0.useSyncExternalStore,nV=v0.useRef,aV=v0.useEffect,iV=v0.useMemo,sV=v0.useDebugValue;QG.useSyncExternalStoreWithSelector=function(e,t,r,n,a){var i=nV(null);if(i.current===null){var s={hasValue:!1,value:null};i.current=s}else s=i.current;i=iV(function(){function c(h){if(!u){if(u=!0,f=h,h=n(h),a!==void 0&&s.hasValue){var x=s.value;if(a(x,h))return d=x}return d=h}if(x=d,tV(f,h))return x;var g=n(h);return a!==void 0&&a(x,g)?(f=h,x):(f=h,d=g)}var u=!1,f,d,p=r===void 0?null:r;return[function(){return c(t())},p===null?void 0:function(){return c(p())}]},[t,r,n,a]);var o=rV(e,i[0],i[1]);return aV(function(){s.hasValue=!0,s.value=o},[o]),sV(o),o};function oV(e){e()}function lV(){let e=null,t=null;return{clear(){e=null,t=null},notify(){oV(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const a=t={callback:r,next:null,prev:t};return a.prev?a.prev.next=a:e=a,function(){!n||e===null||(n=!1,a.next?a.next.prev=a.prev:t=a.prev,a.prev?a.prev.next=a.next:e=a.next)}}}}var E5={notify(){},get:()=>[]};function cV(e,t){let r,n=E5,a=0,i=!1;function s(g){f();const y=n.subscribe(g);let b=!1;return()=>{b||(b=!0,y(),d())}}function o(){n.notify()}function c(){x.onStateChange&&x.onStateChange()}function u(){return i}function f(){a++,r||(r=e.subscribe(c),n=lV())}function d(){a--,r&&a===0&&(r(),r=void 0,n.clear(),n=E5)}function p(){i||(i=!0,f())}function h(){i&&(i=!1,d())}const x={addNestedSub:s,notifyNestedSubs:o,handleChangeWrapper:c,isSubscribed:u,trySubscribe:p,tryUnsubscribe:h,getListeners:()=>n};return x}var uV=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",fV=uV(),dV=()=>typeof navigator<"u"&&navigator.product==="ReactNative",hV=dV(),pV=()=>fV||hV?M.useLayoutEffect:M.useEffect,mV=pV(),o1=Symbol.for("react-redux-context"),l1=typeof globalThis<"u"?globalThis:{};function gV(){if(!M.createContext)return{};const e=l1[o1]??(l1[o1]=new Map);let t=e.get(M.createContext);return t||(t=M.createContext(null),e.set(M.createContext,t)),t}var xV=gV();function vV(e){const{children:t,context:r,serverState:n,store:a}=e,i=M.useMemo(()=>{const c=cV(a);return{store:a,subscription:c,getServerState:n?()=>n:void 0}},[a,n]),s=M.useMemo(()=>a.getState(),[a]);mV(()=>{const{subscription:c}=i;return c.onStateChange=c.notifyNestedSubs,c.trySubscribe(),s!==a.getState()&&c.notifyNestedSubs(),()=>{c.tryUnsubscribe(),c.onStateChange=void 0}},[i,s]);const o=r||xV;return M.createElement(o.Provider,{value:i},t)}var yV=vV,bV=(e,t)=>t,a2=Oe([bV,Er,gz,bn,CA,Xs,oW,sa],dW),i2=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},oE=hi("mouseClick"),lE=s0();lE.startListening({actionCreator:oE,effect:(e,t)=>{var r=e.payload,n=a2(t.getState(),i2(r));(n==null?void 0:n.activeIndex)!=null&&t.dispatch(mq({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var kg=hi("mouseMove"),cE=s0();cE.startListening({actionCreator:kg,effect:(e,t)=>{var r=e.payload,n=t.getState(),a=Wv(n,n.tooltip.settings.shared),i=a2(n,i2(r));a==="axis"&&((i==null?void 0:i.activeIndex)!=null?t.dispatch(SA({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate})):t.dispatch(NA()))}});function wV(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":t}var j5={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},uE=Qa({name:"rootProps",initialState:j5,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:j5.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),_V=uE.reducer,{updateOptions:NV}=uE.actions,fE=Qa({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:SV}=fE.actions,AV=fE.reducer,dE=hi("keyDown"),hE=hi("focus"),s2=s0();s2.startListening({actionCreator:dE,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip,i=e.payload;if(!(i!=="ArrowRight"&&i!=="ArrowLeft"&&i!=="Enter")){var s=Number(Hv(a,vu(r))),o=Xs(r);if(i==="Enter"){var c=jh(r,"axis","hover",String(a.index));t.dispatch(Eg({active:!a.active,activeIndex:a.index,activeDataKey:a.dataKey,activeCoordinate:c}));return}var u=sq(r),f=u==="left-to-right"?1:-1,d=i==="ArrowRight"?1:-1,p=s+d*f;if(!(o==null||p>=o.length||p<0)){var h=jh(r,"axis","hover",String(p));t.dispatch(Eg({active:!0,activeIndex:p.toString(),activeDataKey:void 0,activeCoordinate:h}))}}}}});s2.startListening({actionCreator:hE,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:a}=r.tooltip;if(!a.active&&a.index==null){var i="0",s=jh(r,"axis","hover",String(i));t.dispatch(Eg({activeDataKey:void 0,active:!0,activeIndex:i,activeCoordinate:s}))}}}});var oi=hi("externalEvent"),pE=s0();pE.startListening({actionCreator:oi,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),n={activeCoordinate:Jq(r),activeDataKey:Xq(r),activeIndex:zf(r),activeLabel:FA(r),activeTooltipIndex:zf(r),isTooltipActive:Qq(r)};e.payload.handler(n,e.payload.reactEvent)}}});var EV=Oe([xu],e=>e.tooltipItemPayloads),jV=Oe([EV,g0,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,n)=>{var a=e.find(o=>o.settings.dataKey===n);if(a!=null){var{positions:i}=a;if(i!=null){var s=t(i,r);return s}}}),mE=hi("touchMove"),gE=s0();gE.startListening({actionCreator:mE,effect:(e,t)=>{var r=e.payload,n=t.getState(),a=Wv(n,n.tooltip.settings.shared);if(a==="axis"){var i=a2(n,i2({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));(i==null?void 0:i.activeIndex)!=null&&t.dispatch(SA({activeIndex:i.activeIndex,activeDataKey:void 0,activeCoordinate:i.activeCoordinate}))}else if(a==="item"){var s,o=r.touches[0],c=document.elementFromPoint(o.clientX,o.clientY);if(!c||!c.getAttribute)return;var u=c.getAttribute(wS),f=(s=c.getAttribute(_S))!==null&&s!==void 0?s:void 0,d=jV(t.getState(),u,f);t.dispatch(_A({activeDataKey:f,activeIndex:u,activeCoordinate:d}))}}});var TV=KN({brush:$G,cartesianAxis:JG,chartData:TW,errorBars:RG,graphicalItems:sG,layout:j9,legend:pR,options:NW,polarAxis:NH,polarOptions:AV,referenceElements:WG,rootProps:_V,tooltip:gq}),PV=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return JM({reducer:TV,preloadedState:t,middleware:n=>n({serializableCheck:!1}).concat([lE.middleware,cE.middleware,s2.middleware,pE.middleware,gE.middleware]),devTools:{serialize:{replacer:wV},name:"recharts-".concat(r)}})};function kV(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,a=lu(),i=M.useRef(null);if(a)return r;i.current==null&&(i.current=PV(t,n));var s=Mx;return M.createElement(yV,{context:s,store:i.current},r)}function CV(e){var{layout:t,width:r,height:n,margin:a}=e,i=ia(),s=lu();return M.useEffect(()=>{s||(i(S9(t)),i(A9({width:r,height:n})),i(N9(a)))},[i,s,t,r,n,a]),null}function OV(e){var t=ia();return M.useEffect(()=>{t(NV(e))},[t,e]),null}var LV=["children"];function FV(e,t){if(e==null)return{};var r,n,a=DV(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function DV(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function kh(){return kh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kh.apply(null,arguments)}var IV={width:"100%",height:"100%"},MV=M.forwardRef((e,t)=>{var r=cR(),n=uR(),a=ES();if(!uh(r)||!uh(n))return null;var{children:i,otherAttributes:s,title:o,desc:c}=e,u,f;return typeof s.tabIndex=="number"?u=s.tabIndex:u=a?0:void 0,typeof s.role=="string"?f=s.role:f=a?"application":void 0,M.createElement(rN,kh({},s,{title:o,desc:c,role:f,tabIndex:u,width:r,height:n,style:IV,ref:t}),i)}),RV=e=>{var{children:t}=e,r=qt(_p);if(!r)return null;var{width:n,height:a,y:i,x:s}=r;return M.createElement(rN,{width:n,height:a,x:s,y:i},t)},T5=M.forwardRef((e,t)=>{var{children:r}=e,n=FV(e,LV),a=lu();return a?M.createElement(RV,null,r):M.createElement(MV,kh({ref:t},n),r)});function BV(){var e=ia(),[t,r]=M.useState(null),n=qt(eR);return M.useEffect(()=>{if(t!=null){var a=t.getBoundingClientRect(),i=a.width/t.offsetWidth;Mi(i)&&i!==n&&e(E9(i))}},[t,e,n]),r}function P5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function UV(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?P5(Object(r),!0).forEach(function(n){$V(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):P5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $V(e,t,r){return(t=zV(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function zV(e){var t=qV(e,"string");return typeof t=="symbol"?t:t+""}function qV(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var WV=M.forwardRef((e,t)=>{var{children:r,className:n,height:a,onClick:i,onContextMenu:s,onDoubleClick:o,onMouseDown:c,onMouseEnter:u,onMouseLeave:f,onMouseMove:d,onMouseUp:p,onTouchEnd:h,onTouchMove:x,onTouchStart:g,style:y,width:b}=e,E=ia(),[A,C]=M.useState(null),[N,F]=M.useState(null);CW();var O=BV(),I=M.useCallback(S=>{O(S),typeof t=="function"&&t(S),C(S),F(S)},[O,t,C,F]),P=M.useCallback(S=>{E(oE(S)),E(oi({handler:i,reactEvent:S}))},[E,i]),H=M.useCallback(S=>{E(kg(S)),E(oi({handler:u,reactEvent:S}))},[E,u]),T=M.useCallback(S=>{E(NA()),E(oi({handler:f,reactEvent:S}))},[E,f]),j=M.useCallback(S=>{E(kg(S)),E(oi({handler:d,reactEvent:S}))},[E,d]),z=M.useCallback(()=>{E(hE())},[E]),K=M.useCallback(S=>{E(dE(S.key))},[E]),he=M.useCallback(S=>{E(oi({handler:s,reactEvent:S}))},[E,s]),be=M.useCallback(S=>{E(oi({handler:o,reactEvent:S}))},[E,o]),we=M.useCallback(S=>{E(oi({handler:c,reactEvent:S}))},[E,c]),Q=M.useCallback(S=>{E(oi({handler:p,reactEvent:S}))},[E,p]),le=M.useCallback(S=>{E(oi({handler:g,reactEvent:S}))},[E,g]),ke=M.useCallback(S=>{E(mE(S)),E(oi({handler:x,reactEvent:S}))},[E,x]),ve=M.useCallback(S=>{E(oi({handler:h,reactEvent:S}))},[E,h]);return M.createElement(UA.Provider,{value:A},M.createElement(rI.Provider,{value:N},M.createElement("div",{className:Pn("recharts-wrapper",n),style:UV({position:"relative",cursor:"default",width:b,height:a},y),onClick:P,onContextMenu:he,onDoubleClick:be,onFocus:z,onKeyDown:K,onMouseDown:we,onMouseEnter:H,onMouseLeave:T,onMouseMove:j,onMouseUp:Q,onTouchEnd:ve,onTouchMove:ke,onTouchStart:le,ref:I},r)))}),HV=["children","className","width","height","style","compact","title","desc"];function GV(e,t){if(e==null)return{};var r,n,a=VV(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function VV(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var KV=M.forwardRef((e,t)=>{var{children:r,className:n,width:a,height:i,style:s,compact:o,title:c,desc:u}=e,f=GV(e,HV),d=ip(f);return o?M.createElement(T5,{otherAttributes:d,title:c,desc:u},r):M.createElement(WV,{className:n,style:s,width:a,height:i,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},M.createElement(T5,{otherAttributes:d,title:c,desc:u,ref:t},M.createElement(GG,null,r)))});function YV(e){var t=ia();return M.useEffect(()=>{t(SV(e))},[t,e]),null}var XV=["width","height","layout"];function Cg(){return Cg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cg.apply(null,arguments)}function ZV(e,t){if(e==null)return{};var r,n,a=JV(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function JV(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var QV={top:5,right:5,bottom:5,left:5},eK={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:QV,reverseStackOrder:!1,syncMethod:"index",layout:"radial"},tK=M.forwardRef(function(t,r){var n,a=Wo(t.categoricalChartProps,eK),{width:i,height:s,layout:o}=a,c=ZV(a,XV);if(!uh(i)||!uh(s))return null;var{chartName:u,defaultTooltipEventType:f,validateTooltipEventTypes:d,tooltipPayloadSearcher:p}=t,h={chartName:u,defaultTooltipEventType:f,validateTooltipEventTypes:d,tooltipPayloadSearcher:p,eventEmitter:void 0};return M.createElement(kV,{preloadedState:{options:h},reduxStoreName:(n=a.id)!==null&&n!==void 0?n:u},M.createElement(BG,{chartData:a.data}),M.createElement(CV,{width:i,height:s,layout:o,margin:a.margin}),M.createElement(OV,{accessibilityLayer:a.accessibilityLayer,barCategoryGap:a.barCategoryGap,maxBarSize:a.maxBarSize,stackOffset:a.stackOffset,barGap:a.barGap,barSize:a.barSize,syncId:a.syncId,syncMethod:a.syncMethod,className:a.className}),M.createElement(YV,{cx:a.cx,cy:a.cy,startAngle:a.startAngle,endAngle:a.endAngle,innerRadius:a.innerRadius,outerRadius:a.outerRadius}),M.createElement(KV,Cg({width:i,height:s},c,{ref:r})))}),rK=["item"],nK={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},aK=M.forwardRef((e,t)=>{var r=Wo(e,nK);return M.createElement(tK,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:rK,tooltipPayloadSearcher:wW,categoricalChartProps:r,ref:t})});function fr(e){"@babel/helpers - typeof";return fr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fr(e)}var Ri=Uint8Array,Ga=Uint16Array,o2=Int32Array,l2=new Ri([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),c2=new Ri([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),k5=new Ri([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),xE=function(e,t){for(var r=new Ga(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var a=new o2(r[30]),n=1;n<30;++n)for(var i=r[n];i<r[n+1];++i)a[i]=i-r[n]<<5|n;return{b:r,r:a}},vE=xE(l2,2),iK=vE.b,Og=vE.r;iK[28]=258,Og[258]=28;var sK=xE(c2,0),C5=sK.r,Lg=new Ga(32768);for(var Pr=0;Pr<32768;++Pr){var mo=(Pr&43690)>>1|(Pr&21845)<<1;mo=(mo&52428)>>2|(mo&13107)<<2,mo=(mo&61680)>>4|(mo&3855)<<4,Lg[Pr]=((mo&65280)>>8|(mo&255)<<8)>>1}var wf=function(e,t,r){for(var n=e.length,a=0,i=new Ga(t);a<n;++a)e[a]&&++i[e[a]-1];var s=new Ga(t);for(a=1;a<t;++a)s[a]=s[a-1]+i[a-1]<<1;var o;if(r){o=new Ga(1<<t);var c=15-t;for(a=0;a<n;++a)if(e[a])for(var u=a<<4|e[a],f=t-e[a],d=s[e[a]-1]++<<f,p=d|(1<<f)-1;d<=p;++d)o[Lg[d]>>c]=u}else for(o=new Ga(n),a=0;a<n;++a)e[a]&&(o[a]=Lg[s[e[a]-1]++]>>15-e[a]);return o},Bl=new Ri(288);for(var Pr=0;Pr<144;++Pr)Bl[Pr]=8;for(var Pr=144;Pr<256;++Pr)Bl[Pr]=9;for(var Pr=256;Pr<280;++Pr)Bl[Pr]=7;for(var Pr=280;Pr<288;++Pr)Bl[Pr]=8;var Ch=new Ri(32);for(var Pr=0;Pr<32;++Pr)Ch[Pr]=5;var oK=wf(Bl,9,0),lK=wf(Ch,5,0),yE=function(e){return(e+7)/8|0},cK=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new Ri(e.subarray(t,r))},Ss=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},nf=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},c1=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var a=r.length,i=r.slice();if(!a)return{t:wE,l:0};if(a==1){var s=new Ri(r[0].s+1);return s[r[0].s]=1,{t:s,l:1}}r.sort(function(N,F){return N.f-F.f}),r.push({s:-1,f:25001});var o=r[0],c=r[1],u=0,f=1,d=2;for(r[0]={s:-1,f:o.f+c.f,l:o,r:c};f!=a-1;)o=r[r[u].f<r[d].f?u++:d++],c=r[u!=f&&r[u].f<r[d].f?u++:d++],r[f++]={s:-1,f:o.f+c.f,l:o,r:c};for(var p=i[0].s,n=1;n<a;++n)i[n].s>p&&(p=i[n].s);var h=new Ga(p+1),x=Fg(r[f-1],h,0);if(x>t){var n=0,g=0,y=x-t,b=1<<y;for(i.sort(function(F,O){return h[O.s]-h[F.s]||F.f-O.f});n<a;++n){var E=i[n].s;if(h[E]>t)g+=b-(1<<x-h[E]),h[E]=t;else break}for(g>>=y;g>0;){var A=i[n].s;h[A]<t?g-=1<<t-h[A]++-1:++n}for(;n>=0&&g;--n){var C=i[n].s;h[C]==t&&(--h[C],++g)}x=t}return{t:new Ri(h),l:x}},Fg=function(e,t,r){return e.s==-1?Math.max(Fg(e.l,t,r+1),Fg(e.r,t,r+1)):t[e.s]=r},O5=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new Ga(++t),n=0,a=e[0],i=1,s=function(c){r[n++]=c},o=1;o<=t;++o)if(e[o]==a&&o!=t)++i;else{if(!a&&i>2){for(;i>138;i-=138)s(32754);i>2&&(s(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(s(a),--i;i>6;i-=6)s(8304);i>2&&(s(i-3<<5|8208),i=0)}for(;i--;)s(a);i=1,a=e[o]}return{c:r.subarray(0,n),n:t}},af=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},bE=function(e,t,r){var n=r.length,a=yE(t+2);e[a]=n&255,e[a+1]=n>>8,e[a+2]=e[a]^255,e[a+3]=e[a+1]^255;for(var i=0;i<n;++i)e[a+i+4]=r[i];return(a+4+n)*8},L5=function(e,t,r,n,a,i,s,o,c,u,f){Ss(t,f++,r),++a[256];for(var d=c1(a,15),p=d.t,h=d.l,x=c1(i,15),g=x.t,y=x.l,b=O5(p),E=b.c,A=b.n,C=O5(g),N=C.c,F=C.n,O=new Ga(19),I=0;I<E.length;++I)++O[E[I]&31];for(var I=0;I<N.length;++I)++O[N[I]&31];for(var P=c1(O,7),H=P.t,T=P.l,j=19;j>4&&!H[k5[j-1]];--j);var z=u+5<<3,K=af(a,Bl)+af(i,Ch)+s,he=af(a,p)+af(i,g)+s+14+3*j+af(O,H)+2*O[16]+3*O[17]+7*O[18];if(c>=0&&z<=K&&z<=he)return bE(t,f,e.subarray(c,c+u));var be,we,Q,le;if(Ss(t,f,1+(he<K)),f+=2,he<K){be=wf(p,h,0),we=p,Q=wf(g,y,0),le=g;var ke=wf(H,T,0);Ss(t,f,A-257),Ss(t,f+5,F-1),Ss(t,f+10,j-4),f+=14;for(var I=0;I<j;++I)Ss(t,f+3*I,H[k5[I]]);f+=3*j;for(var ve=[E,N],S=0;S<2;++S)for(var L=ve[S],I=0;I<L.length;++I){var D=L[I]&31;Ss(t,f,ke[D]),f+=H[D],D>15&&(Ss(t,f,L[I]>>5&127),f+=L[I]>>12)}}else be=oK,we=Bl,Q=lK,le=Ch;for(var I=0;I<o;++I){var R=n[I];if(R>255){var D=R>>18&31;nf(t,f,be[D+257]),f+=we[D+257],D>7&&(Ss(t,f,R>>23&31),f+=l2[D]);var X=R&31;nf(t,f,Q[X]),f+=le[X],X>3&&(nf(t,f,R>>5&8191),f+=c2[X])}else nf(t,f,be[R]),f+=we[R]}return nf(t,f,be[256]),f+we[256]},uK=new o2([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),wE=new Ri(0),fK=function(e,t,r,n,a,i){var s=i.z||e.length,o=new Ri(n+s+5*(1+Math.ceil(s/7e3))+a),c=o.subarray(n,o.length-a),u=i.l,f=(i.r||0)&7;if(t){f&&(c[0]=i.r>>3);for(var d=uK[t-1],p=d>>13,h=d&8191,x=(1<<r)-1,g=i.p||new Ga(32768),y=i.h||new Ga(x+1),b=Math.ceil(r/3),E=2*b,A=function(xe){return(e[xe]^e[xe+1]<<b^e[xe+2]<<E)&x},C=new o2(25e3),N=new Ga(288),F=new Ga(32),O=0,I=0,P=i.i||0,H=0,T=i.w||0,j=0;P+2<s;++P){var z=A(P),K=P&32767,he=y[z];if(g[K]=he,y[z]=K,T<=P){var be=s-P;if((O>7e3||H>24576)&&(be>423||!u)){f=L5(e,c,0,C,N,F,I,H,j,P-j,f),H=O=I=0,j=P;for(var we=0;we<286;++we)N[we]=0;for(var we=0;we<30;++we)F[we]=0}var Q=2,le=0,ke=h,ve=K-he&32767;if(be>2&&z==A(P-ve))for(var S=Math.min(p,be)-1,L=Math.min(32767,P),D=Math.min(258,be);ve<=L&&--ke&&K!=he;){if(e[P+Q]==e[P+Q-ve]){for(var R=0;R<D&&e[P+R]==e[P+R-ve];++R);if(R>Q){if(Q=R,le=ve,R>S)break;for(var X=Math.min(ve,R-2),de=0,we=0;we<X;++we){var me=P-ve+we&32767,Y=g[me],oe=me-Y&32767;oe>de&&(de=oe,he=me)}}}K=he,he=g[K],ve+=K-he&32767}if(le){C[H++]=268435456|Og[Q]<<18|C5[le];var ue=Og[Q]&31,fe=C5[le]&31;I+=l2[ue]+c2[fe],++N[257+ue],++F[fe],T=P+Q,++O}else C[H++]=e[P],++N[e[P]]}}for(P=Math.max(P,T);P<s;++P)C[H++]=e[P],++N[e[P]];f=L5(e,c,u,C,N,F,I,H,j,P-j,f),u||(i.r=f&7|c[f/8|0]<<3,f-=7,i.h=y,i.p=g,i.i=P,i.w=T)}else{for(var P=i.w||0;P<s+u;P+=65535){var Ue=P+65535;Ue>=s&&(c[f/8|0]=u,Ue=s),f=bE(c,f+1,e.subarray(P,Ue))}i.i=s}return cK(o,0,n+yE(f)+a)},_E=function(){var e=1,t=0;return{p:function(r){for(var n=e,a=t,i=r.length|0,s=0;s!=i;){for(var o=Math.min(s+2655,i);s<o;++s)a+=n+=r[s];n=(n&65535)+15*(n>>16),a=(a&65535)+15*(a>>16)}e=n,t=a},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},dK=function(e,t,r,n,a){if(!a&&(a={l:1},t.dictionary)){var i=t.dictionary.subarray(-32768),s=new Ri(i.length+e.length);s.set(i),s.set(e,i.length),e=s,a.w=i.length}return fK(e,t.level==null?6:t.level,t.mem==null?a.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,a)},NE=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},hK=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var a=_E();a.p(t.dictionary),NE(e,2,a.d())}};function Dg(e,t){t||(t={});var r=_E();r.p(e);var n=dK(e,t,t.dictionary?6:2,4);return hK(n,t),NE(n,n.length-4,r.d()),n}var pK=typeof TextDecoder<"u"&&new TextDecoder,mK=0;try{pK.decode(wE,{stream:!0}),mK=1}catch{}function gK(e){if(Array.isArray(e))return e}function xK(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,i,s,o=[],c=!0,u=!1;try{if(i=(r=r.call(e)).next,t!==0)for(;!(c=(n=i.call(r)).done)&&(o.push(n.value),o.length!==t);c=!0);}catch(f){u=!0,a=f}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(u)throw a}}return o}}function F5(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function vK(e,t){if(e){if(typeof e=="string")return F5(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?F5(e,t):void 0}}function yK(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function D5(e,t){return gK(e)||xK(e,t)||vK(e,t)||yK()}function I5(e,t="utf8"){return new TextDecoder(t).decode(e)}const bK=new TextEncoder;function wK(e){return bK.encode(e)}const _K=1024*8,NK=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),u1={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class u2{constructor(t=_K,r={}){rr(this,"buffer");rr(this,"byteLength");rr(this,"byteOffset");rr(this,"length");rr(this,"offset");rr(this,"lastWrittenByte");rr(this,"littleEndian");rr(this,"_data");rr(this,"_mark");rr(this,"_marks");let n=!1;typeof t=="number"?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const a=r.offset?r.offset>>>0:0,i=t.byteLength-a;let s=a;(ArrayBuffer.isView(t)||t instanceof u2)&&(t.byteLength!==t.buffer.byteLength&&(s=t.byteOffset+a),t=t.buffer),n?this.lastWrittenByte=i:this.lastWrittenByte=0,this.buffer=t,this.length=i,this.byteLength=i,this.byteOffset=s,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,s,i),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const n=(this.offset+t)*2,a=new Uint8Array(n);a.set(new Uint8Array(this.buffer)),this.buffer=a.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const n=u1[r].BYTES_PER_ELEMENT*t,a=this.byteOffset+this.offset,i=this.buffer.slice(a,a+n);if(this.littleEndian===NK&&r!=="uint8"&&r!=="int8"){const o=new Uint8Array(this.buffer.slice(a,a+n));o.reverse();const c=new u1[r](o.buffer);return this.offset+=n,c.reverse(),c}const s=new u1[r](i);return this.offset+=n,s}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let n=0;n<t;n++)r+=this.readChar();return r}readUtf8(t=1){return I5(this.readBytes(t))}decodeText(t=1,r="utf8"){return I5(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(wK(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const SK=4,M5=0,R5=1,AK=2;function yu(e){let t=e.length;for(;--t>=0;)e[t]=0}const EK=0,SE=1,jK=2,TK=3,PK=258,f2=29,y0=256,Wf=y0+1+f2,Mc=30,d2=19,AE=2*Wf+1,xl=15,f1=16,kK=7,h2=256,EE=16,jE=17,TE=18,Ig=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),jd=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),CK=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),PE=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),OK=512,Es=new Array((Wf+2)*2);yu(Es);const _f=new Array(Mc*2);yu(_f);const Hf=new Array(OK);yu(Hf);const Gf=new Array(PK-TK+1);yu(Gf);const p2=new Array(f2);yu(p2);const Oh=new Array(Mc);yu(Oh);function d1(e,t,r,n,a){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=a,this.has_stree=e&&e.length}let kE,CE,OE;function h1(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}const LE=e=>e<256?Hf[e]:Hf[256+(e>>>7)],Vf=(e,t)=>{e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255},Sa=(e,t,r)=>{e.bi_valid>f1-r?(e.bi_buf|=t<<e.bi_valid&65535,Vf(e,e.bi_buf),e.bi_buf=t>>f1-e.bi_valid,e.bi_valid+=r-f1):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},rs=(e,t,r)=>{Sa(e,r[t*2],r[t*2+1])},FE=(e,t)=>{let r=0;do r|=e&1,e>>>=1,r<<=1;while(--t>0);return r>>>1},LK=e=>{e.bi_valid===16?(Vf(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},FK=(e,t)=>{const r=t.dyn_tree,n=t.max_code,a=t.stat_desc.static_tree,i=t.stat_desc.has_stree,s=t.stat_desc.extra_bits,o=t.stat_desc.extra_base,c=t.stat_desc.max_length;let u,f,d,p,h,x,g=0;for(p=0;p<=xl;p++)e.bl_count[p]=0;for(r[e.heap[e.heap_max]*2+1]=0,u=e.heap_max+1;u<AE;u++)f=e.heap[u],p=r[r[f*2+1]*2+1]+1,p>c&&(p=c,g++),r[f*2+1]=p,!(f>n)&&(e.bl_count[p]++,h=0,f>=o&&(h=s[f-o]),x=r[f*2],e.opt_len+=x*(p+h),i&&(e.static_len+=x*(a[f*2+1]+h)));if(g!==0){do{for(p=c-1;e.bl_count[p]===0;)p--;e.bl_count[p]--,e.bl_count[p+1]+=2,e.bl_count[c]--,g-=2}while(g>0);for(p=c;p!==0;p--)for(f=e.bl_count[p];f!==0;)d=e.heap[--u],!(d>n)&&(r[d*2+1]!==p&&(e.opt_len+=(p-r[d*2+1])*r[d*2],r[d*2+1]=p),f--)}},DE=(e,t,r)=>{const n=new Array(xl+1);let a=0,i,s;for(i=1;i<=xl;i++)a=a+r[i-1]<<1,n[i]=a;for(s=0;s<=t;s++){let o=e[s*2+1];o!==0&&(e[s*2]=FE(n[o]++,o))}},DK=()=>{let e,t,r,n,a;const i=new Array(xl+1);for(r=0,n=0;n<f2-1;n++)for(p2[n]=r,e=0;e<1<<Ig[n];e++)Gf[r++]=n;for(Gf[r-1]=n,a=0,n=0;n<16;n++)for(Oh[n]=a,e=0;e<1<<jd[n];e++)Hf[a++]=n;for(a>>=7;n<Mc;n++)for(Oh[n]=a<<7,e=0;e<1<<jd[n]-7;e++)Hf[256+a++]=n;for(t=0;t<=xl;t++)i[t]=0;for(e=0;e<=143;)Es[e*2+1]=8,e++,i[8]++;for(;e<=255;)Es[e*2+1]=9,e++,i[9]++;for(;e<=279;)Es[e*2+1]=7,e++,i[7]++;for(;e<=287;)Es[e*2+1]=8,e++,i[8]++;for(DE(Es,Wf+1,i),e=0;e<Mc;e++)_f[e*2+1]=5,_f[e*2]=FE(e,5);kE=new d1(Es,Ig,y0+1,Wf,xl),CE=new d1(_f,jd,0,Mc,xl),OE=new d1(new Array(0),CK,0,d2,kK)},IE=e=>{let t;for(t=0;t<Wf;t++)e.dyn_ltree[t*2]=0;for(t=0;t<Mc;t++)e.dyn_dtree[t*2]=0;for(t=0;t<d2;t++)e.bl_tree[t*2]=0;e.dyn_ltree[h2*2]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},ME=e=>{e.bi_valid>8?Vf(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},B5=(e,t,r,n)=>{const a=t*2,i=r*2;return e[a]<e[i]||e[a]===e[i]&&n[t]<=n[r]},p1=(e,t,r)=>{const n=e.heap[r];let a=r<<1;for(;a<=e.heap_len&&(a<e.heap_len&&B5(t,e.heap[a+1],e.heap[a],e.depth)&&a++,!B5(t,n,e.heap[a],e.depth));)e.heap[r]=e.heap[a],r=a,a<<=1;e.heap[r]=n},U5=(e,t,r)=>{let n,a,i=0,s,o;if(e.sym_next!==0)do n=e.pending_buf[e.sym_buf+i++]&255,n+=(e.pending_buf[e.sym_buf+i++]&255)<<8,a=e.pending_buf[e.sym_buf+i++],n===0?rs(e,a,t):(s=Gf[a],rs(e,s+y0+1,t),o=Ig[s],o!==0&&(a-=p2[s],Sa(e,a,o)),n--,s=LE(n),rs(e,s,r),o=jd[s],o!==0&&(n-=Oh[s],Sa(e,n,o)));while(i<e.sym_next);rs(e,h2,t)},Mg=(e,t)=>{const r=t.dyn_tree,n=t.stat_desc.static_tree,a=t.stat_desc.has_stree,i=t.stat_desc.elems;let s,o,c=-1,u;for(e.heap_len=0,e.heap_max=AE,s=0;s<i;s++)r[s*2]!==0?(e.heap[++e.heap_len]=c=s,e.depth[s]=0):r[s*2+1]=0;for(;e.heap_len<2;)u=e.heap[++e.heap_len]=c<2?++c:0,r[u*2]=1,e.depth[u]=0,e.opt_len--,a&&(e.static_len-=n[u*2+1]);for(t.max_code=c,s=e.heap_len>>1;s>=1;s--)p1(e,r,s);u=i;do s=e.heap[1],e.heap[1]=e.heap[e.heap_len--],p1(e,r,1),o=e.heap[1],e.heap[--e.heap_max]=s,e.heap[--e.heap_max]=o,r[u*2]=r[s*2]+r[o*2],e.depth[u]=(e.depth[s]>=e.depth[o]?e.depth[s]:e.depth[o])+1,r[s*2+1]=r[o*2+1]=u,e.heap[1]=u++,p1(e,r,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],FK(e,t),DE(r,c,e.bl_count)},$5=(e,t,r)=>{let n,a=-1,i,s=t[0*2+1],o=0,c=7,u=4;for(s===0&&(c=138,u=3),t[(r+1)*2+1]=65535,n=0;n<=r;n++)i=s,s=t[(n+1)*2+1],!(++o<c&&i===s)&&(o<u?e.bl_tree[i*2]+=o:i!==0?(i!==a&&e.bl_tree[i*2]++,e.bl_tree[EE*2]++):o<=10?e.bl_tree[jE*2]++:e.bl_tree[TE*2]++,o=0,a=i,s===0?(c=138,u=3):i===s?(c=6,u=3):(c=7,u=4))},z5=(e,t,r)=>{let n,a=-1,i,s=t[0*2+1],o=0,c=7,u=4;for(s===0&&(c=138,u=3),n=0;n<=r;n++)if(i=s,s=t[(n+1)*2+1],!(++o<c&&i===s)){if(o<u)do rs(e,i,e.bl_tree);while(--o!==0);else i!==0?(i!==a&&(rs(e,i,e.bl_tree),o--),rs(e,EE,e.bl_tree),Sa(e,o-3,2)):o<=10?(rs(e,jE,e.bl_tree),Sa(e,o-3,3)):(rs(e,TE,e.bl_tree),Sa(e,o-11,7));o=0,a=i,s===0?(c=138,u=3):i===s?(c=6,u=3):(c=7,u=4)}},IK=e=>{let t;for($5(e,e.dyn_ltree,e.l_desc.max_code),$5(e,e.dyn_dtree,e.d_desc.max_code),Mg(e,e.bl_desc),t=d2-1;t>=3&&e.bl_tree[PE[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t},MK=(e,t,r,n)=>{let a;for(Sa(e,t-257,5),Sa(e,r-1,5),Sa(e,n-4,4),a=0;a<n;a++)Sa(e,e.bl_tree[PE[a]*2+1],3);z5(e,e.dyn_ltree,t-1),z5(e,e.dyn_dtree,r-1)},RK=e=>{let t=4093624447,r;for(r=0;r<=31;r++,t>>>=1)if(t&1&&e.dyn_ltree[r*2]!==0)return M5;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return R5;for(r=32;r<y0;r++)if(e.dyn_ltree[r*2]!==0)return R5;return M5};let q5=!1;const BK=e=>{q5||(DK(),q5=!0),e.l_desc=new h1(e.dyn_ltree,kE),e.d_desc=new h1(e.dyn_dtree,CE),e.bl_desc=new h1(e.bl_tree,OE),e.bi_buf=0,e.bi_valid=0,IE(e)},RE=(e,t,r,n)=>{Sa(e,(EK<<1)+(n?1:0),3),ME(e),Vf(e,r),Vf(e,~r),r&&e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r},UK=e=>{Sa(e,SE<<1,3),rs(e,h2,Es),LK(e)},$K=(e,t,r,n)=>{let a,i,s=0;e.level>0?(e.strm.data_type===AK&&(e.strm.data_type=RK(e)),Mg(e,e.l_desc),Mg(e,e.d_desc),s=IK(e),a=e.opt_len+3+7>>>3,i=e.static_len+3+7>>>3,i<=a&&(a=i)):a=i=r+5,r+4<=a&&t!==-1?RE(e,t,r,n):e.strategy===SK||i===a?(Sa(e,(SE<<1)+(n?1:0),3),U5(e,Es,_f)):(Sa(e,(jK<<1)+(n?1:0),3),MK(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),U5(e,e.dyn_ltree,e.dyn_dtree)),IE(e),n&&ME(e)},zK=(e,t,r)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=r,t===0?e.dyn_ltree[r*2]++:(e.matches++,t--,e.dyn_ltree[(Gf[r]+y0+1)*2]++,e.dyn_dtree[LE(t)*2]++),e.sym_next===e.sym_end);var qK=BK,WK=RE,HK=$K,GK=zK,VK=UK,KK={_tr_init:qK,_tr_stored_block:WK,_tr_flush_block:HK,_tr_tally:GK,_tr_align:VK};const YK=(e,t,r,n)=>{let a=e&65535|0,i=e>>>16&65535|0,s=0;for(;r!==0;){s=r>2e3?2e3:r,r-=s;do a=a+t[n++]|0,i=i+a|0;while(--s);a%=65521,i%=65521}return a|i<<16|0};var Kf=YK;const XK=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},ZK=new Uint32Array(XK()),JK=(e,t,r,n)=>{const a=ZK,i=n+r;e^=-1;for(let s=n;s<i;s++)e=e>>>8^a[(e^t[s])&255];return e^-1};var Nn=JK,tu={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},b0={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:QK,_tr_stored_block:Rg,_tr_flush_block:eY,_tr_tally:Co,_tr_align:tY}=KK,{Z_NO_FLUSH:Oo,Z_PARTIAL_FLUSH:rY,Z_FULL_FLUSH:nY,Z_FINISH:fi,Z_BLOCK:W5,Z_OK:Bn,Z_STREAM_END:H5,Z_STREAM_ERROR:ls,Z_DATA_ERROR:aY,Z_BUF_ERROR:m1,Z_DEFAULT_COMPRESSION:iY,Z_FILTERED:sY,Z_HUFFMAN_ONLY:pd,Z_RLE:oY,Z_FIXED:lY,Z_DEFAULT_STRATEGY:cY,Z_UNKNOWN:uY,Z_DEFLATED:Up}=b0,fY=9,dY=15,hY=8,pY=29,mY=256,Bg=mY+1+pY,gY=30,xY=19,vY=2*Bg+1,yY=15,Gt=3,Eo=258,cs=Eo+Gt+1,bY=32,ru=42,m2=57,Ug=69,$g=73,zg=91,qg=103,vl=113,ff=666,pa=1,bu=2,Ul=3,wu=4,wY=3,yl=(e,t)=>(e.msg=tu[t],t),G5=e=>e*2-(e>4?9:0),wo=e=>{let t=e.length;for(;--t>=0;)e[t]=0},_Y=e=>{let t,r,n,a=e.w_size;t=e.hash_size,n=t;do r=e.head[--n],e.head[n]=r>=a?r-a:0;while(--t);t=a,n=t;do r=e.prev[--n],e.prev[n]=r>=a?r-a:0;while(--t)};let NY=(e,t,r)=>(t<<e.hash_shift^r)&e.hash_mask,Lo=NY;const Ra=e=>{const t=e.state;let r=t.pending;r>e.avail_out&&(r=e.avail_out),r!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,t.pending===0&&(t.pending_out=0))},Va=(e,t)=>{eY(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,Ra(e.strm)},nr=(e,t)=>{e.pending_buf[e.pending++]=t},sf=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255},Wg=(e,t,r,n)=>{let a=e.avail_in;return a>n&&(a=n),a===0?0:(e.avail_in-=a,t.set(e.input.subarray(e.next_in,e.next_in+a),r),e.state.wrap===1?e.adler=Kf(e.adler,t,a,r):e.state.wrap===2&&(e.adler=Nn(e.adler,t,a,r)),e.next_in+=a,e.total_in+=a,a)},BE=(e,t)=>{let r=e.max_chain_length,n=e.strstart,a,i,s=e.prev_length,o=e.nice_match;const c=e.strstart>e.w_size-cs?e.strstart-(e.w_size-cs):0,u=e.window,f=e.w_mask,d=e.prev,p=e.strstart+Eo;let h=u[n+s-1],x=u[n+s];e.prev_length>=e.good_match&&(r>>=2),o>e.lookahead&&(o=e.lookahead);do if(a=t,!(u[a+s]!==x||u[a+s-1]!==h||u[a]!==u[n]||u[++a]!==u[n+1])){n+=2,a++;do;while(u[++n]===u[++a]&&u[++n]===u[++a]&&u[++n]===u[++a]&&u[++n]===u[++a]&&u[++n]===u[++a]&&u[++n]===u[++a]&&u[++n]===u[++a]&&u[++n]===u[++a]&&n<p);if(i=Eo-(p-n),n=p-Eo,i>s){if(e.match_start=t,s=i,i>=o)break;h=u[n+s-1],x=u[n+s]}}while((t=d[t&f])>c&&--r!==0);return s<=e.lookahead?s:e.lookahead},nu=e=>{const t=e.w_size;let r,n,a;do{if(n=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-cs)&&(e.window.set(e.window.subarray(t,t+t-n),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),_Y(e),n+=t),e.strm.avail_in===0)break;if(r=Wg(e.strm,e.window,e.strstart+e.lookahead,n),e.lookahead+=r,e.lookahead+e.insert>=Gt)for(a=e.strstart-e.insert,e.ins_h=e.window[a],e.ins_h=Lo(e,e.ins_h,e.window[a+1]);e.insert&&(e.ins_h=Lo(e,e.ins_h,e.window[a+Gt-1]),e.prev[a&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=a,a++,e.insert--,!(e.lookahead+e.insert<Gt)););}while(e.lookahead<cs&&e.strm.avail_in!==0)},UE=(e,t)=>{let r=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,n,a,i,s=0,o=e.strm.avail_in;do{if(n=65535,i=e.bi_valid+42>>3,e.strm.avail_out<i||(i=e.strm.avail_out-i,a=e.strstart-e.block_start,n>a+e.strm.avail_in&&(n=a+e.strm.avail_in),n>i&&(n=i),n<r&&(n===0&&t!==fi||t===Oo||n!==a+e.strm.avail_in)))break;s=t===fi&&n===a+e.strm.avail_in?1:0,Rg(e,0,0,s),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,Ra(e.strm),a&&(a>n&&(a=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+a),e.strm.next_out),e.strm.next_out+=a,e.strm.avail_out-=a,e.strm.total_out+=a,e.block_start+=a,n-=a),n&&(Wg(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(s===0);return o-=e.strm.avail_in,o&&(o>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=o&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-o,e.strm.next_in),e.strstart),e.strstart+=o,e.insert+=o>e.w_size-e.insert?e.w_size-e.insert:o),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),s?wu:t!==Oo&&t!==fi&&e.strm.avail_in===0&&e.strstart===e.block_start?bu:(i=e.window_size-e.strstart,e.strm.avail_in>i&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,i+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),i>e.strm.avail_in&&(i=e.strm.avail_in),i&&(Wg(e.strm,e.window,e.strstart,i),e.strstart+=i,e.insert+=i>e.w_size-e.insert?e.w_size-e.insert:i),e.high_water<e.strstart&&(e.high_water=e.strstart),i=e.bi_valid+42>>3,i=e.pending_buf_size-i>65535?65535:e.pending_buf_size-i,r=i>e.w_size?e.w_size:i,a=e.strstart-e.block_start,(a>=r||(a||t===fi)&&t!==Oo&&e.strm.avail_in===0&&a<=i)&&(n=a>i?i:a,s=t===fi&&e.strm.avail_in===0&&n===a?1:0,Rg(e,e.block_start,n,s),e.block_start+=n,Ra(e.strm)),s?Ul:pa)},g1=(e,t)=>{let r,n;for(;;){if(e.lookahead<cs){if(nu(e),e.lookahead<cs&&t===Oo)return pa;if(e.lookahead===0)break}if(r=0,e.lookahead>=Gt&&(e.ins_h=Lo(e,e.ins_h,e.window[e.strstart+Gt-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),r!==0&&e.strstart-r<=e.w_size-cs&&(e.match_length=BE(e,r)),e.match_length>=Gt)if(n=Co(e,e.strstart-e.match_start,e.match_length-Gt),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=Gt){e.match_length--;do e.strstart++,e.ins_h=Lo(e,e.ins_h,e.window[e.strstart+Gt-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=Lo(e,e.ins_h,e.window[e.strstart+1]);else n=Co(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(Va(e,!1),e.strm.avail_out===0))return pa}return e.insert=e.strstart<Gt-1?e.strstart:Gt-1,t===fi?(Va(e,!0),e.strm.avail_out===0?Ul:wu):e.sym_next&&(Va(e,!1),e.strm.avail_out===0)?pa:bu},gc=(e,t)=>{let r,n,a;for(;;){if(e.lookahead<cs){if(nu(e),e.lookahead<cs&&t===Oo)return pa;if(e.lookahead===0)break}if(r=0,e.lookahead>=Gt&&(e.ins_h=Lo(e,e.ins_h,e.window[e.strstart+Gt-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=Gt-1,r!==0&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-cs&&(e.match_length=BE(e,r),e.match_length<=5&&(e.strategy===sY||e.match_length===Gt&&e.strstart-e.match_start>4096)&&(e.match_length=Gt-1)),e.prev_length>=Gt&&e.match_length<=e.prev_length){a=e.strstart+e.lookahead-Gt,n=Co(e,e.strstart-1-e.prev_match,e.prev_length-Gt),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=a&&(e.ins_h=Lo(e,e.ins_h,e.window[e.strstart+Gt-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=Gt-1,e.strstart++,n&&(Va(e,!1),e.strm.avail_out===0))return pa}else if(e.match_available){if(n=Co(e,0,e.window[e.strstart-1]),n&&Va(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return pa}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=Co(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<Gt-1?e.strstart:Gt-1,t===fi?(Va(e,!0),e.strm.avail_out===0?Ul:wu):e.sym_next&&(Va(e,!1),e.strm.avail_out===0)?pa:bu},SY=(e,t)=>{let r,n,a,i;const s=e.window;for(;;){if(e.lookahead<=Eo){if(nu(e),e.lookahead<=Eo&&t===Oo)return pa;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=Gt&&e.strstart>0&&(a=e.strstart-1,n=s[a],n===s[++a]&&n===s[++a]&&n===s[++a])){i=e.strstart+Eo;do;while(n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&n===s[++a]&&a<i);e.match_length=Eo-(i-a),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=Gt?(r=Co(e,1,e.match_length-Gt),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=Co(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(Va(e,!1),e.strm.avail_out===0))return pa}return e.insert=0,t===fi?(Va(e,!0),e.strm.avail_out===0?Ul:wu):e.sym_next&&(Va(e,!1),e.strm.avail_out===0)?pa:bu},AY=(e,t)=>{let r;for(;;){if(e.lookahead===0&&(nu(e),e.lookahead===0)){if(t===Oo)return pa;break}if(e.match_length=0,r=Co(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(Va(e,!1),e.strm.avail_out===0))return pa}return e.insert=0,t===fi?(Va(e,!0),e.strm.avail_out===0?Ul:wu):e.sym_next&&(Va(e,!1),e.strm.avail_out===0)?pa:bu};function Zi(e,t,r,n,a){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=a}const df=[new Zi(0,0,0,0,UE),new Zi(4,4,8,4,g1),new Zi(4,5,16,8,g1),new Zi(4,6,32,32,g1),new Zi(4,4,16,16,gc),new Zi(8,16,32,32,gc),new Zi(8,16,128,128,gc),new Zi(8,32,128,256,gc),new Zi(32,128,258,1024,gc),new Zi(32,258,258,4096,gc)],EY=e=>{e.window_size=2*e.w_size,wo(e.head),e.max_lazy_match=df[e.level].max_lazy,e.good_match=df[e.level].good_length,e.nice_match=df[e.level].nice_length,e.max_chain_length=df[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=Gt-1,e.match_available=0,e.ins_h=0};function jY(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Up,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(vY*2),this.dyn_dtree=new Uint16Array((2*gY+1)*2),this.bl_tree=new Uint16Array((2*xY+1)*2),wo(this.dyn_ltree),wo(this.dyn_dtree),wo(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(yY+1),this.heap=new Uint16Array(2*Bg+1),wo(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Bg+1),wo(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const w0=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==ru&&t.status!==m2&&t.status!==Ug&&t.status!==$g&&t.status!==zg&&t.status!==qg&&t.status!==vl&&t.status!==ff?1:0},$E=e=>{if(w0(e))return yl(e,ls);e.total_in=e.total_out=0,e.data_type=uY;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap===2?m2:t.wrap?ru:vl,e.adler=t.wrap===2?0:1,t.last_flush=-2,QK(t),Bn},zE=e=>{const t=$E(e);return t===Bn&&EY(e.state),t},TY=(e,t)=>w0(e)||e.state.wrap!==2?ls:(e.state.gzhead=t,Bn),qE=(e,t,r,n,a,i)=>{if(!e)return ls;let s=1;if(t===iY&&(t=6),n<0?(s=0,n=-n):n>15&&(s=2,n-=16),a<1||a>fY||r!==Up||n<8||n>15||t<0||t>9||i<0||i>lY||n===8&&s!==1)return yl(e,ls);n===8&&(n=9);const o=new jY;return e.state=o,o.strm=e,o.status=ru,o.wrap=s,o.gzhead=null,o.w_bits=n,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=a+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+Gt-1)/Gt),o.window=new Uint8Array(o.w_size*2),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<a+6,o.pending_buf_size=o.lit_bufsize*4,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=(o.lit_bufsize-1)*3,o.level=t,o.strategy=i,o.method=r,zE(e)},PY=(e,t)=>qE(e,t,Up,dY,hY,cY),kY=(e,t)=>{if(w0(e)||t>W5||t<0)return e?yl(e,ls):ls;const r=e.state;if(!e.output||e.avail_in!==0&&!e.input||r.status===ff&&t!==fi)return yl(e,e.avail_out===0?m1:ls);const n=r.last_flush;if(r.last_flush=t,r.pending!==0){if(Ra(e),e.avail_out===0)return r.last_flush=-1,Bn}else if(e.avail_in===0&&G5(t)<=G5(n)&&t!==fi)return yl(e,m1);if(r.status===ff&&e.avail_in!==0)return yl(e,m1);if(r.status===ru&&r.wrap===0&&(r.status=vl),r.status===ru){let a=Up+(r.w_bits-8<<4)<<8,i=-1;if(r.strategy>=pd||r.level<2?i=0:r.level<6?i=1:r.level===6?i=2:i=3,a|=i<<6,r.strstart!==0&&(a|=bY),a+=31-a%31,sf(r,a),r.strstart!==0&&(sf(r,e.adler>>>16),sf(r,e.adler&65535)),e.adler=1,r.status=vl,Ra(e),r.pending!==0)return r.last_flush=-1,Bn}if(r.status===m2){if(e.adler=0,nr(r,31),nr(r,139),nr(r,8),r.gzhead)nr(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),nr(r,r.gzhead.time&255),nr(r,r.gzhead.time>>8&255),nr(r,r.gzhead.time>>16&255),nr(r,r.gzhead.time>>24&255),nr(r,r.level===9?2:r.strategy>=pd||r.level<2?4:0),nr(r,r.gzhead.os&255),r.gzhead.extra&&r.gzhead.extra.length&&(nr(r,r.gzhead.extra.length&255),nr(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=Nn(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=Ug;else if(nr(r,0),nr(r,0),nr(r,0),nr(r,0),nr(r,0),nr(r,r.level===9?2:r.strategy>=pd||r.level<2?4:0),nr(r,wY),r.status=vl,Ra(e),r.pending!==0)return r.last_flush=-1,Bn}if(r.status===Ug){if(r.gzhead.extra){let a=r.pending,i=(r.gzhead.extra.length&65535)-r.gzindex;for(;r.pending+i>r.pending_buf_size;){let o=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+o),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>a&&(e.adler=Nn(e.adler,r.pending_buf,r.pending-a,a)),r.gzindex+=o,Ra(e),r.pending!==0)return r.last_flush=-1,Bn;a=0,i-=o}let s=new Uint8Array(r.gzhead.extra);r.pending_buf.set(s.subarray(r.gzindex,r.gzindex+i),r.pending),r.pending+=i,r.gzhead.hcrc&&r.pending>a&&(e.adler=Nn(e.adler,r.pending_buf,r.pending-a,a)),r.gzindex=0}r.status=$g}if(r.status===$g){if(r.gzhead.name){let a=r.pending,i;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>a&&(e.adler=Nn(e.adler,r.pending_buf,r.pending-a,a)),Ra(e),r.pending!==0)return r.last_flush=-1,Bn;a=0}r.gzindex<r.gzhead.name.length?i=r.gzhead.name.charCodeAt(r.gzindex++)&255:i=0,nr(r,i)}while(i!==0);r.gzhead.hcrc&&r.pending>a&&(e.adler=Nn(e.adler,r.pending_buf,r.pending-a,a)),r.gzindex=0}r.status=zg}if(r.status===zg){if(r.gzhead.comment){let a=r.pending,i;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>a&&(e.adler=Nn(e.adler,r.pending_buf,r.pending-a,a)),Ra(e),r.pending!==0)return r.last_flush=-1,Bn;a=0}r.gzindex<r.gzhead.comment.length?i=r.gzhead.comment.charCodeAt(r.gzindex++)&255:i=0,nr(r,i)}while(i!==0);r.gzhead.hcrc&&r.pending>a&&(e.adler=Nn(e.adler,r.pending_buf,r.pending-a,a))}r.status=qg}if(r.status===qg){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(Ra(e),r.pending!==0))return r.last_flush=-1,Bn;nr(r,e.adler&255),nr(r,e.adler>>8&255),e.adler=0}if(r.status=vl,Ra(e),r.pending!==0)return r.last_flush=-1,Bn}if(e.avail_in!==0||r.lookahead!==0||t!==Oo&&r.status!==ff){let a=r.level===0?UE(r,t):r.strategy===pd?AY(r,t):r.strategy===oY?SY(r,t):df[r.level].func(r,t);if((a===Ul||a===wu)&&(r.status=ff),a===pa||a===Ul)return e.avail_out===0&&(r.last_flush=-1),Bn;if(a===bu&&(t===rY?tY(r):t!==W5&&(Rg(r,0,0,!1),t===nY&&(wo(r.head),r.lookahead===0&&(r.strstart=0,r.block_start=0,r.insert=0))),Ra(e),e.avail_out===0))return r.last_flush=-1,Bn}return t!==fi?Bn:r.wrap<=0?H5:(r.wrap===2?(nr(r,e.adler&255),nr(r,e.adler>>8&255),nr(r,e.adler>>16&255),nr(r,e.adler>>24&255),nr(r,e.total_in&255),nr(r,e.total_in>>8&255),nr(r,e.total_in>>16&255),nr(r,e.total_in>>24&255)):(sf(r,e.adler>>>16),sf(r,e.adler&65535)),Ra(e),r.wrap>0&&(r.wrap=-r.wrap),r.pending!==0?Bn:H5)},CY=e=>{if(w0(e))return ls;const t=e.state.status;return e.state=null,t===vl?yl(e,aY):Bn},OY=(e,t)=>{let r=t.length;if(w0(e))return ls;const n=e.state,a=n.wrap;if(a===2||a===1&&n.status!==ru||n.lookahead)return ls;if(a===1&&(e.adler=Kf(e.adler,t,r,0)),n.wrap=0,r>=n.w_size){a===0&&(wo(n.head),n.strstart=0,n.block_start=0,n.insert=0);let c=new Uint8Array(n.w_size);c.set(t.subarray(r-n.w_size,r),0),t=c,r=n.w_size}const i=e.avail_in,s=e.next_in,o=e.input;for(e.avail_in=r,e.next_in=0,e.input=t,nu(n);n.lookahead>=Gt;){let c=n.strstart,u=n.lookahead-(Gt-1);do n.ins_h=Lo(n,n.ins_h,n.window[c+Gt-1]),n.prev[c&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=c,c++;while(--u);n.strstart=c,n.lookahead=Gt-1,nu(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=Gt-1,n.match_available=0,e.next_in=s,e.input=o,e.avail_in=i,n.wrap=a,Bn};var LY=PY,FY=qE,DY=zE,IY=$E,MY=TY,RY=kY,BY=CY,UY=OY,$Y="pako deflate (from Nodeca project)",Nf={deflateInit:LY,deflateInit2:FY,deflateReset:DY,deflateResetKeep:IY,deflateSetHeader:MY,deflate:RY,deflateEnd:BY,deflateSetDictionary:UY,deflateInfo:$Y};const zY=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var qY=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)zY(r,n)&&(e[n]=r[n])}}return e},WY=e=>{let t=0;for(let n=0,a=e.length;n<a;n++)t+=e[n].length;const r=new Uint8Array(t);for(let n=0,a=0,i=e.length;n<i;n++){let s=e[n];r.set(s,a),a+=s.length}return r},$p={assign:qY,flattenChunks:WY};let WE=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{WE=!1}const Yf=new Uint8Array(256);for(let e=0;e<256;e++)Yf[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Yf[254]=Yf[254]=1;var HY=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,n,a,i,s=e.length,o=0;for(a=0;a<s;a++)r=e.charCodeAt(a),(r&64512)===55296&&a+1<s&&(n=e.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),o+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(o),i=0,a=0;i<o;a++)r=e.charCodeAt(a),(r&64512)===55296&&a+1<s&&(n=e.charCodeAt(a+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),a++)),r<128?t[i++]=r:r<2048?(t[i++]=192|r>>>6,t[i++]=128|r&63):r<65536?(t[i++]=224|r>>>12,t[i++]=128|r>>>6&63,t[i++]=128|r&63):(t[i++]=240|r>>>18,t[i++]=128|r>>>12&63,t[i++]=128|r>>>6&63,t[i++]=128|r&63);return t};const GY=(e,t)=>{if(t<65534&&e.subarray&&WE)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r};var VY=(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let n,a;const i=new Array(r*2);for(a=0,n=0;n<r;){let s=e[n++];if(s<128){i[a++]=s;continue}let o=Yf[s];if(o>4){i[a++]=65533,n+=o-1;continue}for(s&=o===2?31:o===3?15:7;o>1&&n<r;)s=s<<6|e[n++]&63,o--;if(o>1){i[a++]=65533;continue}s<65536?i[a++]=s:(s-=65536,i[a++]=55296|s>>10&1023,i[a++]=56320|s&1023)}return GY(i,a)},KY=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+Yf[e[r]]>t?r:t},Xf={string2buf:HY,buf2string:VY,utf8border:KY};function YY(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var HE=YY;const GE=Object.prototype.toString,{Z_NO_FLUSH:XY,Z_SYNC_FLUSH:ZY,Z_FULL_FLUSH:JY,Z_FINISH:QY,Z_OK:Lh,Z_STREAM_END:eX,Z_DEFAULT_COMPRESSION:tX,Z_DEFAULT_STRATEGY:rX,Z_DEFLATED:nX}=b0;function g2(e){this.options=$p.assign({level:tX,method:nX,chunkSize:16384,windowBits:15,memLevel:8,strategy:rX},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new HE,this.strm.avail_out=0;let r=Nf.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==Lh)throw new Error(tu[r]);if(t.header&&Nf.deflateSetHeader(this.strm,t.header),t.dictionary){let n;if(typeof t.dictionary=="string"?n=Xf.string2buf(t.dictionary):GE.call(t.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(t.dictionary):n=t.dictionary,r=Nf.deflateSetDictionary(this.strm,n),r!==Lh)throw new Error(tu[r]);this._dict_set=!0}}g2.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize;let a,i;if(this.ended)return!1;for(t===~~t?i=t:i=t===!0?QY:XY,typeof e=="string"?r.input=Xf.string2buf(e):GE.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){if(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(i===ZY||i===JY)&&r.avail_out<=6){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(a=Nf.deflate(r,i),a===eX)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),a=Nf.deflateEnd(this.strm),this.onEnd(a),this.ended=!0,a===Lh;if(r.avail_out===0){this.onData(r.output);continue}if(i>0&&r.next_out>0){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(r.avail_in===0)break}return!0};g2.prototype.onData=function(e){this.chunks.push(e)};g2.prototype.onEnd=function(e){e===Lh&&(this.result=$p.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};const md=16209,aX=16191;var iX=function(t,r){let n,a,i,s,o,c,u,f,d,p,h,x,g,y,b,E,A,C,N,F,O,I,P,H;const T=t.state;n=t.next_in,P=t.input,a=n+(t.avail_in-5),i=t.next_out,H=t.output,s=i-(r-t.avail_out),o=i+(t.avail_out-257),c=T.dmax,u=T.wsize,f=T.whave,d=T.wnext,p=T.window,h=T.hold,x=T.bits,g=T.lencode,y=T.distcode,b=(1<<T.lenbits)-1,E=(1<<T.distbits)-1;e:do{x<15&&(h+=P[n++]<<x,x+=8,h+=P[n++]<<x,x+=8),A=g[h&b];t:for(;;){if(C=A>>>24,h>>>=C,x-=C,C=A>>>16&255,C===0)H[i++]=A&65535;else if(C&16){N=A&65535,C&=15,C&&(x<C&&(h+=P[n++]<<x,x+=8),N+=h&(1<<C)-1,h>>>=C,x-=C),x<15&&(h+=P[n++]<<x,x+=8,h+=P[n++]<<x,x+=8),A=y[h&E];r:for(;;){if(C=A>>>24,h>>>=C,x-=C,C=A>>>16&255,C&16){if(F=A&65535,C&=15,x<C&&(h+=P[n++]<<x,x+=8,x<C&&(h+=P[n++]<<x,x+=8)),F+=h&(1<<C)-1,F>c){t.msg="invalid distance too far back",T.mode=md;break e}if(h>>>=C,x-=C,C=i-s,F>C){if(C=F-C,C>f&&T.sane){t.msg="invalid distance too far back",T.mode=md;break e}if(O=0,I=p,d===0){if(O+=u-C,C<N){N-=C;do H[i++]=p[O++];while(--C);O=i-F,I=H}}else if(d<C){if(O+=u+d-C,C-=d,C<N){N-=C;do H[i++]=p[O++];while(--C);if(O=0,d<N){C=d,N-=C;do H[i++]=p[O++];while(--C);O=i-F,I=H}}}else if(O+=d-C,C<N){N-=C;do H[i++]=p[O++];while(--C);O=i-F,I=H}for(;N>2;)H[i++]=I[O++],H[i++]=I[O++],H[i++]=I[O++],N-=3;N&&(H[i++]=I[O++],N>1&&(H[i++]=I[O++]))}else{O=i-F;do H[i++]=H[O++],H[i++]=H[O++],H[i++]=H[O++],N-=3;while(N>2);N&&(H[i++]=H[O++],N>1&&(H[i++]=H[O++]))}}else if(C&64){t.msg="invalid distance code",T.mode=md;break e}else{A=y[(A&65535)+(h&(1<<C)-1)];continue r}break}}else if(C&64)if(C&32){T.mode=aX;break e}else{t.msg="invalid literal/length code",T.mode=md;break e}else{A=g[(A&65535)+(h&(1<<C)-1)];continue t}break}}while(n<a&&i<o);N=x>>3,n-=N,x-=N<<3,h&=(1<<x)-1,t.next_in=n,t.next_out=i,t.avail_in=n<a?5+(a-n):5-(n-a),t.avail_out=i<o?257+(o-i):257-(i-o),T.hold=h,T.bits=x};const xc=15,V5=852,K5=592,Y5=0,x1=1,X5=2,sX=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),oX=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),lX=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),cX=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),uX=(e,t,r,n,a,i,s,o)=>{const c=o.bits;let u=0,f=0,d=0,p=0,h=0,x=0,g=0,y=0,b=0,E=0,A,C,N,F,O,I=null,P;const H=new Uint16Array(xc+1),T=new Uint16Array(xc+1);let j=null,z,K,he;for(u=0;u<=xc;u++)H[u]=0;for(f=0;f<n;f++)H[t[r+f]]++;for(h=c,p=xc;p>=1&&H[p]===0;p--);if(h>p&&(h=p),p===0)return a[i++]=1<<24|64<<16|0,a[i++]=1<<24|64<<16|0,o.bits=1,0;for(d=1;d<p&&H[d]===0;d++);for(h<d&&(h=d),y=1,u=1;u<=xc;u++)if(y<<=1,y-=H[u],y<0)return-1;if(y>0&&(e===Y5||p!==1))return-1;for(T[1]=0,u=1;u<xc;u++)T[u+1]=T[u]+H[u];for(f=0;f<n;f++)t[r+f]!==0&&(s[T[t[r+f]]++]=f);if(e===Y5?(I=j=s,P=20):e===x1?(I=sX,j=oX,P=257):(I=lX,j=cX,P=0),E=0,f=0,u=d,O=i,x=h,g=0,N=-1,b=1<<h,F=b-1,e===x1&&b>V5||e===X5&&b>K5)return 1;for(;;){z=u-g,s[f]+1<P?(K=0,he=s[f]):s[f]>=P?(K=j[s[f]-P],he=I[s[f]-P]):(K=96,he=0),A=1<<u-g,C=1<<x,d=C;do C-=A,a[O+(E>>g)+C]=z<<24|K<<16|he|0;while(C!==0);for(A=1<<u-1;E&A;)A>>=1;if(A!==0?(E&=A-1,E+=A):E=0,f++,--H[u]===0){if(u===p)break;u=t[r+s[f]]}if(u>h&&(E&F)!==N){for(g===0&&(g=h),O+=d,x=u-g,y=1<<x;x+g<p&&(y-=H[x+g],!(y<=0));)x++,y<<=1;if(b+=1<<x,e===x1&&b>V5||e===X5&&b>K5)return 1;N=E&F,a[N]=h<<24|x<<16|O-i|0}}return E!==0&&(a[O+E]=u-g<<24|64<<16|0),o.bits=h,0};var Sf=uX;const fX=0,VE=1,KE=2,{Z_FINISH:Z5,Z_BLOCK:dX,Z_TREES:gd,Z_OK:$l,Z_STREAM_END:hX,Z_NEED_DICT:pX,Z_STREAM_ERROR:mi,Z_DATA_ERROR:YE,Z_MEM_ERROR:XE,Z_BUF_ERROR:mX,Z_DEFLATED:J5}=b0,zp=16180,Q5=16181,e_=16182,t_=16183,r_=16184,n_=16185,a_=16186,i_=16187,s_=16188,o_=16189,Fh=16190,As=16191,v1=16192,l_=16193,y1=16194,c_=16195,u_=16196,f_=16197,d_=16198,xd=16199,vd=16200,h_=16201,p_=16202,m_=16203,g_=16204,x_=16205,b1=16206,v_=16207,y_=16208,Or=16209,ZE=16210,JE=16211,gX=852,xX=592,vX=15,yX=vX,b_=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function bX(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Zl=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<zp||t.mode>JE?1:0},QE=e=>{if(Zl(e))return mi;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=zp,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(gX),t.distcode=t.distdyn=new Int32Array(xX),t.sane=1,t.back=-1,$l},ej=e=>{if(Zl(e))return mi;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,QE(e)},tj=(e,t)=>{let r;if(Zl(e))return mi;const n=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?mi:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,ej(e))},rj=(e,t)=>{if(!e)return mi;const r=new bX;e.state=r,r.strm=e,r.window=null,r.mode=zp;const n=tj(e,t);return n!==$l&&(e.state=null),n},wX=e=>rj(e,yX);let w_=!0,w1,_1;const _X=e=>{if(w_){w1=new Int32Array(512),_1=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Sf(VE,e.lens,0,288,w1,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Sf(KE,e.lens,0,32,_1,0,e.work,{bits:5}),w_=!1}e.lencode=w1,e.lenbits=9,e.distcode=_1,e.distbits=5},nj=(e,t,r,n)=>{let a;const i=e.state;return i.window===null&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),n>=i.wsize?(i.window.set(t.subarray(r-i.wsize,r),0),i.wnext=0,i.whave=i.wsize):(a=i.wsize-i.wnext,a>n&&(a=n),i.window.set(t.subarray(r-n,r-n+a),i.wnext),n-=a,n?(i.window.set(t.subarray(r-n,r),0),i.wnext=n,i.whave=i.wsize):(i.wnext+=a,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=a))),0},NX=(e,t)=>{let r,n,a,i,s,o,c,u,f,d,p,h,x,g,y=0,b,E,A,C,N,F,O,I;const P=new Uint8Array(4);let H,T;const j=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Zl(e)||!e.output||!e.input&&e.avail_in!==0)return mi;r=e.state,r.mode===As&&(r.mode=v1),s=e.next_out,a=e.output,c=e.avail_out,i=e.next_in,n=e.input,o=e.avail_in,u=r.hold,f=r.bits,d=o,p=c,I=$l;e:for(;;)switch(r.mode){case zp:if(r.wrap===0){r.mode=v1;break}for(;f<16;){if(o===0)break e;o--,u+=n[i++]<<f,f+=8}if(r.wrap&2&&u===35615){r.wbits===0&&(r.wbits=15),r.check=0,P[0]=u&255,P[1]=u>>>8&255,r.check=Nn(r.check,P,2,0),u=0,f=0,r.mode=Q5;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((u&255)<<8)+(u>>8))%31){e.msg="incorrect header check",r.mode=Or;break}if((u&15)!==J5){e.msg="unknown compression method",r.mode=Or;break}if(u>>>=4,f-=4,O=(u&15)+8,r.wbits===0&&(r.wbits=O),O>15||O>r.wbits){e.msg="invalid window size",r.mode=Or;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=u&512?o_:As,u=0,f=0;break;case Q5:for(;f<16;){if(o===0)break e;o--,u+=n[i++]<<f,f+=8}if(r.flags=u,(r.flags&255)!==J5){e.msg="unknown compression method",r.mode=Or;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=Or;break}r.head&&(r.head.text=u>>8&1),r.flags&512&&r.wrap&4&&(P[0]=u&255,P[1]=u>>>8&255,r.check=Nn(r.check,P,2,0)),u=0,f=0,r.mode=e_;case e_:for(;f<32;){if(o===0)break e;o--,u+=n[i++]<<f,f+=8}r.head&&(r.head.time=u),r.flags&512&&r.wrap&4&&(P[0]=u&255,P[1]=u>>>8&255,P[2]=u>>>16&255,P[3]=u>>>24&255,r.check=Nn(r.check,P,4,0)),u=0,f=0,r.mode=t_;case t_:for(;f<16;){if(o===0)break e;o--,u+=n[i++]<<f,f+=8}r.head&&(r.head.xflags=u&255,r.head.os=u>>8),r.flags&512&&r.wrap&4&&(P[0]=u&255,P[1]=u>>>8&255,r.check=Nn(r.check,P,2,0)),u=0,f=0,r.mode=r_;case r_:if(r.flags&1024){for(;f<16;){if(o===0)break e;o--,u+=n[i++]<<f,f+=8}r.length=u,r.head&&(r.head.extra_len=u),r.flags&512&&r.wrap&4&&(P[0]=u&255,P[1]=u>>>8&255,r.check=Nn(r.check,P,2,0)),u=0,f=0}else r.head&&(r.head.extra=null);r.mode=n_;case n_:if(r.flags&1024&&(h=r.length,h>o&&(h=o),h&&(r.head&&(O=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(i,i+h),O)),r.flags&512&&r.wrap&4&&(r.check=Nn(r.check,n,h,i)),o-=h,i+=h,r.length-=h),r.length))break e;r.length=0,r.mode=a_;case a_:if(r.flags&2048){if(o===0)break e;h=0;do O=n[i+h++],r.head&&O&&r.length<65536&&(r.head.name+=String.fromCharCode(O));while(O&&h<o);if(r.flags&512&&r.wrap&4&&(r.check=Nn(r.check,n,h,i)),o-=h,i+=h,O)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=i_;case i_:if(r.flags&4096){if(o===0)break e;h=0;do O=n[i+h++],r.head&&O&&r.length<65536&&(r.head.comment+=String.fromCharCode(O));while(O&&h<o);if(r.flags&512&&r.wrap&4&&(r.check=Nn(r.check,n,h,i)),o-=h,i+=h,O)break e}else r.head&&(r.head.comment=null);r.mode=s_;case s_:if(r.flags&512){for(;f<16;){if(o===0)break e;o--,u+=n[i++]<<f,f+=8}if(r.wrap&4&&u!==(r.check&65535)){e.msg="header crc mismatch",r.mode=Or;break}u=0,f=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=As;break;case o_:for(;f<32;){if(o===0)break e;o--,u+=n[i++]<<f,f+=8}e.adler=r.check=b_(u),u=0,f=0,r.mode=Fh;case Fh:if(r.havedict===0)return e.next_out=s,e.avail_out=c,e.next_in=i,e.avail_in=o,r.hold=u,r.bits=f,pX;e.adler=r.check=1,r.mode=As;case As:if(t===dX||t===gd)break e;case v1:if(r.last){u>>>=f&7,f-=f&7,r.mode=b1;break}for(;f<3;){if(o===0)break e;o--,u+=n[i++]<<f,f+=8}switch(r.last=u&1,u>>>=1,f-=1,u&3){case 0:r.mode=l_;break;case 1:if(_X(r),r.mode=xd,t===gd){u>>>=2,f-=2;break e}break;case 2:r.mode=u_;break;case 3:e.msg="invalid block type",r.mode=Or}u>>>=2,f-=2;break;case l_:for(u>>>=f&7,f-=f&7;f<32;){if(o===0)break e;o--,u+=n[i++]<<f,f+=8}if((u&65535)!==(u>>>16^65535)){e.msg="invalid stored block lengths",r.mode=Or;break}if(r.length=u&65535,u=0,f=0,r.mode=y1,t===gd)break e;case y1:r.mode=c_;case c_:if(h=r.length,h){if(h>o&&(h=o),h>c&&(h=c),h===0)break e;a.set(n.subarray(i,i+h),s),o-=h,i+=h,c-=h,s+=h,r.length-=h;break}r.mode=As;break;case u_:for(;f<14;){if(o===0)break e;o--,u+=n[i++]<<f,f+=8}if(r.nlen=(u&31)+257,u>>>=5,f-=5,r.ndist=(u&31)+1,u>>>=5,f-=5,r.ncode=(u&15)+4,u>>>=4,f-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=Or;break}r.have=0,r.mode=f_;case f_:for(;r.have<r.ncode;){for(;f<3;){if(o===0)break e;o--,u+=n[i++]<<f,f+=8}r.lens[j[r.have++]]=u&7,u>>>=3,f-=3}for(;r.have<19;)r.lens[j[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,H={bits:r.lenbits},I=Sf(fX,r.lens,0,19,r.lencode,0,r.work,H),r.lenbits=H.bits,I){e.msg="invalid code lengths set",r.mode=Or;break}r.have=0,r.mode=d_;case d_:for(;r.have<r.nlen+r.ndist;){for(;y=r.lencode[u&(1<<r.lenbits)-1],b=y>>>24,E=y>>>16&255,A=y&65535,!(b<=f);){if(o===0)break e;o--,u+=n[i++]<<f,f+=8}if(A<16)u>>>=b,f-=b,r.lens[r.have++]=A;else{if(A===16){for(T=b+2;f<T;){if(o===0)break e;o--,u+=n[i++]<<f,f+=8}if(u>>>=b,f-=b,r.have===0){e.msg="invalid bit length repeat",r.mode=Or;break}O=r.lens[r.have-1],h=3+(u&3),u>>>=2,f-=2}else if(A===17){for(T=b+3;f<T;){if(o===0)break e;o--,u+=n[i++]<<f,f+=8}u>>>=b,f-=b,O=0,h=3+(u&7),u>>>=3,f-=3}else{for(T=b+7;f<T;){if(o===0)break e;o--,u+=n[i++]<<f,f+=8}u>>>=b,f-=b,O=0,h=11+(u&127),u>>>=7,f-=7}if(r.have+h>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=Or;break}for(;h--;)r.lens[r.have++]=O}}if(r.mode===Or)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=Or;break}if(r.lenbits=9,H={bits:r.lenbits},I=Sf(VE,r.lens,0,r.nlen,r.lencode,0,r.work,H),r.lenbits=H.bits,I){e.msg="invalid literal/lengths set",r.mode=Or;break}if(r.distbits=6,r.distcode=r.distdyn,H={bits:r.distbits},I=Sf(KE,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,H),r.distbits=H.bits,I){e.msg="invalid distances set",r.mode=Or;break}if(r.mode=xd,t===gd)break e;case xd:r.mode=vd;case vd:if(o>=6&&c>=258){e.next_out=s,e.avail_out=c,e.next_in=i,e.avail_in=o,r.hold=u,r.bits=f,iX(e,p),s=e.next_out,a=e.output,c=e.avail_out,i=e.next_in,n=e.input,o=e.avail_in,u=r.hold,f=r.bits,r.mode===As&&(r.back=-1);break}for(r.back=0;y=r.lencode[u&(1<<r.lenbits)-1],b=y>>>24,E=y>>>16&255,A=y&65535,!(b<=f);){if(o===0)break e;o--,u+=n[i++]<<f,f+=8}if(E&&!(E&240)){for(C=b,N=E,F=A;y=r.lencode[F+((u&(1<<C+N)-1)>>C)],b=y>>>24,E=y>>>16&255,A=y&65535,!(C+b<=f);){if(o===0)break e;o--,u+=n[i++]<<f,f+=8}u>>>=C,f-=C,r.back+=C}if(u>>>=b,f-=b,r.back+=b,r.length=A,E===0){r.mode=x_;break}if(E&32){r.back=-1,r.mode=As;break}if(E&64){e.msg="invalid literal/length code",r.mode=Or;break}r.extra=E&15,r.mode=h_;case h_:if(r.extra){for(T=r.extra;f<T;){if(o===0)break e;o--,u+=n[i++]<<f,f+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,f-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=p_;case p_:for(;y=r.distcode[u&(1<<r.distbits)-1],b=y>>>24,E=y>>>16&255,A=y&65535,!(b<=f);){if(o===0)break e;o--,u+=n[i++]<<f,f+=8}if(!(E&240)){for(C=b,N=E,F=A;y=r.distcode[F+((u&(1<<C+N)-1)>>C)],b=y>>>24,E=y>>>16&255,A=y&65535,!(C+b<=f);){if(o===0)break e;o--,u+=n[i++]<<f,f+=8}u>>>=C,f-=C,r.back+=C}if(u>>>=b,f-=b,r.back+=b,E&64){e.msg="invalid distance code",r.mode=Or;break}r.offset=A,r.extra=E&15,r.mode=m_;case m_:if(r.extra){for(T=r.extra;f<T;){if(o===0)break e;o--,u+=n[i++]<<f,f+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,f-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=Or;break}r.mode=g_;case g_:if(c===0)break e;if(h=p-c,r.offset>h){if(h=r.offset-h,h>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=Or;break}h>r.wnext?(h-=r.wnext,x=r.wsize-h):x=r.wnext-h,h>r.length&&(h=r.length),g=r.window}else g=a,x=s-r.offset,h=r.length;h>c&&(h=c),c-=h,r.length-=h;do a[s++]=g[x++];while(--h);r.length===0&&(r.mode=vd);break;case x_:if(c===0)break e;a[s++]=r.length,c--,r.mode=vd;break;case b1:if(r.wrap){for(;f<32;){if(o===0)break e;o--,u|=n[i++]<<f,f+=8}if(p-=c,e.total_out+=p,r.total+=p,r.wrap&4&&p&&(e.adler=r.check=r.flags?Nn(r.check,a,p,s-p):Kf(r.check,a,p,s-p)),p=c,r.wrap&4&&(r.flags?u:b_(u))!==r.check){e.msg="incorrect data check",r.mode=Or;break}u=0,f=0}r.mode=v_;case v_:if(r.wrap&&r.flags){for(;f<32;){if(o===0)break e;o--,u+=n[i++]<<f,f+=8}if(r.wrap&4&&u!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=Or;break}u=0,f=0}r.mode=y_;case y_:I=hX;break e;case Or:I=YE;break e;case ZE:return XE;case JE:default:return mi}return e.next_out=s,e.avail_out=c,e.next_in=i,e.avail_in=o,r.hold=u,r.bits=f,(r.wsize||p!==e.avail_out&&r.mode<Or&&(r.mode<b1||t!==Z5))&&nj(e,e.output,e.next_out,p-e.avail_out),d-=e.avail_in,p-=e.avail_out,e.total_in+=d,e.total_out+=p,r.total+=p,r.wrap&4&&p&&(e.adler=r.check=r.flags?Nn(r.check,a,p,e.next_out-p):Kf(r.check,a,p,e.next_out-p)),e.data_type=r.bits+(r.last?64:0)+(r.mode===As?128:0)+(r.mode===xd||r.mode===y1?256:0),(d===0&&p===0||t===Z5)&&I===$l&&(I=mX),I},SX=e=>{if(Zl(e))return mi;let t=e.state;return t.window&&(t.window=null),e.state=null,$l},AX=(e,t)=>{if(Zl(e))return mi;const r=e.state;return r.wrap&2?(r.head=t,t.done=!1,$l):mi},EX=(e,t)=>{const r=t.length;let n,a,i;return Zl(e)||(n=e.state,n.wrap!==0&&n.mode!==Fh)?mi:n.mode===Fh&&(a=1,a=Kf(a,t,r,0),a!==n.check)?YE:(i=nj(e,t,r,r),i?(n.mode=ZE,XE):(n.havedict=1,$l))};var jX=ej,TX=tj,PX=QE,kX=wX,CX=rj,OX=NX,LX=SX,FX=AX,DX=EX,IX="pako inflate (from Nodeca project)",js={inflateReset:jX,inflateReset2:TX,inflateResetKeep:PX,inflateInit:kX,inflateInit2:CX,inflate:OX,inflateEnd:LX,inflateGetHeader:FX,inflateSetDictionary:DX,inflateInfo:IX};function MX(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var RX=MX;const aj=Object.prototype.toString,{Z_NO_FLUSH:BX,Z_FINISH:UX,Z_OK:Zf,Z_STREAM_END:N1,Z_NEED_DICT:S1,Z_STREAM_ERROR:$X,Z_DATA_ERROR:__,Z_MEM_ERROR:zX}=b0;function _0(e){this.options=$p.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new HE,this.strm.avail_out=0;let r=js.inflateInit2(this.strm,t.windowBits);if(r!==Zf)throw new Error(tu[r]);if(this.header=new RX,js.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=Xf.string2buf(t.dictionary):aj.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=js.inflateSetDictionary(this.strm,t.dictionary),r!==Zf)))throw new Error(tu[r])}_0.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,a=this.options.dictionary;let i,s,o;if(this.ended)return!1;for(t===~~t?s=t:s=t===!0?UX:BX,aj.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),i=js.inflate(r,s),i===S1&&a&&(i=js.inflateSetDictionary(r,a),i===Zf?i=js.inflate(r,s):i===__&&(i=S1));r.avail_in>0&&i===N1&&r.state.wrap>0&&e[r.next_in]!==0;)js.inflateReset(r),i=js.inflate(r,s);switch(i){case $X:case __:case S1:case zX:return this.onEnd(i),this.ended=!0,!1}if(o=r.avail_out,r.next_out&&(r.avail_out===0||i===N1))if(this.options.to==="string"){let c=Xf.utf8border(r.output,r.next_out),u=r.next_out-c,f=Xf.buf2string(r.output,c);r.next_out=u,r.avail_out=n-u,u&&r.output.set(r.output.subarray(c,c+u),0),this.onData(f)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(i===Zf&&o===0)){if(i===N1)return i=js.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};_0.prototype.onData=function(e){this.chunks.push(e)};_0.prototype.onEnd=function(e){e===Zf&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=$p.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function x2(e,t){const r=new _0(t);if(r.push(e),r.err)throw r.msg||tu[r.err];return r.result}function qX(e,t){return t=t||{},t.raw=!0,x2(e,t)}var WX=_0,HX=x2,GX=qX,VX=x2,KX=b0,YX={Inflate:WX,inflate:HX,inflateRaw:GX,ungzip:VX,constants:KX};const{Inflate:XX,inflate:ZX,inflateRaw:EJ,ungzip:jJ}=YX;var N_=XX,JX=ZX;const ij=[];for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;ij[e]=t}const S_=4294967295;function QX(e,t,r){let n=e;for(let a=0;a<r;a++)n=ij[(n^t[a])&255]^n>>>8;return n}function eZ(e,t){return(QX(S_,e,t)^S_)>>>0}function A_(e,t,r){const n=e.readUint32(),a=eZ(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(a!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${a}`)}function sj(e,t,r){for(let n=0;n<r;n++)t[n]=e[n]}function oj(e,t,r,n){let a=0;for(;a<n;a++)t[a]=e[a];for(;a<r;a++)t[a]=e[a]+t[a-n]&255}function lj(e,t,r,n){let a=0;if(r.length===0)for(;a<n;a++)t[a]=e[a];else for(;a<n;a++)t[a]=e[a]+r[a]&255}function cj(e,t,r,n,a){let i=0;if(r.length===0){for(;i<a;i++)t[i]=e[i];for(;i<n;i++)t[i]=e[i]+(t[i-a]>>1)&255}else{for(;i<a;i++)t[i]=e[i]+(r[i]>>1)&255;for(;i<n;i++)t[i]=e[i]+(t[i-a]+r[i]>>1)&255}}function uj(e,t,r,n,a){let i=0;if(r.length===0){for(;i<a;i++)t[i]=e[i];for(;i<n;i++)t[i]=e[i]+t[i-a]&255}else{for(;i<a;i++)t[i]=e[i]+r[i]&255;for(;i<n;i++)t[i]=e[i]+tZ(t[i-a],r[i],r[i-a])&255}}function tZ(e,t,r){const n=e+t-r,a=Math.abs(n-e),i=Math.abs(n-t),s=Math.abs(n-r);return a<=i&&a<=s?e:i<=s?t:r}function rZ(e,t,r,n,a,i){switch(e){case 0:sj(t,r,a);break;case 1:oj(t,r,a,i);break;case 2:lj(t,r,n,a);break;case 3:cj(t,r,n,a,i);break;case 4:uj(t,r,n,a,i);break;default:throw new Error(`Unsupported filter: ${e}`)}}const nZ=new Uint16Array([255]),aZ=new Uint8Array(nZ.buffer),iZ=aZ[0]===255;function sZ(e){const{data:t,width:r,height:n,channels:a,depth:i}=e,s=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],o=Math.ceil(i/8)*a,c=new Uint8Array(n*r*o);let u=0;for(let f=0;f<7;f++){const d=s[f],p=Math.ceil((r-d.x)/d.xStep),h=Math.ceil((n-d.y)/d.yStep);if(p<=0||h<=0)continue;const x=p*o,g=new Uint8Array(x);for(let y=0;y<h;y++){const b=t[u++],E=t.subarray(u,u+x);u+=x;const A=new Uint8Array(x);rZ(b,E,A,g,x,o),g.set(A);for(let C=0;C<p;C++){const N=d.x+C*d.xStep,F=d.y+y*d.yStep;if(!(N>=r||F>=n))for(let O=0;O<o;O++)c[(F*r+N)*o+O]=A[C*o+O]}}}if(i===16){const f=new Uint16Array(c.buffer);if(iZ)for(let d=0;d<f.length;d++)f[d]=oZ(f[d]);return f}else return c}function oZ(e){return(e&255)<<8|e>>8&255}const lZ=new Uint16Array([255]),cZ=new Uint8Array(lZ.buffer),uZ=cZ[0]===255,fZ=new Uint8Array(0);function E_(e){const{data:t,width:r,height:n,channels:a,depth:i}=e,s=Math.ceil(i/8)*a,o=Math.ceil(i/8*a*r),c=new Uint8Array(n*o);let u=fZ,f=0,d,p;for(let h=0;h<n;h++){switch(d=t.subarray(f+1,f+1+o),p=c.subarray(h*o,(h+1)*o),t[f]){case 0:sj(d,p,o);break;case 1:oj(d,p,o,s);break;case 2:lj(d,p,u,o);break;case 3:cj(d,p,u,o,s);break;case 4:uj(d,p,u,o,s);break;default:throw new Error(`Unsupported filter: ${t[f]}`)}u=p,f+=o+1}if(i===16){const h=new Uint16Array(c.buffer);if(uZ)for(let x=0;x<h.length;x++)h[x]=dZ(h[x]);return h}else return c}function dZ(e){return(e&255)<<8|e>>8&255}const Td=Uint8Array.of(137,80,78,71,13,10,26,10);function j_(e){if(!hZ(e.readBytes(Td.length)))throw new Error("wrong PNG signature")}function hZ(e){if(e.length<Td.length)return!1;for(let t=0;t<Td.length;t++)if(e[t]!==Td[t])return!1;return!0}const pZ="tEXt",mZ=0,fj=new TextDecoder("latin1");function gZ(e){if(vZ(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const xZ=/^[\u0000-\u00FF]*$/;function vZ(e){if(!xZ.test(e))throw new Error("invalid latin1 text")}function yZ(e,t,r){const n=dj(t);e[n]=bZ(t,r-n.length-1)}function dj(e){for(e.mark();e.readByte()!==mZ;);const t=e.offset;e.reset();const r=fj.decode(e.readBytes(t-e.offset-1));return e.skip(1),gZ(r),r}function bZ(e,t){return fj.decode(e.readBytes(t))}const Ma={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},A1={UNKNOWN:-1,DEFLATE:0},T_={UNKNOWN:-1,ADAPTIVE:0},E1={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},yd={NONE:0,BACKGROUND:1,PREVIOUS:2},j1={SOURCE:0,OVER:1};class wZ extends u2{constructor(r,n={}){super(r);rr(this,"_checkCrc");rr(this,"_inflator");rr(this,"_png");rr(this,"_apng");rr(this,"_end");rr(this,"_hasPalette");rr(this,"_palette");rr(this,"_hasTransparency");rr(this,"_transparency");rr(this,"_compressionMethod");rr(this,"_filterMethod");rr(this,"_interlaceMethod");rr(this,"_colorType");rr(this,"_isAnimated");rr(this,"_numberOfFrames");rr(this,"_numberOfPlays");rr(this,"_frames");rr(this,"_writingDataChunks");const{checkCrc:a=!1}=n;this._checkCrc=a,this._inflator=new N_,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=A1.UNKNOWN,this._filterMethod=T_.UNKNOWN,this._interlaceMethod=E1.UNKNOWN,this._colorType=Ma.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(j_(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(j_(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const a=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case pZ:yZ(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-a!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?A_(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const a=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=a+r;break}if(this.offset-a!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?A_(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=_Z(this.readUint8());const n=this.readUint8();this._colorType=n;let a;switch(n){case Ma.GREYSCALE:a=1;break;case Ma.TRUECOLOUR:a=3;break;case Ma.INDEXED_COLOUR:a=1;break;case Ma.GREYSCALE_ALPHA:a=2;break;case Ma.TRUECOLOUR_ALPHA:a=4;break;case Ma.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=a,this._compressionMethod=this.readUint8(),this._compressionMethod!==A1.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const a=[];this._palette=a;for(let i=0;i<n;i++)a.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,a=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,a=this.offset+this.byteOffset;if(a+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,a,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case Ma.GREYSCALE:case Ma.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case Ma.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const a=this.readByte();this._palette[n].push(a)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case Ma.UNKNOWN:case Ma.GREYSCALE_ALPHA:case Ma.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=dj(this),a=this.readUint8();if(a!==A1.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${a}`);const i=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:JX(i)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),a=this.readByte();this._png.resolution={x:r,y:n,unit:a}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},a=this._frames.at(r);if(a){if(a.data=E_({data:a.data,width:a.width,height:a.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||a.xOffset===0&&a.yOffset===0&&a.width===this._png.width&&a.height===this._png.height)n.data=a.data;else{const i=this._apng.frames.at(r-1);this.disposeFrame(a,i,n),this.addFrameDataToCanvas(n,a)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,a){switch(r.disposeOp){case yd.NONE:break;case yd.BACKGROUND:for(let i=0;i<this._png.height;i++)for(let s=0;s<this._png.width;s++){const o=(i*r.width+s)*this._png.channels;for(let c=0;c<this._png.channels;c++)a.data[o+c]=0}break;case yd.PREVIOUS:a.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const a=1<<this._png.depth,i=(s,o)=>{const c=((s+n.yOffset)*this._png.width+n.xOffset+o)*this._png.channels,u=(s*n.width+o)*this._png.channels;return{index:c,frameIndex:u}};switch(n.blendOp){case j1.SOURCE:for(let s=0;s<n.height;s++)for(let o=0;o<n.width;o++){const{index:c,frameIndex:u}=i(s,o);for(let f=0;f<this._png.channels;f++)r.data[c+f]=n.data[u+f]}break;case j1.OVER:for(let s=0;s<n.height;s++)for(let o=0;o<n.width;o++){const{index:c,frameIndex:u}=i(s,o);for(let f=0;f<this._png.channels;f++){const d=n.data[u+this._png.channels-1]/a,p=f%(this._png.channels-1)===0?1:n.data[u+f],h=Math.floor(d*p+(1-d)*r.data[c+f]);r.data[c+f]+=h}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==T_.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===E1.NO_INTERLACE)this._png.data=E_({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===E1.ADAM7)this._png.data=sZ({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:yd.NONE,blendOp:j1.SOURCE,data:r}),this._inflator=new N_,this._writingDataChunks=!1}}function _Z(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var P_;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(P_||(P_={}));function NZ(e,t){return new wZ(e,t).decode()}var Ct=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function T1(){Ct.console&&typeof Ct.console.log=="function"&&Ct.console.log.apply(Ct.console,arguments)}var vr={log:T1,warn:function(e){Ct.console&&(typeof Ct.console.warn=="function"?Ct.console.warn.apply(Ct.console,arguments):T1.call(null,arguments))},error:function(e){Ct.console&&(typeof Ct.console.error=="function"?Ct.console.error.apply(Ct.console,arguments):T1(e))}};function P1(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){ul(n.response,t,r)},n.onerror=function(){vr.error("could not download file")},n.send()}function k_(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function bd(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var ul=Ct.saveAs||((typeof window>"u"?"undefined":fr(window))!=="object"||window!==Ct?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=Ct.URL||Ct.webkitURL,a=document.createElement("a");t=t||e.name||"download",a.download=t,a.rel="noopener",typeof e=="string"?(a.href=e,a.origin!==location.origin?k_(a.href)?P1(e,t,r):bd(a,a.target="_blank"):bd(a)):(a.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(a.href)},4e4),setTimeout(function(){bd(a)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(k_(e))P1(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){bd(n)})}else navigator.msSaveOrOpenBlob(function(a,i){return i===void 0?i={autoBom:!1}:fr(i)!=="object"&&(vr.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(a.type)?new Blob(["\uFEFF",a],{type:a.type}):a}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return P1(e,t,r);var a=e.type==="application/octet-stream",i=/constructor/i.test(Ct.HTMLElement)||Ct.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||a&&i)&&(typeof FileReader>"u"?"undefined":fr(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var f=o.result;f=s?f:f.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=f:location=f,n=null},o.readAsDataURL(e)}else{var c=Ct.URL||Ct.webkitURL,u=c.createObjectURL(e);n?n.location=u:location.href=u,n=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function hj(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<r.length;n++){var a=r[n].re,i=r[n].process,s=a.exec(e);s&&(t=i(s),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return o.length==1&&(o="0"+o),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+o+c+u}}var Pd=Ct.atob.bind(Ct),C_=Ct.btoa.bind(Ct);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function k1(e,t){var r=e[0],n=e[1],a=e[2],i=e[3];r=Xn(r,n,a,i,t[0],7,-680876936),i=Xn(i,r,n,a,t[1],12,-389564586),a=Xn(a,i,r,n,t[2],17,606105819),n=Xn(n,a,i,r,t[3],22,-1044525330),r=Xn(r,n,a,i,t[4],7,-176418897),i=Xn(i,r,n,a,t[5],12,1200080426),a=Xn(a,i,r,n,t[6],17,-1473231341),n=Xn(n,a,i,r,t[7],22,-45705983),r=Xn(r,n,a,i,t[8],7,1770035416),i=Xn(i,r,n,a,t[9],12,-1958414417),a=Xn(a,i,r,n,t[10],17,-42063),n=Xn(n,a,i,r,t[11],22,-1990404162),r=Xn(r,n,a,i,t[12],7,1804603682),i=Xn(i,r,n,a,t[13],12,-40341101),a=Xn(a,i,r,n,t[14],17,-1502002290),r=Zn(r,n=Xn(n,a,i,r,t[15],22,1236535329),a,i,t[1],5,-165796510),i=Zn(i,r,n,a,t[6],9,-1069501632),a=Zn(a,i,r,n,t[11],14,643717713),n=Zn(n,a,i,r,t[0],20,-373897302),r=Zn(r,n,a,i,t[5],5,-701558691),i=Zn(i,r,n,a,t[10],9,38016083),a=Zn(a,i,r,n,t[15],14,-660478335),n=Zn(n,a,i,r,t[4],20,-405537848),r=Zn(r,n,a,i,t[9],5,568446438),i=Zn(i,r,n,a,t[14],9,-1019803690),a=Zn(a,i,r,n,t[3],14,-187363961),n=Zn(n,a,i,r,t[8],20,1163531501),r=Zn(r,n,a,i,t[13],5,-1444681467),i=Zn(i,r,n,a,t[2],9,-51403784),a=Zn(a,i,r,n,t[7],14,1735328473),r=Jn(r,n=Zn(n,a,i,r,t[12],20,-1926607734),a,i,t[5],4,-378558),i=Jn(i,r,n,a,t[8],11,-2022574463),a=Jn(a,i,r,n,t[11],16,1839030562),n=Jn(n,a,i,r,t[14],23,-35309556),r=Jn(r,n,a,i,t[1],4,-1530992060),i=Jn(i,r,n,a,t[4],11,1272893353),a=Jn(a,i,r,n,t[7],16,-155497632),n=Jn(n,a,i,r,t[10],23,-1094730640),r=Jn(r,n,a,i,t[13],4,681279174),i=Jn(i,r,n,a,t[0],11,-358537222),a=Jn(a,i,r,n,t[3],16,-722521979),n=Jn(n,a,i,r,t[6],23,76029189),r=Jn(r,n,a,i,t[9],4,-640364487),i=Jn(i,r,n,a,t[12],11,-421815835),a=Jn(a,i,r,n,t[15],16,530742520),r=Qn(r,n=Jn(n,a,i,r,t[2],23,-995338651),a,i,t[0],6,-198630844),i=Qn(i,r,n,a,t[7],10,1126891415),a=Qn(a,i,r,n,t[14],15,-1416354905),n=Qn(n,a,i,r,t[5],21,-57434055),r=Qn(r,n,a,i,t[12],6,1700485571),i=Qn(i,r,n,a,t[3],10,-1894986606),a=Qn(a,i,r,n,t[10],15,-1051523),n=Qn(n,a,i,r,t[1],21,-2054922799),r=Qn(r,n,a,i,t[8],6,1873313359),i=Qn(i,r,n,a,t[15],10,-30611744),a=Qn(a,i,r,n,t[6],15,-1560198380),n=Qn(n,a,i,r,t[13],21,1309151649),r=Qn(r,n,a,i,t[4],6,-145523070),i=Qn(i,r,n,a,t[11],10,-1120210379),a=Qn(a,i,r,n,t[2],15,718787259),n=Qn(n,a,i,r,t[9],21,-343485551),e[0]=jo(r,e[0]),e[1]=jo(n,e[1]),e[2]=jo(a,e[2]),e[3]=jo(i,e[3])}function qp(e,t,r,n,a,i){return t=jo(jo(t,e),jo(n,i)),jo(t<<a|t>>>32-a,r)}function Xn(e,t,r,n,a,i,s){return qp(t&r|~t&n,e,t,a,i,s)}function Zn(e,t,r,n,a,i,s){return qp(t&n|r&~n,e,t,a,i,s)}function Jn(e,t,r,n,a,i,s){return qp(t^r^n,e,t,a,i,s)}function Qn(e,t,r,n,a,i,s){return qp(r^(t|~n),e,t,a,i,s)}function pj(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)k1(n,SZ(e.substring(t-64,t)));e=e.substring(t-64);var a=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)a[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(a[t>>2]|=128<<(t%4<<3),t>55)for(k1(n,a),t=0;t<16;t++)a[t]=0;return a[14]=8*r,k1(n,a),n}function SZ(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var O_="0123456789abcdef".split("");function AZ(e){for(var t="",r=0;r<4;r++)t+=O_[e>>8*r+4&15]+O_[e>>8*r&15];return t}function EZ(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function Hg(e){return pj(e).map(EZ).join("")}var jZ=function(e){for(var t=0;t<e.length;t++)e[t]=AZ(e[t]);return e.join("")}(pj("hello"))!="5d41402abc4b2a76b9719d911017c592";function jo(e,t){if(jZ){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Gg(e,t){var r,n,a,i;if(e!==r){for(var s=(a=e,i=1+(256/e.length|0),new Array(i+1).join(a)),o=[],c=0;c<256;c++)o[c]=c;var u=0;for(c=0;c<256;c++){var f=o[c];u=(u+f+s.charCodeAt(c))%256,o[c]=o[u],o[u]=f}r=e,n=o}else o=n;var d=t.length,p=0,h=0,x="";for(c=0;c<d;c++)h=(h+(f=o[p=(p+1)%256]))%256,o[p]=o[h],o[h]=f,s=o[(o[p]+o[h])%256],x+=String.fromCharCode(t.charCodeAt(c)^s);return x}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var L_={print:4,modify:8,copy:16,"annot-forms":32};function _c(e,t,r,n){this.v=1,this.r=2;var a=192;e.forEach(function(o){if(L_.perm!==void 0)throw new Error("Invalid permission: "+o);a+=L_[o]}),this.padding="(¬øN^Nu¬äAd\0NV√ø√∫\b..\0¬∂√êh>¬Ä/\f¬©√ædSiz";var i=(t+this.padding).substr(0,32),s=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,s),this.P=-(1+(255^a)),this.encryptionKey=Hg(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=Gg(this.encryptionKey,this.padding)}function Nc(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var a=e.charCodeAt(n);t+=a<33||a===35||a===37||a===40||a===41||a===47||a===60||a===62||a===91||a===93||a===123||a===125||a>126?"#"+("0"+a.toString(16)).slice(-2):e[n]}return t}function F_(e){if(fr(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,a){if(a=a||!1,typeof r!="string"||typeof n!="function"||typeof a!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var i=Math.random().toString(35);return t[r][i]=[n,!!a],i},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),a=[];for(var i in t[r]){var s=t[r][i];try{s[0].apply(e,n)}catch(o){Ct.console&&vr.error("jsPDF PubSub Error",o.message,o)}s[1]&&a.push(i)}a.length&&a.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function Dh(e){if(!(this instanceof Dh))return new Dh(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function mj(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function hl(e,t,r,n,a){if(!(this instanceof hl))return new hl(e,t,r,n,a);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,mj.call(this,n,a)}function Pc(e,t,r,n,a){if(!(this instanceof Pc))return new Pc(e,t,r,n,a);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,mj.call(this,n,a)}function St(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],a=arguments[2],i=arguments[3],s=[],o=1,c=16,u="S",f=null;fr(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,a=e.format||a,i=e.compress||e.compressPdf||i,(f=e.encryption||null)!==null&&(f.userPassword=f.userPassword||"",f.ownerPassword=f.ownerPassword||"",f.userPermissions=f.userPermissions||[]),o=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(c=e.floatPrecision),u=e.defaultPathOperation||"S"),s=e.filters||(i===!0?["FlateEncode"]:s),n=n||"mm",r=(""+(r||"P")).toLowerCase();var d=e.putOnlyUsedFonts||!1,p={},h={internal:{},__private__:{}};h.__private__.PubSub=F_;var x="1.3",g=h.__private__.getPdfVersion=function(){return x};h.__private__.setPdfVersion=function(w){x=w};var y={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return y};var b=h.__private__.getPageFormat=function(w){return y[w]};a=a||"a4";var E="compat",A="advanced",C=E;function N(){this.saveGraphicsState(),te(new Et(pt,0,0,-pt,0,Pa()*pt).toString()+" cm"),this.setFontSize(this.getFontSize()/pt),u="n",C=A}function F(){this.restoreGraphicsState(),u="S",C=E}var O=h.__private__.combineFontStyleAndFontWeight=function(w,U){if(w=="bold"&&U=="normal"||w=="bold"&&U==400||w=="normal"&&U=="italic"||w=="bold"&&U=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return U&&(w=U==400||U==="normal"?w==="italic"?"italic":"normal":U!=700&&U!=="bold"||w!=="normal"?(U==700?"bold":U)+""+w:"bold"),w};h.advancedAPI=function(w){var U=C===E;return U&&N.call(this),typeof w!="function"||(w(this),U&&F.call(this)),this},h.compatAPI=function(w){var U=C===A;return U&&F.call(this),typeof w!="function"||(w(this),U&&N.call(this)),this},h.isAdvancedAPI=function(){return C===A};var I,P=function(w){if(C!==A)throw new Error(w+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},H=h.roundToPrecision=h.__private__.roundToPrecision=function(w,U){var se=t||U;if(isNaN(w)||isNaN(se))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return w.toFixed(se).replace(/0+$/,"")};I=h.hpf=h.__private__.hpf=typeof c=="number"?function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.hpf");return H(w,c)}:c==="smart"?function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.hpf");return H(w,w>-1&&w<1?16:5)}:function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.hpf");return H(w,16)};var T=h.f2=h.__private__.f2=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.f2");return H(w,2)},j=h.__private__.f3=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.f3");return H(w,3)},z=h.scale=h.__private__.scale=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.scale");return C===E?w*pt:C===A?w:void 0},K=function(w){return z(function(U){return C===E?Pa()-U:C===A?U:void 0}(w))};h.__private__.setPrecision=h.setPrecision=function(w){typeof parseInt(w,10)=="number"&&(t=parseInt(w,10))};var he,be="00000000000000000000000000000000",we=h.__private__.getFileId=function(){return be},Q=h.__private__.setFileId=function(w){return be=w!==void 0&&/^[a-fA-F0-9]{32}$/.test(w)?w.toUpperCase():be.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),f!==null&&(Hr=new _c(f.userPermissions,f.userPassword,f.ownerPassword,be)),be};h.setFileId=function(w){return Q(w),this},h.getFileId=function(){return we()};var le=h.__private__.convertDateToPDFDate=function(w){var U=w.getTimezoneOffset(),se=U<0?"+":"-",pe=Math.floor(Math.abs(U/60)),_e=Math.abs(U%60),Be=[se,D(pe),"'",D(_e),"'"].join("");return["D:",w.getFullYear(),D(w.getMonth()+1),D(w.getDate()),D(w.getHours()),D(w.getMinutes()),D(w.getSeconds()),Be].join("")},ke=h.__private__.convertPDFDateToDate=function(w){var U=parseInt(w.substr(2,4),10),se=parseInt(w.substr(6,2),10)-1,pe=parseInt(w.substr(8,2),10),_e=parseInt(w.substr(10,2),10),Be=parseInt(w.substr(12,2),10),He=parseInt(w.substr(14,2),10);return new Date(U,se,pe,_e,Be,He,0)},ve=h.__private__.setCreationDate=function(w){var U;if(w===void 0&&(w=new Date),w instanceof Date)U=le(w);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(w))throw new Error("Invalid argument passed to jsPDF.setCreationDate");U=w}return he=U},S=h.__private__.getCreationDate=function(w){var U=he;return w==="jsDate"&&(U=ke(he)),U};h.setCreationDate=function(w){return ve(w),this},h.getCreationDate=function(w){return S(w)};var L,D=h.__private__.padd2=function(w){return("0"+parseInt(w)).slice(-2)},R=h.__private__.padd2Hex=function(w){return("00"+(w=w.toString())).substr(w.length)},X=0,de=[],me=[],Y=0,oe=[],ue=[],fe=!1,Ue=me;h.__private__.setCustomOutputDestination=function(w){fe=!0,Ue=w};var xe=function(w){fe||(Ue=w)};h.__private__.resetCustomOutputDestination=function(){fe=!1,Ue=me};var te=h.__private__.out=function(w){return w=w.toString(),Y+=w.length+1,Ue.push(w),Ue},nt=h.__private__.write=function(w){return te(arguments.length===1?w.toString():Array.prototype.join.call(arguments," "))},Re=h.__private__.getArrayBuffer=function(w){for(var U=w.length,se=new ArrayBuffer(U),pe=new Uint8Array(se);U--;)pe[U]=w.charCodeAt(U);return se},ot=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return ot};var ze=e.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(w){return ze=C===A?w/pt:w,this};var lt,Qe=h.__private__.getFontSize=h.getFontSize=function(){return C===E?ze:ze*pt},jt=e.R2L||!1;h.__private__.setR2L=h.setR2L=function(w){return jt=w,this},h.__private__.getR2L=h.getR2L=function(){return jt};var ft,Ot=h.__private__.setZoomMode=function(w){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(w))lt=w;else if(isNaN(w)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(w)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+w+'" is not recognized.');lt=w}else lt=parseInt(w,10)};h.__private__.getZoomMode=function(){return lt};var Fe,Xe=h.__private__.setPageMode=function(w){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(w)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+w+'" is not recognized.');ft=w};h.__private__.getPageMode=function(){return ft};var At=h.__private__.setLayoutMode=function(w){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(w)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+w+'" is not recognized.');Fe=w};h.__private__.getLayoutMode=function(){return Fe},h.__private__.setDisplayMode=h.setDisplayMode=function(w,U,se){return Ot(w),At(U),Xe(se),this};var xt={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(w){if(Object.keys(xt).indexOf(w)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return xt[w]},h.__private__.getDocumentProperties=function(){return xt},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(w){for(var U in xt)xt.hasOwnProperty(U)&&w[U]&&(xt[U]=w[U]);return this},h.__private__.setDocumentProperty=function(w,U){if(Object.keys(xt).indexOf(w)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return xt[w]=U};var st,pt,dt,Qt,$t,mt={},Tt={},er=[],Pe={},tt={},bt={},Xt={},wr=null,Wt=0,_t=[],Ut=new F_(h),ir=e.hotfixes||[],Dr={},dn={},Cn=[],Et=function w(U,se,pe,_e,Be,He){if(!(this instanceof w))return new w(U,se,pe,_e,Be,He);isNaN(U)&&(U=1),isNaN(se)&&(se=0),isNaN(pe)&&(pe=0),isNaN(_e)&&(_e=1),isNaN(Be)&&(Be=0),isNaN(He)&&(He=0),this._matrix=[U,se,pe,_e,Be,He]};Object.defineProperty(Et.prototype,"sx",{get:function(){return this._matrix[0]},set:function(w){this._matrix[0]=w}}),Object.defineProperty(Et.prototype,"shy",{get:function(){return this._matrix[1]},set:function(w){this._matrix[1]=w}}),Object.defineProperty(Et.prototype,"shx",{get:function(){return this._matrix[2]},set:function(w){this._matrix[2]=w}}),Object.defineProperty(Et.prototype,"sy",{get:function(){return this._matrix[3]},set:function(w){this._matrix[3]=w}}),Object.defineProperty(Et.prototype,"tx",{get:function(){return this._matrix[4]},set:function(w){this._matrix[4]=w}}),Object.defineProperty(Et.prototype,"ty",{get:function(){return this._matrix[5]},set:function(w){this._matrix[5]=w}}),Object.defineProperty(Et.prototype,"a",{get:function(){return this._matrix[0]},set:function(w){this._matrix[0]=w}}),Object.defineProperty(Et.prototype,"b",{get:function(){return this._matrix[1]},set:function(w){this._matrix[1]=w}}),Object.defineProperty(Et.prototype,"c",{get:function(){return this._matrix[2]},set:function(w){this._matrix[2]=w}}),Object.defineProperty(Et.prototype,"d",{get:function(){return this._matrix[3]},set:function(w){this._matrix[3]=w}}),Object.defineProperty(Et.prototype,"e",{get:function(){return this._matrix[4]},set:function(w){this._matrix[4]=w}}),Object.defineProperty(Et.prototype,"f",{get:function(){return this._matrix[5]},set:function(w){this._matrix[5]=w}}),Object.defineProperty(Et.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Et.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Et.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Et.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Et.prototype.join=function(w){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(I).join(w)},Et.prototype.multiply=function(w){var U=w.sx*this.sx+w.shy*this.shx,se=w.sx*this.shy+w.shy*this.sy,pe=w.shx*this.sx+w.sy*this.shx,_e=w.shx*this.shy+w.sy*this.sy,Be=w.tx*this.sx+w.ty*this.shx+this.tx,He=w.tx*this.shy+w.ty*this.sy+this.ty;return new Et(U,se,pe,_e,Be,He)},Et.prototype.decompose=function(){var w=this.sx,U=this.shy,se=this.shx,pe=this.sy,_e=this.tx,Be=this.ty,He=Math.sqrt(w*w+U*U),gt=(w/=He)*se+(U/=He)*pe;se-=w*gt,pe-=U*gt;var wt=Math.sqrt(se*se+pe*pe);return gt/=wt,w*(pe/=wt)<U*(se/=wt)&&(w=-w,U=-U,gt=-gt,He=-He),{scale:new Et(He,0,0,wt,0,0),translate:new Et(1,0,0,1,_e,Be),rotate:new Et(w,U,-U,w,0,0),skew:new Et(1,0,gt,1,0,0)}},Et.prototype.toString=function(w){return this.join(" ")},Et.prototype.inversed=function(){var w=this.sx,U=this.shy,se=this.shx,pe=this.sy,_e=this.tx,Be=this.ty,He=1/(w*pe-U*se),gt=pe*He,wt=-U*He,kt=-se*He,It=w*He;return new Et(gt,wt,kt,It,-gt*_e-kt*Be,-wt*_e-It*Be)},Et.prototype.applyToPoint=function(w){var U=w.x*this.sx+w.y*this.shx+this.tx,se=w.x*this.shy+w.y*this.sy+this.ty;return new el(U,se)},Et.prototype.applyToRectangle=function(w){var U=this.applyToPoint(w),se=this.applyToPoint(new el(w.x+w.w,w.y+w.h));return new Pu(U.x,U.y,se.x-U.x,se.y-U.y)},Et.prototype.clone=function(){var w=this.sx,U=this.shy,se=this.shx,pe=this.sy,_e=this.tx,Be=this.ty;return new Et(w,U,se,pe,_e,Be)},h.Matrix=Et;var yi=h.matrixMult=function(w,U){return U.multiply(w)},bi=new Et(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=bi;var Vn=function(w,U){if(!tt[w]){var se=(U instanceof hl?"Sh":"P")+(Object.keys(Pe).length+1).toString(10);U.id=se,tt[w]=se,Pe[se]=U,Ut.publish("addPattern",U)}};h.ShadingPattern=hl,h.TilingPattern=Pc,h.addShadingPattern=function(w,U){return P("addShadingPattern()"),Vn(w,U),this},h.beginTilingPattern=function(w){P("beginTilingPattern()"),ku(w.boundingBox[0],w.boundingBox[1],w.boundingBox[2]-w.boundingBox[0],w.boundingBox[3]-w.boundingBox[1],w.matrix)},h.endTilingPattern=function(w,U){P("endTilingPattern()"),U.stream=ue[L].join(`
`),Vn(w,U),Ut.publish("endTilingPattern",U),Cn.pop().restore()};var xa,Cr=h.__private__.newObject=function(){var w=rn();return q(w,!0),w},rn=h.__private__.newObjectDeferred=function(){return X++,de[X]=function(){return Y},X},q=function(w,U){return U=typeof U=="boolean"&&U,de[w]=Y,U&&te(w+" 0 obj"),w},ae=h.__private__.newAdditionalObject=function(){var w={objId:rn(),content:""};return oe.push(w),w},Z=rn(),ee=rn(),ie=h.__private__.decodeColorString=function(w){var U=w.split(" ");if(U.length!==2||U[1]!=="g"&&U[1]!=="G")U.length!==5||U[4]!=="k"&&U[4]!=="K"||(U=[(1-U[0])*(1-U[3]),(1-U[1])*(1-U[3]),(1-U[2])*(1-U[3]),"r"]);else{var se=parseFloat(U[0]);U=[se,se,se,"r"]}for(var pe="#",_e=0;_e<3;_e++)pe+=("0"+Math.floor(255*parseFloat(U[_e])).toString(16)).slice(-2);return pe},ce=h.__private__.encodeColorString=function(w){var U;typeof w=="string"&&(w={ch1:w});var se=w.ch1,pe=w.ch2,_e=w.ch3,Be=w.ch4,He=w.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof se=="string"&&se.charAt(0)!=="#"){var gt=new hj(se);if(gt.ok)se=gt.toHex();else if(!/^\d*\.?\d*$/.test(se))throw new Error('Invalid color "'+se+'" passed to jsPDF.encodeColorString.')}if(typeof se=="string"&&/^#[0-9A-Fa-f]{3}$/.test(se)&&(se="#"+se[1]+se[1]+se[2]+se[2]+se[3]+se[3]),typeof se=="string"&&/^#[0-9A-Fa-f]{6}$/.test(se)){var wt=parseInt(se.substr(1),16);se=wt>>16&255,pe=wt>>8&255,_e=255&wt}if(pe===void 0||Be===void 0&&se===pe&&pe===_e)U=typeof se=="string"?se+" "+He[0]:w.precision===2?T(se/255)+" "+He[0]:j(se/255)+" "+He[0];else if(Be===void 0||fr(Be)==="object"){if(Be&&!isNaN(Be.a)&&Be.a===0)return["1.","1.","1.",He[1]].join(" ");U=typeof se=="string"?[se,pe,_e,He[1]].join(" "):w.precision===2?[T(se/255),T(pe/255),T(_e/255),He[1]].join(" "):[j(se/255),j(pe/255),j(_e/255),He[1]].join(" ")}else U=typeof se=="string"?[se,pe,_e,Be,He[2]].join(" "):w.precision===2?[T(se),T(pe),T(_e),T(Be),He[2]].join(" "):[j(se),j(pe),j(_e),j(Be),He[2]].join(" ");return U},Se=h.__private__.getFilters=function(){return s},Le=h.__private__.putStream=function(w){var U=(w=w||{}).data||"",se=w.filters||Se(),pe=w.alreadyAppliedFilters||[],_e=w.addLength1||!1,Be=U.length,He=w.objectId,gt=function(hn){return hn};if(f!==null&&He===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");f!==null&&(gt=Hr.encryptor(He,0));var wt={};se===!0&&(se=["FlateEncode"]);var kt=w.additionalKeyValues||[],It=(wt=St.API.processDataByFilters!==void 0?St.API.processDataByFilters(U,se):{data:U,reverseChain:[]}).reverseChain+(Array.isArray(pe)?pe.join(" "):pe.toString());if(wt.data.length!==0&&(kt.push({key:"Length",value:wt.data.length}),_e===!0&&kt.push({key:"Length1",value:Be})),It.length!=0)if(It.split("/").length-1==1)kt.push({key:"Filter",value:It});else{kt.push({key:"Filter",value:"["+It+"]"});for(var tr=0;tr<kt.length;tr+=1)if(kt[tr].key==="DecodeParms"){for(var Ir=[],an=0;an<wt.reverseChain.split("/").length-1;an+=1)Ir.push("null");Ir.push(kt[tr].value),kt[tr].value="["+Ir.join(" ")+"]"}}te("<<");for(var mr=0;mr<kt.length;mr++)te("/"+kt[mr].key+" "+kt[mr].value);te(">>"),wt.data.length!==0&&(te("stream"),te(gt(wt.data)),te("endstream"))},Ae=h.__private__.putPage=function(w){var U=w.number,se=w.data,pe=w.objId,_e=w.contentsObjId;q(pe,!0),te("<</Type /Page"),te("/Parent "+w.rootDictionaryObjId+" 0 R"),te("/Resources "+w.resourceDictionaryObjId+" 0 R"),te("/MediaBox ["+parseFloat(I(w.mediaBox.bottomLeftX))+" "+parseFloat(I(w.mediaBox.bottomLeftY))+" "+I(w.mediaBox.topRightX)+" "+I(w.mediaBox.topRightY)+"]"),w.cropBox!==null&&te("/CropBox ["+I(w.cropBox.bottomLeftX)+" "+I(w.cropBox.bottomLeftY)+" "+I(w.cropBox.topRightX)+" "+I(w.cropBox.topRightY)+"]"),w.bleedBox!==null&&te("/BleedBox ["+I(w.bleedBox.bottomLeftX)+" "+I(w.bleedBox.bottomLeftY)+" "+I(w.bleedBox.topRightX)+" "+I(w.bleedBox.topRightY)+"]"),w.trimBox!==null&&te("/TrimBox ["+I(w.trimBox.bottomLeftX)+" "+I(w.trimBox.bottomLeftY)+" "+I(w.trimBox.topRightX)+" "+I(w.trimBox.topRightY)+"]"),w.artBox!==null&&te("/ArtBox ["+I(w.artBox.bottomLeftX)+" "+I(w.artBox.bottomLeftY)+" "+I(w.artBox.topRightX)+" "+I(w.artBox.topRightY)+"]"),typeof w.userUnit=="number"&&w.userUnit!==1&&te("/UserUnit "+w.userUnit),Ut.publish("putPage",{objId:pe,pageContext:_t[U],pageNumber:U,page:se}),te("/Contents "+_e+" 0 R"),te(">>"),te("endobj");var Be=se.join(`
`);return C===A&&(Be+=`
Q`),q(_e,!0),Le({data:Be,filters:Se(),objectId:_e}),te("endobj"),pe},Ee=h.__private__.putPages=function(){var w,U,se=[];for(w=1;w<=Wt;w++)_t[w].objId=rn(),_t[w].contentsObjId=rn();for(w=1;w<=Wt;w++)se.push(Ae({number:w,data:ue[w],objId:_t[w].objId,contentsObjId:_t[w].contentsObjId,mediaBox:_t[w].mediaBox,cropBox:_t[w].cropBox,bleedBox:_t[w].bleedBox,trimBox:_t[w].trimBox,artBox:_t[w].artBox,userUnit:_t[w].userUnit,rootDictionaryObjId:Z,resourceDictionaryObjId:ee}));q(Z,!0),te("<</Type /Pages");var pe="/Kids [";for(U=0;U<Wt;U++)pe+=se[U]+" 0 R ";te(pe+"]"),te("/Count "+Wt),te(">>"),te("endobj"),Ut.publish("postPutPages")},Ce=function(w){Ut.publish("putFont",{font:w,out:te,newObject:Cr,putStream:Le}),w.isAlreadyPutted!==!0&&(w.objectNumber=Cr(),te("<<"),te("/Type /Font"),te("/BaseFont /"+Nc(w.postScriptName)),te("/Subtype /Type1"),typeof w.encoding=="string"&&te("/Encoding /"+w.encoding),te("/FirstChar 32"),te("/LastChar 255"),te(">>"),te("endobj"))},Ge=function(w){w.objectNumber=Cr();var U=[];U.push({key:"Type",value:"/XObject"}),U.push({key:"Subtype",value:"/Form"}),U.push({key:"BBox",value:"["+[I(w.x),I(w.y),I(w.x+w.width),I(w.y+w.height)].join(" ")+"]"}),U.push({key:"Matrix",value:"["+w.matrix.toString()+"]"});var se=w.pages[1].join(`
`);Le({data:se,additionalKeyValues:U,objectId:w.objectNumber}),te("endobj")},Ze=function(w,U){U||(U=21);var se=Cr(),pe=function(He,gt){var wt,kt=[],It=1/(gt-1);for(wt=0;wt<1;wt+=It)kt.push(wt);if(kt.push(1),He[0].offset!=0){var tr={offset:0,color:He[0].color};He.unshift(tr)}if(He[He.length-1].offset!=1){var Ir={offset:1,color:He[He.length-1].color};He.push(Ir)}for(var an="",mr=0,hn=0;hn<kt.length;hn++){for(wt=kt[hn];wt>He[mr+1].offset;)mr++;var sn=He[mr].offset,On=(wt-sn)/(He[mr+1].offset-sn),gs=He[mr].color,eo=He[mr+1].color;an+=R(Math.round((1-On)*gs[0]+On*eo[0]).toString(16))+R(Math.round((1-On)*gs[1]+On*eo[1]).toString(16))+R(Math.round((1-On)*gs[2]+On*eo[2]).toString(16))}return an.trim()}(w.colors,U),_e=[];_e.push({key:"FunctionType",value:"0"}),_e.push({key:"Domain",value:"[0.0 1.0]"}),_e.push({key:"Size",value:"["+U+"]"}),_e.push({key:"BitsPerSample",value:"8"}),_e.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),_e.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Le({data:pe,additionalKeyValues:_e,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:se}),te("endobj"),w.objectNumber=Cr(),te("<< /ShadingType "+w.type),te("/ColorSpace /DeviceRGB");var Be="/Coords ["+I(parseFloat(w.coords[0]))+" "+I(parseFloat(w.coords[1]))+" ";w.type===2?Be+=I(parseFloat(w.coords[2]))+" "+I(parseFloat(w.coords[3])):Be+=I(parseFloat(w.coords[2]))+" "+I(parseFloat(w.coords[3]))+" "+I(parseFloat(w.coords[4]))+" "+I(parseFloat(w.coords[5])),te(Be+="]"),w.matrix&&te("/Matrix ["+w.matrix.toString()+"]"),te("/Function "+se+" 0 R"),te("/Extend [true true]"),te(">>"),te("endobj")},it=function(w,U){var se=rn(),pe=Cr();U.push({resourcesOid:se,objectOid:pe}),w.objectNumber=pe;var _e=[];_e.push({key:"Type",value:"/Pattern"}),_e.push({key:"PatternType",value:"1"}),_e.push({key:"PaintType",value:"1"}),_e.push({key:"TilingType",value:"1"}),_e.push({key:"BBox",value:"["+w.boundingBox.map(I).join(" ")+"]"}),_e.push({key:"XStep",value:I(w.xStep)}),_e.push({key:"YStep",value:I(w.yStep)}),_e.push({key:"Resources",value:se+" 0 R"}),w.matrix&&_e.push({key:"Matrix",value:"["+w.matrix.toString()+"]"}),Le({data:w.stream,additionalKeyValues:_e,objectId:w.objectNumber}),te("endobj")},Ye=function(w){for(var U in w.objectNumber=Cr(),te("<<"),w)switch(U){case"opacity":te("/ca "+T(w[U]));break;case"stroke-opacity":te("/CA "+T(w[U]))}te(">>"),te("endobj")},at=function(w){q(w.resourcesOid,!0),te("<<"),te("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var U in te("/Font <<"),mt)mt.hasOwnProperty(U)&&(d===!1||d===!0&&p.hasOwnProperty(U))&&te("/"+U+" "+mt[U].objectNumber+" 0 R");te(">>")}(),function(){if(Object.keys(Pe).length>0){for(var U in te("/Shading <<"),Pe)Pe.hasOwnProperty(U)&&Pe[U]instanceof hl&&Pe[U].objectNumber>=0&&te("/"+U+" "+Pe[U].objectNumber+" 0 R");Ut.publish("putShadingPatternDict"),te(">>")}}(),function(U){if(Object.keys(Pe).length>0){for(var se in te("/Pattern <<"),Pe)Pe.hasOwnProperty(se)&&Pe[se]instanceof h.TilingPattern&&Pe[se].objectNumber>=0&&Pe[se].objectNumber<U&&te("/"+se+" "+Pe[se].objectNumber+" 0 R");Ut.publish("putTilingPatternDict"),te(">>")}}(w.objectOid),function(){if(Object.keys(bt).length>0){var U;for(U in te("/ExtGState <<"),bt)bt.hasOwnProperty(U)&&bt[U].objectNumber>=0&&te("/"+U+" "+bt[U].objectNumber+" 0 R");Ut.publish("putGStateDict"),te(">>")}}(),function(){for(var U in te("/XObject <<"),Dr)Dr.hasOwnProperty(U)&&Dr[U].objectNumber>=0&&te("/"+U+" "+Dr[U].objectNumber+" 0 R");Ut.publish("putXobjectDict"),te(">>")}(),te(">>"),te("endobj")},Pt=function(w){Tt[w.fontName]=Tt[w.fontName]||{},Tt[w.fontName][w.fontStyle]=w.id},pr=function(w,U,se,pe,_e){var Be={id:"F"+(Object.keys(mt).length+1).toString(10),postScriptName:w,fontName:U,fontStyle:se,encoding:pe,isStandardFont:_e||!1,metadata:{}};return Ut.publish("addFont",{font:Be,instance:this}),mt[Be.id]=Be,Pt(Be),Be.id},zt=h.__private__.pdfEscape=h.pdfEscape=function(w,U){return function(se,pe){var _e,Be,He,gt,wt,kt,It,tr,Ir;if(He=(pe=pe||{}).sourceEncoding||"Unicode",wt=pe.outputEncoding,(pe.autoencode||wt)&&mt[st].metadata&&mt[st].metadata[He]&&mt[st].metadata[He].encoding&&(gt=mt[st].metadata[He].encoding,!wt&&mt[st].encoding&&(wt=mt[st].encoding),!wt&&gt.codePages&&(wt=gt.codePages[0]),typeof wt=="string"&&(wt=gt[wt]),wt)){for(It=!1,kt=[],_e=0,Be=se.length;_e<Be;_e++)(tr=wt[se.charCodeAt(_e)])?kt.push(String.fromCharCode(tr)):kt.push(se[_e]),kt[_e].charCodeAt(0)>>8&&(It=!0);se=kt.join("")}for(_e=se.length;It===void 0&&_e!==0;)se.charCodeAt(_e-1)>>8&&(It=!0),_e--;if(!It)return se;for(kt=pe.noBOM?[]:[254,255],_e=0,Be=se.length;_e<Be;_e++){if((Ir=(tr=se.charCodeAt(_e))>>8)>>8)throw new Error("Character at position "+_e+" of string '"+se+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");kt.push(Ir),kt.push(tr-(Ir<<8))}return String.fromCharCode.apply(void 0,kt)}(w,U).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Mr=h.__private__.beginPage=function(w){ue[++Wt]=[],_t[Wt]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(w[0]),topRightY:Number(w[1])}},qi(Wt),xe(ue[L])},zi=function(w,U){var se,pe,_e;switch(r=U||r,typeof w=="string"&&(se=b(w.toLowerCase()),Array.isArray(se)&&(pe=se[0],_e=se[1])),Array.isArray(w)&&(pe=w[0]*pt,_e=w[1]*pt),isNaN(pe)&&(pe=a[0],_e=a[1]),(pe>14400||_e>14400)&&(vr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),pe=Math.min(14400,pe),_e=Math.min(14400,_e)),a=[pe,_e],r.substr(0,1)){case"l":_e>pe&&(a=[_e,pe]);break;case"p":pe>_e&&(a=[_e,pe])}Mr(a),Jp(Au),te(Ql),ju!==0&&te(ju+" J"),Tu!==0&&te(Tu+" j"),Ut.publish("addPage",{pageNumber:Wt})},wi=function(w){w>0&&w<=Wt&&(ue.splice(w,1),_t.splice(w,1),Wt--,L>Wt&&(L=Wt),this.setPage(L))},qi=function(w){w>0&&w<=Wt&&(L=w)},ei=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return ue.length-1},Zs=function(w,U,se){var pe,_e=void 0;return se=se||{},w=w!==void 0?w:mt[st].fontName,U=U!==void 0?U:mt[st].fontStyle,pe=w.toLowerCase(),Tt[pe]!==void 0&&Tt[pe][U]!==void 0?_e=Tt[pe][U]:Tt[w]!==void 0&&Tt[w][U]!==void 0?_e=Tt[w][U]:se.disableWarning===!1&&vr.warn("Unable to look up font label for font '"+w+"', '"+U+"'. Refer to getFontList() for available fonts."),_e||se.noFallback||(_e=Tt.times[U])==null&&(_e=Tt.times.normal),_e},Kn=h.__private__.putInfo=function(){var w=Cr(),U=function(pe){return pe};for(var se in f!==null&&(U=Hr.encryptor(w,0)),te("<<"),te("/Producer ("+zt(U("jsPDF "+St.version))+")"),xt)xt.hasOwnProperty(se)&&xt[se]&&te("/"+se.substr(0,1).toUpperCase()+se.substr(1)+" ("+zt(U(xt[se]))+")");te("/CreationDate ("+zt(U(he))+")"),te(">>"),te("endobj")},Wp=h.__private__.putCatalog=function(w){var U=(w=w||{}).rootDictionaryObjId||Z;switch(Cr(),te("<<"),te("/Type /Catalog"),te("/Pages "+U+" 0 R"),lt||(lt="fullwidth"),lt){case"fullwidth":te("/OpenAction [3 0 R /FitH null]");break;case"fullheight":te("/OpenAction [3 0 R /FitV null]");break;case"fullpage":te("/OpenAction [3 0 R /Fit]");break;case"original":te("/OpenAction [3 0 R /XYZ null null 1]");break;default:var se=""+lt;se.substr(se.length-1)==="%"&&(lt=parseInt(lt)/100),typeof lt=="number"&&te("/OpenAction [3 0 R /XYZ null null "+T(lt)+"]")}switch(Fe||(Fe="continuous"),Fe){case"continuous":te("/PageLayout /OneColumn");break;case"single":te("/PageLayout /SinglePage");break;case"two":case"twoleft":te("/PageLayout /TwoColumnLeft");break;case"tworight":te("/PageLayout /TwoColumnRight")}ft&&te("/PageMode /"+ft),Ut.publish("putCatalog"),te(">>"),te("endobj")},nn=h.__private__.putTrailer=function(){te("trailer"),te("<<"),te("/Size "+(X+1)),te("/Root "+X+" 0 R"),te("/Info "+(X-1)+" 0 R"),f!==null&&te("/Encrypt "+Hr.oid+" 0 R"),te("/ID [ <"+be+"> <"+be+"> ]"),te(">>")},N0=h.__private__.putHeader=function(){te("%PDF-"+x),te("%¬∫√ü¬¨√†")},S0=h.__private__.putXRef=function(){var w="0000000000";te("xref"),te("0 "+(X+1)),te("0000000000 65535 f ");for(var U=1;U<=X;U++)typeof de[U]=="function"?te((w+de[U]()).slice(-10)+" 00000 n "):de[U]!==void 0?te((w+de[U]).slice(-10)+" 00000 n "):te("0000000000 00000 n ")},hs=h.__private__.buildDocument=function(){var w;X=0,Y=0,me=[],de=[],oe=[],Z=rn(),ee=rn(),xe(me),Ut.publish("buildDocument"),N0(),Ee(),function(){Ut.publish("putAdditionalObjects");for(var se=0;se<oe.length;se++){var pe=oe[se];q(pe.objId,!0),te(pe.content),te("endobj")}Ut.publish("postPutAdditionalObjects")}(),w=[],function(){for(var se in mt)mt.hasOwnProperty(se)&&(d===!1||d===!0&&p.hasOwnProperty(se))&&Ce(mt[se])}(),function(){var se;for(se in bt)bt.hasOwnProperty(se)&&Ye(bt[se])}(),function(){for(var se in Dr)Dr.hasOwnProperty(se)&&Ge(Dr[se])}(),function(se){var pe;for(pe in Pe)Pe.hasOwnProperty(pe)&&(Pe[pe]instanceof hl?Ze(Pe[pe]):Pe[pe]instanceof Pc&&it(Pe[pe],se))}(w),Ut.publish("putResources"),w.forEach(at),at({resourcesOid:ee,objectOid:Number.MAX_SAFE_INTEGER}),Ut.publish("postPutResources"),f!==null&&(Hr.oid=Cr(),te("<<"),te("/Filter /Standard"),te("/V "+Hr.v),te("/R "+Hr.r),te("/U <"+Hr.toHexString(Hr.U)+">"),te("/O <"+Hr.toHexString(Hr.O)+">"),te("/P "+Hr.P),te(">>"),te("endobj")),Kn(),Wp();var U=Y;return S0(),nn(),te("startxref"),te(""+U),te("%%EOF"),xe(ue[L]),me.join(`
`)},Ko=h.__private__.getBlob=function(w){return new Blob([Re(w)],{type:"application/pdf"})},_i=h.output=h.__private__.output=(xa=function(w,U){switch(typeof(U=U||{})=="string"?U={filename:U}:U.filename=U.filename||"generated.pdf",w){case void 0:return hs();case"save":h.save(U.filename);break;case"arraybuffer":return Re(hs());case"blob":return Ko(hs());case"bloburi":case"bloburl":if(Ct.URL!==void 0&&typeof Ct.URL.createObjectURL=="function")return Ct.URL&&Ct.URL.createObjectURL(Ko(hs()))||void 0;vr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var se="",pe=hs();try{se=C_(pe)}catch{se=C_(unescape(encodeURIComponent(pe)))}return"data:application/pdf;filename="+U.filename+";base64,"+se;case"pdfobjectnewwindow":if(Object.prototype.toString.call(Ct)==="[object Window]"){var _e="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Be=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';U.pdfObjectUrl&&(_e=U.pdfObjectUrl,Be="");var He='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+_e+'"'+Be+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(U)+");<\/script></body></html>",gt=Ct.open();return gt!==null&&gt.document.write(He),gt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(Ct)==="[object Window]"){var wt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(U.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+U.filename+'" width="500px" height="400px" /></body></html>',kt=Ct.open();if(kt!==null){kt.document.write(wt);var It=this;kt.document.documentElement.querySelector("#pdfViewer").onload=function(){kt.document.title=U.filename,kt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(It.output("bloburl"))}}return kt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(Ct)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var tr='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",U)+'"></iframe></body></html>',Ir=Ct.open();if(Ir!==null&&(Ir.document.write(tr),Ir.document.title=U.filename),Ir||typeof safari>"u")return Ir;break;case"datauri":case"dataurl":return Ct.document.location.href=this.output("datauristring",U);default:return null}},xa.foo=function(){try{return xa.apply(this,arguments)}catch(se){var w=se.stack||"";~w.indexOf(" at ")&&(w=w.split(" at ")[1]);var U="Error in function "+w.split(`
`)[0].split("<")[0]+": "+se.message;if(!Ct.console)throw new Error(U);Ct.console.error(U,se),Ct.alert&&alert(U)}},xa.foo.bar=xa,xa.foo),Yo=function(w){return Array.isArray(ir)===!0&&ir.indexOf(w)>-1};switch(n){case"pt":pt=1;break;case"mm":pt=72/25.4;break;case"cm":pt=72/2.54;break;case"in":pt=72;break;case"px":pt=Yo("px_scaling")==1?.75:96/72;break;case"pc":case"em":pt=12;break;case"ex":pt=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);pt=n}var Hr=null;ve(),Q();var _u=h.__private__.getPageInfo=h.getPageInfo=function(w){if(isNaN(w)||w%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:_t[w].objId,pageNumber:w,pageContext:_t[w]}},Hp=h.__private__.getPageInfoByObjId=function(w){if(isNaN(w)||w%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var U in _t)if(_t[U].objId===w)break;return _u(U)},Gp=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:_t[L].objId,pageNumber:L,pageContext:_t[L]}};h.addPage=function(){return zi.apply(this,arguments),this},h.setPage=function(){return qi.apply(this,arguments),xe.call(this,ue[L]),this},h.insertPage=function(w){return this.addPage(),this.movePage(L,w),this},h.movePage=function(w,U){var se,pe;if(w>U){se=ue[w],pe=_t[w];for(var _e=w;_e>U;_e--)ue[_e]=ue[_e-1],_t[_e]=_t[_e-1];ue[U]=se,_t[U]=pe,this.setPage(U)}else if(w<U){se=ue[w],pe=_t[w];for(var Be=w;Be<U;Be++)ue[Be]=ue[Be+1],_t[Be]=_t[Be+1];ue[U]=se,_t[U]=pe,this.setPage(U)}return this},h.deletePage=function(){return wi.apply(this,arguments),this},h.__private__.text=h.text=function(w,U,se,pe,_e){var Be,He,gt,wt,kt,It,tr,Ir,an,mr=(pe=pe||{}).scope||this;if(typeof w=="number"&&typeof U=="number"&&(typeof se=="string"||Array.isArray(se))){var hn=se;se=U,U=w,w=hn}if(arguments[3]instanceof Et==0?(gt=arguments[4],wt=arguments[5],fr(tr=arguments[3])==="object"&&tr!==null||(typeof gt=="string"&&(wt=gt,gt=null),typeof tr=="string"&&(wt=tr,tr=null),typeof tr=="number"&&(gt=tr,tr=null),pe={flags:tr,angle:gt,align:wt})):(P("The transform parameter of text() with a Matrix value"),an=_e),isNaN(U)||isNaN(se)||w==null)throw new Error("Invalid arguments passed to jsPDF.text");if(w.length===0)return mr;var sn,On="",gs=typeof pe.lineHeightFactor=="number"?pe.lineHeightFactor:Zo,eo=mr.internal.scaleFactor;function im(_r){return _r=_r.split("	").join(Array(pe.TabLen||9).join(" ")),zt(_r,tr)}function j0(_r){for(var Nr,Vr=_r.concat(),Kr=[],bs=Vr.length;bs--;)typeof(Nr=Vr.shift())=="string"?Kr.push(Nr):Array.isArray(_r)&&(Nr.length===1||Nr[1]===void 0&&Nr[2]===void 0)?Kr.push(Nr[0]):Kr.push([Nr[0],Nr[1],Nr[2]]);return Kr}function rl(_r,Nr){var Vr;if(typeof _r=="string")Vr=Nr(_r)[0];else if(Array.isArray(_r)){for(var Kr,bs,uc=_r.concat(),Xi=[],Uu=uc.length;Uu--;)typeof(Kr=uc.shift())=="string"?Xi.push(Nr(Kr)[0]):Array.isArray(Kr)&&typeof Kr[0]=="string"&&(bs=Nr(Kr[0],Kr[1],Kr[2]),Xi.push([bs[0],bs[1],bs[2]]));Vr=Xi}return Vr}var Ni=!1,Lu=!0;if(typeof w=="string")Ni=!0;else if(Array.isArray(w)){var nc=w.concat();He=[];for(var to,_n=nc.length;_n--;)(typeof(to=nc.shift())!="string"||Array.isArray(to)&&typeof to[0]!="string")&&(Lu=!1);Ni=Lu}if(Ni===!1)throw new Error('Type of text must be string or Array. "'+w+'" is not recognized.');typeof w=="string"&&(w=w.match(/[\r?\n]/)?w.split(/\r\n|\r|\n/g):[w]);var xs=ze/mr.internal.scaleFactor,vs=xs*(gs-1);switch(pe.baseline){case"bottom":se-=vs;break;case"top":se+=xs-vs;break;case"hanging":se+=xs-2*vs;break;case"middle":se+=xs/2-vs}if((It=pe.maxWidth||0)>0&&(typeof w=="string"?w=mr.splitTextToSize(w,It):Object.prototype.toString.call(w)==="[object Array]"&&(w=w.reduce(function(_r,Nr){return _r.concat(mr.splitTextToSize(Nr,It))},[]))),Be={text:w,x:U,y:se,options:pe,mutex:{pdfEscape:zt,activeFontKey:st,fonts:mt,activeFontSize:ze}},Ut.publish("preProcessText",Be),w=Be.text,gt=(pe=Be.options).angle,an instanceof Et==0&&gt&&typeof gt=="number"){gt*=Math.PI/180,pe.rotationDirection===0&&(gt=-gt),C===A&&(gt=-gt);var ac=Math.cos(gt),Fu=Math.sin(gt);an=new Et(ac,Fu,-Fu,ac,0,0)}else gt&&gt instanceof Et&&(an=gt);C!==A||an||(an=bi),(kt=pe.charSpace||tc)!==void 0&&(On+=I(z(kt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Ir=pe.horizontalScale)!==void 0&&(On+=I(100*Ir)+` Tz
`),pe.lang;var oa=-1,T0=pe.renderingMode!==void 0?pe.renderingMode:pe.stroke,ic=mr.internal.getCurrentPageInfo().pageContext;switch(T0){case 0:case!1:case"fill":oa=0;break;case 1:case!0:case"stroke":oa=1;break;case 2:case"fillThenStroke":oa=2;break;case 3:case"invisible":oa=3;break;case 4:case"fillAndAddForClipping":oa=4;break;case 5:case"strokeAndAddPathForClipping":oa=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":oa=6;break;case 7:case"addToPathForClipping":oa=7}var P0=ic.usedRenderingMode!==void 0?ic.usedRenderingMode:-1;oa!==-1?On+=oa+` Tr
`:P0!==-1&&(On+=`0 Tr
`),oa!==-1&&(ic.usedRenderingMode=oa),wt=pe.align||"left";var pn,ti=ze*gs,Du=mr.internal.pageSize.getWidth(),Iu=mt[st];kt=pe.charSpace||tc,It=pe.maxWidth||0,tr=Object.assign({autoencode:!0,noBOM:!0},pe.flags);var ro=[],sc=function(_r){return mr.getStringUnitWidth(_r,{font:Iu,charSpace:kt,fontSize:ze,doKerning:!1})*ze/eo};if(Object.prototype.toString.call(w)==="[object Array]"){var va;He=j0(w),wt!=="left"&&(pn=He.map(sc));var ya,nl=0;if(wt==="right"){U-=pn[0],w=[],_n=He.length;for(var Gi=0;Gi<_n;Gi++)Gi===0?(ya=ps(U),va=ms(se)):(ya=z(nl-pn[Gi]),va=-ti),w.push([He[Gi],ya,va]),nl=pn[Gi]}else if(wt==="center"){U-=pn[0]/2,w=[],_n=He.length;for(var no=0;no<_n;no++)no===0?(ya=ps(U),va=ms(se)):(ya=z((nl-pn[no])/2),va=-ti),w.push([He[no],ya,va]),nl=pn[no]}else if(wt==="left"){w=[],_n=He.length;for(var Mu=0;Mu<_n;Mu++)w.push(He[Mu])}else if(wt==="justify"&&Iu.encoding==="Identity-H"){w=[],_n=He.length,It=It!==0?It:Du;for(var ao=0,Gr=0;Gr<_n;Gr++)if(va=Gr===0?ms(se):-ti,ya=Gr===0?ps(U):ao,Gr<_n-1){var sm=z((It-pn[Gr])/(He[Gr].split(" ").length-1)),Vi=He[Gr].split(" ");w.push([Vi[0]+" ",ya,va]),ao=0;for(var Ki=1;Ki<Vi.length;Ki++){var oc=(sc(Vi[Ki-1]+" "+Vi[Ki])-sc(Vi[Ki]))*eo+sm;Ki==Vi.length-1?w.push([Vi[Ki],oc,0]):w.push([Vi[Ki]+" ",oc,0]),ao-=oc}}else w.push([He[Gr],ya,va]);w.push(["",ao,0])}else{if(wt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(w=[],_n=He.length,It=It!==0?It:Du,Gr=0;Gr<_n;Gr++)va=Gr===0?ms(se):-ti,ya=Gr===0?ps(U):0,Gr<_n-1?ro.push(I(z((It-pn[Gr])/(He[Gr].split(" ").length-1)))):ro.push(0),w.push([He[Gr],ya,va])}}(typeof pe.R2L=="boolean"?pe.R2L:jt)===!0&&(w=rl(w,function(_r,Nr,Vr){return[_r.split("").reverse().join(""),Nr,Vr]})),Be={text:w,x:U,y:se,options:pe,mutex:{pdfEscape:zt,activeFontKey:st,fonts:mt,activeFontSize:ze}},Ut.publish("postProcessText",Be),w=Be.text,sn=Be.mutex.isHex||!1;var Ru=mt[st].encoding;Ru!=="WinAnsiEncoding"&&Ru!=="StandardEncoding"||(w=rl(w,function(_r,Nr,Vr){return[im(_r),Nr,Vr]})),He=j0(w),w=[];for(var lc,cc,al,il=Array.isArray(He[0])?1:0,ys="",Bu=function(_r,Nr,Vr){var Kr="";return Vr instanceof Et?(Vr=typeof pe.angle=="number"?yi(Vr,new Et(1,0,0,1,_r,Nr)):yi(new Et(1,0,0,1,_r,Nr),Vr),C===A&&(Vr=yi(new Et(1,0,0,-1,0,0),Vr)),Kr=Vr.join(" ")+` Tm
`):Kr=I(_r)+" "+I(Nr)+` Td
`,Kr},ka=0;ka<He.length;ka++){switch(ys="",il){case 1:al=(sn?"<":"(")+He[ka][0]+(sn?">":")"),lc=parseFloat(He[ka][1]),cc=parseFloat(He[ka][2]);break;case 0:al=(sn?"<":"(")+He[ka]+(sn?">":")"),lc=ps(U),cc=ms(se)}ro!==void 0&&ro[ka]!==void 0&&(ys=ro[ka]+` Tw
`),ka===0?w.push(ys+Bu(lc,cc,an)+al):il===0?w.push(ys+al):il===1&&w.push(ys+Bu(lc,cc,an)+al)}w=il===0?w.join(` Tj
T* `):w.join(` Tj
`),w+=` Tj
`;var Yi=`BT
/`;return Yi+=st+" "+ze+` Tf
`,Yi+=I(ze*gs)+` TL
`,Yi+=Jo+`
`,Yi+=On,Yi+=w,te(Yi+="ET"),p[st]=!0,mr};var Vp=h.__private__.clip=h.clip=function(w){return te(w==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return Vp("evenodd")},h.__private__.discardPath=h.discardPath=function(){return te("n"),this};var Wi=h.__private__.isValidStyle=function(w){var U=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(w)!==-1&&(U=!0),U};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(w){return Wi(w)&&(u=w),this};var A0=h.__private__.getStyle=h.getStyle=function(w){var U=u;switch(w){case"D":case"S":U="S";break;case"F":U="f";break;case"FD":case"DF":U="B";break;case"f":case"f*":case"B":case"B*":U=w}return U},E0=h.close=function(){return te("h"),this};h.stroke=function(){return te("S"),this},h.fill=function(w){return Js("f",w),this},h.fillEvenOdd=function(w){return Js("f*",w),this},h.fillStroke=function(w){return Js("B",w),this},h.fillStrokeEvenOdd=function(w){return Js("B*",w),this};var Js=function(w,U){fr(U)==="object"?Yp(U,w):te(w)},Nu=function(w){w===null||C===A&&w===void 0||(w=A0(w),te(w))};function Kp(w,U,se,pe,_e){var Be=new Pc(U||this.boundingBox,se||this.xStep,pe||this.yStep,this.gState,_e||this.matrix);Be.stream=this.stream;var He=w+"$$"+this.cloneIndex+++"$$";return Vn(He,Be),Be}var Yp=function(w,U){var se=tt[w.key],pe=Pe[se];if(pe instanceof hl)te("q"),te(Xp(U)),pe.gState&&h.setGState(pe.gState),te(w.matrix.toString()+" cm"),te("/"+se+" sh"),te("Q");else if(pe instanceof Pc){var _e=new Et(1,0,0,-1,0,Pa());w.matrix&&(_e=_e.multiply(w.matrix||bi),se=Kp.call(pe,w.key,w.boundingBox,w.xStep,w.yStep,_e).id),te("q"),te("/Pattern cs"),te("/"+se+" scn"),pe.gState&&h.setGState(pe.gState),te(U),te("Q")}},Xp=function(w){switch(w){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Su=h.moveTo=function(w,U){return te(I(z(w))+" "+I(K(U))+" m"),this},Xo=h.lineTo=function(w,U){return te(I(z(w))+" "+I(K(U))+" l"),this},Qs=h.curveTo=function(w,U,se,pe,_e,Be){return te([I(z(w)),I(K(U)),I(z(se)),I(K(pe)),I(z(_e)),I(K(Be)),"c"].join(" ")),this};h.__private__.line=h.line=function(w,U,se,pe,_e){if(isNaN(w)||isNaN(U)||isNaN(se)||isNaN(pe)||!Wi(_e))throw new Error("Invalid arguments passed to jsPDF.line");return C===E?this.lines([[se-w,pe-U]],w,U,[1,1],_e||"S"):this.lines([[se-w,pe-U]],w,U,[1,1]).stroke()},h.__private__.lines=h.lines=function(w,U,se,pe,_e,Be){var He,gt,wt,kt,It,tr,Ir,an,mr,hn,sn,On;if(typeof w=="number"&&(On=se,se=U,U=w,w=On),pe=pe||[1,1],Be=Be||!1,isNaN(U)||isNaN(se)||!Array.isArray(w)||!Array.isArray(pe)||!Wi(_e)||typeof Be!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Su(U,se),He=pe[0],gt=pe[1],kt=w.length,hn=U,sn=se,wt=0;wt<kt;wt++)(It=w[wt]).length===2?(hn=It[0]*He+hn,sn=It[1]*gt+sn,Xo(hn,sn)):(tr=It[0]*He+hn,Ir=It[1]*gt+sn,an=It[2]*He+hn,mr=It[3]*gt+sn,hn=It[4]*He+hn,sn=It[5]*gt+sn,Qs(tr,Ir,an,mr,hn,sn));return Be&&E0(),Nu(_e),this},h.path=function(w){for(var U=0;U<w.length;U++){var se=w[U],pe=se.c;switch(se.op){case"m":Su(pe[0],pe[1]);break;case"l":Xo(pe[0],pe[1]);break;case"c":Qs.apply(this,pe);break;case"h":E0()}}return this},h.__private__.rect=h.rect=function(w,U,se,pe,_e){if(isNaN(w)||isNaN(U)||isNaN(se)||isNaN(pe)||!Wi(_e))throw new Error("Invalid arguments passed to jsPDF.rect");return C===E&&(pe=-pe),te([I(z(w)),I(K(U)),I(z(se)),I(z(pe)),"re"].join(" ")),Nu(_e),this},h.__private__.triangle=h.triangle=function(w,U,se,pe,_e,Be,He){if(isNaN(w)||isNaN(U)||isNaN(se)||isNaN(pe)||isNaN(_e)||isNaN(Be)||!Wi(He))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[se-w,pe-U],[_e-se,Be-pe],[w-_e,U-Be]],w,U,[1,1],He,!0),this},h.__private__.roundedRect=h.roundedRect=function(w,U,se,pe,_e,Be,He){if(isNaN(w)||isNaN(U)||isNaN(se)||isNaN(pe)||isNaN(_e)||isNaN(Be)||!Wi(He))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var gt=4/3*(Math.SQRT2-1);return _e=Math.min(_e,.5*se),Be=Math.min(Be,.5*pe),this.lines([[se-2*_e,0],[_e*gt,0,_e,Be-Be*gt,_e,Be],[0,pe-2*Be],[0,Be*gt,-_e*gt,Be,-_e,Be],[2*_e-se,0],[-_e*gt,0,-_e,-Be*gt,-_e,-Be],[0,2*Be-pe],[0,-Be*gt,_e*gt,-Be,_e,-Be]],w+_e,U,[1,1],He,!0),this},h.__private__.ellipse=h.ellipse=function(w,U,se,pe,_e){if(isNaN(w)||isNaN(U)||isNaN(se)||isNaN(pe)||!Wi(_e))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Be=4/3*(Math.SQRT2-1)*se,He=4/3*(Math.SQRT2-1)*pe;return Su(w+se,U),Qs(w+se,U-He,w+Be,U-pe,w,U-pe),Qs(w-Be,U-pe,w-se,U-He,w-se,U),Qs(w-se,U+He,w-Be,U+pe,w,U+pe),Qs(w+Be,U+pe,w+se,U+He,w+se,U),Nu(_e),this},h.__private__.circle=h.circle=function(w,U,se,pe){if(isNaN(w)||isNaN(U)||isNaN(se)||!Wi(pe))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(w,U,se,se,pe)},h.setFont=function(w,U,se){return se&&(U=O(U,se)),st=Zs(w,U,{disableWarning:!1}),this};var Zp=h.__private__.getFont=h.getFont=function(){return mt[Zs.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var w,U,se={};for(w in Tt)if(Tt.hasOwnProperty(w))for(U in se[w]=[],Tt[w])Tt[w].hasOwnProperty(U)&&se[w].push(U);return se},h.addFont=function(w,U,se,pe,_e){var Be=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Be.indexOf(arguments[3])!==-1?_e=arguments[3]:arguments[3]&&Be.indexOf(arguments[3])==-1&&(se=O(se,pe)),pr.call(this,w,U,se,_e=_e||"Identity-H")};var Zo,Au=e.lineWidth||.200025,Lt=h.__private__.getLineWidth=h.getLineWidth=function(){return Au},Jp=h.__private__.setLineWidth=h.setLineWidth=function(w){return Au=w,te(I(z(w))+" w"),this};h.__private__.setLineDash=St.API.setLineDash=St.API.setLineDashPattern=function(w,U){if(w=w||[],U=U||0,isNaN(U)||!Array.isArray(w))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return w=w.map(function(se){return I(z(se))}).join(" "),U=I(z(U)),te("["+w+"] "+U+" d"),this};var Qp=h.__private__.getLineHeight=h.getLineHeight=function(){return ze*Zo};h.__private__.getLineHeight=h.getLineHeight=function(){return ze*Zo};var em=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(w){return typeof(w=w||1.15)=="number"&&(Zo=w),this},tm=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return Zo};em(e.lineHeight);var ps=h.__private__.getHorizontalCoordinate=function(w){return z(w)},ms=h.__private__.getVerticalCoordinate=function(w){return C===A?w:_t[L].mediaBox.topRightY-_t[L].mediaBox.bottomLeftY-z(w)},rm=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(w){return I(ps(w))},nm=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(w){return I(ms(w))},Ql=e.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return ie(Ql)},h.__private__.setStrokeColor=h.setDrawColor=function(w,U,se,pe){return Ql=ce({ch1:w,ch2:U,ch3:se,ch4:pe,pdfColorType:"draw",precision:2}),te(Ql),this};var Eu=e.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return ie(Eu)},h.__private__.setFillColor=h.setFillColor=function(w,U,se,pe){return Eu=ce({ch1:w,ch2:U,ch3:se,ch4:pe,pdfColorType:"fill",precision:2}),te(Eu),this};var Jo=e.textColor||"0 g",ec=h.__private__.getTextColor=h.getTextColor=function(){return ie(Jo)};h.__private__.setTextColor=h.setTextColor=function(w,U,se,pe){return Jo=ce({ch1:w,ch2:U,ch3:se,ch4:pe,pdfColorType:"text",precision:3}),this};var tc=e.charSpace,am=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(tc||0)};h.__private__.setCharSpace=h.setCharSpace=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return tc=w,this};var ju=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(w){var U=h.CapJoinStyles[w];if(U===void 0)throw new Error("Line cap style of '"+w+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return ju=U,te(U+" J"),this};var Tu=0;h.__private__.setLineJoin=h.setLineJoin=function(w){var U=h.CapJoinStyles[w];if(U===void 0)throw new Error("Line join style of '"+w+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Tu=U,te(U+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(w){if(w=w||0,isNaN(w))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return te(I(z(w))+" M"),this},h.GState=Dh,h.setGState=function(w){(w=typeof w=="string"?bt[Xt[w]]:Qo(null,w)).equals(wr)||(te("/"+w.id+" gs"),wr=w)};var Qo=function(w,U){if(!w||!Xt[w]){var se=!1;for(var pe in bt)if(bt.hasOwnProperty(pe)&&bt[pe].equals(U)){se=!0;break}if(se)U=bt[pe];else{var _e="GS"+(Object.keys(bt).length+1).toString(10);bt[_e]=U,U.id=_e}return w&&(Xt[w]=U.id),Ut.publish("addGState",U),U}};h.addGState=function(w,U){return Qo(w,U),this},h.saveGraphicsState=function(){return te("q"),er.push({key:st,size:ze,color:Jo}),this},h.restoreGraphicsState=function(){te("Q");var w=er.pop();return st=w.key,ze=w.size,Jo=w.color,wr=null,this},h.setCurrentTransformationMatrix=function(w){return te(w.toString()+" cm"),this},h.comment=function(w){return te("#"+w),this};var el=function(w,U){var se=w||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return se},set:function(Be){isNaN(Be)||(se=parseFloat(Be))}});var pe=U||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return pe},set:function(Be){isNaN(Be)||(pe=parseFloat(Be))}});var _e="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return _e},set:function(Be){_e=Be.toString()}}),this},Pu=function(w,U,se,pe){el.call(this,w,U),this.type="rect";var _e=se||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return _e},set:function(He){isNaN(He)||(_e=parseFloat(He))}});var Be=pe||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Be},set:function(He){isNaN(He)||(Be=parseFloat(He))}}),this},rc=function(){this.page=Wt,this.currentPage=L,this.pages=ue.slice(0),this.pagesContext=_t.slice(0),this.x=dt,this.y=Qt,this.matrix=$t,this.width=Cu(L),this.height=Pa(L),this.outputDestination=Ue,this.id="",this.objectNumber=-1};rc.prototype.restore=function(){Wt=this.page,L=this.currentPage,_t=this.pagesContext,ue=this.pages,dt=this.x,Qt=this.y,$t=this.matrix,Ou(L,this.width),Hi(L,this.height),Ue=this.outputDestination};var ku=function(w,U,se,pe,_e){Cn.push(new rc),Wt=L=0,ue=[],dt=w,Qt=U,$t=_e,Mr([se,pe])};for(var tl in h.beginFormObject=function(w,U,se,pe,_e){return ku(w,U,se,pe,_e),this},h.endFormObject=function(w){return function(U){if(dn[U])Cn.pop().restore();else{var se=new rc,pe="Xo"+(Object.keys(Dr).length+1).toString(10);se.id=pe,dn[U]=pe,Dr[pe]=se,Ut.publish("addFormObject",se),Cn.pop().restore()}}(w),this},h.doFormObject=function(w,U){var se=Dr[dn[w]];return te("q"),te(U.toString()+" cm"),te("/"+se.id+" Do"),te("Q"),this},h.getFormObject=function(w){var U=Dr[dn[w]];return{x:U.x,y:U.y,width:U.width,height:U.height,matrix:U.matrix}},h.save=function(w,U){return w=w||"generated.pdf",(U=U||{}).returnPromise=U.returnPromise||!1,U.returnPromise===!1?(ul(Ko(hs()),w),typeof ul.unload=="function"&&Ct.setTimeout&&setTimeout(ul.unload,911),this):new Promise(function(se,pe){try{var _e=ul(Ko(hs()),w);typeof ul.unload=="function"&&Ct.setTimeout&&setTimeout(ul.unload,911),se(_e)}catch(Be){pe(Be.message)}})},St.API)St.API.hasOwnProperty(tl)&&(tl==="events"&&St.API.events.length?function(w,U){var se,pe,_e;for(_e=U.length-1;_e!==-1;_e--)se=U[_e][0],pe=U[_e][1],w.subscribe.apply(w,[se].concat(typeof pe=="function"?[pe]:pe))}(Ut,St.API.events):h[tl]=St.API[tl]);var Cu=h.getPageWidth=function(w){return(_t[w=w||L].mediaBox.topRightX-_t[w].mediaBox.bottomLeftX)/pt},Ou=h.setPageWidth=function(w,U){_t[w].mediaBox.topRightX=U*pt+_t[w].mediaBox.bottomLeftX},Pa=h.getPageHeight=function(w){return(_t[w=w||L].mediaBox.topRightY-_t[w].mediaBox.bottomLeftY)/pt},Hi=h.setPageHeight=function(w,U){_t[w].mediaBox.topRightY=U*pt+_t[w].mediaBox.bottomLeftY};return h.internal={pdfEscape:zt,getStyle:A0,getFont:Zp,getFontSize:Qe,getCharSpace:am,getTextColor:ec,getLineHeight:Qp,getLineHeightFactor:tm,getLineWidth:Lt,write:nt,getHorizontalCoordinate:ps,getVerticalCoordinate:ms,getCoordinateString:rm,getVerticalCoordinateString:nm,collections:{},newObject:Cr,newAdditionalObject:ae,newObjectDeferred:rn,newObjectDeferredBegin:q,getFilters:Se,putStream:Le,events:Ut,scaleFactor:pt,pageSize:{getWidth:function(){return Cu(L)},setWidth:function(w){Ou(L,w)},getHeight:function(){return Pa(L)},setHeight:function(w){Hi(L,w)}},encryptionOptions:f,encryption:Hr,getEncryptor:function(w){return f!==null?Hr.encryptor(w,0):function(U){return U}},output:_i,getNumberOfPages:ei,pages:ue,out:te,f2:T,f3:j,getPageInfo:_u,getPageInfoByObjId:Hp,getCurrentPageInfo:Gp,getPDFVersion:g,Point:el,Rectangle:Pu,Matrix:Et,hasHotfix:Yo},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return Cu(L)},set:function(w){Ou(L,w)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return Pa(L)},set:function(w){Hi(L,w)},enumerable:!0,configurable:!0}),(function(w){for(var U=0,se=ot.length;U<se;U++){var pe=pr.call(this,w[U][0],w[U][1],w[U][2],ot[U][3],!0);d===!1&&(p[pe]=!0);var _e=w[U][0].split("-");Pt({id:pe,fontName:_e[0],fontStyle:_e[1]||""})}Ut.publish("addFonts",{fonts:mt,dictionary:Tt})}).call(h,ot),st="F1",zi(a,r),Ut.publish("initialized"),h}_c.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},_c.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},_c.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},_c.prototype.processOwnerPassword=function(e,t){return Gg(Hg(t).substr(0,5),e)},_c.prototype.encryptor=function(e,t){var r=Hg(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return Gg(r,n)}},Dh.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||fr(e)!==fr(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},St.API={events:[]},St.version="3.0.2";var Ur=St.API,v2=1,Jl=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},vc=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Ft=function(e){return e.toFixed(2)},go=function(e){return e.toFixed(5)};Ur.__acroform__={};var Ta=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},D_=function(e){return e*v2},es=function(e){var t=new xj,r=ht.internal.getHeight(e)||0,n=ht.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Ft(n)),Number(Ft(r))],t},TZ=Ur.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},PZ=Ur.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},kZ=Ur.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},Zr=Ur.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return kZ(e,t-1)},Jr=Ur.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return TZ(e,t-1)},Qr=Ur.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return PZ(e,t-1)},CZ=Ur.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,a=e[0],i=e[1],s=e[2],o=e[3],c={};return c.lowerLeft_X=r(a)||0,c.lowerLeft_Y=n(i+o)||0,c.upperRight_X=r(a+s)||0,c.upperRight_Y=n(i)||0,[Number(Ft(c.lowerLeft_X)),Number(Ft(c.lowerLeft_Y)),Number(Ft(c.upperRight_X)),Number(Ft(c.upperRight_Y))]},OZ=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=Vg(e,r),a=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+a+" "+Ft(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var i=es(e);return i.scope=e.scope,i.stream=t.join(`
`),i}},Vg=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},a=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");a=e.multiline?a.map(function(T){return T.split(`
`)}):a.map(function(T){return[T]});var i=r,s=ht.internal.getHeight(e)||0;s=s<0?-s:s;var o=ht.internal.getWidth(e)||0;o=o<0?-o:o;var c=function(T,j,z){if(T+1<a.length){var K=j+" "+a[T+1][0];return wd(K,e,z).width<=o-4}return!1};i++;e:for(;i>0;){t="",i--;var u,f,d=wd("3",e,i).height,p=e.multiline?s-i:(s-d)/2,h=p+=2,x=0,g=0,y=0;if(i<=0){t=`(...) Tj
`,t+="% Width of Text: "+wd(t,e,i=12).width+", FieldWidth:"+o+`
`;break}for(var b="",E=0,A=0;A<a.length;A++)if(a.hasOwnProperty(A)){var C=!1;if(a[A].length!==1&&y!==a[A].length-1){if((d+2)*(E+2)+2>s)continue e;b+=a[A][y],C=!0,g=A,A--}else{b=(b+=a[A][y]+" ").substr(b.length-1)==" "?b.substr(0,b.length-1):b;var N=parseInt(A),F=c(N,b,i),O=A>=a.length-1;if(F&&!O){b+=" ",y=0;continue}if(F||O){if(O)g=N;else if(e.multiline&&(d+2)*(E+2)+2>s)continue e}else{if(!e.multiline||(d+2)*(E+2)+2>s)continue e;g=N}}for(var I="",P=x;P<=g;P++){var H=a[P];if(e.multiline){if(P===g){I+=H[y]+" ",y=(y+1)%H.length;continue}if(P===x){I+=H[H.length-1]+" ";continue}}I+=H[0]+" "}switch(I=I.substr(I.length-1)==" "?I.substr(0,I.length-1):I,f=wd(I,e,i).width,e.textAlign){case"right":u=o-f-2;break;case"center":u=(o-f)/2;break;default:u=2}t+=Ft(u)+" "+Ft(h)+` Td
`,t+="("+Jl(I)+`) Tj
`,t+=-Ft(u)+` 0 Td
`,h=-(i+2),f=0,x=C?g:g+1,E++,b=""}break}return n.text=t,n.fontSize=i,n},wd=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),a=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:a}},LZ={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},FZ=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},DZ=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(Ui.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(LZ)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");v2=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new vj,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var a in n)if(n.hasOwnProperty(a)){var i=n[a];i.objId=void 0,i.hasAnnotation&&FZ(i,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,a){var i=!n;for(var s in n||(a.internal.newObjectDeferredBegin(a.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),a.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||a.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(s)){var o=n[s],c=[],u=o.Rect;if(o.Rect&&(o.Rect=CZ(o.Rect,a)),a.internal.newObjectDeferredBegin(o.objId,!0),o.DA=ht.createDefaultAppearanceStream(o),fr(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(c=o.getKeyValueListForStream()),o.Rect=u,o.hasAppearanceStream&&!o.appearanceStreamContent){var f=OZ(o);c.push({key:"AP",value:"<</N "+f+">>"}),a.internal.acroformPlugin.xForms.push(f)}if(o.appearanceStreamContent){var d="";for(var p in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(p)){var h=o.appearanceStreamContent[p];if(d+="/"+p+" ",d+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var s in h)if(h.hasOwnProperty(s)){var x=h[s];typeof x=="function"&&(x=x.call(a,o)),d+="/"+s+" "+x+" ",a.internal.acroformPlugin.xForms.indexOf(x)>=0||a.internal.acroformPlugin.xForms.push(x)}}else typeof(x=h)=="function"&&(x=x.call(a,o)),d+="/"+s+" "+x,a.internal.acroformPlugin.xForms.indexOf(x)>=0||a.internal.acroformPlugin.xForms.push(x);d+=">>"}c.push({key:"AP",value:`<<
`+d+">>"})}a.internal.putStream({additionalKeyValues:c,objectId:o.objId}),a.internal.out("endobj")}i&&function(g,y){for(var b in g)if(g.hasOwnProperty(b)){var E=b,A=g[b];y.internal.newObjectDeferredBegin(A.objId,!0),fr(A)==="object"&&typeof A.putStream=="function"&&A.putStream(),delete g[E]}}(a.internal.acroformPlugin.xForms,a)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},gj=Ur.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(s){return s};if(Array.isArray(e)){for(var a="[",i=0;i<e.length;i++)switch(i!==0&&(a+=" "),fr(e[i])){case"boolean":case"number":case"object":a+=e[i].toString();break;case"string":e[i].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),a+="("+Jl(n(e[i].toString()))+")"):a+=e[i].toString()}return a+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},C1=function(e,t,r){var n=function(a){return a};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),"("+Jl(n(e))+")"},as=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};as.prototype.toString=function(){return this.objId+" 0 R"},as.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},as.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],a=this[n];a&&(Array.isArray(a)?e.push({key:n,value:gj(a,this.objId,this.scope)}):a instanceof as?(a.scope=this.scope,e.push({key:n,value:a.objId+" 0 R"})):typeof a!="function"&&e.push({key:n,value:a}))}return e};var xj=function(){as.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};Ta(xj,as);var vj=function(){as.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Jl(r(e))+")"}},set:function(r){e=r}})};Ta(vj,as);var Ui=function e(){as.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute F supplied.');t=b}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Zr(t,3)},set:function(b){b?this.F=Jr(t,3):this.F=Qr(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute Ff supplied.');r=b}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(b){n=b!==void 0?b:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(b){n[0]=b}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(b){n[1]=b}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(b){n[2]=b}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(b){n[3]=b}});var a="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return a},set:function(b){switch(b){case"/Btn":case"/Tx":case"/Ch":case"/Sig":a=b;break;default:throw new Error('Invalid value "'+b+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof Ih)return;i="FieldObject"+e.FieldNum++}var b=function(E){return E};return this.scope&&(b=this.scope.internal.getEncryptor(this.objId)),"("+Jl(b(i))+")"},set:function(b){i=b.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(b){i=b}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(b){s=b}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(b){o=b}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(b){c=b}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/v2:u},set:function(b){u=b}});var f="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return f},set:function(b){f=b}});var d="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!d||this instanceof Ih||this instanceof kl))return C1(d,this.objId,this.scope)},set:function(b){b=b.toString(),d=b}});var p=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof An==0?C1(p,this.objId,this.scope):p},set:function(b){b=b.toString(),p=this instanceof An==0?b.substr(0,1)==="("?vc(b.substr(1,b.length-2)):vc(b):b}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof An==1?vc(p.substr(1,p.length-1)):p},set:function(b){b=b.toString(),p=this instanceof An==1?"/"+b:b}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(b){this.V=b}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof An==0?C1(h,this.objId,this.scope):h},set:function(b){b=b.toString(),h=this instanceof An==0?b.substr(0,1)==="("?vc(b.substr(1,b.length-2)):vc(b):b}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof An==1?vc(h.substr(1,h.length-1)):h},set:function(b){b=b.toString(),h=this instanceof An==1?"/"+b:b}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var x,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(b){b=!!b,g=b}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(x)return x},set:function(b){x=b}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,1)},set:function(b){b?this.Ff=Jr(this.Ff,1):this.Ff=Qr(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,2)},set:function(b){b?this.Ff=Jr(this.Ff,2):this.Ff=Qr(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,3)},set:function(b){b?this.Ff=Jr(this.Ff,3):this.Ff=Qr(this.Ff,3)}});var y=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(y!==null)return y},set:function(b){if([0,1,2].indexOf(b)===-1)throw new Error('Invalid value "'+b+'" for attribute Q supplied.');y=b}}),Object.defineProperty(this,"textAlign",{get:function(){var b;switch(y){case 0:default:b="left";break;case 1:b="center";break;case 2:b="right"}return b},configurable:!0,enumerable:!0,set:function(b){switch(b){case"right":case 2:y=2;break;case"center":case 1:y=1;break;default:y=0}}})};Ta(Ui,as);var Rc=function(){Ui.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return gj(t,this.objId,this.scope)},set:function(r){var n,a;a=[],typeof(n=r)=="string"&&(a=function(i,s,o){o||(o=1);for(var c,u=[];c=s.exec(i);)u.push(c[o]);return u}(n,/\((.*?)\)/g)),t=a}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,18)},set:function(r){r?this.Ff=Jr(this.Ff,18):this.Ff=Qr(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Jr(this.Ff,19):this.Ff=Qr(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,20)},set:function(r){r?(this.Ff=Jr(this.Ff,20),t.sort()):this.Ff=Qr(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,22)},set:function(r){r?this.Ff=Jr(this.Ff,22):this.Ff=Qr(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,23)},set:function(r){r?this.Ff=Jr(this.Ff,23):this.Ff=Qr(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,27)},set:function(r){r?this.Ff=Jr(this.Ff,27):this.Ff=Qr(this.Ff,27)}}),this.hasAppearanceStream=!1};Ta(Rc,Ui);var Bc=function(){Rc.call(this),this.fontName="helvetica",this.combo=!1};Ta(Bc,Rc);var Uc=function(){Bc.call(this),this.combo=!0};Ta(Uc,Bc);var kd=function(){Uc.call(this),this.edit=!0};Ta(kd,Uc);var An=function(){Ui.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,15)},set:function(r){r?this.Ff=Jr(this.Ff,15):this.Ff=Qr(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,16)},set:function(r){r?this.Ff=Jr(this.Ff,16):this.Ff=Qr(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,17)},set:function(r){r?this.Ff=Jr(this.Ff,17):this.Ff=Qr(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,26)},set:function(r){r?this.Ff=Jr(this.Ff,26):this.Ff=Qr(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(i){return i};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,a=[];for(n in a.push("<<"),t)a.push("/"+n+" ("+Jl(r(t[n]))+")");return a.push(">>"),a.join(`
`)}},set:function(r){fr(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};Ta(An,Ui);var Cd=function(){An.call(this),this.pushButton=!0};Ta(Cd,An);var $c=function(){An.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};Ta($c,An);var Ih=function(){var e,t;Ui.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(a){e=a}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(a){t=a}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var a=function(o){return o};this.scope&&(a=this.scope.internal.getEncryptor(this.objId));var i,s=[];for(i in s.push("<<"),n)s.push("/"+i+" ("+Jl(a(n[i]))+")");return s.push(">>"),s.join(`
`)},set:function(a){fr(a)==="object"&&(n=a)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(a){typeof a=="string"&&(n.CA=a)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(a){r=a}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(a){r="/"+a}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=ht.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};Ta(Ih,Ui),$c.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},$c.prototype.createOption=function(e){var t=new Ih;return t.Parent=this,t.optionName=e,this.Kids.push(t),IZ.call(this.scope,t),t};var Od=function(){An.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=ht.CheckBox.createAppearanceStream()};Ta(Od,An);var kl=function(){Ui.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,13)},set:function(t){t?this.Ff=Jr(this.Ff,13):this.Ff=Qr(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,21)},set:function(t){t?this.Ff=Jr(this.Ff,21):this.Ff=Qr(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,23)},set:function(t){t?this.Ff=Jr(this.Ff,23):this.Ff=Qr(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,24)},set:function(t){t?this.Ff=Jr(this.Ff,24):this.Ff=Qr(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,25)},set:function(t){t?this.Ff=Jr(this.Ff,25):this.Ff=Qr(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,26)},set:function(t){t?this.Ff=Jr(this.Ff,26):this.Ff=Qr(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};Ta(kl,Ui);var Ld=function(){kl.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Zr(this.Ff,14)},set:function(e){e?this.Ff=Jr(this.Ff,14):this.Ff=Qr(this.Ff,14)}}),this.password=!0};Ta(Ld,kl);var ht={CheckBox:{createAppearanceStream:function(){return{N:{On:ht.CheckBox.YesNormal},D:{On:ht.CheckBox.YesPushDown,Off:ht.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=es(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,a=e.scope.__private__.encodeColorString(e.color),i=Vg(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+Ft(ht.internal.getWidth(e))+" "+Ft(ht.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Ft(i.fontSize)+" Tf "+a),r.push("BT"),r.push(i.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=es(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),a=[],i=ht.internal.getHeight(e),s=ht.internal.getWidth(e),o=Vg(e,e.caption);return a.push("1 g"),a.push("0 0 "+Ft(s)+" "+Ft(i)+" re"),a.push("f"),a.push("q"),a.push("0 0 1 rg"),a.push("0 0 "+Ft(s-1)+" "+Ft(i-1)+" re"),a.push("W"),a.push("n"),a.push("0 g"),a.push("BT"),a.push("/"+r+" "+Ft(o.fontSize)+" Tf "+n),a.push(o.text),a.push("ET"),a.push("Q"),t.stream=a.join(`
`),t},OffPushDown:function(e){var t=es(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Ft(ht.internal.getWidth(e))+" "+Ft(ht.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:ht.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=ht.RadioButton.Circle.YesNormal,t.D[e]=ht.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=es(e);t.scope=e.scope;var r=[],n=ht.internal.getWidth(e)<=ht.internal.getHeight(e)?ht.internal.getWidth(e)/4:ht.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=ht.internal.Bezier_C,i=Number((n*a).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+go(ht.internal.getWidth(e)/2)+" "+go(ht.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+i+" "+i+" "+n+" 0 "+n+" c"),r.push("-"+i+" "+n+" -"+n+" "+i+" -"+n+" 0 c"),r.push("-"+n+" -"+i+" -"+i+" -"+n+" 0 -"+n+" c"),r.push(i+" -"+n+" "+n+" -"+i+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=es(e);t.scope=e.scope;var r=[],n=ht.internal.getWidth(e)<=ht.internal.getHeight(e)?ht.internal.getWidth(e)/4:ht.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),i=Number((a*ht.internal.Bezier_C).toFixed(5)),s=Number((n*ht.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+go(ht.internal.getWidth(e)/2)+" "+go(ht.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+go(ht.internal.getWidth(e)/2)+" "+go(ht.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=es(e);t.scope=e.scope;var r=[],n=ht.internal.getWidth(e)<=ht.internal.getHeight(e)?ht.internal.getWidth(e)/4:ht.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var a=Number((2*n).toFixed(5)),i=Number((a*ht.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+go(ht.internal.getWidth(e)/2)+" "+go(ht.internal.getHeight(e)/2)+" cm"),r.push(a+" 0 m"),r.push(a+" "+i+" "+i+" "+a+" 0 "+a+" c"),r.push("-"+i+" "+a+" -"+a+" "+i+" -"+a+" 0 c"),r.push("-"+a+" -"+i+" -"+i+" -"+a+" 0 -"+a+" c"),r.push(i+" -"+a+" "+a+" -"+i+" "+a+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:ht.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=ht.RadioButton.Cross.YesNormal,t.D[e]=ht.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=es(e);t.scope=e.scope;var r=[],n=ht.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+Ft(ht.internal.getWidth(e)-2)+" "+Ft(ht.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(Ft(n.x1.x)+" "+Ft(n.x1.y)+" m"),r.push(Ft(n.x2.x)+" "+Ft(n.x2.y)+" l"),r.push(Ft(n.x4.x)+" "+Ft(n.x4.y)+" m"),r.push(Ft(n.x3.x)+" "+Ft(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=es(e);t.scope=e.scope;var r=ht.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+Ft(ht.internal.getWidth(e))+" "+Ft(ht.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Ft(ht.internal.getWidth(e)-2)+" "+Ft(ht.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(Ft(r.x1.x)+" "+Ft(r.x1.y)+" m"),n.push(Ft(r.x2.x)+" "+Ft(r.x2.y)+" l"),n.push(Ft(r.x4.x)+" "+Ft(r.x4.y)+" m"),n.push(Ft(r.x3.x)+" "+Ft(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=es(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Ft(ht.internal.getWidth(e))+" "+Ft(ht.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};ht.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=ht.internal.getWidth(e),r=ht.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},ht.internal.getWidth=function(e){var t=0;return fr(e)==="object"&&(t=D_(e.Rect[2])),t},ht.internal.getHeight=function(e){var t=0;return fr(e)==="object"&&(t=D_(e.Rect[3])),t};var IZ=Ur.addField=function(e){if(DZ(this,e),!(e instanceof Ui))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};Ur.AcroFormChoiceField=Rc,Ur.AcroFormListBox=Bc,Ur.AcroFormComboBox=Uc,Ur.AcroFormEditBox=kd,Ur.AcroFormButton=An,Ur.AcroFormPushButton=Cd,Ur.AcroFormRadioButton=$c,Ur.AcroFormCheckBox=Od,Ur.AcroFormTextField=kl,Ur.AcroFormPasswordField=Ld,Ur.AcroFormAppearance=ht,Ur.AcroForm={ChoiceField:Rc,ListBox:Bc,ComboBox:Uc,EditBox:kd,Button:An,PushButton:Cd,RadioButton:$c,CheckBox:Od,TextField:kl,PasswordField:Ld,Appearance:ht},St.AcroForm={ChoiceField:Rc,ListBox:Bc,ComboBox:Uc,EditBox:kd,Button:An,PushButton:Cd,RadioButton:$c,CheckBox:Od,TextField:kl,PasswordField:Ld,Appearance:ht};function yj(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){var t="addImage_";e.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},a=e.__addimage__.getImageFileTypeByImageData=function(T,j){var z,K,he,be,we,Q=r;if((j=j||r)==="RGBA"||T.data!==void 0&&T.data instanceof Uint8ClampedArray&&"height"in T&&"width"in T)return"RGBA";if(F(T))for(we in n)for(he=n[we],z=0;z<he.length;z+=1){for(be=!0,K=0;K<he[z].length;K+=1)if(he[z][K]!==void 0&&he[z][K]!==T[K]){be=!1;break}if(be===!0){Q=we;break}}else for(we in n)for(he=n[we],z=0;z<he.length;z+=1){for(be=!0,K=0;K<he[z].length;K+=1)if(he[z][K]!==void 0&&he[z][K]!==T.charCodeAt(K)){be=!1;break}if(be===!0){Q=we;break}}return Q===r&&j!==r&&(Q=j),Q},i=function T(j){for(var z=this.internal.write,K=this.internal.putStream,he=(0,this.internal.getFilters)();he.indexOf("FlateEncode")!==-1;)he.splice(he.indexOf("FlateEncode"),1);j.objectId=this.internal.newObject();var be=[];if(be.push({key:"Type",value:"/XObject"}),be.push({key:"Subtype",value:"/Image"}),be.push({key:"Width",value:j.width}),be.push({key:"Height",value:j.height}),j.colorSpace===b.INDEXED?be.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(j.palette.length/3-1)+" "+("sMask"in j&&j.sMask!==void 0?j.objectId+2:j.objectId+1)+" 0 R]"}):(be.push({key:"ColorSpace",value:"/"+j.colorSpace}),j.colorSpace===b.DEVICE_CMYK&&be.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),be.push({key:"BitsPerComponent",value:j.bitsPerComponent}),"decodeParameters"in j&&j.decodeParameters!==void 0&&be.push({key:"DecodeParms",value:"<<"+j.decodeParameters+">>"}),"transparency"in j&&Array.isArray(j.transparency)){for(var we="",Q=0,le=j.transparency.length;Q<le;Q++)we+=j.transparency[Q]+" "+j.transparency[Q]+" ";be.push({key:"Mask",value:"["+we+"]"})}j.sMask!==void 0&&be.push({key:"SMask",value:j.objectId+1+" 0 R"});var ke=j.filter!==void 0?["/"+j.filter]:void 0;if(K({data:j.data,additionalKeyValues:be,alreadyAppliedFilters:ke,objectId:j.objectId}),z("endobj"),"sMask"in j&&j.sMask!==void 0){var ve=(j.predictor!=null?"/Predictor "+j.predictor:"")+" /Colors 1 /BitsPerComponent 8 /Columns "+j.width,S={width:j.width,height:j.height,colorSpace:"DeviceGray",bitsPerComponent:j.bitsPerComponent,decodeParameters:ve,data:j.sMask};"filter"in j&&(S.filter=j.filter),T.call(this,S)}if(j.colorSpace===b.INDEXED){var L=this.internal.newObject();K({data:I(new Uint8Array(j.palette)),objectId:L}),z("endobj")}},s=function(){var T=this.internal.collections[t+"images"];for(var j in T)i.call(this,T[j])},o=function(){var T,j=this.internal.collections[t+"images"],z=this.internal.write;for(var K in j)z("/I"+(T=j[K]).index,T.objectId,"0","R")},c=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",o))},u=function(){var T=this.internal.collections[t+"images"];return c.call(this),T},f=function(){return Object.keys(this.internal.collections[t+"images"]).length},d=function(T){return typeof e["process"+T.toUpperCase()]=="function"},p=function(T){return fr(T)==="object"&&T.nodeType===1},h=function(T,j){if(T.nodeName==="IMG"&&T.hasAttribute("src")){var z=""+T.getAttribute("src");if(z.indexOf("data:image/")===0)return Pd(unescape(z).split("base64,").pop());var K=e.loadFile(z,!0);if(K!==void 0)return K}if(T.nodeName==="CANVAS"){if(T.width===0||T.height===0)throw new Error("Given canvas must have data. Canvas width: "+T.width+", height: "+T.height);var he;switch(j){case"PNG":he="image/png";break;case"WEBP":he="image/webp";break;default:he="image/jpeg"}return Pd(T.toDataURL(he,1).split("base64,").pop())}},x=function(T){var j=this.internal.collections[t+"images"];if(j){for(var z in j)if(T===j[z].alias)return j[z]}},g=function(T,j,z){return T||j||(T=-96,j=-96),T<0&&(T=-1*z.width*72/T/this.internal.scaleFactor),j<0&&(j=-1*z.height*72/j/this.internal.scaleFactor),T===0&&(T=j*z.width/z.height),j===0&&(j=T*z.height/z.width),[T,j]},y=function(T,j,z,K,he,be){var we=g.call(this,z,K,he),Q=this.internal.getCoordinateString,le=this.internal.getVerticalCoordinateString,ke=u.call(this);if(z=we[0],K=we[1],ke[he.index]=he,be){be*=Math.PI/180;var ve=Math.cos(be),S=Math.sin(be),L=function(R){return R.toFixed(4)},D=[L(ve),L(S),L(-1*S),L(ve),0,0,"cm"]}this.internal.write("q"),be?(this.internal.write([1,"0","0",1,Q(T),le(j+K),"cm"].join(" ")),this.internal.write(D.join(" ")),this.internal.write([Q(z),"0","0",Q(K),"0","0","cm"].join(" "))):this.internal.write([Q(z),"0","0",Q(K),Q(T),le(j+K),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+he.index+" Do"),this.internal.write("Q")},b=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var E=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},A=e.__addimage__.sHashCode=function(T){var j,z,K=0;if(typeof T=="string")for(z=T.length,j=0;j<z;j++)K=(K<<5)-K+T.charCodeAt(j),K|=0;else if(F(T))for(z=T.byteLength/2,j=0;j<z;j++)K=(K<<5)-K+T[j],K|=0;return K},C=e.__addimage__.validateStringAsBase64=function(T){(T=T||"").toString().trim();var j=!0;return T.length===0&&(j=!1),T.length%4!=0&&(j=!1),/^[A-Za-z0-9+/]+$/.test(T.substr(0,T.length-2))===!1&&(j=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(T.substr(-2))===!1&&(j=!1),j},N=e.__addimage__.extractImageFromDataUrl=function(T){if(T==null||!(T=T.trim()).startsWith("data:"))return null;var j=T.indexOf(",");return j<0?null:T.substring(0,j).trim().endsWith("base64")?T.substring(j+1):null};e.__addimage__.isArrayBuffer=function(T){return T instanceof ArrayBuffer};var F=e.__addimage__.isArrayBufferView=function(T){return T instanceof Int8Array||T instanceof Uint8Array||T instanceof Uint8ClampedArray||T instanceof Int16Array||T instanceof Uint16Array||T instanceof Int32Array||T instanceof Uint32Array||T instanceof Float32Array||T instanceof Float64Array},O=e.__addimage__.binaryStringToUint8Array=function(T){for(var j=T.length,z=new Uint8Array(j),K=0;K<j;K++)z[K]=T.charCodeAt(K);return z},I=e.__addimage__.arrayBufferToBinaryString=function(T){for(var j="",z=F(T)?T:new Uint8Array(T),K=0;K<z.length;K+=8192)j+=String.fromCharCode.apply(null,z.subarray(K,K+8192));return j};e.addImage=function(){var T,j,z,K,he,be,we,Q,le;if(typeof arguments[1]=="number"?(j=r,z=arguments[1],K=arguments[2],he=arguments[3],be=arguments[4],we=arguments[5],Q=arguments[6],le=arguments[7]):(j=arguments[1],z=arguments[2],K=arguments[3],he=arguments[4],be=arguments[5],we=arguments[6],Q=arguments[7],le=arguments[8]),fr(T=arguments[0])==="object"&&!p(T)&&"imageData"in T){var ke=T;T=ke.imageData,j=ke.format||j||r,z=ke.x||z||0,K=ke.y||K||0,he=ke.w||ke.width||he,be=ke.h||ke.height||be,we=ke.alias||we,Q=ke.compression||Q,le=ke.rotation||ke.angle||le}var ve=this.internal.getFilters();if(Q===void 0&&ve.indexOf("FlateEncode")!==-1&&(Q="SLOW"),isNaN(z)||isNaN(K))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var S=P.call(this,T,j,we,Q);return y.call(this,z,K,he,be,S,le),this};var P=function(T,j,z,K){var he,be,we;if(typeof T=="string"&&a(T)===r){T=unescape(T);var Q=H(T,!1);(Q!==""||(Q=e.loadFile(T,!0))!==void 0)&&(T=Q)}if(p(T)&&(T=h(T,j)),j=a(T,j),!d(j))throw new Error("addImage does not support files of type '"+j+"', please ensure that a plugin for '"+j+"' support is added.");if(((we=z)==null||we.length===0)&&(z=function(le){return typeof le=="string"||F(le)?A(le):F(le.data)?A(le.data):null}(T)),(he=x.call(this,z))||(T instanceof Uint8Array||j==="RGBA"||(be=T,T=O(T)),he=this["process"+j.toUpperCase()](T,f.call(this),z,function(le){return le&&typeof le=="string"&&(le=le.toUpperCase()),le in e.image_compression?le:E.NONE}(K),be)),!he)throw new Error("An unknown error occurred whilst processing the image.");return he},H=e.__addimage__.convertBase64ToBinaryString=function(T,j){j=typeof j!="boolean"||j;var z,K="";if(typeof T=="string"){var he;z=(he=N(T))!==null&&he!==void 0?he:T;try{K=Pd(z)}catch(be){if(j)throw C(z)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+be.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return K};e.getImageProperties=function(T){var j,z,K="";if(p(T)&&(T=h(T)),typeof T=="string"&&a(T)===r&&((K=H(T,!1))===""&&(K=e.loadFile(T)||""),T=K),z=a(T),!d(z))throw new Error("addImage does not support files of type '"+z+"', please ensure that a plugin for '"+z+"' support is added.");if(T instanceof Uint8Array||(T=O(T)),!(j=this["process"+z.toUpperCase()](T)))throw new Error("An unknown error occurred whilst processing the image");return j.fileType=z,j}})(St.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};St.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,a,i,s=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(r.objId),u=r.pageContext.annotations,f=!1,d=0;d<u.length&&!f;d++)switch((n=u[d]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(f=!0);break;case"reference":case"text":case"freetext":f=!0}if(f!=0){this.internal.write("/Annots [");for(var p=0;p<u.length;p++){n=u[p];var h=this.internal.pdfEscape,x=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var g=this.internal.newAdditionalObject(),y=this.internal.newAdditionalObject(),b=this.internal.getEncryptor(g.objId),E=n.title||"Note";i="<</Type /Annot /Subtype /Text "+(a="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+h(b(n.contents))+")",i+=" /Popup "+y.objId+" 0 R",i+=" /P "+c.objId+" 0 R",i+=" /T ("+h(b(E))+") >>",g.content=i;var A=g.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(a="/Rect ["+s(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+A,n.open&&(i+=" /Open true"),i+=" >>",y.content=i,this.internal.write(g.objId,"0 R",y.objId,"0 R");break;case"freetext":a="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var C=n.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+a+"/Contents ("+h(x(n.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+C+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(n.options.name){var N=this.annotations._nameMap[n.options.name];n.options.pageNumber=N.page,n.options.top=N.y}else n.options.top||(n.options.top=0);if(a="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",i="",n.options.url)i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /A <</S /URI /URI ("+h(x(n.options.url))+") >>";else if(n.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+a+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,i+=" /FitV "+n.options.left+"]";break;default:var F=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),i+=" /XYZ "+n.options.left+" "+F+" "+n.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,a,i,s){var o=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:c(r),y:u(n),w:c(r+a),h:u(n+i)},options:s,type:"link"})},e.textWithLink=function(r,n,a,i){var s,o,c=this.getTextWidth(r),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){o=i.maxWidth;var f=this.splitTextToSize(r,o).length;s=Math.ceil(u*f)}else o=c,s=u;return this.text(r,n,a,i),a+=.2*u,i.align==="center"&&(n-=c/2),i.align==="right"&&(n-=c),this.link(n,a-u,o,s,i),c},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(St.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},a=[1570,1571,1573,1575];e.__arabicParser__={};var i=e.__arabicParser__.isInArabicSubstitutionA=function(g){return t[g.charCodeAt(0)]!==void 0},s=e.__arabicParser__.isArabicLetter=function(g){return typeof g=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(g)},o=e.__arabicParser__.isArabicEndLetter=function(g){return s(g)&&i(g)&&t[g.charCodeAt(0)].length<=2},c=e.__arabicParser__.isArabicAlfLetter=function(g){return s(g)&&a.indexOf(g.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(g){return s(g)&&i(g)&&t[g.charCodeAt(0)].length>=1};var u=e.__arabicParser__.arabicLetterHasFinalForm=function(g){return s(g)&&i(g)&&t[g.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(g){return s(g)&&i(g)&&t[g.charCodeAt(0)].length>=3};var f=e.__arabicParser__.arabicLetterHasMedialForm=function(g){return s(g)&&i(g)&&t[g.charCodeAt(0)].length==4},d=e.__arabicParser__.resolveLigatures=function(g){var y=0,b=r,E="",A=0;for(y=0;y<g.length;y+=1)b[g.charCodeAt(y)]!==void 0?(A++,typeof(b=b[g.charCodeAt(y)])=="number"&&(E+=String.fromCharCode(b),b=r,A=0),y===g.length-1&&(b=r,E+=g.charAt(y-(A-1)),y-=A-1,A=0)):(b=r,E+=g.charAt(y-A),y-=A,A=0);return E};e.__arabicParser__.isArabicDiacritic=function(g){return g!==void 0&&n[g.charCodeAt(0)]!==void 0};var p=e.__arabicParser__.getCorrectForm=function(g,y,b){return s(g)?i(g)===!1?-1:!u(g)||!s(y)&&!s(b)||!s(b)&&o(y)||o(g)&&!s(y)||o(g)&&c(y)||o(g)&&o(y)?0:f(g)&&s(y)&&!o(y)&&s(b)&&u(b)?3:o(g)||!s(b)?1:2:-1},h=function(g){var y=0,b=0,E=0,A="",C="",N="",F=(g=g||"").split("\\s+"),O=[];for(y=0;y<F.length;y+=1){for(O.push(""),b=0;b<F[y].length;b+=1)A=F[y][b],C=F[y][b-1],N=F[y][b+1],s(A)?(E=p(A,C,N),O[y]+=E!==-1?String.fromCharCode(t[A.charCodeAt(0)][E]):A):O[y]+=A;O[y]=d(O[y])}return O.join(" ")},x=e.__arabicParser__.processArabic=e.processArabic=function(){var g,y=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,b=[];if(Array.isArray(y)){var E=0;for(b=[],E=0;E<y.length;E+=1)Array.isArray(y[E])?b.push([h(y[E][0]),y[E][1],y[E][2]]):b.push([h(y[E])]);g=b}else g=h(y);return typeof arguments[0]=="string"?g:(arguments[0].text=g,arguments[0])};e.events.push(["preProcessText",x])}(St.API),St.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(o){r=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var a=300;Object.defineProperty(this,"height",{get:function(){return a},set:function(o){a=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=a+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(o){i=o}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(o){s=o}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var a;if((r=r||"2d")!=="2d")return null;for(a in n)this.pdf.context2d.hasOwnProperty(a)&&(this.pdf.context2d[a]=n[a]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(St.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),a.call(this))},a=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(g){c=g}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(g){u=g}});var f=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return f},set:function(g){f=g}});var d=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return d},set:function(g){d=g}});var p=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return p},set:function(g){p=g}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(g){h=g}});var x=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return x},set:function(g){x=g}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(c){return n.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},e.getTextDimensions=function(c,u){n.call(this);var f=(u=u||{}).fontSize||this.getFontSize(),d=u.font||this.getFont(),p=u.scaleFactor||this.internal.scaleFactor,h=0,x=0,g=0,y=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var b=u.maxWidth;b>0?typeof c=="string"?c=this.splitTextToSize(c,b):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(A,C){return A.concat(y.splitTextToSize(C,b))},[])):c=Array.isArray(c)?c:[c];for(var E=0;E<c.length;E++)h<(g=this.getStringUnitWidth(c[E],{font:d})*f)&&(h=g);return h!==0&&(x=c.length),{w:h/=p,h:Math.max((x*f*this.getLineHeightFactor()-f*(this.getLineHeightFactor()-1))/p,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var c=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new i(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=e.cell=function(){var c;c=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var u=this.internal.__cell__.lastCell,f=this.internal.__cell__.padding,d=this.internal.__cell__.margins||t,p=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+d.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=d.top,h&&p&&(this.printHeaderRow(c.lineNumber,!0),c.y+=p[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,r===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-f,c.y+f,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+f,{align:"center",baseline:"top",maxWidth:c.width-f-f}):this.text(c.text,c.x+f,c.y+f,{align:"left",baseline:"top",maxWidth:c.width-f-f})),this.internal.__cell__.lastCell=c,this};e.table=function(c,u,f,d,p){if(n.call(this),!f)throw new Error("No data for PDF table.");var h,x,g,y,b=[],E=[],A=[],C={},N={},F=[],O=[],I=(p=p||{}).autoSize||!1,P=p.printHeaders!==!1,H=p.css&&p.css["font-size"]!==void 0?16*p.css["font-size"]:p.fontSize||12,T=p.margins||Object.assign({width:this.getPageWidth()},t),j=typeof p.padding=="number"?p.padding:3,z=p.headerBackgroundColor||"#c8c8c8",K=p.headerTextColor||"#000";if(a.call(this),this.internal.__cell__.printHeaders=P,this.internal.__cell__.margins=T,this.internal.__cell__.table_font_size=H,this.internal.__cell__.padding=j,this.internal.__cell__.headerBackgroundColor=z,this.internal.__cell__.headerTextColor=K,this.setFontSize(H),d==null)E=b=Object.keys(f[0]),A=b.map(function(){return"left"});else if(Array.isArray(d)&&fr(d[0])==="object")for(b=d.map(function(ke){return ke.name}),E=d.map(function(ke){return ke.prompt||ke.name||""}),A=d.map(function(ke){return ke.align||"left"}),h=0;h<d.length;h+=1)N[d[h].name]=.7499990551181103*d[h].width;else Array.isArray(d)&&typeof d[0]=="string"&&(E=b=d,A=b.map(function(){return"left"}));if(I||Array.isArray(d)&&typeof d[0]=="string")for(h=0;h<b.length;h+=1){for(C[y=b[h]]=f.map(function(ke){return ke[y]}),this.setFont(void 0,"bold"),F.push(this.getTextDimensions(E[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),x=C[y],this.setFont(void 0,"normal"),g=0;g<x.length;g+=1)F.push(this.getTextDimensions(x[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);N[y]=Math.max.apply(null,F)+j+j,F=[]}if(P){var he={};for(h=0;h<b.length;h+=1)he[b[h]]={},he[b[h]].text=E[h],he[b[h]].align=A[h];var be=o.call(this,he,N);O=b.map(function(ke){return new i(c,u,N[ke],be,he[ke].text,void 0,he[ke].align)}),this.setTableHeaderRow(O),this.printHeaderRow(1,!1)}var we=d.reduce(function(ke,ve){return ke[ve.name]=ve.align,ke},{});for(h=0;h<f.length;h+=1){"rowStart"in p&&p.rowStart instanceof Function&&p.rowStart({row:h,data:f[h]},this);var Q=o.call(this,f[h],N);for(g=0;g<b.length;g+=1){var le=f[h][b[g]];"cellStart"in p&&p.cellStart instanceof Function&&p.cellStart({row:h,col:g,data:le},this),s.call(this,new i(c,u,N[b[g]],Q,le,h+2,we[b[g]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var o=function(c,u){var f=this.internal.__cell__.padding,d=this.internal.__cell__.table_font_size,p=this.internal.scaleFactor;return Object.keys(c).map(function(h){var x=c[h];return this.splitTextToSize(x.hasOwnProperty("text")?x.text:x,u[h]-f-f)},this).map(function(h){return this.getLineHeightFactor()*h.length*d/p+f+f},this).reduce(function(h,x){return Math.max(h,x)},0)};e.setTableHeaderRow=function(c){n.call(this),this.internal.__cell__.tableHeaderRow=c},e.printHeaderRow=function(c,u){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var f;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var d=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(d[0],d[1],d[2],d[3],void 0,-1)}this.setFont(void 0,"bold");for(var p=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){f=this.internal.__cell__.tableHeaderRow[h].clone(),u&&(f.y=this.internal.__cell__.margins.top||0,p.push(f)),f.lineNumber=c;var x=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,f),this.setTextColor(x)}p.length>0&&this.setTableHeaderRow(p),this.setFont(void 0,"normal"),r=!1}}(St.API);var bj={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},wj=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Kg=yj(wj),_j=[100,200,300,400,500,600,700,800,900],MZ=yj(_j);function O1(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(i){return bj[i=i||"normal"]?i:"normal"}(e.style),n=function(i){return i?typeof i=="number"?i>=100&&i<=900&&i%100==0?i:400:/^\d00$/.test(i)?parseInt(i):i==="bold"?700:400:400}(e.weight),a=function(i){return typeof Kg[i=i||"normal"]=="number"?i:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:a,src:e.src||[],ref:e.ref||{name:t,style:[a,r,n].join(" ")}}}function I_(e,t,r,n){var a;for(a=r;a>=0&&a<t.length;a+=n)if(e[t[a]])return e[t[a]];for(a=r;a>=0&&a<t.length;a-=n)if(e[t[a]])return e[t[a]]}var RZ={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},M_={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function R_(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function B_(e){return e.trimLeft()}function BZ(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function UZ(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var _d,U_,$_,yc,Nd,z_,q_,W_,L1=["times"];function H_(e,t,r,n){var a=4,i=V_;switch(n){case St.API.image_compression.FAST:a=1,i=G_;break;case St.API.image_compression.MEDIUM:a=6,i=K_;break;case St.API.image_compression.SLOW:a=9,i=Y_}e=function(o,c,u,f){for(var d,p=o.length/c,h=new Uint8Array(o.length+p),x=[$Z,G_,V_,K_,Y_],g=0;g<p;g+=1){var y=g*c,b=o.subarray(y,y+c);if(f)h.set(f(b,u,d),y+g);else{for(var E=x.length,A=[],C=0;C<E;C+=1)A[C]=x[C](b,u,d);var N=qZ(A.concat());h.set(A[N],y+g)}d=b}return h}(e,t,r,i);var s=Dg(e,{level:a});return St.API.__addimage__.arrayBufferToBinaryString(s)}function $Z(e){var t=Array.apply([],e);return t.unshift(0),t}function G_(e,t){var r=e.length,n=[];n[0]=1;for(var a=0;a<r;a+=1){var i=e[a-t]||0;n[a+1]=e[a]-i+256&255}return n}function V_(e,t,r){var n=e.length,a=[];a[0]=2;for(var i=0;i<n;i+=1){var s=r&&r[i]||0;a[i+1]=e[i]-s+256&255}return a}function K_(e,t,r){var n=e.length,a=[];a[0]=3;for(var i=0;i<n;i+=1){var s=e[i-t]||0,o=r&&r[i]||0;a[i+1]=e[i]+256-(s+o>>>1)&255}return a}function Y_(e,t,r){var n=e.length,a=[];a[0]=4;for(var i=0;i<n;i+=1){var s=zZ(e[i-t]||0,r&&r[i]||0,r&&r[i-t]||0);a[i+1]=e[i]-s+256&255}return a}function zZ(e,t,r){if(e===t&&t===r)return e;var n=Math.abs(t-r),a=Math.abs(e-r),i=Math.abs(e+t-r-r);return n<=a&&n<=i?e:a<=i?t:r}function qZ(e){var t=e.map(function(r){return r.reduce(function(n,a){return n+Math.abs(a)},0)});return t.indexOf(Math.min.apply(null,t))}function F1(e,t,r){var n=t*r,a=Math.floor(n/8),i=16-(n-8*a+r),s=(1<<r)-1;return Nj(e,a)>>i&s}function X_(e,t,r,n){var a=r*n,i=Math.floor(a/8),s=16-(a-8*i+n),o=(1<<n)-1,c=(t&o)<<s;(function(u,f,d){if(f+1<u.byteLength)u.setUint16(f,d,!1);else{var p=d>>8&255;u.setUint8(f,p)}})(e,i,Nj(e,i)&~(o<<s)&65535|c)}function Nj(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function WZ(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,a=e[t++],i=a>>7,s=1<<1+(7&a);e[t++],e[t++];var o=null,c=null;i&&(o=t,c=s,t+=3*s);var u=!0,f=[],d=0,p=null,h=0,x=null;for(this.width=r,this.height=n;u&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,x=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((T=e[t++])>=0))throw Error("Invalid block size");if(T===0)break;t+=T}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var g=e[t++];d=e[t++]|e[t++]<<8,p=e[t++],1&g||(p=null),h=g>>2&7,t++;break;case 254:for(;;){if(!((T=e[t++])>=0))throw Error("Invalid block size");if(T===0)break;t+=T}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var y=e[t++]|e[t++]<<8,b=e[t++]|e[t++]<<8,E=e[t++]|e[t++]<<8,A=e[t++]|e[t++]<<8,C=e[t++],N=C>>6&1,F=1<<1+(7&C),O=o,I=c,P=!1;C>>7&&(P=!0,O=t,I=F,t+=3*F);var H=t;for(t++;;){var T;if(!((T=e[t++])>=0))throw Error("Invalid block size");if(T===0)break;t+=T}f.push({x:y,y:b,width:E,height:A,has_local_palette:P,palette_offset:O,palette_size:I,data_offset:H,data_length:t-H,transparent_index:p,interlaced:!!N,delay:d,disposal:h});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return f.length},this.loopCount=function(){return x},this.frameInfo=function(j){if(j<0||j>=f.length)throw new Error("Frame index out of range.");return f[j]},this.decodeAndBlitFrameBGRA=function(j,z){var K=this.frameInfo(j),he=K.width*K.height,be=new Uint8Array(he);Z_(e,K.data_offset,be,he);var we=K.palette_offset,Q=K.transparent_index;Q===null&&(Q=256);var le=K.width,ke=r-le,ve=le,S=4*(K.y*r+K.x),L=4*((K.y+K.height)*r+K.x),D=S,R=4*ke;K.interlaced===!0&&(R+=4*r*7);for(var X=8,de=0,me=be.length;de<me;++de){var Y=be[de];if(ve===0&&(ve=le,(D+=R)>=L&&(R=4*ke+4*r*(X-1),D=S+(le+ke)*(X<<1),X>>=1)),Y===Q)D+=4;else{var oe=e[we+3*Y],ue=e[we+3*Y+1],fe=e[we+3*Y+2];z[D++]=fe,z[D++]=ue,z[D++]=oe,z[D++]=255}--ve}},this.decodeAndBlitFrameRGBA=function(j,z){var K=this.frameInfo(j),he=K.width*K.height,be=new Uint8Array(he);Z_(e,K.data_offset,be,he);var we=K.palette_offset,Q=K.transparent_index;Q===null&&(Q=256);var le=K.width,ke=r-le,ve=le,S=4*(K.y*r+K.x),L=4*((K.y+K.height)*r+K.x),D=S,R=4*ke;K.interlaced===!0&&(R+=4*r*7);for(var X=8,de=0,me=be.length;de<me;++de){var Y=be[de];if(ve===0&&(ve=le,(D+=R)>=L&&(R=4*ke+4*r*(X-1),D=S+(le+ke)*(X<<1),X>>=1)),Y===Q)D+=4;else{var oe=e[we+3*Y],ue=e[we+3*Y+1],fe=e[we+3*Y+2];z[D++]=oe,z[D++]=ue,z[D++]=fe,z[D++]=255}--ve}}}function Z_(e,t,r,n){for(var a=e[t++],i=1<<a,s=i+1,o=s+1,c=a+1,u=(1<<c)-1,f=0,d=0,p=0,h=e[t++],x=new Int32Array(4096),g=null;;){for(;f<16&&h!==0;)d|=e[t++]<<f,f+=8,h===1?h=e[t++]:--h;if(f<c)break;var y=d&u;if(d>>=c,f-=c,y!==i){if(y===s)break;for(var b=y<o?y:g,E=0,A=b;A>i;)A=x[A]>>8,++E;var C=A;if(p+E+(b!==y?1:0)>n)return void vr.log("Warning, gif stream longer than expected.");r[p++]=C;var N=p+=E;for(b!==y&&(r[p++]=C),A=b;E--;)A=x[A],r[--N]=255&A,A>>=8;g!==null&&o<4096&&(x[o++]=g<<8|C,o>=u+1&&c<12&&(++c,u=u<<1|1)),g=y}else o=s+1,u=(1<<(c=a+1))-1,g=null}return p!==n&&vr.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function D1(e){var t,r,n,a,i,s=Math.floor,o=new Array(64),c=new Array(64),u=new Array(64),f=new Array(64),d=new Array(65535),p=new Array(65535),h=new Array(64),x=new Array(64),g=[],y=0,b=7,E=new Array(64),A=new Array(64),C=new Array(64),N=new Array(256),F=new Array(2048),O=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],I=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],P=[0,1,2,3,4,5,6,7,8,9,10,11],H=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],T=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],j=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],z=[0,1,2,3,4,5,6,7,8,9,10,11],K=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],he=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function be(S,L){for(var D=0,R=0,X=new Array,de=1;de<=16;de++){for(var me=1;me<=S[de];me++)X[L[R]]=[],X[L[R]][0]=D,X[L[R]][1]=de,R++,D++;D*=2}return X}function we(S){for(var L=S[0],D=S[1]-1;D>=0;)L&1<<D&&(y|=1<<b),D--,--b<0&&(y==255?(Q(255),Q(0)):Q(y),b=7,y=0)}function Q(S){g.push(S)}function le(S){Q(S>>8&255),Q(255&S)}function ke(S,L,D,R,X){for(var de,me=X[0],Y=X[240],oe=function(ze,lt){var Qe,jt,ft,Ot,Fe,Xe,At,xt,st,pt,dt=0;for(st=0;st<8;++st){Qe=ze[dt],jt=ze[dt+1],ft=ze[dt+2],Ot=ze[dt+3],Fe=ze[dt+4],Xe=ze[dt+5],At=ze[dt+6];var Qt=Qe+(xt=ze[dt+7]),$t=Qe-xt,mt=jt+At,Tt=jt-At,er=ft+Xe,Pe=ft-Xe,tt=Ot+Fe,bt=Ot-Fe,Xt=Qt+tt,wr=Qt-tt,Wt=mt+er,_t=mt-er;ze[dt]=Xt+Wt,ze[dt+4]=Xt-Wt;var Ut=.707106781*(_t+wr);ze[dt+2]=wr+Ut,ze[dt+6]=wr-Ut;var ir=.382683433*((Xt=bt+Pe)-(_t=Tt+$t)),Dr=.5411961*Xt+ir,dn=1.306562965*_t+ir,Cn=.707106781*(Wt=Pe+Tt),Et=$t+Cn,yi=$t-Cn;ze[dt+5]=yi+Dr,ze[dt+3]=yi-Dr,ze[dt+1]=Et+dn,ze[dt+7]=Et-dn,dt+=8}for(dt=0,st=0;st<8;++st){Qe=ze[dt],jt=ze[dt+8],ft=ze[dt+16],Ot=ze[dt+24],Fe=ze[dt+32],Xe=ze[dt+40],At=ze[dt+48];var bi=Qe+(xt=ze[dt+56]),Vn=Qe-xt,xa=jt+At,Cr=jt-At,rn=ft+Xe,q=ft-Xe,ae=Ot+Fe,Z=Ot-Fe,ee=bi+ae,ie=bi-ae,ce=xa+rn,Se=xa-rn;ze[dt]=ee+ce,ze[dt+32]=ee-ce;var Le=.707106781*(Se+ie);ze[dt+16]=ie+Le,ze[dt+48]=ie-Le;var Ae=.382683433*((ee=Z+q)-(Se=Cr+Vn)),Ee=.5411961*ee+Ae,Ce=1.306562965*Se+Ae,Ge=.707106781*(ce=q+Cr),Ze=Vn+Ge,it=Vn-Ge;ze[dt+40]=it+Ee,ze[dt+24]=it-Ee,ze[dt+8]=Ze+Ce,ze[dt+56]=Ze-Ce,dt++}for(st=0;st<64;++st)pt=ze[st]*lt[st],h[st]=pt>0?pt+.5|0:pt-.5|0;return h}(S,L),ue=0;ue<64;++ue)x[O[ue]]=oe[ue];var fe=x[0]-D;D=x[0],fe==0?we(R[0]):(we(R[p[de=32767+fe]]),we(d[de]));for(var Ue=63;Ue>0&&x[Ue]==0;)Ue--;if(Ue==0)return we(me),D;for(var xe,te=1;te<=Ue;){for(var nt=te;x[te]==0&&te<=Ue;)++te;var Re=te-nt;if(Re>=16){xe=Re>>4;for(var ot=1;ot<=xe;++ot)we(Y);Re&=15}de=32767+x[te],we(X[(Re<<4)+p[de]]),we(d[de]),te++}return Ue!=63&&we(me),D}function ve(S){S=Math.min(Math.max(S,1),100),i!=S&&(function(L){for(var D=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],R=0;R<64;R++){var X=s((D[R]*L+50)/100);X=Math.min(Math.max(X,1),255),o[O[R]]=X}for(var de=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],me=0;me<64;me++){var Y=s((de[me]*L+50)/100);Y=Math.min(Math.max(Y,1),255),c[O[me]]=Y}for(var oe=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],ue=0,fe=0;fe<8;fe++)for(var Ue=0;Ue<8;Ue++)u[ue]=1/(o[O[ue]]*oe[fe]*oe[Ue]*8),f[ue]=1/(c[O[ue]]*oe[fe]*oe[Ue]*8),ue++}(S<50?Math.floor(5e3/S):Math.floor(200-2*S)),i=S)}this.encode=function(S,L){L&&ve(L),g=new Array,y=0,b=7,le(65496),le(65504),le(16),Q(74),Q(70),Q(73),Q(70),Q(0),Q(1),Q(1),Q(0),le(1),le(1),Q(0),Q(0),function(){le(65499),le(132),Q(0);for(var jt=0;jt<64;jt++)Q(o[jt]);Q(1);for(var ft=0;ft<64;ft++)Q(c[ft])}(),function(jt,ft){le(65472),le(17),Q(8),le(ft),le(jt),Q(3),Q(1),Q(17),Q(0),Q(2),Q(17),Q(1),Q(3),Q(17),Q(1)}(S.width,S.height),function(){le(65476),le(418),Q(0);for(var jt=0;jt<16;jt++)Q(I[jt+1]);for(var ft=0;ft<=11;ft++)Q(P[ft]);Q(16);for(var Ot=0;Ot<16;Ot++)Q(H[Ot+1]);for(var Fe=0;Fe<=161;Fe++)Q(T[Fe]);Q(1);for(var Xe=0;Xe<16;Xe++)Q(j[Xe+1]);for(var At=0;At<=11;At++)Q(z[At]);Q(17);for(var xt=0;xt<16;xt++)Q(K[xt+1]);for(var st=0;st<=161;st++)Q(he[st])}(),le(65498),le(12),Q(3),Q(1),Q(0),Q(2),Q(17),Q(3),Q(17),Q(0),Q(63),Q(0);var D=0,R=0,X=0;y=0,b=7,this.encode.displayName="_encode_";for(var de,me,Y,oe,ue,fe,Ue,xe,te,nt=S.data,Re=S.width,ot=S.height,ze=4*Re,lt=0;lt<ot;){for(de=0;de<ze;){for(ue=ze*lt+de,Ue=-1,xe=0,te=0;te<64;te++)fe=ue+(xe=te>>3)*ze+(Ue=4*(7&te)),lt+xe>=ot&&(fe-=ze*(lt+1+xe-ot)),de+Ue>=ze&&(fe-=de+Ue-ze+4),me=nt[fe++],Y=nt[fe++],oe=nt[fe++],E[te]=(F[me]+F[Y+256|0]+F[oe+512|0]>>16)-128,A[te]=(F[me+768|0]+F[Y+1024|0]+F[oe+1280|0]>>16)-128,C[te]=(F[me+1280|0]+F[Y+1536|0]+F[oe+1792|0]>>16)-128;D=ke(E,u,D,t,n),R=ke(A,f,R,r,a),X=ke(C,f,X,r,a),de+=32}lt+=8}if(b>=0){var Qe=[];Qe[1]=b+1,Qe[0]=(1<<b+1)-1,we(Qe)}return le(65497),new Uint8Array(g)},e=e||50,function(){for(var S=String.fromCharCode,L=0;L<256;L++)N[L]=S(L)}(),t=be(I,P),r=be(j,z),n=be(H,T),a=be(K,he),function(){for(var S=1,L=2,D=1;D<=15;D++){for(var R=S;R<L;R++)p[32767+R]=D,d[32767+R]=[],d[32767+R][1]=D,d[32767+R][0]=R;for(var X=-(L-1);X<=-S;X++)p[32767+X]=D,d[32767+X]=[],d[32767+X][1]=D,d[32767+X][0]=L-1+X;S<<=1,L<<=1}}(),function(){for(var S=0;S<256;S++)F[S]=19595*S,F[S+256|0]=38470*S,F[S+512|0]=7471*S+32768,F[S+768|0]=-11059*S,F[S+1024|0]=-21709*S,F[S+1280|0]=32768*S+8421375,F[S+1536|0]=-27439*S,F[S+1792|0]=-5329*S}(),ve(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Pi(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function J_(e){function t(P){if(!P)throw Error("assert :P")}function r(P,H,T){for(var j=0;4>j;j++)if(P[H+j]!=T.charCodeAt(j))return!0;return!1}function n(P,H,T,j,z){for(var K=0;K<z;K++)P[H+K]=T[j+K]}function a(P,H,T,j){for(var z=0;z<j;z++)P[H+z]=T}function i(P){return new Int32Array(P)}function s(P,H){for(var T=[],j=0;j<P;j++)T.push(new H);return T}function o(P,H){var T=[];return function j(z,K,he){for(var be=he[K],we=0;we<be&&(z.push(he.length>K+1?[]:new H),!(he.length<K+1));we++)j(z[we],K+1,he)}(T,0,P),T}var c=function(){var P=this;function H(m,v){for(var _=1<<v-1>>>0;m&_;)_>>>=1;return _?(m&_-1)+_:m}function T(m,v,_,k,B){t(!(k%_));do m[v+(k-=_)]=B;while(0<k)}function j(m,v,_,k,B){if(t(2328>=B),512>=B)var W=i(512);else if((W=i(B))==null)return 0;return function(G,V,J,re,ge,Te){var ne,ye,Ne=V,Ie=1<<J,je=i(16),Me=i(16);for(t(ge!=0),t(re!=null),t(G!=null),t(0<J),ye=0;ye<ge;++ye){if(15<re[ye])return 0;++je[re[ye]]}if(je[0]==ge)return 0;for(Me[1]=0,ne=1;15>ne;++ne){if(je[ne]>1<<ne)return 0;Me[ne+1]=Me[ne]+je[ne]}for(ye=0;ye<ge;++ye)ne=re[ye],0<re[ye]&&(Te[Me[ne]++]=ye);if(Me[15]==1)return(re=new z).g=0,re.value=Te[0],T(G,Ne,1,Ie,re),Ie;var $e,Ve=-1,We=Ie-1,Nt=0,ut=1,Mt=1,vt=1<<J;for(ye=0,ne=1,ge=2;ne<=J;++ne,ge<<=1){if(ut+=Mt<<=1,0>(Mt-=je[ne]))return 0;for(;0<je[ne];--je[ne])(re=new z).g=ne,re.value=Te[ye++],T(G,Ne+Nt,ge,vt,re),Nt=H(Nt,ne)}for(ne=J+1,ge=2;15>=ne;++ne,ge<<=1){if(ut+=Mt<<=1,0>(Mt-=je[ne]))return 0;for(;0<je[ne];--je[ne]){if(re=new z,(Nt&We)!=Ve){for(Ne+=vt,$e=1<<(Ve=ne)-J;15>Ve&&!(0>=($e-=je[Ve]));)++Ve,$e<<=1;Ie+=vt=1<<($e=Ve-J),G[V+(Ve=Nt&We)].g=$e+J,G[V+Ve].value=Ne-V-Ve}re.g=ne-J,re.value=Te[ye++],T(G,Ne+(Nt>>J),ge,vt,re),Nt=H(Nt,ne)}}return ut!=2*Me[15]-1?0:Ie}(m,v,_,k,B,W)}function z(){this.value=this.g=0}function K(){this.value=this.g=0}function he(){this.G=s(5,z),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s(Gi,K)}function be(m,v,_,k){t(m!=null),t(v!=null),t(2147483648>k),m.Ca=254,m.I=0,m.b=-8,m.Ka=0,m.oa=v,m.pa=_,m.Jd=v,m.Yc=_+k,m.Zc=4<=k?_+k-4+1:_,me(m)}function we(m,v){for(var _=0;0<v--;)_|=oe(m,128)<<v;return _}function Q(m,v){var _=we(m,v);return Y(m)?-_:_}function le(m,v,_,k){var B,W=0;for(t(m!=null),t(v!=null),t(4294967288>k),m.Sb=k,m.Ra=0,m.u=0,m.h=0,4<k&&(k=4),B=0;B<k;++B)W+=v[_+B]<<8*B;m.Ra=W,m.bb=k,m.oa=v,m.pa=_}function ke(m){for(;8<=m.u&&m.bb<m.Sb;)m.Ra>>>=8,m.Ra+=m.oa[m.pa+m.bb]<<ao-8>>>0,++m.bb,m.u-=8;R(m)&&(m.h=1,m.u=0)}function ve(m,v){if(t(0<=v),!m.h&&v<=Mu){var _=D(m)&no[v];return m.u+=v,ke(m),_}return m.h=1,m.u=0}function S(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function L(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function D(m){return m.Ra>>>(m.u&ao-1)>>>0}function R(m){return t(m.bb<=m.Sb),m.h||m.bb==m.Sb&&m.u>ao}function X(m,v){m.u=v,m.h=R(m)}function de(m){m.u>=Gr&&(t(m.u>=Gr),ke(m))}function me(m){t(m!=null&&m.oa!=null),m.pa<m.Zc?(m.I=(m.oa[m.pa++]|m.I<<8)>>>0,m.b+=8):(t(m!=null&&m.oa!=null),m.pa<m.Yc?(m.b+=8,m.I=m.oa[m.pa++]|m.I<<8):m.Ka?m.b=0:(m.I<<=8,m.b+=8,m.Ka=1))}function Y(m){return we(m,1)}function oe(m,v){var _=m.Ca;0>m.b&&me(m);var k=m.b,B=_*v>>>8,W=(m.I>>>k>B)+0;for(W?(_-=B,m.I-=B+1<<k>>>0):_=B+1,k=_,B=0;256<=k;)B+=8,k>>=8;return k=7^B+sm[k],m.b-=k,m.Ca=(_<<k)-1,W}function ue(m,v,_){m[v+0]=_>>24&255,m[v+1]=_>>16&255,m[v+2]=_>>8&255,m[v+3]=255&_}function fe(m,v){return m[v+0]|m[v+1]<<8}function Ue(m,v){return fe(m,v)|m[v+2]<<16}function xe(m,v){return fe(m,v)|fe(m,v+2)<<16}function te(m,v){var _=1<<v;return t(m!=null),t(0<v),m.X=i(_),m.X==null?0:(m.Mb=32-v,m.Xa=v,1)}function nt(m,v){t(m!=null),t(v!=null),t(m.Xa==v.Xa),n(v.X,0,m.X,0,1<<v.Xa)}function Re(){this.X=[],this.Xa=this.Mb=0}function ot(m,v,_,k){t(_!=null),t(k!=null);var B=_[0],W=k[0];return B==0&&(B=(m*W+v/2)/v),W==0&&(W=(v*B+m/2)/m),0>=B||0>=W?0:(_[0]=B,k[0]=W,1)}function ze(m,v){return m+(1<<v)-1>>>v}function lt(m,v){return((4278255360&m)+(4278255360&v)>>>0&4278255360)+((16711935&m)+(16711935&v)>>>0&16711935)>>>0}function Qe(m,v){P[v]=function(_,k,B,W,G,V,J){var re;for(re=0;re<G;++re){var ge=P[m](V[J+re-1],B,W+re);V[J+re]=lt(_[k+re],ge)}}}function jt(){this.ud=this.hd=this.jd=0}function ft(m,v){return((4278124286&(m^v))>>>1)+(m&v)>>>0}function Ot(m){return 0<=m&&256>m?m:0>m?0:255<m?255:void 0}function Fe(m,v){return Ot(m+(m-v+.5>>1))}function Xe(m,v,_){return Math.abs(v-_)-Math.abs(m-_)}function At(m,v,_,k,B,W,G){for(k=W[G-1],_=0;_<B;++_)W[G+_]=k=lt(m[v+_],k)}function xt(m,v,_,k,B){var W;for(W=0;W<_;++W){var G=m[v+W],V=G>>8&255,J=16711935&(J=(J=16711935&G)+((V<<16)+V));k[B+W]=(4278255360&G)+J>>>0}}function st(m,v){v.jd=255&m,v.hd=m>>8&255,v.ud=m>>16&255}function pt(m,v,_,k,B,W){var G;for(G=0;G<k;++G){var V=v[_+G],J=V>>>8,re=V,ge=255&(ge=(ge=V>>>16)+((m.jd<<24>>24)*(J<<24>>24)>>>5));re=255&(re=(re+=(m.hd<<24>>24)*(J<<24>>24)>>>5)+((m.ud<<24>>24)*(ge<<24>>24)>>>5)),B[W+G]=(4278255360&V)+(ge<<16)+re}}function dt(m,v,_,k,B){P[v]=function(W,G,V,J,re,ge,Te,ne,ye){for(J=Te;J<ne;++J)for(Te=0;Te<ye;++Te)re[ge++]=B(V[k(W[G++])])},P[m]=function(W,G,V,J,re,ge,Te){var ne=8>>W.b,ye=W.Ea,Ne=W.K[0],Ie=W.w;if(8>ne)for(W=(1<<W.b)-1,Ie=(1<<ne)-1;G<V;++G){var je,Me=0;for(je=0;je<ye;++je)je&W||(Me=k(J[re++])),ge[Te++]=B(Ne[Me&Ie]),Me>>=ne}else P["VP8LMapColor"+_](J,re,Ne,Ie,ge,Te,G,V,ye)}}function Qt(m,v,_,k,B){for(_=v+_;v<_;){var W=m[v++];k[B++]=W>>16&255,k[B++]=W>>8&255,k[B++]=255&W}}function $t(m,v,_,k,B){for(_=v+_;v<_;){var W=m[v++];k[B++]=W>>16&255,k[B++]=W>>8&255,k[B++]=255&W,k[B++]=W>>24&255}}function mt(m,v,_,k,B){for(_=v+_;v<_;){var W=(G=m[v++])>>16&240|G>>12&15,G=240&G|G>>28&15;k[B++]=W,k[B++]=G}}function Tt(m,v,_,k,B){for(_=v+_;v<_;){var W=(G=m[v++])>>16&248|G>>13&7,G=G>>5&224|G>>3&31;k[B++]=W,k[B++]=G}}function er(m,v,_,k,B){for(_=v+_;v<_;){var W=m[v++];k[B++]=255&W,k[B++]=W>>8&255,k[B++]=W>>16&255}}function Pe(m,v,_,k,B,W){if(W==0)for(_=v+_;v<_;)ue(k,((W=m[v++])[0]>>24|W[1]>>8&65280|W[2]<<8&16711680|W[3]<<24)>>>0),B+=32;else n(k,B,m,v,_)}function tt(m,v){P[v][0]=P[m+"0"],P[v][1]=P[m+"1"],P[v][2]=P[m+"2"],P[v][3]=P[m+"3"],P[v][4]=P[m+"4"],P[v][5]=P[m+"5"],P[v][6]=P[m+"6"],P[v][7]=P[m+"7"],P[v][8]=P[m+"8"],P[v][9]=P[m+"9"],P[v][10]=P[m+"10"],P[v][11]=P[m+"11"],P[v][12]=P[m+"12"],P[v][13]=P[m+"13"],P[v][14]=P[m+"0"],P[v][15]=P[m+"0"]}function bt(m){return m==cm||m==um||m==D0||m==fm}function Xt(){this.eb=[],this.size=this.A=this.fb=0}function wr(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Wt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Xt,this.f.kb=new wr,this.sd=null}function _t(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Ut(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function ir(m){return alert("todo:WebPSamplerProcessPlane"),m.T}function Dr(m,v){var _=m.T,k=v.ba.f.RGBA,B=k.eb,W=k.fb+m.ka*k.A,G=ni[v.ba.S],V=m.y,J=m.O,re=m.f,ge=m.N,Te=m.ea,ne=m.W,ye=v.cc,Ne=v.dc,Ie=v.Mc,je=v.Nc,Me=m.ka,$e=m.ka+m.T,Ve=m.U,We=Ve+1>>1;for(Me==0?G(V,J,null,null,re,ge,Te,ne,re,ge,Te,ne,B,W,null,null,Ve):(G(v.ec,v.fc,V,J,ye,Ne,Ie,je,re,ge,Te,ne,B,W-k.A,B,W,Ve),++_);Me+2<$e;Me+=2)ye=re,Ne=ge,Ie=Te,je=ne,ge+=m.Rc,ne+=m.Rc,W+=2*k.A,G(V,(J+=2*m.fa)-m.fa,V,J,ye,Ne,Ie,je,re,ge,Te,ne,B,W-k.A,B,W,Ve);return J+=m.fa,m.j+$e<m.o?(n(v.ec,v.fc,V,J,Ve),n(v.cc,v.dc,re,ge,We),n(v.Mc,v.Nc,Te,ne,We),_--):1&$e||G(V,J,null,null,re,ge,Te,ne,re,ge,Te,ne,B,W+k.A,null,null,Ve),_}function dn(m,v,_){var k=m.F,B=[m.J];if(k!=null){var W=m.U,G=v.ba.S,V=G==F0||G==D0;v=v.ba.f.RGBA;var J=[0],re=m.ka;J[0]=m.T,m.Kb&&(re==0?--J[0]:(--re,B[0]-=m.width),m.j+m.ka+m.T==m.o&&(J[0]=m.o-m.j-re));var ge=v.eb;re=v.fb+re*v.A,m=O2(k,B[0],m.width,W,J,ge,re+(V?0:3),v.A),t(_==J),m&&bt(G)&&$u(ge,re,V,W,J,v.A)}return 0}function Cn(m){var v=m.ma,_=v.ba.S,k=11>_,B=_==O0||_==L0||_==F0||_==lm||_==12||bt(_);if(v.memory=null,v.Ib=null,v.Jb=null,v.Nd=null,!va(v.Oa,m,B?11:12))return 0;if(B&&bt(_)&&Lu(),m.da)alert("todo:use_scaling");else{if(k){if(v.Ib=ir,m.Kb){if(_=m.U+1>>1,v.memory=i(m.U+2*_),v.memory==null)return 0;v.ec=v.memory,v.fc=0,v.cc=v.ec,v.dc=v.fc+m.U,v.Mc=v.cc,v.Nc=v.dc+_,v.Ib=Dr,Lu()}}else alert("todo:EmitYUV");B&&(v.Jb=dn,k&&rl())}if(k&&!Y2){for(m=0;256>m;++m)Hj[m]=89858*(m-128)+M0>>I0,Kj[m]=-22014*(m-128)+M0,Vj[m]=-45773*(m-128),Gj[m]=113618*(m-128)+M0>>I0;for(m=qu;m<pm;++m)v=76283*(m-16)+M0>>I0,Yj[m-qu]=pn(v,255),Xj[m-qu]=pn(v+8>>4,15);Y2=1}return 1}function Et(m){var v=m.ma,_=m.U,k=m.T;return t(!(1&m.ka)),0>=_||0>=k?0:(_=v.Ib(m,v),v.Jb!=null&&v.Jb(m,v,_),v.Dc+=_,1)}function yi(m){m.ma.memory=null}function bi(m,v,_,k){return ve(m,8)!=47?0:(v[0]=ve(m,14)+1,_[0]=ve(m,14)+1,k[0]=ve(m,1),ve(m,3)!=0?0:!m.h)}function Vn(m,v){if(4>m)return m+1;var _=m-2>>1;return(2+(1&m)<<_)+ve(v,_)+1}function xa(m,v){return 120<v?v-120:1<=(_=((_=Cj[v-1])>>4)*m+(8-(15&_)))?_:1;var _}function Cr(m,v,_){var k=D(_),B=m[v+=255&k].g-8;return 0<B&&(X(_,_.u+8),k=D(_),v+=m[v].value,v+=k&(1<<B)-1),X(_,_.u+m[v].g),m[v].value}function rn(m,v,_){return _.g+=m.g,_.value+=m.value<<v>>>0,t(8>=_.g),m.g}function q(m,v,_){var k=m.xc;return t((v=k==0?0:m.vc[m.md*(_>>k)+(v>>k)])<m.Wb),m.Ya[v]}function ae(m,v,_,k){var B=m.ab,W=m.c*v,G=m.C;v=G+v;var V=_,J=k;for(k=m.Ta,_=m.Ua;0<B--;){var re=m.gc[B],ge=G,Te=v,ne=V,ye=J,Ne=(J=k,V=_,re.Ea);switch(t(ge<Te),t(Te<=re.nc),re.hc){case 2:oc(ne,ye,(Te-ge)*Ne,J,V);break;case 0:var Ie=ge,je=Te,Me=J,$e=V,Ve=(vt=re).Ea;Ie==0&&(Vi(ne,ye,null,null,1,Me,$e),At(ne,ye+1,0,0,Ve-1,Me,$e+1),ye+=Ve,$e+=Ve,++Ie);for(var We=1<<vt.b,Nt=We-1,ut=ze(Ve,vt.b),Mt=vt.K,vt=vt.w+(Ie>>vt.b)*ut;Ie<je;){var Ht=Mt,mn=vt,Rt=1;for(Ki(ne,ye,Me,$e-Ve,1,Me,$e);Rt<Ve;){var yt=(Rt&~Nt)+We;yt>Ve&&(yt=Ve),(0,il[Ht[mn++]>>8&15])(ne,ye+ +Rt,Me,$e+Rt-Ve,yt-Rt,Me,$e+Rt),Rt=yt}ye+=Ve,$e+=Ve,++Ie&Nt||(vt+=ut)}Te!=re.nc&&n(J,V-Ne,J,V+(Te-ge-1)*Ne,Ne);break;case 1:for(Ne=ne,je=ye,Ve=(ne=re.Ea)-($e=ne&~(Me=(ye=1<<re.b)-1)),Ie=ze(ne,re.b),We=re.K,re=re.w+(ge>>re.b)*Ie;ge<Te;){for(Nt=We,ut=re,Mt=new jt,vt=je+$e,Ht=je+ne;je<vt;)st(Nt[ut++],Mt),ys(Mt,Ne,je,ye,J,V),je+=ye,V+=ye;je<Ht&&(st(Nt[ut++],Mt),ys(Mt,Ne,je,Ve,J,V),je+=Ve,V+=Ve),++ge&Me||(re+=Ie)}break;case 3:if(ne==J&&ye==V&&0<re.b){for(je=J,ne=Ne=V+(Te-ge)*Ne-($e=(Te-ge)*ze(re.Ea,re.b)),ye=J,Me=V,Ie=[],$e=(Ve=$e)-1;0<=$e;--$e)Ie[$e]=ye[Me+$e];for($e=Ve-1;0<=$e;--$e)je[ne+$e]=Ie[$e];Ru(re,ge,Te,J,Ne,J,V)}else Ru(re,ge,Te,ne,ye,J,V)}V=k,J=_}J!=_&&n(k,_,V,J,W)}function Z(m,v){var _=m.V,k=m.Ba+m.c*m.C,B=v-m.C;if(t(v<=m.l.o),t(16>=B),0<B){var W=m.l,G=m.Ta,V=m.Ua,J=W.width;if(ae(m,B,_,k),B=V=[V],t((_=m.C)<(k=v)),t(W.v<W.va),k>W.o&&(k=W.o),_<W.j){var re=W.j-_;_=W.j,B[0]+=re*J}if(_>=k?_=0:(B[0]+=4*W.v,W.ka=_-W.j,W.U=W.va-W.v,W.T=k-_,_=1),_){if(V=V[0],11>(_=m.ca).S){var ge=_.f.RGBA,Te=(k=_.S,B=W.U,W=W.T,re=ge.eb,ge.A),ne=W;for(ge=ge.fb+m.Ma*ge.A;0<ne--;){var ye=G,Ne=V,Ie=B,je=re,Me=ge;switch(k){case C0:Bu(ye,Ne,Ie,je,Me);break;case O0:ka(ye,Ne,Ie,je,Me);break;case cm:ka(ye,Ne,Ie,je,Me),$u(je,Me,0,Ie,1,0);break;case B2:Nr(ye,Ne,Ie,je,Me);break;case L0:Pe(ye,Ne,Ie,je,Me,1);break;case um:Pe(ye,Ne,Ie,je,Me,1),$u(je,Me,0,Ie,1,0);break;case F0:Pe(ye,Ne,Ie,je,Me,0);break;case D0:Pe(ye,Ne,Ie,je,Me,0),$u(je,Me,1,Ie,1,0);break;case lm:Yi(ye,Ne,Ie,je,Me);break;case fm:Yi(ye,Ne,Ie,je,Me),C2(je,Me,Ie,1,0);break;case U2:_r(ye,Ne,Ie,je,Me);break;default:t(0)}V+=J,ge+=Te}m.Ma+=W}else alert("todo:EmitRescaledRowsYUVA");t(m.Ma<=_.height)}}m.C=v,t(m.C<=m.i)}function ee(m){var v;if(0<m.ua)return 0;for(v=0;v<m.Wb;++v){var _=m.Ya[v].G,k=m.Ya[v].H;if(0<_[1][k[1]+0].g||0<_[2][k[2]+0].g||0<_[3][k[3]+0].g)return 0}return 1}function ie(m,v,_,k,B,W){if(m.Z!=0){var G=m.qd,V=m.rd;for(t(so[m.Z]!=null);v<_;++v)so[m.Z](G,V,k,B,k,B,W),G=k,V=B,B+=W;m.qd=G,m.rd=V}}function ce(m,v){var _=m.l.ma,k=_.Z==0||_.Z==1?m.l.j:m.C;if(k=m.C<k?k:m.C,t(v<=m.l.o),v>k){var B=m.l.width,W=_.ca,G=_.tb+B*k,V=m.V,J=m.Ba+m.c*k,re=m.gc;t(m.ab==1),t(re[0].hc==3),cc(re[0],k,v,V,J,W,G),ie(_,k,v,W,G,B)}m.C=m.Ma=v}function Se(m,v,_,k,B,W,G){var V=m.$/k,J=m.$%k,re=m.m,ge=m.s,Te=_+m.$,ne=Te;B=_+k*B;var ye=_+k*W,Ne=280+ge.ua,Ie=m.Pb?V:16777216,je=0<ge.ua?ge.Wa:null,Me=ge.wc,$e=Te<ye?q(ge,J,V):null;t(m.C<W),t(ye<=B);var Ve=!1;e:for(;;){for(;Ve||Te<ye;){var We=0;if(V>=Ie){var Nt=Te-_;t((Ie=m).Pb),Ie.wd=Ie.m,Ie.xd=Nt,0<Ie.s.ua&&nt(Ie.s.Wa,Ie.s.vb),Ie=V+Lj}if(J&Me||($e=q(ge,J,V)),t($e!=null),$e.Qb&&(v[Te]=$e.qb,Ve=!0),!Ve)if(de(re),$e.jc){We=re,Nt=v;var ut=Te,Mt=$e.pd[D(We)&Gi-1];t($e.jc),256>Mt.g?(X(We,We.u+Mt.g),Nt[ut]=Mt.value,We=0):(X(We,We.u+Mt.g-256),t(256<=Mt.value),We=Mt.value),We==0&&(Ve=!0)}else We=Cr($e.G[0],$e.H[0],re);if(re.h)break;if(Ve||256>We){if(!Ve)if($e.nd)v[Te]=($e.qb|We<<8)>>>0;else{if(de(re),Ve=Cr($e.G[1],$e.H[1],re),de(re),Nt=Cr($e.G[2],$e.H[2],re),ut=Cr($e.G[3],$e.H[3],re),re.h)break;v[Te]=(ut<<24|Ve<<16|We<<8|Nt)>>>0}if(Ve=!1,++Te,++J>=k&&(J=0,++V,G!=null&&V<=W&&!(V%16)&&G(m,V),je!=null))for(;ne<Te;)We=v[ne++],je.X[(506832829*We&4294967295)>>>je.Mb]=We}else if(280>We){if(We=Vn(We-256,re),Nt=Cr($e.G[4],$e.H[4],re),de(re),Nt=xa(k,Nt=Vn(Nt,re)),re.h)break;if(Te-_<Nt||B-Te<We)break e;for(ut=0;ut<We;++ut)v[Te+ut]=v[Te+ut-Nt];for(Te+=We,J+=We;J>=k;)J-=k,++V,G!=null&&V<=W&&!(V%16)&&G(m,V);if(t(Te<=B),J&Me&&($e=q(ge,J,V)),je!=null)for(;ne<Te;)We=v[ne++],je.X[(506832829*We&4294967295)>>>je.Mb]=We}else{if(!(We<Ne))break e;for(Ve=We-280,t(je!=null);ne<Te;)We=v[ne++],je.X[(506832829*We&4294967295)>>>je.Mb]=We;We=Te,t(!(Ve>>>(Nt=je).Xa)),v[We]=Nt.X[Ve],Ve=!0}Ve||t(re.h==R(re))}if(m.Pb&&re.h&&Te<B)t(m.m.h),m.a=5,m.m=m.wd,m.$=m.xd,0<m.s.ua&&nt(m.s.vb,m.s.Wa);else{if(re.h)break e;G!=null&&G(m,V>W?W:V),m.a=0,m.$=Te-_}return 1}return m.a=3,0}function Le(m){t(m!=null),m.vc=null,m.yc=null,m.Ya=null;var v=m.Wa;v!=null&&(v.X=null),m.vb=null,t(m!=null)}function Ae(){var m=new Ir;return m==null?null:(m.a=0,m.xb=q2,tt("Predictor","VP8LPredictors"),tt("Predictor","VP8LPredictors_C"),tt("PredictorAdd","VP8LPredictorsAdd"),tt("PredictorAdd","VP8LPredictorsAdd_C"),oc=xt,ys=pt,Bu=Qt,ka=$t,Yi=mt,_r=Tt,Nr=er,P.VP8LMapColor32b=lc,P.VP8LMapColor8b=al,m)}function Ee(m,v,_,k,B){var W=1,G=[m],V=[v],J=k.m,re=k.s,ge=null,Te=0;e:for(;;){if(_)for(;W&&ve(J,1);){var ne=G,ye=V,Ne=k,Ie=1,je=Ne.m,Me=Ne.gc[Ne.ab],$e=ve(je,2);if(Ne.Oc&1<<$e)W=0;else{switch(Ne.Oc|=1<<$e,Me.hc=$e,Me.Ea=ne[0],Me.nc=ye[0],Me.K=[null],++Ne.ab,t(4>=Ne.ab),$e){case 0:case 1:Me.b=ve(je,3)+2,Ie=Ee(ze(Me.Ea,Me.b),ze(Me.nc,Me.b),0,Ne,Me.K),Me.K=Me.K[0];break;case 3:var Ve,We=ve(je,8)+1,Nt=16<We?0:4<We?1:2<We?2:3;if(ne[0]=ze(Me.Ea,Nt),Me.b=Nt,Ve=Ie=Ee(We,1,0,Ne,Me.K)){var ut,Mt=We,vt=Me,Ht=1<<(8>>vt.b),mn=i(Ht);if(mn==null)Ve=0;else{var Rt=vt.K[0],yt=vt.w;for(mn[0]=vt.K[0][0],ut=1;ut<1*Mt;++ut)mn[ut]=lt(Rt[yt+ut],mn[ut-1]);for(;ut<4*Ht;++ut)mn[ut]=0;vt.K[0]=null,vt.K[0]=mn,Ve=1}}Ie=Ve;break;case 2:break;default:t(0)}W=Ie}}if(G=G[0],V=V[0],W&&ve(J,1)&&!(W=1<=(Te=ve(J,4))&&11>=Te)){k.a=3;break e}var rt;if(rt=W)t:{var Yr,Dt,Kt,jr=k,Ln=G,la=V,Rr=Te,Yn=_,ca=jr.m,gn=jr.s,Yt=[null],sr=1,Br=0,or=Oj[Rr];r:for(;;){if(Yn&&ve(ca,1)){var Fn=ve(ca,3)+2,Ai=ze(Ln,Fn),Xr=ze(la,Fn),ba=Ai*Xr;if(!Ee(Ai,Xr,0,jr,Yt))break r;for(Yt=Yt[0],gn.xc=Fn,Yr=0;Yr<ba;++Yr){var xr=Yt[Yr]>>8&65535;Yt[Yr]=xr,xr>=sr&&(sr=xr+1)}}if(ca.h)break r;for(Dt=0;5>Dt;++Dt){var xn=$2[Dt];!Dt&&0<Rr&&(xn+=1<<Rr),Br<xn&&(Br=xn)}var Oa=s(sr*or,z),ua=sr,La=s(ua,he);if(La==null)var Fa=null;else t(65536>=ua),Fa=La;var wa=i(Br);if(Fa==null||wa==null||Oa==null){jr.a=1;break r}var Da=Oa;for(Yr=Kt=0;Yr<sr;++Yr){var Sr=Fa[Yr],Ia=Sr.G,Ei=Sr.H,sl=0,_s=1,Dn=0;for(Dt=0;5>Dt;++Dt){xn=$2[Dt],Ia[Dt]=Da,Ei[Dt]=Kt,!Dt&&0<Rr&&(xn+=1<<Rr);a:{var B0,mm=xn,U0=jr,Wu=wa,Qj=Da,eT=Kt,gm=0,oo=U0.m,tT=ve(oo,1);if(a(Wu,0,0,mm),tT){var rT=ve(oo,1)+1,nT=ve(oo,1),J2=ve(oo,nT==0?1:8);Wu[J2]=1,rT==2&&(Wu[J2=ve(oo,8)]=1);var $0=1}else{var Q2=i(19),ey=ve(oo,4)+4;if(19<ey){U0.a=3;var z0=0;break a}for(B0=0;B0<ey;++B0)Q2[kj[B0]]=ve(oo,3);var xm=void 0,Hu=void 0,ty=U0,aT=Q2,q0=mm,ry=Wu,vm=0,lo=ty.m,ny=8,ay=s(128,z);n:for(;j(ay,0,7,aT,19);){if(ve(lo,1)){var iT=2+2*ve(lo,3);if((xm=2+ve(lo,iT))>q0)break n}else xm=q0;for(Hu=0;Hu<q0&&xm--;){de(lo);var iy=ay[0+(127&D(lo))];X(lo,lo.u+iy.g);var fc=iy.value;if(16>fc)ry[Hu++]=fc,fc!=0&&(ny=fc);else{var sT=fc==16,sy=fc-16,oT=Tj[sy],oy=ve(lo,jj[sy])+oT;if(Hu+oy>q0)break n;for(var lT=sT?ny:0;0<oy--;)ry[Hu++]=lT}}vm=1;break n}vm||(ty.a=3),$0=vm}($0=$0&&!oo.h)&&(gm=j(Qj,eT,8,Wu,mm)),$0&&gm!=0?z0=gm:(U0.a=3,z0=0)}if(z0==0)break r;if(_s&&Pj[Dt]==1&&(_s=Da[Kt].g==0),sl+=Da[Kt].g,Kt+=z0,3>=Dt){var Gu,ym=wa[0];for(Gu=1;Gu<xn;++Gu)wa[Gu]>ym&&(ym=wa[Gu]);Dn+=ym}}if(Sr.nd=_s,Sr.Qb=0,_s&&(Sr.qb=(Ia[3][Ei[3]+0].value<<24|Ia[1][Ei[1]+0].value<<16|Ia[2][Ei[2]+0].value)>>>0,sl==0&&256>Ia[0][Ei[0]+0].value&&(Sr.Qb=1,Sr.qb+=Ia[0][Ei[0]+0].value<<8)),Sr.jc=!Sr.Qb&&6>Dn,Sr.jc){var W0,Ns=Sr;for(W0=0;W0<Gi;++W0){var co=W0,uo=Ns.pd[co],H0=Ns.G[0][Ns.H[0]+co];256<=H0.value?(uo.g=H0.g+256,uo.value=H0.value):(uo.g=0,uo.value=0,co>>=rn(H0,8,uo),co>>=rn(Ns.G[1][Ns.H[1]+co],16,uo),co>>=rn(Ns.G[2][Ns.H[2]+co],0,uo),rn(Ns.G[3][Ns.H[3]+co],24,uo))}}}gn.vc=Yt,gn.Wb=sr,gn.Ya=Fa,gn.yc=Oa,rt=1;break t}rt=0}if(!(W=rt)){k.a=3;break e}if(0<Te){if(re.ua=1<<Te,!te(re.Wa,Te)){k.a=1,W=0;break e}}else re.ua=0;var bm=k,ly=G,cT=V,wm=bm.s,_m=wm.xc;if(bm.c=ly,bm.i=cT,wm.md=ze(ly,_m),wm.wc=_m==0?-1:(1<<_m)-1,_){k.xb=Uj;break e}if((ge=i(G*V))==null){k.a=1,W=0;break e}W=(W=Se(k,ge,0,G,V,V,null))&&!J.h;break e}return W?(B!=null?B[0]=ge:(t(ge==null),t(_)),k.$=0,_||Le(re)):Le(re),W}function Ce(m,v){var _=m.c*m.i,k=_+v+16*v;return t(m.c<=v),m.V=i(k),m.V==null?(m.Ta=null,m.Ua=0,m.a=1,0):(m.Ta=m.V,m.Ua=m.Ba+_+v,1)}function Ge(m,v){var _=m.C,k=v-_,B=m.V,W=m.Ba+m.c*_;for(t(v<=m.l.o);0<k;){var G=16<k?16:k,V=m.l.ma,J=m.l.width,re=J*G,ge=V.ca,Te=V.tb+J*_,ne=m.Ta,ye=m.Ua;ae(m,G,B,W),L2(ne,ye,ge,Te,re),ie(V,_,_+G,ge,Te,J),k-=G,B+=G*m.c,_+=G}t(_==v),m.C=m.Ma=v}function Ze(){this.ub=this.yd=this.td=this.Rb=0}function it(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ye(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function at(){this.Yb=function(){var m=[];return function v(_,k,B){for(var W=B[k],G=0;G<W&&(_.push(B.length>k+1?[]:0),!(B.length<k+1));G++)v(_[G],k+1,B)}(m,0,[3,11]),m}()}function Pt(){this.jb=i(3),this.Wc=o([4,8],at),this.Xc=o([4,17],at)}function pr(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function zt(){this.ld=this.La=this.dd=this.tc=0}function Mr(){this.Na=this.la=0}function zi(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function wi(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function qi(){this.uc=this.M=this.Nb=0,this.wa=Array(new zt),this.Y=0,this.ya=Array(new wi),this.aa=0,this.l=new Kn}function ei(){this.y=i(16),this.f=i(8),this.ea=i(8)}function Zs(){this.cb=this.a=0,this.sc="",this.m=new S,this.Od=new Ze,this.Kc=new it,this.ed=new pr,this.Qa=new Ye,this.Ic=this.$c=this.Aa=0,this.D=new qi,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,S),this.ia=0,this.pb=s(4,zi),this.Pa=new Pt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new ei),this.Hd=0,this.rb=Array(new Mr),this.sb=0,this.wa=Array(new zt),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new wi),this.L=this.aa=0,this.gd=o([4,2],zt),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Kn(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Wp(){var m=new Zs;return m!=null&&(m.a=0,m.sc="OK",m.cb=0,m.Xb=0,zu||(zu=hs)),m}function nn(m,v,_){return m.a==0&&(m.a=v,m.sc=_,m.cb=0),0}function N0(m,v,_){return 3<=_&&m[v+0]==157&&m[v+1]==1&&m[v+2]==42}function S0(m,v){if(m==null)return 0;if(m.a=0,m.sc="OK",v==null)return nn(m,2,"null VP8Io passed to VP8GetHeaders()");var _=v.data,k=v.w,B=v.ha;if(4>B)return nn(m,7,"Truncated header.");var W=_[k+0]|_[k+1]<<8|_[k+2]<<16,G=m.Od;if(G.Rb=!(1&W),G.td=W>>1&7,G.yd=W>>4&1,G.ub=W>>5,3<G.td)return nn(m,3,"Incorrect keyframe parameters.");if(!G.yd)return nn(m,4,"Frame not displayable.");k+=3,B-=3;var V=m.Kc;if(G.Rb){if(7>B)return nn(m,7,"cannot parse picture header");if(!N0(_,k,B))return nn(m,3,"Bad code word");V.c=16383&(_[k+4]<<8|_[k+3]),V.Td=_[k+4]>>6,V.i=16383&(_[k+6]<<8|_[k+5]),V.Ud=_[k+6]>>6,k+=7,B-=7,m.za=V.c+15>>4,m.Ub=V.i+15>>4,v.width=V.c,v.height=V.i,v.Da=0,v.j=0,v.v=0,v.va=v.width,v.o=v.height,v.da=0,v.ib=v.width,v.hb=v.height,v.U=v.width,v.T=v.height,a((W=m.Pa).jb,0,255,W.jb.length),t((W=m.Qa)!=null),W.Cb=0,W.Bb=0,W.Fb=1,a(W.Zb,0,0,W.Zb.length),a(W.Lb,0,0,W.Lb)}if(G.ub>B)return nn(m,7,"bad partition length");be(W=m.m,_,k,G.ub),k+=G.ub,B-=G.ub,G.Rb&&(V.Ld=Y(W),V.Kd=Y(W)),V=m.Qa;var J,re=m.Pa;if(t(W!=null),t(V!=null),V.Cb=Y(W),V.Cb){if(V.Bb=Y(W),Y(W)){for(V.Fb=Y(W),J=0;4>J;++J)V.Zb[J]=Y(W)?Q(W,7):0;for(J=0;4>J;++J)V.Lb[J]=Y(W)?Q(W,6):0}if(V.Bb)for(J=0;3>J;++J)re.jb[J]=Y(W)?we(W,8):255}else V.Bb=0;if(W.Ka)return nn(m,3,"cannot parse segment header");if((V=m.ed).zd=Y(W),V.Tb=we(W,6),V.wb=we(W,3),V.Pc=Y(W),V.Pc&&Y(W)){for(re=0;4>re;++re)Y(W)&&(V.vd[re]=Q(W,6));for(re=0;4>re;++re)Y(W)&&(V.od[re]=Q(W,6))}if(m.L=V.Tb==0?0:V.zd?1:2,W.Ka)return nn(m,3,"cannot parse filter header");var ge=B;if(B=J=k,k=J+ge,V=ge,m.Xb=(1<<we(m.m,2))-1,ge<3*(re=m.Xb))_=7;else{for(J+=3*re,V-=3*re,ge=0;ge<re;++ge){var Te=_[B+0]|_[B+1]<<8|_[B+2]<<16;Te>V&&(Te=V),be(m.Jc[+ge],_,J,Te),J+=Te,V-=Te,B+=3}be(m.Jc[+re],_,J,V),_=J<k?0:5}if(_!=0)return nn(m,_,"cannot parse partitions");for(_=we(J=m.m,7),B=Y(J)?Q(J,4):0,k=Y(J)?Q(J,4):0,V=Y(J)?Q(J,4):0,re=Y(J)?Q(J,4):0,J=Y(J)?Q(J,4):0,ge=m.Qa,Te=0;4>Te;++Te){if(ge.Cb){var ne=ge.Zb[Te];ge.Fb||(ne+=_)}else{if(0<Te){m.pb[Te]=m.pb[0];continue}ne=_}var ye=m.pb[Te];ye.Sc[0]=dm[pn(ne+B,127)],ye.Sc[1]=hm[pn(ne+0,127)],ye.Eb[0]=2*dm[pn(ne+k,127)],ye.Eb[1]=101581*hm[pn(ne+V,127)]>>16,8>ye.Eb[1]&&(ye.Eb[1]=8),ye.Qc[0]=dm[pn(ne+re,117)],ye.Qc[1]=hm[pn(ne+J,127)],ye.lc=ne+J}if(!G.Rb)return nn(m,4,"Not a key frame.");for(Y(W),G=m.Pa,_=0;4>_;++_){for(B=0;8>B;++B)for(k=0;3>k;++k)for(V=0;11>V;++V)re=oe(W,Rj[_][B][k][V])?we(W,8):Ij[_][B][k][V],G.Wc[_][B].Yb[k][V]=re;for(B=0;17>B;++B)G.Xc[_][B]=G.Wc[_][Bj[B]]}return m.kc=Y(W),m.kc&&(m.Bd=we(W,8)),m.cb=1}function hs(m,v,_,k,B,W,G){var V=v[B].Yb[_];for(_=0;16>B;++B){if(!oe(m,V[_+0]))return B;for(;!oe(m,V[_+1]);)if(V=v[++B].Yb[0],_=0,B==16)return 16;var J=v[B+1].Yb;if(oe(m,V[_+2])){var re=m,ge=0;if(oe(re,(ne=V)[(Te=_)+3]))if(oe(re,ne[Te+6])){for(V=0,Te=2*(ge=oe(re,ne[Te+8]))+(ne=oe(re,ne[Te+9+ge])),ge=0,ne=Fj[Te];ne[V];++V)ge+=ge+oe(re,ne[V]);ge+=3+(8<<Te)}else oe(re,ne[Te+7])?(ge=7+2*oe(re,165),ge+=oe(re,145)):ge=5+oe(re,159);else ge=oe(re,ne[Te+4])?3+oe(re,ne[Te+5]):2;V=J[2]}else ge=1,V=J[1];J=G+Dj[B],0>(re=m).b&&me(re);var Te,ne=re.b,ye=(Te=re.Ca>>1)-(re.I>>ne)>>31;--re.b,re.Ca+=ye,re.Ca|=1,re.I-=(Te+1&ye)<<ne,W[J]=((ge^ye)-ye)*k[(0<B)+0]}return 16}function Ko(m){var v=m.rb[m.sb-1];v.la=0,v.Na=0,a(m.zc,0,0,m.zc.length),m.ja=0}function _i(m,v,_,k,B){B=m[v+_+32*k]+(B>>3),m[v+_+32*k]=-256&B?0>B?0:255:B}function Yo(m,v,_,k,B,W){_i(m,v,0,_,k+B),_i(m,v,1,_,k+W),_i(m,v,2,_,k-W),_i(m,v,3,_,k-B)}function Hr(m){return(20091*m>>16)+m}function _u(m,v,_,k){var B,W=0,G=i(16);for(B=0;4>B;++B){var V=m[v+0]+m[v+8],J=m[v+0]-m[v+8],re=(35468*m[v+4]>>16)-Hr(m[v+12]),ge=Hr(m[v+4])+(35468*m[v+12]>>16);G[W+0]=V+ge,G[W+1]=J+re,G[W+2]=J-re,G[W+3]=V-ge,W+=4,v++}for(B=W=0;4>B;++B)V=(m=G[W+0]+4)+G[W+8],J=m-G[W+8],re=(35468*G[W+4]>>16)-Hr(G[W+12]),_i(_,k,0,0,V+(ge=Hr(G[W+4])+(35468*G[W+12]>>16))),_i(_,k,1,0,J+re),_i(_,k,2,0,J-re),_i(_,k,3,0,V-ge),W++,k+=32}function Hp(m,v,_,k){var B=m[v+0]+4,W=35468*m[v+4]>>16,G=Hr(m[v+4]),V=35468*m[v+1]>>16;Yo(_,k,0,B+G,m=Hr(m[v+1]),V),Yo(_,k,1,B+W,m,V),Yo(_,k,2,B-W,m,V),Yo(_,k,3,B-G,m,V)}function Gp(m,v,_,k,B){_u(m,v,_,k),B&&_u(m,v+16,_,k+4)}function Vp(m,v,_,k){Kr(m,v+0,_,k,1),Kr(m,v+32,_,k+128,1)}function Wi(m,v,_,k){var B;for(m=m[v+0]+4,B=0;4>B;++B)for(v=0;4>v;++v)_i(_,k,v,B,m)}function A0(m,v,_,k){m[v+0]&&Xi(m,v+0,_,k),m[v+16]&&Xi(m,v+16,_,k+4),m[v+32]&&Xi(m,v+32,_,k+128),m[v+48]&&Xi(m,v+48,_,k+128+4)}function E0(m,v,_,k){var B,W=i(16);for(B=0;4>B;++B){var G=m[v+0+B]+m[v+12+B],V=m[v+4+B]+m[v+8+B],J=m[v+4+B]-m[v+8+B],re=m[v+0+B]-m[v+12+B];W[0+B]=G+V,W[8+B]=G-V,W[4+B]=re+J,W[12+B]=re-J}for(B=0;4>B;++B)G=(m=W[0+4*B]+3)+W[3+4*B],V=W[1+4*B]+W[2+4*B],J=W[1+4*B]-W[2+4*B],re=m-W[3+4*B],_[k+0]=G+V>>3,_[k+16]=re+J>>3,_[k+32]=G-V>>3,_[k+48]=re-J>>3,k+=64}function Js(m,v,_){var k,B=v-32,W=Ca,G=255-m[B-1];for(k=0;k<_;++k){var V,J=W,re=G+m[v-1];for(V=0;V<_;++V)m[v+V]=J[re+m[B+V]];v+=32}}function Nu(m,v){Js(m,v,4)}function Kp(m,v){Js(m,v,8)}function Yp(m,v){Js(m,v,16)}function Xp(m,v){var _;for(_=0;16>_;++_)n(m,v+32*_,m,v-32,16)}function Su(m,v){var _;for(_=16;0<_;--_)a(m,v,m[v-1],16),v+=32}function Xo(m,v,_){var k;for(k=0;16>k;++k)a(v,_+32*k,m,16)}function Qs(m,v){var _,k=16;for(_=0;16>_;++_)k+=m[v-1+32*_]+m[v+_-32];Xo(k>>5,m,v)}function Zp(m,v){var _,k=8;for(_=0;16>_;++_)k+=m[v-1+32*_];Xo(k>>4,m,v)}function Zo(m,v){var _,k=8;for(_=0;16>_;++_)k+=m[v+_-32];Xo(k>>4,m,v)}function Au(m,v){Xo(128,m,v)}function Lt(m,v,_){return m+2*v+_+2>>2}function Jp(m,v){var _,k=v-32;for(k=new Uint8Array([Lt(m[k-1],m[k+0],m[k+1]),Lt(m[k+0],m[k+1],m[k+2]),Lt(m[k+1],m[k+2],m[k+3]),Lt(m[k+2],m[k+3],m[k+4])]),_=0;4>_;++_)n(m,v+32*_,k,0,k.length)}function Qp(m,v){var _=m[v-1],k=m[v-1+32],B=m[v-1+64],W=m[v-1+96];ue(m,v+0,16843009*Lt(m[v-1-32],_,k)),ue(m,v+32,16843009*Lt(_,k,B)),ue(m,v+64,16843009*Lt(k,B,W)),ue(m,v+96,16843009*Lt(B,W,W))}function em(m,v){var _,k=4;for(_=0;4>_;++_)k+=m[v+_-32]+m[v-1+32*_];for(k>>=3,_=0;4>_;++_)a(m,v+32*_,k,4)}function tm(m,v){var _=m[v-1+0],k=m[v-1+32],B=m[v-1+64],W=m[v-1-32],G=m[v+0-32],V=m[v+1-32],J=m[v+2-32],re=m[v+3-32];m[v+0+96]=Lt(k,B,m[v-1+96]),m[v+1+96]=m[v+0+64]=Lt(_,k,B),m[v+2+96]=m[v+1+64]=m[v+0+32]=Lt(W,_,k),m[v+3+96]=m[v+2+64]=m[v+1+32]=m[v+0+0]=Lt(G,W,_),m[v+3+64]=m[v+2+32]=m[v+1+0]=Lt(V,G,W),m[v+3+32]=m[v+2+0]=Lt(J,V,G),m[v+3+0]=Lt(re,J,V)}function ps(m,v){var _=m[v+1-32],k=m[v+2-32],B=m[v+3-32],W=m[v+4-32],G=m[v+5-32],V=m[v+6-32],J=m[v+7-32];m[v+0+0]=Lt(m[v+0-32],_,k),m[v+1+0]=m[v+0+32]=Lt(_,k,B),m[v+2+0]=m[v+1+32]=m[v+0+64]=Lt(k,B,W),m[v+3+0]=m[v+2+32]=m[v+1+64]=m[v+0+96]=Lt(B,W,G),m[v+3+32]=m[v+2+64]=m[v+1+96]=Lt(W,G,V),m[v+3+64]=m[v+2+96]=Lt(G,V,J),m[v+3+96]=Lt(V,J,J)}function ms(m,v){var _=m[v-1+0],k=m[v-1+32],B=m[v-1+64],W=m[v-1-32],G=m[v+0-32],V=m[v+1-32],J=m[v+2-32],re=m[v+3-32];m[v+0+0]=m[v+1+64]=W+G+1>>1,m[v+1+0]=m[v+2+64]=G+V+1>>1,m[v+2+0]=m[v+3+64]=V+J+1>>1,m[v+3+0]=J+re+1>>1,m[v+0+96]=Lt(B,k,_),m[v+0+64]=Lt(k,_,W),m[v+0+32]=m[v+1+96]=Lt(_,W,G),m[v+1+32]=m[v+2+96]=Lt(W,G,V),m[v+2+32]=m[v+3+96]=Lt(G,V,J),m[v+3+32]=Lt(V,J,re)}function rm(m,v){var _=m[v+0-32],k=m[v+1-32],B=m[v+2-32],W=m[v+3-32],G=m[v+4-32],V=m[v+5-32],J=m[v+6-32],re=m[v+7-32];m[v+0+0]=_+k+1>>1,m[v+1+0]=m[v+0+64]=k+B+1>>1,m[v+2+0]=m[v+1+64]=B+W+1>>1,m[v+3+0]=m[v+2+64]=W+G+1>>1,m[v+0+32]=Lt(_,k,B),m[v+1+32]=m[v+0+96]=Lt(k,B,W),m[v+2+32]=m[v+1+96]=Lt(B,W,G),m[v+3+32]=m[v+2+96]=Lt(W,G,V),m[v+3+64]=Lt(G,V,J),m[v+3+96]=Lt(V,J,re)}function nm(m,v){var _=m[v-1+0],k=m[v-1+32],B=m[v-1+64],W=m[v-1+96];m[v+0+0]=_+k+1>>1,m[v+2+0]=m[v+0+32]=k+B+1>>1,m[v+2+32]=m[v+0+64]=B+W+1>>1,m[v+1+0]=Lt(_,k,B),m[v+3+0]=m[v+1+32]=Lt(k,B,W),m[v+3+32]=m[v+1+64]=Lt(B,W,W),m[v+3+64]=m[v+2+64]=m[v+0+96]=m[v+1+96]=m[v+2+96]=m[v+3+96]=W}function Ql(m,v){var _=m[v-1+0],k=m[v-1+32],B=m[v-1+64],W=m[v-1+96],G=m[v-1-32],V=m[v+0-32],J=m[v+1-32],re=m[v+2-32];m[v+0+0]=m[v+2+32]=_+G+1>>1,m[v+0+32]=m[v+2+64]=k+_+1>>1,m[v+0+64]=m[v+2+96]=B+k+1>>1,m[v+0+96]=W+B+1>>1,m[v+3+0]=Lt(V,J,re),m[v+2+0]=Lt(G,V,J),m[v+1+0]=m[v+3+32]=Lt(_,G,V),m[v+1+32]=m[v+3+64]=Lt(k,_,G),m[v+1+64]=m[v+3+96]=Lt(B,k,_),m[v+1+96]=Lt(W,B,k)}function Eu(m,v){var _;for(_=0;8>_;++_)n(m,v+32*_,m,v-32,8)}function Jo(m,v){var _;for(_=0;8>_;++_)a(m,v,m[v-1],8),v+=32}function ec(m,v,_){var k;for(k=0;8>k;++k)a(v,_+32*k,m,8)}function tc(m,v){var _,k=8;for(_=0;8>_;++_)k+=m[v+_-32]+m[v-1+32*_];ec(k>>4,m,v)}function am(m,v){var _,k=4;for(_=0;8>_;++_)k+=m[v+_-32];ec(k>>3,m,v)}function ju(m,v){var _,k=4;for(_=0;8>_;++_)k+=m[v-1+32*_];ec(k>>3,m,v)}function Tu(m,v){ec(128,m,v)}function Qo(m,v,_){var k=m[v-_],B=m[v+0],W=3*(B-k)+om[1020+m[v-2*_]-m[v+_]],G=k0[112+(W+4>>3)];m[v-_]=Ca[255+k+k0[112+(W+3>>3)]],m[v+0]=Ca[255+B-G]}function el(m,v,_,k){var B=m[v+0],W=m[v+_];return ri[255+m[v-2*_]-m[v-_]]>k||ri[255+W-B]>k}function Pu(m,v,_,k){return 4*ri[255+m[v-_]-m[v+0]]+ri[255+m[v-2*_]-m[v+_]]<=k}function rc(m,v,_,k,B){var W=m[v-3*_],G=m[v-2*_],V=m[v-_],J=m[v+0],re=m[v+_],ge=m[v+2*_],Te=m[v+3*_];return 4*ri[255+V-J]+ri[255+G-re]>k?0:ri[255+m[v-4*_]-W]<=B&&ri[255+W-G]<=B&&ri[255+G-V]<=B&&ri[255+Te-ge]<=B&&ri[255+ge-re]<=B&&ri[255+re-J]<=B}function ku(m,v,_,k){var B=2*k+1;for(k=0;16>k;++k)Pu(m,v+k,_,B)&&Qo(m,v+k,_)}function tl(m,v,_,k){var B=2*k+1;for(k=0;16>k;++k)Pu(m,v+k*_,1,B)&&Qo(m,v+k*_,1)}function Cu(m,v,_,k){var B;for(B=3;0<B;--B)ku(m,v+=4*_,_,k)}function Ou(m,v,_,k){var B;for(B=3;0<B;--B)tl(m,v+=4,_,k)}function Pa(m,v,_,k,B,W,G,V){for(W=2*W+1;0<B--;){if(rc(m,v,_,W,G))if(el(m,v,_,V))Qo(m,v,_);else{var J=m,re=v,ge=_,Te=J[re-2*ge],ne=J[re-ge],ye=J[re+0],Ne=J[re+ge],Ie=J[re+2*ge],je=27*($e=om[1020+3*(ye-ne)+om[1020+Te-Ne]])+63>>7,Me=18*$e+63>>7,$e=9*$e+63>>7;J[re-3*ge]=Ca[255+J[re-3*ge]+$e],J[re-2*ge]=Ca[255+Te+Me],J[re-ge]=Ca[255+ne+je],J[re+0]=Ca[255+ye-je],J[re+ge]=Ca[255+Ne-Me],J[re+2*ge]=Ca[255+Ie-$e]}v+=k}}function Hi(m,v,_,k,B,W,G,V){for(W=2*W+1;0<B--;){if(rc(m,v,_,W,G))if(el(m,v,_,V))Qo(m,v,_);else{var J=m,re=v,ge=_,Te=J[re-ge],ne=J[re+0],ye=J[re+ge],Ne=k0[112+(4+(Ie=3*(ne-Te))>>3)],Ie=k0[112+(Ie+3>>3)],je=Ne+1>>1;J[re-2*ge]=Ca[255+J[re-2*ge]+je],J[re-ge]=Ca[255+Te+Ie],J[re+0]=Ca[255+ne-Ne],J[re+ge]=Ca[255+ye-je]}v+=k}}function w(m,v,_,k,B,W){Pa(m,v,_,1,16,k,B,W)}function U(m,v,_,k,B,W){Pa(m,v,1,_,16,k,B,W)}function se(m,v,_,k,B,W){var G;for(G=3;0<G;--G)Hi(m,v+=4*_,_,1,16,k,B,W)}function pe(m,v,_,k,B,W){var G;for(G=3;0<G;--G)Hi(m,v+=4,1,_,16,k,B,W)}function _e(m,v,_,k,B,W,G,V){Pa(m,v,B,1,8,W,G,V),Pa(_,k,B,1,8,W,G,V)}function Be(m,v,_,k,B,W,G,V){Pa(m,v,1,B,8,W,G,V),Pa(_,k,1,B,8,W,G,V)}function He(m,v,_,k,B,W,G,V){Hi(m,v+4*B,B,1,8,W,G,V),Hi(_,k+4*B,B,1,8,W,G,V)}function gt(m,v,_,k,B,W,G,V){Hi(m,v+4,1,B,8,W,G,V),Hi(_,k+4,1,B,8,W,G,V)}function wt(){this.ba=new Wt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Ut,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function kt(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function It(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function tr(){this.ua=0,this.Wa=new Re,this.vb=new Re,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new he,this.yc=new z}function Ir(){this.xb=this.a=0,this.l=new Kn,this.ca=new Wt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new L,this.Pb=0,this.wd=new L,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new tr,this.ab=0,this.gc=s(4,It),this.Oc=0}function an(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Kn,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function mr(m,v,_,k,B,W,G){for(m=m==null?0:m[v+0],v=0;v<G;++v)B[W+v]=m+_[k+v]&255,m=B[W+v]}function hn(m,v,_,k,B,W,G){var V;if(m==null)mr(null,null,_,k,B,W,G);else for(V=0;V<G;++V)B[W+V]=m[v+V]+_[k+V]&255}function sn(m,v,_,k,B,W,G){if(m==null)mr(null,null,_,k,B,W,G);else{var V,J=m[v+0],re=J,ge=J;for(V=0;V<G;++V)re=ge+(J=m[v+V])-re,ge=_[k+V]+(-256&re?0>re?0:255:re)&255,re=J,B[W+V]=ge}}function On(m,v,_,k){var B=v.width,W=v.o;if(t(m!=null&&v!=null),0>_||0>=k||_+k>W)return null;if(!m.Cc){if(m.ga==null){var G;if(m.ga=new an,(G=m.ga==null)||(G=v.width*v.o,t(m.Gb.length==0),m.Gb=i(G),m.Uc=0,m.Gb==null?G=0:(m.mb=m.Gb,m.nb=m.Uc,m.rc=null,G=1),G=!G),!G){G=m.ga;var V=m.Fa,J=m.P,re=m.qc,ge=m.mb,Te=m.nb,ne=J+1,ye=re-1,Ne=G.l;if(t(V!=null&&ge!=null&&v!=null),so[0]=null,so[1]=mr,so[2]=hn,so[3]=sn,G.ca=ge,G.tb=Te,G.c=v.width,G.i=v.height,t(0<G.c&&0<G.i),1>=re)v=0;else if(G.$a=3&V[J+0],G.Z=V[J+0]>>2&3,G.Lc=V[J+0]>>4&3,J=V[J+0]>>6&3,0>G.$a||1<G.$a||4<=G.Z||1<G.Lc||J)v=0;else if(Ne.put=Et,Ne.ac=Cn,Ne.bc=yi,Ne.ma=G,Ne.width=v.width,Ne.height=v.height,Ne.Da=v.Da,Ne.v=v.v,Ne.va=v.va,Ne.j=v.j,Ne.o=v.o,G.$a)e:{t(G.$a==1),v=Ae();t:for(;;){if(v==null){v=0;break e}if(t(G!=null),G.mc=v,v.c=G.c,v.i=G.i,v.l=G.l,v.l.ma=G,v.l.width=G.c,v.l.height=G.i,v.a=0,le(v.m,V,ne,ye),!Ee(G.c,G.i,1,v,null)||(v.ab==1&&v.gc[0].hc==3&&ee(v.s)?(G.ic=1,V=v.c*v.i,v.Ta=null,v.Ua=0,v.V=i(V),v.Ba=0,v.V==null?(v.a=1,v=0):v=1):(G.ic=0,v=Ce(v,G.c)),!v))break t;v=1;break e}G.mc=null,v=0}else v=ye>=G.c*G.i;G=!v}if(G)return null;m.ga.Lc!=1?m.Ga=0:k=W-_}t(m.ga!=null),t(_+k<=W);e:{if(v=(V=m.ga).c,W=V.l.o,V.$a==0){if(ne=m.rc,ye=m.Vc,Ne=m.Fa,J=m.P+1+_*v,re=m.mb,ge=m.nb+_*v,t(J<=m.P+m.qc),V.Z!=0)for(t(so[V.Z]!=null),G=0;G<k;++G)so[V.Z](ne,ye,Ne,J,re,ge,v),ne=re,ye=ge,ge+=v,J+=v;else for(G=0;G<k;++G)n(re,ge,Ne,J,v),ne=re,ye=ge,ge+=v,J+=v;m.rc=ne,m.Vc=ye}else{if(t(V.mc!=null),v=_+k,t((G=V.mc)!=null),t(v<=G.i),G.C>=v)v=1;else if(V.ic||rl(),V.ic){V=G.V,ne=G.Ba,ye=G.c;var Ie=G.i,je=(Ne=1,J=G.$/ye,re=G.$%ye,ge=G.m,Te=G.s,G.$),Me=ye*Ie,$e=ye*v,Ve=Te.wc,We=je<$e?q(Te,re,J):null;t(je<=Me),t(v<=Ie),t(ee(Te));t:for(;;){for(;!ge.h&&je<$e;){if(re&Ve||(We=q(Te,re,J)),t(We!=null),de(ge),256>(Ie=Cr(We.G[0],We.H[0],ge)))V[ne+je]=Ie,++je,++re>=ye&&(re=0,++J<=v&&!(J%16)&&ce(G,J));else{if(!(280>Ie)){Ne=0;break t}Ie=Vn(Ie-256,ge);var Nt,ut=Cr(We.G[4],We.H[4],ge);if(de(ge),!(je>=(ut=xa(ye,ut=Vn(ut,ge)))&&Me-je>=Ie)){Ne=0;break t}for(Nt=0;Nt<Ie;++Nt)V[ne+je+Nt]=V[ne+je+Nt-ut];for(je+=Ie,re+=Ie;re>=ye;)re-=ye,++J<=v&&!(J%16)&&ce(G,J);je<$e&&re&Ve&&(We=q(Te,re,J))}t(ge.h==R(ge))}ce(G,J>v?v:J);break t}!Ne||ge.h&&je<Me?(Ne=0,G.a=ge.h?5:3):G.$=je,v=Ne}else v=Se(G,G.V,G.Ba,G.c,G.i,v,Ge);if(!v){k=0;break e}}_+k>=W&&(m.Cc=1),k=1}if(!k)return null;if(m.Cc&&((k=m.ga)!=null&&(k.mc=null),m.ga=null,0<m.Ga))return alert("todo:WebPDequantizeLevels"),null}return m.nb+_*B}function gs(m,v,_,k,B,W){for(;0<B--;){var G,V=m,J=v+(_?1:0),re=m,ge=v+(_?0:3);for(G=0;G<k;++G){var Te=re[ge+4*G];Te!=255&&(Te*=32897,V[J+4*G+0]=V[J+4*G+0]*Te>>23,V[J+4*G+1]=V[J+4*G+1]*Te>>23,V[J+4*G+2]=V[J+4*G+2]*Te>>23)}v+=W}}function eo(m,v,_,k,B){for(;0<k--;){var W;for(W=0;W<_;++W){var G=m[v+2*W+0],V=15&(re=m[v+2*W+1]),J=4369*V,re=(240&re|re>>4)*J>>16;m[v+2*W+0]=(240&G|G>>4)*J>>16&240|(15&G|G<<4)*J>>16>>4&15,m[v+2*W+1]=240&re|V}v+=B}}function im(m,v,_,k,B,W,G,V){var J,re,ge=255;for(re=0;re<B;++re){for(J=0;J<k;++J){var Te=m[v+J];W[G+4*J]=Te,ge&=Te}v+=_,G+=V}return ge!=255}function j0(m,v,_,k,B){var W;for(W=0;W<B;++W)_[k+W]=m[v+W]>>8}function rl(){$u=gs,C2=eo,O2=im,L2=j0}function Ni(m,v,_){P[m]=function(k,B,W,G,V,J,re,ge,Te,ne,ye,Ne,Ie,je,Me,$e,Ve){var We,Nt=Ve-1>>1,ut=V[J+0]|re[ge+0]<<16,Mt=Te[ne+0]|ye[Ne+0]<<16;t(k!=null);var vt=3*ut+Mt+131074>>2;for(v(k[B+0],255&vt,vt>>16,Ie,je),W!=null&&(vt=3*Mt+ut+131074>>2,v(W[G+0],255&vt,vt>>16,Me,$e)),We=1;We<=Nt;++We){var Ht=V[J+We]|re[ge+We]<<16,mn=Te[ne+We]|ye[Ne+We]<<16,Rt=ut+Ht+Mt+mn+524296,yt=Rt+2*(Ht+Mt)>>3;vt=yt+ut>>1,ut=(Rt=Rt+2*(ut+mn)>>3)+Ht>>1,v(k[B+2*We-1],255&vt,vt>>16,Ie,je+(2*We-1)*_),v(k[B+2*We-0],255&ut,ut>>16,Ie,je+(2*We-0)*_),W!=null&&(vt=Rt+Mt>>1,ut=yt+mn>>1,v(W[G+2*We-1],255&vt,vt>>16,Me,$e+(2*We-1)*_),v(W[G+2*We+0],255&ut,ut>>16,Me,$e+(2*We+0)*_)),ut=Ht,Mt=mn}1&Ve||(vt=3*ut+Mt+131074>>2,v(k[B+Ve-1],255&vt,vt>>16,Ie,je+(Ve-1)*_),W!=null&&(vt=3*Mt+ut+131074>>2,v(W[G+Ve-1],255&vt,vt>>16,Me,$e+(Ve-1)*_)))}}function Lu(){ni[C0]=$j,ni[O0]=W2,ni[B2]=zj,ni[L0]=H2,ni[F0]=G2,ni[lm]=V2,ni[U2]=qj,ni[cm]=W2,ni[um]=H2,ni[D0]=G2,ni[fm]=V2}function nc(m){return m&~Wj?0>m?0:255:m>>K2}function to(m,v){return nc((19077*m>>8)+(26149*v>>8)-14234)}function _n(m,v,_){return nc((19077*m>>8)-(6419*v>>8)-(13320*_>>8)+8708)}function xs(m,v){return nc((19077*m>>8)+(33050*v>>8)-17685)}function vs(m,v,_,k,B){k[B+0]=to(m,_),k[B+1]=_n(m,v,_),k[B+2]=xs(m,v)}function ac(m,v,_,k,B){k[B+0]=xs(m,v),k[B+1]=_n(m,v,_),k[B+2]=to(m,_)}function Fu(m,v,_,k,B){var W=_n(m,v,_);v=W<<3&224|xs(m,v)>>3,k[B+0]=248&to(m,_)|W>>5,k[B+1]=v}function oa(m,v,_,k,B){var W=240&xs(m,v)|15;k[B+0]=240&to(m,_)|_n(m,v,_)>>4,k[B+1]=W}function T0(m,v,_,k,B){k[B+0]=255,vs(m,v,_,k,B+1)}function ic(m,v,_,k,B){ac(m,v,_,k,B),k[B+3]=255}function P0(m,v,_,k,B){vs(m,v,_,k,B),k[B+3]=255}function pn(m,v){return 0>m?0:m>v?v:m}function ti(m,v,_){P[m]=function(k,B,W,G,V,J,re,ge,Te){for(var ne=ge+(-2&Te)*_;ge!=ne;)v(k[B+0],W[G+0],V[J+0],re,ge),v(k[B+1],W[G+0],V[J+0],re,ge+_),B+=2,++G,++J,ge+=2*_;1&Te&&v(k[B+0],W[G+0],V[J+0],re,ge)}}function Du(m,v,_){return _==0?m==0?v==0?6:5:v==0?4:0:_}function Iu(m,v,_,k,B){switch(m>>>30){case 3:Kr(v,_,k,B,0);break;case 2:bs(v,_,k,B);break;case 1:Xi(v,_,k,B)}}function ro(m,v){var _,k,B=v.M,W=v.Nb,G=m.oc,V=m.pc+40,J=m.oc,re=m.pc+584,ge=m.oc,Te=m.pc+600;for(_=0;16>_;++_)G[V+32*_-1]=129;for(_=0;8>_;++_)J[re+32*_-1]=129,ge[Te+32*_-1]=129;for(0<B?G[V-1-32]=J[re-1-32]=ge[Te-1-32]=129:(a(G,V-32-1,127,21),a(J,re-32-1,127,9),a(ge,Te-32-1,127,9)),k=0;k<m.za;++k){var ne=v.ya[v.aa+k];if(0<k){for(_=-1;16>_;++_)n(G,V+32*_-4,G,V+32*_+12,4);for(_=-1;8>_;++_)n(J,re+32*_-4,J,re+32*_+4,4),n(ge,Te+32*_-4,ge,Te+32*_+4,4)}var ye=m.Gd,Ne=m.Hd+k,Ie=ne.ad,je=ne.Hc;if(0<B&&(n(G,V-32,ye[Ne].y,0,16),n(J,re-32,ye[Ne].f,0,8),n(ge,Te-32,ye[Ne].ea,0,8)),ne.Za){var Me=G,$e=V-32+16;for(0<B&&(k>=m.za-1?a(Me,$e,ye[Ne].y[15],4):n(Me,$e,ye[Ne+1].y,0,4)),_=0;4>_;_++)Me[$e+128+_]=Me[$e+256+_]=Me[$e+384+_]=Me[$e+0+_];for(_=0;16>_;++_,je<<=2)Me=G,$e=V+X2[_],Si[ne.Ob[_]](Me,$e),Iu(je,Ie,16*+_,Me,$e)}else if(Me=Du(k,B,ne.Ob[0]),io[Me](G,V),je!=0)for(_=0;16>_;++_,je<<=2)Iu(je,Ie,16*+_,G,V+X2[_]);for(_=ne.Gc,Me=Du(k,B,ne.Dd),ws[Me](J,re),ws[Me](ge,Te),je=Ie,Me=J,$e=re,255&(ne=0|_)&&(170&ne?uc(je,256,Me,$e):Uu(je,256,Me,$e)),ne=ge,je=Te,255&(_>>=8)&&(170&_?uc(Ie,320,ne,je):Uu(Ie,320,ne,je)),B<m.Ub-1&&(n(ye[Ne].y,0,G,V+480,16),n(ye[Ne].f,0,J,re+224,8),n(ye[Ne].ea,0,ge,Te+224,8)),_=8*W*m.B,ye=m.sa,Ne=m.ta+16*k+16*W*m.R,Ie=m.qa,ne=m.ra+8*k+_,je=m.Ha,Me=m.Ia+8*k+_,_=0;16>_;++_)n(ye,Ne+_*m.R,G,V+32*_,16);for(_=0;8>_;++_)n(Ie,ne+_*m.B,J,re+32*_,8),n(je,Me+_*m.B,ge,Te+32*_,8)}}function sc(m,v,_,k,B,W,G,V,J){var re=[0],ge=[0],Te=0,ne=J!=null?J.kd:0,ye=J??new kt;if(m==null||12>_)return 7;ye.data=m,ye.w=v,ye.ha=_,v=[v],_=[_],ye.gb=[ye.gb];e:{var Ne=v,Ie=_,je=ye.gb;if(t(m!=null),t(Ie!=null),t(je!=null),je[0]=0,12<=Ie[0]&&!r(m,Ne[0],"RIFF")){if(r(m,Ne[0]+8,"WEBP")){je=3;break e}var Me=xe(m,Ne[0]+4);if(12>Me||4294967286<Me){je=3;break e}if(ne&&Me>Ie[0]-8){je=7;break e}je[0]=Me,Ne[0]+=12,Ie[0]-=12}je=0}if(je!=0)return je;for(Me=0<ye.gb[0],_=_[0];;){e:{var $e=m;Ie=v,je=_;var Ve=re,We=ge,Nt=Ne=[0];if((vt=Te=[Te])[0]=0,8>je[0])je=7;else{if(!r($e,Ie[0],"VP8X")){if(xe($e,Ie[0]+4)!=10){je=3;break e}if(18>je[0]){je=7;break e}var ut=xe($e,Ie[0]+8),Mt=1+Ue($e,Ie[0]+12);if(2147483648<=Mt*($e=1+Ue($e,Ie[0]+15))){je=3;break e}Nt!=null&&(Nt[0]=ut),Ve!=null&&(Ve[0]=Mt),We!=null&&(We[0]=$e),Ie[0]+=18,je[0]-=18,vt[0]=1}je=0}}if(Te=Te[0],Ne=Ne[0],je!=0)return je;if(Ie=!!(2&Ne),!Me&&Te)return 3;if(W!=null&&(W[0]=!!(16&Ne)),G!=null&&(G[0]=Ie),V!=null&&(V[0]=0),G=re[0],Ne=ge[0],Te&&Ie&&J==null){je=0;break}if(4>_){je=7;break}if(Me&&Te||!Me&&!Te&&!r(m,v[0],"ALPH")){_=[_],ye.na=[ye.na],ye.P=[ye.P],ye.Sa=[ye.Sa];e:{ut=m,je=v,Me=_;var vt=ye.gb;Ve=ye.na,We=ye.P,Nt=ye.Sa,Mt=22,t(ut!=null),t(Me!=null),$e=je[0];var Ht=Me[0];for(t(Ve!=null),t(Nt!=null),Ve[0]=null,We[0]=null,Nt[0]=0;;){if(je[0]=$e,Me[0]=Ht,8>Ht){je=7;break e}var mn=xe(ut,$e+4);if(4294967286<mn){je=3;break e}var Rt=8+mn+1&-2;if(Mt+=Rt,0<vt&&Mt>vt){je=3;break e}if(!r(ut,$e,"VP8 ")||!r(ut,$e,"VP8L")){je=0;break e}if(Ht[0]<Rt){je=7;break e}r(ut,$e,"ALPH")||(Ve[0]=ut,We[0]=$e+8,Nt[0]=mn),$e+=Rt,Ht-=Rt}}if(_=_[0],ye.na=ye.na[0],ye.P=ye.P[0],ye.Sa=ye.Sa[0],je!=0)break}_=[_],ye.Ja=[ye.Ja],ye.xa=[ye.xa];e:if(vt=m,je=v,Me=_,Ve=ye.gb[0],We=ye.Ja,Nt=ye.xa,ut=je[0],$e=!r(vt,ut,"VP8 "),Mt=!r(vt,ut,"VP8L"),t(vt!=null),t(Me!=null),t(We!=null),t(Nt!=null),8>Me[0])je=7;else{if($e||Mt){if(vt=xe(vt,ut+4),12<=Ve&&vt>Ve-12){je=3;break e}if(ne&&vt>Me[0]-8){je=7;break e}We[0]=vt,je[0]+=8,Me[0]-=8,Nt[0]=Mt}else Nt[0]=5<=Me[0]&&vt[ut+0]==47&&!(vt[ut+4]>>5),We[0]=Me[0];je=0}if(_=_[0],ye.Ja=ye.Ja[0],ye.xa=ye.xa[0],v=v[0],je!=0)break;if(4294967286<ye.Ja)return 3;if(V==null||Ie||(V[0]=ye.xa?2:1),G=[G],Ne=[Ne],ye.xa){if(5>_){je=7;break}V=G,ne=Ne,Ie=W,m==null||5>_?m=0:5<=_&&m[v+0]==47&&!(m[v+4]>>5)?(Me=[0],vt=[0],Ve=[0],le(We=new L,m,v,_),bi(We,Me,vt,Ve)?(V!=null&&(V[0]=Me[0]),ne!=null&&(ne[0]=vt[0]),Ie!=null&&(Ie[0]=Ve[0]),m=1):m=0):m=0}else{if(10>_){je=7;break}V=Ne,m==null||10>_||!N0(m,v+3,_-3)?m=0:(ne=m[v+0]|m[v+1]<<8|m[v+2]<<16,Ie=16383&(m[v+7]<<8|m[v+6]),m=16383&(m[v+9]<<8|m[v+8]),1&ne||3<(ne>>1&7)||!(ne>>4&1)||ne>>5>=ye.Ja||!Ie||!m?m=0:(G&&(G[0]=Ie),V&&(V[0]=m),m=1))}if(!m||(G=G[0],Ne=Ne[0],Te&&(re[0]!=G||ge[0]!=Ne)))return 3;J!=null&&(J[0]=ye,J.offset=v-J.w,t(4294967286>v-J.w),t(J.offset==J.ha-_));break}return je==0||je==7&&Te&&J==null?(W!=null&&(W[0]|=ye.na!=null&&0<ye.na.length),k!=null&&(k[0]=G),B!=null&&(B[0]=Ne),0):je}function va(m,v,_){var k=v.width,B=v.height,W=0,G=0,V=k,J=B;if(v.Da=m!=null&&0<m.Da,v.Da&&(V=m.cd,J=m.bd,W=m.v,G=m.j,11>_||(W&=-2,G&=-2),0>W||0>G||0>=V||0>=J||W+V>k||G+J>B))return 0;if(v.v=W,v.j=G,v.va=W+V,v.o=G+J,v.U=V,v.T=J,v.da=m!=null&&0<m.da,v.da){if(!ot(V,J,_=[m.ib],W=[m.hb]))return 0;v.ib=_[0],v.hb=W[0]}return v.ob=m!=null&&m.ob,v.Kb=m==null||!m.Sd,v.da&&(v.ob=v.ib<3*k/4&&v.hb<3*B/4,v.Kb=0),1}function ya(m){if(m==null)return 2;if(11>m.S){var v=m.f.RGBA;v.fb+=(m.height-1)*v.A,v.A=-v.A}else v=m.f.kb,m=m.height,v.O+=(m-1)*v.fa,v.fa=-v.fa,v.N+=(m-1>>1)*v.Ab,v.Ab=-v.Ab,v.W+=(m-1>>1)*v.Db,v.Db=-v.Db,v.F!=null&&(v.J+=(m-1)*v.lb,v.lb=-v.lb);return 0}function nl(m,v,_,k){if(k==null||0>=m||0>=v)return 2;if(_!=null){if(_.Da){var B=_.cd,W=_.bd,G=-2&_.v,V=-2&_.j;if(0>G||0>V||0>=B||0>=W||G+B>m||V+W>v)return 2;m=B,v=W}if(_.da){if(!ot(m,v,B=[_.ib],W=[_.hb]))return 2;m=B[0],v=W[0]}}k.width=m,k.height=v;e:{var J=k.width,re=k.height;if(m=k.S,0>=J||0>=re||!(m>=C0&&13>m))m=2;else{if(0>=k.Rd&&k.sd==null){G=W=B=v=0;var ge=(V=J*Z2[m])*re;if(11>m||(W=(re+1)/2*(v=(J+1)/2),m==12&&(G=(B=J)*re)),(re=i(ge+2*W+G))==null){m=1;break e}k.sd=re,11>m?((J=k.f.RGBA).eb=re,J.fb=0,J.A=V,J.size=ge):((J=k.f.kb).y=re,J.O=0,J.fa=V,J.Fd=ge,J.f=re,J.N=0+ge,J.Ab=v,J.Cd=W,J.ea=re,J.W=0+ge+W,J.Db=v,J.Ed=W,m==12&&(J.F=re,J.J=0+ge+2*W),J.Tc=G,J.lb=B)}if(v=1,B=k.S,W=k.width,G=k.height,B>=C0&&13>B)if(11>B)m=k.f.RGBA,v&=(V=Math.abs(m.A))*(G-1)+W<=m.size,v&=V>=W*Z2[B],v&=m.eb!=null;else{m=k.f.kb,V=(W+1)/2,ge=(G+1)/2,J=Math.abs(m.fa),re=Math.abs(m.Ab);var Te=Math.abs(m.Db),ne=Math.abs(m.lb),ye=ne*(G-1)+W;v&=J*(G-1)+W<=m.Fd,v&=re*(ge-1)+V<=m.Cd,v=(v&=Te*(ge-1)+V<=m.Ed)&J>=W&re>=V&Te>=V,v&=m.y!=null,v&=m.f!=null,v&=m.ea!=null,B==12&&(v&=ne>=W,v&=ye<=m.Tc,v&=m.F!=null)}else v=0;m=v?0:2}}return m!=0||_!=null&&_.fd&&(m=ya(k)),m}var Gi=64,no=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Mu=24,ao=32,Gr=8,sm=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Qe("Predictor0","PredictorAdd0"),P.Predictor0=function(){return 4278190080},P.Predictor1=function(m){return m},P.Predictor2=function(m,v,_){return v[_+0]},P.Predictor3=function(m,v,_){return v[_+1]},P.Predictor4=function(m,v,_){return v[_-1]},P.Predictor5=function(m,v,_){return ft(ft(m,v[_+1]),v[_+0])},P.Predictor6=function(m,v,_){return ft(m,v[_-1])},P.Predictor7=function(m,v,_){return ft(m,v[_+0])},P.Predictor8=function(m,v,_){return ft(v[_-1],v[_+0])},P.Predictor9=function(m,v,_){return ft(v[_+0],v[_+1])},P.Predictor10=function(m,v,_){return ft(ft(m,v[_-1]),ft(v[_+0],v[_+1]))},P.Predictor11=function(m,v,_){var k=v[_+0];return 0>=Xe(k>>24&255,m>>24&255,(v=v[_-1])>>24&255)+Xe(k>>16&255,m>>16&255,v>>16&255)+Xe(k>>8&255,m>>8&255,v>>8&255)+Xe(255&k,255&m,255&v)?k:m},P.Predictor12=function(m,v,_){var k=v[_+0];return(Ot((m>>24&255)+(k>>24&255)-((v=v[_-1])>>24&255))<<24|Ot((m>>16&255)+(k>>16&255)-(v>>16&255))<<16|Ot((m>>8&255)+(k>>8&255)-(v>>8&255))<<8|Ot((255&m)+(255&k)-(255&v)))>>>0},P.Predictor13=function(m,v,_){var k=v[_-1];return(Fe((m=ft(m,v[_+0]))>>24&255,k>>24&255)<<24|Fe(m>>16&255,k>>16&255)<<16|Fe(m>>8&255,k>>8&255)<<8|Fe(255&m,255&k))>>>0};var Vi=P.PredictorAdd0;P.PredictorAdd1=At,Qe("Predictor2","PredictorAdd2"),Qe("Predictor3","PredictorAdd3"),Qe("Predictor4","PredictorAdd4"),Qe("Predictor5","PredictorAdd5"),Qe("Predictor6","PredictorAdd6"),Qe("Predictor7","PredictorAdd7"),Qe("Predictor8","PredictorAdd8"),Qe("Predictor9","PredictorAdd9"),Qe("Predictor10","PredictorAdd10"),Qe("Predictor11","PredictorAdd11"),Qe("Predictor12","PredictorAdd12"),Qe("Predictor13","PredictorAdd13");var Ki=P.PredictorAdd2;dt("ColorIndexInverseTransform","MapARGB","32b",function(m){return m>>8&255},function(m){return m}),dt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(m){return m},function(m){return m>>8&255});var oc,Ru=P.ColorIndexInverseTransform,lc=P.MapARGB,cc=P.VP8LColorIndexInverseTransformAlpha,al=P.MapAlpha,il=P.VP8LPredictorsAdd=[];il.length=16,(P.VP8LPredictors=[]).length=16,(P.VP8LPredictorsAdd_C=[]).length=16,(P.VP8LPredictors_C=[]).length=16;var ys,Bu,ka,Yi,_r,Nr,Vr,Kr,bs,uc,Xi,Uu,y2,b2,w2,_2,N2,S2,A2,E2,j2,T2,P2,k2,$u,C2,O2,L2,F2=i(511),D2=i(2041),I2=i(225),M2=i(767),R2=0,om=D2,k0=I2,Ca=M2,ri=F2,C0=0,O0=1,B2=2,L0=3,F0=4,lm=5,U2=6,cm=7,um=8,D0=9,fm=10,jj=[2,3,7],Tj=[3,3,11],$2=[280,256,256,256,40],Pj=[0,1,1,1,0],kj=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],Cj=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Oj=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],Lj=8,dm=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],hm=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],zu=null,Fj=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Dj=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],z2=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Ij=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],Mj=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],Rj=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Bj=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],io=[],Si=[],ws=[],Uj=1,q2=2,so=[],ni=[];Ni("UpsampleRgbLinePair",vs,3),Ni("UpsampleBgrLinePair",ac,3),Ni("UpsampleRgbaLinePair",P0,4),Ni("UpsampleBgraLinePair",ic,4),Ni("UpsampleArgbLinePair",T0,4),Ni("UpsampleRgba4444LinePair",oa,2),Ni("UpsampleRgb565LinePair",Fu,2);var $j=P.UpsampleRgbLinePair,zj=P.UpsampleBgrLinePair,W2=P.UpsampleRgbaLinePair,H2=P.UpsampleBgraLinePair,G2=P.UpsampleArgbLinePair,V2=P.UpsampleRgba4444LinePair,qj=P.UpsampleRgb565LinePair,I0=16,M0=1<<I0-1,qu=-227,pm=482,K2=6,Wj=(256<<K2)-1,Y2=0,Hj=i(256),Gj=i(256),Vj=i(256),Kj=i(256),Yj=i(pm-qu),Xj=i(pm-qu);ti("YuvToRgbRow",vs,3),ti("YuvToBgrRow",ac,3),ti("YuvToRgbaRow",P0,4),ti("YuvToBgraRow",ic,4),ti("YuvToArgbRow",T0,4),ti("YuvToRgba4444Row",oa,2),ti("YuvToRgb565Row",Fu,2);var X2=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],R0=[0,2,8],Zj=[8,7,6,4,4,2,2,2,1,1,1,1],Jj=1;this.WebPDecodeRGBA=function(m,v,_,k,B){var W=O0,G=new wt,V=new Wt;G.ba=V,V.S=W,V.width=[V.width],V.height=[V.height];var J=V.width,re=V.height,ge=new _t;if(ge==null||m==null)var Te=2;else t(ge!=null),Te=sc(m,v,_,ge.width,ge.height,ge.Pd,ge.Qd,ge.format,null);if(Te!=0?J=0:(J!=null&&(J[0]=ge.width[0]),re!=null&&(re[0]=ge.height[0]),J=1),J){V.width=V.width[0],V.height=V.height[0],k!=null&&(k[0]=V.width),B!=null&&(B[0]=V.height);e:{if(k=new Kn,(B=new kt).data=m,B.w=v,B.ha=_,B.kd=1,v=[0],t(B!=null),((m=sc(B.data,B.w,B.ha,null,null,null,v,null,B))==0||m==7)&&v[0]&&(m=4),(v=m)==0){if(t(G!=null),k.data=B.data,k.w=B.w+B.offset,k.ha=B.ha-B.offset,k.put=Et,k.ac=Cn,k.bc=yi,k.ma=G,B.xa){if((m=Ae())==null){G=1;break e}if(function(ne,ye){var Ne=[0],Ie=[0],je=[0];t:for(;;){if(ne==null)return 0;if(ye==null)return ne.a=2,0;if(ne.l=ye,ne.a=0,le(ne.m,ye.data,ye.w,ye.ha),!bi(ne.m,Ne,Ie,je)){ne.a=3;break t}if(ne.xb=q2,ye.width=Ne[0],ye.height=Ie[0],!Ee(Ne[0],Ie[0],1,ne,null))break t;return 1}return t(ne.a!=0),0}(m,k)){if(k=(v=nl(k.width,k.height,G.Oa,G.ba))==0){t:{k=m;r:for(;;){if(k==null){k=0;break t}if(t(k.s.yc!=null),t(k.s.Ya!=null),t(0<k.s.Wb),t((_=k.l)!=null),t((B=_.ma)!=null),k.xb!=0){if(k.ca=B.ba,k.tb=B.tb,t(k.ca!=null),!va(B.Oa,_,L0)){k.a=2;break r}if(!Ce(k,_.width)||_.da)break r;if((_.da||bt(k.ca.S))&&rl(),11>k.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),k.ca.f.kb.F!=null&&rl()),k.Pb&&0<k.s.ua&&k.s.vb.X==null&&!te(k.s.vb,k.s.Wa.Xa)){k.a=1;break r}k.xb=0}if(!Se(k,k.V,k.Ba,k.c,k.i,_.o,Z))break r;B.Dc=k.Ma,k=1;break t}t(k.a!=0),k=0}k=!k}k&&(v=m.a)}else v=m.a}else{if((m=new Wp)==null){G=1;break e}if(m.Fa=B.na,m.P=B.P,m.qc=B.Sa,S0(m,k)){if((v=nl(k.width,k.height,G.Oa,G.ba))==0){if(m.Aa=0,_=G.Oa,t((B=m)!=null),_!=null){if(0<(J=0>(J=_.Md)?0:100<J?255:255*J/100)){for(re=ge=0;4>re;++re)12>(Te=B.pb[re]).lc&&(Te.ia=J*Zj[0>Te.lc?0:Te.lc]>>3),ge|=Te.ia;ge&&(alert("todo:VP8InitRandom"),B.ia=1)}B.Ga=_.Id,100<B.Ga?B.Ga=100:0>B.Ga&&(B.Ga=0)}(function(ne,ye){if(ne==null)return 0;if(ye==null)return nn(ne,2,"NULL VP8Io parameter in VP8Decode().");if(!ne.cb&&!S0(ne,ye))return 0;if(t(ne.cb),ye.ac==null||ye.ac(ye)){ye.ob&&(ne.L=0);var Ne=R0[ne.L];if(ne.L==2?(ne.yb=0,ne.zb=0):(ne.yb=ye.v-Ne>>4,ne.zb=ye.j-Ne>>4,0>ne.yb&&(ne.yb=0),0>ne.zb&&(ne.zb=0)),ne.Va=ye.o+15+Ne>>4,ne.Hb=ye.va+15+Ne>>4,ne.Hb>ne.za&&(ne.Hb=ne.za),ne.Va>ne.Ub&&(ne.Va=ne.Ub),0<ne.L){var Ie=ne.ed;for(Ne=0;4>Ne;++Ne){var je;if(ne.Qa.Cb){var Me=ne.Qa.Lb[Ne];ne.Qa.Fb||(Me+=Ie.Tb)}else Me=Ie.Tb;for(je=0;1>=je;++je){var $e=ne.gd[Ne][je],Ve=Me;if(Ie.Pc&&(Ve+=Ie.vd[0],je&&(Ve+=Ie.od[0])),0<(Ve=0>Ve?0:63<Ve?63:Ve)){var We=Ve;0<Ie.wb&&(We=4<Ie.wb?We>>2:We>>1)>9-Ie.wb&&(We=9-Ie.wb),1>We&&(We=1),$e.dd=We,$e.tc=2*Ve+We,$e.ld=40<=Ve?2:15<=Ve?1:0}else $e.tc=0;$e.La=je}}}Ne=0}else nn(ne,6,"Frame setup failed"),Ne=ne.a;if(Ne=Ne==0){if(Ne){ne.$c=0,0<ne.Aa||(ne.Ic=Jj);t:{Ne=ne.Ic,Ie=4*(We=ne.za);var Nt=32*We,ut=We+1,Mt=0<ne.L?We*(0<ne.Aa?2:1):0,vt=(ne.Aa==2?2:1)*We;if(($e=Ie+832+(je=3*(16*Ne+R0[ne.L])/2*Nt)+(Me=ne.Fa!=null&&0<ne.Fa.length?ne.Kc.c*ne.Kc.i:0))!=$e)Ne=0;else{if($e>ne.Vb){if(ne.Vb=0,ne.Ec=i($e),ne.Fc=0,ne.Ec==null){Ne=nn(ne,1,"no memory during frame initialization.");break t}ne.Vb=$e}$e=ne.Ec,Ve=ne.Fc,ne.Ac=$e,ne.Bc=Ve,Ve+=Ie,ne.Gd=s(Nt,ei),ne.Hd=0,ne.rb=s(ut+1,Mr),ne.sb=1,ne.wa=Mt?s(Mt,zt):null,ne.Y=0,ne.D.Nb=0,ne.D.wa=ne.wa,ne.D.Y=ne.Y,0<ne.Aa&&(ne.D.Y+=We),t(!0),ne.oc=$e,ne.pc=Ve,Ve+=832,ne.ya=s(vt,wi),ne.aa=0,ne.D.ya=ne.ya,ne.D.aa=ne.aa,ne.Aa==2&&(ne.D.aa+=We),ne.R=16*We,ne.B=8*We,We=(Nt=R0[ne.L])*ne.R,Nt=Nt/2*ne.B,ne.sa=$e,ne.ta=Ve+We,ne.qa=ne.sa,ne.ra=ne.ta+16*Ne*ne.R+Nt,ne.Ha=ne.qa,ne.Ia=ne.ra+8*Ne*ne.B+Nt,ne.$c=0,Ve+=je,ne.mb=Me?$e:null,ne.nb=Me?Ve:null,t(Ve+Me<=ne.Fc+ne.Vb),Ko(ne),a(ne.Ac,ne.Bc,0,Ie),Ne=1}}if(Ne){if(ye.ka=0,ye.y=ne.sa,ye.O=ne.ta,ye.f=ne.qa,ye.N=ne.ra,ye.ea=ne.Ha,ye.Vd=ne.Ia,ye.fa=ne.R,ye.Rc=ne.B,ye.F=null,ye.J=0,!R2){for(Ne=-255;255>=Ne;++Ne)F2[255+Ne]=0>Ne?-Ne:Ne;for(Ne=-1020;1020>=Ne;++Ne)D2[1020+Ne]=-128>Ne?-128:127<Ne?127:Ne;for(Ne=-112;112>=Ne;++Ne)I2[112+Ne]=-16>Ne?-16:15<Ne?15:Ne;for(Ne=-255;510>=Ne;++Ne)M2[255+Ne]=0>Ne?0:255<Ne?255:Ne;R2=1}Vr=E0,Kr=Gp,uc=Vp,Xi=Wi,Uu=A0,bs=Hp,y2=w,b2=U,w2=_e,_2=Be,N2=se,S2=pe,A2=He,E2=gt,j2=ku,T2=tl,P2=Cu,k2=Ou,Si[0]=em,Si[1]=Nu,Si[2]=Jp,Si[3]=Qp,Si[4]=tm,Si[5]=ms,Si[6]=ps,Si[7]=rm,Si[8]=Ql,Si[9]=nm,io[0]=Qs,io[1]=Yp,io[2]=Xp,io[3]=Su,io[4]=Zp,io[5]=Zo,io[6]=Au,ws[0]=tc,ws[1]=Kp,ws[2]=Eu,ws[3]=Jo,ws[4]=ju,ws[5]=am,ws[6]=Tu,Ne=1}else Ne=0}Ne&&(Ne=function(Ht,mn){for(Ht.M=0;Ht.M<Ht.Va;++Ht.M){var Rt,yt=Ht.Jc[Ht.M&Ht.Xb],rt=Ht.m,Yr=Ht;for(Rt=0;Rt<Yr.za;++Rt){var Dt=rt,Kt=Yr,jr=Kt.Ac,Ln=Kt.Bc+4*Rt,la=Kt.zc,Rr=Kt.ya[Kt.aa+Rt];if(Kt.Qa.Bb?Rr.$b=oe(Dt,Kt.Pa.jb[0])?2+oe(Dt,Kt.Pa.jb[2]):oe(Dt,Kt.Pa.jb[1]):Rr.$b=0,Kt.kc&&(Rr.Ad=oe(Dt,Kt.Bd)),Rr.Za=!oe(Dt,145)+0,Rr.Za){var Yn=Rr.Ob,ca=0;for(Kt=0;4>Kt;++Kt){var gn,Yt=la[0+Kt];for(gn=0;4>gn;++gn){Yt=Mj[jr[Ln+gn]][Yt];for(var sr=z2[oe(Dt,Yt[0])];0<sr;)sr=z2[2*sr+oe(Dt,Yt[sr])];Yt=-sr,jr[Ln+gn]=Yt}n(Yn,ca,jr,Ln,4),ca+=4,la[0+Kt]=Yt}}else Yt=oe(Dt,156)?oe(Dt,128)?1:3:oe(Dt,163)?2:0,Rr.Ob[0]=Yt,a(jr,Ln,Yt,4),a(la,0,Yt,4);Rr.Dd=oe(Dt,142)?oe(Dt,114)?oe(Dt,183)?1:3:2:0}if(Yr.m.Ka)return nn(Ht,7,"Premature end-of-partition0 encountered.");for(;Ht.ja<Ht.za;++Ht.ja){if(Yr=yt,Dt=(rt=Ht).rb[rt.sb-1],jr=rt.rb[rt.sb+rt.ja],Rt=rt.ya[rt.aa+rt.ja],Ln=rt.kc?Rt.Ad:0)Dt.la=jr.la=0,Rt.Za||(Dt.Na=jr.Na=0),Rt.Hc=0,Rt.Gc=0,Rt.ia=0;else{var Br,or;if(Dt=jr,jr=Yr,Ln=rt.Pa.Xc,la=rt.ya[rt.aa+rt.ja],Rr=rt.pb[la.$b],Kt=la.ad,Yn=0,ca=rt.rb[rt.sb-1],Yt=gn=0,a(Kt,Yn,0,384),la.Za)var Fn=0,Ai=Ln[3];else{sr=i(16);var Xr=Dt.Na+ca.Na;if(Xr=zu(jr,Ln[1],Xr,Rr.Eb,0,sr,0),Dt.Na=ca.Na=(0<Xr)+0,1<Xr)Vr(sr,0,Kt,Yn);else{var ba=sr[0]+3>>3;for(sr=0;256>sr;sr+=16)Kt[Yn+sr]=ba}Fn=1,Ai=Ln[0]}var xr=15&Dt.la,xn=15&ca.la;for(sr=0;4>sr;++sr){var Oa=1&xn;for(ba=or=0;4>ba;++ba)xr=xr>>1|(Oa=(Xr=zu(jr,Ai,Xr=Oa+(1&xr),Rr.Sc,Fn,Kt,Yn))>Fn)<<7,or=or<<2|(3<Xr?3:1<Xr?2:Kt[Yn+0]!=0),Yn+=16;xr>>=4,xn=xn>>1|Oa<<7,gn=(gn<<8|or)>>>0}for(Ai=xr,Fn=xn>>4,Br=0;4>Br;Br+=2){for(or=0,xr=Dt.la>>4+Br,xn=ca.la>>4+Br,sr=0;2>sr;++sr){for(Oa=1&xn,ba=0;2>ba;++ba)Xr=Oa+(1&xr),xr=xr>>1|(Oa=0<(Xr=zu(jr,Ln[2],Xr,Rr.Qc,0,Kt,Yn)))<<3,or=or<<2|(3<Xr?3:1<Xr?2:Kt[Yn+0]!=0),Yn+=16;xr>>=2,xn=xn>>1|Oa<<5}Yt|=or<<4*Br,Ai|=xr<<4<<Br,Fn|=(240&xn)<<Br}Dt.la=Ai,ca.la=Fn,la.Hc=gn,la.Gc=Yt,la.ia=43690&Yt?0:Rr.ia,Ln=!(gn|Yt)}if(0<rt.L&&(rt.wa[rt.Y+rt.ja]=rt.gd[Rt.$b][Rt.Za],rt.wa[rt.Y+rt.ja].La|=!Ln),Yr.Ka)return nn(Ht,7,"Premature end-of-file encountered.")}if(Ko(Ht),rt=mn,Yr=1,Rt=(yt=Ht).D,Dt=0<yt.L&&yt.M>=yt.zb&&yt.M<=yt.Va,yt.Aa==0)t:{if(Rt.M=yt.M,Rt.uc=Dt,ro(yt,Rt),Yr=1,Rt=(or=yt.D).Nb,Dt=(Yt=R0[yt.L])*yt.R,jr=Yt/2*yt.B,sr=16*Rt*yt.R,ba=8*Rt*yt.B,Ln=yt.sa,la=yt.ta-Dt+sr,Rr=yt.qa,Kt=yt.ra-jr+ba,Yn=yt.Ha,ca=yt.Ia-jr+ba,xn=(xr=or.M)==0,gn=xr>=yt.Va-1,yt.Aa==2&&ro(yt,or),or.uc)for(Oa=(Xr=yt).D.M,t(Xr.D.uc),or=Xr.yb;or<Xr.Hb;++or){Fn=or,Ai=Oa;var ua=(La=(Dn=Xr).D).Nb;Br=Dn.R;var La=La.wa[La.Y+Fn],Fa=Dn.sa,wa=Dn.ta+16*ua*Br+16*Fn,Da=La.dd,Sr=La.tc;if(Sr!=0)if(t(3<=Sr),Dn.L==1)0<Fn&&T2(Fa,wa,Br,Sr+4),La.La&&k2(Fa,wa,Br,Sr),0<Ai&&j2(Fa,wa,Br,Sr+4),La.La&&P2(Fa,wa,Br,Sr);else{var Ia=Dn.B,Ei=Dn.qa,sl=Dn.ra+8*ua*Ia+8*Fn,_s=Dn.Ha,Dn=Dn.Ia+8*ua*Ia+8*Fn;ua=La.ld,0<Fn&&(b2(Fa,wa,Br,Sr+4,Da,ua),_2(Ei,sl,_s,Dn,Ia,Sr+4,Da,ua)),La.La&&(S2(Fa,wa,Br,Sr,Da,ua),E2(Ei,sl,_s,Dn,Ia,Sr,Da,ua)),0<Ai&&(y2(Fa,wa,Br,Sr+4,Da,ua),w2(Ei,sl,_s,Dn,Ia,Sr+4,Da,ua)),La.La&&(N2(Fa,wa,Br,Sr,Da,ua),A2(Ei,sl,_s,Dn,Ia,Sr,Da,ua))}}if(yt.ia&&alert("todo:DitherRow"),rt.put!=null){if(or=16*xr,xr=16*(xr+1),xn?(rt.y=yt.sa,rt.O=yt.ta+sr,rt.f=yt.qa,rt.N=yt.ra+ba,rt.ea=yt.Ha,rt.W=yt.Ia+ba):(or-=Yt,rt.y=Ln,rt.O=la,rt.f=Rr,rt.N=Kt,rt.ea=Yn,rt.W=ca),gn||(xr-=Yt),xr>rt.o&&(xr=rt.o),rt.F=null,rt.J=null,yt.Fa!=null&&0<yt.Fa.length&&or<xr&&(rt.J=On(yt,rt,or,xr-or),rt.F=yt.mb,rt.F==null&&rt.F.length==0)){Yr=nn(yt,3,"Could not decode alpha data.");break t}or<rt.j&&(Yt=rt.j-or,or=rt.j,t(!(1&Yt)),rt.O+=yt.R*Yt,rt.N+=yt.B*(Yt>>1),rt.W+=yt.B*(Yt>>1),rt.F!=null&&(rt.J+=rt.width*Yt)),or<xr&&(rt.O+=rt.v,rt.N+=rt.v>>1,rt.W+=rt.v>>1,rt.F!=null&&(rt.J+=rt.v),rt.ka=or-rt.j,rt.U=rt.va-rt.v,rt.T=xr-or,Yr=rt.put(rt))}Rt+1!=yt.Ic||gn||(n(yt.sa,yt.ta-Dt,Ln,la+16*yt.R,Dt),n(yt.qa,yt.ra-jr,Rr,Kt+8*yt.B,jr),n(yt.Ha,yt.Ia-jr,Yn,ca+8*yt.B,jr))}if(!Yr)return nn(Ht,6,"Output aborted.")}return 1}(ne,ye)),ye.bc!=null&&ye.bc(ye),Ne&=1}return Ne?(ne.cb=0,Ne):0})(m,k)||(v=m.a)}}else v=m.a}v==0&&G.Oa!=null&&G.Oa.fd&&(v=ya(G.ba))}G=v}W=G!=0?null:11>W?V.f.RGBA.eb:V.f.kb.y}else W=null;return W};var Z2=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(P,H){for(var T="",j=0;j<4;j++)T+=String.fromCharCode(P[H++]);return T}function f(P,H){return P[H+0]|P[H+1]<<8}function d(P,H){return(P[H+0]|P[H+1]<<8|P[H+2]<<16)>>>0}function p(P,H){return(P[H+0]|P[H+1]<<8|P[H+2]<<16|P[H+3]<<24)>>>0}new c;var h=[0],x=[0],g=[],y=new c,b=e,E=function(P,H){var T={},j=0,z=!1,K=0,he=0;if(T.frames=[],!function(S,L){for(var D=0;D<4;D++)if(S[L+D]!="RIFF".charCodeAt(D))return!0;return!1}(P,H)){for(p(P,H+=4),H+=8;H<P.length;){var be=u(P,H),we=p(P,H+=4);H+=4;var Q=we+(1&we);switch(be){case"VP8 ":case"VP8L":T.frames[j]===void 0&&(T.frames[j]={}),(ve=T.frames[j]).src_off=z?he:H-8,ve.src_size=K+we+8,j++,z&&(z=!1,K=0,he=0);break;case"VP8X":(ve=T.header={}).feature_flags=P[H];var le=H+4;ve.canvas_width=1+d(P,le),le+=3,ve.canvas_height=1+d(P,le),le+=3;break;case"ALPH":z=!0,K=Q+8,he=H-8;break;case"ANIM":(ve=T.header).bgcolor=p(P,H),le=H+4,ve.loop_count=f(P,le),le+=2;break;case"ANMF":var ke,ve;(ve=T.frames[j]={}).offset_x=2*d(P,H),H+=3,ve.offset_y=2*d(P,H),H+=3,ve.width=1+d(P,H),H+=3,ve.height=1+d(P,H),H+=3,ve.duration=d(P,H),H+=3,ke=P[H++],ve.dispose=1&ke,ve.blend=ke>>1&1}be!="ANMF"&&(H+=Q)}return T}}(b,0);E.response=b,E.rgbaoutput=!0,E.dataurl=!1;var A=E.header?E.header:null,C=E.frames?E.frames:null;if(A){A.loop_counter=A.loop_count,h=[A.canvas_height],x=[A.canvas_width];for(var N=0;N<C.length&&C[N].blend!=0;N++);}var F=C[0],O=y.WebPDecodeRGBA(b,F.src_off,F.src_size,x,h);F.rgba=O,F.imgwidth=x[0],F.imgheight=h[0];for(var I=0;I<x[0]*h[0]*4;I++)g[I]=O[I];return this.width=x,this.height=h,this.data=g,this}(function(e){var t,r,n,a,i,s,o,c,u,f=function(S){return S=S||{},this.isStrokeTransparent=S.isStrokeTransparent||!1,this.strokeOpacity=S.strokeOpacity||1,this.strokeStyle=S.strokeStyle||"#000000",this.fillStyle=S.fillStyle||"#000000",this.isFillTransparent=S.isFillTransparent||!1,this.fillOpacity=S.fillOpacity||1,this.font=S.font||"10px sans-serif",this.textBaseline=S.textBaseline||"alphabetic",this.textAlign=S.textAlign||"left",this.lineWidth=S.lineWidth||1,this.lineJoin=S.lineJoin||"miter",this.lineCap=S.lineCap||"butt",this.path=S.path||[],this.transform=S.transform!==void 0?S.transform.clone():new c,this.globalCompositeOperation=S.globalCompositeOperation||"normal",this.globalAlpha=S.globalAlpha||1,this.clip_path=S.clip_path||[],this.currentPoint=S.currentPoint||new s,this.miterLimit=S.miterLimit||10,this.lastPoint=S.lastPoint||new s,this.lineDashOffset=S.lineDashOffset||0,this.lineDash=S.lineDash||[],this.margin=S.margin||[0,0,0,0],this.prevPageLastElemOffset=S.prevPageLastElemOffset||0,this.ignoreClearRect=typeof S.ignoreClearRect!="boolean"||S.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new d(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,a=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,s=this.internal.Point,o=this.internal.Rectangle,c=this.internal.Matrix,u=new f}]);var d=function(S){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var L=S;Object.defineProperty(this,"pdf",{get:function(){return L}});var D=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return D},set:function(xe){D=!!xe}});var R=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return R},set:function(xe){R=!!xe}});var X=0;Object.defineProperty(this,"posX",{get:function(){return X},set:function(xe){isNaN(xe)||(X=xe)}});var de=0;Object.defineProperty(this,"posY",{get:function(){return de},set:function(xe){isNaN(xe)||(de=xe)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(xe){var te;typeof xe=="number"?te=[xe,xe,xe,xe]:((te=new Array(4))[0]=xe[0],te[1]=xe.length>=2?xe[1]:te[0],te[2]=xe.length>=3?xe[2]:te[0],te[3]=xe.length>=4?xe[3]:te[1]),u.margin=te}});var me=!1;Object.defineProperty(this,"autoPaging",{get:function(){return me},set:function(xe){me=xe}});var Y=0;Object.defineProperty(this,"lastBreak",{get:function(){return Y},set:function(xe){Y=xe}});var oe=[];Object.defineProperty(this,"pageBreaks",{get:function(){return oe},set:function(xe){oe=xe}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(xe){xe instanceof f&&(u=xe)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(xe){u.path=xe}});var ue=[];Object.defineProperty(this,"ctxStack",{get:function(){return ue},set:function(xe){ue=xe}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(xe){var te;te=p(xe),this.ctx.fillStyle=te.style,this.ctx.isFillTransparent=te.a===0,this.ctx.fillOpacity=te.a,this.pdf.setFillColor(te.r,te.g,te.b,{a:te.a}),this.pdf.setTextColor(te.r,te.g,te.b,{a:te.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(xe){var te=p(xe);this.ctx.strokeStyle=te.style,this.ctx.isStrokeTransparent=te.a===0,this.ctx.strokeOpacity=te.a,te.a===0?this.pdf.setDrawColor(255,255,255):(te.a,this.pdf.setDrawColor(te.r,te.g,te.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(xe){["butt","round","square"].indexOf(xe)!==-1&&(this.ctx.lineCap=xe,this.pdf.setLineCap(xe))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(xe){isNaN(xe)||(this.ctx.lineWidth=xe,this.pdf.setLineWidth(xe))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(xe){["bevel","round","miter"].indexOf(xe)!==-1&&(this.ctx.lineJoin=xe,this.pdf.setLineJoin(xe))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(xe){isNaN(xe)||(this.ctx.miterLimit=xe,this.pdf.setMiterLimit(xe))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(xe){this.ctx.textBaseline=xe}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(xe){["right","end","center","left","start"].indexOf(xe)!==-1&&(this.ctx.textAlign=xe)}});var fe=null,Ue=null;Object.defineProperty(this,"fontFaces",{get:function(){return Ue},set:function(xe){fe=null,Ue=xe}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(xe){var te;if(this.ctx.font=xe,(te=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(xe))!==null){var nt=te[1];te[2];var Re=te[3],ot=te[4];te[5];var ze=te[6],lt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(ot)[2];ot=Math.floor(lt==="px"?parseFloat(ot)*this.pdf.internal.scaleFactor:lt==="em"?parseFloat(ot)*this.pdf.getFontSize():parseFloat(ot)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(ot);var Qe=function(pt){var dt,Qt,$t=[],mt=pt.trim();if(mt==="")return L1;if(mt in M_)return[M_[mt]];for(;mt!=="";){switch(Qt=null,dt=(mt=B_(mt)).charAt(0)){case'"':case"'":Qt=BZ(mt.substring(1),dt);break;default:Qt=UZ(mt)}if(Qt===null||($t.push(Qt[0]),(mt=B_(Qt[1]))!==""&&mt.charAt(0)!==","))return L1;mt=mt.replace(/^,/,"")}return $t}(ze);if(this.fontFaces){var jt=function(pt,dt){if(fe===null){var Qt=function($t){var mt=[];return Object.keys($t).forEach(function(Tt){$t[Tt].forEach(function(er){var Pe=null;switch(er){case"bold":Pe={family:Tt,weight:"bold"};break;case"italic":Pe={family:Tt,style:"italic"};break;case"bolditalic":Pe={family:Tt,weight:"bold",style:"italic"};break;case"":case"normal":Pe={family:Tt}}Pe!==null&&(Pe.ref={name:Tt,style:er},mt.push(Pe))})}),mt}(pt.getFontList());fe=function($t){for(var mt={},Tt=0;Tt<$t.length;++Tt){var er=O1($t[Tt]),Pe=er.family,tt=er.stretch,bt=er.style,Xt=er.weight;mt[Pe]=mt[Pe]||{},mt[Pe][tt]=mt[Pe][tt]||{},mt[Pe][tt][bt]=mt[Pe][tt][bt]||{},mt[Pe][tt][bt][Xt]=er}return mt}(Qt.concat(dt))}return fe}(this.pdf,this.fontFaces),ft=Qe.map(function(pt){return{family:pt,stretch:"normal",weight:Re,style:nt}}),Ot=function(pt,dt,Qt){for(var $t=(Qt=Qt||{}).defaultFontFamily||"times",mt=Object.assign({},RZ,Qt.genericFontFamilies||{}),Tt=null,er=null,Pe=0;Pe<dt.length;++Pe)if(mt[(Tt=O1(dt[Pe])).family]&&(Tt.family=mt[Tt.family]),pt.hasOwnProperty(Tt.family)){er=pt[Tt.family];break}if(!(er=er||pt[$t]))throw new Error("Could not find a font-family for the rule '"+R_(Tt)+"' and default family '"+$t+"'.");if(er=function(tt,bt){if(bt[tt])return bt[tt];var Xt=Kg[tt],wr=Xt<=Kg.normal?-1:1,Wt=I_(bt,wj,Xt,wr);if(!Wt)throw new Error("Could not find a matching font-stretch value for "+tt);return Wt}(Tt.stretch,er),er=function(tt,bt){if(bt[tt])return bt[tt];for(var Xt=bj[tt],wr=0;wr<Xt.length;++wr)if(bt[Xt[wr]])return bt[Xt[wr]];throw new Error("Could not find a matching font-style for "+tt)}(Tt.style,er),!(er=function(tt,bt){if(bt[tt])return bt[tt];if(tt===400&&bt[500])return bt[500];if(tt===500&&bt[400])return bt[400];var Xt=MZ[tt],wr=I_(bt,_j,Xt,tt<400?-1:1);if(!wr)throw new Error("Could not find a matching font-weight for value "+tt);return wr}(Tt.weight,er)))throw new Error("Failed to resolve a font for the rule '"+R_(Tt)+"'.");return er}(jt,ft);this.pdf.setFont(Ot.ref.name,Ot.ref.style)}else{var Fe="";(Re==="bold"||parseInt(Re,10)>=700||nt==="bold")&&(Fe="bold"),nt==="italic"&&(Fe+="italic"),Fe.length===0&&(Fe="normal");for(var Xe="",At={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},xt=0;xt<Qe.length;xt++){if(this.pdf.internal.getFont(Qe[xt],Fe,{noFallback:!0,disableWarning:!0})!==void 0){Xe=Qe[xt];break}if(Fe==="bolditalic"&&this.pdf.internal.getFont(Qe[xt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Xe=Qe[xt],Fe="bold";else if(this.pdf.internal.getFont(Qe[xt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Xe=Qe[xt],Fe="normal";break}}if(Xe===""){for(var st=0;st<Qe.length;st++)if(At[Qe[st]]){Xe=At[Qe[st]];break}}Xe=Xe===""?"Times":Xe,this.pdf.setFont(Xe,Fe)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(xe){this.ctx.globalCompositeOperation=xe}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(xe){this.ctx.globalAlpha=xe}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(xe){this.ctx.lineDashOffset=xe,ve.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(xe){this.ctx.lineDash=xe,ve.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(xe){this.ctx.ignoreClearRect=!!xe}})};d.prototype.setLineDash=function(S){this.lineDash=S},d.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},d.prototype.fill=function(){C.call(this,"fill",!1)},d.prototype.stroke=function(){C.call(this,"stroke",!1)},d.prototype.beginPath=function(){this.path=[{type:"begin"}]},d.prototype.moveTo=function(S,L){if(isNaN(S)||isNaN(L))throw vr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var D=this.ctx.transform.applyToPoint(new s(S,L));this.path.push({type:"mt",x:D.x,y:D.y}),this.ctx.lastPoint=new s(S,L)},d.prototype.closePath=function(){var S=new s(0,0),L=0;for(L=this.path.length-1;L!==-1;L--)if(this.path[L].type==="begin"&&fr(this.path[L+1])==="object"&&typeof this.path[L+1].x=="number"){S=new s(this.path[L+1].x,this.path[L+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(S.x,S.y)},d.prototype.lineTo=function(S,L){if(isNaN(S)||isNaN(L))throw vr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var D=this.ctx.transform.applyToPoint(new s(S,L));this.path.push({type:"lt",x:D.x,y:D.y}),this.ctx.lastPoint=new s(D.x,D.y)},d.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),C.call(this,null,!0)},d.prototype.quadraticCurveTo=function(S,L,D,R){if(isNaN(D)||isNaN(R)||isNaN(S)||isNaN(L))throw vr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var X=this.ctx.transform.applyToPoint(new s(D,R)),de=this.ctx.transform.applyToPoint(new s(S,L));this.path.push({type:"qct",x1:de.x,y1:de.y,x:X.x,y:X.y}),this.ctx.lastPoint=new s(X.x,X.y)},d.prototype.bezierCurveTo=function(S,L,D,R,X,de){if(isNaN(X)||isNaN(de)||isNaN(S)||isNaN(L)||isNaN(D)||isNaN(R))throw vr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var me=this.ctx.transform.applyToPoint(new s(X,de)),Y=this.ctx.transform.applyToPoint(new s(S,L)),oe=this.ctx.transform.applyToPoint(new s(D,R));this.path.push({type:"bct",x1:Y.x,y1:Y.y,x2:oe.x,y2:oe.y,x:me.x,y:me.y}),this.ctx.lastPoint=new s(me.x,me.y)},d.prototype.arc=function(S,L,D,R,X,de){if(isNaN(S)||isNaN(L)||isNaN(D)||isNaN(R)||isNaN(X))throw vr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(de=!!de,!this.ctx.transform.isIdentity){var me=this.ctx.transform.applyToPoint(new s(S,L));S=me.x,L=me.y;var Y=this.ctx.transform.applyToPoint(new s(0,D)),oe=this.ctx.transform.applyToPoint(new s(0,0));D=Math.sqrt(Math.pow(Y.x-oe.x,2)+Math.pow(Y.y-oe.y,2))}Math.abs(X-R)>=2*Math.PI&&(R=0,X=2*Math.PI),this.path.push({type:"arc",x:S,y:L,radius:D,startAngle:R,endAngle:X,counterclockwise:de})},d.prototype.arcTo=function(S,L,D,R,X){throw new Error("arcTo not implemented.")},d.prototype.rect=function(S,L,D,R){if(isNaN(S)||isNaN(L)||isNaN(D)||isNaN(R))throw vr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(S,L),this.lineTo(S+D,L),this.lineTo(S+D,L+R),this.lineTo(S,L+R),this.lineTo(S,L),this.lineTo(S+D,L),this.lineTo(S,L)},d.prototype.fillRect=function(S,L,D,R){if(isNaN(S)||isNaN(L)||isNaN(D)||isNaN(R))throw vr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var X={};this.lineCap!=="butt"&&(X.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(X.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(S,L,D,R),this.fill(),X.hasOwnProperty("lineCap")&&(this.lineCap=X.lineCap),X.hasOwnProperty("lineJoin")&&(this.lineJoin=X.lineJoin)}},d.prototype.strokeRect=function(S,L,D,R){if(isNaN(S)||isNaN(L)||isNaN(D)||isNaN(R))throw vr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");x.call(this)||(this.beginPath(),this.rect(S,L,D,R),this.stroke())},d.prototype.clearRect=function(S,L,D,R){if(isNaN(S)||isNaN(L)||isNaN(D)||isNaN(R))throw vr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(S,L,D,R))},d.prototype.save=function(S){S=typeof S!="boolean"||S;for(var L=this.pdf.internal.getCurrentPageInfo().pageNumber,D=0;D<this.pdf.internal.getNumberOfPages();D++)this.pdf.setPage(D+1),this.pdf.internal.out("q");if(this.pdf.setPage(L),S){this.ctx.fontSize=this.pdf.internal.getFontSize();var R=new f(this.ctx);this.ctxStack.push(this.ctx),this.ctx=R}},d.prototype.restore=function(S){S=typeof S!="boolean"||S;for(var L=this.pdf.internal.getCurrentPageInfo().pageNumber,D=0;D<this.pdf.internal.getNumberOfPages();D++)this.pdf.setPage(D+1),this.pdf.internal.out("Q");this.pdf.setPage(L),S&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},d.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var p=function(S){var L,D,R,X;if(S.isCanvasGradient===!0&&(S=S.getColor()),!S)return{r:0,g:0,b:0,a:0,style:S};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(S))L=0,D=0,R=0,X=0;else{var de=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(S);if(de!==null)L=parseInt(de[1]),D=parseInt(de[2]),R=parseInt(de[3]),X=1;else if((de=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(S))!==null)L=parseInt(de[1]),D=parseInt(de[2]),R=parseInt(de[3]),X=parseFloat(de[4]);else{if(X=1,typeof S=="string"&&S.charAt(0)!=="#"){var me=new hj(S);S=me.ok?me.toHex():"#000000"}S.length===4?(L=S.substring(1,2),L+=L,D=S.substring(2,3),D+=D,R=S.substring(3,4),R+=R):(L=S.substring(1,3),D=S.substring(3,5),R=S.substring(5,7)),L=parseInt(L,16),D=parseInt(D,16),R=parseInt(R,16)}}return{r:L,g:D,b:R,a:X,style:S}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},x=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};d.prototype.fillText=function(S,L,D,R){if(isNaN(L)||isNaN(D)||typeof S!="string")throw vr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(R=isNaN(R)?void 0:R,!h.call(this)){var X=Q(this.ctx.transform.rotation),de=this.ctx.transform.scaleX;j.call(this,{text:S,x:L,y:D,scale:de,angle:X,align:this.textAlign,maxWidth:R})}},d.prototype.strokeText=function(S,L,D,R){if(isNaN(L)||isNaN(D)||typeof S!="string")throw vr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!x.call(this)){R=isNaN(R)?void 0:R;var X=Q(this.ctx.transform.rotation),de=this.ctx.transform.scaleX;j.call(this,{text:S,x:L,y:D,scale:de,renderingMode:"stroke",angle:X,align:this.textAlign,maxWidth:R})}},d.prototype.measureText=function(S){if(typeof S!="string")throw vr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var L=this.pdf,D=this.pdf.internal.scaleFactor,R=L.internal.getFontSize(),X=L.getStringUnitWidth(S)*R/L.internal.scaleFactor;return new function(de){var me=(de=de||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return me}}),this}({width:X*=Math.round(96*D/72*1e4)/1e4})},d.prototype.scale=function(S,L){if(isNaN(S)||isNaN(L))throw vr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var D=new c(S,0,0,L,0,0);this.ctx.transform=this.ctx.transform.multiply(D)},d.prototype.rotate=function(S){if(isNaN(S))throw vr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var L=new c(Math.cos(S),Math.sin(S),-Math.sin(S),Math.cos(S),0,0);this.ctx.transform=this.ctx.transform.multiply(L)},d.prototype.translate=function(S,L){if(isNaN(S)||isNaN(L))throw vr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var D=new c(1,0,0,1,S,L);this.ctx.transform=this.ctx.transform.multiply(D)},d.prototype.transform=function(S,L,D,R,X,de){if(isNaN(S)||isNaN(L)||isNaN(D)||isNaN(R)||isNaN(X)||isNaN(de))throw vr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var me=new c(S,L,D,R,X,de);this.ctx.transform=this.ctx.transform.multiply(me)},d.prototype.setTransform=function(S,L,D,R,X,de){S=isNaN(S)?1:S,L=isNaN(L)?0:L,D=isNaN(D)?0:D,R=isNaN(R)?1:R,X=isNaN(X)?0:X,de=isNaN(de)?0:de,this.ctx.transform=new c(S,L,D,R,X,de)};var g=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};d.prototype.drawImage=function(S,L,D,R,X,de,me,Y,oe){var ue=this.pdf.getImageProperties(S),fe=1,Ue=1,xe=1,te=1;R!==void 0&&Y!==void 0&&(xe=Y/R,te=oe/X,fe=ue.width/R*Y/R,Ue=ue.height/X*oe/X),de===void 0&&(de=L,me=D,L=0,D=0),R!==void 0&&Y===void 0&&(Y=R,oe=X),R===void 0&&Y===void 0&&(Y=ue.width,oe=ue.height);for(var nt,Re=this.ctx.transform.decompose(),ot=Q(Re.rotate.shx),ze=new c,lt=(ze=(ze=(ze=ze.multiply(Re.translate)).multiply(Re.skew)).multiply(Re.scale)).applyToRectangle(new o(de-L*xe,me-D*te,R*fe,X*Ue)),Qe=y.call(this,lt),jt=[],ft=0;ft<Qe.length;ft+=1)jt.indexOf(Qe[ft])===-1&&jt.push(Qe[ft]);if(A(jt),this.autoPaging)for(var Ot=jt[0],Fe=jt[jt.length-1],Xe=Ot;Xe<Fe+1;Xe++){this.pdf.setPage(Xe);var At=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],xt=Xe===1?this.posY+this.margin[0]:this.margin[0],st=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],pt=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],dt=Xe===1?0:st+(Xe-2)*pt;if(this.ctx.clip_path.length!==0){var Qt=this.path;nt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=E(nt,this.posX+this.margin[3],-dt+xt+this.ctx.prevPageLastElemOffset),N.call(this,"fill",!0),this.path=Qt}var $t=JSON.parse(JSON.stringify(lt));$t=E([$t],this.posX+this.margin[3],-dt+xt+this.ctx.prevPageLastElemOffset)[0];var mt=(Xe>Ot||Xe<Fe)&&g.call(this);mt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],At,pt,null).clip().discardPath()),this.pdf.addImage(S,"JPEG",$t.x,$t.y,$t.w,$t.h,null,null,ot),mt&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(S,"JPEG",lt.x,lt.y,lt.w,lt.h,null,null,ot)};var y=function(S,L,D){var R=[];L=L||this.pdf.internal.pageSize.width,D=D||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var X=this.posY+this.ctx.prevPageLastElemOffset;switch(S.type){default:case"mt":case"lt":R.push(Math.floor((S.y+X)/D)+1);break;case"arc":R.push(Math.floor((S.y+X-S.radius)/D)+1),R.push(Math.floor((S.y+X+S.radius)/D)+1);break;case"qct":var de=le(this.ctx.lastPoint.x,this.ctx.lastPoint.y,S.x1,S.y1,S.x,S.y);R.push(Math.floor((de.y+X)/D)+1),R.push(Math.floor((de.y+de.h+X)/D)+1);break;case"bct":var me=ke(this.ctx.lastPoint.x,this.ctx.lastPoint.y,S.x1,S.y1,S.x2,S.y2,S.x,S.y);R.push(Math.floor((me.y+X)/D)+1),R.push(Math.floor((me.y+me.h+X)/D)+1);break;case"rect":R.push(Math.floor((S.y+X)/D)+1),R.push(Math.floor((S.y+S.h+X)/D)+1)}for(var Y=0;Y<R.length;Y+=1)for(;this.pdf.internal.getNumberOfPages()<R[Y];)b.call(this);return R},b=function(){var S=this.fillStyle,L=this.strokeStyle,D=this.font,R=this.lineCap,X=this.lineWidth,de=this.lineJoin;this.pdf.addPage(),this.fillStyle=S,this.strokeStyle=L,this.font=D,this.lineCap=R,this.lineWidth=X,this.lineJoin=de},E=function(S,L,D){for(var R=0;R<S.length;R++)switch(S[R].type){case"bct":S[R].x2+=L,S[R].y2+=D;case"qct":S[R].x1+=L,S[R].y1+=D;default:S[R].x+=L,S[R].y+=D}return S},A=function(S){return S.sort(function(L,D){return L-D})},C=function(S,L){for(var D,R,X=this.fillStyle,de=this.strokeStyle,me=this.lineCap,Y=this.lineWidth,oe=Math.abs(Y*this.ctx.transform.scaleX),ue=this.lineJoin,fe=JSON.parse(JSON.stringify(this.path)),Ue=JSON.parse(JSON.stringify(this.path)),xe=[],te=0;te<Ue.length;te++)if(Ue[te].x!==void 0)for(var nt=y.call(this,Ue[te]),Re=0;Re<nt.length;Re+=1)xe.indexOf(nt[Re])===-1&&xe.push(nt[Re]);for(var ot=0;ot<xe.length;ot++)for(;this.pdf.internal.getNumberOfPages()<xe[ot];)b.call(this);if(A(xe),this.autoPaging)for(var ze=xe[0],lt=xe[xe.length-1],Qe=ze;Qe<lt+1;Qe++){this.pdf.setPage(Qe),this.fillStyle=X,this.strokeStyle=de,this.lineCap=me,this.lineWidth=oe,this.lineJoin=ue;var jt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ft=Qe===1?this.posY+this.margin[0]:this.margin[0],Ot=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Fe=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Xe=Qe===1?0:Ot+(Qe-2)*Fe;if(this.ctx.clip_path.length!==0){var At=this.path;D=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=E(D,this.posX+this.margin[3],-Xe+ft+this.ctx.prevPageLastElemOffset),N.call(this,S,!0),this.path=At}if(R=JSON.parse(JSON.stringify(fe)),this.path=E(R,this.posX+this.margin[3],-Xe+ft+this.ctx.prevPageLastElemOffset),L===!1||Qe===0){var xt=(Qe>ze||Qe<lt)&&g.call(this);xt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],jt,Fe,null).clip().discardPath()),N.call(this,S,L),xt&&this.pdf.restoreGraphicsState()}this.lineWidth=Y}else this.lineWidth=oe,N.call(this,S,L),this.lineWidth=Y;this.path=fe},N=function(S,L){if((S!=="stroke"||L||!x.call(this))&&(S==="stroke"||L||!h.call(this))){for(var D,R,X=[],de=this.path,me=0;me<de.length;me++){var Y=de[me];switch(Y.type){case"begin":X.push({begin:!0});break;case"close":X.push({close:!0});break;case"mt":X.push({start:Y,deltas:[],abs:[]});break;case"lt":var oe=X.length;if(de[me-1]&&!isNaN(de[me-1].x)&&(D=[Y.x-de[me-1].x,Y.y-de[me-1].y],oe>0)){for(;oe>=0;oe--)if(X[oe-1].close!==!0&&X[oe-1].begin!==!0){X[oe-1].deltas.push(D),X[oe-1].abs.push(Y);break}}break;case"bct":D=[Y.x1-de[me-1].x,Y.y1-de[me-1].y,Y.x2-de[me-1].x,Y.y2-de[me-1].y,Y.x-de[me-1].x,Y.y-de[me-1].y],X[X.length-1].deltas.push(D);break;case"qct":var ue=de[me-1].x+2/3*(Y.x1-de[me-1].x),fe=de[me-1].y+2/3*(Y.y1-de[me-1].y),Ue=Y.x+2/3*(Y.x1-Y.x),xe=Y.y+2/3*(Y.y1-Y.y),te=Y.x,nt=Y.y;D=[ue-de[me-1].x,fe-de[me-1].y,Ue-de[me-1].x,xe-de[me-1].y,te-de[me-1].x,nt-de[me-1].y],X[X.length-1].deltas.push(D);break;case"arc":X.push({deltas:[],abs:[],arc:!0}),Array.isArray(X[X.length-1].abs)&&X[X.length-1].abs.push(Y)}}R=L?null:S==="stroke"?"stroke":"fill";for(var Re=!1,ot=0;ot<X.length;ot++)if(X[ot].arc)for(var ze=X[ot].abs,lt=0;lt<ze.length;lt++){var Qe=ze[lt];Qe.type==="arc"?I.call(this,Qe.x,Qe.y,Qe.radius,Qe.startAngle,Qe.endAngle,Qe.counterclockwise,void 0,L,!Re):z.call(this,Qe.x,Qe.y),Re=!0}else if(X[ot].close===!0)this.pdf.internal.out("h"),Re=!1;else if(X[ot].begin!==!0){var jt=X[ot].start.x,ft=X[ot].start.y;K.call(this,X[ot].deltas,jt,ft),Re=!0}R&&P.call(this,R),L&&H.call(this)}},F=function(S){var L=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,D=L*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return S-D;case"top":return S+L-D;case"hanging":return S+L-2*D;case"middle":return S+L/2-D;default:return S}},O=function(S){return S+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};d.prototype.createLinearGradient=function(){var S=function(){};return S.colorStops=[],S.addColorStop=function(L,D){this.colorStops.push([L,D])},S.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},S.isCanvasGradient=!0,S},d.prototype.createPattern=function(){return this.createLinearGradient()},d.prototype.createRadialGradient=function(){return this.createLinearGradient()};var I=function(S,L,D,R,X,de,me,Y,oe){for(var ue=be.call(this,D,R,X,de),fe=0;fe<ue.length;fe++){var Ue=ue[fe];fe===0&&(oe?T.call(this,Ue.x1+S,Ue.y1+L):z.call(this,Ue.x1+S,Ue.y1+L)),he.call(this,S,L,Ue.x2,Ue.y2,Ue.x3,Ue.y3,Ue.x4,Ue.y4)}Y?H.call(this):P.call(this,me)},P=function(S){switch(S){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},H=function(){this.pdf.clip(),this.pdf.discardPath()},T=function(S,L){this.pdf.internal.out(r(S)+" "+n(L)+" m")},j=function(S){var L;switch(S.align){case"right":case"end":L="right";break;case"center":L="center";break;default:L="left"}var D=this.pdf.getTextDimensions(S.text),R=F.call(this,S.y),X=O.call(this,R)-D.h,de=this.ctx.transform.applyToPoint(new s(S.x,R)),me=this.ctx.transform.decompose(),Y=new c;Y=(Y=(Y=Y.multiply(me.translate)).multiply(me.skew)).multiply(me.scale);for(var oe,ue,fe,Ue=this.ctx.transform.applyToRectangle(new o(S.x,R,D.w,D.h)),xe=Y.applyToRectangle(new o(S.x,X,D.w,D.h)),te=y.call(this,xe),nt=[],Re=0;Re<te.length;Re+=1)nt.indexOf(te[Re])===-1&&nt.push(te[Re]);if(A(nt),this.autoPaging)for(var ot=nt[0],ze=nt[nt.length-1],lt=ot;lt<ze+1;lt++){this.pdf.setPage(lt);var Qe=lt===1?this.posY+this.margin[0]:this.margin[0],jt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ft=this.pdf.internal.pageSize.height-this.margin[2],Ot=ft-this.margin[0],Fe=this.pdf.internal.pageSize.width-this.margin[1],Xe=Fe-this.margin[3],At=lt===1?0:jt+(lt-2)*Ot;if(this.ctx.clip_path.length!==0){var xt=this.path;oe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=E(oe,this.posX+this.margin[3],-1*At+Qe),N.call(this,"fill",!0),this.path=xt}var st=E([JSON.parse(JSON.stringify(xe))],this.posX+this.margin[3],-At+Qe+this.ctx.prevPageLastElemOffset)[0];S.scale>=.01&&(ue=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ue*S.scale),fe=this.lineWidth,this.lineWidth=fe*S.scale);var pt=this.autoPaging!=="text";if(pt||st.y+st.h<=ft){if(pt||st.y>=Qe&&st.x<=Fe){var dt=pt?S.text:this.pdf.splitTextToSize(S.text,S.maxWidth||Fe-st.x)[0],Qt=E([JSON.parse(JSON.stringify(Ue))],this.posX+this.margin[3],-At+Qe+this.ctx.prevPageLastElemOffset)[0],$t=pt&&(lt>ot||lt<ze)&&g.call(this);$t&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Xe,Ot,null).clip().discardPath()),this.pdf.text(dt,Qt.x,Qt.y,{angle:S.angle,align:L,renderingMode:S.renderingMode}),$t&&this.pdf.restoreGraphicsState()}}else st.y<ft&&(this.ctx.prevPageLastElemOffset+=ft-st.y);S.scale>=.01&&(this.pdf.setFontSize(ue),this.lineWidth=fe)}else S.scale>=.01&&(ue=this.pdf.internal.getFontSize(),this.pdf.setFontSize(ue*S.scale),fe=this.lineWidth,this.lineWidth=fe*S.scale),this.pdf.text(S.text,de.x+this.posX,de.y+this.posY,{angle:S.angle,align:L,renderingMode:S.renderingMode,maxWidth:S.maxWidth}),S.scale>=.01&&(this.pdf.setFontSize(ue),this.lineWidth=fe)},z=function(S,L,D,R){D=D||0,R=R||0,this.pdf.internal.out(r(S+D)+" "+n(L+R)+" l")},K=function(S,L,D){return this.pdf.lines(S,L,D,null,null)},he=function(S,L,D,R,X,de,me,Y){this.pdf.internal.out([t(a(D+S)),t(i(R+L)),t(a(X+S)),t(i(de+L)),t(a(me+S)),t(i(Y+L)),"c"].join(" "))},be=function(S,L,D,R){for(var X=2*Math.PI,de=Math.PI/2;L>D;)L-=X;var me=Math.abs(D-L);me<X&&R&&(me=X-me);for(var Y=[],oe=R?-1:1,ue=L;me>1e-5;){var fe=ue+oe*Math.min(me,de);Y.push(we.call(this,S,ue,fe)),me-=Math.abs(fe-ue),ue=fe}return Y},we=function(S,L,D){var R=(D-L)/2,X=S*Math.cos(R),de=S*Math.sin(R),me=X,Y=-de,oe=me*me+Y*Y,ue=oe+me*X+Y*de,fe=4/3*(Math.sqrt(2*oe*ue)-ue)/(me*de-Y*X),Ue=me-fe*Y,xe=Y+fe*me,te=Ue,nt=-xe,Re=R+L,ot=Math.cos(Re),ze=Math.sin(Re);return{x1:S*Math.cos(L),y1:S*Math.sin(L),x2:Ue*ot-xe*ze,y2:Ue*ze+xe*ot,x3:te*ot-nt*ze,y3:te*ze+nt*ot,x4:S*Math.cos(D),y4:S*Math.sin(D)}},Q=function(S){return 180*S/Math.PI},le=function(S,L,D,R,X,de){var me=S+.5*(D-S),Y=L+.5*(R-L),oe=X+.5*(D-X),ue=de+.5*(R-de),fe=Math.min(S,X,me,oe),Ue=Math.max(S,X,me,oe),xe=Math.min(L,de,Y,ue),te=Math.max(L,de,Y,ue);return new o(fe,xe,Ue-fe,te-xe)},ke=function(S,L,D,R,X,de,me,Y){var oe,ue,fe,Ue,xe,te,nt,Re,ot,ze,lt,Qe,jt,ft,Ot=D-S,Fe=R-L,Xe=X-D,At=de-R,xt=me-X,st=Y-de;for(ue=0;ue<41;ue++)ot=(nt=(fe=S+(oe=ue/40)*Ot)+oe*((xe=D+oe*Xe)-fe))+oe*(xe+oe*(X+oe*xt-xe)-nt),ze=(Re=(Ue=L+oe*Fe)+oe*((te=R+oe*At)-Ue))+oe*(te+oe*(de+oe*st-te)-Re),ue==0?(lt=ot,Qe=ze,jt=ot,ft=ze):(lt=Math.min(lt,ot),Qe=Math.min(Qe,ze),jt=Math.max(jt,ot),ft=Math.max(ft,ze));return new o(Math.round(lt),Math.round(Qe),Math.round(jt-lt),Math.round(ft-Qe))},ve=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var S,L,D=(S=this.ctx.lineDash,L=this.ctx.lineDashOffset,JSON.stringify({lineDash:S,lineDashOffset:L}));this.prevLineDash!==D&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=D)}}})(St.API),function(e){var t=function(s){var o,c,u,f,d,p,h,x,g,y;for(c=[],u=0,f=(s+=o="\0\0\0\0".slice(s.length%4||4)).length;f>u;u+=4)(d=(s.charCodeAt(u)<<24)+(s.charCodeAt(u+1)<<16)+(s.charCodeAt(u+2)<<8)+s.charCodeAt(u+3))!==0?(p=(d=((d=((d=((d=(d-(y=d%85))/85)-(g=d%85))/85)-(x=d%85))/85)-(h=d%85))/85)%85,c.push(p+33,h+33,x+33,g+33,y+33)):c.push(122);return function(b,E){for(var A=E;A>0;A--)b.pop()}(c,o.length),String.fromCharCode.apply(String,c)+"~>"},r=function(s){var o,c,u,f,d,p=String,h="length",x=255,g="charCodeAt",y="slice",b="replace";for(s[y](-2),s=s[y](0,-2)[b](/\s/g,"")[b]("z","!!!!!"),u=[],f=0,d=(s+=o="uuuuu"[y](s[h]%5||5))[h];d>f;f+=5)c=52200625*(s[g](f)-33)+614125*(s[g](f+1)-33)+7225*(s[g](f+2)-33)+85*(s[g](f+3)-33)+(s[g](f+4)-33),u.push(x&c>>24,x&c>>16,x&c>>8,x&c);return function(E,A){for(var C=A;C>0;C--)E.pop()}(u,o[h]),p.fromCharCode.apply(p,u)},n=function(s){return s.split("").map(function(o){return("0"+o.charCodeAt().toString(16)).slice(-2)}).join("")+">"},a=function(s){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),o.test(s)===!1)return"";for(var c="",u=0;u<s.length;u+=2)c+=String.fromCharCode("0x"+(s[u]+s[u+1]));return c},i=function(s){for(var o=new Uint8Array(s.length),c=s.length;c--;)o[c]=s.charCodeAt(c);return(o=Dg(o)).reduce(function(u,f){return u+String.fromCharCode(f)},"")};e.processDataByFilters=function(s,o){var c=0,u=s||"",f=[];for(typeof(o=o||[])=="string"&&(o=[o]),c=0;c<o.length;c+=1)switch(o[c]){case"ASCII85Decode":case"/ASCII85Decode":u=r(u),f.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=t(u),f.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=a(u),f.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=n(u),f.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=i(u),f.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[c]+'" is not implemented')}return{data:u,reverseChain:f.reverse().join(" ")}}}(St.API),function(e){e.loadFile=function(t,r,n){return function(a,i,s){i=i!==!1,s=typeof s=="function"?s:function(){};var o=void 0;try{o=function(c,u,f){var d=new XMLHttpRequest,p=0,h=function(x){var g=x.length,y=[],b=String.fromCharCode;for(p=0;p<g;p+=1)y.push(b(255&x.charCodeAt(p)));return y.join("")};if(d.open("GET",c,!u),d.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(d.onload=function(){d.status===200?f(h(this.responseText)):f(void 0)}),d.send(null),u&&d.status===200)return h(d.responseText)}(a,i,s)}catch{}return o}(t,r,n)},e.loadImageFile=e.loadFile}(St.API),function(e){function t(){return(Ct.html2canvas?Promise.resolve(Ct.html2canvas):Nm(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function r(){return(Ct.DOMPurify?Promise.resolve(Ct.DOMPurify):Nm(()=>import("./purify.es-BFmuJLeH.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var n=function(o){var c=fr(o);return c==="undefined"?"undefined":c==="string"||o instanceof String?"string":c==="number"||o instanceof Number?"number":c==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":c==="object"?"object":"unknown"},a=function(o,c){var u=document.createElement(o);for(var f in c.className&&(u.className=c.className),c.innerHTML&&c.dompurify&&(u.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)u.style[f]=c.style[f];return u},i=function o(c,u){for(var f=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),d=c.firstChild;d;d=d.nextSibling)u!==!0&&d.nodeType===1&&d.nodeName==="SCRIPT"||f.appendChild(o(d,u));return c.nodeType===1&&(c.nodeName==="CANVAS"?(f.width=c.width,f.height=c.height,f.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(f.value=c.value),f.addEventListener("load",function(){f.scrollTop=c.scrollTop,f.scrollLeft=c.scrollLeft},!0)),f},s=function o(c){var u=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),f=o.convert(Promise.resolve(),u);return(f=f.setProgress(1,o,1,[o])).set(c)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(o,c){return o.__proto__=c||s.prototype,o},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(o,c){return this.then(function(){switch(c=c||function(u){switch(n(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(o),c){case"string":return this.then(r).then(function(u){return this.set({src:a("div",{innerHTML:o,dompurify:u})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},s.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=i(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=a("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=a("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(a("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(c){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,c(this.prop.container,u)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(c){var u=this.opt.jsPDF,f=this.opt.fontFaces,d=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,p=Object.assign({async:!0,allowTaint:!0,scale:d,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete p.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=f,f)for(var h=0;h<f.length;++h){var x=f[h],g=x.src.find(function(y){return y.format==="truetype"});g&&u.addFont(g.url,x.ref.name,x.ref.style)}return p.windowHeight=p.windowHeight||0,p.windowHeight=p.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):p.windowHeight,u.context2d.save(!0),c(this.prop.container,p)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(o,c,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(o,c):this.outputPdf(o,c)},s.prototype.outputPdf=function(o,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,c)})},s.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},s.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(o){if(n(o)!=="object")return this;var c=Object.keys(o||{}).map(function(u){if(u in s.template.prop)return function(){this.prop[u]=o[u]};switch(u){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[u]=o[u]}}},this);return this.then(function(){return this.thenList(c)})},s.prototype.get=function(o,c){return this.then(function(){var u=o in s.template.prop?this.prop[o]:this.opt[o];return c?c(u):u})},s.prototype.setMargin=function(o){return this.then(function(){switch(n(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},s.prototype.setPageSize=function(o){function c(u,f){return Math.floor(u*f/72*96)}return this.then(function(){(o=o||St.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:c(o.inner.width,o.k),height:c(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},s.prototype.setProgress=function(o,c,u,f){return o!=null&&(this.progress.val=o),c!=null&&(this.progress.state=c),u!=null&&(this.progress.n=u),f!=null&&(this.progress.stack=f),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(o,c,u,f){return this.setProgress(o?this.progress.val+o:null,c||null,u?this.progress.n+u:null,f?this.progress.stack.concat(f):null)},s.prototype.then=function(o,c){var u=this;return this.thenCore(o,c,function(f,d){return u.updateProgress(null,null,1,[f]),Promise.prototype.then.call(this,function(p){return u.updateProgress(null,f),p}).then(f,d).then(function(p){return u.updateProgress(1),p})})},s.prototype.thenCore=function(o,c,u){u=u||Promise.prototype.then;var f=this;o&&(o=o.bind(f)),c&&(c=c.bind(f));var d=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?f:s.convert(Object.assign({},f),Promise.prototype),p=u.call(d,o,c);return s.convert(p,f.__proto__)},s.prototype.thenExternal=function(o,c){return Promise.prototype.then.call(this,o,c)},s.prototype.thenList=function(o){var c=this;return o.forEach(function(u){c=c.thenCore(u)}),c},s.prototype.catch=function(o){o&&(o=o.bind(this));var c=Promise.prototype.catch.call(this,o);return s.convert(c,this)},s.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},s.prototype.error=function(o){return this.then(function(){throw new Error(o)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,St.getPageSize=function(o,c,u){if(fr(o)==="object"){var f=o;o=f.orientation,c=f.unit||c,u=f.format||u}c=c||"mm",u=u||"a4",o=(""+(o||"P")).toLowerCase();var d,p=(""+u).toLowerCase(),h={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":d=1;break;case"mm":d=72/25.4;break;case"cm":d=72/2.54;break;case"in":d=72;break;case"px":d=.75;break;case"pc":case"em":d=12;break;case"ex":d=6;break;default:throw"Invalid unit: "+c}var x,g=0,y=0;if(h.hasOwnProperty(p))g=h[p][1]/d,y=h[p][0]/d;else try{g=u[1],y=u[0]}catch{throw new Error("Invalid format: "+u)}if(o==="p"||o==="portrait")o="p",y>g&&(x=y,y=g,g=x);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",g>y&&(x=y,y=g,g=x)}return{width:y,height:g,unit:c,k:d,orientation:o}},e.html=function(o,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(O1):null;var u=new s(c);return c.worker?u:u.from(o).doCallback()}}(St.API),St.API.addJS=function(e){return $_=e,this.internal.events.subscribe("postPutResources",function(){_d=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(_d+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),U_=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+$_+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){_d!==void 0&&U_!==void 0&&this.internal.out("/Names <</JavaScript "+_d+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var a=r.outline.render().split(/\r\n/),i=0;i<a.length;i++){var s=a[i],o=n.exec(s);if(o!=null){var c=o[1];r.internal.newObjectDeferredBegin(c,!1)}r.internal.write(s)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,f=[];for(i=0;i<u;i++){var d=r.internal.newObject();f.push(d);var p=r.internal.getPageInfo(i+1);r.internal.write("<< /D["+p.objId+" 0 R /XYZ null null null]>> endobj")}var h=r.internal.newObject();for(r.internal.write("<< /Names [ "),i=0;i<f.length;i++)r.internal.write("(page_"+(i+1)+")"+f[i]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+h+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,a,i){var s={title:a,options:i,children:[]};return n==null&&(n=this.root),n.children.push(s),s},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var a=0;a<n.children.length;a++)this.genIds_r(n.children[a])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var a=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<n.children.length;i++){var s=n.children[i];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(n)),i>0&&this.line("/Prev "+this.makeRef(n.children[i-1])),i<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[i+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var o=this.count=this.count_r({count:0},s);if(o>0&&this.line("/Count "+o),s.options&&s.options.pageNumber){var c=r.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+a(0)+" 0]")}this.objEnd()}for(var u=0;u<n.children.length;u++)this.renderItems(n.children[u])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,a){for(var i=0;i<a.children.length;i++)n.count++,this.count_r(n,a.children[i]);return n.count}}])}(St.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,a,i,s,o){var c,u=this.decode.DCT_DECODE,f=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=s||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,c=function(d){for(var p,h=256*d.charCodeAt(4)+d.charCodeAt(5),x=d.length,g={width:0,height:0,numcomponents:1},y=4;y<x;y+=2){if(y+=h,t.indexOf(d.charCodeAt(y+1))!==-1){p=256*d.charCodeAt(y+5)+d.charCodeAt(y+6),g={width:256*d.charCodeAt(y+7)+d.charCodeAt(y+8),height:p,numcomponents:d.charCodeAt(y+9)};break}h=256*d.charCodeAt(y+2)+d.charCodeAt(y+3)}return g}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),c.numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}f={data:r,width:c.width,height:c.height,colorSpace:o,bitsPerComponent:8,filter:u,index:n,alias:a}}return f}}(St.API),St.API.processPNG=function(e,t,r,n){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var a,i=NZ(e,{checkCrc:!0}),s=i.width,o=i.height,c=i.channels,u=i.palette,f=i.depth;a=u&&c===1?function(O){for(var I=O.width,P=O.height,H=O.data,T=O.palette,j=O.depth,z=!1,K=[],he=[],be=void 0,we=!1,Q=0,le=0;le<T.length;le++){var ke=D5(T[le],4),ve=ke[0],S=ke[1],L=ke[2],D=ke[3];K.push(ve,S,L),D!=null&&(D===0?(Q++,he.length<1&&he.push(le)):D<255&&(we=!0))}if(we||Q>1){z=!0,he=void 0;var R=I*P;be=new Uint8Array(R);for(var X=new DataView(H.buffer),de=0;de<R;de++){var me=F1(X,de,j),Y=D5(T[me],4)[3];be[de]=Y}}return{colorSpace:"Indexed",colorsPerPixel:1,colorBytes:H,alphaBytes:be,needSMask:z,palette:K,mask:he}}(i):c===2||c===4?function(O){for(var I=O.data,P=O.width,H=O.height,T=O.channels,j=O.depth,z=T===2?"DeviceGray":"DeviceRGB",K=T-1,he=P*H,be=K,we=he*be,Q=1*he,le=Math.ceil(we*j/8),ke=Math.ceil(Q*j/8),ve=new Uint8Array(le),S=new Uint8Array(ke),L=new DataView(I.buffer),D=new DataView(ve.buffer),R=new DataView(S.buffer),X=!1,de=0;de<he;de++){for(var me=de*T,Y=0;Y<be;Y++)X_(D,F1(L,me+Y,j),de*be+Y,j);var oe=F1(L,me+be,j);oe<(1<<j)-1&&(X=!0),X_(R,oe,1*de,j)}return{colorSpace:z,colorsPerPixel:K,colorBytes:ve,alphaBytes:S,needSMask:X}}(i):function(O){var I=O.data,P=O.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:P,colorsPerPixel:P==="DeviceGray"?1:3,colorBytes:I instanceof Uint8Array?I:new Uint8Array(I.buffer),needSMask:!1}}(i);var d,p,h,x=a,g=x.colorSpace,y=x.colorsPerPixel,b=x.colorBytes,E=x.alphaBytes,A=x.needSMask,C=x.palette,N=x.mask,F=null;return n!==St.API.image_compression.NONE&&typeof Dg=="function"?(F=function(O){var I;switch(O){case St.API.image_compression.FAST:I=11;break;case St.API.image_compression.MEDIUM:I=13;break;case St.API.image_compression.SLOW:I=14;break;default:I=12}return I}(n),d=this.decode.FLATE_DECODE,p="/Predictor ".concat(F," "),e=H_(b,s*y,y,n),A&&(h=H_(E,s,1,n))):(d=void 0,p="",e=b,A&&(h=E)),p+="/Colors ".concat(y," /BitsPerComponent ").concat(f," /Columns ").concat(s),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(h&&this.__addimage__.isArrayBuffer(h)||this.__addimage__.isArrayBufferView(h))&&(h=this.__addimage__.arrayBufferToBinaryString(h)),{alias:r,data:e,index:t,filter:d,decodeParameters:p,transparency:N,palette:C,sMask:h,predictor:F,width:s,height:o,bitsPerComponent:f,colorSpace:g}}},function(e){e.processGIF89A=function(t,r,n,a){var i=new WZ(t),s=i.width,o=i.height,c=[];i.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:s,height:o},f=new D1(100).encode(u,100);return e.processJPEG.call(this,f,r,n,a)},e.processGIF87A=e.processGIF89A}(St.API),Pi.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:a,green:n,blue:r,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Pi.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){vr.log("bit decode error:"+r)}},Pi.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,a=0;a<t;a++)for(var i=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+8*a*4,o=0;o<8&&8*a+o<this.width;o++){var c=this.palette[i>>7-o&1];this.data[s+4*o]=c.blue,this.data[s+4*o+1]=c.green,this.data[s+4*o+2]=c.red,this.data[s+4*o+3]=255}r!==0&&(this.pos+=4-r)}},Pi.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<e;a++){var i=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+2*a*4,o=i>>4,c=15&i,u=this.palette[o];if(this.data[s]=u.blue,this.data[s+1]=u.green,this.data[s+2]=u.red,this.data[s+3]=255,2*a+1>=this.width)break;u=this.palette[c],this.data[s+4]=u.blue,this.data[s+4+1]=u.green,this.data[s+4+2]=u.red,this.data[s+4+3]=255}t!==0&&(this.pos+=4-t)}},Pi.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var a=this.datav.getUint8(this.pos++,!0),i=r*this.width*4+4*n;if(a<this.palette.length){var s=this.palette[a];this.data[i]=s.red,this.data[i+1]=s.green,this.data[i+2]=s.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}e!==0&&(this.pos+=4-e)}},Pi.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,a=0;a<this.width;a++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(i&t)/t*255|0,o=(i>>5&t)/t*255|0,c=(i>>10&t)/t*255|0,u=i>>15?255:0,f=n*this.width*4+4*a;this.data[f]=c,this.data[f+1]=o,this.data[f+2]=s,this.data[f+3]=u}this.pos+=e}},Pi.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var a=this.bottom_up?n:this.height-1-n,i=0;i<this.width;i++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&t)/t*255|0,c=(s>>5&r)/r*255|0,u=(s>>11)/t*255|0,f=a*this.width*4+4*i;this.data[f]=u,this.data[f+1]=c,this.data[f+2]=o,this.data[f+3]=255}this.pos+=e}},Pi.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*r;this.data[s]=i,this.data[s+1]=a,this.data[s+2]=n,this.data[s+3]=255}this.pos+=this.width%4}},Pi.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=i,this.data[o+1]=a,this.data[o+2]=n,this.data[o+3]=s}},Pi.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,a){var i=new Pi(t,!1),s=i.width,o=i.height,c={data:i.getData(),width:s,height:o},u=new D1(100).encode(c,100);return e.processJPEG.call(this,u,r,n,a)}}(St.API),J_.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,a){var i=new J_(t),s=i.width,o=i.height,c={data:i.getData(),width:s,height:o},u=new D1(100).encode(c,100);return e.processJPEG.call(this,u,r,n,a)}}(St.API),St.API.processRGBA=function(e,t,r){for(var n=e.data,a=n.length,i=new Uint8Array(a/4*3),s=new Uint8Array(a/4),o=0,c=0,u=0;u<a;u+=4){var f=n[u],d=n[u+1],p=n[u+2],h=n[u+3];i[o++]=f,i[o++]=d,i[o++]=p,s[c++]=h}var x=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:x,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},St.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},yc=St.API,Nd=yc.getCharWidthsArray=function(e,t){var r,n,a=(t=t||{}).font||this.internal.getFont(),i=t.fontSize||this.internal.getFontSize(),s=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:a.metadata.Unicode.widths,c=o.fof?o.fof:1,u=t.kerning?t.kerning:a.metadata.Unicode.kerning,f=u.fof?u.fof:1,d=t.doKerning!==!1,p=0,h=e.length,x=0,g=o[0]||c,y=[];for(r=0;r<h;r++)n=e.charCodeAt(r),typeof a.metadata.widthOfString=="function"?y.push((a.metadata.widthOfGlyph(a.metadata.characterToGlyph(n))+s*(1e3/i)||0)/1e3):(p=d&&fr(u[n])==="object"&&!isNaN(parseInt(u[n][x],10))?u[n][x]/f:0,y.push((o[n]||g)/c+p)),x=n;return y},z_=yc.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),a=t.charSpace||this.internal.getCharSpace();return yc.processArabic&&(e=yc.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,a)/r:Nd.apply(this,arguments).reduce(function(i,s){return i+s},0)},q_=function(e,t,r,n){for(var a=[],i=0,s=e.length,o=0;i!==s&&o+t[i]<r;)o+=t[i],i++;a.push(e.slice(0,i));var c=i;for(o=0;i!==s;)o+t[i]>n&&(a.push(e.slice(c,i)),o=0,c=i),o+=t[i],i++;return c!==i&&a.push(e.slice(c,i)),a},W_=function(e,t,r){r||(r={});var n,a,i,s,o,c,u,f=[],d=[f],p=r.textIndent||0,h=0,x=0,g=e.split(" "),y=Nd.apply(this,[" ",r])[0];if(c=r.lineIndent===-1?g[0].length+2:r.lineIndent||0){var b=Array(c).join(" "),E=[];g.map(function(C){(C=C.split(/\s*\n/)).length>1?E=E.concat(C.map(function(N,F){return(F&&N.length?`
`:"")+N})):E.push(C[0])}),g=E,c=z_.apply(this,[b,r])}for(i=0,s=g.length;i<s;i++){var A=0;if(n=g[i],c&&n[0]==`
`&&(n=n.substr(1),A=1),p+h+(x=(a=Nd.apply(this,[n,r])).reduce(function(C,N){return C+N},0))>t||A){if(x>t){for(o=q_.apply(this,[n,a,t-(p+h),t]),f.push(o.shift()),f=[o.pop()];o.length;)d.push([o.shift()]);x=a.slice(n.length-(f[0]?f[0].length:0)).reduce(function(C,N){return C+N},0)}else f=[n];d.push(f),p=x+c,h=y}else f.push(n),p+=h+x,h=y}return u=c?function(C,N){return(N?b:"")+C.join(" ")}:function(C){return C.join(" ")},d.map(u)},yc.splitTextToSize=function(e,t,r){var n,a=(r=r||{}).fontSize||this.internal.getFontSize(),i=(function(f){if(f.widths&&f.kerning)return{widths:f.widths,kerning:f.kerning};var d=this.internal.getFont(f.fontName,f.fontStyle),p="Unicode";return d.metadata[p]?{widths:d.metadata[p].widths||{0:1},kerning:d.metadata[p].kerning||{}}:{font:d.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var s=1*this.internal.scaleFactor*t/a;i.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/a:0,i.lineIndent=r.lineIndent;var o,c,u=[];for(o=0,c=n.length;o<c;o++)u=u.concat(W_.apply(this,[n[o],s,i]));return u},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",n={},a={},i=0;i<16;i++)n[r[i]]=t[i],a[t[i]]=r[i];var s=function(p){return"0x"+parseInt(p,10).toString(16)},o=e.__fontmetrics__.compress=function(p){var h,x,g,y,b=["{"];for(var E in p){if(h=p[E],isNaN(parseInt(E,10))?x="'"+E+"'":(E=parseInt(E,10),x=(x=s(E).slice(2)).slice(0,-1)+a[x.slice(-1)]),typeof h=="number")h<0?(g=s(h).slice(3),y="-"):(g=s(h).slice(2),y=""),g=y+g.slice(0,-1)+a[g.slice(-1)];else{if(fr(h)!=="object")throw new Error("Don't know what to do with value type "+fr(h)+".");g=o(h)}b.push(x+g)}return b.push("}"),b.join("")},c=e.__fontmetrics__.uncompress=function(p){if(typeof p!="string")throw new Error("Invalid argument passed to uncompress.");for(var h,x,g,y,b={},E=1,A=b,C=[],N="",F="",O=p.length-1,I=1;I<O;I+=1)(y=p[I])=="'"?h?(g=h.join(""),h=void 0):h=[]:h?h.push(y):y=="{"?(C.push([A,g]),A={},g=void 0):y=="}"?((x=C.pop())[0][x[1]]=A,g=void 0,A=x[0]):y=="-"?E=-1:g===void 0?n.hasOwnProperty(y)?(N+=n[y],g=parseInt(N,16)*E,E=1,N=""):N+=y:n.hasOwnProperty(y)?(F+=n[y],A[g]=parseInt(F,16)*E,E=1,g=void 0,F=""):F+=y;return b},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},f={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},d={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(p){var h=p.font,x=d.Unicode[h.postScriptName];x&&(h.metadata.Unicode={},h.metadata.Unicode.widths=x.widths,h.metadata.Unicode.kerning=x.kerning);var g=f.Unicode[h.postScriptName];g&&(h.metadata.Unicode.encoding=g,h.encoding=g.codePages[0])}])}(St.API),function(e){var t=function(r){for(var n=r.length,a=new Uint8Array(n),i=0;i<n;i++)a[i]=r.charCodeAt(i);return a};e.API.events.push(["addFont",function(r){var n=void 0,a=r.font,i=r.instance;if(!a.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(n=i.existsFileInVFS(a.postScriptName)===!1?i.loadFile(a.postScriptName):i.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(s,o){o=/^\x00\x01\x00\x00/.test(o)?t(o):t(Pd(o)),s.metadata=e.API.TTFFont.open(o),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(a,n)}}])}(St),St.API.addSvgAsImage=function(e,t,r,n,a,i,s,o){if(isNaN(t)||isNaN(r))throw vr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(a))throw vr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=n,c.height=a;var u=c.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,c.width,c.height);var f={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},d=this;return(Ct.canvg?Promise.resolve(Ct.canvg):Nm(()=>import("./index.es-Cl1hG9Dw.js"),__vite__mapDeps([0,1,2,3]))).catch(function(p){return Promise.reject(new Error("Could not load canvg: "+p))}).then(function(p){return p.default?p.default:p}).then(function(p){return p.fromString(u,e,f)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(p){return p.render(f)}).then(function(){d.addImage(c.toDataURL("image/jpeg",1),t,r,n,a,s,o)})},St.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var a=0;a<this.internal.pages[n].length;a++)this.internal.pages[n][a]=this.internal.pages[n][a].replace(t,r);return this},St.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,a,i,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(s),c=[],u=0,f=0,d=0;function p(x,g){var y,b=!1;for(y=0;y<x.length;y+=1)x[y]===g&&(b=!0);return b}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var h=o.length;for(d=0;d<h;d+=1)r[o[d]].value=r[o[d]].defaultValue,r[o[d]].explicitSet=!1}if(fr(e)==="object"){for(a in e)if(i=e[a],p(o,a)&&i!==void 0){if(r[a].type==="boolean"&&typeof i=="boolean")r[a].value=i;else if(r[a].type==="name"&&p(r[a].valueSet,i))r[a].value=i;else if(r[a].type==="integer"&&Number.isInteger(i))r[a].value=i;else if(r[a].type==="array"){for(u=0;u<i.length;u+=1)if(n=!0,i[u].length===1&&typeof i[u][0]=="number")c.push(String(i[u]-1));else if(i[u].length>1){for(f=0;f<i[u].length;f+=1)typeof i[u][f]!="number"&&(n=!1);n===!0&&c.push([i[u][0]-1,i[u][1]-1].join(" "))}r[a].value="["+c.join(" ")+"]"}else r[a].value=r[a].defaultValue;r[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var x,g=[];for(x in r)r[x].explicitSet===!0&&(r[x].type==="name"?g.push("/"+x+" /"+r[x].value):g.push("/"+x+" "+r[x].value));g.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+g.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',a=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(n)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=i.length+s.length+o.length+a.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(a+i+s+o+c),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,a){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:a||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(St.API),function(e){var t=e.API,r=t.pdfEscape16=function(i,s){for(var o,c=s.metadata.Unicode.widths,u=["","0","00","000","0000"],f=[""],d=0,p=i.length;d<p;++d){if(o=s.metadata.characterToGlyph(i.charCodeAt(d)),s.metadata.glyIdsUsed.push(o),s.metadata.toUnicode[o]=i.charCodeAt(d),c.indexOf(o)==-1&&(c.push(o),c.push([parseInt(s.metadata.widthOfGlyph(o),10)])),o=="0")return f.join("");o=o.toString(16),f.push(u[4-o.length],o)}return f.join("")},n=function(i){var s,o,c,u,f,d,p;for(f=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],d=0,p=(o=Object.keys(i).sort(function(h,x){return h-x})).length;d<p;d++)s=o[d],c.length>=100&&(f+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),i[s]!==void 0&&i[s]!==null&&typeof i[s].toString=="function"&&(u=("0000"+i[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),c.push("<"+s+"><"+u+">"));return c.length&&(f+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),f+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(i){(function(s){var o=s.font,c=s.out,u=s.newObject,f=s.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="Identity-H"){for(var d=o.metadata.Unicode.widths,p=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),h="",x=0;x<p.length;x++)h+=String.fromCharCode(p[x]);var g=u();f({data:h,addLength1:!0,objectId:g}),c("endobj");var y=u();f({data:n(o.metadata.toUnicode),addLength1:!0,objectId:y}),c("endobj");var b=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+Nc(o.fontName)),c("/FontFile2 "+g+" 0 R"),c("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),c("/Flags "+o.metadata.flags),c("/StemV "+o.metadata.stemV),c("/ItalicAngle "+o.metadata.italicAngle),c("/Ascent "+o.metadata.ascender),c("/Descent "+o.metadata.decender),c("/CapHeight "+o.metadata.capHeight),c(">>"),c("endobj");var E=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+Nc(o.fontName)),c("/FontDescriptor "+b+" 0 R"),c("/W "+e.API.PDFObject.convert(d)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+o.encoding+")"),c(">>"),c(">>"),c("endobj"),o.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+y+" 0 R"),c("/BaseFont /"+Nc(o.fontName)),c("/Encoding /"+o.encoding),c("/DescendantFonts ["+E+" 0 R]"),c(">>"),c("endobj"),o.isAlreadyPutted=!0}})(i)}]),t.events.push(["putFont",function(i){(function(s){var o=s.font,c=s.out,u=s.newObject,f=s.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var d=o.metadata.rawData,p="",h=0;h<d.length;h++)p+=String.fromCharCode(d[h]);var x=u();f({data:p,addLength1:!0,objectId:x}),c("endobj");var g=u();f({data:n(o.metadata.toUnicode),addLength1:!0,objectId:g}),c("endobj");var y=u();c("<<"),c("/Descent "+o.metadata.decender),c("/CapHeight "+o.metadata.capHeight),c("/StemV "+o.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+x+" 0 R"),c("/Flags 96"),c("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),c("/FontName /"+Nc(o.fontName)),c("/ItalicAngle "+o.metadata.italicAngle),c("/Ascent "+o.metadata.ascender),c(">>"),c("endobj"),o.objectNumber=u();for(var b=0;b<o.metadata.hmtx.widths.length;b++)o.metadata.hmtx.widths[b]=parseInt(o.metadata.hmtx.widths[b]*(1e3/o.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+g+" 0 R/BaseFont/"+Nc(o.fontName)+"/FontDescriptor "+y+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),c("endobj"),o.isAlreadyPutted=!0}})(i)}]);var a=function(i){var s,o=i.text||"",c=i.x,u=i.y,f=i.options||{},d=i.mutex||{},p=d.pdfEscape,h=d.activeFontKey,x=d.fonts,g=h,y="",b=0,E="",A=x[g].encoding;if(x[g].encoding!=="Identity-H")return{text:o,x:c,y:u,options:f,mutex:d};for(E=o,g=h,Array.isArray(o)&&(E=o[0]),b=0;b<E.length;b+=1)x[g].metadata.hasOwnProperty("cmap")&&(s=x[g].metadata.cmap.unicode.codeMap[E[b].charCodeAt(0)]),s||E[b].charCodeAt(0)<256&&x[g].metadata.hasOwnProperty("Unicode")?y+=E[b]:y+="";var C="";return parseInt(g.slice(1))<14||A==="WinAnsiEncoding"?C=p(y,g).split("").map(function(N){return N.charCodeAt(0).toString(16)}).join(""):A==="Identity-H"&&(C=r(y,x[g])),d.isHex=!0,{text:C,x:c,y:u,options:f,mutex:d}};t.events.push(["postProcessText",function(i){var s=i.text||"",o=[],c={text:s,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(s)){var u=0;for(u=0;u<s.length;u+=1)Array.isArray(s[u])&&s[u].length===3?o.push([a(Object.assign({},c,{text:s[u][0]})).text,s[u][1],s[u][2]]):o.push(a(Object.assign({},c,{text:s[u]})).text);i.text=o}else i.text=a(Object.assign({},c,{text:s})).text}])}(St),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(St.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var a,i,s,o,c,u,f,d=t,p=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],x={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},g={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},y=["(",")","(","<",">","<","[","]","[","{","}","{","¬´","¬ª","¬´","‚Äπ","‚Ä∫","‚Äπ","‚ÅÖ","‚ÅÜ","‚ÅÖ","‚ÅΩ","‚Åæ","‚ÅΩ","‚Çç","‚Çé","‚Çç","‚â§","‚â•","‚â§","‚å©","‚å™","‚å©","Ôπô","Ôπö","Ôπô","Ôπõ","Ôπú","Ôπõ","Ôπù","Ôπû","Ôπù","Ôπ§","Ôπ•","Ôπ§"],b=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),E=!1,A=0;this.__bidiEngine__={};var C=function(T){var j=T.charCodeAt(),z=j>>8,K=g[z];return K!==void 0?d[256*K+(255&j)]:z===252||z===253?"AL":b.test(z)?"L":z===8?"R":"N"},N=function(T){for(var j,z=0;z<T.length;z++){if((j=C(T.charAt(z)))==="L")return!1;if(j==="R")return!0}return!1},F=function(T,j,z,K){var he,be,we,Q,le=j[K];switch(le){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":E=!1;break;case"N":case"AN":break;case"EN":E&&(le="AN");break;case"AL":E=!0,le="R";break;case"WS":case"BN":le="N";break;case"CS":K<1||K+1>=j.length||(he=z[K-1])!=="EN"&&he!=="AN"||(be=j[K+1])!=="EN"&&be!=="AN"?le="N":E&&(be="AN"),le=be===he?be:"N";break;case"ES":le=(he=K>0?z[K-1]:"B")==="EN"&&K+1<j.length&&j[K+1]==="EN"?"EN":"N";break;case"ET":if(K>0&&z[K-1]==="EN"){le="EN";break}if(E){le="N";break}for(we=K+1,Q=j.length;we<Q&&j[we]==="ET";)we++;le=we<Q&&j[we]==="EN"?"EN":"N";break;case"NSM":if(s&&!o){for(Q=j.length,we=K+1;we<Q&&j[we]==="NSM";)we++;if(we<Q){var ke=T[K],ve=ke>=1425&&ke<=2303||ke===64286;if(he=j[we],ve&&(he==="R"||he==="AL")){le="R";break}}}le=K<1||(he=j[K-1])==="B"?"N":z[K-1];break;case"B":E=!1,a=!0,le=A;break;case"S":i=!0,le="N"}return le},O=function(T,j,z){var K=T.split("");return z&&I(K,z,{hiLevel:A}),K.reverse(),j&&j.reverse(),K.join("")},I=function(T,j,z){var K,he,be,we,Q,le=-1,ke=T.length,ve=0,S=[],L=A?h:p,D=[];for(E=!1,a=!1,i=!1,he=0;he<ke;he++)D[he]=C(T[he]);for(be=0;be<ke;be++){if(Q=ve,S[be]=F(T,D,S,be),K=240&(ve=L[Q][x[S[be]]]),ve&=15,j[be]=we=L[ve][5],K>0)if(K===16){for(he=le;he<be;he++)j[he]=1;le=-1}else le=-1;if(L[ve][6])le===-1&&(le=be);else if(le>-1){for(he=le;he<be;he++)j[he]=we;le=-1}D[be]==="B"&&(j[be]=0),z.hiLevel|=we}i&&function(R,X,de){for(var me=0;me<de;me++)if(R[me]==="S"){X[me]=A;for(var Y=me-1;Y>=0&&R[Y]==="WS";Y--)X[Y]=A}}(D,j,ke)},P=function(T,j,z,K,he){if(!(he.hiLevel<T)){if(T===1&&A===1&&!a)return j.reverse(),void(z&&z.reverse());for(var be,we,Q,le,ke=j.length,ve=0;ve<ke;){if(K[ve]>=T){for(Q=ve+1;Q<ke&&K[Q]>=T;)Q++;for(le=ve,we=Q-1;le<we;le++,we--)be=j[le],j[le]=j[we],j[we]=be,z&&(be=z[le],z[le]=z[we],z[we]=be);ve=Q}ve++}}},H=function(T,j,z){var K=T.split(""),he={hiLevel:A};return z||(z=[]),I(K,z,he),function(be,we,Q){if(Q.hiLevel!==0&&f)for(var le,ke=0;ke<be.length;ke++)we[ke]===1&&(le=y.indexOf(be[ke]))>=0&&(be[ke]=y[le+1])}(K,z,he),P(2,K,j,z,he),P(1,K,j,z,he),K.join("")};return this.__bidiEngine__.doBidiReorder=function(T,j,z){if(function(he,be){if(be)for(var we=0;we<he.length;we++)be[we]=we;o===void 0&&(o=N(he)),u===void 0&&(u=N(he))}(T,j),s||!c||u)if(s&&c&&o^u)A=o?1:0,T=O(T,j,z);else if(!s&&c&&u)A=o?1:0,T=H(T,j,z),T=O(T,j);else if(!s||o||c||u){if(s&&!c&&o^u)T=O(T,j),o?(A=0,T=H(T,j,z)):(A=1,T=H(T,j,z),T=O(T,j));else if(s&&o&&!c&&u)A=1,T=H(T,j,z),T=O(T,j);else if(!s&&!c&&o^u){var K=f;o?(A=1,T=H(T,j,z),A=0,f=!1,T=H(T,j,z),f=K):(A=0,T=H(T,j,z),T=O(T,j),A=1,f=!1,T=H(T,j,z),f=K,T=O(T,j))}}else A=0,T=H(T,j,z);else A=o?1:0,T=H(T,j,z);return T},this.__bidiEngine__.setOptions=function(T){T&&(s=T.isInputVisual,c=T.isOutputVisual,o=T.isInputRtl,u=T.isOutputRtl,f=T.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var a=n.text;n.x,n.y;var i=n.options||{};n.mutex,i.lang;var s=[];if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,r.setOptions(i),Object.prototype.toString.call(a)==="[object Array]"){var o=0;for(s=[],o=0;o<a.length;o+=1)Object.prototype.toString.call(a[o])==="[object Array]"?s.push([r.doBidiReorder(a[o][0]),a[o][1],a[o][2]]):s.push([r.doBidiReorder(a[o])]);n.text=s}else n.text=r.doBidiReorder(a);r.setOptions({isInputVisual:!0})}])}(St),St.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new $o(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new iJ(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new HZ(this.contents),this.head=new VZ(this),this.name=new JZ(this),this.cmap=new Sj(this),this.toUnicode={},this.hhea=new KZ(this),this.maxp=new QZ(this),this.hmtx=new eJ(this),this.post=new XZ(this),this.os2=new YZ(this),this.loca=new aJ(this),this.glyf=new tJ(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,a,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var s,o,c,u;for(u=[],s=0,o=(c=this.bbox).length;s<o;s++)t=c[s],u.push(Math.round(t*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(n=255&(a=this.post.italic_angle),32768&(r=a>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var a,i,s,o;for(s=0,i=0,o=(t=""+t).length;0<=o?i<o:i>o;i=0<=o?++i:--i)a=t.charCodeAt(i),s+=this.widthOfGlyph(this.characterToGlyph(a))+n*(1e3/r)||0;return s*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var $i,$o=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,a;for(a=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)a.push(this.writeByte(t.charCodeAt(r)));return a},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,a,i,s,o,c;return t=this.readByte(),r=this.readByte(),n=this.readByte(),a=this.readByte(),i=this.readByte(),s=this.readByte(),o=this.readByte(),c=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^a)+16777216*(255^i)+65536*(255^s)+256*(255^o)+(255^c)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*a+16777216*i+65536*s+256*o+c},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,a,i;for(i=[],n=0,a=t.length;n<a;n++)r=t[n],i.push(this.writeByte(r));return i},e}(),HZ=function(){var e;function t(r){var n,a,i;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},a=0,i=this.tableCount;0<=i?a<i:a>i;a=0<=i?++a:--a)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,a,i,s,o,c,u,f,d,p,h,x,g;for(g in h=Object.keys(r).length,c=Math.log(2),d=16*Math.floor(Math.log(h)/c),s=Math.floor(d/c),f=16*h-d,(a=new $o).writeInt(this.scalarType),a.writeShort(h),a.writeShort(d),a.writeShort(s),a.writeShort(f),i=16*h,u=a.pos+i,o=null,x=[],r)for(p=r[g],a.writeString(g),a.writeInt(e(p)),a.writeInt(u),a.writeInt(p.length),x=x.concat(p),g==="head"&&(o=u),u+=p.length;u%4;)x.push(0),u++;return a.write(x),n=2981146554-e(a.data),a.pos=o+8,a.writeUInt32(n),a.data},e=function(r){var n,a,i,s;for(r=Aj.call(r);r.length%4;)r.push(0);for(i=new $o(r),a=0,n=0,s=r.length;n<s;n=n+=4)a+=i.readUInt32();return 4294967295&a},t}(),GZ={}.hasOwnProperty,ds=function(e,t){for(var r in t)GZ.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};$i=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var VZ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ds(e,$i),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new $o).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e}(),Q_=function(){function e(t,r){var n,a,i,s,o,c,u,f,d,p,h,x,g,y,b,E,A;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),d=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=t.readByte();break;case 4:for(h=t.readUInt16(),p=h/2,t.pos+=6,i=function(){var C,N;for(N=[],c=C=0;0<=p?C<p:C>p;c=0<=p?++C:--C)N.push(t.readUInt16());return N}(),t.pos+=2,g=function(){var C,N;for(N=[],c=C=0;0<=p?C<p:C>p;c=0<=p?++C:--C)N.push(t.readUInt16());return N}(),u=function(){var C,N;for(N=[],c=C=0;0<=p?C<p:C>p;c=0<=p?++C:--C)N.push(t.readUInt16());return N}(),f=function(){var C,N;for(N=[],c=C=0;0<=p?C<p:C>p;c=0<=p?++C:--C)N.push(t.readUInt16());return N}(),a=(this.length-t.pos+this.offset)/2,o=function(){var C,N;for(N=[],c=C=0;0<=a?C<a:C>a;c=0<=a?++C:--C)N.push(t.readUInt16());return N}(),c=b=0,A=i.length;b<A;c=++b)for(y=i[c],n=E=x=g[c];x<=y?E<=y:E>=y;n=x<=y?++E:--E)f[c]===0?s=n+u[c]:(s=o[f[c]/2+(n-x)-(p-c)]||0)!==0&&(s+=u[c]),this.codeMap[n]=65535&s}t.pos=d}return e.encode=function(t,r){var n,a,i,s,o,c,u,f,d,p,h,x,g,y,b,E,A,C,N,F,O,I,P,H,T,j,z,K,he,be,we,Q,le,ke,ve,S,L,D,R,X,de,me,Y,oe,ue,fe;switch(K=new $o,s=Object.keys(t).sort(function(Ue,xe){return Ue-xe}),r){case"macroman":for(g=0,y=function(){var Ue=[];for(x=0;x<256;++x)Ue.push(0);return Ue}(),E={0:0},i={},he=0,le=s.length;he<le;he++)E[Y=t[a=s[he]]]==null&&(E[Y]=++g),i[a]={old:t[a],new:E[t[a]]},y[a]=E[t[a]];return K.writeUInt16(1),K.writeUInt16(0),K.writeUInt32(12),K.writeUInt16(0),K.writeUInt16(262),K.writeUInt16(0),K.write(y),{charMap:i,subtable:K.data,maxGlyphID:g+1};case"unicode":for(j=[],d=[],A=0,E={},n={},b=u=null,be=0,ke=s.length;be<ke;be++)E[N=t[a=s[be]]]==null&&(E[N]=++A),n[a]={old:N,new:E[N]},o=E[N]-a,b!=null&&o===u||(b&&d.push(b),j.push(a),u=o),b=a;for(b&&d.push(b),d.push(65535),j.push(65535),H=2*(P=j.length),I=2*Math.pow(Math.log(P)/Math.LN2,2),p=Math.log(I/2)/Math.LN2,O=2*P-I,c=[],F=[],h=[],x=we=0,ve=j.length;we<ve;x=++we){if(T=j[x],f=d[x],T===65535){c.push(0),F.push(0);break}if(T-(z=n[T].new)>=32768)for(c.push(0),F.push(2*(h.length+P-x)),a=Q=T;T<=f?Q<=f:Q>=f;a=T<=f?++Q:--Q)h.push(n[a].new);else c.push(z-T),F.push(0)}for(K.writeUInt16(3),K.writeUInt16(1),K.writeUInt32(12),K.writeUInt16(4),K.writeUInt16(16+8*P+2*h.length),K.writeUInt16(0),K.writeUInt16(H),K.writeUInt16(I),K.writeUInt16(p),K.writeUInt16(O),de=0,S=d.length;de<S;de++)a=d[de],K.writeUInt16(a);for(K.writeUInt16(0),me=0,L=j.length;me<L;me++)a=j[me],K.writeUInt16(a);for(oe=0,D=c.length;oe<D;oe++)o=c[oe],K.writeUInt16(o);for(ue=0,R=F.length;ue<R;ue++)C=F[ue],K.writeUInt16(C);for(fe=0,X=h.length;fe<X;fe++)g=h[fe],K.writeUInt16(g);return{charMap:n,subtable:K.data,maxGlyphID:A+1}}},e}(),Sj=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ds(e,$i),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,n,a;for(t.pos=this.offset,this.version=t.readUInt16(),a=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=a?n<a:n>a;n=0<=a?++n:--n)r=new Q_(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var n,a;return r==null&&(r="macroman"),n=Q_.encode(t,r),(a=new $o).writeUInt16(0),a.writeUInt16(1),n.table=a.data.concat(n.subtable),n},e}(),KZ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ds(e,$i),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),YZ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ds(e,$i),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(t.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(t.readInt());return n}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(t.readInt());return n}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),XZ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ds(e,$i),e.prototype.tag="post",e.prototype.parse=function(t){var r,n,a;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var i;for(n=t.readUInt16(),this.glyphNameIndex=[],i=0;0<=n?i<n:i>n;i=0<=n?++i:--i)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],a=[];t.pos<this.offset+this.length;)r=t.readByte(),a.push(this.names.push(t.readString(r)));return a;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 262144:return this.map=(function(){var s,o,c;for(c=[],i=s=0,o=this.file.maxp.numGlyphs;0<=o?s<o:s>o;i=0<=o?++s:--s)c.push(t.readUInt32());return c}).call(this)}},e}(),ZZ=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},JZ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ds(e,$i),e.prototype.tag="name",e.prototype.parse=function(t){var r,n,a,i,s,o,c,u,f,d,p;for(t.pos=this.offset,t.readShort(),r=t.readShort(),o=t.readShort(),n=[],i=0;0<=r?i<r:i>r;i=0<=r?++i:--i)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+o+t.readShort()});for(c={},i=f=0,d=n.length;f<d;i=++f)a=n[i],t.pos=a.offset,u=t.readString(a.length),s=new ZZ(u,a),c[p=a.nameID]==null&&(c[p]=[]),c[a.nameID].push(s);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},e}(),QZ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ds(e,$i),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),eJ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ds(e,$i),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,n,a,i,s,o,c;for(t.pos=this.offset,this.metrics=[],r=0,o=this.file.hhea.numberOfMetrics;0<=o?r<o:r>o;r=0<=o?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(a=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,f;for(f=[],r=u=0;0<=a?u<a:u>a;r=0<=a?++u:--u)f.push(t.readInt16());return f}(),this.widths=(function(){var u,f,d,p;for(p=[],u=0,f=(d=this.metrics).length;u<f;u++)i=d[u],p.push(i.advance);return p}).call(this),n=this.widths[this.widths.length-1],c=[],r=s=0;0<=a?s<a:s>a;r=0<=a?++s:--s)c.push(this.widths.push(n));return c},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),Aj=[].slice,tJ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ds(e,$i),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,n,a,i,s,o,c,u,f,d;return t in this.cache?this.cache[t]:(i=this.file.loca,r=this.file.contents,n=i.indexOf(t),(a=i.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+n,s=(o=new $o(r.read(a))).readShort(),u=o.readShort(),d=o.readShort(),c=o.readShort(),f=o.readShort(),this.cache[t]=s===-1?new nJ(o,u,d,c,f):new rJ(o,s,u,d,c,f),this.cache[t]))},e.prototype.encode=function(t,r,n){var a,i,s,o,c;for(s=[],i=[],o=0,c=r.length;o<c;o++)a=t[r[o]],i.push(s.length),a&&(s=s.concat(a.encode(n)));return i.push(s.length),{table:s,offsets:i}},e}(),rJ=function(){function e(t,r,n,a,i,s){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=a,this.xMax=i,this.yMax=s,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),nJ=function(){function e(t,r,n,a,i){var s,o;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=a,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;o=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&o;)s.pos+=1&o?4:2,128&o?s.pos+=8:64&o?s.pos+=4:8&o&&(s.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new $o(Aj.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),aJ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ds(e,$i),e.prototype.tag="loca",e.prototype.parse=function(t){var r,n;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var a,i;for(i=[],n=0,a=this.length;n<a;n+=2)i.push(2*t.readUInt16());return i}).call(this):(function(){var a,i;for(i=[],n=0,a=this.length;n<a;n+=4)i.push(t.readUInt32());return i}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var n=new Uint32Array(this.offsets.length),a=0,i=0,s=0;s<n.length;++s)if(n[s]=a,i<r.length&&r[i]==s){++i,n[s]=a;var o=this.offsets[s],c=this.offsets[s+1]-o;c>0&&(a+=c)}for(var u=new Array(4*n.length),f=0;f<n.length;++f)u[4*f+3]=255&n[f],u[4*f+2]=(65280&n[f])>>8,u[4*f+1]=(16711680&n[f])>>16,u[4*f]=(4278190080&n[f])>>24;return u},e}(),iJ=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,a,i;for(r in a=this.font.cmap.tables[0].codeMap,t={},i=this.subset)n=i[r],t[r]=a[n];return t},e.prototype.glyphsFor=function(t){var r,n,a,i,s,o,c;for(a={},s=0,o=t.length;s<o;s++)a[i=t[s]]=this.font.glyf.glyphFor(i);for(i in r=[],a)(n=a[i])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(i in c=this.glyphsFor(r))n=c[i],a[i]=n;return a},e.prototype.encode=function(t,r){var n,a,i,s,o,c,u,f,d,p,h,x,g,y,b;for(a in n=Sj.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(t),h={0:0},b=n.charMap)h[(c=b[a]).old]=c.new;for(x in p=n.maxGlyphID,s)x in h||(h[x]=p++);return f=function(E){var A,C;for(A in C={},E)C[E[A]]=A;return C}(h),d=Object.keys(f).sort(function(E,A){return E-A}),g=function(){var E,A,C;for(C=[],E=0,A=d.length;E<A;E++)o=d[E],C.push(f[o]);return C}(),i=this.font.glyf.encode(s,g,h),u=this.font.loca.encode(i.offsets,g),y={cmap:this.font.cmap.raw(),glyf:i.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(y["OS/2"]=this.font.os2.raw()),this.font.directory.encode(y)},e}();St.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,a,i,s;if(Array.isArray(r))return"["+function(){var o,c,u;for(u=[],o=0,c=r.length;o<c;o++)n=r[o],u.push(t.convert(n));return u}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(a in i=["<<"],r)s=r[a],i.push("/"+a+" "+t.convert(s));return i.push(">>"),i.join(`
`)}return""+r},t}();const sJ=()=>{const{user:e}=aa(),[t,r]=M.useState({totalPurchases:0,totalPayments:0,totalGives:0,totalTakes:0,totalSpends:0,netOutstanding:0,supplierBreakdown:[],personBreakdown:[],spendBreakdown:[],pieChartData:[],categoryFilter:"suppliers"}),[n,a]=M.useState([]),[i,s]=M.useState([]),[o,c]=M.useState(!0),[u,f]=M.useState(""),[d,p]=M.useState(""),[h,x]=M.useState(!1);M.useEffect(()=>{const N=new Date,F=new Date(N);F.setDate(N.getDate()-30),f(F.toISOString().split("T")[0]),p(N.toISOString().split("T")[0])},[]),M.useEffect(()=>{u&&d&&g()},[e,u,d]),M.useEffect(()=>{const N=()=>{h&&x(!1)};return document.addEventListener("mousedown",N),()=>{document.removeEventListener("mousedown",N)}},[h]);const g=async N=>{if(!e)return;const F=N||t.categoryFilter;try{c(!0);const{data:O,error:I}=await Ke.from("transactions").select(`
          *,
          supplier:suppliers(name)
        `).eq("user_id",e.id).gte("created_at",u).lte("created_at",d+"T23:59:59").order("created_at",{ascending:!1});if(I)throw I;const{data:P,error:H}=await Ke.from("loan_transactions").select(`
          *,
          person:persons(name)
        `).eq("user_id",e.id).gte("created_at",u).lte("created_at",d+"T23:59:59").order("created_at",{ascending:!1});if(H)throw H;const{data:T,error:j}=await Ke.from("spends").select("*").eq("user_id",e.id).gte("date",u).lte("date",d).order("date",{ascending:!1});if(j)throw j;a(O||[]),s(P||[]);const z=new Map;let K=0,he=0;O==null||O.forEach(Y=>{var Ue;const oe=((Ue=Y.supplier)==null?void 0:Ue.name)||"Unknown",ue=parseFloat(Y.amount.toString());z.has(oe)||z.set(oe,{supplier:oe,purchases:0,payments:0,outstanding:0});const fe=z.get(oe);Y.type==="new_purchase"?(fe.purchases+=ue,K+=ue,Y.is_paid||(fe.outstanding+=ue)):(Y.type==="pay_due"||Y.type==="settle_bill")&&(fe.payments+=ue,he+=ue,fe.outstanding-=ue),z.set(oe,fe)});const be=new Map;let we=0,Q=0;P==null||P.forEach(Y=>{var Ue;const oe=((Ue=Y.person)==null?void 0:Ue.name)||"Unknown",ue=parseFloat(Y.amount.toString());be.has(oe)||be.set(oe,{person:oe,gives:0,takes:0,outstanding:0});const fe=be.get(oe);Y.type==="Gives"?(fe.gives+=ue,we+=ue,fe.outstanding+=ue):Y.type==="Takes"&&(fe.takes+=ue,Q+=ue,fe.outstanding-=ue),be.set(oe,fe)});const le=Array.from(z.values()).sort((Y,oe)=>oe.purchases-Y.purchases),ke=Array.from(be.values()).sort((Y,oe)=>oe.gives-Y.gives),ve=new Map;let S=0;T==null||T.forEach(Y=>{const oe=Y.category,ue=parseFloat(Y.amount.toString());ve.has(oe)||ve.set(oe,{category:oe,amount:0});const fe=ve.get(oe);fe.amount+=ue,S+=ue,ve.set(oe,fe)});const L=Array.from(ve.values()).sort((Y,oe)=>oe.amount-Y.amount),D=le.reduce((Y,oe)=>Y+oe.outstanding,0),R=ke.reduce((Y,oe)=>Y+oe.outstanding,0),X=D+R,de=["#3B82F6","#EF4444","#10B981","#F59E0B","#8B5CF6","#EC4899","#14B8A6","#F97316","#6366F1","#84CC16"];let me=[];F==="suppliers"?me=le.filter(Y=>Y.purchases>0).slice(0,5).map((Y,oe)=>({name:Y.supplier,value:Y.purchases,color:de[oe%de.length]})):F==="persons"?me=ke.filter(Y=>Y.gives>0).slice(0,5).map((Y,oe)=>({name:Y.person,value:Y.gives,color:de[oe%de.length]})):F==="spends"&&(me=L.filter(Y=>Y.amount>0).slice(0,5).map((Y,oe)=>({name:Y.category,value:Y.amount,color:de[oe%de.length]}))),r({totalPurchases:K,totalPayments:he,totalGives:we,totalTakes:Q,totalSpends:S,netOutstanding:Math.max(0,X),supplierBreakdown:le,personBreakdown:ke,spendBreakdown:L,pieChartData:me,categoryFilter:F})}catch(O){console.error("Error fetching report data:",O)}finally{c(!1)}},y=async()=>{const N=t.categoryFilter,F=["Date","Entity","Type","Description","Amount","Status","Transaction Type"];let O=[];if(N==="suppliers"){const j=n.map(z=>{var K;return[new Date(z.created_at).toLocaleDateString("en-IN"),((K=z.supplier)==null?void 0:K.name)||"Unknown",A(z.type),z.description,parseFloat(z.amount.toString()),z.is_paid?"Paid":"Unpaid","Supplier"]});O=[...O,...j]}if(N==="persons"){const j=i.map(z=>{var K;return[new Date(z.created_at).toLocaleDateString("en-IN"),((K=z.person)==null?void 0:K.name)||"Unknown",z.type,z.description||"",parseFloat(z.amount.toString()),"Completed","Person"]});O=[...O,...j]}if(N==="spends"){const{data:j}=await Ke.from("spends").select("*").gte("created_at",`${u}T00:00:00.000Z`).lte("created_at",`${d}T23:59:59.999Z`).eq("user_id",e==null?void 0:e.id);if(j){const z=j.map(K=>[new Date(K.created_at).toLocaleDateString("en-IN"),K.category,"Spend",K.description,parseFloat(K.amount.toString()),"Completed","Spend"]);O=[...O,...z]}}const I=[F.join(","),...O.map(j=>j.map(z=>`"${z}"`).join(","))].join(`
`),P=new Blob([I],{type:"text/csv;charset=utf-8;"}),H=document.createElement("a"),T=URL.createObjectURL(P);H.setAttribute("href",T),H.setAttribute("download",`transactions-report-${u}-to-${d}.csv`),H.style.visibility="hidden",document.body.appendChild(H),H.click(),document.body.removeChild(H)},b=async()=>{const N=t.categoryFilter;let F=[];if(N==="suppliers"){const H=n.map(T=>{var j;return{Date:new Date(T.created_at).toLocaleDateString("en-IN"),Entity:((j=T.supplier)==null?void 0:j.name)||"Unknown",Type:A(T.type),Description:T.description,Amount:parseFloat(T.amount.toString()),Status:T.is_paid?"Paid":"Unpaid","Transaction Type":"Supplier"}});F=[...F,...H]}if(N==="persons"){const H=i.map(T=>{var j;return{Date:new Date(T.created_at).toLocaleDateString("en-IN"),Entity:((j=T.person)==null?void 0:j.name)||"Unknown",Type:T.type,Description:T.description||"",Amount:parseFloat(T.amount.toString()),Status:"Completed","Transaction Type":"Person"}});F=[...F,...H]}if(N==="spends"){const{data:H}=await Ke.from("spends").select("*").gte("created_at",`${u}T00:00:00.000Z`).lte("created_at",`${d}T23:59:59.999Z`).eq("user_id",e==null?void 0:e.id);if(H){const T=H.map(j=>({Date:new Date(j.created_at).toLocaleDateString("en-IN"),Category:j.category,Description:j.description,Amount:parseFloat(j.amount.toString()),"Transaction Type":"Spend"}));F=[...F,...T]}}const O=yo.book_new();yo.book_append_sheet(O,yo.json_to_sheet(F),"Transactions");const I=[];N==="suppliers"&&I.push({Metric:"Total Purchases",Value:t.totalPurchases},{Metric:"Total Payments",Value:t.totalPayments}),N==="persons"&&I.push({Metric:"Total Gives",Value:t.totalGives},{Metric:"Total Takes",Value:t.totalTakes}),N==="spends"&&I.push({Metric:"Total Spends",Value:t.totalSpends}),I.push({Metric:"Net Outstanding",Value:t.netOutstanding});const P=yo.json_to_sheet(I);yo.book_append_sheet(O,P,"Summary"),H3(O,`transactions-report-${u}-to-${d}.xlsx`)},E=async()=>{const N=t.categoryFilter,F=new St;F.setFontSize(20),F.text(`${N==="suppliers"?"Supplier":N==="persons"?"Person":"Spends"} Transaction Report`,20,20),F.setFontSize(12),F.text(`Period: ${u} to ${d}`,20,35),F.setFontSize(14),F.text("Summary",20,55),F.setFontSize(10);let O=70;N==="suppliers"&&(F.text(`Total Purchases: ‚Çπ${t.totalPurchases.toLocaleString()}`,20,O),O+=10,F.text(`Total Payments: ‚Çπ${t.totalPayments.toLocaleString()}`,20,O),O+=10),N==="persons"&&(F.text(`Total Gives: ‚Çπ${t.totalGives.toLocaleString()}`,20,O),O+=10,F.text(`Total Takes: ‚Çπ${t.totalTakes.toLocaleString()}`,20,O),O+=10),N==="spends"&&(F.text(`Total Spends: ‚Çπ${t.totalSpends.toLocaleString()}`,20,O),O+=10),F.text(`Net Outstanding: ‚Çπ${t.netOutstanding.toLocaleString()}`,20,O),O+=20,N==="suppliers"&&t.supplierBreakdown.length>0?(F.setFontSize(14),F.text("Top Suppliers by Purchases",20,O),F.setFontSize(10),O+=15,t.supplierBreakdown.slice(0,10).forEach((I,P)=>{O>270&&(F.addPage(),O=20),F.text(`${P+1}. ${I.supplier}: ‚Çπ${I.purchases.toLocaleString()}`,20,O),O+=10})):N==="persons"&&t.personBreakdown.length>0?(F.setFontSize(14),F.text("Top Persons by Loans Given",20,O),F.setFontSize(10),O+=15,t.personBreakdown.slice(0,10).forEach((I,P)=>{O>270&&(F.addPage(),O=20),F.text(`${P+1}. ${I.person}: ‚Çπ${I.gives.toLocaleString()}`,20,O),O+=10})):N==="spends"&&t.spendBreakdown.length>0&&(F.setFontSize(14),F.text("Top Spend Categories",20,O),F.setFontSize(10),O+=15,t.spendBreakdown.slice(0,10).forEach((I,P)=>{O>270&&(F.addPage(),O=20),F.text(`${P+1}. ${I.category}: ‚Çπ${I.amount.toLocaleString()}`,20,O),O+=10})),F.save(`${N==="suppliers"?"supplier":N==="persons"?"person":"spends"}-transaction-report-${u}-to-${d}.pdf`)},A=N=>{switch(N){case"new_purchase":return"New Purchase";case"pay_due":return"Payment";case"settle_bill":return"Settlement";default:return N}},C=N=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(N);return l.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Reports"}),l.jsx("p",{className:"text-gray-600 mt-1",children:"Analyze your supplier transactions and purchases"})]}),l.jsxs("div",{className:"relative export-dropdown",children:[l.jsxs("button",{onClick:()=>x(!h),disabled:n.length===0,className:"w-full sm:w-auto bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed",children:[l.jsx(zc,{className:"h-4 w-4 mr-2"}),"Export"]}),h&&l.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-20",children:l.jsxs("div",{className:"py-2",children:[l.jsxs("button",{onClick:()=>{y(),x(!1)},className:"w-full text-left px-4 py-2 hover:bg-gray-50 flex items-center text-gray-700",children:[l.jsx(_o,{className:"h-4 w-4 mr-3 text-green-600"}),"Export as CSV"]}),l.jsxs("button",{onClick:()=>{b(),x(!1)},className:"w-full text-left px-4 py-2 hover:bg-gray-50 flex items-center text-gray-700",children:[l.jsx(bT,{className:"h-4 w-4 mr-3 text-blue-600"}),"Export as Excel"]}),l.jsxs("button",{onClick:()=>{E(),x(!1)},className:"w-full text-left px-4 py-2 hover:bg-gray-50 flex items-center text-gray-700",children:[l.jsx(zc,{className:"h-4 w-4 mr-3 text-red-600"}),"Export as PDF"]})]})})]})]}),l.jsx("div",{className:"border-b border-gray-200 mb-6",children:l.jsxs("nav",{className:"-mb-px flex space-x-8",children:[l.jsxs("button",{onClick:()=>{r(N=>({...N,categoryFilter:"suppliers"})),g("suppliers")},className:`py-2 px-1 border-b-2 font-medium text-sm ${t.categoryFilter==="suppliers"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[l.jsx(Wn,{className:"h-4 w-4 inline mr-2"}),"Suppliers"]}),l.jsxs("button",{onClick:()=>{r(N=>({...N,categoryFilter:"persons"})),g("persons")},className:`py-2 px-1 border-b-2 font-medium text-sm ${t.categoryFilter==="persons"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[l.jsx(qr,{className:"h-4 w-4 inline mr-2"}),"Persons"]}),l.jsxs("button",{onClick:()=>{r(N=>({...N,categoryFilter:"spends"})),g("spends")},className:`py-2 px-1 border-b-2 font-medium text-sm ${t.categoryFilter==="spends"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[l.jsx(li,{className:"h-4 w-4 inline mr-2"}),"Spends"]})]})}),l.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:l.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:items-center sm:space-y-0 sm:space-x-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Zg,{className:"h-5 w-5 text-gray-400"}),l.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Filters"})]}),l.jsxs("div",{className:"flex flex-col space-y-3 sm:flex-row sm:items-center sm:space-y-0 sm:space-x-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(Po,{className:"h-4 w-4 text-gray-400"}),l.jsx("label",{className:"text-sm font-medium text-gray-700 min-w-max",children:"From:"}),l.jsx("input",{type:"date",value:u,onChange:N=>f(N.target.value),className:"flex-1 border border-gray-300 rounded-lg px-3 py-1.5 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("label",{className:"text-sm font-medium text-gray-700 min-w-max",children:"To:"}),l.jsx("input",{type:"date",value:d,onChange:N=>p(N.target.value),className:"flex-1 border border-gray-300 rounded-lg px-3 py-1.5 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]})}),o?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:[t.categoryFilter==="suppliers"&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:l.jsxs("div",{className:"flex items-center",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Purchases"}),l.jsx("p",{className:"text-xl sm:text-2xl font-bold text-blue-600",children:C(t.totalPurchases)})]}),l.jsx(Fd,{className:"h-6 w-6 sm:h-8 sm:w-8 text-blue-600"})]})}),l.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:l.jsxs("div",{className:"flex items-center",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Payments"}),l.jsx("p",{className:"text-xl sm:text-2xl font-bold text-green-600",children:C(t.totalPayments)})]}),l.jsx(Am,{className:"h-6 w-6 sm:h-8 sm:w-8 text-green-600"})]})})]}),t.categoryFilter==="persons"&&l.jsxs(l.Fragment,{children:[l.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:l.jsxs("div",{className:"flex items-center",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Gives"}),l.jsx("p",{className:"text-xl sm:text-2xl font-bold text-red-600",children:C(t.totalGives)})]}),l.jsx(Fd,{className:"h-6 w-6 sm:h-8 sm:w-8 text-red-600"})]})}),l.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:l.jsxs("div",{className:"flex items-center",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Takes"}),l.jsx("p",{className:"text-xl sm:text-2xl font-bold text-green-600",children:C(t.totalTakes)})]}),l.jsx(Am,{className:"h-6 w-6 sm:h-8 sm:w-8 text-green-600"})]})})]}),t.categoryFilter==="spends"&&l.jsx(l.Fragment,{children:l.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:l.jsxs("div",{className:"flex items-center",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Spends"}),l.jsx("p",{className:"text-xl sm:text-2xl font-bold text-purple-600",children:C(t.totalSpends)})]}),l.jsx(Am,{className:"h-6 w-6 sm:h-8 sm:w-8 text-purple-600"})]})})}),l.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6 sm:col-span-2 lg:col-span-1",children:l.jsxs("div",{className:"flex items-center",children:[l.jsxs("div",{className:"flex-1",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Outstanding Amount"}),l.jsx("p",{className:"text-xl sm:text-2xl font-bold text-red-600",children:C(t.netOutstanding)})]}),l.jsx(li,{className:"h-6 w-6 sm:h-8 sm:w-8 text-red-600"})]})})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-4 sm:mb-6",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:t.categoryFilter==="suppliers"?"Purchase Distribution by Suppliers":t.categoryFilter==="persons"?"Loan Distribution by Persons":"Spend Distribution by Categories"}),l.jsx("p",{className:"text-gray-600 mt-1 text-sm sm:text-base",children:t.categoryFilter==="suppliers"?"Shows purchase amounts from each supplier":t.categoryFilter==="persons"?"Shows loan amounts given to each person":"Shows spending amounts by category"})]}),l.jsx(hy,{className:"h-6 w-6 text-gray-400 mt-2 sm:mt-0"})]}),t.pieChartData.length>0?l.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-4 sm:gap-6",children:[l.jsx("div",{className:"h-64 sm:h-80",children:l.jsx(HW,{width:"100%",height:"100%",children:l.jsxs(aK,{children:[l.jsx(sE,{data:t.pieChartData,cx:"50%",cy:"50%",outerRadius:80,fill:"#8884d8",dataKey:"value",children:t.pieChartData.map((N,F)=>l.jsx(Bp,{fill:N.color},`cell-${F}`))}),l.jsx(BW,{formatter:N=>[C(Number(N)),t.categoryFilter==="suppliers"?"Purchases":t.categoryFilter==="persons"?"Loans Given":"Spends"],labelFormatter:N=>`${N}`})]})})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:t.categoryFilter==="suppliers"?"Top Suppliers":t.categoryFilter==="persons"?"Top Persons":"Top Spend Categories"}),l.jsx("div",{className:"space-y-3",children:t.pieChartData.slice(0,8).map(N=>l.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"w-4 h-4 rounded-full mr-3",style:{backgroundColor:N.color}}),l.jsx("span",{className:"font-medium text-gray-900",children:N.name})]}),l.jsx("span",{className:"text-gray-600 font-semibold",children:C(N.value)})]},N.name))})]})]}):l.jsxs("div",{className:"text-center py-12",children:[l.jsx(hy,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500",children:t.categoryFilter==="suppliers"?"No purchase data available for the selected period":t.categoryFilter==="persons"?"No loan data available for the selected period":"No spend data available for the selected period"})]})]}),t.categoryFilter==="suppliers"&&l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-4 sm:mb-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Detailed Supplier Breakdown"}),l.jsx(li,{className:"h-5 w-5 text-gray-400 mt-2 sm:mt-0"})]}),t.supplierBreakdown.length>0?l.jsx("div",{className:"space-y-3 sm:space-y-4",children:t.supplierBreakdown.map((N,F)=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 sm:p-4",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-3",children:[l.jsx("h3",{className:"font-medium text-gray-900 text-sm sm:text-base",children:N.supplier}),l.jsxs("span",{className:"text-xs sm:text-sm font-medium text-blue-600 mt-1 sm:mt-0",children:["Outstanding: ",C(N.outstanding)]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-3 sm:gap-4 text-xs sm:text-sm",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-600",children:"Total Purchases"}),l.jsx("p",{className:"font-medium text-red-600",children:C(N.purchases)})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-600",children:"Total Payments"}),l.jsx("p",{className:"font-medium text-green-600",children:C(N.payments)})]})]})]},F))}):l.jsxs("div",{className:"text-center py-6 sm:py-8",children:[l.jsx(li,{className:"h-10 w-10 sm:h-12 sm:w-12 text-gray-400 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500 text-sm sm:text-base",children:"No data available for the selected period"})]})]}),t.categoryFilter==="persons"&&l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-4 sm:mb-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Detailed Person Breakdown"}),l.jsx(li,{className:"h-5 w-5 text-gray-400 mt-2 sm:mt-0"})]}),t.personBreakdown.length>0?l.jsx("div",{className:"space-y-3 sm:space-y-4",children:t.personBreakdown.map((N,F)=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 sm:p-4",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-3",children:[l.jsx("h3",{className:"font-medium text-gray-900 text-sm sm:text-base",children:N.person}),l.jsxs("span",{className:"text-xs sm:text-sm font-medium text-blue-600 mt-1 sm:mt-0",children:["Outstanding: ",C(N.outstanding)]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-3 sm:gap-4 text-xs sm:text-sm",children:[l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-600",children:"Total Gives"}),l.jsx("p",{className:"font-medium text-red-600",children:C(N.gives)})]}),l.jsxs("div",{children:[l.jsx("p",{className:"text-gray-600",children:"Total Takes"}),l.jsx("p",{className:"font-medium text-green-600",children:C(N.takes)})]})]})]},F))}):l.jsxs("div",{className:"text-center py-6 sm:py-8",children:[l.jsx(li,{className:"h-10 w-10 sm:h-12 sm:w-12 text-gray-400 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500 text-sm sm:text-base",children:"No data available for the selected period"})]})]}),t.categoryFilter==="spends"&&l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-4 sm:mb-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Detailed Spends Breakdown"}),l.jsx(li,{className:"h-5 w-5 text-gray-400 mt-2 sm:mt-0"})]}),t.spendBreakdown.length>0?l.jsx("div",{className:"space-y-3 sm:space-y-4",children:t.spendBreakdown.map((N,F)=>l.jsx("div",{className:"border border-gray-200 rounded-lg p-3 sm:p-4",children:l.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-3",children:[l.jsx("h3",{className:"font-medium text-gray-900 text-sm sm:text-base",children:N.category}),l.jsxs("span",{className:"text-xs sm:text-sm font-medium text-purple-600 mt-1 sm:mt-0",children:["Total: ",C(N.amount)]})]})},F))}):l.jsxs("div",{className:"text-center py-6 sm:py-8",children:[l.jsx(li,{className:"h-10 w-10 sm:h-12 sm:w-12 text-gray-400 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500 text-sm sm:text-base",children:"No data available for the selected period"})]})]})]})]})};class bl{constructor(){this.isAuthenticated=!1,this.userEmail=""}static getInstance(){return bl.instance||(bl.instance=new bl),bl.instance}async initializeGoogleDrive(){console.log("Initializing Google Drive API...")}async authenticate(){try{return new Promise(t=>{setTimeout(()=>{this.isAuthenticated=!0,this.userEmail="user@gmail.com",t({success:!0,userEmail:this.userEmail})},2e3)})}catch(t){return console.error("Google Drive authentication failed:",t),{success:!1,userEmail:""}}}isConnected(){return this.isAuthenticated}getConnectedEmail(){return this.userEmail}async createBackup(t){try{return console.log("Creating backup on Google Drive...",t),new Promise(r=>{setTimeout(()=>{r({success:!0,fileId:`shopsynk-backup-${Date.now()}`})},3e3)})}catch(r){return console.error("Backup creation failed:",r),{success:!1}}}async scheduleAutoBackup(t){console.log("Auto backup scheduled for midnight daily");const r=new Date,n=new Date;n.setHours(24,0,0,0);const a=n.getTime()-r.getTime();setTimeout(()=>{t(),setInterval(t,24*60*60*1e3)},a)}disconnect(){this.isAuthenticated=!1,this.userEmail=""}}class wl{constructor(){this.googleDriveService=bl.getInstance()}static getInstance(){return wl.instance||(wl.instance=new wl),wl.instance}async exportUserData(t,r){try{const{data:n,error:a}=await Ke.from("suppliers").select("*").eq("user_id",t);if(a)throw a;const{data:i,error:s}=await Ke.from("transactions").select(`
          *,
          supplier:suppliers(name, contact_person, phone, email)
        `).eq("user_id",t);if(s)throw s;return{suppliers:n||[],transactions:i||[],exportDate:new Date().toISOString(),userEmail:r}}catch(n){return console.error("Error exporting user data:",n),null}}async createBackup(t,r){try{if(!this.googleDriveService.isConnected())return{success:!1,message:"Google Drive not connected. Please connect first."};const n=await this.exportUserData(t,r);if(!n)return{success:!1,message:"Failed to export user data."};const a=await this.googleDriveService.createBackup(n);return a.success?(await this.recordBackup(t,a.fileId||"",n),{success:!0,message:"Backup created successfully on Google Drive!"}):{success:!1,message:"Failed to upload backup to Google Drive."}}catch(n){return console.error("Backup creation error:",n),{success:!1,message:"An error occurred during backup creation."}}}async recordBackup(t,r,n){try{await Ke.from("user_backups").insert([{user_id:t,backup_date:new Date().toISOString(),google_drive_file_id:r,suppliers_count:n.suppliers.length,transactions_count:n.transactions.length,backup_size:JSON.stringify(n).length,status:"completed"}])}catch(a){console.error("Error recording backup:",a)}}async setupAutoBackup(t,r){const n=async()=>{console.log("Running automatic backup...");const a=await this.createBackup(t,r);console.log("Auto backup result:",a.message),await this.sendBackupNotification(r,a.success)};await this.googleDriveService.scheduleAutoBackup(n)}async sendBackupNotification(t,r){console.log(`Backup notification sent to ${t}: ${r?"Success":"Failed"}`)}async getBackupHistory(t){try{const{data:r,error:n}=await Ke.from("user_backups").select("*").eq("user_id",t).order("backup_date",{ascending:!1}).limit(10);if(n)throw n;return r||[]}catch(r){return console.error("Error fetching backup history:",r),[]}}downloadBackupFile(t){const r=JSON.stringify(t,null,2),n=new Blob([r],{type:"application/json"}),a=URL.createObjectURL(n),i=document.createElement("a");i.href=a,i.download=`shopsynk-backup-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(a)}}const oJ=()=>{const{user:e}=aa(),[t,r]=M.useState(null),[n,a]=M.useState(!0),[i,s]=M.useState("pdf"),[o,c]=M.useState(!1),[u,f]=M.useState(!1),[d,p]=M.useState("");M.useEffect(()=>{h()},[e]);const h=async()=>{if(e)try{a(!0);const{count:N}=await Ke.from("transactions").select("*",{count:"exact",head:!0}).eq("user_id",e.id),{count:F}=await Ke.from("suppliers").select("*",{count:"exact",head:!0}).eq("user_id",e.id),{count:O}=await Ke.from("business_owners").select("*",{count:"exact",head:!0}).eq("user_id",e.id),{data:I}=await Ke.from("user_backups").select("created_at").eq("user_id",e.id).order("created_at",{ascending:!1}).limit(1).single(),P=.5,H=.3,T=.2,j=.1,z=(N||0)*P,K=(F||0)*H,he=(O||0)*T,be=z+K+he+j;r({totalTransactions:N||0,totalSuppliers:F||0,totalOwners:O||0,estimatedSizeKB:be,lastBackup:(I==null?void 0:I.created_at)||null,dataBreakdown:{transactions:{count:N||0,sizeKB:z},suppliers:{count:F||0,sizeKB:K},owners:{count:O||0,sizeKB:he},settings:{count:1,sizeKB:j}}})}catch(N){console.error("Error fetching storage stats:",N)}finally{a(!1)}},x=async N=>{if(e)try{c(!0);const[F,O,I]=await Promise.all([Ke.from("transactions").select("*, supplier:suppliers(name), owner:business_owners(owner_name)").eq("user_id",e.id).order("created_at",{ascending:!1}),Ke.from("suppliers").select("*").eq("user_id",e.id).order("name"),Ke.from("business_owners").select("*").eq("user_id",e.id).order("owner_name")]),P={exportDate:new Date().toISOString(),user:{id:e.id,email:e.email},summary:t,data:{transactions:F.data||[],suppliers:O.data||[],businessOwners:I.data||[]}};N==="json"?g(P):N==="csv"?y(P):N==="pdf"&&b(P)}catch(F){console.error("Error downloading data:",F),alert("Error downloading data. Please try again.")}finally{c(!1)}},g=N=>{const F=new Blob([JSON.stringify(N,null,2)],{type:"application/json"}),O=URL.createObjectURL(F),I=document.createElement("a");I.href=O,I.download=`shopsynk-data-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(I),I.click(),document.body.removeChild(I),URL.revokeObjectURL(O)},y=N=>{let F="Type,Supplier,Amount,Description,Date,Due Date,Status,Handled By\\n";N.data.transactions.forEach(H=>{var T,j;F+=`${H.type},"${((T=H.supplier)==null?void 0:T.name)||"Unknown"}",${H.amount},"${H.description}",${H.created_at},${H.due_date||""},${H.is_paid?"Paid":"Unpaid"},"${((j=H.owner)==null?void 0:j.owner_name)||"Unknown"}"\\n`});const O=new Blob([F],{type:"text/csv"}),I=URL.createObjectURL(O),P=document.createElement("a");P.href=I,P.download=`shopsynk-transactions-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(P),P.click(),document.body.removeChild(P),URL.revokeObjectURL(I)},b=N=>{const F=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Shopsynk Data Export</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 20px; }
          h1, h2 { color: #2563eb; }
          table { width: 100%; border-collapse: collapse; margin: 20px 0; }
          th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
          th { background-color: #f8f9fa; }
          .summary { background-color: #f0f9ff; padding: 15px; border-radius: 5px; margin: 20px 0; }
        </style>
      </head>
      <body>
        <h1>Shopsynk Data Export</h1>
        <p><strong>Export Date:</strong> ${new Date().toLocaleDateString()}</p>
        <p><strong>User:</strong> ${(e==null?void 0:e.email)||"Unknown"}</p>
        
        <div class="summary">
          <h2>Summary</h2>
          <p><strong>Total Transactions:</strong> ${t==null?void 0:t.totalTransactions}</p>
          <p><strong>Total Suppliers:</strong> ${t==null?void 0:t.totalSuppliers}</p>
          <p><strong>Total Owners:</strong> ${t==null?void 0:t.totalOwners}</p>
          <p><strong>Estimated Size:</strong> ${((t==null?void 0:t.estimatedSizeKB)||0).toFixed(2)} KB</p>
        </div>

        <h2>Recent Transactions</h2>
        <table>
          <tr>
            <th>Date</th>
            <th>Type</th>
            <th>Supplier</th>
            <th>Amount</th>
            <th>Status</th>
            <th>Handled By</th>
          </tr>
          ${N.data.transactions.slice(0,50).map(H=>{var T,j;return`
            <tr>
              <td>${new Date(H.created_at).toLocaleDateString()}</td>
              <td>${H.type}</td>
              <td>${((T=H.supplier)==null?void 0:T.name)||"Unknown"}</td>
              <td>‚Çπ${H.amount}</td>
              <td>${H.is_paid?"Paid":"Unpaid"}</td>
              <td>${((j=H.owner)==null?void 0:j.owner_name)||"Unknown"}</td>
            </tr>
          `}).join("")}
        </table>
      </body>
      </html>
    `,O=new Blob([F],{type:"text/html"}),I=URL.createObjectURL(O),P=document.createElement("a");P.href=I,P.download=`shopsynk-report-${new Date().toISOString().split("T")[0]}.html`,document.body.appendChild(P),P.click(),document.body.removeChild(P),URL.revokeObjectURL(I)},E=async()=>{if(e)try{f(!0),p("Preparing backup...");const N=wl.getInstance();p("Creating backup..."),await N.createBackup(e.id,e.email||"unknown@email.com"),p("Backup completed successfully!"),setTimeout(()=>p(""),3e3),await h()}catch(N){console.error("Error creating manual backup:",N),p("Backup failed. Please try again."),setTimeout(()=>p(""),3e3)}finally{f(!1)}},A=N=>N<1?`${(N*1024).toFixed(0)} bytes`:N<1024?`${N.toFixed(2)} KB`:`${(N/1024).toFixed(2)} MB`,C=N=>N?new Date(N).toLocaleString():"Never";return n?l.jsxs("div",{className:"flex items-center justify-center h-64",children:[l.jsx(ts,{className:"h-8 w-8 animate-spin text-blue-500"}),l.jsx("span",{className:"ml-2 text-gray-600",children:"Loading storage information..."})]}):l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Data Storage & Export"}),l.jsxs("button",{onClick:h,className:"flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:[l.jsx(ts,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx(hf,{className:"h-8 w-8 text-blue-500"}),l.jsxs("div",{className:"ml-4",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Storage"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:A((t==null?void 0:t.estimatedSizeKB)||0)})]})]})}),l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx(ma,{className:"h-8 w-8 text-green-500"}),l.jsxs("div",{className:"ml-4",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Transactions"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t==null?void 0:t.totalTransactions})]})]})}),l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx(py,{className:"h-8 w-8 text-purple-500"}),l.jsxs("div",{className:"ml-4",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Suppliers"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t==null?void 0:t.totalSuppliers})]})]})}),l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:l.jsxs("div",{className:"flex items-center",children:[l.jsx(Wn,{className:"h-8 w-8 text-orange-500"}),l.jsxs("div",{className:"ml-4",children:[l.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Business Owners"}),l.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t==null?void 0:t.totalOwners})]})]})})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Storage Breakdown"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx(ma,{className:"h-5 w-5 text-green-500 mr-3"}),l.jsx("span",{className:"font-medium",children:"Transactions Data"})]}),l.jsxs("div",{className:"text-right",children:[l.jsxs("p",{className:"font-medium",children:[t==null?void 0:t.dataBreakdown.transactions.count," records"]}),l.jsx("p",{className:"text-sm text-gray-500",children:A((t==null?void 0:t.dataBreakdown.transactions.sizeKB)||0)})]})]}),l.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx(py,{className:"h-5 w-5 text-purple-500 mr-3"}),l.jsx("span",{className:"font-medium",children:"Suppliers Data"})]}),l.jsxs("div",{className:"text-right",children:[l.jsxs("p",{className:"font-medium",children:[t==null?void 0:t.dataBreakdown.suppliers.count," records"]}),l.jsx("p",{className:"text-sm text-gray-500",children:A((t==null?void 0:t.dataBreakdown.suppliers.sizeKB)||0)})]})]}),l.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx(Wn,{className:"h-5 w-5 text-orange-500 mr-3"}),l.jsx("span",{className:"font-medium",children:"Business Owners"})]}),l.jsxs("div",{className:"text-right",children:[l.jsxs("p",{className:"font-medium",children:[t==null?void 0:t.dataBreakdown.owners.count," records"]}),l.jsx("p",{className:"text-sm text-gray-500",children:A((t==null?void 0:t.dataBreakdown.owners.sizeKB)||0)})]})]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Export Data"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Export Format"}),l.jsxs("select",{value:i,onChange:N=>s(N.target.value),className:"w-full md:w-64 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"pdf",children:"PDF Report"}),l.jsx("option",{value:"csv",children:"CSV (Spreadsheet)"}),l.jsx("option",{value:"json",children:"JSON (Raw Data)"})]})]}),l.jsx("div",{className:"flex flex-wrap gap-3",children:l.jsxs("button",{onClick:()=>x(i),disabled:o,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[o?l.jsx(ts,{className:"h-4 w-4 mr-2 animate-spin"}):l.jsx(zc,{className:"h-4 w-4 mr-2"}),o?"Preparing...":`Download ${i.toUpperCase()}`]})}),l.jsxs("div",{className:"text-sm text-gray-500",children:[l.jsx("p",{children:"‚Ä¢ PDF: Formatted report with summary and recent transactions"}),l.jsx("p",{children:"‚Ä¢ CSV: Spreadsheet format for analysis and import"}),l.jsx("p",{children:"‚Ä¢ JSON: Complete raw data for technical use"})]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Backup Management"}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 rounded-lg border border-blue-200",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx(Nl,{className:"h-6 w-6 text-blue-500 mr-3"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-blue-900",children:"Last Backup"}),l.jsx("p",{className:"text-sm text-blue-700",children:C((t==null?void 0:t.lastBackup)||null)})]})]}),l.jsxs("button",{onClick:E,disabled:u,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[u?l.jsx(ts,{className:"h-4 w-4 mr-2 animate-spin"}):l.jsx(wT,{className:"h-4 w-4 mr-2"}),u?"Creating Backup...":"Create Backup Now"]})]}),d&&l.jsxs("div",{className:`flex items-center p-3 rounded-lg ${d.includes("failed")?"bg-red-50 border border-red-200 text-red-700":d.includes("success")?"bg-green-50 border border-green-200 text-green-700":"bg-yellow-50 border border-yellow-200 text-yellow-700"}`,children:[d.includes("failed")?l.jsx(is,{className:"h-5 w-5 mr-2"}):d.includes("success")?l.jsx(ea,{className:"h-5 w-5 mr-2"}):l.jsx(ts,{className:"h-5 w-5 mr-2 animate-spin"}),d]}),l.jsxs("div",{className:"text-sm text-gray-500",children:[l.jsx("p",{children:"‚Ä¢ Automatic backups run daily when configured"}),l.jsx("p",{children:"‚Ä¢ Manual backups are stored in your connected Google Drive"}),l.jsx("p",{children:"‚Ä¢ Configure automatic backups in your Profile settings"})]})]})]})]})},Ej=[{id:"v1.4.3",version:"1.4.3",name:"The opening page update",date:"October 18, 2025",type:"minor",color:"purple",current:!0,description:"Enhanced user experience with a professional landing page showcasing all features and capabilities.",features:[{category:"User Experience",icon:my,color:"purple",items:["New professional landing page with big logo and branding","Comprehensive feature showcase with detailed descriptions",'Prominent "Get Started" call-to-action button',"Responsive design for all screen sizes","Statistics section highlighting key app benefits"]},{category:"Navigation & Routing",icon:Io,color:"blue",items:["Improved authentication flow with proper redirects","Landing page for unauthenticated users","Dashboard access for authenticated users","Fixed email verification redirects","Enhanced user onboarding experience"]}],impact:"This update significantly improves the first impression and user onboarding experience. New visitors now see a professional landing page that clearly communicates the app's value proposition and features, making it easier for them to understand what Shopsynk offers and get started with the application.",breaking:!1,migration:[]},{id:"v1.4.2",version:"1.4.2",name:"Bugs Fixed",date:"September 26, 2025",type:"patch",color:"blue",current:!1,description:"Critical bug fixes and type safety improvements for enhanced stability and performance.",features:[{category:"Bug Fixes",icon:AT,color:"blue",items:["Fixed TypeScript errors in transaction filtering logic","Resolved property access issues on union types","Removed unused imports to eliminate warnings","Fixed Reports page tab switching for Persons and Spends","Improved type safety across transaction components"]},{category:"Code Quality",icon:$1,color:"purple",items:["Enhanced type guards for transaction property access","Cleaned up import statements","Improved error handling in data filtering","Better TypeScript compliance throughout the application"]}],impact:"This patch release addresses critical TypeScript errors and improves overall application stability. The fixes ensure proper type safety when accessing transaction properties and eliminate compilation warnings, resulting in a more robust and maintainable codebase.",breaking:!1,migration:[]},{id:"v1.3.2",version:"1.3.2",name:"Mobile Logout Enhancement",date:"September 24, 2025",type:"minor",color:"red",current:!1,description:"Enhanced mobile user experience with logout functionality accessible from the mobile navigation menu.",features:[{category:"Mobile User Experience",icon:No,color:"red",items:["Added logout button to mobile More menu","Easy access to sign out functionality on mobile devices","Improved mobile navigation completeness","Consistent logout experience across all platforms","Enhanced mobile security and session management"]}],impact:"This minor update improves the mobile user experience by providing easy access to logout functionality. Users can now securely sign out of their account directly from the mobile navigation, ensuring better session management and security on mobile devices.",breaking:!1,migration:[]},{id:"v1.3",version:"1.3",name:"Person Money Tracking",date:"September 23, 2025",type:"major",color:"green",current:!1,description:"Introducing comprehensive person-to-person money tracking alongside supplier management for complete financial relationship management.",features:[{category:"Person Money Tracking",icon:qr,color:"green",items:["Complete person-to-person money tracking system",'Track money given to persons ("Gives") and received from persons ("Takes")',"Personal loan and debt management capabilities","Outstanding balance tracking for each person","Comprehensive person transaction history"]},{category:"Enhanced Reports",icon:li,color:"blue",items:["Dual reporting system for suppliers and persons","Person transaction analytics and insights","Combined financial overview across all relationships","Export functionality for person transactions","Visual charts and breakdowns for personal finances"]},{category:"Navigation Improvements",icon:No,color:"purple",items:["Added profile button to mobile more menu","Fixed person tab switching in reports","Improved navigation consistency across all sections","Enhanced mobile user experience","Better accessibility and touch targets"]}],impact:"This major update expands Shopsynk beyond supplier management to include comprehensive person-to-person financial tracking. Users can now manage both business supplier relationships and personal financial transactions in one unified platform, providing complete visibility into all financial relationships.",breaking:!1,migration:[]},{id:"v1.2",version:"1.2",name:"The Navigation Update",date:"September 5, 2025",type:"major",color:"purple",current:!1,description:"Complete mobile navigation redesign with enhanced user experience and comprehensive documentation.",features:[{category:"Mobile Navigation",icon:No,color:"purple",items:["Complete mobile navigation redesign with bottom navigation bar","Replaced hamburger menu with thumb-friendly bottom navigation","Enhanced touch targets and gesture support","Improved mobile responsiveness across all pages","Optimized PWA experience for mobile devices"]},{category:"Documentation System",icon:s4,color:"blue",items:["Card-based documentation system with dedicated pages","Enhanced mobile experience guide","Comprehensive version history tracking","Interactive documentation navigation","Improved accessibility and user experience"]},{category:"User Experience",icon:pf,color:"green",items:["Mobile-first design philosophy implementation","Improved navigation patterns for better usability","Enhanced visual feedback and transitions","Better content organization and discovery","Responsive design improvements across all components"]}],impact:"This major update transforms Shopsynk into a truly mobile-first application with modern navigation patterns and comprehensive documentation. Users can now enjoy a seamless experience across all devices with improved accessibility and usability.",breaking:!1,migration:[]},{id:"v1.0",version:"1.00",name:"Initial Release",date:"September 1, 2025",type:"major",color:"blue",current:!1,description:"First stable release of Shopsynk with core supplier management functionality.",features:[{category:"Core Features",icon:o4,color:"blue",items:["Complete supplier management system","Transaction tracking with CRUD operations","Comprehensive reporting and analytics","Data backup and export functionality","PWA support with offline capabilities"]},{category:"User Interface",icon:my,color:"green",items:["Clean and intuitive dashboard design","Responsive layout for desktop and mobile","Professional business-focused styling","Accessible form controls and navigation","Modern Material Design principles"]},{category:"Technical Foundation",icon:Jf,color:"orange",items:["React + TypeScript architecture","Supabase backend integration","Tailwind CSS styling system","Vite build tooling","Progressive Web App configuration"]}],impact:"Established the foundation for modern supplier management with essential features for tracking suppliers, managing transactions, and generating reports. Set the technical architecture for future enhancements.",breaking:!1,migration:[]},{id:"v0.9",version:"0.9",name:"Beta Release",date:"August 25, 2025",type:"minor",color:"orange",current:!1,description:"Feature-complete beta with testing and optimization focus.",features:[{category:"Testing & Quality",icon:ea,color:"green",items:["Comprehensive testing suite implementation","Performance optimization and profiling","Cross-browser compatibility testing","Security audit and vulnerability fixes","User acceptance testing completion"]},{category:"Documentation",icon:_o,color:"blue",items:["Initial documentation structure","API documentation for developers","User guide and tutorials","Installation and setup instructions","FAQ and troubleshooting guides"]}],impact:"Finalized core functionality and ensured application stability through extensive testing. Prepared the foundation for public release.",breaking:!1,migration:[]},{id:"v0.5",version:"0.5",name:"Alpha Release",date:"August 15, 2025",type:"minor",color:"yellow",current:!1,description:"Initial alpha release with basic supplier management functionality.",features:[{category:"Basic Features",icon:qr,color:"blue",items:["Basic supplier CRUD operations","Simple transaction recording","Basic reporting capabilities","User authentication system","Data persistence with Supabase"]},{category:"Development Setup",icon:$1,color:"gray",items:["Initial React application setup","TypeScript configuration","Basic styling with Tailwind CSS","Development tooling configuration","Version control and repository setup"]}],impact:"Established the basic foundation for supplier management with essential CRUD operations and user authentication.",breaking:!0,migration:["Initial setup required","Database schema creation"]}],lJ=({onVersionSelect:e,onBackToMain:t})=>l.jsxs("div",{className:"space-y-8",children:[l.jsxs("div",{className:"mb-8",children:[l.jsxs("button",{onClick:t,className:"flex items-center text-blue-600 hover:text-blue-800 mb-4",children:[l.jsx(To,{className:"h-4 w-4 mr-2"}),"Back to Documentation"]}),l.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Version History & Updates"}),l.jsx("p",{className:"text-xl text-gray-600",children:"Complete changelog and development timeline"})]}),l.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 border border-blue-200 rounded-xl p-6 mb-8",children:[l.jsxs("div",{className:"flex items-center mb-3",children:[l.jsx(i4,{className:"h-6 w-6 text-blue-600 mr-3"}),l.jsxs("span",{className:"text-2xl font-bold text-gray-900",children:["Current Version: ",Wc()]}),l.jsx("span",{className:"ml-3 bg-green-500 text-white text-sm px-3 py-1 rounded-full",children:"LATEST"})]}),l.jsxs("p",{className:"text-gray-700",children:["Welcome to Shopsynk ",Wc()," - ",h4,"! This version introduces enhanced mobile navigation, improved user experience, and comprehensive documentation."]})]}),l.jsx("div",{className:"grid gap-6",children:Ej.map(r=>{const n=i=>({purple:"bg-purple-500",blue:"bg-blue-500",orange:"bg-orange-500",yellow:"bg-yellow-500",green:"bg-green-500"})[i]||"bg-gray-500",a=i=>({purple:"border-purple-200 hover:border-purple-300",blue:"border-blue-200 hover:border-blue-300",orange:"border-orange-200 hover:border-orange-300",yellow:"border-yellow-200 hover:border-yellow-300",green:"border-green-200 hover:border-green-300"})[i]||"border-gray-200 hover:border-gray-300";return l.jsxs("div",{onClick:()=>e(r.id),className:`
                bg-white border-2 ${a(r.color)} rounded-xl p-6 
                cursor-pointer transition-all duration-200 hover:shadow-lg transform hover:scale-105
              `,children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsxs("div",{className:`${n(r.color)} text-white text-sm font-semibold px-3 py-1 rounded-full mr-3`,children:["v",r.version]}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:r.name}),l.jsx("p",{className:"text-sm text-gray-500",children:r.date})]})]}),l.jsxs("div",{className:"flex items-center space-x-2",children:[r.current&&l.jsx("span",{className:"bg-green-500 text-white text-xs px-2 py-1 rounded-full",children:"CURRENT"}),l.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${r.type==="major"?"bg-red-100 text-red-700":"bg-blue-100 text-blue-700"}`,children:r.type.toUpperCase()}),r.breaking&&l.jsx("span",{className:"bg-orange-100 text-orange-700 text-xs px-2 py-1 rounded-full",children:"BREAKING"})]})]}),l.jsx("p",{className:"text-gray-600 mb-4",children:r.description}),l.jsxs("div",{className:"space-y-3",children:[r.features.slice(0,2).map((i,s)=>l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx(i.icon,{className:"h-5 w-5 text-gray-500 mt-0.5 flex-shrink-0"}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:i.category}),l.jsxs("p",{className:"text-xs text-gray-600",children:[i.items.length," updates"]})]})]},s)),r.features.length>2&&l.jsxs("div",{className:"text-sm text-blue-600 font-medium",children:["+",r.features.length-2," more categories"]})]}),l.jsxs("div",{className:"mt-4 flex items-center text-blue-600 font-semibold",children:[l.jsx("span",{children:"View Details"}),l.jsx(Io,{className:"h-4 w-4 ml-2"})]})]},r.id)})})]}),cJ=({versionId:e,onBack:t})=>{const r=Ej.find(a=>a.id===e);if(!r)return l.jsxs("div",{className:"text-center py-12",children:[l.jsxs("button",{onClick:t,className:"flex items-center text-blue-600 hover:text-blue-800 mb-4",children:[l.jsx(To,{className:"h-4 w-4 mr-2"}),"Back to Version History"]}),l.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Version Not Found"}),l.jsx("p",{className:"text-gray-600",children:"The requested version could not be found."})]});const n=a=>({purple:"bg-purple-500",blue:"bg-blue-500",orange:"bg-orange-500",yellow:"bg-yellow-500",green:"bg-green-500"})[a]||"bg-gray-500";return l.jsxs("div",{className:"space-y-8",children:[l.jsxs("div",{className:"mb-8",children:[l.jsxs("button",{onClick:t,className:"flex items-center text-blue-600 hover:text-blue-800 mb-4",children:[l.jsx(To,{className:"h-4 w-4 mr-2"}),"Back to Version History"]}),l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsxs("div",{className:`${n(r.color)} text-white text-lg font-bold px-4 py-2 rounded-full mr-4`,children:["v",r.version]}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:r.name}),l.jsx("p",{className:"text-lg text-gray-600",children:r.date})]}),r.current&&l.jsx("span",{className:"ml-4 bg-green-500 text-white text-sm px-3 py-1 rounded-full",children:"CURRENT"})]}),l.jsx("p",{className:"text-xl text-gray-700 mb-6",children:r.description}),l.jsxs("div",{className:"flex items-center space-x-4",children:[l.jsxs("span",{className:`text-sm px-3 py-1 rounded-full ${r.type==="major"?"bg-red-100 text-red-700":"bg-blue-100 text-blue-700"}`,children:[r.type.toUpperCase()," RELEASE"]}),r.breaking&&l.jsx("span",{className:"bg-orange-100 text-orange-700 text-sm px-3 py-1 rounded-full",children:"BREAKING CHANGES"})]})]}),l.jsxs("div",{className:"space-y-6",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"What's New in This Version"}),r.features.map((a,i)=>l.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx(a.icon,{className:"h-8 w-8 text-blue-600 mr-3"}),l.jsx("h3",{className:"text-xl font-bold text-gray-900",children:a.category})]}),l.jsx("ul",{className:"space-y-2",children:a.items.map((s,o)=>l.jsxs("li",{className:"flex items-start",children:[l.jsx(ea,{className:"h-5 w-5 text-green-500 mr-3 mt-0.5 flex-shrink-0"}),l.jsx("span",{className:"text-gray-700",children:s})]},o))})]},i))]}),l.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-xl p-6",children:[l.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-3 flex items-center",children:[l.jsx(pf,{className:"h-6 w-6 text-blue-600 mr-3"}),"Impact & Benefits"]}),l.jsx("p",{className:"text-gray-700",children:r.impact})]}),r.breaking&&r.migration.length>0&&l.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-6",children:[l.jsxs("h3",{className:"text-xl font-bold text-orange-900 mb-3 flex items-center",children:[l.jsx(is,{className:"h-6 w-6 text-orange-600 mr-3"}),"Migration Guide"]}),l.jsx("ul",{className:"space-y-2",children:r.migration.map((a,i)=>l.jsxs("li",{className:"flex items-start",children:[l.jsx(Io,{className:"h-5 w-5 text-orange-600 mr-3 mt-0.5 flex-shrink-0"}),l.jsx("span",{className:"text-orange-800",children:a})]},i))})]})]})},uJ=()=>{const[e,t]=M.useState(null),r=[{id:"overview",title:"Getting Started",description:"Learn the basics and get started with Shopsynk",icon:_l,color:"blue",topics:["Introduction","Key Features","System Requirements","Quick Setup"]},{id:"user-guide",title:"User Guide",description:"Complete step-by-step instructions for all features",icon:_o,color:"green",topics:["Dashboard","Suppliers","Transactions","Reports","Data Management"]},{id:"mobile-guide",title:"Mobile Experience",description:"Using Shopsynk on mobile devices and PWA features",icon:No,color:"purple",topics:["Mobile Navigation","PWA Installation","Offline Features","Touch Gestures"]},{id:"rules",title:"Policies & Rules",description:"Terms of service, privacy policy, and usage guidelines",icon:Yg,color:"red",topics:["Privacy Policy","Terms of Service","Usage Guidelines","Data Security"]},{id:"contribute",title:"Developer Guide",description:"Contribute to the project and technical documentation",icon:$1,color:"indigo",topics:["Setup Environment","Code Standards","Pull Requests","API Reference"]},{id:"updates",title:"Version History",description:"Complete changelog and update history",icon:Dd,color:"orange",topics:["Recent Updates","Version Timeline","Breaking Changes","Migration Guide"]},{id:"about",title:"About & Support",description:"Learn about the developer and get support",icon:qr,color:"teal",topics:["Developer Info","Contact Support","Community","Feedback"]}],n=(i,s="light")=>{var c;const o={blue:{light:"bg-blue-50 text-blue-700",dark:"bg-blue-600 text-white",border:"border-blue-200",hover:"hover:bg-blue-100 hover:border-blue-300"},green:{light:"bg-green-50 text-green-700",dark:"bg-green-600 text-white",border:"border-green-200",hover:"hover:bg-green-100 hover:border-green-300"},purple:{light:"bg-purple-50 text-purple-700",dark:"bg-purple-600 text-white",border:"border-purple-200",hover:"hover:bg-purple-100 hover:border-purple-300"},red:{light:"bg-red-50 text-red-700",dark:"bg-red-600 text-white",border:"border-red-200",hover:"hover:bg-red-100 hover:border-red-300"},indigo:{light:"bg-indigo-50 text-indigo-700",dark:"bg-indigo-600 text-white",border:"border-indigo-200",hover:"hover:bg-indigo-100 hover:border-indigo-300"},orange:{light:"bg-orange-50 text-orange-700",dark:"bg-orange-600 text-white",border:"border-orange-200",hover:"hover:bg-orange-100 hover:border-orange-300"},teal:{light:"bg-teal-50 text-teal-700",dark:"bg-teal-600 text-white",border:"border-teal-200",hover:"hover:bg-teal-100 hover:border-teal-300"}};return((c=o[i])==null?void 0:c[s])||o.blue[s]},a=i=>{switch(i){case"overview":return l.jsxs("div",{className:"space-y-8",children:[l.jsxs("div",{className:"mb-8",children:[l.jsxs("button",{onClick:()=>t(null),className:"flex items-center text-blue-600 hover:text-blue-800 mb-4",children:[l.jsx(To,{className:"h-4 w-4 mr-2"}),"Back to Documentation"]}),l.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Getting Started with Shopsynk"}),l.jsx("p",{className:"text-xl text-gray-600",children:"Welcome to Shopsynk - your comprehensive supplier management solution"})]}),l.jsxs("div",{className:"grid gap-6",children:[l.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6",children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx(pf,{className:"h-8 w-8 text-blue-600 mr-3"}),l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"What is Shopsynk?"})]}),l.jsx("p",{className:"text-gray-700 mb-4",children:"Shopsynk is a modern, comprehensive supplier dues management system designed to help businesses efficiently track, manage, and maintain their supplier relationships and financial obligations. Built with cutting-edge web technologies, it offers a seamless experience across all devices."}),l.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"bg-white/50 rounded-lg p-4",children:[l.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"üéØ Purpose"}),l.jsx("p",{className:"text-sm text-blue-800",children:"Streamline supplier relationship management and financial tracking"})]}),l.jsxs("div",{className:"bg-white/50 rounded-lg p-4",children:[l.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"‚ö° Performance"}),l.jsx("p",{className:"text-sm text-blue-800",children:"Fast, responsive PWA with offline capabilities"})]})]})]}),l.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[l.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-4 flex items-center",children:[l.jsx(bc,{className:"h-6 w-6 text-yellow-500 mr-3"}),"Key Features"]}),l.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:[{icon:o4,title:"Supplier Management",desc:"Complete supplier profiles and contact management"},{icon:Fd,title:"Transaction Tracking",desc:"Record and monitor all financial transactions"},{icon:li,title:"Advanced Reports",desc:"Comprehensive analytics and reporting tools"},{icon:Nl,title:"Data Backup",desc:"Secure cloud backup and data export options"},{icon:No,title:"Mobile PWA",desc:"Full mobile experience with app-like features"},{icon:Jf,title:"Customizable",desc:"Flexible settings and personalization options"}].map((s,o)=>l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[l.jsx(s.icon,{className:"h-8 w-8 text-blue-600 mb-3"}),l.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:s.title}),l.jsx("p",{className:"text-sm text-gray-600",children:s.desc})]},o))})]}),l.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-6",children:[l.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-4 flex items-center",children:[l.jsx(ea,{className:"h-6 w-6 text-green-600 mr-3"}),"System Requirements"]}),l.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-green-900 mb-3",children:"Minimum Requirements"}),l.jsxs("ul",{className:"space-y-2 text-green-800",children:[l.jsxs("li",{className:"flex items-center",children:[l.jsx(ea,{className:"h-4 w-4 mr-2"}),"Modern web browser (Chrome 90+, Firefox 88+, Safari 14+)"]}),l.jsxs("li",{className:"flex items-center",children:[l.jsx(ea,{className:"h-4 w-4 mr-2"}),"Internet connection for sync and backup"]}),l.jsxs("li",{className:"flex items-center",children:[l.jsx(ea,{className:"h-4 w-4 mr-2"}),"JavaScript enabled"]}),l.jsxs("li",{className:"flex items-center",children:[l.jsx(ea,{className:"h-4 w-4 mr-2"}),"Local storage support (5MB+)"]})]})]}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-green-900 mb-3",children:"Recommended Setup"}),l.jsxs("ul",{className:"space-y-2 text-green-800",children:[l.jsxs("li",{className:"flex items-center",children:[l.jsx(bc,{className:"h-4 w-4 mr-2"}),"Desktop/laptop for data entry"]}),l.jsxs("li",{className:"flex items-center",children:[l.jsx(bc,{className:"h-4 w-4 mr-2"}),"Mobile device for PWA installation"]}),l.jsxs("li",{className:"flex items-center",children:[l.jsx(bc,{className:"h-4 w-4 mr-2"}),"Stable internet for real-time sync"]}),l.jsxs("li",{className:"flex items-center",children:[l.jsx(bc,{className:"h-4 w-4 mr-2"}),"Regular backup schedule"]})]})]})]})]}),l.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-xl p-6",children:[l.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-4 flex items-center",children:[l.jsx(ST,{className:"h-6 w-6 text-purple-600 mr-3"}),"Quick Setup Guide"]}),l.jsx("div",{className:"space-y-4",children:[{step:1,title:"Create Account",desc:"Sign up with your email and create a secure password"},{step:2,title:"Complete Profile",desc:"Fill in your business information and preferences"},{step:3,title:"Add First Supplier",desc:"Create your first supplier profile with contact details"},{step:4,title:"Record Transaction",desc:"Add your first transaction to get familiar with the system"},{step:5,title:"Explore Features",desc:"Browse reports, settings, and advanced features"}].map(s=>l.jsxs("div",{className:"flex items-start space-x-4 bg-white rounded-lg p-4",children:[l.jsx("div",{className:"bg-purple-600 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm font-bold",children:s.step}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-gray-900",children:s.title}),l.jsx("p",{className:"text-gray-600 text-sm",children:s.desc})]})]},s.step))})]})]})]});case"mobile-guide":return l.jsxs("div",{className:"space-y-8",children:[l.jsxs("div",{className:"mb-8",children:[l.jsxs("button",{onClick:()=>t(null),className:"flex items-center text-blue-600 hover:text-blue-800 mb-4",children:[l.jsx(To,{className:"h-4 w-4 mr-2"}),"Back to Documentation"]}),l.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Mobile Experience Guide"}),l.jsx("p",{className:"text-xl text-gray-600",children:"Get the most out of Shopsynk on mobile devices"})]}),l.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 border border-purple-200 rounded-xl p-6 mb-6",children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx(No,{className:"h-8 w-8 text-purple-600 mr-3"}),l.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Person Money Tracking v1.3"}),l.jsx("span",{className:"ml-3 bg-purple-500 text-white text-xs px-2 py-1 rounded-full",children:"NEW"})]}),l.jsx("p",{className:"text-gray-700 mb-4",children:'Version 1.3 introduces comprehensive person-to-person money tracking alongside supplier management. Track money given to persons ("Gives") and received from persons ("Takes") with complete transaction history, outstanding balance management, and integrated reporting. replacing the traditional hamburger menu with a modern bottom navigation bar for easier thumb-friendly access.'}),l.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"bg-white/50 rounded-lg p-4",children:[l.jsx("h3",{className:"font-semibold text-purple-900 mb-2",children:"üéØ Bottom Navigation"}),l.jsx("p",{className:"text-sm text-purple-800",children:"Quick access to Dashboard, Suppliers, Transactions, and Reports"})]}),l.jsxs("div",{className:"bg-white/50 rounded-lg p-4",children:[l.jsx("h3",{className:"font-semibold text-purple-900 mb-2",children:"üì± Touch Optimized"}),l.jsx("p",{className:"text-sm text-purple-800",children:"Large touch targets and gesture-friendly interface design"})]})]})]}),l.jsxs("div",{className:"grid gap-6",children:[l.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6",children:[l.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-4 flex items-center",children:[l.jsx(zc,{className:"h-6 w-6 text-blue-600 mr-3"}),"PWA Installation"]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"bg-white rounded-lg p-4",children:[l.jsx("h3",{className:"font-semibold mb-2",children:"üì± iOS Installation"}),l.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-sm text-gray-700",children:[l.jsx("li",{children:"Open Shopsynk in Safari browser"}),l.jsx("li",{children:"Tap the Share button (square with arrow)"}),l.jsx("li",{children:'Scroll down and tap "Add to Home Screen"'}),l.jsx("li",{children:'Customize the name and tap "Add"'})]})]}),l.jsxs("div",{className:"bg-white rounded-lg p-4",children:[l.jsx("h3",{className:"font-semibold mb-2",children:"ü§ñ Android Installation"}),l.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-sm text-gray-700",children:[l.jsx("li",{children:"Open Shopsynk in Chrome browser"}),l.jsx("li",{children:"Tap the menu (three dots) in the top right"}),l.jsx("li",{children:'Select "Add to Home screen"'}),l.jsx("li",{children:"Confirm the installation"})]})]})]})]}),l.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-6",children:[l.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-4 flex items-center",children:[l.jsx(_T,{className:"h-6 w-6 text-green-600 mr-3"}),"Offline Features"]}),l.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-green-900 mb-3",children:"Available Offline"}),l.jsxs("ul",{className:"space-y-2 text-green-800",children:[l.jsxs("li",{className:"flex items-center",children:[l.jsx(ea,{className:"h-4 w-4 mr-2"}),"View existing suppliers and transactions"]}),l.jsxs("li",{className:"flex items-center",children:[l.jsx(ea,{className:"h-4 w-4 mr-2"}),"Access cached reports and data"]}),l.jsxs("li",{className:"flex items-center",children:[l.jsx(ea,{className:"h-4 w-4 mr-2"}),"Browse documentation"]})]})]}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-green-900 mb-3",children:"Requires Internet"}),l.jsxs("ul",{className:"space-y-2 text-green-800",children:[l.jsxs("li",{className:"flex items-center",children:[l.jsx(is,{className:"h-4 w-4 mr-2"}),"Adding new data"]}),l.jsxs("li",{className:"flex items-center",children:[l.jsx(is,{className:"h-4 w-4 mr-2"}),"Real-time sync"]}),l.jsxs("li",{className:"flex items-center",children:[l.jsx(is,{className:"h-4 w-4 mr-2"}),"Data backup"]})]})]})]})]}),l.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-6",children:[l.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-4 flex items-center",children:[l.jsx(pf,{className:"h-6 w-6 text-orange-600 mr-3"}),"Mobile Best Practices"]}),l.jsx("div",{className:"space-y-4",children:[{title:"Portrait Mode",tip:"Use portrait orientation for optimal experience"},{title:"Touch Gestures",tip:"Swipe left/right to navigate between sections"},{title:"Quick Actions",tip:"Long press on items for context menus"},{title:"Voice Input",tip:"Use voice input for faster data entry"},{title:"Auto-Save",tip:"Data is automatically saved as you type"}].map((s,o)=>l.jsxs("div",{className:"bg-white rounded-lg p-4 flex items-start space-x-3",children:[l.jsx(NT,{className:"h-5 w-5 text-orange-600 mt-0.5 flex-shrink-0"}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-orange-900",children:s.title}),l.jsx("p",{className:"text-sm text-orange-800",children:s.tip})]})]},o))})]})]})]});case"updates":return l.jsx(lJ,{onVersionSelect:s=>t(`version-detail-${s}`),onBackToMain:()=>t(null)});default:if(e&&e.startsWith("version-detail-")){const s=e.split("-")[2];return l.jsx(cJ,{versionId:s,onBack:()=>t("updates")})}return l.jsxs("div",{className:"text-center py-12",children:[l.jsx("div",{className:"mb-8",children:l.jsxs("button",{onClick:()=>t(null),className:"flex items-center text-blue-600 hover:text-blue-800 mb-4",children:[l.jsx(To,{className:"h-4 w-4 mr-2"}),"Back to Documentation"]})}),l.jsx(_l,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),l.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Coming Soon"}),l.jsx("p",{className:"text-gray-600",children:"This section is under development."})]})}};return e?l.jsx("div",{className:"min-h-screen bg-gray-50 pb-20 md:pb-8",children:l.jsx("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:a(e)})}):l.jsx("div",{className:"min-h-screen bg-gray-50 pb-20 md:pb-8",children:l.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[l.jsxs("div",{className:"text-center mb-12",children:[l.jsxs("div",{className:"flex items-center justify-center mb-6",children:[l.jsx(_l,{className:"h-12 w-12 text-blue-600 mr-4"}),l.jsxs("div",{children:[l.jsx("h1",{className:"text-4xl font-bold text-gray-900",children:"Shopsynk Documentation"}),l.jsxs("p",{className:"text-xl text-gray-600 mt-2",children:["Complete guide for Shopsynk ",Wc()," - ",h4]})]})]}),l.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-xl p-6 mb-8",children:[l.jsxs("div",{className:"flex items-center justify-center mb-3",children:[l.jsx(i4,{className:"h-6 w-6 text-blue-600 mr-3"}),l.jsxs("span",{className:"text-2xl font-bold text-gray-900",children:["Version ",Wc()]}),l.jsx("span",{className:"ml-3 bg-green-500 text-white text-sm px-3 py-1 rounded-full",children:"LATEST"})]}),l.jsx("p",{className:"text-gray-700 max-w-3xl mx-auto",children:"Welcome to the comprehensive documentation for Shopsynk, your modern supplier management system. This version introduces enhanced mobile navigation, improved user experience, and complete documentation coverage."})]})]}),l.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12",children:r.map(i=>{const s=i.icon;return l.jsxs("div",{onClick:()=>t(i.id),className:`
                    bg-white border-2 ${n(i.color,"border")} rounded-xl p-6 
                    cursor-pointer transition-all duration-200 transform hover:scale-105 
                    hover:shadow-lg ${n(i.color,"hover")}
                  `,children:[l.jsxs("div",{className:"flex items-center mb-4",children:[l.jsx("div",{className:`${n(i.color,"dark")} rounded-lg p-3 mr-4`,children:l.jsx(s,{className:"h-6 w-6"})}),l.jsx("h3",{className:"text-xl font-bold text-gray-900",children:i.title})]}),l.jsx("p",{className:"text-gray-600 mb-4",children:i.description}),l.jsx("div",{className:"space-y-2",children:i.topics.map((o,c)=>l.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[l.jsx("div",{className:"w-1.5 h-1.5 bg-gray-400 rounded-full mr-3"}),o]},c))}),l.jsxs("div",{className:"mt-4 flex items-center text-blue-600 font-semibold",children:[l.jsx("span",{children:"Explore"}),l.jsx(Io,{className:"h-4 w-4 ml-2"})]})]},i.id)})}),l.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-8",children:[l.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6 text-center",children:"Documentation Overview"}),l.jsxs("div",{className:"grid md:grid-cols-4 gap-6",children:[l.jsxs("div",{className:"text-center",children:[l.jsx(s4,{className:"h-8 w-8 text-blue-600 mx-auto mb-2"}),l.jsx("div",{className:"text-2xl font-bold text-gray-900",children:"7"}),l.jsx("div",{className:"text-sm text-gray-600",children:"Documentation Sections"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx(pf,{className:"h-8 w-8 text-green-600 mx-auto mb-2"}),l.jsx("div",{className:"text-2xl font-bold text-gray-900",children:"25+"}),l.jsx("div",{className:"text-sm text-gray-600",children:"Topics Covered"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx(No,{className:"h-8 w-8 text-purple-600 mx-auto mb-2"}),l.jsx("div",{className:"text-2xl font-bold text-gray-900",children:"NEW"}),l.jsx("div",{className:"text-sm text-gray-600",children:"Mobile Logout"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx(Dd,{className:"h-8 w-8 text-orange-600 mx-auto mb-2"}),l.jsx("div",{className:"text-2xl font-bold text-gray-900",children:"v1.3.2"}),l.jsx("div",{className:"text-sm text-gray-600",children:"Current Version"})]})]})]})]})})},fJ=()=>{const[e,t]=M.useState({total:0,read:0,unread:0,readPercentage:0}),[r,n]=M.useState(!1),[a,i]=M.useState(null);M.useEffect(()=>{s();const d=localStorage.getItem("last_notification_cleanup");d&&i(d)},[]);const s=async()=>{const d=await kc.getNotificationStats();t(d)},o=async()=>{n(!0);try{await kc.performFullCleanup();const d=new Date().toLocaleString();localStorage.setItem("last_notification_cleanup",d),i(d),setTimeout(s,1e3),alert("‚úÖ Database cleanup completed successfully!")}catch(d){console.error("Cleanup error:",d),alert("‚ùå Cleanup failed. Please try again.")}finally{n(!1)}},c=async()=>{n(!0);try{await kc.cleanupReadNotifications(),setTimeout(s,1e3),alert("‚úÖ Quick cleanup completed!")}catch(d){console.error("Quick cleanup error:",d),alert("‚ùå Quick cleanup failed.")}finally{n(!1)}},f=e.total>500?{level:"high",message:"High storage usage detected. Recommend immediate cleanup.",color:"text-red-600 bg-red-50 border-red-200"}:e.total>200?{level:"medium",message:"Moderate storage usage. Consider cleanup.",color:"text-yellow-600 bg-yellow-50 border-yellow-200"}:{level:"low",message:"Storage usage is optimal.",color:"text-green-600 bg-green-50 border-green-200"};return l.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:l.jsx(Nl,{className:"w-5 h-5 text-blue-600"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Notification Storage"}),l.jsx("p",{className:"text-sm text-gray-500",children:"Manage database efficiency"})]})]}),l.jsx("button",{onClick:s,className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors",title:"Refresh stats",children:l.jsx(ts,{className:"w-4 h-4"})})]}),l.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[l.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx(li,{className:"w-4 h-4 text-gray-500"}),l.jsx("span",{className:"text-sm text-gray-500",children:"Total"})]}),l.jsx("div",{className:"text-2xl font-bold text-gray-900 mt-1",children:e.total})]}),l.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),l.jsx("span",{className:"text-sm text-blue-600",children:"Unread"})]}),l.jsx("div",{className:"text-2xl font-bold text-blue-700 mt-1",children:e.unread})]}),l.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),l.jsx("span",{className:"text-sm text-green-600",children:"Read"})]}),l.jsx("div",{className:"text-2xl font-bold text-green-700 mt-1",children:e.read})]}),l.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),l.jsx("span",{className:"text-sm text-purple-600",children:"Read %"})]}),l.jsxs("div",{className:"text-2xl font-bold text-purple-700 mt-1",children:[e.readPercentage,"%"]})]})]}),l.jsxs("div",{className:`rounded-lg border p-4 mb-6 ${f.color}`,children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-2 h-2 rounded-full bg-current"}),l.jsx("span",{className:"font-medium",children:"Storage Status"})]}),l.jsx("p",{className:"text-sm mt-1",children:f.message})]}),l.jsxs("div",{className:"space-y-3",children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium text-gray-900",children:"Full Cleanup"}),l.jsx("p",{className:"text-sm text-gray-500",children:"Remove old notifications, keep latest 100 per user"})]}),l.jsxs("button",{onClick:o,disabled:r,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2 transition-colors",children:[l.jsx(Do,{className:"w-4 h-4"}),l.jsx("span",{children:r?"Cleaning...":"Full Cleanup"})]})]}),l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium text-gray-900",children:"Quick Cleanup"}),l.jsx("p",{className:"text-sm text-gray-500",children:"Remove only read notifications older than 3 days"})]}),l.jsxs("button",{onClick:c,disabled:r,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2 transition-colors",children:[l.jsx(Dd,{className:"w-4 h-4"}),l.jsx("span",{children:r?"Cleaning...":"Quick Cleanup"})]})]})]}),a&&l.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:l.jsxs("p",{className:"text-xs text-gray-500",children:["Last cleanup: ",a]})}),l.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[l.jsxs("div",{className:"flex items-center space-x-2",children:[l.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),l.jsx("span",{className:"text-sm text-gray-600",children:"Auto-cleanup active"})]}),l.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["‚Ä¢ Read notifications auto-deleted after 5 seconds",l.jsx("br",{}),"‚Ä¢ User notifications limited to 50 per user",l.jsx("br",{}),"‚Ä¢ Cleanup runs every 30 minutes"]})]})]})},dJ=({className:e=""})=>{const{user:t}=aa(),[r,n]=M.useState({supported:!1,permission:"default",subscribed:!1}),[a,i]=M.useState(!1);M.useEffect(()=>{s()},[]);const s=async()=>{const u=await vo.getSubscriptionStatus();n(u)},o=async()=>{if(t!=null&&t.id){i(!0);try{if(!await vo.initialize())throw new Error("Push notifications not supported");if(!await vo.requestPermission())throw new Error("Permission denied");if(!await vo.subscribe(t.id))throw new Error("Failed to subscribe");await s()}catch(u){console.error("Failed to enable push notifications:",u),alert("Failed to enable push notifications. Please try again.")}i(!1)}},c=async()=>{if(t!=null&&t.id){i(!0);try{if(!await vo.unsubscribe(t.id))throw new Error("Failed to unsubscribe");await s()}catch(u){console.error("Failed to disable push notifications:",u),alert("Failed to disable push notifications. Please try again.")}i(!1)}};return r.supported?l.jsxs("div",{className:`bg-white border border-gray-200 rounded-lg p-4 ${e}`,children:[l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"flex-shrink-0",children:r.subscribed?l.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:l.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{d:"M10 2a6 6 0 00-6 6v3.586l-.707.707A1 1 0 004 14h12a1 1 0 00.707-1.707L16 11.586V8a6 6 0 00-6-6zM10 18a3 3 0 01-3-3h6a3 3 0 01-3 3z"})})}):l.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center",children:l.jsxs("svg",{className:"w-5 h-5 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:[l.jsx("path",{fillRule:"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM15.657 6.343a1 1 0 011.414 0A9.972 9.972 0 0119 12a9.972 9.972 0 01-1.929 5.657 1 1 0 11-1.414-1.414A7.971 7.971 0 0017 12a7.971 7.971 0 00-1.343-4.243 1 1 0 010-1.414z",clipRule:"evenodd"}),l.jsx("path",{fillRule:"evenodd",d:"M13.828 8.172a1 1 0 011.414 0A5.983 5.983 0 0117 12a5.983 5.983 0 01-1.758 3.828 1 1 0 11-1.414-1.414A3.987 3.987 0 0015 12a3.987 3.987 0 00-1.172-2.828 1 1 0 010-1.414z",clipRule:"evenodd"})]})})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Push Notifications"}),l.jsx("p",{className:"text-sm text-gray-600",children:r.subscribed?"Get notified even when the app is closed":"Enable to receive notifications when app is closed"}),l.jsxs("div",{className:"mt-1 flex items-center space-x-4 text-xs text-gray-500",children:[l.jsxs("span",{children:["Permission: ",r.permission]}),l.jsxs("span",{children:["Status: ",r.subscribed?"Active":"Inactive"]})]})]})]}),l.jsx("div",{className:"flex-shrink-0",children:r.permission==="denied"?l.jsxs("div",{className:"text-xs text-red-600 text-right",children:[l.jsx("p",{children:"Permission denied."}),l.jsx("p",{children:"Please enable in browser settings."})]}):l.jsxs("button",{onClick:r.subscribed?c:o,disabled:a,className:`inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 ${r.subscribed?"text-red-700 bg-red-100 hover:bg-red-200 focus:ring-red-500":"text-white bg-amber-600 hover:bg-amber-700 focus:ring-amber-500"} disabled:opacity-50 disabled:cursor-not-allowed transition-colors`,children:[a?l.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-current",fill:"none",viewBox:"0 0 24 24",children:[l.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),l.jsx("path",{className:"opacity-75",fill:"currentColor",d:"m4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):null,r.subscribed?"Disable":"Enable"]})})]}),r.subscribed&&l.jsx("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded-md",children:l.jsxs("div",{className:"flex",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:"h-5 w-5 text-green-400",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),l.jsx("div",{className:"ml-3",children:l.jsx("p",{className:"text-sm text-green-800",children:"‚ú® You'll receive notifications for new transactions, payments, and supplier updates even when the app is closed!"})})]})})]}):l.jsx("div",{className:`bg-gray-50 border border-gray-200 rounded-lg p-4 ${e}`,children:l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:l.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),l.jsxs("div",{className:"ml-3",children:[l.jsx("h3",{className:"text-sm font-medium text-gray-800",children:"Push notifications not supported"}),l.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Your browser doesn't support push notifications."})]})]})})},hJ=()=>{const{user:e}=aa(),[t,r]=M.useState({suppliersCount:0,transactionsCount:0,totalOutstanding:0,lastLogin:""}),[n,a]=M.useState(!0),[i,s]=M.useState({isConnected:!1,userEmail:"",lastBackup:"",autoBackupEnabled:!0}),[o,c]=M.useState([]),[u,f]=M.useState(!1),[d,p]=M.useState(!1),[h,x]=M.useState(""),g=wl.getInstance(),y=bl.getInstance(),b=Ps.getInstance(),[E,A]=M.useState([]),[C,N]=M.useState([]),[F,O]=M.useState(!1),[I,P]=M.useState(null),[H,T]=M.useState({owner_name:"",role:"Owner"}),[j,z]=M.useState("");M.useEffect(()=>{me(),he(),be(),K()},[e]);const K=async()=>{var ue;if(e)try{await b.ensurePrimaryOwner(e.id,e.email,(ue=e.user_metadata)==null?void 0:ue.full_name);const fe=await b.getBusinessOwners(e.id);A(fe);const Ue=await b.getOwnerStats(e.id);N(Ue)}catch(fe){console.error("Error loading business owners:",fe),z("Error loading business owners.")}},he=async()=>{if(e)try{const{data:ue,error:fe}=await Ke.from("user_settings").select("*").eq("user_id",e.id).single();if(fe&&fe.code!=="PGRST116")throw fe;ue&&s({isConnected:ue.google_drive_connected||!1,userEmail:ue.google_drive_email||"",lastBackup:ue.last_backup_date||"",autoBackupEnabled:ue.auto_backup_enabled||!0})}catch(ue){console.error("Error loading Google Drive settings:",ue)}},be=async()=>{if(e)try{const ue=await g.getBackupHistory(e.id);c(ue)}catch(ue){console.error("Error loading backup history:",ue)}},we=async()=>{f(!0),x("");try{const ue=await y.authenticate();ue.success?(await Ke.from("user_settings").upsert({user_id:e==null?void 0:e.id,google_drive_connected:!0,google_drive_email:ue.userEmail,updated_at:new Date().toISOString()}),s(fe=>({...fe,isConnected:!0,userEmail:ue.userEmail})),x("Successfully connected to Google Drive!"),await g.setupAutoBackup(e.id,e.email)):x("Failed to connect to Google Drive. Please try again.")}catch(ue){console.error("Google Drive connection error:",ue),x("An error occurred while connecting to Google Drive.")}finally{f(!1)}},Q=async()=>{try{y.disconnect(),await Ke.from("user_settings").upsert({user_id:e==null?void 0:e.id,google_drive_connected:!1,google_drive_email:null,updated_at:new Date().toISOString()}),s(ue=>({...ue,isConnected:!1,userEmail:""})),x("Disconnected from Google Drive.")}catch(ue){console.error("Error disconnecting Google Drive:",ue),x("Error disconnecting from Google Drive.")}},le=async()=>{if(e){p(!0),x("");try{const ue=await g.createBackup(e.id,e.email);x(ue.message),ue.success&&(await be(),await he())}catch(ue){console.error("Manual backup error:",ue),x("An error occurred during backup.")}finally{p(!1)}}},ke=async()=>{if(e)try{const ue=await g.exportUserData(e.id,e.email);ue?(g.downloadBackupFile(ue),x("Backup file downloaded successfully!")):x("Failed to create backup file.")}catch(ue){console.error("Download backup error:",ue),x("Error creating backup file.")}},ve=async()=>{if(e)try{const ue=!i.autoBackupEnabled;await Ke.from("user_settings").upsert({user_id:e.id,auto_backup_enabled:ue,updated_at:new Date().toISOString()}),s(fe=>({...fe,autoBackupEnabled:ue})),x(`Auto backup ${ue?"enabled":"disabled"}.`)}catch(ue){console.error("Error toggling auto backup:",ue),x("Error updating auto backup setting.")}},S=async ue=>{if(ue.preventDefault(),!!e)try{const fe=await b.createBusinessOwner(e.id,H);fe.success?(z("Owner added successfully!"),await K(),X()):z(`Error: ${fe.error}`)}catch(fe){console.error("Error adding owner:",fe),z("An error occurred while adding the owner.")}},L=ue=>{P(ue),T({owner_name:ue.owner_name,role:ue.role}),O(!0)},D=async ue=>{if(ue.preventDefault(),!!I)try{const fe=await b.updateBusinessOwner(I.id,H);fe.success?(z("Owner updated successfully!"),await K(),X()):z(`Error: ${fe.error}`)}catch(fe){console.error("Error updating owner:",fe),z("An error occurred while updating the owner.")}},R=async ue=>{if(confirm("Are you sure you want to remove this owner? This action cannot be undone."))try{const fe=await b.deactivateBusinessOwner(ue);fe.success?(z("Owner removed successfully."),await K()):z(`Error: ${fe.error}`)}catch(fe){console.error("Error removing owner:",fe),z("An error occurred while removing the owner.")}},X=()=>{T({owner_name:"",role:"Owner"}),P(null),O(!1)},de=ue=>C.find(fe=>fe.owner_id===ue)||{total_transactions:0,total_purchases:0,total_payments:0,total_purchase_amount:0,total_payment_amount:0},me=async()=>{if(e)try{const{count:ue}=await Ke.from("suppliers").select("*",{count:"exact",head:!0}).eq("user_id",e.id),{count:fe}=await Ke.from("transactions").select("*",{count:"exact",head:!0}).eq("user_id",e.id),{data:Ue}=await Ke.from("transactions").select("type, amount, is_paid").eq("user_id",e.id);let xe=0;Ue==null||Ue.forEach(te=>{te.type==="new_purchase"&&!te.is_paid?xe+=parseFloat(te.amount.toString()):(te.type==="pay_due"||te.type==="settle_bill")&&(xe-=parseFloat(te.amount.toString()))}),r({suppliersCount:ue||0,transactionsCount:fe||0,totalOutstanding:Math.max(0,xe),lastLogin:e.last_sign_in_at||e.created_at||""})}catch(ue){console.error("Error fetching user stats:",ue)}finally{a(!1)}},Y=ue=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(ue),oe=ue=>new Date(ue).toLocaleDateString("en-IN",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return n?l.jsx("div",{className:"flex items-center justify-center h-64",children:l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):l.jsxs("div",{className:"space-y-6",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Profile"}),l.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your account settings and view activity"})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Account Information"}),l.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:l.jsx(qr,{className:"h-6 w-6 text-blue-600"})})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[l.jsx(Cl,{className:"h-5 w-5 text-gray-400"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Email Address"}),l.jsx("p",{className:"font-medium text-gray-900",children:e==null?void 0:e.email})]})]}),l.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[l.jsx(Yg,{className:"h-5 w-5 text-gray-400"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Account Status"}),l.jsx("p",{className:"font-medium text-green-600",children:"Active"})]})]}),l.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[l.jsx(Po,{className:"h-5 w-5 text-gray-400"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Account Created"}),l.jsx("p",{className:"font-medium text-gray-900",children:e!=null&&e.created_at?oe(e.created_at):"N/A"})]})]}),t.lastLogin&&l.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[l.jsx(Po,{className:"h-5 w-5 text-gray-400"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Last Sign In"}),l.jsx("p",{className:"font-medium text-gray-900",children:oe(t.lastLogin)})]})]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Activity Summary"}),l.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:l.jsx(Nl,{className:"h-6 w-6 text-green-600"})})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"Total Suppliers"}),l.jsx("p",{className:"text-2xl font-bold text-blue-700",children:t.suppliersCount})]})}),l.jsx("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-green-600 font-medium",children:"Total Transactions"}),l.jsx("p",{className:"text-2xl font-bold text-green-700",children:t.transactionsCount})]})}),l.jsx("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-lg",children:l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-red-600 font-medium",children:"Outstanding Amount"}),l.jsx("p",{className:"text-2xl font-bold text-red-700",children:Y(t.totalOutstanding)})]})})]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center",children:l.jsx(Wn,{className:"h-6 w-6 text-purple-600"})}),l.jsxs("div",{children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Business Owners"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Manage owners and track their activities"})]})]}),l.jsxs("button",{onClick:()=>O(!0),className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors flex items-center",children:[l.jsx(ET,{className:"h-4 w-4 mr-2"}),"Add Owner"]})]}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:E.map(ue=>{const fe=de(ue.id);return l.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[l.jsxs("div",{className:"flex items-start justify-between mb-3",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:ue.is_primary?l.jsx(bc,{className:"h-5 w-5 text-yellow-500"}):l.jsx(qr,{className:"h-5 w-5 text-purple-600"})}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-semibold text-gray-900",children:ue.owner_name}),l.jsx("p",{className:"text-sm text-gray-600",children:ue.role}),ue.is_primary&&l.jsx("span",{className:"text-xs bg-yellow-100 text-yellow-700 px-2 py-1 rounded-full",children:"Primary"})]})]}),!ue.is_primary&&l.jsxs("div",{className:"flex space-x-1",children:[l.jsx("button",{onClick:()=>L(ue),className:"p-1 text-gray-400 hover:text-blue-600 rounded",title:"Edit owner",children:l.jsx(Ac,{className:"h-4 w-4"})}),l.jsx("button",{onClick:()=>R(ue.id),className:"p-1 text-gray-400 hover:text-red-600 rounded",title:"Remove owner",children:l.jsx(Do,{className:"h-4 w-4"})})]})]}),l.jsx("div",{className:"mt-4 pt-3 border-t border-gray-200",children:l.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-blue-600 font-medium",children:fe.total_purchases}),l.jsx("p",{className:"text-gray-500",children:"Purchases"})]}),l.jsxs("div",{className:"text-center",children:[l.jsx("p",{className:"text-green-600 font-medium",children:fe.total_payments}),l.jsx("p",{className:"text-gray-500",children:"Payments"})]}),l.jsxs("div",{className:"col-span-2 text-center",children:[l.jsx("p",{className:"text-purple-600 font-medium",children:Y(fe.total_purchase_amount-fe.total_payment_amount)}),l.jsx("p",{className:"text-gray-500",children:"Net Activity"})]})]})})]},ue.id)})}),E.length===0&&l.jsxs("div",{className:"text-center py-8",children:[l.jsx(Wn,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500",children:"No business owners found"}),l.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Add owners to track who handles transactions"})]})]}),l.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Google Drive Backup"}),l.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:l.jsx(gy,{className:"h-6 w-6 text-blue-600"})})]}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[i.isConnected?l.jsx(ea,{className:"h-5 w-5 text-green-500"}):l.jsx(Em,{className:"h-5 w-5 text-red-500"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Connection Status"}),l.jsx("p",{className:`font-medium ${i.isConnected?"text-green-600":"text-red-600"}`,children:i.isConnected?"Connected":"Not Connected"}),i.isConnected&&i.userEmail&&l.jsx("p",{className:"text-xs text-gray-500",children:i.userEmail})]})]}),i.isConnected&&l.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(Dd,{className:"h-5 w-5 text-gray-400"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Auto Backup"}),l.jsx("p",{className:"text-xs text-gray-500",children:"Daily at midnight"})]})]}),l.jsx("button",{onClick:ve,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${i.autoBackupEnabled?"bg-blue-600":"bg-gray-200"}`,children:l.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${i.autoBackupEnabled?"translate-x-6":"translate-x-1"}`})})]}),i.lastBackup&&l.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[l.jsx(Po,{className:"h-5 w-5 text-gray-400"}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm text-gray-600",children:"Last Backup"}),l.jsx("p",{className:"font-medium text-gray-900",children:oe(i.lastBackup)})]})]}),l.jsx("div",{className:"flex space-x-3",children:i.isConnected?l.jsxs(l.Fragment,{children:[l.jsx("button",{onClick:le,disabled:d,className:"flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors disabled:bg-green-400 flex items-center justify-center",children:d?l.jsxs(l.Fragment,{children:[l.jsx(ts,{className:"h-4 w-4 mr-2 animate-spin"}),"Backing up..."]}):l.jsxs(l.Fragment,{children:[l.jsx(Nl,{className:"h-4 w-4 mr-2"}),"Backup Now"]})}),l.jsx("button",{onClick:Q,className:"px-4 py-2 border border-red-300 text-red-600 rounded-lg hover:bg-red-50 transition-colors",children:"Disconnect"})]}):l.jsx("button",{onClick:we,disabled:u,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors disabled:bg-blue-400 flex items-center justify-center",children:u?l.jsxs(l.Fragment,{children:[l.jsx(ts,{className:"h-4 w-4 mr-2 animate-spin"}),"Connecting..."]}):l.jsxs(l.Fragment,{children:[l.jsx(gy,{className:"h-4 w-4 mr-2"}),"Connect Google Drive"]})})}),l.jsxs("button",{onClick:ke,className:"w-full bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 transition-colors flex items-center justify-center",children:[l.jsx(zc,{className:"h-4 w-4 mr-2"}),"Download Local Backup"]})]})]}),l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[l.jsxs("div",{className:"flex items-center justify-between mb-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Backup History"}),l.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:l.jsx(Jf,{className:"h-6 w-6 text-green-600"})})]}),l.jsx("div",{className:"space-y-3",children:o.length>0?o.slice(0,5).map(ue=>l.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx("div",{className:`w-3 h-3 rounded-full ${ue.status==="completed"?"bg-green-500":ue.status==="failed"?"bg-red-500":"bg-yellow-500"}`}),l.jsxs("div",{children:[l.jsx("p",{className:"text-sm font-medium text-gray-900",children:oe(ue.backup_date)}),l.jsxs("p",{className:"text-xs text-gray-500",children:[ue.suppliers_count," suppliers, ",ue.transactions_count," transactions"]})]})]}),l.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${ue.status==="completed"?"bg-green-100 text-green-700":ue.status==="failed"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:ue.status})]},ue.id)):l.jsxs("div",{className:"text-center py-8",children:[l.jsx(Nl,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),l.jsx("p",{className:"text-gray-500",children:"No backups yet"}),l.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Connect Google Drive to start automatic backups"})]})})]})]}),h&&l.jsx("div",{className:`border rounded-lg p-4 ${h.includes("Success")||h.includes("successfully")?"bg-green-50 border-green-200":h.includes("Error")||h.includes("Failed")?"bg-red-50 border-red-200":"bg-blue-50 border-blue-200"}`,children:l.jsxs("div",{className:"flex items-start space-x-3",children:[h.includes("Success")||h.includes("successfully")?l.jsx(ea,{className:"h-5 w-5 text-green-600 mt-0.5"}):h.includes("Error")||h.includes("Failed")?l.jsx(Em,{className:"h-5 w-5 text-red-600 mt-0.5"}):l.jsx(is,{className:"h-5 w-5 text-blue-600 mt-0.5"}),l.jsx("div",{children:l.jsx("p",{className:`text-sm font-medium ${h.includes("Success")||h.includes("successfully")?"text-green-800":h.includes("Error")||h.includes("Failed")?"text-red-800":"text-blue-800"}`,children:h})})]})}),j&&l.jsx("div",{className:`border rounded-lg p-4 ${j.includes("Success")||j.includes("successfully")?"bg-green-50 border-green-200":j.includes("Error")||j.includes("Failed")?"bg-red-50 border-red-200":"bg-blue-50 border-blue-200"}`,children:l.jsxs("div",{className:"flex items-start space-x-3",children:[j.includes("Success")||j.includes("successfully")?l.jsx(ea,{className:"h-5 w-5 text-green-600 mt-0.5"}):j.includes("Error")||j.includes("Failed")?l.jsx(Em,{className:"h-5 w-5 text-red-600 mt-0.5"}):l.jsx(is,{className:"h-5 w-5 text-blue-600 mt-0.5"}),l.jsx("div",{children:l.jsx("p",{className:`text-sm font-medium ${j.includes("Success")||j.includes("successfully")?"text-green-800":j.includes("Error")||j.includes("Failed")?"text-red-800":"text-blue-800"}`,children:j})})]})}),F&&l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:l.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:I?"Edit Owner":"Add New Owner"}),l.jsxs("form",{onSubmit:I?D:S,className:"space-y-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Owner Name *"}),l.jsx("input",{type:"text",required:!0,value:H.owner_name,onChange:ue=>T({...H,owner_name:ue.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",placeholder:"Enter owner's full name"})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role/Title"}),l.jsx("input",{type:"text",value:H.role,onChange:ue=>T({...H,role:ue.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",placeholder:"e.g., Owner, Partner, Manager"})]}),l.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[l.jsx("button",{type:"button",onClick:X,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),l.jsx("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:I?"Update Owner":"Add Owner"})]})]})]})}),l.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[l.jsxs("div",{children:[l.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[l.jsx(I1,{className:"h-5 w-5 mr-2 text-amber-600"}),"Push Notifications"]}),l.jsx(dJ,{})]}),l.jsx(fJ,{})]}),l.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex items-start space-x-3",children:[l.jsx(is,{className:"h-5 w-5 text-yellow-600 mt-0.5"}),l.jsxs("div",{children:[l.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Security Notice"}),l.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:"Your data is securely stored and encrypted. Always sign out when using shared devices. If you notice any unusual activity, please contact support immediately."})]})]})})]})},pJ=()=>{const[e,t]=M.useState({suppliers:!0,spends:!0,persons:!0}),[r,n]=M.useState({suppliers:"reports",spends:"transactions",persons:"data-storage"}),[a,i]=M.useState([{id:"dashboard",name:"Dashboard",path:"/",iconName:"Home",enabled:!0},{id:"suppliers",name:"Suppliers",path:"/suppliers",iconName:"Users",enabled:!0},{id:"spends",name:"Spends",path:"/spends",iconName:"DollarSign",enabled:!0},{id:"persons",name:"Persons",path:"/persons",iconName:"User",enabled:!0},{id:"transactions",name:"Transactions",path:"/transactions",iconName:"Receipt",enabled:!0},{id:"reports",name:"Reports",path:"/reports",iconName:"FileText",enabled:!0},{id:"more",name:"More",path:"#",iconName:"MoreVertical",enabled:!0}]),[s,o]=M.useState(null),c=g=>{switch(g){case"Home":return Sc;case"Users":return Wn;case"DollarSign":return en;case"User":return qr;case"FileText":return _o;case"HardDrive":return hf;case"Book":return _l;default:return Sc}};M.useEffect(()=>{try{const g=localStorage.getItem("shopsynk_settings");if(g){const y=JSON.parse(g);y.features?(t(y.features),y.replacements&&n(y.replacements),y.menuOrder&&i(y.menuOrder.map(b=>({...b,enabled:y.features[b.id]!==!1})))):y.menuOrder&&i(y.menuOrder)}}catch(g){console.error("Error loading settings:",g),t({suppliers:!0,spends:!0,persons:!0}),i([{id:"dashboard",name:"Dashboard",path:"/",iconName:"Home",enabled:!0},{id:"suppliers",name:"Suppliers",path:"/suppliers",iconName:"Users",enabled:!0},{id:"spends",name:"Spends",path:"/spends",iconName:"DollarSign",enabled:!0},{id:"persons",name:"Persons",path:"/persons",iconName:"User",enabled:!0},{id:"transactions",name:"Transactions",path:"/transactions",iconName:"Receipt",enabled:!0},{id:"reports",name:"Reports",path:"/reports",iconName:"FileText",enabled:!0},{id:"more",name:"More",path:"#",iconName:"MoreVertical",enabled:!0}])}},[]),M.useEffect(()=>{const g={features:e,replacements:r,menuOrder:a};localStorage.setItem("shopsynk_settings",JSON.stringify(g)),window.dispatchEvent(new CustomEvent("settingsChanged"))},[e,r,a]);const u=g=>{t(y=>{const b={...y,[g]:!y[g]};return i(E=>E.map(A=>A.id===g?{...A,enabled:b[g]}:A)),b})},f=(g,y)=>{o(y),g.dataTransfer.effectAllowed="move"},d=g=>{g.preventDefault(),g.dataTransfer.dropEffect="move"},p=(g,y)=>{if(g.preventDefault(),!s||s===y)return;const b=a.findIndex(N=>N.id===s),E=a.findIndex(N=>N.id===y),A=[...a],[C]=A.splice(b,1);A.splice(E,0,C),i(A),o(null)},h=()=>{o(null)},x=()=>{t({suppliers:!0,spends:!0,persons:!0}),n({suppliers:"reports",spends:"transactions",persons:"data-storage"}),i([{id:"dashboard",name:"Dashboard",path:"/",iconName:"Home",enabled:!0},{id:"suppliers",name:"Suppliers",path:"/suppliers",iconName:"Users",enabled:!0},{id:"spends",name:"Spends",path:"/spends",iconName:"DollarSign",enabled:!0},{id:"persons",name:"Persons",path:"/persons",iconName:"User",enabled:!0},{id:"transactions",name:"Transactions",path:"/transactions",iconName:"Receipt",enabled:!0},{id:"reports",name:"Reports",path:"/reports",iconName:"FileText",enabled:!0},{id:"more",name:"More",path:"#",iconName:"MoreVertical",enabled:!0}])};return l.jsxs("div",{className:"max-w-4xl mx-auto p-6 space-y-8",children:[l.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[l.jsx(Jf,{className:"h-8 w-8 text-blue-600"}),l.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Settings"})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Feature Settings"}),l.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Enable or disable features you want to use in the app."}),l.jsxs("div",{className:"space-y-4",children:[l.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(Wn,{className:"h-5 w-5 text-blue-600"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:"Suppliers"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Manage suppliers and transactions"})]})]}),l.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:e.suppliers,onChange:()=>u("suppliers"),className:"sr-only peer"}),l.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),!e.suppliers&&l.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-100",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Replace with:"}),l.jsxs("select",{value:r.suppliers,onChange:g=>n(y=>({...y,suppliers:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"reports",children:"Reports"}),l.jsx("option",{value:"transactions",children:"Transactions"}),l.jsx("option",{value:"data-storage",children:"Data Storage"}),l.jsx("option",{value:"documentation",children:"Documentation"})]})]})]}),l.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(en,{className:"h-5 w-5 text-green-600"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:"Spends"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Track personal expenses"})]})]}),l.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:e.spends,onChange:()=>u("spends"),className:"sr-only peer"}),l.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),!e.spends&&l.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-100",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Replace with:"}),l.jsxs("select",{value:r.spends,onChange:g=>n(y=>({...y,spends:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"transactions",children:"Transactions"}),l.jsx("option",{value:"reports",children:"Reports"}),l.jsx("option",{value:"data-storage",children:"Data Storage"}),l.jsx("option",{value:"documentation",children:"Documentation"})]})]})]}),l.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[l.jsxs("div",{className:"flex items-center justify-between mb-3",children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[l.jsx(qr,{className:"h-5 w-5 text-purple-600"}),l.jsxs("div",{children:[l.jsx("p",{className:"font-medium text-gray-900",children:"Persons"}),l.jsx("p",{className:"text-sm text-gray-600",children:"Manage persons and transactions"})]})]}),l.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[l.jsx("input",{type:"checkbox",checked:e.persons,onChange:()=>u("persons"),className:"sr-only peer"}),l.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),!e.persons&&l.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-100",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Replace with:"}),l.jsxs("select",{value:r.persons,onChange:g=>n(y=>({...y,persons:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[l.jsx("option",{value:"data-storage",children:"Data Storage"}),l.jsx("option",{value:"transactions",children:"Transactions"}),l.jsx("option",{value:"reports",children:"Reports"}),l.jsx("option",{value:"documentation",children:"Documentation"})]})]})]})]})]}),l.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[l.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Bottom Menu Customization"}),l.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Drag and drop to reorder menu items. Disabled items won't appear in the bottom navigation."}),l.jsx("div",{className:"space-y-3",children:a.map(g=>{try{const y=c(g.iconName);return l.jsxs("div",{draggable:g.enabled,onDragStart:b=>f(b,g.id),onDragOver:d,onDrop:b=>p(b,g.id),onDragEnd:h,className:`flex items-center justify-between p-4 border border-gray-200 rounded-lg transition-all ${s===g.id?"opacity-50":""} ${g.enabled?"bg-white hover:bg-gray-50":"opacity-50 bg-gray-50"} ${g.enabled?"cursor-move":"cursor-not-allowed"}`,children:[l.jsxs("div",{className:"flex items-center space-x-3",children:[g.enabled&&l.jsx(jT,{className:"h-5 w-5 text-gray-400"}),l.jsx(y,{className:`h-5 w-5 ${g.enabled?"text-blue-600":"text-gray-400"}`}),l.jsxs("div",{children:[l.jsx("p",{className:`font-medium ${g.enabled?"text-gray-900":"text-gray-500"}`,children:g.name}),!g.enabled&&l.jsx("p",{className:"text-xs text-gray-400",children:"Disabled"})]})]}),l.jsx("div",{className:"flex items-center space-x-2",children:l.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${g.enabled?"bg-green-100 text-green-800":"bg-gray-100 text-gray-600"}`,children:g.enabled?"Enabled":"Disabled"})})]},g.id)}catch(y){return console.error("Error rendering menu item:",g,y),l.jsx("div",{className:"p-4 border border-red-200 rounded-lg bg-red-50",children:l.jsxs("p",{className:"text-red-600",children:["Error loading menu item: ",g.name]})},g.id)}})}),l.jsx("div",{className:"mt-6 pt-4 border-t border-gray-200",children:l.jsx("button",{onClick:x,className:"px-4 py-2 text-sm text-gray-600 hover:text-gray-800 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Reset to Defaults"})})]})]})};function mJ(){const[e,t]=M.useState(!1);return M.useEffect(()=>{(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0||document.referrer.includes("android-app://")||window.location.search.includes("utm_source=pwa")||localStorage.getItem("shopsynk_first_launch")===null||window.location.search.includes("show_splash=true"))&&(t(!0),localStorage.setItem("shopsynk_first_launch","false")),z1.requestNotificationPermission()},[]),e?l.jsx(I8,{onComplete:()=>t(!1)}):l.jsx(IT,{children:l.jsx(RT,{children:l.jsx(pT,{children:l.jsxs("div",{className:"App",children:[l.jsx(M8,{}),l.jsxs(cy,{children:[l.jsx(In,{path:"/login",element:l.jsx(R8,{})}),l.jsx(In,{path:"/register",element:l.jsx(B8,{})}),l.jsx(In,{path:"/",element:l.jsx(U8,{})}),l.jsx(In,{path:"/*",element:l.jsx(BT,{children:l.jsx(D8,{children:l.jsxs(cy,{children:[l.jsx(In,{path:"/dashboard",element:l.jsx($8,{})}),l.jsx(In,{path:"/suppliers",element:l.jsx(z8,{})}),l.jsx(In,{path:"/suppliers/:id",element:l.jsx(q8,{})}),l.jsx(In,{path:"/persons",element:l.jsx(W8,{})}),l.jsx(In,{path:"/persons/:id",element:l.jsx(H8,{})}),l.jsx(In,{path:"/spends",element:l.jsx(FD,{})}),l.jsx(In,{path:"/transactions",element:l.jsx(ID,{})}),l.jsx(In,{path:"/reports",element:l.jsx(sJ,{})}),l.jsx(In,{path:"/data-storage",element:l.jsx(oJ,{})}),l.jsx(In,{path:"/documentation",element:l.jsx(uJ,{})}),l.jsx(In,{path:"/profile",element:l.jsx(hJ,{})}),l.jsx(In,{path:"/settings",element:l.jsx(pJ,{})}),l.jsx(In,{path:"*",element:l.jsx(t4,{to:"/",replace:!0})})]})})})})]})]})})})})}u4(document.getElementById("root")).render(l.jsx(M.StrictMode,{children:l.jsx(mJ,{})}));export{fr as _};
