const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.es-DaCNQBnt.js","assets/vendor-CL556xxY.js","assets/supabase-D3hB1bgS.js","assets/ui-bnKsQQ67.js"])))=>i.map(i=>d[i]);
var t8=Object.defineProperty;var r8=(e,t,r)=>t in e?t8(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var tr=(e,t,r)=>r8(e,typeof t!="symbol"?t+"":t,r);import{r as z,a as U_,N as $_,u as Gc,b as z_,L as W_,d as n8,e as ko,R as i8,B as a8,f as Zx,h as Ji}from"./vendor-CL556xxY.js";import{c as s8,_ as h1}from"./supabase-D3hB1bgS.js";import{X as xl,D as jc,R as _s,B as Nm,C as o8,T as kc,S as Jx,U as So,L as l8,P as q_,a as c8,b as H_,c as nf,H as Qx,d as Qa,e as ja,F as vf,f as Sm,M as Cc,g as Am,E as Em,h as Tm,A as qf,i as uc,j as d1,k as Ig,l as Mg,G as u8,m as f8,n as Es,o as xf,p as Qo,q as G_,r as Rg,s as gh,t as Pm,u as fl,v as h8,w as V_,x as mc,y as d8,z as p8,I as m8,J as K_,K as g8,N as af,O as ey,Q as ty,V as gc,W as v8,Y as pi,Z as Y_,_ as X_,$ as sf,a0 as Xu,a1 as Z_,a2 as J_,a3 as x8,a4 as y8,a5 as Q_,a6 as Bg,a7 as b8,a8 as w8,a9 as _8,aa as ry,ab as p1}from"./ui-bnKsQQ67.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var e4={exports:{}},Td={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var N8=z,S8=Symbol.for("react.element"),A8=Symbol.for("react.fragment"),E8=Object.prototype.hasOwnProperty,T8=N8.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,P8={key:!0,ref:!0,__self:!0,__source:!0};function t4(e,t,r){var n,i={},a=null,s=null;r!==void 0&&(a=""+r),t.key!==void 0&&(a=""+t.key),t.ref!==void 0&&(s=t.ref);for(n in t)E8.call(t,n)&&!P8.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)i[n]===void 0&&(i[n]=t[n]);return{$$typeof:S8,type:e,key:a,ref:s,props:i,_owner:T8.current}}Td.Fragment=A8;Td.jsx=t4;Td.jsxs=t4;e4.exports=Td;var f=e4.exports,r4,ny=U_;r4=ny.createRoot,ny.hydrateRoot;const j8="https://gxgiqmmlvdgrzvbgmgfp.supabase.co",k8="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd4Z2lxbW1sdmRncnp2YmdtZ2ZwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTYwOTA4OTEsImV4cCI6MjA3MTY2Njg5MX0.VzO5yGWCFpN6ZU7d76tK9ADFPNwukuQ96RD3iILpAg0",et=s8(j8,k8),n4=z.createContext(void 0),Hi=()=>{const e=z.useContext(n4);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e},C8=({children:e})=>{const[t,r]=z.useState(null),[n,i]=z.useState(!0);z.useEffect(()=>{et.auth.getUser().then(({data:{user:u}})=>{r(u),i(!1)});const{data:{subscription:c}}=et.auth.onAuthStateChange((u,h)=>{r((h==null?void 0:h.user)??null),i(!1)});return()=>c.unsubscribe()},[]);const l={user:t,loading:n,signUp:async(c,u)=>{const{data:h,error:p}=await et.auth.signUp({email:c,password:u});return{data:h,error:p}},signIn:async(c,u)=>{const{data:h,error:p}=await et.auth.signInWithPassword({email:c,password:u});return{data:h,error:p}},signOut:async()=>{const{error:c}=await et.auth.signOut();if(c)throw c}};return f.jsx(n4.Provider,{value:l,children:e})};class vc{static async cleanupOldNotifications(){try{const t=new Date;t.setDate(t.getDate()-7);const{error:r}=await et.from("notifications").delete().lt("created_at",t.toISOString());if(r)throw r;console.log("‚úÖ Old notifications cleaned up successfully")}catch(t){console.error("‚ùå Error cleaning up old notifications:",t)}}static async cleanupReadNotifications(){try{const t=new Date;t.setDate(t.getDate()-3);const{error:r}=await et.from("notifications").delete().eq("read",!0).lt("created_at",t.toISOString());if(r)throw r;console.log("‚úÖ Read notifications cleaned up successfully")}catch(t){console.error("‚ùå Error cleaning up read notifications:",t)}}static async limitNotificationsPerUser(t,r=50){try{const{data:n,error:i}=await et.from("notifications").select("id, created_at").eq("user_id",t).order("created_at",{ascending:!1});if(i)throw i;if(!n||n.length<=r)return;const s=n.slice(r).map(l=>l.id),{error:o}=await et.from("notifications").delete().in("id",s);if(o)throw o;console.log(`‚úÖ Kept latest ${r} notifications, removed ${s.length} old ones`)}catch(n){console.error("‚ùå Error limiting notifications per user:",n)}}static async limitAllUsersNotifications(){try{const{data:t,error:r}=await et.from("notifications").select("user_id");if(r)throw r;if(!t)return;const n=[...new Set(t.map(i=>i.user_id))];for(const i of n)typeof i=="string"&&await this.limitNotificationsPerUser(i,100)}catch(t){console.error("‚ùå Error limiting notifications for all users:",t)}}static async performFullCleanup(){console.log("üßπ Starting notification database cleanup..."),await this.cleanupOldNotifications(),await this.cleanupReadNotifications(),await this.limitAllUsersNotifications(),console.log("‚úÖ Full notification cleanup completed")}static async deleteReadNotification(t){try{setTimeout(async()=>{const{error:r}=await et.from("notifications").delete().eq("id",t).eq("read",!0);r?console.error("Error auto-deleting read notification:",r):console.log("‚úÖ Auto-deleted read notification")},5e3)}catch(r){console.error("Error in auto-delete process:",r)}}static async getNotificationStats(){try{const{count:t,error:r}=await et.from("notifications").select("*",{count:"exact",head:!0});if(r)throw r;const{count:n,error:i}=await et.from("notifications").select("*",{count:"exact",head:!0}).eq("read",!0);if(i)throw i;const{count:a,error:s}=await et.from("notifications").select("*",{count:"exact",head:!0}).eq("read",!1);if(s)throw s;const o=t||0,l=n||0,c=a||0,u=o>0?Math.round(l/o*100):0;return{total:o,read:l,unread:c,readPercentage:u}}catch(t){return console.error("Error getting notification stats:",t),{total:0,read:0,unread:0,readPercentage:0}}}}class fc{constructor(){this.registration=null}static getInstance(){return fc.instance||(fc.instance=new fc),fc.instance}async initialize(){try{return!("serviceWorker"in navigator)||!("PushManager"in window)?(console.warn("Push notifications are not supported in this browser"),!1):(this.registration=await navigator.serviceWorker.register("/sw.js"),console.log("Service Worker registered successfully"),await navigator.serviceWorker.ready,!0)}catch(t){return console.error("Failed to initialize push notifications:",t),!1}}async requestPermission(){if(!("Notification"in window))return console.warn("This browser does not support notifications"),!1;let t=Notification.permission;return t==="default"&&(t=await Notification.requestPermission()),t==="granted"?(console.log("Notification permission granted"),!0):(console.warn("Notification permission denied"),!1)}async subscribe(t){try{if(this.registration||await this.initialize(),!this.registration)throw new Error("Service worker registration failed");const r=await this.registration.pushManager.getSubscription();if(r)return await this.saveSubscription(r,t),!0;const n=await this.registration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:this.urlBase64ToUint8Array("BEl62iUYgUivxIkv69yViEuiBIa40HI80YS_qZfKsRBF2uMi85KZJw-q9_-k9Q_nM8F1jQk2dGvQQQ6VDNt-3hc")});return await this.saveSubscription(n,t),console.log("Push notification subscription successful"),!0}catch(r){return console.error("Failed to subscribe to push notifications:",r),!1}}async unsubscribe(t){try{if(!this.registration)return!1;const r=await this.registration.pushManager.getSubscription();return r?(await r.unsubscribe(),await this.removeSubscription(t),console.log("Push notification unsubscribed successfully"),!0):!1}catch(r){return console.error("Failed to unsubscribe from push notifications:",r),!1}}async saveSubscription(t,r){const n=t.getKey?{p256dh:this.arrayBufferToBase64(t.getKey("p256dh")),auth:this.arrayBufferToBase64(t.getKey("auth"))}:{p256dh:"",auth:""},i={user_id:r,endpoint:t.endpoint,p256dh:n.p256dh,auth:n.auth,user_agent:navigator.userAgent},{error:a}=await et.from("push_subscriptions").upsert(i,{onConflict:"user_id"});if(a)throw new Error(`Failed to save push subscription: ${a.message}`)}async removeSubscription(t){const{error:r}=await et.from("push_subscriptions").delete().eq("user_id",t);r&&console.error("Failed to remove push subscription:",r)}async isSubscribed(){try{return this.registration?await this.registration.pushManager.getSubscription()!==null:!1}catch(t){return console.error("Failed to check subscription status:",t),!1}}async getSubscriptionStatus(){const t="serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window,r=t?Notification.permission:"denied",n=t?await this.isSubscribed():!1;return{supported:t,permission:r,subscribed:n}}urlBase64ToUint8Array(t){const r="=".repeat((4-t.length%4)%4),n=(t+r).replace(/-/g,"+").replace(/_/g,"/"),i=window.atob(n),a=new Uint8Array(i.length);for(let s=0;s<i.length;++s)a[s]=i.charCodeAt(s);return a}arrayBufferToBase64(t){if(!t)return"";const r=new Uint8Array(t);let n="";for(let i=0;i<r.byteLength;i++)n+=String.fromCharCode(r[i]);return window.btoa(n)}}const fo=fc.getInstance(),i4=z.createContext(void 0),O8=()=>{const e=z.useContext(i4);if(!e)throw new Error("useNotifications must be used within a NotificationProvider");return e},L8=({children:e})=>{const[t,r]=z.useState([]),{user:n}=Hi(),i=t.filter(v=>!v.read).length;z.useEffect(()=>{if(!(n!=null&&n.id))return;s(),o(),a(),vc.limitNotificationsPerUser(n.id,50);const v=setInterval(()=>{vc.limitNotificationsPerUser(n.id,50)},30*60*1e3);return()=>{clearInterval(v)}},[n==null?void 0:n.id]);const a=async()=>{if(n!=null&&n.id)try{if(!await fo.initialize()){console.warn("Push notifications not supported or failed to initialize");return}if(!await fo.requestPermission()){console.warn("Push notification permission denied");return}await fo.subscribe(n.id)?console.log("Push notifications enabled successfully"):console.warn("Failed to subscribe to push notifications"),"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",b=>{var E;if(((E=b.data)==null?void 0:E.type)==="MARK_NOTIFICATION_READ"){const S=b.data.notificationId;c(S)}})}catch(v){console.error("Push notification initialization failed:",v)}},s=async()=>{if(n!=null&&n.id)try{const{data:v,error:g}=await et.from("notifications").select("*").eq("user_id",n.id).order("created_at",{ascending:!1}).limit(50);if(g)throw g;const y=v.map(b=>({id:b.id,userId:b.user_id,type:b.type,title:b.title,message:b.message,data:b.data,read:b.read,createdAt:b.created_at,updatedAt:b.updated_at}));r(y)}catch(v){console.error("Error loading notifications:",v)}},o=()=>{if(!(n!=null&&n.id))return;const v=et.channel("notifications").on("postgres_changes",{event:"INSERT",schema:"public",table:"notifications",filter:`user_id=eq.${n.id}`},g=>{const y={id:g.new.id,userId:g.new.user_id,type:g.new.type,title:g.new.title,message:g.new.message,data:g.new.data,read:g.new.read,createdAt:g.new.created_at,updatedAt:g.new.updated_at};r(b=>[y,...b]),"Notification"in window&&window.Notification.permission==="granted"&&new window.Notification(y.title,{body:y.message,icon:"/pwa opning/SHOP.png",tag:y.id})}).subscribe();return()=>{v.unsubscribe()}},l=async v=>{if(n!=null&&n.id)try{const{data:g,error:y}=await et.from("notifications").insert({user_id:n.id,type:v.type,title:v.title,message:v.message,data:v.data,read:!1}).select().single();if(y)throw y;const b={id:g.id,userId:g.user_id,type:g.type,title:g.title,message:g.message,data:g.data,read:g.read,createdAt:g.created_at,updatedAt:g.updated_at};r(E=>[b,...E])}catch(g){console.error("Error adding notification:",g)}},c=async v=>{try{const{error:g}=await et.from("notifications").update({read:!0,updated_at:new Date().toISOString()}).eq("id",v);if(g)throw g;r(y=>y.map(b=>b.id===v?{...b,read:!0}:b)),vc.deleteReadNotification(v)}catch(g){console.error("Error marking notification as read:",g)}},d={notifications:t,unreadCount:i,addNotification:l,markAsRead:c,markAllAsRead:async()=>{if(n!=null&&n.id)try{const{error:v}=await et.from("notifications").update({read:!0,updated_at:new Date().toISOString()}).eq("user_id",n.id).eq("read",!1);if(v)throw v;r(g=>g.map(y=>({...y,read:!0})))}catch(v){console.error("Error marking all notifications as read:",v)}},clearNotification:async v=>{try{const{error:g}=await et.from("notifications").delete().eq("id",v);if(g)throw g;r(y=>y.filter(b=>b.id!==v))}catch(g){console.error("Error clearing notification:",g)}},clearAllNotifications:async()=>{if(n!=null&&n.id)try{const{error:v}=await et.from("notifications").delete().eq("user_id",n.id);if(v)throw v;r([])}catch(v){console.error("Error clearing all notifications:",v)}}};return f.jsx(i4.Provider,{value:d,children:e})};class jm{static async sendNotificationToAccountOwners(t,r){var n;try{const{data:i,error:a}=await et.from("profiles").select("id").neq("id",t);if(a)throw a;if(!i||i.length===0)return;const s=i.map(u=>({user_id:u.id,type:r.type,title:r.title,message:r.message,data:r.data,read:!1,created_at:new Date().toISOString(),updated_at:new Date().toISOString()})),{data:o,error:l}=await et.from("notifications").insert(s).select("id");if(l)throw l;console.log(`Notifications sent to ${i.length} users`);const c=i.map(u=>u.id);try{await this.sendPushNotification({title:r.title,body:r.message,userIds:c,url:this.getNotificationUrl(r.type,r.data),tag:r.type,notificationId:(n=o==null?void 0:o[0])==null?void 0:n.id})}catch(u){console.warn("Push notification failed:",u)}}catch(i){console.error("Error sending notifications:",i)}}static async notifyTransactionCreated(t,r,n,i,a,s){await this.sendNotificationToAccountOwners(t,{type:"transaction_created",title:"New Transaction Added",message:`${r} purchased ‚Çπ${n.toLocaleString()} supplies from ${i}`,data:{transactionId:a,supplierId:s,amount:n,supplierName:i,userAction:"created",userName:r}})}static async notifyTransactionUpdated(t,r,n,i,a,s){await this.sendNotificationToAccountOwners(t,{type:"transaction_updated",title:"Transaction Updated",message:`${r} updated transaction with ${i} (‚Çπ${n.toLocaleString()})`,data:{transactionId:a,supplierId:s,amount:n,supplierName:i,userAction:"updated",userName:r}})}static async notifyTransactionDeleted(t,r,n,i,a){await this.sendNotificationToAccountOwners(t,{type:"transaction_deleted",title:"Transaction Deleted",message:`${r} deleted transaction with ${i} (‚Çπ${n.toLocaleString()})`,data:{supplierId:a,amount:n,supplierName:i,userAction:"deleted",userName:r}})}static async notifyPaymentMade(t,r,n,i,a){await this.sendNotificationToAccountOwners(t,{type:"payment_made",title:"Payment Made",message:`${r} made payment of ‚Çπ${n.toLocaleString()} to ${i}`,data:{supplierId:a,amount:n,supplierName:i,userAction:"payment",userName:r}})}static async notifySupplierAdded(t,r,n,i){await this.sendNotificationToAccountOwners(t,{type:"supplier_added",title:"New Supplier Added",message:`${r} added new supplier: ${n}`,data:{supplierId:i,supplierName:n,userAction:"added",userName:r}})}static async requestNotificationPermission(){return"Notification"in window&&window.Notification.permission==="default"?await window.Notification.requestPermission()==="granted":window.Notification.permission==="granted"}static async sendPushNotification(t){try{const{data:r,error:n}=await et.functions.invoke("send-push-notification",{body:t});if(n)throw console.error("Push notification error:",n),n;return console.log("Push notification result:",r),r}catch(r){throw console.error("Failed to send push notification:",r),r}}static getNotificationUrl(t,r){switch(t){case"transaction_created":case"transaction_updated":return r!=null&&r.supplierId?`/suppliers/${r.supplierId}`:"/transactions";case"payment_made":return r!=null&&r.supplierId?`/suppliers/${r.supplierId}`:"/suppliers";case"supplier_added":return r!=null&&r.supplierId?`/suppliers/${r.supplierId}`:"/suppliers";default:return"/dashboard"}}}const F8=({children:e})=>{const{user:t,loading:r}=Hi();return r?f.jsx("div",{className:"min-h-screen flex items-center justify-center",children:f.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600"})}):t?f.jsx(f.Fragment,{children:e}):f.jsx($_,{to:"/login",replace:!0})},D8="1.1",a4="The Navigation Update",Oc=()=>`v${D8}`,I8=()=>{const[e,t]=z.useState(null),[r,n]=z.useState(!1),[i,a]=z.useState(!1),[s,o]=z.useState(!1);z.useEffect(()=>{const u=/iPad|iPhone|iPod/.test(navigator.userAgent);a(u);const h=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone||document.referrer.includes("android-app://");o(h);const p=d=>{d.preventDefault(),t(d),n(!0)};return window.addEventListener("beforeinstallprompt",p),()=>{window.removeEventListener("beforeinstallprompt",p)}},[]);const l=async()=>{if(!e)return;e.prompt();const{outcome:u}=await e.userChoice;console.log(u==="accepted"?"User accepted the install prompt":"User dismissed the install prompt"),t(null),n(!1)},c=()=>{n(!1),sessionStorage.setItem("installPromptDismissed","true")};return s||sessionStorage.getItem("installPromptDismissed")==="true"?null:i&&!s?f.jsx("div",{className:"fixed bottom-4 left-4 right-4 z-50 bg-blue-600 text-white p-4 rounded-lg shadow-lg border border-blue-500",children:f.jsxs("div",{className:"flex items-start justify-between",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("h3",{className:"font-semibold text-sm",children:"Install Shopsynk"}),f.jsxs("p",{className:"text-xs mt-1 opacity-90",children:["Install this app on your iPhone: tap ",f.jsx("span",{className:"font-bold",children:"Share"})," and then ",f.jsx("span",{className:"font-bold",children:"Add to Home Screen"})]})]}),f.jsx("button",{onClick:c,className:"ml-2 p-1 hover:bg-blue-700 rounded",children:f.jsx(xl,{className:"h-4 w-4"})})]})}):r&&e?f.jsx("div",{className:"fixed bottom-4 left-4 right-4 z-50 bg-gradient-to-r from-blue-600 to-purple-600 text-white p-4 rounded-lg shadow-lg border border-blue-500",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center flex-1",children:[f.jsx(jc,{className:"h-5 w-5 mr-3 flex-shrink-0"}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold text-sm",children:"Install Shopsynk App"}),f.jsx("p",{className:"text-xs mt-1 opacity-90",children:"Get the full app experience with offline access and notifications"})]})]}),f.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[f.jsx("button",{onClick:l,className:"bg-white text-blue-600 px-3 py-1 rounded text-xs font-medium hover:bg-gray-100 transition-colors",children:"Install"}),f.jsx("button",{onClick:c,className:"p-1 hover:bg-blue-700 rounded",children:f.jsx(xl,{className:"h-4 w-4"})})]})]})}):null},M8=()=>{const[e,t]=z.useState(!1),[r,n]=z.useState(null);z.useEffect(()=>{"serviceWorker"in navigator&&(navigator.serviceWorker.ready.then(s=>{s.waiting&&(n(s.waiting),t(!0)),s.addEventListener("updatefound",()=>{const o=s.installing;o&&o.addEventListener("statechange",()=>{o.state==="installed"&&navigator.serviceWorker.controller&&(n(o),t(!0))})})}),navigator.serviceWorker.addEventListener("controllerchange",()=>{window.location.reload()}))},[]);const i=()=>{r&&(r.postMessage({type:"SKIP_WAITING"}),t(!1))},a=()=>{t(!1)};return e?f.jsx("div",{className:"fixed top-4 left-4 right-4 z-50 bg-green-600 text-white p-4 rounded-lg shadow-lg border border-green-500",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center flex-1",children:[f.jsx(_s,{className:"h-5 w-5 mr-3 flex-shrink-0"}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold text-sm",children:"App Update Available"}),f.jsx("p",{className:"text-xs mt-1 opacity-90",children:"A new version of Shopsynk is ready to install"})]})]}),f.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[f.jsx("button",{onClick:i,className:"bg-white text-green-600 px-3 py-1 rounded text-xs font-medium hover:bg-gray-100 transition-colors",children:"Update"}),f.jsx("button",{onClick:a,className:"p-1 hover:bg-green-700 rounded",children:f.jsx(xl,{className:"h-4 w-4"})})]})]})}):null},R0=43200,iy=1440,ay=Symbol.for("constructDateFrom");function Ug(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&ay in e?e[ay](t):e instanceof Date?new e.constructor(t):new Date(t)}function Ao(e,t){return Ug(e,e)}let R8={};function B8(){return R8}function sy(e){const t=Ao(e),r=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return r.setUTCFullYear(t.getFullYear()),+e-+r}function $g(e,...t){const r=Ug.bind(null,e||t.find(n=>typeof n=="object"));return t.map(r)}function vh(e,t){const r=+Ao(e)-+Ao(t);return r<0?-1:r>0?1:r}function U8(e){return Ug(e,Date.now())}function $8(e,t,r){const[n,i]=$g(r==null?void 0:r.in,e,t),a=n.getFullYear()-i.getFullYear(),s=n.getMonth()-i.getMonth();return a*12+s}function z8(e){return t=>{const n=(e?Math[e]:Math.trunc)(t);return n===0?0:n}}function W8(e,t){return+Ao(e)-+Ao(t)}function q8(e,t){const r=Ao(e);return r.setHours(23,59,59,999),r}function H8(e,t){const r=Ao(e),n=r.getMonth();return r.setFullYear(r.getFullYear(),n+1,0),r.setHours(23,59,59,999),r}function G8(e,t){const r=Ao(e);return+q8(r)==+H8(r)}function V8(e,t,r){const[n,i,a]=$g(r==null?void 0:r.in,e,e,t),s=vh(i,a),o=Math.abs($8(i,a));if(o<1)return 0;i.getMonth()===1&&i.getDate()>27&&i.setDate(30),i.setMonth(i.getMonth()-s*o);let l=vh(i,a)===-s;G8(n)&&o===1&&vh(n,a)===1&&(l=!1);const c=s*(o-+l);return c===0?0:c}function K8(e,t,r){const n=W8(e,t)/1e3;return z8(r==null?void 0:r.roundingMethod)(n)}const Y8={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},X8=(e,t,r)=>{let n;const i=Y8[e];return typeof i=="string"?n=i:t===1?n=i.one:n=i.other.replace("{{count}}",t.toString()),r!=null&&r.addSuffix?r.comparison&&r.comparison>0?"in "+n:n+" ago":n};function m1(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}const Z8={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},J8={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Q8={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},eP={date:m1({formats:Z8,defaultWidth:"full"}),time:m1({formats:J8,defaultWidth:"full"}),dateTime:m1({formats:Q8,defaultWidth:"full"})},tP={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},rP=(e,t,r,n)=>tP[e];function Iu(e){return(t,r)=>{const n=r!=null&&r.context?String(r.context):"standalone";let i;if(n==="formatting"&&e.formattingValues){const s=e.defaultFormattingWidth||e.defaultWidth,o=r!=null&&r.width?String(r.width):s;i=e.formattingValues[o]||e.formattingValues[s]}else{const s=e.defaultWidth,o=r!=null&&r.width?String(r.width):e.defaultWidth;i=e.values[o]||e.values[s]}const a=e.argumentCallback?e.argumentCallback(t):t;return i[a]}}const nP={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},iP={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},aP={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},sP={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},oP={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},lP={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},cP=(e,t)=>{const r=Number(e),n=r%100;if(n>20||n<10)switch(n%10){case 1:return r+"st";case 2:return r+"nd";case 3:return r+"rd"}return r+"th"},uP={ordinalNumber:cP,era:Iu({values:nP,defaultWidth:"wide"}),quarter:Iu({values:iP,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Iu({values:aP,defaultWidth:"wide"}),day:Iu({values:sP,defaultWidth:"wide"}),dayPeriod:Iu({values:oP,defaultWidth:"wide",formattingValues:lP,defaultFormattingWidth:"wide"})};function Mu(e){return(t,r={})=>{const n=r.width,i=n&&e.matchPatterns[n]||e.matchPatterns[e.defaultMatchWidth],a=t.match(i);if(!a)return null;const s=a[0],o=n&&e.parsePatterns[n]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?hP(o,h=>h.test(s)):fP(o,h=>h.test(s));let c;c=e.valueCallback?e.valueCallback(l):l,c=r.valueCallback?r.valueCallback(c):c;const u=t.slice(s.length);return{value:c,rest:u}}}function fP(e,t){for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t(e[r]))return r}function hP(e,t){for(let r=0;r<e.length;r++)if(t(e[r]))return r}function dP(e){return(t,r={})=>{const n=t.match(e.matchPattern);if(!n)return null;const i=n[0],a=t.match(e.parsePattern);if(!a)return null;let s=e.valueCallback?e.valueCallback(a[0]):a[0];s=r.valueCallback?r.valueCallback(s):s;const o=t.slice(i.length);return{value:s,rest:o}}}const pP=/^(\d+)(th|st|nd|rd)?/i,mP=/\d+/i,gP={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},vP={any:[/^b/i,/^(a|c)/i]},xP={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},yP={any:[/1/i,/2/i,/3/i,/4/i]},bP={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},wP={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},_P={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},NP={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},SP={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},AP={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},EP={ordinalNumber:dP({matchPattern:pP,parsePattern:mP,valueCallback:e=>parseInt(e,10)}),era:Mu({matchPatterns:gP,defaultMatchWidth:"wide",parsePatterns:vP,defaultParseWidth:"any"}),quarter:Mu({matchPatterns:xP,defaultMatchWidth:"wide",parsePatterns:yP,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Mu({matchPatterns:bP,defaultMatchWidth:"wide",parsePatterns:wP,defaultParseWidth:"any"}),day:Mu({matchPatterns:_P,defaultMatchWidth:"wide",parsePatterns:NP,defaultParseWidth:"any"}),dayPeriod:Mu({matchPatterns:SP,defaultMatchWidth:"any",parsePatterns:AP,defaultParseWidth:"any"})},TP={code:"en-US",formatDistance:X8,formatLong:eP,formatRelative:rP,localize:uP,match:EP,options:{weekStartsOn:0,firstWeekContainsDate:1}};function PP(e,t,r){const n=B8(),i=(r==null?void 0:r.locale)??n.locale??TP,a=2520,s=vh(e,t);if(isNaN(s))throw new RangeError("Invalid time value");const o=Object.assign({},r,{addSuffix:r==null?void 0:r.addSuffix,comparison:s}),[l,c]=$g(r==null?void 0:r.in,...s>0?[t,e]:[e,t]),u=K8(c,l),h=(sy(c)-sy(l))/1e3,p=Math.round((u-h)/60);let d;if(p<2)return r!=null&&r.includeSeconds?u<5?i.formatDistance("lessThanXSeconds",5,o):u<10?i.formatDistance("lessThanXSeconds",10,o):u<20?i.formatDistance("lessThanXSeconds",20,o):u<40?i.formatDistance("halfAMinute",0,o):u<60?i.formatDistance("lessThanXMinutes",1,o):i.formatDistance("xMinutes",1,o):p===0?i.formatDistance("lessThanXMinutes",1,o):i.formatDistance("xMinutes",p,o);if(p<45)return i.formatDistance("xMinutes",p,o);if(p<90)return i.formatDistance("aboutXHours",1,o);if(p<iy){const v=Math.round(p/60);return i.formatDistance("aboutXHours",v,o)}else{if(p<a)return i.formatDistance("xDays",1,o);if(p<R0){const v=Math.round(p/iy);return i.formatDistance("xDays",v,o)}else if(p<R0*2)return d=Math.round(p/R0),i.formatDistance("aboutXMonths",d,o)}if(d=V8(c,l),d<12){const v=Math.round(p/R0);return i.formatDistance("xMonths",v,o)}else{const v=d%12,g=Math.trunc(d/12);return v<3?i.formatDistance("aboutXYears",g,o):v<9?i.formatDistance("overXYears",g,o):i.formatDistance("almostXYears",g+1,o)}}function jP(e,t){return PP(e,U8(e),t)}const oy=()=>{const[e,t]=z.useState(!1),{notifications:r,unreadCount:n,markAsRead:i,markAllAsRead:a,clearNotification:s,clearAllNotifications:o}=O8(),l=h=>{var p,d;h.read||i(h.id),(p=h.data)!=null&&p.transactionId||(d=h.data)!=null&&d.supplierId},c=h=>{switch(h){case"transaction_created":return"üí∞";case"transaction_updated":return"‚úèÔ∏è";case"transaction_deleted":return"üóëÔ∏è";case"supplier_added":return"üè™";case"payment_made":return"üí≥";default:return"üì¢"}},u=h=>{try{return jP(new Date(h),{addSuffix:!0})}catch{return"Recently"}};return f.jsxs("div",{className:"relative",children:[f.jsxs("button",{onClick:()=>t(!e),className:"relative p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-full transition-colors",children:[f.jsx(Nm,{className:"w-6 h-6"}),n>0&&f.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center font-bold",children:n>99?"99+":n})]}),e&&f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"fixed inset-0 z-10",onClick:()=>t(!1)}),f.jsxs("div",{className:"absolute right-0 top-full mt-2 w-80 bg-white rounded-lg shadow-xl border border-gray-200 z-20 max-h-96 overflow-hidden",children:[f.jsx("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Notifications",n>0&&f.jsxs("span",{className:"ml-2 text-sm bg-red-100 text-red-600 px-2 py-1 rounded-full",children:[n," new"]})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[n>0&&f.jsx("button",{onClick:a,className:"text-sm text-blue-600 hover:text-blue-800 flex items-center",title:"Mark all as read",children:f.jsx(o8,{className:"w-4 h-4"})}),f.jsx("button",{onClick:()=>t(!1),className:"text-gray-400 hover:text-gray-600",children:f.jsx(xl,{className:"w-4 h-4"})})]})]})}),f.jsx("div",{className:"max-h-64 overflow-y-auto",children:r.length===0?f.jsxs("div",{className:"p-8 text-center text-gray-500",children:[f.jsx(Nm,{className:"w-12 h-12 mx-auto mb-3 text-gray-300"}),f.jsx("p",{className:"text-sm",children:"No notifications yet"})]}):r.map(h=>f.jsx("div",{className:`p-4 border-b border-gray-100 cursor-pointer hover:bg-gray-50 transition-colors ${h.read?"":"bg-blue-50 border-l-4 border-l-blue-500"}`,onClick:()=>l(h),children:f.jsxs("div",{className:"flex items-start space-x-3",children:[f.jsx("div",{className:"text-2xl flex-shrink-0",children:c(h.type)}),f.jsx("div",{className:"flex-1 min-w-0",children:f.jsxs("div",{className:"flex items-start justify-between",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:`text-sm font-medium ${h.read?"text-gray-700":"text-gray-900"}`,children:h.title}),f.jsx("p",{className:`text-sm mt-1 ${h.read?"text-gray-500":"text-gray-700"}`,children:h.message}),f.jsx("p",{className:"text-xs text-gray-400 mt-2",children:u(h.createdAt)})]}),f.jsx("button",{onClick:p=>{p.stopPropagation(),s(h.id)},className:"text-gray-400 hover:text-gray-600 ml-2 flex-shrink-0",title:"Remove notification",children:f.jsx(xl,{className:"w-4 h-4"})})]})})]})},h.id))}),r.length>0&&f.jsx("div",{className:"p-3 border-t border-gray-200 bg-gray-50",children:f.jsxs("button",{onClick:o,className:"w-full text-center text-sm text-red-600 hover:text-red-800 flex items-center justify-center space-x-1",children:[f.jsx(kc,{className:"w-4 h-4"}),f.jsx("span",{children:"Clear all notifications"})]})})]})]})]})},kP=({children:e})=>{const{user:t,signOut:r}=Hi(),n=Gc(),i=z_(),[a,s]=z.useState(!1),o=async()=>{try{await r(),n("/login")}catch(y){console.error("Error signing out:",y)}},l=i.pathname==="/suppliers",c=i.pathname.startsWith("/suppliers/")&&i.pathname!=="/suppliers",u=()=>{l?n("/suppliers?add=true"):c&&s(!0)},h=()=>{s(!1);const y=new CustomEvent("openPurchaseModal");window.dispatchEvent(y)},p=()=>{s(!1);const y=new CustomEvent("openPaymentModal");window.dispatchEvent(y)},d=[{name:"Dashboard",path:"/",icon:Qx},{name:"Suppliers",path:"/suppliers",icon:Qa},{name:"Transactions",path:"/transactions",icon:ja},{name:"Reports",path:"/reports",icon:vf},{name:"Data Storage",path:"/data-storage",icon:Sm},{name:"Documentation",path:"/documentation",icon:nf}],v=[{name:"Dashboard",path:"/",icon:Qx},{name:"Transactions",path:"/transactions",icon:ja},{name:"Suppliers",path:"/suppliers",icon:Qa},{name:"Reports",path:"/reports",icon:vf},{name:"Data Storage",path:"/data-storage",icon:Sm}],g=y=>y==="/"?i.pathname==="/":i.pathname.startsWith(y);return f.jsxs("div",{className:"min-h-screen bg-gray-50",children:[f.jsx("div",{className:"hidden lg:block fixed inset-y-0 left-0 z-40 w-64 bg-white shadow-lg border-r border-gray-200",children:f.jsxs("div",{className:"flex flex-col h-full",children:[f.jsxs("div",{className:"flex flex-col items-center justify-center h-16 bg-blue-600 text-white",children:[f.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[f.jsx(Jx,{className:"h-8 w-8 text-white"}),f.jsx("h1",{className:"text-xl font-bold",children:"Shopsynk"})]}),f.jsx("p",{className:"text-xs text-blue-200",children:Oc()})]}),f.jsx("nav",{className:"flex-1 px-4 py-6 space-y-2",children:d.map(y=>{const b=y.icon;return f.jsxs("button",{onClick:()=>n(y.path),className:`w-full flex items-center px-4 py-3 text-left rounded-lg transition-colors ${g(y.path)?"bg-blue-50 text-blue-700 border border-blue-200":"text-gray-700 hover:bg-gray-50 hover:text-gray-900"}`,children:[f.jsx(b,{className:"h-5 w-5 mr-3"}),y.name]},y.name)})}),f.jsxs("div",{className:"p-4 border-t border-gray-200",children:[f.jsx("button",{onClick:()=>n("/profile"),className:"w-full flex items-center justify-between p-3 rounded-lg hover:bg-gray-50 transition-colors mb-3",children:f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:f.jsx(So,{className:"h-4 w-4 text-blue-600"})}),f.jsxs("div",{className:"flex-1 min-w-0 text-left",children:[f.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:"Profile Settings"}),f.jsx("p",{className:"text-xs text-gray-500 truncate",children:t==null?void 0:t.email})]})]})}),f.jsxs("button",{onClick:o,className:"w-full flex items-center justify-center p-3 text-red-600 hover:bg-red-50 rounded-lg transition-colors",children:[f.jsx(l8,{className:"h-4 w-4 mr-2"}),"Sign Out"]})]})]})}),f.jsx("div",{className:"lg:hidden fixed bottom-0 left-0 right-0 z-50 bg-white border-t border-gray-200 shadow-lg safe-area-pb",children:f.jsx("div",{className:"flex items-center justify-around px-1 py-3",children:v.map(y=>{const b=g(y.path);if(y.path==="/suppliers"&&(l||c))return f.jsx("button",{onClick:u,className:"flex items-center justify-center p-3 rounded-xl transition-all duration-200 min-w-0 flex-1 mx-1 bg-blue-600 text-white transform scale-110",title:l?"Add Supplier":"Quick Actions",children:f.jsx(q_,{className:"h-6 w-6 text-white"})},y.name);const E=y.icon;return f.jsx("button",{onClick:()=>n(y.path),className:`flex items-center justify-center p-3 rounded-xl transition-all duration-200 min-w-0 flex-1 mx-1 ${b?"text-blue-600 bg-blue-50 transform scale-110":"text-gray-500 hover:text-gray-700 hover:bg-gray-50 active:scale-95"}`,title:y.name,children:f.jsx(E,{className:`h-6 w-6 ${b?"text-blue-600":"text-gray-500"}`})},y.name)})})}),a&&c&&f.jsx("div",{className:"lg:hidden fixed inset-0 bg-black bg-opacity-50 z-[60] flex items-end justify-center",children:f.jsxs("div",{className:"bg-white rounded-t-2xl w-full p-6 animate-slide-up",children:[f.jsxs("div",{className:"flex items-center justify-between mb-6",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Quick Actions"}),f.jsx("button",{onClick:()=>s(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:f.jsx(xl,{className:"h-5 w-5 text-gray-500"})})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("button",{onClick:h,className:"flex flex-col items-center p-6 bg-red-50 border border-red-200 rounded-xl hover:bg-red-100 transition-colors",children:[f.jsx("div",{className:"w-12 h-12 bg-red-500 rounded-full flex items-center justify-center mb-3",children:f.jsx(c8,{className:"h-6 w-6 text-white"})}),f.jsx("span",{className:"text-red-700 font-medium",children:"Add Purchase"}),f.jsx("span",{className:"text-red-600 text-sm mt-1",children:"Record new purchase"})]}),f.jsxs("button",{onClick:p,className:"flex flex-col items-center p-6 bg-green-50 border border-green-200 rounded-xl hover:bg-green-100 transition-colors",children:[f.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-full flex items-center justify-center mb-3",children:f.jsx(H_,{className:"h-6 w-6 text-white"})}),f.jsx("span",{className:"text-green-700 font-medium",children:"Pay Due"}),f.jsx("span",{className:"text-green-600 text-sm mt-1",children:"Make payment"})]})]})]})}),f.jsx("div",{className:"lg:hidden bg-white border-b border-gray-200 px-4 py-3 sticky top-0 z-40",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Jx,{className:"h-6 w-6 text-blue-600"}),f.jsx("h1",{className:"text-lg font-bold text-blue-600",children:"Shopsynk"}),f.jsx("span",{className:"ml-2 text-xs text-gray-500",children:Oc()})]}),f.jsxs("div",{className:"flex items-center space-x-1",children:[f.jsx("button",{onClick:()=>n("/documentation"),className:`p-2 rounded-lg transition-colors ${g("/documentation")?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-100"}`,title:"Documentation",children:f.jsx(nf,{className:"h-5 w-5"})}),f.jsx(oy,{}),f.jsx("button",{onClick:()=>n("/profile"),className:`p-2 rounded-lg transition-colors ${g("/profile")?"bg-blue-50 text-blue-600":"text-gray-600 hover:bg-gray-100"}`,title:"Profile",children:f.jsx(So,{className:"h-5 w-5"})})]})]})}),f.jsxs("div",{className:"lg:pl-64",children:[f.jsx("div",{className:"hidden lg:block bg-white border-b border-gray-200 px-6 py-4 lg:px-8",children:f.jsx("div",{className:"flex items-center justify-end",children:f.jsx(oy,{})})}),f.jsx("main",{className:"p-4 lg:p-8 pb-20 lg:pb-8 pt-4 lg:pt-0",children:e})]}),f.jsx(I8,{}),f.jsx(M8,{})]})},CP=({onComplete:e})=>{const[t,r]=z.useState(!0);return z.useEffect(()=>{const n=setTimeout(()=>{r(!1),setTimeout(e,300)},2500);return()=>clearTimeout(n)},[e]),t?f.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-yellow-100 to-orange-200 flex items-center justify-center z-50 transition-opacity duration-300",children:f.jsxs("div",{className:"text-center animate-bounce-slow",children:[f.jsx("img",{src:"/pwa opning/SHOP.png",alt:"Shopsynk",className:"w-48 h-48 mx-auto mb-6 drop-shadow-lg object-contain",onError:n=>{var a;n.currentTarget.style.display="none";const i=document.createElement("div");i.className="w-48 h-48 mx-auto mb-6 bg-orange-400 rounded-3xl flex items-center justify-center text-white text-6xl font-bold shadow-lg",i.textContent="S",(a=n.currentTarget.parentNode)==null||a.insertBefore(i,n.currentTarget)}}),f.jsx("div",{className:"text-2xl font-bold text-orange-600 mb-2 animate-pulse",children:"Shopsynk"}),f.jsx("div",{className:"text-orange-500 animate-fade-in-delayed",children:"Supplier Management"}),f.jsxs("div",{className:"mt-8 flex justify-center space-x-1",children:[f.jsx("div",{className:"w-2 h-2 bg-orange-400 rounded-full animate-bounce",style:{animationDelay:"0ms"}}),f.jsx("div",{className:"w-2 h-2 bg-orange-400 rounded-full animate-bounce",style:{animationDelay:"150ms"}}),f.jsx("div",{className:"w-2 h-2 bg-orange-400 rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})]})}):f.jsx("div",{className:"fixed inset-0 bg-gradient-to-br from-yellow-100 to-orange-200 flex items-center justify-center z-50 opacity-0 transition-opacity duration-300 pointer-events-none",children:f.jsxs("div",{className:"text-center animate-fade-out",children:[f.jsx("img",{src:"/pwa opning/SHOP.png",alt:"Shopsynk",className:"w-48 h-48 mx-auto mb-6 animate-pulse object-contain",onError:n=>{n.currentTarget.style.display="none"}}),f.jsx("div",{className:"text-2xl font-bold text-orange-600 mb-2",children:"Shopsynk"}),f.jsx("div",{className:"text-orange-500",children:"Supplier Management"})]})})},OP=()=>{const[e,t]=z.useState(!1),[r,n]=z.useState(!1);z.useEffect(()=>{const s=localStorage.getItem("icon-update-v1-seen"),o=window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0;if(!s&&o){const l=setTimeout(()=>{t(!0)},3e3);return()=>clearTimeout(l)}},[]);const i=()=>{n(!0),t(!1),localStorage.setItem("icon-update-v1-seen","true")},a=()=>{i(),alert(`To see our new logo:
1. Remove Shopsynk from your home screen
2. Visit shopsynk.netlify.app in your browser
3. Add to Home Screen again
4. Enjoy the updated branding!`)};return!e||r?null:f.jsx("div",{className:"fixed top-4 right-4 bg-gradient-to-r from-blue-500 to-purple-600 text-white p-4 rounded-lg shadow-xl z-50 max-w-sm",children:f.jsxs("div",{className:"flex items-start space-x-3",children:[f.jsx("div",{className:"bg-white/20 rounded-full p-2",children:f.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})}),f.jsxs("div",{className:"flex-1",children:[f.jsx("h4",{className:"font-semibold text-sm",children:"üéâ New Logo Available!"}),f.jsx("p",{className:"text-xs mt-1 opacity-90",children:"We've updated our branding! Reinstall the app to see our new logo on your home screen."}),f.jsxs("div",{className:"flex space-x-2 mt-3",children:[f.jsx("button",{onClick:a,className:"bg-white/20 text-xs px-3 py-1 rounded-full hover:bg-white/30 transition-colors",children:"How to Update"}),f.jsx("button",{onClick:i,className:"text-xs px-3 py-1 rounded-full hover:bg-white/10 transition-colors",children:"Later"})]})]}),f.jsx("button",{onClick:i,className:"text-white/70 hover:text-white transition-colors",children:f.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:f.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})},LP=()=>{const[e,t]=z.useState(""),[r,n]=z.useState(""),[i,a]=z.useState(!1),[s,o]=z.useState(!1),[l,c]=z.useState(""),{signIn:u}=Hi(),h=Gc(),p=async d=>{d.preventDefault(),o(!0),c("");try{const{error:v}=await u(e,r);if(v)throw v;h("/")}catch(v){c(v.message)}finally{o(!1)}};return f.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:f.jsx("div",{className:"max-w-md w-full",children:f.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[f.jsxs("div",{className:"text-center mb-8",children:[f.jsx("div",{className:"w-16 h-16 rounded-2xl flex items-center justify-center mx-auto mb-4",children:f.jsx("img",{src:"/pwa opning/shopsynk.png",alt:"Shopsynk Logo",className:"w-16 h-16 object-contain"})}),f.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Welcome Back"}),f.jsx("p",{className:"text-gray-600 mt-2",children:"Sign in to manage your supplier dues"})]}),l&&f.jsx("div",{className:"mb-4 p-3 rounded-lg bg-red-50 border border-red-200 text-red-600 text-sm",children:l}),f.jsxs("form",{onSubmit:p,className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),f.jsxs("div",{className:"relative",children:[f.jsx(Cc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),f.jsx("input",{type:"email",value:e,onChange:d=>t(d.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Enter your email",required:!0})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),f.jsxs("div",{className:"relative",children:[f.jsx(Am,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),f.jsx("input",{type:i?"text":"password",value:r,onChange:d=>n(d.target.value),className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Enter your password",required:!0}),f.jsx("button",{type:"button",onClick:()=>a(!i),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:i?f.jsx(Em,{className:"h-5 w-5"}):f.jsx(Tm,{className:"h-5 w-5"})})]})]}),f.jsx("button",{type:"submit",disabled:s,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:s?f.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):f.jsxs(f.Fragment,{children:["Sign In",f.jsx(qf,{className:"ml-2 h-4 w-4"})]})})]}),f.jsx("div",{className:"mt-6 text-center",children:f.jsxs("p",{className:"text-gray-600",children:["Don't have an account?"," ",f.jsx(W_,{to:"/register",className:"text-blue-600 hover:text-blue-700 font-medium",children:"Create one"})]})})]})})})},FP=()=>{const[e,t]=z.useState(""),[r,n]=z.useState(""),[i,a]=z.useState(""),[s,o]=z.useState(!1),[l,c]=z.useState(!1),[u,h]=z.useState(!1),[p,d]=z.useState(""),[v,g]=z.useState(""),{signUp:y}=Hi(),b=Gc(),E=async S=>{if(S.preventDefault(),h(!0),d(""),g(""),r!==i){d("Passwords do not match"),h(!1);return}try{const{error:P}=await y(e,r);if(P)throw P;g("Account created successfully! You can now sign in."),setTimeout(()=>b("/login"),2e3)}catch(P){d(P.message)}finally{h(!1)}};return f.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center p-4",children:f.jsx("div",{className:"max-w-md w-full",children:f.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[f.jsxs("div",{className:"text-center mb-8",children:[f.jsx("div",{className:"w-16 h-16 bg-blue-600 rounded-2xl flex items-center justify-center mx-auto mb-4",children:f.jsx("span",{className:"text-2xl font-bold text-white",children:"DT"})}),f.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Create Account"}),f.jsx("p",{className:"text-gray-600 mt-2",children:"Start managing your supplier dues today"})]}),p&&f.jsx("div",{className:"mb-4 p-3 rounded-lg bg-red-50 border border-red-200 text-red-600 text-sm",children:p}),v&&f.jsx("div",{className:"mb-4 p-3 rounded-lg bg-green-50 border border-green-200 text-green-600 text-sm",children:v}),f.jsxs("form",{onSubmit:E,className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),f.jsxs("div",{className:"relative",children:[f.jsx(Cc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),f.jsx("input",{type:"email",value:e,onChange:S=>t(S.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Enter your email",required:!0})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),f.jsxs("div",{className:"relative",children:[f.jsx(Am,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),f.jsx("input",{type:s?"text":"password",value:r,onChange:S=>n(S.target.value),className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Create a password",required:!0,minLength:6}),f.jsx("button",{type:"button",onClick:()=>o(!s),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:s?f.jsx(Em,{className:"h-5 w-5"}):f.jsx(Tm,{className:"h-5 w-5"})})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password"}),f.jsxs("div",{className:"relative",children:[f.jsx(Am,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),f.jsx("input",{type:l?"text":"password",value:i,onChange:S=>a(S.target.value),className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors",placeholder:"Confirm your password",required:!0,minLength:6}),f.jsx("button",{type:"button",onClick:()=>c(!l),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:l?f.jsx(Em,{className:"h-5 w-5"}):f.jsx(Tm,{className:"h-5 w-5"})})]})]}),f.jsx("button",{type:"submit",disabled:u,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg font-medium hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center",children:u?f.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}):f.jsxs(f.Fragment,{children:["Create Account",f.jsx(qf,{className:"ml-2 h-4 w-4"})]})})]}),f.jsx("div",{className:"mt-6 text-center",children:f.jsxs("p",{className:"text-gray-600",children:["Already have an account?"," ",f.jsx(W_,{to:"/login",className:"text-blue-600 hover:text-blue-700 font-medium",children:"Sign in"})]})})]})})})},DP=()=>{const{user:e}=Hi(),t=Gc(),[r,n]=z.useState({totalDues:0,totalSuppliers:0,totalTransactions:0,pendingPayments:0,recentTransactions:[],upcomingDues:[]}),[i,a]=z.useState(!0);z.useEffect(()=>{s()},[e]);const s=async()=>{if(e)try{const{count:c}=await et.from("suppliers").select("*",{count:"exact",head:!0}).eq("user_id",e.id),{count:u}=await et.from("transactions").select("*",{count:"exact",head:!0}).eq("user_id",e.id),{data:h}=await et.from("transactions").select("*").eq("user_id",e.id),p=new Map;h==null||h.forEach(S=>{const P=S.supplier_id;p.has(P)||p.set(P,0),S.type==="new_purchase"?p.set(P,p.get(P)+parseFloat(S.amount)):(S.type==="pay_due"||S.type==="settle_bill")&&p.set(P,p.get(P)-parseFloat(S.amount))});let d=0,v=0;p.forEach(S=>{S>.01&&(d+=S,v++)});const{data:g}=await et.from("transactions").select(`
          *,
          supplier:suppliers(name),
          owner:business_owners(owner_name)
        `).eq("user_id",e.id).order("created_at",{ascending:!1}).limit(5),{data:y}=await et.from("transactions").select(`
          *,
          supplier:suppliers(name),
          owner:business_owners(owner_name)
        `).eq("user_id",e.id).order("created_at",{ascending:!1}),b=new Map;y==null||y.forEach(S=>{var C;const P=S.supplier_id,L=(C=S.supplier)==null?void 0:C.name;b.has(P)||b.set(P,{supplier_id:P,supplier_name:L,balance:0,lastTransaction:S,dueDate:null});const q=b.get(P);S.type==="new_purchase"?(q.balance+=parseFloat(S.amount),S.due_date&&(!q.dueDate||S.due_date<q.dueDate)&&(q.dueDate=S.due_date)):(S.type==="pay_due"||S.type==="settle_bill")&&(q.balance-=parseFloat(S.amount))});const E=Array.from(b.values()).filter(S=>S.balance>.01).map(S=>({id:`outstanding-${S.supplier_id}`,supplier_id:S.supplier_id,supplier:{name:S.supplier_name},amount:S.balance.toFixed(2),description:"Outstanding balance",due_date:S.dueDate,type:"outstanding"})).sort((S,P)=>S.due_date&&!P.due_date?-1:!S.due_date&&P.due_date?1:S.due_date&&P.due_date&&S.due_date!==P.due_date?S.due_date.localeCompare(P.due_date):parseFloat(P.amount)-parseFloat(S.amount)).slice(0,10);n({totalDues:Math.max(0,d),totalSuppliers:c||0,totalTransactions:u||0,pendingPayments:v,recentTransactions:g||[],upcomingDues:E||[]})}catch(c){console.error("Error fetching dashboard data:",c)}finally{a(!1)}},o=c=>{switch(c){case"new_purchase":return f.jsx(Mg,{className:"h-4 w-4 text-red-500"});case"pay_due":case"settle_bill":return f.jsx(Ig,{className:"h-4 w-4 text-green-500"});default:return f.jsx(ja,{className:"h-4 w-4 text-gray-500"})}},l=c=>{switch(c){case"new_purchase":return"Purchase";case"pay_due":return"Payment";case"settle_bill":return"Settlement";default:return c}};return i?f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):f.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[f.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:f.jsxs("div",{children:[f.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Dashboard"}),f.jsx("p",{className:"text-gray-600 text-sm",children:"Your business overview"})]})}),f.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4",children:[f.jsx("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:f.jsxs("div",{className:"text-center",children:[f.jsx(uc,{className:"h-6 w-6 text-red-500 mx-auto mb-2"}),f.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Outstanding"}),f.jsxs("p",{className:"text-lg font-bold text-red-600",children:["‚Çπ",Math.round(r.totalDues).toLocaleString()]})]})}),f.jsx("button",{onClick:()=>t("/suppliers"),className:"bg-white rounded-lg p-4 border border-gray-200 hover:border-blue-300 hover:bg-blue-50 transition-colors w-full",children:f.jsxs("div",{className:"text-center",children:[f.jsx(Qa,{className:"h-6 w-6 text-blue-500 mx-auto mb-2"}),f.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Suppliers"}),f.jsx("p",{className:"text-lg font-bold text-blue-600",children:r.totalSuppliers})]})}),f.jsx("button",{onClick:()=>t("/transactions"),className:"bg-white rounded-lg p-4 border border-gray-200 hover:border-green-300 hover:bg-green-50 transition-colors w-full",children:f.jsxs("div",{className:"text-center",children:[f.jsx(ja,{className:"h-6 w-6 text-green-500 mx-auto mb-2"}),f.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Transactions"}),f.jsx("p",{className:"text-lg font-bold text-green-600",children:r.totalTransactions})]})}),f.jsx("div",{className:"bg-white rounded-lg p-4 border border-gray-200",children:f.jsxs("div",{className:"text-center",children:[f.jsx(d1,{className:"h-6 w-6 text-orange-500 mx-auto mb-2"}),f.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Pending"}),f.jsx("p",{className:"text-lg font-bold text-orange-600",children:r.pendingPayments})]})})]}),f.jsxs("div",{className:"space-y-4 lg:grid lg:grid-cols-2 lg:gap-6 lg:space-y-0",children:[f.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[f.jsxs("div",{className:"flex items-center justify-between mb-3",children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Recent Activity"}),f.jsx("button",{onClick:()=>t("/transactions"),className:"text-blue-600 text-sm font-medium",children:"View All"})]}),f.jsx("div",{className:"space-y-3",children:r.recentTransactions.length>0?r.recentTransactions.slice(0,4).map(c=>{var u;return f.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[f.jsxs("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[o(c.type),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("p",{className:"font-medium text-gray-900 truncate",children:(u=c.supplier)==null?void 0:u.name}),f.jsx("p",{className:"text-sm text-gray-500",children:l(c.type)})]})]}),f.jsx("div",{className:"text-right",children:f.jsxs("p",{className:`font-medium ${c.type==="new_purchase"?"text-red-600":"text-green-600"}`,children:[c.type==="new_purchase"?"+":"-","‚Çπ",Math.round(parseFloat(c.amount)).toLocaleString()]})})]},c.id)}):f.jsx("p",{className:"text-gray-500 text-center py-6 text-sm",children:"No transactions yet"})})]}),f.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[f.jsxs("div",{className:"flex items-center justify-between mb-3",children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Payments Due"}),f.jsx(d1,{className:"h-5 w-5 text-orange-400"})]}),f.jsx("div",{className:"space-y-3",children:r.upcomingDues.length>0?r.upcomingDues.slice(0,4).map(c=>{var u;return f.jsxs("div",{className:"flex items-center justify-between p-3 bg-orange-50 rounded-lg border border-orange-100",onClick:()=>t(`/suppliers/${c.supplier_id}`),children:[f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("p",{className:"font-medium text-gray-900 truncate",children:(u=c.supplier)==null?void 0:u.name}),f.jsx("p",{className:"text-sm text-gray-500",children:"Outstanding balance"})]}),f.jsx("div",{className:"text-right",children:f.jsxs("p",{className:"font-medium text-red-600",children:["‚Çπ",Math.round(parseFloat(c.amount)).toLocaleString()]})})]},c.id)}):f.jsxs("div",{className:"text-center py-6",children:[f.jsx(d1,{className:"h-8 w-8 text-green-500 mx-auto mb-2 opacity-50"}),f.jsx("p",{className:"text-green-600 text-sm font-medium",children:"All payments up to date!"})]})})]})]})]})},IP=()=>{const{user:e}=Hi(),t=Gc(),r=z_(),[n,i]=z.useState([]),[a,s]=z.useState(!0),[o,l]=z.useState(""),[c,u]=z.useState("dues_desc"),[h,p]=z.useState("all"),[d,v]=z.useState("grid"),[g,y]=z.useState("all"),[b,E]=z.useState(!1),[S,P]=z.useState(!1),[L,q]=z.useState({name:"",contact_person:"",phone:"",email:"",address:""});z.useEffect(()=>{C()},[e]),z.useEffect(()=>{new URLSearchParams(r.search).get("add")==="true"&&(P(!0),t("/suppliers",{replace:!0}))},[r.search,t]);const C=async()=>{if(e)try{const{data:_,error:j}=await et.from("suppliers").select("*").eq("user_id",e.id);if(j)throw j;const H=await Promise.all((_||[]).map(async X=>{const{data:ce}=await et.from("transactions").select("amount, type").eq("supplier_id",X.id).eq("user_id",e.id),pe=(ce||[]).reduce((ye,me)=>me.type==="purchase"?ye+me.amount:ye-me.amount,0);return{...X,dueAmount:Math.max(0,pe)}}));i(H)}catch(_){console.error("Error fetching suppliers:",_)}finally{s(!1)}},R=async _=>{if(_.preventDefault(),!!e)try{const{error:j}=await et.from("suppliers").insert([{...L,user_id:e.id}]);if(j)throw j;await C(),q({name:"",contact_person:"",phone:"",email:"",address:""}),P(!1)}catch(j){console.error("Error adding supplier:",j)}},k=()=>{q({name:"",contact_person:"",phone:"",email:"",address:""}),P(!1)},G=n.filter(_=>{var ce,pe,ye;const j=_.name.toLowerCase().includes(o.toLowerCase())||((ce=_.contact_person)==null?void 0:ce.toLowerCase().includes(o.toLowerCase()))||((pe=_.phone)==null?void 0:pe.includes(o))||((ye=_.email)==null?void 0:ye.toLowerCase().includes(o.toLowerCase())),H=g==="all"||g==="high_dues"&&_.dueAmount>1e3||g==="recent"&&new Date(_.created_at).getTime()>Date.now()-7*24*60*60*1e3||g==="favorites"&&_.dueAmount>5e3,X=h==="all"||h==="with_dues"&&_.dueAmount>0||h==="no_dues"&&_.dueAmount===0||h==="high_dues"&&_.dueAmount>1e3||h==="recent"&&new Date(_.created_at).getTime()>Date.now()-7*24*60*60*1e3;return j&&H&&X}).sort((_,j)=>{switch(c){case"dues_desc":return j.dueAmount-_.dueAmount;case"dues_asc":return _.dueAmount-j.dueAmount;case"name_asc":return _.name.localeCompare(j.name);case"name_desc":return j.name.localeCompare(_.name);case"recent":return new Date(j.created_at).getTime()-new Date(_.created_at).getTime();case"oldest":return new Date(_.created_at).getTime()-new Date(j.created_at).getTime();default:return j.dueAmount-_.dueAmount}});return a?f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):f.jsxs("div",{className:"min-h-screen bg-gray-50 p-4 sm:p-6 max-w-7xl mx-auto",children:[f.jsxs("div",{className:"bg-white rounded-xl shadow-sm p-4 sm:p-6 mb-4 sm:mb-6",children:[f.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6",children:[f.jsxs("div",{className:"text-center sm:text-left",children:[f.jsxs("div",{className:"flex items-center justify-center sm:justify-start gap-3 mb-2",children:[f.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center",children:f.jsx(Qa,{className:"h-5 w-5 text-white"})}),f.jsxs("div",{children:[f.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Suppliers"}),f.jsx("p",{className:"text-xs text-blue-600 font-medium",children:"v1.2 - The Supplier Nav Update"})]})]}),f.jsx("p",{className:"text-gray-600 text-sm sm:text-base",children:"Advanced supplier management with smart navigation"})]}),f.jsxs("div",{className:"flex items-center gap-2 bg-gray-100 rounded-lg p-1",children:[f.jsx("button",{onClick:()=>v("grid"),className:`p-2 rounded-md transition-colors ${d==="grid"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,title:"Grid View",children:f.jsx(u8,{className:"h-4 w-4"})}),f.jsx("button",{onClick:()=>v("list"),className:`p-2 rounded-md transition-colors ${d==="list"?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"}`,title:"List View",children:f.jsx(f8,{className:"h-4 w-4"})})]})]}),f.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:[{id:"all",label:"All Suppliers",icon:Qa,count:n.length},{id:"high_dues",label:"High Dues",icon:Es,count:n.filter(_=>_.dueAmount>1e3).length},{id:"recent",label:"Recent",icon:xf,count:n.filter(_=>new Date(_.created_at).getTime()>Date.now()-7*24*60*60*1e3).length},{id:"favorites",label:"Top Partners",icon:Qo,count:n.filter(_=>_.dueAmount>5e3).length}].map(_=>{const j=_.icon;return f.jsxs("button",{onClick:()=>y(_.id),className:`flex items-center gap-2 px-4 py-2 rounded-xl font-medium transition-all ${g===_.id?"bg-blue-500 text-white shadow-lg":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[f.jsx(j,{className:"h-4 w-4"}),f.jsx("span",{className:"text-sm",children:_.label}),f.jsx("span",{className:"text-xs bg-white/20 px-2 py-0.5 rounded-full",children:_.count})]},_.id)})}),f.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[f.jsxs("div",{className:"relative flex-1",children:[f.jsx(G_,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),f.jsx("input",{type:"text",placeholder:"Search by name, contact, phone, or email...",value:o,onChange:_=>l(_.target.value),className:"w-full pl-12 pr-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-gray-50 text-base"})]}),f.jsxs("button",{onClick:()=>E(!b),className:`flex items-center gap-2 px-4 py-3 rounded-xl font-medium transition-colors ${b||h!=="all"||c!=="dues_desc"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[f.jsx(Rg,{className:"h-4 w-4"}),f.jsx("span",{className:"hidden sm:inline",children:"Filters"})]})]}),b&&f.jsx("div",{className:"mt-4 p-4 bg-gray-50 rounded-xl border border-gray-200",children:f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sort By"}),f.jsxs("select",{value:c,onChange:_=>u(_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[f.jsx("option",{value:"dues_desc",children:"Highest Dues"}),f.jsx("option",{value:"dues_asc",children:"Lowest Dues"}),f.jsx("option",{value:"name_asc",children:"Name A-Z"}),f.jsx("option",{value:"name_desc",children:"Name Z-A"}),f.jsx("option",{value:"recent",children:"Most Recent"}),f.jsx("option",{value:"oldest",children:"Oldest First"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter By"}),f.jsxs("select",{value:h,onChange:_=>p(_.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[f.jsx("option",{value:"all",children:"All Suppliers"}),f.jsx("option",{value:"with_dues",children:"With Outstanding Dues"}),f.jsx("option",{value:"no_dues",children:"Fully Paid"}),f.jsx("option",{value:"high_dues",children:"High Dues (>‚Çπ1000)"}),f.jsx("option",{value:"recent",children:"Added This Week"})]})]}),f.jsx("div",{className:"flex items-end",children:f.jsx("button",{onClick:()=>{u("dues_desc"),p("all"),y("all"),l("")},className:"w-full px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors font-medium",children:"Clear All Filters"})})]})}),f.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-3 mt-6",children:[f.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 p-4 rounded-xl text-center",children:[f.jsx("p",{className:"text-2xl font-bold text-blue-600",children:n.length}),f.jsx("p",{className:"text-xs font-medium text-blue-700",children:"Total Suppliers"})]}),f.jsxs("div",{className:"bg-gradient-to-br from-red-50 to-red-100 p-4 rounded-xl text-center",children:[f.jsx("p",{className:"text-2xl font-bold text-red-600",children:n.filter(_=>_.dueAmount>0).length}),f.jsx("p",{className:"text-xs font-medium text-red-700",children:"With Dues"})]}),f.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 p-4 rounded-xl text-center",children:[f.jsx("p",{className:"text-2xl font-bold text-green-600",children:n.filter(_=>_.dueAmount===0).length}),f.jsx("p",{className:"text-xs font-medium text-green-700",children:"All Clear"})]}),f.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 p-4 rounded-xl text-center",children:[f.jsxs("p",{className:"text-lg font-bold text-purple-600",children:["‚Çπ",Math.round(n.reduce((_,j)=>_+j.dueAmount,0)).toLocaleString()]}),f.jsx("p",{className:"text-xs font-medium text-purple-700",children:"Total Dues"})]})]})]}),f.jsx("div",{className:d==="grid"?"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6":"space-y-4",children:G.length===0?f.jsxs("div",{className:"col-span-full text-center py-16 bg-white rounded-xl shadow-sm",children:[f.jsx("div",{className:"w-20 h-20 mx-auto mb-6 bg-gray-100 rounded-full flex items-center justify-center",children:f.jsx(Qa,{className:"h-10 w-10 text-gray-400"})}),f.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No suppliers found"}),f.jsx("p",{className:"text-gray-500 mb-6",children:o||g!=="all"?"Try adjusting your search or filters":"Add your first supplier to get started"}),!o&&g==="all"&&f.jsx("button",{onClick:()=>P(!0),className:"bg-blue-500 text-white px-6 py-3 rounded-xl hover:bg-blue-600 transition-colors",children:"Add Your First Supplier"})]}):G.map(_=>f.jsx("div",{onClick:()=>t(`/supplier/${_.id}`),className:`bg-white rounded-xl shadow-sm hover:shadow-lg transition-all duration-200 cursor-pointer border border-gray-100 hover:border-blue-200 ${d==="list"?"p-4 flex items-center gap-4":"p-4 sm:p-6"}`,children:d==="grid"?f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"flex items-start justify-between mb-4",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center text-white font-bold text-lg",children:_.name.charAt(0).toUpperCase()}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold text-gray-900 text-lg leading-tight",children:_.name}),_.contact_person&&f.jsx("p",{className:"text-gray-600 text-sm",children:_.contact_person})]})]}),_.dueAmount>1e3&&f.jsx("div",{className:"bg-red-100 text-red-600 px-2 py-1 rounded-lg text-xs font-medium",children:"High Due"})]}),f.jsxs("div",{className:"space-y-2 mb-4",children:[_.phone&&f.jsxs("div",{className:"flex items-center gap-2 text-gray-600 text-sm",children:[f.jsx(gh,{className:"h-4 w-4"}),f.jsx("span",{children:_.phone})]}),_.email&&f.jsxs("div",{className:"flex items-center gap-2 text-gray-600 text-sm",children:[f.jsx(Cc,{className:"h-4 w-4"}),f.jsx("span",{className:"truncate",children:_.email})]}),_.address&&f.jsxs("div",{className:"flex items-center gap-2 text-gray-600 text-sm",children:[f.jsx(Pm,{className:"h-4 w-4"}),f.jsx("span",{className:"truncate",children:_.address})]})]}),f.jsx("div",{className:"border-t border-gray-100 pt-4",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("span",{className:"text-sm text-gray-600",children:"Outstanding Due"}),f.jsxs("span",{className:`font-bold text-lg ${_.dueAmount>0?"text-red-600":"text-green-600"}`,children:["‚Çπ",_.dueAmount.toLocaleString()]})]})})]}):f.jsxs(f.Fragment,{children:[f.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center text-white font-bold text-lg flex-shrink-0",children:_.name.charAt(0).toUpperCase()}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("div",{className:"flex items-center justify-between mb-1",children:[f.jsx("h3",{className:"font-semibold text-gray-900 truncate",children:_.name}),f.jsxs("span",{className:`font-bold ${_.dueAmount>0?"text-red-600":"text-green-600"}`,children:["‚Çπ",_.dueAmount.toLocaleString()]})]}),_.contact_person&&f.jsx("p",{className:"text-gray-600 text-sm truncate",children:_.contact_person}),_.phone&&f.jsx("p",{className:"text-gray-500 text-xs",children:_.phone})]})]})},_.id))}),S&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[60]",children:f.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md",children:[f.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[f.jsx("h2",{className:"text-xl font-bold text-gray-900",children:"Add New Supplier"}),f.jsx("button",{onClick:k,className:"text-gray-400 hover:text-gray-600 text-2xl",children:"√ó"})]}),f.jsxs("form",{onSubmit:R,className:"p-6 space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Supplier Name *"}),f.jsx("input",{type:"text",required:!0,value:L.name,onChange:_=>q({...L,name:_.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter supplier name"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Person"}),f.jsx("input",{type:"text",value:L.contact_person,onChange:_=>q({...L,contact_person:_.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter contact person name"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),f.jsx("input",{type:"tel",value:L.phone,onChange:_=>q({...L,phone:_.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter phone number"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email Address"}),f.jsx("input",{type:"email",value:L.email,onChange:_=>q({...L,email:_.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter email address"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),f.jsx("textarea",{value:L.address,onChange:_=>q({...L,address:_.target.value}),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500",rows:3,placeholder:"Enter full address"})]}),f.jsxs("div",{className:"flex flex-col-reverse sm:flex-row gap-3 pt-6",children:[f.jsx("button",{type:"button",onClick:k,className:"order-2 sm:order-1 flex-1 px-6 py-4 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 font-medium transition-colors",children:"Cancel"}),f.jsx("button",{type:"submit",className:"order-1 sm:order-2 flex-1 px-6 py-4 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl hover:from-blue-600 hover:to-blue-700 font-medium shadow-lg transition-all duration-200",children:"Add Supplier"})]})]})]})})]})};class mo{static getInstance(){return mo.instance||(mo.instance=new mo),mo.instance}async getBusinessOwners(t){try{const{data:r,error:n}=await et.from("business_owners").select("*").eq("user_id",t).eq("is_active",!0).order("is_primary",{ascending:!1}).order("created_at",{ascending:!0});if(n)throw n;return r||[]}catch(r){return console.error("Error fetching business owners:",r),[]}}async getPrimaryOwner(t){try{const{data:r,error:n}=await et.from("business_owners").select("*").eq("user_id",t).eq("is_primary",!0).eq("is_active",!0).single();if(n&&n.code!=="PGRST116")throw n;return r||null}catch(r){return console.error("Error fetching primary owner:",r),null}}async createBusinessOwner(t,r){try{const{data:n,error:i}=await et.from("business_owners").insert([{user_id:t,owner_name:r.owner_name,role:r.role||"Owner",is_primary:!1,is_active:!0}]).select().single();if(i)throw i;return{success:!0,data:n}}catch(n){return console.error("Error creating business owner:",n),{success:!1,error:n.message||"Failed to create business owner"}}}async updateBusinessOwner(t,r){try{const{data:n,error:i}=await et.from("business_owners").update({owner_name:r.owner_name,role:r.role,updated_at:new Date().toISOString()}).eq("id",t).select().single();if(i)throw i;return{success:!0,data:n}}catch(n){return console.error("Error updating business owner:",n),{success:!1,error:n.message||"Failed to update business owner"}}}async deactivateBusinessOwner(t){try{const{data:r,error:n}=await et.from("business_owners").select("is_primary").eq("id",t).single();if(n)throw n;if(r.is_primary)return{success:!1,error:"Cannot deactivate the primary owner"};const{error:i}=await et.from("business_owners").update({is_active:!1,updated_at:new Date().toISOString()}).eq("id",t);if(i)throw i;return{success:!0}}catch(r){return console.error("Error deactivating business owner:",r),{success:!1,error:r.message||"Failed to deactivate business owner"}}}async getOwnerStats(t){try{const{data:r,error:n}=await et.from("owner_transaction_stats").select("*").eq("user_id",t);if(n)throw n;return r||[]}catch(r){return console.error("Error fetching owner stats:",r),[]}}async ensurePrimaryOwner(t,r,n){try{const i=await this.getPrimaryOwner(t);if(i)return i;const a=await this.createBusinessOwner(t,{owner_name:n||r.split("@")[0],role:"Primary Owner",is_primary:!0});return a.success?a.data:null}catch(i){return console.error("Error ensuring primary owner:",i),null}}async updateTransactionOwner(t,r){try{const{error:n}=await et.from("transactions").update({owner_id:r}).eq("id",t);if(n)throw n;return{success:!0}}catch(n){return console.error("Error updating transaction owner:",n),{success:!1,error:n.message||"Failed to update transaction owner"}}}async updateSupplierOwner(t,r){try{const{error:n}=await et.from("suppliers").update({added_by_owner_id:r}).eq("id",t);if(n)throw n;return{success:!0}}catch(n){return console.error("Error updating supplier owner:",n),{success:!1,error:n.message||"Failed to update supplier owner"}}}}const MP=()=>{const{id:e}=n8(),{user:t}=Hi(),r=Gc(),[n,i]=z.useState(null),[a,s]=z.useState([]),[o,l]=z.useState([]),[c,u]=z.useState(!0),[h,p]=z.useState(!1),[d,v]=z.useState(!1),[g,y]=z.useState(""),[b,E]=z.useState(""),[S,P]=z.useState(""),[L,q]=z.useState(""),[C,R]=z.useState(""),[k,G]=z.useState(""),[_,j]=z.useState(""),[H,X]=z.useState(0),[ce,pe]=z.useState(!1),[ye,me]=z.useState({name:"",contact_person:"",phone:"",email:"",address:""}),[be,Ue]=z.useState({totalPurchases:0,totalPaid:0,totalDue:0,transactionCount:0}),[Fe,A]=z.useState(!1),[F,O]=z.useState({show:!1,x:0,y:0,transaction:null}),[M,J]=z.useState(!1),[fe,ve]=z.useState(null),[ae,ue]=z.useState(""),[oe,le]=z.useState(""),Be=je=>{localStorage.setItem("shopsynk_last_selected_owner",je)},ge=()=>localStorage.getItem("shopsynk_last_selected_owner")||"";z.useEffect(()=>{e&&Q()},[e,t]),z.useEffect(()=>{const je=()=>{F.show&&ft()};if(F.show)return document.addEventListener("mousedown",je),()=>{document.removeEventListener("mousedown",je)}},[F.show]),z.useEffect(()=>{const je=()=>{v(!0)},nt=()=>{p(!0)};return window.addEventListener("openPurchaseModal",je),window.addEventListener("openPaymentModal",nt),()=>{window.removeEventListener("openPurchaseModal",je),window.removeEventListener("openPaymentModal",nt)}},[]);const Q=async()=>{if(!(!t||!e))try{const{data:je,error:nt}=await et.from("suppliers").select("*").eq("id",e).eq("user_id",t.id).single();if(nt)throw nt;const{data:ot,error:Ct}=await et.from("transactions").select(`
          *,
          owner:business_owners(owner_name)
        `).eq("supplier_id",e).eq("user_id",t.id).order("created_at",{ascending:!1});if(Ct)throw Ct;const ir=await mo.getInstance().getBusinessOwners(t.id);i(je),s(ot||[]),l(ir||[]);const ar=ge();ar&&ir&&ir.some(Tn=>Tn.id===ar)&&(E(ar),q(ar));let zt=0,at=0,$t=0;ot==null||ot.forEach(Tn=>{const Fr=parseFloat(Tn.amount.toString());Tn.type==="new_purchase"?(zt+=Fr,Tn.is_paid||($t+=Fr)):(Tn.type==="pay_due"||Tn.type==="settle_bill")&&(at+=Fr,$t-=Fr)}),X(Math.max(0,$t)),Ue({totalPurchases:zt,totalPaid:at,totalDue:Math.max(0,$t),transactionCount:(ot==null?void 0:ot.length)||0})}catch(je){console.error("Error fetching supplier data:",je)}finally{u(!1)}},tt=async je=>{if(je.preventDefault(),!(!t||!e||!g||!b))try{Be(b);const{error:nt}=await et.from("transactions").insert([{user_id:t.id,supplier_id:e,type:"pay_due",amount:parseFloat(g),description:_||"Payment made",is_paid:!0,owner_id:b}]);if(nt)throw nt;await Q(),p(!1),y(""),j("")}catch(nt){console.error("Error processing payment:",nt)}},Re=async je=>{if(je.preventDefault(),!(!t||!e||!S||!L))try{Be(L);const{error:nt}=await et.from("transactions").insert([{user_id:t.id,supplier_id:e,type:"new_purchase",amount:parseFloat(S),description:C||"New purchase",due_date:k||null,is_paid:!1,owner_id:L}]);if(nt)throw nt;await Q(),v(!1),P(""),R(""),G("")}catch(nt){console.error("Error adding purchase:",nt)}},it=async je=>{if(je.preventDefault(),!(!t||!e))try{const{error:nt}=await et.from("suppliers").update(ye).eq("id",e).eq("user_id",t.id);if(nt)throw nt;await Q(),pe(!1)}catch(nt){console.error("Error updating supplier:",nt)}},We=async()=>{if(!(!t||!e||!window.confirm(`Are you sure you want to delete ${n==null?void 0:n.name}? This will also delete all associated transactions. This action cannot be undone.`)))try{await et.from("transactions").delete().eq("supplier_id",e).eq("user_id",t.id);const{error:nt}=await et.from("suppliers").delete().eq("id",e).eq("user_id",t.id);if(nt)throw nt;r("/suppliers")}catch(nt){console.error("Error deleting supplier:",nt)}},st=()=>{n&&(me({name:n.name,contact_person:n.contact_person||"",phone:n.phone||"",email:n.email||"",address:n.address||""}),pe(!0))},Ze=(je,nt)=>{je.preventDefault(),O({show:!0,x:je.clientX,y:je.clientY,transaction:nt})},Pt=je=>{O({show:!0,x:window.innerWidth/2,y:window.innerHeight/2,transaction:je})},ft=()=>{O({show:!1,x:0,y:0,transaction:null})},Lt=()=>{F.transaction&&(ve(F.transaction),ue(F.transaction.amount.toString()),le(F.transaction.description||""),J(!0),ft())},At=async()=>{if(!F.transaction||!t)return;if(!window.confirm("Are you sure you want to delete this transaction? This action cannot be undone.")){ft();return}try{const{error:nt}=await et.from("transactions").delete().eq("id",F.transaction.id).eq("user_id",t.id);if(nt)throw nt;await Q(),ft()}catch(nt){console.error("Error deleting transaction:",nt)}},Et=(je,nt=500)=>{const[ot,Ct]=z.useState(!1),St=z.useRef(),ir=z.useRef(),ar=z.useCallback(at=>{at.type==="mousedown"&&at.button!==0||(St.current=setTimeout(()=>{je(),Ct(!0)},nt),ir.current=at.target)},[je,nt]),zt=z.useCallback(at=>{St.current&&clearTimeout(St.current),ot&&(at.preventDefault(),at.stopPropagation()),Ct(!1)},[ot]);return{onMouseDown:at=>ar(at),onTouchStart:at=>ar(at),onMouseUp:at=>zt(at),onTouchEnd:at=>zt(at),onMouseLeave:at=>zt(at)}},Kt=async je=>{if(je.preventDefault(),!(!fe||!t||!ae))try{const{error:nt}=await et.from("transactions").update({amount:parseFloat(ae),description:oe||null}).eq("id",fe.id).eq("user_id",t.id);if(nt)throw nt;await Q(),J(!1),ve(null),ue(""),le("")}catch(nt){console.error("Error updating transaction:",nt)}},yt=je=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(je),pt=je=>new Date(je).toLocaleDateString("en-IN",{year:"numeric",month:"short",day:"numeric"}),_t=je=>{switch(je){case"new_purchase":return f.jsx(Mg,{className:"h-5 w-5 text-red-500"});case"pay_due":case"settle_bill":return f.jsx(Ig,{className:"h-5 w-5 text-green-500"});default:return f.jsx(ja,{className:"h-5 w-5 text-gray-500"})}},mt=je=>{switch(je){case"new_purchase":return"Purchase";case"pay_due":return"Payment";case"settle_bill":return"Settlement";default:return je}},Qt=je=>{switch(je){case"new_purchase":return"text-red-600";case"pay_due":case"settle_bill":return"text-green-600";default:return"text-gray-600"}},Ut=()=>{n!=null&&n.phone&&(window.location.href=`tel:${n.phone}`)};if(c)return f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})});if(!n)return f.jsxs("div",{className:"text-center py-12",children:[f.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Supplier not found"}),f.jsx("button",{onClick:()=>r("/suppliers"),className:"text-blue-600 hover:text-blue-700",children:"Back to Suppliers"})]});const ht=({transaction:je})=>{var ot;const nt=Et(()=>Pt(je));return f.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors cursor-pointer select-none",onContextMenu:Ct=>Ze(Ct,je),...nt,children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center space-x-3",children:[_t(je.type),f.jsxs("div",{children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("span",{className:"font-medium text-gray-900",children:mt(je.type)}),!je.is_paid&&je.type==="new_purchase"&&f.jsx("span",{className:"px-2 py-1 text-xs font-medium bg-red-100 text-red-700 rounded-full",children:"Unpaid"})]}),f.jsx("p",{className:"text-gray-600 text-sm",children:je.description}),((ot=je.owner)==null?void 0:ot.owner_name)&&f.jsxs("p",{className:"text-xs text-blue-600 mt-1",children:[je.type==="new_purchase"?"Purchased by: ":"Paid by: ",je.owner.owner_name]}),f.jsxs("div",{className:"flex items-center space-x-4 mt-1 text-xs text-gray-500",children:[f.jsxs("span",{className:"flex items-center",children:[f.jsx(mc,{className:"h-3 w-3 mr-1"}),pt(je.created_at)]}),je.due_date&&f.jsxs("span",{children:["Due: ",pt(je.due_date)]})]})]})]}),f.jsx("div",{className:"text-right",children:f.jsxs("p",{className:`text-lg font-semibold ${Qt(je.type)}`,children:[je.type==="new_purchase"?"+":"-",yt(parseFloat(je.amount.toString()))]})})]})},je.id)};return f.jsxs("div",{className:"min-h-screen bg-gray-50",children:[f.jsx("div",{className:"bg-white shadow-sm sticky top-0 z-30",children:f.jsxs("div",{className:"flex items-center px-4 py-3",children:[f.jsx("button",{onClick:()=>r("/suppliers"),className:"p-2 hover:bg-gray-100 rounded-full transition-colors mr-2",children:f.jsx(fl,{className:"h-5 w-5 text-gray-600"})}),f.jsxs("button",{onClick:()=>A(!0),className:"flex items-center space-x-3 flex-1 text-left hover:bg-gray-50 p-2 rounded-lg transition-colors",children:[f.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center text-white font-semibold",children:n.name.charAt(0).toUpperCase()}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsx("h1",{className:"text-lg font-semibold text-gray-900 truncate",children:n.name}),f.jsx("p",{className:"text-sm text-gray-500 truncate",children:n.contact_person?`Contact: ${n.contact_person}`:"Business Supplier"})]})]}),f.jsx("button",{onClick:n.phone?Ut:void 0,className:`p-3 rounded-full transition-colors ${n.phone?"hover:bg-green-100 text-green-600 cursor-pointer":"text-gray-300 cursor-not-allowed"}`,disabled:!n.phone,title:n.phone?`Call ${n.phone}`:"No phone number available",children:f.jsx(gh,{className:"h-5 w-5"})})]})}),Fe&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[60] flex items-center justify-center p-4",children:f.jsxs("div",{className:"bg-white rounded-xl w-full max-w-md max-h-[90vh] overflow-hidden",children:[f.jsxs("div",{className:"bg-blue-500 text-white p-6 text-center",children:[f.jsx("div",{className:"w-24 h-24 bg-white bg-opacity-20 rounded-full flex items-center justify-center text-3xl font-bold mx-auto mb-3",children:n.name.charAt(0).toUpperCase()}),f.jsx("h2",{className:"text-xl font-semibold",children:n.name}),n.contact_person&&f.jsx("p",{className:"text-blue-100 text-sm mt-1",children:n.contact_person})]}),f.jsxs("div",{className:"p-4 space-y-4",children:[n.phone&&f.jsxs("div",{className:"flex items-center space-x-4",children:[f.jsx("div",{className:"w-10 h-10 bg-green-100 rounded-full flex items-center justify-center",children:f.jsx(gh,{className:"h-5 w-5 text-green-600"})}),f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"font-medium text-gray-900",children:n.phone}),f.jsx("p",{className:"text-sm text-gray-500",children:"Mobile"})]}),f.jsx("button",{onClick:Ut,className:"bg-green-500 text-white px-4 py-2 rounded-full hover:bg-green-600 transition-colors",children:"Call"})]}),n.email&&f.jsxs("div",{className:"flex items-center space-x-4",children:[f.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center",children:f.jsx(Cc,{className:"h-5 w-5 text-blue-600"})}),f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"font-medium text-gray-900",children:n.email}),f.jsx("p",{className:"text-sm text-gray-500",children:"Email"})]})]}),n.address&&f.jsxs("div",{className:"flex items-start space-x-4",children:[f.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:f.jsx(Pm,{className:"h-5 w-5 text-purple-600"})}),f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"font-medium text-gray-900",children:n.address}),f.jsx("p",{className:"text-sm text-gray-500",children:"Address"})]})]}),f.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[f.jsx("p",{className:"text-sm text-gray-600",children:"Outstanding Amount"}),f.jsx("p",{className:`text-2xl font-bold ${be.totalDue>0?"text-red-600":"text-green-600"}`,children:yt(be.totalDue)})]})]}),f.jsxs("div",{className:"p-4 border-t border-gray-200 space-y-3",children:[f.jsxs("div",{className:"flex space-x-3",children:[f.jsxs("button",{onClick:()=>{A(!1),st()},className:"flex-1 bg-blue-500 text-white py-3 rounded-lg hover:bg-blue-600 transition-colors flex items-center justify-center",children:[f.jsx(So,{className:"h-4 w-4 mr-2"}),"Edit Profile"]}),f.jsxs("button",{onClick:()=>{A(!1),We()},className:"flex-1 bg-red-500 text-white py-3 rounded-lg hover:bg-red-600 transition-colors flex items-center justify-center",children:[f.jsx(kc,{className:"h-4 w-4 mr-2"}),"Delete Profile"]})]}),f.jsx("button",{onClick:()=>A(!1),className:"w-full bg-gray-100 text-gray-700 py-3 rounded-lg hover:bg-gray-200 transition-colors",children:"Close"})]})]})}),f.jsxs("div",{className:"max-w-4xl mx-auto p-4 space-y-6",children:[f.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6",children:f.jsxs("div",{className:"text-center",children:[f.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Outstanding Amount"}),f.jsx("p",{className:`text-4xl font-bold ${be.totalDue>0?"text-red-600":"text-green-600"}`,children:yt(be.totalDue)})]})}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[f.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:f.jsx(H_,{className:"h-6 w-6 text-green-600"})}),f.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Total Paid"}),f.jsx("p",{className:"text-2xl font-bold text-green-600",children:yt(be.totalPaid)})]})}),f.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:f.jsx(h8,{className:"h-6 w-6 text-blue-600"})}),f.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Total Purchases"}),f.jsx("p",{className:"text-2xl font-bold text-blue-600",children:yt(be.totalPurchases)})]})}),f.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"w-12 h-12 bg-gray-100 rounded-xl flex items-center justify-center mx-auto mb-3",children:f.jsx(ja,{className:"h-6 w-6 text-gray-600"})}),f.jsx("p",{className:"text-sm font-medium text-gray-600 mb-1",children:"Total Transactions"}),f.jsx("p",{className:"text-2xl font-bold text-gray-900",children:be.transactionCount})]})})]}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[f.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[f.jsxs("div",{className:"flex items-center space-x-3 mb-6",children:[f.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:f.jsx(So,{className:"h-6 w-6 text-blue-600"})}),f.jsxs("div",{children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:n.name}),n.contact_person&&f.jsx("p",{className:"text-gray-600",children:n.contact_person})]})]}),f.jsxs("div",{className:"space-y-4",children:[n.phone&&f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx(gh,{className:"h-5 w-5 text-gray-400"}),f.jsx("span",{className:"text-gray-700",children:n.phone})]}),n.email&&f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx(Cc,{className:"h-5 w-5 text-gray-400"}),f.jsx("span",{className:"text-gray-700",children:n.email})]}),n.address&&f.jsxs("div",{className:"flex items-start space-x-3",children:[f.jsx(Pm,{className:"h-5 w-5 text-gray-400 mt-0.5"}),f.jsx("span",{className:"text-gray-700",children:n.address})]})]})]}),f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Payment Status"}),f.jsx(uc,{className:"h-5 w-5 text-gray-400"})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsx("span",{className:"text-sm text-gray-600",children:"Payment Rate"}),f.jsx("span",{className:"text-sm font-medium",children:be.totalPurchases>0?`${Math.round(be.totalPaid/be.totalPurchases*100)}%`:"0%"})]}),f.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:f.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-300",style:{width:be.totalPurchases>0?`${Math.min(be.totalPaid/be.totalPurchases*100,100)}%`:"0%"}})}),f.jsxs("div",{className:"text-center pt-2",children:[f.jsx("p",{className:`text-2xl font-bold ${be.totalDue>0?"text-red-600":"text-green-600"}`,children:be.totalDue>0?yt(be.totalDue):"All Clear!"}),f.jsx("p",{className:"text-sm text-gray-600 mt-1",children:be.totalDue>0?"Outstanding Balance":"No pending dues"})]})]})]})]}),f.jsx("div",{className:"lg:col-span-2",children:f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:[f.jsx("div",{className:"p-6 border-b border-gray-200",children:f.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Transaction History"})}),f.jsx("div",{className:"p-6",children:a.length>0?f.jsx("div",{className:"space-y-4",children:a.map(je=>f.jsx(ht,{transaction:je},je.id))}):f.jsxs("div",{className:"text-center py-8",children:[f.jsx(ja,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),f.jsx("p",{className:"text-gray-500",children:"No transactions yet with this supplier"})]})})]})})]}),h&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[60]",children:f.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[f.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:["Pay Due to ",n.name]}),f.jsxs("form",{onSubmit:tt,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Amount *"}),f.jsxs("div",{className:"relative",children:[f.jsx(uc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),f.jsx("input",{type:"number",step:"0.01",required:!0,value:g,onChange:je=>y(je.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Enter payment amount"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),f.jsx("input",{type:"text",value:_,onChange:je=>j(je.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Payment description (optional)"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Made By *"}),f.jsxs("select",{value:b,onChange:je=>E(je.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",children:[f.jsx("option",{value:"",children:"Select who made this payment"}),o.map(je=>f.jsxs("option",{value:je.id,children:[je.owner_name," ",je.is_primary&&"(Primary)"," - ",je.role]},je.id))]})]}),f.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:f.jsxs("p",{className:"text-sm text-green-700",children:["Current outstanding: ",f.jsx("span",{className:"font-medium",children:yt(H)})]})}),f.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[f.jsx("button",{type:"button",onClick:()=>p(!1),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),f.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Process Payment"})]})]})]})}),d&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[60]",children:f.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[f.jsxs("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:["New Purchase from ",n.name]}),f.jsxs("form",{onSubmit:Re,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Purchase Amount *"}),f.jsxs("div",{className:"relative",children:[f.jsx(uc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),f.jsx("input",{type:"number",step:"0.01",required:!0,value:S,onChange:je=>P(je.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter purchase amount"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),f.jsx("input",{type:"text",value:C,onChange:je=>R(je.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Purchase description (optional)"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Purchase Made By *"}),f.jsxs("select",{value:L,onChange:je=>q(je.target.value),required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[f.jsx("option",{value:"",children:"Select who made this purchase"}),o.map(je=>f.jsxs("option",{value:je.id,children:[je.owner_name," ",je.is_primary&&"(Primary)"," - ",je.role]},je.id))]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Due Date"}),f.jsx("input",{type:"date",value:k,onChange:je=>G(je.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),f.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[f.jsx("button",{type:"button",onClick:()=>v(!1),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),f.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Add Purchase"})]})]})]})}),ce&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[60] flex items-end sm:items-center justify-center p-4",children:f.jsxs("div",{className:"bg-white rounded-t-xl sm:rounded-xl w-full sm:max-w-md max-h-[90vh] overflow-y-auto",children:[f.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Edit Supplier"}),f.jsx("button",{onClick:()=>pe(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:"√ó"})]}),f.jsxs("form",{onSubmit:it,className:"p-4 space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supplier Name *"}),f.jsx("input",{type:"text",value:ye.name,onChange:je=>me({...ye,name:je.target.value}),required:!0,className:"w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Contact Person"}),f.jsx("input",{type:"text",value:ye.contact_person,onChange:je=>me({...ye,contact_person:je.target.value}),className:"w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone"}),f.jsx("input",{type:"tel",value:ye.phone,onChange:je=>me({...ye,phone:je.target.value}),className:"w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),f.jsx("input",{type:"email",value:ye.email,onChange:je=>me({...ye,email:je.target.value}),className:"w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address"}),f.jsx("textarea",{value:ye.address,onChange:je=>me({...ye,address:je.target.value}),rows:3,className:"w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),f.jsxs("div",{className:"flex space-x-3 pt-2",children:[f.jsx("button",{type:"button",onClick:()=>pe(!1),className:"flex-1 px-4 py-2.5 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Cancel"}),f.jsx("button",{type:"submit",className:"flex-1 px-4 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Update Supplier"})]})]})]})}),F.show&&f.jsxs("div",{className:"fixed z-[70] bg-white rounded-lg shadow-lg border border-gray-200 py-2 min-w-32",style:{left:Math.min(F.x,window.innerWidth-160),top:Math.min(F.y,window.innerHeight-100)},children:[f.jsxs("button",{onClick:Lt,className:"w-full text-left px-4 py-2 hover:bg-gray-50 flex items-center text-gray-700",children:[f.jsx(V_,{className:"h-4 w-4 mr-3 text-blue-600"}),"Edit Transaction"]}),f.jsxs("button",{onClick:At,className:"w-full text-left px-4 py-2 hover:bg-gray-50 flex items-center text-gray-700",children:[f.jsx(kc,{className:"h-4 w-4 mr-3 text-red-600"}),"Delete Transaction"]})]}),M&&fe&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-[60]",children:f.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[f.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:"Edit Transaction"}),f.jsxs("form",{onSubmit:Kt,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount *"}),f.jsxs("div",{className:"relative",children:[f.jsx(uc,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),f.jsx("input",{type:"number",step:"0.01",required:!0,value:ae,onChange:je=>ue(je.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter amount"})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),f.jsx("input",{type:"text",value:oe,onChange:je=>le(je.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Transaction description"})]}),f.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[f.jsxs("p",{className:"text-sm text-blue-700",children:["Type: ",f.jsx("span",{className:"font-medium",children:mt(fe.type)})]}),f.jsxs("p",{className:"text-sm text-blue-700",children:["Date: ",f.jsx("span",{className:"font-medium",children:pt(fe.created_at)})]})]}),f.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[f.jsx("button",{type:"button",onClick:()=>J(!1),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),f.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Update Transaction"})]})]})]})})]})]})},RP=({isOpen:e,onClose:t,onSubmit:r,suppliers:n,businessOwners:i,editingTransaction:a})=>{const[s,o]=z.useState({supplier_id:"",type:"new_purchase",amount:"",description:"",owner_id:""});z.useEffect(()=>{o(a?{supplier_id:a.supplier_id||"",type:a.type,amount:a.amount.toString(),description:a.description||"",owner_id:a.owner_id||""}:{supplier_id:"",type:"new_purchase",amount:"",description:"",owner_id:""})},[a,e]);const l=c=>{c.preventDefault(),r(s),a||o({supplier_id:"",type:"new_purchase",amount:"",description:"",owner_id:""})};return e?f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[60] flex items-end sm:items-center justify-center p-4",children:f.jsxs("div",{className:"bg-white rounded-t-xl sm:rounded-xl w-full sm:max-w-md max-h-[90vh] overflow-y-auto",children:[f.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-200",children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:a?"Edit Transaction":"Add Transaction"}),f.jsx("button",{onClick:t,className:"p-2 hover:bg-gray-100 rounded-lg",children:f.jsx(xl,{className:"h-5 w-5"})})]}),f.jsxs("form",{onSubmit:l,className:"p-4 space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Transaction Type"}),f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsxs("button",{type:"button",onClick:()=>o({...s,type:"new_purchase"}),className:`p-3 border rounded-lg text-center ${s.type==="new_purchase"?"border-red-500 bg-red-50 text-red-700":"border-gray-300 hover:bg-gray-50"}`,children:[f.jsx(q_,{className:"h-4 w-4 mx-auto mb-1"}),f.jsx("span",{className:"text-sm",children:"Purchase"})]}),f.jsxs("button",{type:"button",onClick:()=>o({...s,type:"pay_due"}),className:`p-3 border rounded-lg text-center ${s.type==="pay_due"?"border-green-500 bg-green-50 text-green-700":"border-gray-300 hover:bg-gray-50"}`,children:[f.jsx(uc,{className:"h-4 w-4 mx-auto mb-1"}),f.jsx("span",{className:"text-sm",children:"Payment"})]})]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Supplier"}),f.jsxs("select",{value:s.supplier_id,onChange:c=>o({...s,supplier_id:c.target.value}),required:!0,className:"w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[f.jsx("option",{value:"",children:"Select Supplier"}),n.map(c=>f.jsx("option",{value:c.id,children:c.name},c.id))]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount (‚Çπ)"}),f.jsx("input",{type:"number",value:s.amount,onChange:c=>o({...s,amount:c.target.value}),required:!0,min:"0",step:"0.01",placeholder:"Enter amount",className:"w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:s.type==="new_purchase"?"Purchased by":"Paid by"}),f.jsxs("select",{value:s.owner_id,onChange:c=>o({...s,owner_id:c.target.value}),className:"w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[f.jsx("option",{value:"",children:"Select person"}),i.map(c=>f.jsx("option",{value:c.id,children:c.owner_name},c.id))]})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description (Optional)"}),f.jsx("input",{type:"text",value:s.description,onChange:c=>o({...s,description:c.target.value}),placeholder:"Add description...",className:"w-full p-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),f.jsxs("div",{className:"flex space-x-3 pt-2",children:[f.jsx("button",{type:"button",onClick:t,className:"flex-1 px-4 py-2.5 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200",children:"Cancel"}),f.jsx("button",{type:"submit",className:"flex-1 px-4 py-2.5 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:a?"Update Transaction":"Add Transaction"})]})]})]})}):null},BP=()=>{const{user:e}=Hi(),[t,r]=z.useState([]),[n,i]=z.useState([]),[a,s]=z.useState([]),[o,l]=z.useState(!0),[c,u]=z.useState(""),[h,p]=z.useState("all"),[d,v]=z.useState(!1),[g,y]=z.useState(null),[b,E]=z.useState(null);z.useEffect(()=>{S()},[e]),z.useEffect(()=>{const _=j=>{b&&!j.target.closest(".dropdown-menu")&&E(null)};return document.addEventListener("mousedown",_),()=>document.removeEventListener("mousedown",_)},[b]);const S=async()=>{if(e)try{const{data:_,error:j}=await et.from("transactions").select(`
          *,
          supplier:suppliers(name),
          owner:business_owners(owner_name)
        `).eq("user_id",e.id).order("created_at",{ascending:!1});if(j)throw j;const{data:H,error:X}=await et.from("suppliers").select("*").eq("user_id",e.id).order("name");if(X)throw X;const pe=await mo.getInstance().getBusinessOwners(e.id);r(_||[]),i(H||[]),s(pe||[])}catch(_){console.error("Error fetching data:",_)}finally{l(!1)}},P=async _=>{if(e)try{if(g){const{error:j}=await et.from("transactions").update({amount:parseFloat(_.amount),description:_.description,type:_.type,supplier_id:_.supplier_id,owner_id:_.owner_id}).eq("id",g.id);if(j)throw j;y(null)}else{const{data:j,error:H}=await et.from("transactions").insert([{..._,user_id:e.id,amount:parseFloat(_.amount)}]).select(`
            *,
            supplier:suppliers(name),
            owner:business_owners(owner_name)
          `).single();if(H)throw H;const X=n.find(pe=>pe.id===_.supplier_id),ce=a.find(pe=>pe.id===_.owner_id);if(X&&ce&&e.email){const pe=parseFloat(_.amount);_.type==="new_purchase"?await jm.notifyTransactionCreated(e.id,ce.owner_name,pe,X.name,j.id,X.id):_.type==="pay_due"&&await jm.notifyPaymentMade(e.id,ce.owner_name,pe,X.name,X.id)}}await S(),v(!1)}catch(j){console.error("Error saving transaction:",j)}},L=_=>{y(_),v(!0),E(null)},q=async _=>{if(confirm("Are you sure you want to delete this transaction?"))try{const{error:j}=await et.from("transactions").delete().eq("id",_);if(j)throw j;await S(),E(null)}catch(j){console.error("Error deleting transaction:",j)}},C=t.filter(_=>{var X,ce,pe,ye,me;const j=((X=_.description)==null?void 0:X.toLowerCase().includes(c.toLowerCase()))||((pe=(ce=_.supplier)==null?void 0:ce.name)==null?void 0:pe.toLowerCase().includes(c.toLowerCase()))||((me=(ye=_.owner)==null?void 0:ye.owner_name)==null?void 0:me.toLowerCase().includes(c.toLowerCase())),H=h==="all"||_.type===h;return j&&H}),R=_=>{switch(_){case"new_purchase":return f.jsx(Mg,{className:"h-4 w-4 text-red-500"});case"pay_due":case"settle_bill":return f.jsx(Ig,{className:"h-4 w-4 text-green-500"});default:return f.jsx(ja,{className:"h-4 w-4 text-gray-500"})}},k=_=>{switch(_){case"new_purchase":return"Purchase";case"pay_due":return"Payment";case"settle_bill":return"Settlement";default:return _}},G=_=>new Date(_).toLocaleDateString("en-IN",{month:"short",day:"numeric",year:"numeric"});return o?f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):f.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[f.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-3",children:f.jsxs("div",{children:[f.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Transactions"}),f.jsx("p",{className:"text-gray-600 text-sm",children:"Track all your business transactions"})]})}),f.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[f.jsxs("div",{className:"relative flex-1",children:[f.jsx(G_,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),f.jsx("input",{type:"text",placeholder:"Search transactions...",value:c,onChange:_=>u(_.target.value),className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),f.jsxs("div",{className:"relative",children:[f.jsx(Rg,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),f.jsxs("select",{value:h,onChange:_=>p(_.target.value),className:"pl-10 pr-8 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 appearance-none bg-white",children:[f.jsx("option",{value:"all",children:"All Types"}),f.jsx("option",{value:"new_purchase",children:"Purchases"}),f.jsx("option",{value:"pay_due",children:"Payments"})]})]})]}),f.jsx("div",{className:"space-y-3",children:C.length===0?f.jsxs("div",{className:"text-center py-12",children:[f.jsx(ja,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),f.jsx("p",{className:"text-gray-500 text-lg",children:"No transactions found"}),f.jsx("p",{className:"text-gray-400 text-sm",children:c?"Try adjusting your search":"Add your first transaction to get started"})]}):C.map(_=>{var j,H;return f.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:f.jsxs("div",{className:"flex items-start justify-between",children:[f.jsxs("div",{className:"flex items-start space-x-3 flex-1 min-w-0",children:[f.jsx("div",{className:"flex-shrink-0 mt-1",children:R(_.type)}),f.jsxs("div",{className:"flex-1 min-w-0",children:[f.jsxs("div",{className:"flex items-center justify-between mb-1",children:[f.jsx("h3",{className:"font-medium text-gray-900 truncate",children:(j=_.supplier)==null?void 0:j.name}),f.jsxs("p",{className:`font-semibold text-lg ${_.type==="new_purchase"?"text-red-600":"text-green-600"}`,children:[_.type==="new_purchase"?"+":"-","‚Çπ",Math.round(_.amount).toLocaleString()]})]}),f.jsx("p",{className:"text-sm text-gray-600 mb-1",children:k(_.type)}),_.description&&f.jsx("p",{className:"text-sm text-gray-500 mb-2 line-clamp-2",children:_.description}),f.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400",children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx(mc,{className:"h-3 w-3 mr-1"}),G(_.created_at)]}),((H=_.owner)==null?void 0:H.owner_name)&&f.jsxs("span",{className:"text-blue-600 font-medium",children:["by ",_.owner.owner_name]})]})]})]}),f.jsxs("div",{className:"relative ml-3",children:[f.jsx("button",{onClick:()=>E(b===_.id?null:_.id),className:"p-1 hover:bg-gray-100 rounded-full transition-colors",children:f.jsx(d8,{className:"h-4 w-4 text-gray-500"})}),b===_.id&&f.jsxs("div",{className:"dropdown-menu absolute right-0 top-8 w-36 bg-white border border-gray-200 rounded-lg shadow-lg z-10",children:[f.jsxs("button",{onClick:()=>L(_),className:"w-full px-3 py-2 text-left text-sm text-gray-700 hover:bg-gray-50 flex items-center rounded-t-lg",children:[f.jsx(p8,{className:"h-4 w-4 mr-2"}),"Edit"]}),f.jsxs("button",{onClick:()=>q(_.id),className:"w-full px-3 py-2 text-left text-sm text-red-600 hover:bg-red-50 flex items-center rounded-b-lg",children:[f.jsx(kc,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]})},_.id)})}),f.jsx(RP,{isOpen:d,onClose:()=>{v(!1),y(null)},onSubmit:P,suppliers:n,businessOwners:a,editingTransaction:g})]})};function s4(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(r=s4(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function An(){for(var e,t,r=0,n="",i=arguments.length;r<i;r++)(e=arguments[r])&&(t=s4(e))&&(n&&(n+=" "),n+=t);return n}var Pd={},o4={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==="__proto__"}e.isUnsafeProperty=t})(o4);var zg={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){switch(typeof r){case"number":case"symbol":return!1;case"string":return r.includes(".")||r.includes("[")||r.includes("]")}}e.isDeepKey=t})(zg);var Wg={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var n;return typeof r=="string"||typeof r=="symbol"?r:Object.is((n=r==null?void 0:r.valueOf)==null?void 0:n.call(r),-0)?"-0":String(r)}e.toKey=t})(Wg);var jd={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){const n=[],i=r.length;if(i===0)return n;let a=0,s="",o="",l=!1;for(r.charCodeAt(0)===46&&(n.push(""),a++);a<i;){const c=r[a];o?c==="\\"&&a+1<i?(a++,s+=r[a]):c===o?o="":s+=c:l?c==='"'||c==="'"?o=c:c==="]"?(l=!1,n.push(s),s=""):s+=c:c==="["?(l=!0,s&&(n.push(s),s="")):c==="."?s&&(n.push(s),s=""):s+=c,a++}return s&&n.push(s),n}e.toPath=t})(jd);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=o4,r=zg,n=Wg,i=jd;function a(o,l,c){if(o==null)return c;switch(typeof l){case"string":{if(t.isUnsafeProperty(l))return c;const u=o[l];return u===void 0?r.isDeepKey(l)?a(o,i.toPath(l),c):c:u}case"number":case"symbol":{typeof l=="number"&&(l=n.toKey(l));const u=o[l];return u===void 0?c:u}default:{if(Array.isArray(l))return s(o,l,c);if(Object.is(l==null?void 0:l.valueOf(),-0)?l="-0":l=String(l),t.isUnsafeProperty(l))return c;const u=o[l];return u===void 0?c:u}}}function s(o,l,c){if(l.length===0)return c;let u=o;for(let h=0;h<l.length;h++){if(u==null||t.isUnsafeProperty(l[h]))return c;u=u[l[h]]}return u===void 0?c:u}e.get=a})(Pd);var UP=Pd.get;const Lc=ko(UP);var l4={exports:{}},br={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qg=Symbol.for("react.transitional.element"),Hg=Symbol.for("react.portal"),kd=Symbol.for("react.fragment"),Cd=Symbol.for("react.strict_mode"),Od=Symbol.for("react.profiler"),Ld=Symbol.for("react.consumer"),Fd=Symbol.for("react.context"),Dd=Symbol.for("react.forward_ref"),Id=Symbol.for("react.suspense"),Md=Symbol.for("react.suspense_list"),Rd=Symbol.for("react.memo"),Bd=Symbol.for("react.lazy"),$P=Symbol.for("react.view_transition"),zP=Symbol.for("react.client.reference");function ua(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case qg:switch(e=e.type,e){case kd:case Od:case Cd:case Id:case Md:case $P:return e;default:switch(e=e&&e.$$typeof,e){case Fd:case Dd:case Bd:case Rd:return e;case Ld:return e;default:return t}}case Hg:return t}}}br.ContextConsumer=Ld;br.ContextProvider=Fd;br.Element=qg;br.ForwardRef=Dd;br.Fragment=kd;br.Lazy=Bd;br.Memo=Rd;br.Portal=Hg;br.Profiler=Od;br.StrictMode=Cd;br.Suspense=Id;br.SuspenseList=Md;br.isContextConsumer=function(e){return ua(e)===Ld};br.isContextProvider=function(e){return ua(e)===Fd};br.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===qg};br.isForwardRef=function(e){return ua(e)===Dd};br.isFragment=function(e){return ua(e)===kd};br.isLazy=function(e){return ua(e)===Bd};br.isMemo=function(e){return ua(e)===Rd};br.isPortal=function(e){return ua(e)===Hg};br.isProfiler=function(e){return ua(e)===Od};br.isStrictMode=function(e){return ua(e)===Cd};br.isSuspense=function(e){return ua(e)===Id};br.isSuspenseList=function(e){return ua(e)===Md};br.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===kd||e===Od||e===Cd||e===Id||e===Md||typeof e=="object"&&e!==null&&(e.$$typeof===Bd||e.$$typeof===Rd||e.$$typeof===Fd||e.$$typeof===Ld||e.$$typeof===Dd||e.$$typeof===zP||e.getModuleId!==void 0)};br.typeOf=ua;l4.exports=br;var WP=l4.exports,Mi=e=>e===0?0:e>0?1:-1,Ca=e=>typeof e=="number"&&e!=+e,Zu=e=>typeof e=="string"&&e.indexOf("%")===e.length-1,Vt=e=>(typeof e=="number"||e instanceof Number)&&!Ca(e),Os=e=>Vt(e)||typeof e=="string",qP=0,Eh=e=>{var t=++qP;return"".concat(e||"").concat(t)},es=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!Vt(t)&&typeof t!="string")return n;var a;if(Zu(t)){if(r==null)return n;var s=t.indexOf("%");a=r*parseFloat(t.slice(0,s))/100}else a=+t;return Ca(a)&&(a=n),i&&r!=null&&a>r&&(a=r),a},c4=e=>{if(!Array.isArray(e))return!1;for(var t=e.length,r={},n=0;n<t;n++)if(!r[e[n]])r[e[n]]=!0;else return!0;return!1},ly=(e,t)=>Vt(e)&&Vt(t)?r=>e+r*(t-e):()=>t;function HP(e,t,r){if(!(!e||!e.length))return e.find(n=>n&&(typeof t=="function"?t(n):Lc(n,t))===r)}var yl=e=>e===null||typeof e>"u",Hf=e=>yl(e)?e:"".concat(e.charAt(0).toUpperCase()).concat(e.slice(1)),GP=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"];function Gg(e){if(typeof e!="string")return!1;var t=GP;return t.includes(e)}var VP=["viewBox","children"],cy=["points","pathLength"],g1={svg:VP,polygon:cy,polyline:cy},KP=(e,t)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var r=e;if(z.isValidElement(e)&&(r=e.props),typeof r!="object"&&typeof r!="function")return null;var n={};return Object.keys(r).forEach(i=>{Gg(i)&&(n[i]=a=>r[i](r,a))}),n},YP=(e,t,r)=>n=>(e(t,r,n),null),XP=(e,t,r)=>{if(e===null||typeof e!="object"&&typeof e!="function")return null;var n=null;return Object.keys(e).forEach(i=>{var a=e[i];Gg(i)&&typeof a=="function"&&(n||(n={}),n[i]=YP(a,t,r))}),n},ZP=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"];function u4(e){if(typeof e!="string")return!1;var t=ZP;return t.includes(e)}function Ud(e){var t=Object.entries(e).filter(r=>{var[n]=r;return u4(n)});return Object.fromEntries(t)}var uy=e=>typeof e=="string"?e:e?e.displayName||e.name||"Component":"",fy=null,v1=null,f4=e=>{if(e===fy&&Array.isArray(v1))return v1;var t=[];return z.Children.forEach(e,r=>{yl(r)||(WP.isFragment(r)?t=t.concat(f4(r.props.children)):t.push(r))}),v1=t,fy=e,t};function h4(e,t){var r=[],n=[];return Array.isArray(t)?n=t.map(i=>uy(i)):n=[uy(t)],f4(e).forEach(i=>{var a=Lc(i,"type.displayName")||Lc(i,"type.name");n.indexOf(a)!==-1&&r.push(i)}),r}var JP=(e,t,r,n)=>{var i;if(typeof t=="symbol"||typeof t=="number")return!0;var a=(i=n&&(g1==null?void 0:g1[n]))!==null&&i!==void 0?i:[],s=t.startsWith("data-"),o=typeof e!="function"&&(!!n&&a.includes(t)||u4(t)),l=!!r&&Gg(t);return s||o||l},$i=(e,t,r)=>{if(!e||typeof e=="function"||typeof e=="boolean")return null;var n=e;if(z.isValidElement(e)&&(n=e.props),typeof n!="object"&&typeof n!="function")return null;var i={};return Object.keys(n).forEach(a=>{var s;JP((s=n)===null||s===void 0?void 0:s[a],a,t,r)&&(i[a]=n[a])}),i},QP=["children","width","height","viewBox","className","style","title","desc"];function km(){return km=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},km.apply(null,arguments)}function ej(e,t){if(e==null)return{};var r,n,i=tj(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function tj(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var d4=z.forwardRef((e,t)=>{var{children:r,width:n,height:i,viewBox:a,className:s,style:o,title:l,desc:c}=e,u=ej(e,QP),h=a||{width:n,height:i,x:0,y:0},p=An("recharts-surface",s);return z.createElement("svg",km({},$i(u,!0,"svg"),{className:p,width:n,height:i,style:o,viewBox:"".concat(h.x," ").concat(h.y," ").concat(h.width," ").concat(h.height),ref:t}),z.createElement("title",null,l),z.createElement("desc",null,c),r)}),rj=["children","className"];function Cm(){return Cm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Cm.apply(null,arguments)}function nj(e,t){if(e==null)return{};var r,n,i=ij(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function ij(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var Fc=z.forwardRef((e,t)=>{var{children:r,className:n}=e,i=nj(e,rj),a=An("recharts-layer",n);return z.createElement("g",Cm({className:a},$i(i,!0),{ref:t}),r)}),aj=z.createContext(null);function Sr(e){return function(){return e}}const p4=Math.cos,Th=Math.sin,Fa=Math.sqrt,Ph=Math.PI,$d=2*Ph,Om=Math.PI,Lm=2*Om,Yo=1e-6,sj=Lm-Yo;function m4(e){this._+=e[0];for(let t=1,r=e.length;t<r;++t)this._+=arguments[t]+e[t]}function oj(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return m4;const r=10**t;return function(n){this._+=n[0];for(let i=1,a=n.length;i<a;++i)this._+=Math.round(arguments[i]*r)/r+n[i]}}class lj{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?m4:oj(t)}moveTo(t,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,r){this._append`L${this._x1=+t},${this._y1=+r}`}quadraticCurveTo(t,r,n,i){this._append`Q${+t},${+r},${this._x1=+n},${this._y1=+i}`}bezierCurveTo(t,r,n,i,a,s){this._append`C${+t},${+r},${+n},${+i},${this._x1=+a},${this._y1=+s}`}arcTo(t,r,n,i,a){if(t=+t,r=+r,n=+n,i=+i,a=+a,a<0)throw new Error(`negative radius: ${a}`);let s=this._x1,o=this._y1,l=n-t,c=i-r,u=s-t,h=o-r,p=u*u+h*h;if(this._x1===null)this._append`M${this._x1=t},${this._y1=r}`;else if(p>Yo)if(!(Math.abs(h*l-c*u)>Yo)||!a)this._append`L${this._x1=t},${this._y1=r}`;else{let d=n-s,v=i-o,g=l*l+c*c,y=d*d+v*v,b=Math.sqrt(g),E=Math.sqrt(p),S=a*Math.tan((Om-Math.acos((g+p-y)/(2*b*E)))/2),P=S/E,L=S/b;Math.abs(P-1)>Yo&&this._append`L${t+P*u},${r+P*h}`,this._append`A${a},${a},0,0,${+(h*d>u*v)},${this._x1=t+L*l},${this._y1=r+L*c}`}}arc(t,r,n,i,a,s){if(t=+t,r=+r,n=+n,s=!!s,n<0)throw new Error(`negative radius: ${n}`);let o=n*Math.cos(i),l=n*Math.sin(i),c=t+o,u=r+l,h=1^s,p=s?i-a:a-i;this._x1===null?this._append`M${c},${u}`:(Math.abs(this._x1-c)>Yo||Math.abs(this._y1-u)>Yo)&&this._append`L${c},${u}`,n&&(p<0&&(p=p%Lm+Lm),p>sj?this._append`A${n},${n},0,1,${h},${t-o},${r-l}A${n},${n},0,1,${h},${this._x1=c},${this._y1=u}`:p>Yo&&this._append`A${n},${n},0,${+(p>=Om)},${h},${this._x1=t+n*Math.cos(a)},${this._y1=r+n*Math.sin(a)}`)}rect(t,r,n,i){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+r}h${n=+n}v${+i}h${-n}Z`}toString(){return this._}}function Vg(e){let t=3;return e.digits=function(r){if(!arguments.length)return t;if(r==null)t=null;else{const n=Math.floor(r);if(!(n>=0))throw new RangeError(`invalid digits: ${r}`);t=n}return e},()=>new lj(t)}function Kg(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function g4(e){this._context=e}g4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function zd(e){return new g4(e)}function v4(e){return e[0]}function x4(e){return e[1]}function y4(e,t){var r=Sr(!0),n=null,i=zd,a=null,s=Vg(o);e=typeof e=="function"?e:e===void 0?v4:Sr(e),t=typeof t=="function"?t:t===void 0?x4:Sr(t);function o(l){var c,u=(l=Kg(l)).length,h,p=!1,d;for(n==null&&(a=i(d=s())),c=0;c<=u;++c)!(c<u&&r(h=l[c],c,l))===p&&((p=!p)?a.lineStart():a.lineEnd()),p&&a.point(+e(h,c,l),+t(h,c,l));if(d)return a=null,d+""||null}return o.x=function(l){return arguments.length?(e=typeof l=="function"?l:Sr(+l),o):e},o.y=function(l){return arguments.length?(t=typeof l=="function"?l:Sr(+l),o):t},o.defined=function(l){return arguments.length?(r=typeof l=="function"?l:Sr(!!l),o):r},o.curve=function(l){return arguments.length?(i=l,n!=null&&(a=i(n)),o):i},o.context=function(l){return arguments.length?(l==null?n=a=null:a=i(n=l),o):n},o}function B0(e,t,r){var n=null,i=Sr(!0),a=null,s=zd,o=null,l=Vg(c);e=typeof e=="function"?e:e===void 0?v4:Sr(+e),t=typeof t=="function"?t:Sr(t===void 0?0:+t),r=typeof r=="function"?r:r===void 0?x4:Sr(+r);function c(h){var p,d,v,g=(h=Kg(h)).length,y,b=!1,E,S=new Array(g),P=new Array(g);for(a==null&&(o=s(E=l())),p=0;p<=g;++p){if(!(p<g&&i(y=h[p],p,h))===b)if(b=!b)d=p,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),v=p-1;v>=d;--v)o.point(S[v],P[v]);o.lineEnd(),o.areaEnd()}b&&(S[p]=+e(y,p,h),P[p]=+t(y,p,h),o.point(n?+n(y,p,h):S[p],r?+r(y,p,h):P[p]))}if(E)return o=null,E+""||null}function u(){return y4().defined(i).curve(s).context(a)}return c.x=function(h){return arguments.length?(e=typeof h=="function"?h:Sr(+h),n=null,c):e},c.x0=function(h){return arguments.length?(e=typeof h=="function"?h:Sr(+h),c):e},c.x1=function(h){return arguments.length?(n=h==null?null:typeof h=="function"?h:Sr(+h),c):n},c.y=function(h){return arguments.length?(t=typeof h=="function"?h:Sr(+h),r=null,c):t},c.y0=function(h){return arguments.length?(t=typeof h=="function"?h:Sr(+h),c):t},c.y1=function(h){return arguments.length?(r=h==null?null:typeof h=="function"?h:Sr(+h),c):r},c.lineX0=c.lineY0=function(){return u().x(e).y(t)},c.lineY1=function(){return u().x(e).y(r)},c.lineX1=function(){return u().x(n).y(t)},c.defined=function(h){return arguments.length?(i=typeof h=="function"?h:Sr(!!h),c):i},c.curve=function(h){return arguments.length?(s=h,a!=null&&(o=s(a)),c):s},c.context=function(h){return arguments.length?(h==null?a=o=null:o=s(a=h),c):a},c}class b4{constructor(t,r){this._context=t,this._x=r}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,r){switch(t=+t,r=+r,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,r):this._context.moveTo(t,r);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,r,t,r):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+r)/2,t,this._y0,t,r);break}}this._x0=t,this._y0=r}}function cj(e){return new b4(e,!0)}function uj(e){return new b4(e,!1)}const Yg={draw(e,t){const r=Fa(t/Ph);e.moveTo(r,0),e.arc(0,0,r,0,$d)}},fj={draw(e,t){const r=Fa(t/5)/2;e.moveTo(-3*r,-r),e.lineTo(-r,-r),e.lineTo(-r,-3*r),e.lineTo(r,-3*r),e.lineTo(r,-r),e.lineTo(3*r,-r),e.lineTo(3*r,r),e.lineTo(r,r),e.lineTo(r,3*r),e.lineTo(-r,3*r),e.lineTo(-r,r),e.lineTo(-3*r,r),e.closePath()}},w4=Fa(1/3),hj=w4*2,dj={draw(e,t){const r=Fa(t/hj),n=r*w4;e.moveTo(0,-r),e.lineTo(n,0),e.lineTo(0,r),e.lineTo(-n,0),e.closePath()}},pj={draw(e,t){const r=Fa(t),n=-r/2;e.rect(n,n,r,r)}},mj=.8908130915292852,_4=Th(Ph/10)/Th(7*Ph/10),gj=Th($d/10)*_4,vj=-p4($d/10)*_4,xj={draw(e,t){const r=Fa(t*mj),n=gj*r,i=vj*r;e.moveTo(0,-r),e.lineTo(n,i);for(let a=1;a<5;++a){const s=$d*a/5,o=p4(s),l=Th(s);e.lineTo(l*r,-o*r),e.lineTo(o*n-l*i,l*n+o*i)}e.closePath()}},x1=Fa(3),yj={draw(e,t){const r=-Fa(t/(x1*3));e.moveTo(0,r*2),e.lineTo(-x1*r,-r),e.lineTo(x1*r,-r),e.closePath()}},Qi=-.5,ea=Fa(3)/2,Fm=1/Fa(12),bj=(Fm/2+1)*3,wj={draw(e,t){const r=Fa(t/bj),n=r/2,i=r*Fm,a=n,s=r*Fm+r,o=-a,l=s;e.moveTo(n,i),e.lineTo(a,s),e.lineTo(o,l),e.lineTo(Qi*n-ea*i,ea*n+Qi*i),e.lineTo(Qi*a-ea*s,ea*a+Qi*s),e.lineTo(Qi*o-ea*l,ea*o+Qi*l),e.lineTo(Qi*n+ea*i,Qi*i-ea*n),e.lineTo(Qi*a+ea*s,Qi*s-ea*a),e.lineTo(Qi*o+ea*l,Qi*l-ea*o),e.closePath()}};function _j(e,t){let r=null,n=Vg(i);e=typeof e=="function"?e:Sr(e||Yg),t=typeof t=="function"?t:Sr(t===void 0?64:+t);function i(){let a;if(r||(r=a=n()),e.apply(this,arguments).draw(r,+t.apply(this,arguments)),a)return r=null,a+""||null}return i.type=function(a){return arguments.length?(e=typeof a=="function"?a:Sr(a),i):e},i.size=function(a){return arguments.length?(t=typeof a=="function"?a:Sr(+a),i):t},i.context=function(a){return arguments.length?(r=a??null,i):r},i}function jh(){}function kh(e,t,r){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+r)/6)}function N4(e){this._context=e}N4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:kh(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:kh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Nj(e){return new N4(e)}function S4(e){this._context=e}S4.prototype={areaStart:jh,areaEnd:jh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:kh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Sj(e){return new S4(e)}function A4(e){this._context=e}A4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var r=(this._x0+4*this._x1+e)/6,n=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(r,n):this._context.moveTo(r,n);break;case 3:this._point=4;default:kh(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Aj(e){return new A4(e)}function E4(e){this._context=e}E4.prototype={areaStart:jh,areaEnd:jh,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Ej(e){return new E4(e)}function hy(e){return e<0?-1:1}function dy(e,t,r){var n=e._x1-e._x0,i=t-e._x1,a=(e._y1-e._y0)/(n||i<0&&-0),s=(r-e._y1)/(i||n<0&&-0),o=(a*i+s*n)/(n+i);return(hy(a)+hy(s))*Math.min(Math.abs(a),Math.abs(s),.5*Math.abs(o))||0}function py(e,t){var r=e._x1-e._x0;return r?(3*(e._y1-e._y0)/r-t)/2:t}function y1(e,t,r){var n=e._x0,i=e._y0,a=e._x1,s=e._y1,o=(a-n)/3;e._context.bezierCurveTo(n+o,i+o*t,a-o,s-o*r,a,s)}function Ch(e){this._context=e}Ch.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:y1(this,this._t0,py(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var r=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,y1(this,py(this,r=dy(this,e,t)),r);break;default:y1(this,this._t0,r=dy(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=r}}};function T4(e){this._context=new P4(e)}(T4.prototype=Object.create(Ch.prototype)).point=function(e,t){Ch.prototype.point.call(this,t,e)};function P4(e){this._context=e}P4.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,r,n,i,a){this._context.bezierCurveTo(t,e,n,r,a,i)}};function Tj(e){return new Ch(e)}function Pj(e){return new T4(e)}function j4(e){this._context=e}j4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,r=e.length;if(r)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),r===2)this._context.lineTo(e[1],t[1]);else for(var n=my(e),i=my(t),a=0,s=1;s<r;++a,++s)this._context.bezierCurveTo(n[0][a],i[0][a],n[1][a],i[1][a],e[s],t[s]);(this._line||this._line!==0&&r===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function my(e){var t,r=e.length-1,n,i=new Array(r),a=new Array(r),s=new Array(r);for(i[0]=0,a[0]=2,s[0]=e[0]+2*e[1],t=1;t<r-1;++t)i[t]=1,a[t]=4,s[t]=4*e[t]+2*e[t+1];for(i[r-1]=2,a[r-1]=7,s[r-1]=8*e[r-1]+e[r],t=1;t<r;++t)n=i[t]/a[t-1],a[t]-=n,s[t]-=n*s[t-1];for(i[r-1]=s[r-1]/a[r-1],t=r-2;t>=0;--t)i[t]=(s[t]-i[t+1])/a[t];for(a[r-1]=(e[r]+i[r-1])/2,t=0;t<r-1;++t)a[t]=2*e[t+1]-i[t+1];return[i,a]}function jj(e){return new j4(e)}function Wd(e,t){this._context=e,this._t=t}Wd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var r=this._x*(1-this._t)+e*this._t;this._context.lineTo(r,this._y),this._context.lineTo(r,t)}break}}this._x=e,this._y=t}};function kj(e){return new Wd(e,.5)}function Cj(e){return new Wd(e,0)}function Oj(e){return new Wd(e,1)}function Dc(e,t){if((s=e.length)>1)for(var r=1,n,i,a=e[t[0]],s,o=a.length;r<s;++r)for(i=a,a=e[t[r]],n=0;n<o;++n)a[n][1]+=a[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function Dm(e){for(var t=e.length,r=new Array(t);--t>=0;)r[t]=t;return r}function Lj(e,t){return e[t]}function Fj(e){const t=[];return t.key=e,t}function Dj(){var e=Sr([]),t=Dm,r=Dc,n=Lj;function i(a){var s=Array.from(e.apply(this,arguments),Fj),o,l=s.length,c=-1,u;for(const h of a)for(o=0,++c;o<l;++o)(s[o][c]=[0,+n(h,s[o].key,c,a)]).data=h;for(o=0,u=Kg(t(s));o<l;++o)s[u[o]].index=o;return r(s,u),s}return i.keys=function(a){return arguments.length?(e=typeof a=="function"?a:Sr(Array.from(a)),i):e},i.value=function(a){return arguments.length?(n=typeof a=="function"?a:Sr(+a),i):n},i.order=function(a){return arguments.length?(t=a==null?Dm:typeof a=="function"?a:Sr(Array.from(a)),i):t},i.offset=function(a){return arguments.length?(r=a??Dc,i):r},i}function Ij(e,t){if((n=e.length)>0){for(var r,n,i=0,a=e[0].length,s;i<a;++i){for(s=r=0;r<n;++r)s+=e[r][i][1]||0;if(s)for(r=0;r<n;++r)e[r][i][1]/=s}Dc(e,t)}}function Mj(e,t){if((i=e.length)>0){for(var r=0,n=e[t[0]],i,a=n.length;r<a;++r){for(var s=0,o=0;s<i;++s)o+=e[s][r][1]||0;n[r][1]+=n[r][0]=-o/2}Dc(e,t)}}function Rj(e,t){if(!(!((s=e.length)>0)||!((a=(i=e[t[0]]).length)>0))){for(var r=0,n=1,i,a,s;n<a;++n){for(var o=0,l=0,c=0;o<s;++o){for(var u=e[t[o]],h=u[n][1]||0,p=u[n-1][1]||0,d=(h-p)/2,v=0;v<o;++v){var g=e[t[v]],y=g[n][1]||0,b=g[n-1][1]||0;d+=y-b}l+=h,c+=d*h}i[n-1][1]+=i[n-1][0]=r,l&&(r-=c/l)}i[n-1][1]+=i[n-1][0]=r,Dc(e,t)}}var Bj=["type","size","sizeType"];function Im(){return Im=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Im.apply(null,arguments)}function gy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function vy(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?gy(Object(r),!0).forEach(function(n){Uj(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Uj(e,t,r){return(t=$j(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $j(e){var t=zj(e,"string");return typeof t=="symbol"?t:t+""}function zj(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wj(e,t){if(e==null)return{};var r,n,i=qj(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function qj(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var k4={symbolCircle:Yg,symbolCross:fj,symbolDiamond:dj,symbolSquare:pj,symbolStar:xj,symbolTriangle:yj,symbolWye:wj},Hj=Math.PI/180,Gj=e=>{var t="symbol".concat(Hf(e));return k4[t]||Yg},Vj=(e,t,r)=>{if(t==="area")return e;switch(r){case"cross":return 5*e*e/9;case"diamond":return .5*e*e/Math.sqrt(3);case"square":return e*e;case"star":{var n=18*Hj;return 1.25*e*e*(Math.tan(n)-Math.tan(n*2)*Math.tan(n)**2)}case"triangle":return Math.sqrt(3)*e*e/4;case"wye":return(21-10*Math.sqrt(3))*e*e/8;default:return Math.PI*e*e/4}},Kj=(e,t)=>{k4["symbol".concat(Hf(e))]=t},C4=e=>{var{type:t="circle",size:r=64,sizeType:n="area"}=e,i=Wj(e,Bj),a=vy(vy({},i),{},{type:t,size:r,sizeType:n}),s=()=>{var h=Gj(t),p=_j().type(h).size(Vj(r,n,t));return p()},{className:o,cx:l,cy:c}=a,u=$i(a,!0);return l===+l&&c===+c&&r===+r?z.createElement("path",Im({},u,{className:An("recharts-symbols",o),transform:"translate(".concat(l,", ").concat(c,")"),d:s()})):null};C4.registerSymbol=Kj;var O4={},L4={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){const i=new Map;for(let a=0;a<r.length;a++){const s=r[a],o=n(s);i.has(o)||i.set(o,s)}return Array.from(i.values())}e.uniqBy=t})(L4);var Xg={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r}e.identity=t})(Xg);var F4={},Zg={},D4={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Number.isSafeInteger(r)&&r>=0}e.isLength=t})(D4);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=D4;function r(n){return n!=null&&typeof n!="function"&&t.isLength(n.length)}e.isArrayLike=r})(Zg);var I4={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="object"&&r!==null}e.isObjectLike=t})(I4);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Zg,r=I4;function n(i){return r.isObjectLike(i)&&t.isArrayLike(i)}e.isArrayLikeObject=n})(F4);var M4={},R4={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Pd;function r(n){return function(i){return t.get(i,n)}}e.property=r})(R4);var B4={},b1={},w1={},Jg={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r!==null&&(typeof r=="object"||typeof r=="function")}e.isObject=t})(Jg);var Qg={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null||typeof r!="object"&&typeof r!="function"}e.isPrimitive=t})(Qg);var qd={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n){return r===n||Number.isNaN(r)&&Number.isNaN(n)}e.eq=t})(qd);var xy;function Yj(){return xy||(xy=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=e2(),r=Jg,n=Qg,i=qd;function a(h,p,d){return typeof d!="function"?t.isMatch(h,p):s(h,p,function v(g,y,b,E,S,P){const L=d(g,y,b,E,S,P);return L!==void 0?!!L:s(g,y,v,P)},new Map)}function s(h,p,d,v){if(p===h)return!0;switch(typeof p){case"object":return o(h,p,d,v);case"function":return Object.keys(p).length>0?s(h,{...p},d,v):i.eq(h,p);default:return r.isObject(h)?typeof p=="string"?p==="":!0:i.eq(h,p)}}function o(h,p,d,v){if(p==null)return!0;if(Array.isArray(p))return c(h,p,d,v);if(p instanceof Map)return l(h,p,d,v);if(p instanceof Set)return u(h,p,d,v);const g=Object.keys(p);if(h==null)return g.length===0;if(g.length===0)return!0;if(v&&v.has(p))return v.get(p)===h;v&&v.set(p,h);try{for(let y=0;y<g.length;y++){const b=g[y];if(!n.isPrimitive(h)&&!(b in h)||p[b]===void 0&&h[b]!==void 0||p[b]===null&&h[b]!==null||!d(h[b],p[b],b,h,p,v))return!1}return!0}finally{v&&v.delete(p)}}function l(h,p,d,v){if(p.size===0)return!0;if(!(h instanceof Map))return!1;for(const[g,y]of p.entries()){const b=h.get(g);if(d(b,y,g,h,p,v)===!1)return!1}return!0}function c(h,p,d,v){if(p.length===0)return!0;if(!Array.isArray(h))return!1;const g=new Set;for(let y=0;y<p.length;y++){const b=p[y];let E=!1;for(let S=0;S<h.length;S++){if(g.has(S))continue;const P=h[S];let L=!1;if(d(P,b,y,h,p,v)&&(L=!0),L){g.add(S),E=!0;break}}if(!E)return!1}return!0}function u(h,p,d,v){return p.size===0?!0:h instanceof Set?c([...h],[...p],d,v):!1}e.isMatchWith=a,e.isSetMatch=u}(w1)),w1}var yy;function e2(){return yy||(yy=1,function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Yj();function r(n,i){return t.isMatchWith(n,i,()=>{})}e.isMatch=r}(b1)),b1}var U4={},t2={},r2={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return Object.getOwnPropertySymbols(r).filter(n=>Object.prototype.propertyIsEnumerable.call(r,n))}e.getSymbols=t})(r2);var Hd={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return r==null?r===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(r)}e.getTag=t})(Hd);var Gd={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t="[object RegExp]",r="[object String]",n="[object Number]",i="[object Boolean]",a="[object Arguments]",s="[object Symbol]",o="[object Date]",l="[object Map]",c="[object Set]",u="[object Array]",h="[object Function]",p="[object ArrayBuffer]",d="[object Object]",v="[object Error]",g="[object DataView]",y="[object Uint8Array]",b="[object Uint8ClampedArray]",E="[object Uint16Array]",S="[object Uint32Array]",P="[object BigUint64Array]",L="[object Int8Array]",q="[object Int16Array]",C="[object Int32Array]",R="[object BigInt64Array]",k="[object Float32Array]",G="[object Float64Array]";e.argumentsTag=a,e.arrayBufferTag=p,e.arrayTag=u,e.bigInt64ArrayTag=R,e.bigUint64ArrayTag=P,e.booleanTag=i,e.dataViewTag=g,e.dateTag=o,e.errorTag=v,e.float32ArrayTag=k,e.float64ArrayTag=G,e.functionTag=h,e.int16ArrayTag=q,e.int32ArrayTag=C,e.int8ArrayTag=L,e.mapTag=l,e.numberTag=n,e.objectTag=d,e.regexpTag=t,e.setTag=c,e.stringTag=r,e.symbolTag=s,e.uint16ArrayTag=E,e.uint32ArrayTag=S,e.uint8ArrayTag=y,e.uint8ClampedArrayTag=b})(Gd);var $4={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)}e.isTypedArray=t})($4);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=r2,r=Hd,n=Gd,i=Qg,a=$4;function s(u,h){return o(u,void 0,u,new Map,h)}function o(u,h,p,d=new Map,v=void 0){const g=v==null?void 0:v(u,h,p,d);if(g!==void 0)return g;if(i.isPrimitive(u))return u;if(d.has(u))return d.get(u);if(Array.isArray(u)){const y=new Array(u.length);d.set(u,y);for(let b=0;b<u.length;b++)y[b]=o(u[b],b,p,d,v);return Object.hasOwn(u,"index")&&(y.index=u.index),Object.hasOwn(u,"input")&&(y.input=u.input),y}if(u instanceof Date)return new Date(u.getTime());if(u instanceof RegExp){const y=new RegExp(u.source,u.flags);return y.lastIndex=u.lastIndex,y}if(u instanceof Map){const y=new Map;d.set(u,y);for(const[b,E]of u)y.set(b,o(E,b,p,d,v));return y}if(u instanceof Set){const y=new Set;d.set(u,y);for(const b of u)y.add(o(b,void 0,p,d,v));return y}if(typeof Buffer<"u"&&Buffer.isBuffer(u))return u.subarray();if(a.isTypedArray(u)){const y=new(Object.getPrototypeOf(u)).constructor(u.length);d.set(u,y);for(let b=0;b<u.length;b++)y[b]=o(u[b],b,p,d,v);return y}if(u instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&u instanceof SharedArrayBuffer)return u.slice(0);if(u instanceof DataView){const y=new DataView(u.buffer.slice(0),u.byteOffset,u.byteLength);return d.set(u,y),l(y,u,p,d,v),y}if(typeof File<"u"&&u instanceof File){const y=new File([u],u.name,{type:u.type});return d.set(u,y),l(y,u,p,d,v),y}if(u instanceof Blob){const y=new Blob([u],{type:u.type});return d.set(u,y),l(y,u,p,d,v),y}if(u instanceof Error){const y=new u.constructor;return d.set(u,y),y.message=u.message,y.name=u.name,y.stack=u.stack,y.cause=u.cause,l(y,u,p,d,v),y}if(typeof u=="object"&&c(u)){const y=Object.create(Object.getPrototypeOf(u));return d.set(u,y),l(y,u,p,d,v),y}return u}function l(u,h,p=u,d,v){const g=[...Object.keys(h),...t.getSymbols(h)];for(let y=0;y<g.length;y++){const b=g[y],E=Object.getOwnPropertyDescriptor(u,b);(E==null||E.writable)&&(u[b]=o(h[b],b,p,d,v))}}function c(u){switch(r.getTag(u)){case n.argumentsTag:case n.arrayTag:case n.arrayBufferTag:case n.dataViewTag:case n.booleanTag:case n.dateTag:case n.float32ArrayTag:case n.float64ArrayTag:case n.int8ArrayTag:case n.int16ArrayTag:case n.int32ArrayTag:case n.mapTag:case n.numberTag:case n.objectTag:case n.regexpTag:case n.setTag:case n.stringTag:case n.symbolTag:case n.uint8ArrayTag:case n.uint8ClampedArrayTag:case n.uint16ArrayTag:case n.uint32ArrayTag:return!0;default:return!1}}e.cloneDeepWith=s,e.cloneDeepWithImpl=o,e.copyProperties=l})(t2);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=t2;function r(n){return t.cloneDeepWithImpl(n,void 0,n,new Map,void 0)}e.cloneDeep=r})(U4);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=e2(),r=U4;function n(i){return i=r.cloneDeep(i),a=>t.isMatch(a,i)}e.matches=n})(B4);var z4={},W4={},q4={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=t2,r=Gd;function n(i,a){return t.cloneDeepWith(i,(s,o,l,c)=>{const u=a==null?void 0:a(s,o,l,c);if(u!==void 0)return u;if(typeof i=="object")switch(Object.prototype.toString.call(i)){case r.numberTag:case r.stringTag:case r.booleanTag:{const h=new i.constructor(i==null?void 0:i.valueOf());return t.copyProperties(h,i),h}case r.argumentsTag:{const h={};return t.copyProperties(h,i),h.length=i.length,h[Symbol.iterator]=i[Symbol.iterator],h}default:return}})}e.cloneDeepWith=n})(q4);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=q4;function r(n){return t.cloneDeepWith(n)}e.cloneDeep=r})(W4);var H4={},n2={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=/^(?:0|[1-9]\d*)$/;function r(n,i=Number.MAX_SAFE_INTEGER){switch(typeof n){case"number":return Number.isInteger(n)&&n>=0&&n<i;case"symbol":return!1;case"string":return t.test(n)}}e.isIndex=r})(n2);var G4={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Hd;function r(n){return n!==null&&typeof n=="object"&&t.getTag(n)==="[object Arguments]"}e.isArguments=r})(G4);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=zg,r=n2,n=G4,i=jd;function a(s,o){let l;if(Array.isArray(o)?l=o:typeof o=="string"&&t.isDeepKey(o)&&(s==null?void 0:s[o])==null?l=i.toPath(o):l=[o],l.length===0)return!1;let c=s;for(let u=0;u<l.length;u++){const h=l[u];if((c==null||!Object.hasOwn(c,h))&&!((Array.isArray(c)||n.isArguments(c))&&r.isIndex(h)&&h<c.length))return!1;c=c[h]}return!0}e.has=a})(H4);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=e2(),r=Wg,n=W4,i=Pd,a=H4;function s(o,l){switch(typeof o){case"object":{Object.is(o==null?void 0:o.valueOf(),-0)&&(o="-0");break}case"number":{o=r.toKey(o);break}}return l=n.cloneDeep(l),function(c){const u=i.get(c,o);return u===void 0?a.has(c,o):l===void 0?u===void 0:t.isMatch(u,l)}}e.matchesProperty=s})(z4);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Xg,r=R4,n=B4,i=z4;function a(s){if(s==null)return t.identity;switch(typeof s){case"function":return s;case"object":return Array.isArray(s)&&s.length===2?i.matchesProperty(s[0],s[1]):n.matches(s);case"string":case"symbol":case"number":return r.property(s)}}e.iteratee=a})(M4);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=L4,r=Xg,n=F4,i=M4;function a(s,o=r.identity){return n.isArrayLikeObject(s)?t.uniqBy(Array.from(s),i.iteratee(o)):[]}e.uniqBy=a})(O4);var Xj=O4.uniqBy;const by=ko(Xj);function Zj(e,t,r){return t===!0?by(e,r):typeof t=="function"?by(e,t):e}var V4={exports:{}},K4={},Y4={exports:{}},X4={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ic=z;function Jj(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Qj=typeof Object.is=="function"?Object.is:Jj,ek=Ic.useState,tk=Ic.useEffect,rk=Ic.useLayoutEffect,nk=Ic.useDebugValue;function ik(e,t){var r=t(),n=ek({inst:{value:r,getSnapshot:t}}),i=n[0].inst,a=n[1];return rk(function(){i.value=r,i.getSnapshot=t,_1(i)&&a({inst:i})},[e,r,t]),tk(function(){return _1(i)&&a({inst:i}),e(function(){_1(i)&&a({inst:i})})},[e]),nk(r),r}function _1(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!Qj(e,r)}catch{return!0}}function ak(e,t){return t()}var sk=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?ak:ik;X4.useSyncExternalStore=Ic.useSyncExternalStore!==void 0?Ic.useSyncExternalStore:sk;Y4.exports=X4;var ok=Y4.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vd=z,lk=ok;function ck(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var uk=typeof Object.is=="function"?Object.is:ck,fk=lk.useSyncExternalStore,hk=Vd.useRef,dk=Vd.useEffect,pk=Vd.useMemo,mk=Vd.useDebugValue;K4.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var a=hk(null);if(a.current===null){var s={hasValue:!1,value:null};a.current=s}else s=a.current;a=pk(function(){function l(d){if(!c){if(c=!0,u=d,d=n(d),i!==void 0&&s.hasValue){var v=s.value;if(i(v,d))return h=v}return h=d}if(v=h,uk(u,d))return v;var g=n(d);return i!==void 0&&i(v,g)?(u=d,v):(u=d,h=g)}var c=!1,u,h,p=r===void 0?null:r;return[function(){return l(t())},p===null?void 0:function(){return l(p())}]},[t,r,n,i]);var o=fk(e,a[0],a[1]);return dk(function(){s.hasValue=!0,s.value=o},[o]),mk(o),o};V4.exports=K4;var gk=V4.exports,i2=z.createContext(null),vk=e=>e,Zn=()=>{var e=z.useContext(i2);return e?e.store.dispatch:vk},xh=()=>{},xk=()=>xh,yk=(e,t)=>e===t;function qt(e){var t=z.useContext(i2);return gk.useSyncExternalStoreWithSelector(t?t.subscription.addNestedSub:xk,t?t.store.getState:xh,t?t.store.getState:xh,t?e:xh,yk)}function bk(e,t=`expected a function, instead received ${typeof e}`){if(typeof e!="function")throw new TypeError(t)}function wk(e,t=`expected an object, instead received ${typeof e}`){if(typeof e!="object")throw new TypeError(t)}function _k(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(r=>typeof r=="function")){const r=e.map(n=>typeof n=="function"?`function ${n.name||"unnamed"}()`:typeof n).join(", ");throw new TypeError(`${t}[${r}]`)}}var wy=e=>Array.isArray(e)?e:[e];function Nk(e){const t=Array.isArray(e[0])?e[0]:e;return _k(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}function Sk(e,t){const r=[],{length:n}=e;for(let i=0;i<n;i++)r.push(e[i].apply(null,t));return r}var Ak=class{constructor(e){this.value=e}deref(){return this.value}},Ek=typeof WeakRef<"u"?WeakRef:Ak,Tk=0,_y=1;function U0(){return{s:Tk,v:void 0,o:null,p:null}}function Z4(e,t={}){let r=U0();const{resultEqualityCheck:n}=t;let i,a=0;function s(){var h;let o=r;const{length:l}=arguments;for(let p=0,d=l;p<d;p++){const v=arguments[p];if(typeof v=="function"||typeof v=="object"&&v!==null){let g=o.o;g===null&&(o.o=g=new WeakMap);const y=g.get(v);y===void 0?(o=U0(),g.set(v,o)):o=y}else{let g=o.p;g===null&&(o.p=g=new Map);const y=g.get(v);y===void 0?(o=U0(),g.set(v,o)):o=y}}const c=o;let u;if(o.s===_y)u=o.v;else if(u=e.apply(null,arguments),a++,n){const p=((h=i==null?void 0:i.deref)==null?void 0:h.call(i))??i;p!=null&&n(p,u)&&(u=p,a!==0&&a--),i=typeof u=="object"&&u!==null||typeof u=="function"?new Ek(u):u}return c.s=_y,c.v=u,u}return s.clearCache=()=>{r=U0(),s.resetResultsCount()},s.resultsCount=()=>a,s.resetResultsCount=()=>{a=0},s}function Pk(e,...t){const r=typeof e=="function"?{memoize:e,memoizeOptions:t}:e,n=(...i)=>{let a=0,s=0,o,l={},c=i.pop();typeof c=="object"&&(l=c,c=i.pop()),bk(c,`createSelector expects an output function after the inputs, but received: [${typeof c}]`);const u={...r,...l},{memoize:h,memoizeOptions:p=[],argsMemoize:d=Z4,argsMemoizeOptions:v=[],devModeChecks:g={}}=u,y=wy(p),b=wy(v),E=Nk(i),S=h(function(){return a++,c.apply(null,arguments)},...y),P=d(function(){s++;const q=Sk(E,arguments);return o=S.apply(null,q),o},...b);return Object.assign(P,{resultFunc:c,memoizedResultFunc:S,dependencies:E,dependencyRecomputations:()=>s,resetDependencyRecomputations:()=>{s=0},lastResult:()=>o,recomputations:()=>a,resetRecomputations:()=>{a=0},memoize:h,argsMemoize:d})};return Object.assign(n,{withTypes:()=>n}),n}var ke=Pk(Z4),jk=Object.assign((e,t=ke)=>{wk(e,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof e}`);const r=Object.keys(e),n=r.map(a=>e[a]);return t(n,(...a)=>a.reduce((s,o,l)=>(s[r[l]]=o,s),{}))},{withTypes:()=>jk}),J4={},Q4={},e3={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(n){return typeof n=="symbol"?1:n===null?2:n===void 0?3:n!==n?4:0}const r=(n,i,a)=>{if(n!==i){const s=t(n),o=t(i);if(s===o&&s===0){if(n<i)return a==="desc"?1:-1;if(n>i)return a==="desc"?-1:1}return a==="desc"?o-s:s-o}return 0};e.compareValues=r})(e3);var t3={},a2={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){return typeof r=="symbol"||r instanceof Symbol}e.isSymbol=t})(a2);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=a2,r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(a,s){return Array.isArray(a)?!1:typeof a=="number"||typeof a=="boolean"||a==null||t.isSymbol(a)?!0:typeof a=="string"&&(n.test(a)||!r.test(a))||s!=null&&Object.hasOwn(s,a)}e.isKey=i})(t3);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=e3,r=t3,n=jd;function i(a,s,o,l){if(a==null)return[];o=l?void 0:o,Array.isArray(a)||(a=Object.values(a)),Array.isArray(s)||(s=s==null?[null]:[s]),s.length===0&&(s=[null]),Array.isArray(o)||(o=o==null?[]:[o]),o=o.map(d=>String(d));const c=(d,v)=>{let g=d;for(let y=0;y<v.length&&g!=null;++y)g=g[v[y]];return g},u=(d,v)=>v==null||d==null?v:typeof d=="object"&&"key"in d?Object.hasOwn(v,d.key)?v[d.key]:c(v,d.path):typeof d=="function"?d(v):Array.isArray(d)?c(v,d):typeof v=="object"?v[d]:v,h=s.map(d=>(Array.isArray(d)&&d.length===1&&(d=d[0]),d==null||typeof d=="function"||Array.isArray(d)||r.isKey(d)?d:{key:d,path:n.toPath(d)}));return a.map(d=>({original:d,criteria:h.map(v=>u(v,d))})).slice().sort((d,v)=>{for(let g=0;g<h.length;g++){const y=t.compareValues(d.criteria[g],v.criteria[g],o[g]);if(y!==0)return y}return 0}).map(d=>d.original)}e.orderBy=i})(Q4);var r3={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n=1){const i=[],a=Math.floor(n),s=(o,l)=>{for(let c=0;c<o.length;c++){const u=o[c];Array.isArray(u)&&l<a?s(u,l+1):i.push(u)}};return s(r,0),i}e.flatten=t})(r3);var s2={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=n2,r=Zg,n=Jg,i=qd;function a(s,o,l){return n.isObject(l)&&(typeof o=="number"&&r.isArrayLike(l)&&t.isIndex(o)&&o<l.length||typeof o=="string"&&o in l)?i.eq(l[o],s):!1}e.isIterateeCall=a})(s2);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Q4,r=r3,n=s2;function i(a,...s){const o=s.length;return o>1&&n.isIterateeCall(a,s[0],s[1])?s=[]:o>2&&n.isIterateeCall(s[0],s[1],s[2])&&(s=[s[0]]),t.orderBy(a,r.flatten(s),["asc"])}e.sortBy=i})(J4);var kk=J4.sortBy;const Kd=ko(kk);var n3=e=>e.legend.settings,Ck=e=>e.legend.size,Ok=e=>e.legend.payload;ke([Ok,n3],(e,t)=>{var{itemSorter:r}=t,n=e.flat(1);return r?Kd(n,r):n});var $0=1;function Lk(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],[t,r]=z.useState({height:0,left:0,top:0,width:0}),n=z.useCallback(i=>{if(i!=null){var a=i.getBoundingClientRect(),s={height:a.height,left:a.left,top:a.top,width:a.width};(Math.abs(s.height-t.height)>$0||Math.abs(s.left-t.left)>$0||Math.abs(s.top-t.top)>$0||Math.abs(s.width-t.width)>$0)&&r({height:s.height,left:s.left,top:s.top,width:s.width})}},[t.width,t.height,t.top,t.left,...e]);return[t,n]}function Ln(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var Fk=typeof Symbol=="function"&&Symbol.observable||"@@observable",Ny=Fk,N1=()=>Math.random().toString(36).substring(7).split("").join("."),Dk={INIT:`@@redux/INIT${N1()}`,REPLACE:`@@redux/REPLACE${N1()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${N1()}`},Oh=Dk;function o2(e){if(typeof e!="object"||e===null)return!1;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||Object.getPrototypeOf(e)===null}function i3(e,t,r){if(typeof e!="function")throw new Error(Ln(2));if(typeof t=="function"&&typeof r=="function"||typeof r=="function"&&typeof arguments[3]=="function")throw new Error(Ln(0));if(typeof t=="function"&&typeof r>"u"&&(r=t,t=void 0),typeof r<"u"){if(typeof r!="function")throw new Error(Ln(1));return r(i3)(e,t)}let n=e,i=t,a=new Map,s=a,o=0,l=!1;function c(){s===a&&(s=new Map,a.forEach((y,b)=>{s.set(b,y)}))}function u(){if(l)throw new Error(Ln(3));return i}function h(y){if(typeof y!="function")throw new Error(Ln(4));if(l)throw new Error(Ln(5));let b=!0;c();const E=o++;return s.set(E,y),function(){if(b){if(l)throw new Error(Ln(6));b=!1,c(),s.delete(E),a=null}}}function p(y){if(!o2(y))throw new Error(Ln(7));if(typeof y.type>"u")throw new Error(Ln(8));if(typeof y.type!="string")throw new Error(Ln(17));if(l)throw new Error(Ln(9));try{l=!0,i=n(i,y)}finally{l=!1}return(a=s).forEach(E=>{E()}),y}function d(y){if(typeof y!="function")throw new Error(Ln(10));n=y,p({type:Oh.REPLACE})}function v(){const y=h;return{subscribe(b){if(typeof b!="object"||b===null)throw new Error(Ln(11));function E(){const P=b;P.next&&P.next(u())}return E(),{unsubscribe:y(E)}},[Ny](){return this}}}return p({type:Oh.INIT}),{dispatch:p,subscribe:h,getState:u,replaceReducer:d,[Ny]:v}}function Ik(e){Object.keys(e).forEach(t=>{const r=e[t];if(typeof r(void 0,{type:Oh.INIT})>"u")throw new Error(Ln(12));if(typeof r(void 0,{type:Oh.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(Ln(13))})}function a3(e){const t=Object.keys(e),r={};for(let a=0;a<t.length;a++){const s=t[a];typeof e[s]=="function"&&(r[s]=e[s])}const n=Object.keys(r);let i;try{Ik(r)}catch(a){i=a}return function(s={},o){if(i)throw i;let l=!1;const c={};for(let u=0;u<n.length;u++){const h=n[u],p=r[h],d=s[h],v=p(d,o);if(typeof v>"u")throw o&&o.type,new Error(Ln(14));c[h]=v,l=l||v!==d}return l=l||n.length!==Object.keys(s).length,l?c:s}}function Lh(...e){return e.length===0?t=>t:e.length===1?e[0]:e.reduce((t,r)=>(...n)=>t(r(...n)))}function Mk(...e){return t=>(r,n)=>{const i=t(r,n);let a=()=>{throw new Error(Ln(15))};const s={getState:i.getState,dispatch:(l,...c)=>a(l,...c)},o=e.map(l=>l(s));return a=Lh(...o)(i.dispatch),{...i,dispatch:a}}}function s3(e){return o2(e)&&"type"in e&&typeof e.type=="string"}var o3=Symbol.for("immer-nothing"),Sy=Symbol.for("immer-draftable"),zi=Symbol.for("immer-state");function Aa(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var Mc=Object.getPrototypeOf;function bl(e){return!!e&&!!e[zi]}function Ls(e){var t;return e?l3(e)||Array.isArray(e)||!!e[Sy]||!!((t=e.constructor)!=null&&t[Sy])||Xd(e)||Zd(e):!1}var Rk=Object.prototype.constructor.toString();function l3(e){if(!e||typeof e!="object")return!1;const t=Mc(e);if(t===null)return!0;const r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return r===Object?!0:typeof r=="function"&&Function.toString.call(r)===Rk}function Fh(e,t){Yd(e)===0?Reflect.ownKeys(e).forEach(r=>{t(r,e[r],e)}):e.forEach((r,n)=>t(n,r,e))}function Yd(e){const t=e[zi];return t?t.type_:Array.isArray(e)?1:Xd(e)?2:Zd(e)?3:0}function Mm(e,t){return Yd(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function c3(e,t,r){const n=Yd(e);n===2?e.set(t,r):n===3?e.add(r):e[t]=r}function Bk(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function Xd(e){return e instanceof Map}function Zd(e){return e instanceof Set}function Xo(e){return e.copy_||e.base_}function Rm(e,t){if(Xd(e))return new Map(e);if(Zd(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const r=l3(e);if(t===!0||t==="class_only"&&!r){const n=Object.getOwnPropertyDescriptors(e);delete n[zi];let i=Reflect.ownKeys(n);for(let a=0;a<i.length;a++){const s=i[a],o=n[s];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(n[s]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[s]})}return Object.create(Mc(e),n)}else{const n=Mc(e);if(n!==null&&r)return{...e};const i=Object.create(n);return Object.assign(i,e)}}function l2(e,t=!1){return Jd(e)||bl(e)||!Ls(e)||(Yd(e)>1&&(e.set=e.add=e.clear=e.delete=Uk),Object.freeze(e),t&&Object.entries(e).forEach(([r,n])=>l2(n,!0))),e}function Uk(){Aa(2)}function Jd(e){return Object.isFrozen(e)}var $k={};function wl(e){const t=$k[e];return t||Aa(0,e),t}var yf;function u3(){return yf}function zk(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Ay(e,t){t&&(wl("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function Bm(e){Um(e),e.drafts_.forEach(Wk),e.drafts_=null}function Um(e){e===yf&&(yf=e.parent_)}function Ey(e){return yf=zk(yf,e)}function Wk(e){const t=e[zi];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function Ty(e,t){t.unfinalizedDrafts_=t.drafts_.length;const r=t.drafts_[0];return e!==void 0&&e!==r?(r[zi].modified_&&(Bm(t),Aa(4)),Ls(e)&&(e=Dh(t,e),t.parent_||Ih(t,e)),t.patches_&&wl("Patches").generateReplacementPatches_(r[zi].base_,e,t.patches_,t.inversePatches_)):e=Dh(t,r,[]),Bm(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==o3?e:void 0}function Dh(e,t,r){if(Jd(t))return t;const n=t[zi];if(!n)return Fh(t,(i,a)=>Py(e,n,t,i,a,r)),t;if(n.scope_!==e)return t;if(!n.modified_)return Ih(e,n.base_,!0),n.base_;if(!n.finalized_){n.finalized_=!0,n.scope_.unfinalizedDrafts_--;const i=n.copy_;let a=i,s=!1;n.type_===3&&(a=new Set(i),i.clear(),s=!0),Fh(a,(o,l)=>Py(e,n,i,o,l,r,s)),Ih(e,i,!1),r&&e.patches_&&wl("Patches").generatePatches_(n,r,e.patches_,e.inversePatches_)}return n.copy_}function Py(e,t,r,n,i,a,s){if(bl(i)){const o=a&&t&&t.type_!==3&&!Mm(t.assigned_,n)?a.concat(n):void 0,l=Dh(e,i,o);if(c3(r,n,l),bl(l))e.canAutoFreeze_=!1;else return}else s&&r.add(i);if(Ls(i)&&!Jd(i)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;Dh(e,i),(!t||!t.scope_.parent_)&&typeof n!="symbol"&&Object.prototype.propertyIsEnumerable.call(r,n)&&Ih(e,i)}}function Ih(e,t,r=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&l2(t,r)}function qk(e,t){const r=Array.isArray(e),n={type_:r?1:0,scope_:t?t.scope_:u3(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let i=n,a=c2;r&&(i=[n],a=bf);const{revoke:s,proxy:o}=Proxy.revocable(i,a);return n.draft_=o,n.revoke_=s,o}var c2={get(e,t){if(t===zi)return e;const r=Xo(e);if(!Mm(r,t))return Hk(e,r,t);const n=r[t];return e.finalized_||!Ls(n)?n:n===S1(e.base_,t)?(A1(e),e.copy_[t]=zm(n,e)):n},has(e,t){return t in Xo(e)},ownKeys(e){return Reflect.ownKeys(Xo(e))},set(e,t,r){const n=f3(Xo(e),t);if(n!=null&&n.set)return n.set.call(e.draft_,r),!0;if(!e.modified_){const i=S1(Xo(e),t),a=i==null?void 0:i[zi];if(a&&a.base_===r)return e.copy_[t]=r,e.assigned_[t]=!1,!0;if(Bk(r,i)&&(r!==void 0||Mm(e.base_,t)))return!0;A1(e),$m(e)}return e.copy_[t]===r&&(r!==void 0||t in e.copy_)||Number.isNaN(r)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=r,e.assigned_[t]=!0),!0},deleteProperty(e,t){return S1(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,A1(e),$m(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const r=Xo(e),n=Reflect.getOwnPropertyDescriptor(r,t);return n&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:n.enumerable,value:r[t]}},defineProperty(){Aa(11)},getPrototypeOf(e){return Mc(e.base_)},setPrototypeOf(){Aa(12)}},bf={};Fh(c2,(e,t)=>{bf[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});bf.deleteProperty=function(e,t){return bf.set.call(this,e,t,void 0)};bf.set=function(e,t,r){return c2.set.call(this,e[0],t,r,e[0])};function S1(e,t){const r=e[zi];return(r?Xo(r):e)[t]}function Hk(e,t,r){var i;const n=f3(t,r);return n?"value"in n?n.value:(i=n.get)==null?void 0:i.call(e.draft_):void 0}function f3(e,t){if(!(t in e))return;let r=Mc(e);for(;r;){const n=Object.getOwnPropertyDescriptor(r,t);if(n)return n;r=Mc(r)}}function $m(e){e.modified_||(e.modified_=!0,e.parent_&&$m(e.parent_))}function A1(e){e.copy_||(e.copy_=Rm(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var Gk=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,r,n)=>{if(typeof t=="function"&&typeof r!="function"){const a=r;r=t;const s=this;return function(l=a,...c){return s.produce(l,u=>r.call(this,u,...c))}}typeof r!="function"&&Aa(6),n!==void 0&&typeof n!="function"&&Aa(7);let i;if(Ls(t)){const a=Ey(this),s=zm(t,void 0);let o=!0;try{i=r(s),o=!1}finally{o?Bm(a):Um(a)}return Ay(a,n),Ty(i,a)}else if(!t||typeof t!="object"){if(i=r(t),i===void 0&&(i=t),i===o3&&(i=void 0),this.autoFreeze_&&l2(i,!0),n){const a=[],s=[];wl("Patches").generateReplacementPatches_(t,i,a,s),n(a,s)}return i}else Aa(1,t)},this.produceWithPatches=(t,r)=>{if(typeof t=="function")return(s,...o)=>this.produceWithPatches(s,l=>t(l,...o));let n,i;return[this.produce(t,r,(s,o)=>{n=s,i=o}),n,i]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Ls(e)||Aa(8),bl(e)&&(e=Ts(e));const t=Ey(this),r=zm(e,void 0);return r[zi].isManual_=!0,Um(t),r}finishDraft(e,t){const r=e&&e[zi];(!r||!r.isManual_)&&Aa(9);const{scope_:n}=r;return Ay(n,t),Ty(void 0,n)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let r;for(r=t.length-1;r>=0;r--){const i=t[r];if(i.path.length===0&&i.op==="replace"){e=i.value;break}}r>-1&&(t=t.slice(r+1));const n=wl("Patches").applyPatches_;return bl(e)?n(e,t):this.produce(e,i=>n(i,t))}};function zm(e,t){const r=Xd(e)?wl("MapSet").proxyMap_(e,t):Zd(e)?wl("MapSet").proxySet_(e,t):qk(e,t);return(t?t.scope_:u3()).drafts_.push(r),r}function Ts(e){return bl(e)||Aa(10,e),h3(e)}function h3(e){if(!Ls(e)||Jd(e))return e;const t=e[zi];let r;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,r=Rm(e,t.scope_.immer_.useStrictShallowCopy_)}else r=Rm(e,!0);return Fh(r,(n,i)=>{c3(r,n,h3(i))}),t&&(t.finalized_=!1),r}var Wi=new Gk,d3=Wi.produce;Wi.produceWithPatches.bind(Wi);Wi.setAutoFreeze.bind(Wi);Wi.setUseStrictShallowCopy.bind(Wi);Wi.applyPatches.bind(Wi);Wi.createDraft.bind(Wi);Wi.finishDraft.bind(Wi);function p3(e){return({dispatch:r,getState:n})=>i=>a=>typeof a=="function"?a(r,n,e):i(a)}var Vk=p3(),Kk=p3,Yk=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?Lh:Lh.apply(null,arguments)};function oa(e,t){function r(...n){if(t){let i=t(...n);if(!i)throw new Error(Ui(0));return{type:e,payload:i.payload,..."meta"in i&&{meta:i.meta},..."error"in i&&{error:i.error}}}return{type:e,payload:n[0]}}return r.toString=()=>`${e}`,r.type=e,r.match=n=>s3(n)&&n.type===e,r}var m3=class Ju extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,Ju.prototype)}static get[Symbol.species](){return Ju}concat(...t){return super.concat.apply(this,t)}prepend(...t){return t.length===1&&Array.isArray(t[0])?new Ju(...t[0].concat(this)):new Ju(...t.concat(this))}};function jy(e){return Ls(e)?d3(e,()=>{}):e}function z0(e,t,r){return e.has(t)?e.get(t):e.set(t,r(t)).get(t)}function Xk(e){return typeof e=="boolean"}var Zk=()=>function(t){const{thunk:r=!0,immutableCheck:n=!0,serializableCheck:i=!0,actionCreatorCheck:a=!0}=t??{};let s=new m3;return r&&(Xk(r)?s.push(Vk):s.push(Kk(r.extraArgument))),s},Jk="RTK_autoBatch",ky=e=>t=>{setTimeout(t,e)},Qk=(e={type:"raf"})=>t=>(...r)=>{const n=t(...r);let i=!0,a=!1,s=!1;const o=new Set,l=e.type==="tick"?queueMicrotask:e.type==="raf"?typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:ky(10):e.type==="callback"?e.queueNotification:ky(e.timeout),c=()=>{s=!1,a&&(a=!1,o.forEach(u=>u()))};return Object.assign({},n,{subscribe(u){const h=()=>i&&u(),p=n.subscribe(h);return o.add(u),()=>{p(),o.delete(u)}},dispatch(u){var h;try{return i=!((h=u==null?void 0:u.meta)!=null&&h[Jk]),a=!i,a&&(s||(s=!0,l(c))),n.dispatch(u)}finally{i=!0}}})},eC=e=>function(r){const{autoBatch:n=!0}=r??{};let i=new m3(e);return n&&i.push(Qk(typeof n=="object"?n:void 0)),i};function tC(e){const t=Zk(),{reducer:r=void 0,middleware:n,devTools:i=!0,duplicateMiddlewareCheck:a=!0,preloadedState:s=void 0,enhancers:o=void 0}=e||{};let l;if(typeof r=="function")l=r;else if(o2(r))l=a3(r);else throw new Error(Ui(1));let c;typeof n=="function"?c=n(t):c=t();let u=Lh;i&&(u=Yk({trace:!1,...typeof i=="object"&&i}));const h=Mk(...c),p=eC(h);let d=typeof o=="function"?o(p):p();const v=u(...d);return i3(l,s,v)}function g3(e){const t={},r=[];let n;const i={addCase(a,s){const o=typeof a=="string"?a:a.type;if(!o)throw new Error(Ui(28));if(o in t)throw new Error(Ui(29));return t[o]=s,i},addMatcher(a,s){return r.push({matcher:a,reducer:s}),i},addDefaultCase(a){return n=a,i}};return e(i),[t,r,n]}function rC(e){return typeof e=="function"}function nC(e,t){let[r,n,i]=g3(t),a;if(rC(e))a=()=>jy(e());else{const o=jy(e);a=()=>o}function s(o=a(),l){let c=[r[l.type],...n.filter(({matcher:u})=>u(l)).map(({reducer:u})=>u)];return c.filter(u=>!!u).length===0&&(c=[i]),c.reduce((u,h)=>{if(h)if(bl(u)){const d=h(u,l);return d===void 0?u:d}else{if(Ls(u))return d3(u,p=>h(p,l));{const p=h(u,l);if(p===void 0){if(u===null)return u;throw Error("A case reducer on a non-draftable value must not return undefined")}return p}}return u},o)}return s.getInitialState=a,s}var iC="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",aC=(e=21)=>{let t="",r=e;for(;r--;)t+=iC[Math.random()*64|0];return t},sC=Symbol.for("rtk-slice-createasyncthunk");function oC(e,t){return`${e}/${t}`}function lC({creators:e}={}){var r;const t=(r=e==null?void 0:e.asyncThunk)==null?void 0:r[sC];return function(i){const{name:a,reducerPath:s=a}=i;if(!a)throw new Error(Ui(11));typeof process<"u";const o=(typeof i.reducers=="function"?i.reducers(uC()):i.reducers)||{},l=Object.keys(o),c={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},u={addCase(P,L){const q=typeof P=="string"?P:P.type;if(!q)throw new Error(Ui(12));if(q in c.sliceCaseReducersByType)throw new Error(Ui(13));return c.sliceCaseReducersByType[q]=L,u},addMatcher(P,L){return c.sliceMatchers.push({matcher:P,reducer:L}),u},exposeAction(P,L){return c.actionCreators[P]=L,u},exposeCaseReducer(P,L){return c.sliceCaseReducersByName[P]=L,u}};l.forEach(P=>{const L=o[P],q={reducerName:P,type:oC(a,P),createNotation:typeof i.reducers=="function"};hC(L)?pC(q,L,u,t):fC(q,L,u)});function h(){const[P={},L=[],q=void 0]=typeof i.extraReducers=="function"?g3(i.extraReducers):[i.extraReducers],C={...P,...c.sliceCaseReducersByType};return nC(i.initialState,R=>{for(let k in C)R.addCase(k,C[k]);for(let k of c.sliceMatchers)R.addMatcher(k.matcher,k.reducer);for(let k of L)R.addMatcher(k.matcher,k.reducer);q&&R.addDefaultCase(q)})}const p=P=>P,d=new Map,v=new WeakMap;let g;function y(P,L){return g||(g=h()),g(P,L)}function b(){return g||(g=h()),g.getInitialState()}function E(P,L=!1){function q(R){let k=R[P];return typeof k>"u"&&L&&(k=z0(v,q,b)),k}function C(R=p){const k=z0(d,L,()=>new WeakMap);return z0(k,R,()=>{const G={};for(const[_,j]of Object.entries(i.selectors??{}))G[_]=cC(j,R,()=>z0(v,R,b),L);return G})}return{reducerPath:P,getSelectors:C,get selectors(){return C(q)},selectSlice:q}}const S={name:a,reducer:y,actions:c.actionCreators,caseReducers:c.sliceCaseReducersByName,getInitialState:b,...E(s),injectInto(P,{reducerPath:L,...q}={}){const C=L??s;return P.inject({reducerPath:C,reducer:y},q),{...S,...E(C,!0)}}};return S}}function cC(e,t,r,n){function i(a,...s){let o=t(a);return typeof o>"u"&&n&&(o=r()),e(o,...s)}return i.unwrapped=e,i}var Gi=lC();function uC(){function e(t,r){return{_reducerDefinitionType:"asyncThunk",payloadCreator:t,...r}}return e.withTypes=()=>e,{reducer(t){return Object.assign({[t.name](...r){return t(...r)}}[t.name],{_reducerDefinitionType:"reducer"})},preparedReducer(t,r){return{_reducerDefinitionType:"reducerWithPrepare",prepare:t,reducer:r}},asyncThunk:e}}function fC({type:e,reducerName:t,createNotation:r},n,i){let a,s;if("reducer"in n){if(r&&!dC(n))throw new Error(Ui(17));a=n.reducer,s=n.prepare}else a=n;i.addCase(e,a).exposeCaseReducer(t,a).exposeAction(t,s?oa(e,s):oa(e))}function hC(e){return e._reducerDefinitionType==="asyncThunk"}function dC(e){return e._reducerDefinitionType==="reducerWithPrepare"}function pC({type:e,reducerName:t},r,n,i){if(!i)throw new Error(Ui(18));const{payloadCreator:a,fulfilled:s,pending:o,rejected:l,settled:c,options:u}=r,h=i(e,a,u);n.exposeAction(t,h),s&&n.addCase(h.fulfilled,s),o&&n.addCase(h.pending,o),l&&n.addCase(h.rejected,l),c&&n.addMatcher(h.settled,c),n.exposeCaseReducer(t,{fulfilled:s||W0,pending:o||W0,rejected:l||W0,settled:c||W0})}function W0(){}var mC="task",v3="listener",x3="completed",u2="cancelled",gC=`task-${u2}`,vC=`task-${x3}`,Wm=`${v3}-${u2}`,xC=`${v3}-${x3}`,Qd=class{constructor(e){tr(this,"name","TaskAbortError");tr(this,"message");this.code=e,this.message=`${mC} ${u2} (reason: ${e})`}},f2=(e,t)=>{if(typeof e!="function")throw new TypeError(Ui(32))},Mh=()=>{},y3=(e,t=Mh)=>(e.catch(t),e),b3=(e,t)=>(e.addEventListener("abort",t,{once:!0}),()=>e.removeEventListener("abort",t)),hl=(e,t)=>{const r=e.signal;r.aborted||("reason"in r||Object.defineProperty(r,"reason",{enumerable:!0,value:t,configurable:!0,writable:!0}),e.abort(t))},dl=e=>{if(e.aborted){const{reason:t}=e;throw new Qd(t)}};function w3(e,t){let r=Mh;return new Promise((n,i)=>{const a=()=>i(new Qd(e.reason));if(e.aborted){a();return}r=b3(e,a),t.finally(()=>r()).then(n,i)}).finally(()=>{r=Mh})}var yC=async(e,t)=>{try{return await Promise.resolve(),{status:"ok",value:await e()}}catch(r){return{status:r instanceof Qd?"cancelled":"rejected",error:r}}finally{t==null||t()}},Rh=e=>t=>y3(w3(e,t).then(r=>(dl(e),r))),_3=e=>{const t=Rh(e);return r=>t(new Promise(n=>setTimeout(n,r)))},{assign:xc}=Object,Cy={},ep="listenerMiddleware",bC=(e,t)=>{const r=n=>b3(e,()=>hl(n,e.reason));return(n,i)=>{f2(n);const a=new AbortController;r(a);const s=yC(async()=>{dl(e),dl(a.signal);const o=await n({pause:Rh(a.signal),delay:_3(a.signal),signal:a.signal});return dl(a.signal),o},()=>hl(a,vC));return i!=null&&i.autoJoin&&t.push(s.catch(Mh)),{result:Rh(e)(s),cancel(){hl(a,gC)}}}},wC=(e,t)=>{const r=async(n,i)=>{dl(t);let a=()=>{};const o=[new Promise((l,c)=>{let u=e({predicate:n,effect:(h,p)=>{p.unsubscribe(),l([h,p.getState(),p.getOriginalState()])}});a=()=>{u(),c()}})];i!=null&&o.push(new Promise(l=>setTimeout(l,i,null)));try{const l=await w3(t,Promise.race(o));return dl(t),l}finally{a()}};return(n,i)=>y3(r(n,i))},N3=e=>{let{type:t,actionCreator:r,matcher:n,predicate:i,effect:a}=e;if(t)i=oa(t).match;else if(r)t=r.type,i=r.match;else if(n)i=n;else if(!i)throw new Error(Ui(21));return f2(a),{predicate:i,type:t,effect:a}},S3=xc(e=>{const{type:t,predicate:r,effect:n}=N3(e);return{id:aC(),effect:n,type:t,predicate:r,pending:new Set,unsubscribe:()=>{throw new Error(Ui(22))}}},{withTypes:()=>S3}),Oy=(e,t)=>{const{type:r,effect:n,predicate:i}=N3(t);return Array.from(e.values()).find(a=>(typeof r=="string"?a.type===r:a.predicate===i)&&a.effect===n)},qm=e=>{e.pending.forEach(t=>{hl(t,Wm)})},_C=e=>()=>{e.forEach(qm),e.clear()},Ly=(e,t,r)=>{try{e(t,r)}catch(n){setTimeout(()=>{throw n},0)}},A3=xc(oa(`${ep}/add`),{withTypes:()=>A3}),NC=oa(`${ep}/removeAll`),E3=xc(oa(`${ep}/remove`),{withTypes:()=>E3}),SC=(...e)=>{console.error(`${ep}/error`,...e)},Gf=(e={})=>{const t=new Map,{extra:r,onError:n=SC}=e;f2(n);const i=u=>(u.unsubscribe=()=>t.delete(u.id),t.set(u.id,u),h=>{u.unsubscribe(),h!=null&&h.cancelActive&&qm(u)}),a=u=>{const h=Oy(t,u)??S3(u);return i(h)};xc(a,{withTypes:()=>a});const s=u=>{const h=Oy(t,u);return h&&(h.unsubscribe(),u.cancelActive&&qm(h)),!!h};xc(s,{withTypes:()=>s});const o=async(u,h,p,d)=>{const v=new AbortController,g=wC(a,v.signal),y=[];try{u.pending.add(v),await Promise.resolve(u.effect(h,xc({},p,{getOriginalState:d,condition:(b,E)=>g(b,E).then(Boolean),take:g,delay:_3(v.signal),pause:Rh(v.signal),extra:r,signal:v.signal,fork:bC(v.signal,y),unsubscribe:u.unsubscribe,subscribe:()=>{t.set(u.id,u)},cancelActiveListeners:()=>{u.pending.forEach((b,E,S)=>{b!==v&&(hl(b,Wm),S.delete(b))})},cancel:()=>{hl(v,Wm),u.pending.delete(v)},throwIfCancelled:()=>{dl(v.signal)}})))}catch(b){b instanceof Qd||Ly(n,b,{raisedBy:"effect"})}finally{await Promise.all(y),hl(v,xC),u.pending.delete(v)}},l=_C(t);return{middleware:u=>h=>p=>{if(!s3(p))return h(p);if(A3.match(p))return a(p.payload);if(NC.match(p)){l();return}if(E3.match(p))return s(p.payload);let d=u.getState();const v=()=>{if(d===Cy)throw new Error(Ui(23));return d};let g;try{if(g=h(p),t.size>0){const y=u.getState(),b=Array.from(t.values());for(const E of b){let S=!1;try{S=E.predicate(p,y,d)}catch(P){S=!1,Ly(n,P,{raisedBy:"predicate"})}S&&o(E,p,u,v)}}}finally{d=Cy}return g},startListening:a,stopListening:s,clearListeners:l}};function Ui(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var AC={layoutType:"horizontal",width:0,height:0,margin:{top:5,right:5,bottom:5,left:5},scale:1},T3=Gi({name:"chartLayout",initialState:AC,reducers:{setLayout(e,t){e.layoutType=t.payload},setChartSize(e,t){e.width=t.payload.width,e.height=t.payload.height},setMargin(e,t){e.margin.top=t.payload.top,e.margin.right=t.payload.right,e.margin.bottom=t.payload.bottom,e.margin.left=t.payload.left},setScale(e,t){e.scale=t.payload}}}),{setMargin:EC,setLayout:TC,setChartSize:PC,setScale:jC}=T3.actions,kC=T3.reducer;function Fy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Dy(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Fy(Object(r),!0).forEach(function(n){CC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function CC(e,t,r){return(t=OC(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function OC(e){var t=LC(e,"string");return typeof t=="symbol"?t:t+""}function LC(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bh=Math.PI/180,FC=e=>e*180/Math.PI,Kn=(e,t,r,n)=>({x:e+Math.cos(-Bh*n)*r,y:t+Math.sin(-Bh*n)*r}),P3=function(t,r){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{top:0,right:0,bottom:0,left:0,width:0,height:0,brushBottom:0};return Math.min(Math.abs(t-(n.left||0)-(n.right||0)),Math.abs(r-(n.top||0)-(n.bottom||0)))/2},DC=(e,t)=>{var{x:r,y:n}=e,{x:i,y:a}=t;return Math.sqrt((r-i)**2+(n-a)**2)},IC=(e,t)=>{var{x:r,y:n}=e,{cx:i,cy:a}=t,s=DC({x:r,y:n},{x:i,y:a});if(s<=0)return{radius:s,angle:0};var o=(r-i)/s,l=Math.acos(o);return n>a&&(l=2*Math.PI-l),{radius:s,angle:FC(l),angleInRadian:l}},MC=e=>{var{startAngle:t,endAngle:r}=e,n=Math.floor(t/360),i=Math.floor(r/360),a=Math.min(n,i);return{startAngle:t-a*360,endAngle:r-a*360}},RC=(e,t)=>{var{startAngle:r,endAngle:n}=t,i=Math.floor(r/360),a=Math.floor(n/360),s=Math.min(i,a);return e+s*360},BC=(e,t)=>{var{x:r,y:n}=e,{radius:i,angle:a}=IC({x:r,y:n},t),{innerRadius:s,outerRadius:o}=t;if(i<s||i>o||i===0)return null;var{startAngle:l,endAngle:c}=MC(t),u=a,h;if(l<=c){for(;u>c;)u-=360;for(;u<l;)u+=360;h=u>=l&&u<=c}else{for(;u>l;)u-=360;for(;u<c;)u+=360;h=u>=c&&u<=l}return h?Dy(Dy({},t),{},{radius:i,angle:RC(u,t)}):null};function j3(e,t,r){return Array.isArray(e)&&e&&t+r!==0?e.slice(t,r+1):e}function Iy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ia(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Iy(Object(r),!0).forEach(function(n){UC(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Iy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function UC(e,t,r){return(t=$C(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function $C(e){var t=zC(e,"string");return typeof t=="symbol"?t:t+""}function zC(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function an(e,t,r){return yl(e)||yl(t)?r:Os(t)?Lc(e,t,r):typeof t=="function"?t(e):r}var WC=(e,t,r,n,i)=>{var a,s=-1,o=(a=t==null?void 0:t.length)!==null&&a!==void 0?a:0;if(o<=1||e==null)return 0;if(n==="angleAxis"&&i!=null&&Math.abs(Math.abs(i[1]-i[0])-360)<=1e-6)for(var l=0;l<o;l++){var c=l>0?r[l-1].coordinate:r[o-1].coordinate,u=r[l].coordinate,h=l>=o-1?r[0].coordinate:r[l+1].coordinate,p=void 0;if(Mi(u-c)!==Mi(h-u)){var d=[];if(Mi(h-u)===Mi(i[1]-i[0])){p=h;var v=u+i[1]-i[0];d[0]=Math.min(v,(v+c)/2),d[1]=Math.max(v,(v+c)/2)}else{p=c;var g=h+i[1]-i[0];d[0]=Math.min(u,(g+u)/2),d[1]=Math.max(u,(g+u)/2)}var y=[Math.min(u,(p+u)/2),Math.max(u,(p+u)/2)];if(e>y[0]&&e<=y[1]||e>=d[0]&&e<=d[1]){({index:s}=r[l]);break}}else{var b=Math.min(c,h),E=Math.max(c,h);if(e>(b+u)/2&&e<=(E+u)/2){({index:s}=r[l]);break}}}else if(t){for(var S=0;S<o;S++)if(S===0&&e<=(t[S].coordinate+t[S+1].coordinate)/2||S>0&&S<o-1&&e>(t[S].coordinate+t[S-1].coordinate)/2&&e<=(t[S].coordinate+t[S+1].coordinate)/2||S===o-1&&e>(t[S].coordinate+t[S-1].coordinate)/2){({index:s}=t[S]);break}}return s},qC=(e,t,r)=>{if(t&&r){var{width:n,height:i}=r,{align:a,verticalAlign:s,layout:o}=t;if((o==="vertical"||o==="horizontal"&&s==="middle")&&a!=="center"&&Vt(e[a]))return ia(ia({},e),{},{[a]:e[a]+(n||0)});if((o==="horizontal"||o==="vertical"&&a==="center")&&s!=="middle"&&Vt(e[s]))return ia(ia({},e),{},{[s]:e[s]+(i||0)})}return e},jl=(e,t)=>e==="horizontal"&&t==="xAxis"||e==="vertical"&&t==="yAxis"||e==="centric"&&t==="angleAxis"||e==="radial"&&t==="radiusAxis",My=1e-4,HC=e=>{var t=e.domain();if(!(!t||t.length<=2)){var r=t.length,n=e.range(),i=Math.min(n[0],n[1])-My,a=Math.max(n[0],n[1])+My,s=e(t[0]),o=e(t[r-1]);(s<i||s>a||o<i||o>a)&&e.domain([t[0],t[r-1]])}},GC=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var i=0,a=0,s=0;s<t;++s){var o=Ca(e[s][r][1])?e[s][r][0]:e[s][r][1];o>=0?(e[s][r][0]=i,e[s][r][1]=i+o,i=e[s][r][1]):(e[s][r][0]=a,e[s][r][1]=a+o,a=e[s][r][1])}},VC=e=>{var t=e.length;if(!(t<=0))for(var r=0,n=e[0].length;r<n;++r)for(var i=0,a=0;a<t;++a){var s=Ca(e[a][r][1])?e[a][r][0]:e[a][r][1];s>=0?(e[a][r][0]=i,e[a][r][1]=i+s,i=e[a][r][1]):(e[a][r][0]=0,e[a][r][1]=0)}},KC={sign:GC,expand:Ij,none:Dc,silhouette:Mj,wiggle:Rj,positive:VC},YC=(e,t,r)=>{var n=KC[r],i=Dj().keys(t).value((a,s)=>+an(a,s,0)).order(Dm).offset(n);return i(e)},XC=e=>{var t=e.flat(2).filter(Vt);return[Math.min(...t),Math.max(...t)]},ZC=e=>[e[0]===1/0?0:e[0],e[1]===-1/0?0:e[1]],JC=(e,t,r)=>{if(e!=null)return ZC(Object.keys(e).reduce((n,i)=>{var a=e[i],{stackedData:s}=a,o=s.reduce((l,c)=>{var u=j3(c,t,r),h=XC(u);return[Math.min(l[0],h[0]),Math.max(l[1],h[1])]},[1/0,-1/0]);return[Math.min(o[0],n[0]),Math.max(o[1],n[1])]},[1/0,-1/0]))},Ry=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,By=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,QC=(e,t,r)=>{if(e&&e.scale&&e.scale.bandwidth){var n=e.scale.bandwidth();return n}if(e&&t&&t.length>=2){for(var i=Kd(t,u=>u.coordinate),a=1/0,s=1,o=i.length;s<o;s++){var l=i[s],c=i[s-1];a=Math.min((l.coordinate||0)-(c.coordinate||0),a)}return a===1/0?0:a}return 0};function Uy(e){var{tooltipEntrySettings:t,dataKey:r,payload:n,value:i,name:a}=e;return ia(ia({},t),{},{dataKey:r,payload:n,value:i,name:a})}function k3(e,t){if(e)return String(e);if(typeof t=="string")return t}function eO(e,t,r,n,i){if(r==="horizontal"||r==="vertical"){var a=e>=i.left&&e<=i.left+i.width&&t>=i.top&&t<=i.top+i.height;return a?{x:e,y:t}:null}return n?BC({x:e,y:t},n):null}var tO=(e,t,r,n)=>{var i=t.find(c=>c&&c.index===r);if(i){if(e==="horizontal")return{x:i.coordinate,y:n.y};if(e==="vertical")return{x:n.x,y:i.coordinate};if(e==="centric"){var a=i.coordinate,{radius:s}=n;return ia(ia(ia({},n),Kn(n.cx,n.cy,s,a)),{},{angle:a,radius:s})}var o=i.coordinate,{angle:l}=n;return ia(ia(ia({},n),Kn(n.cx,n.cy,o,l)),{},{angle:l,radius:o})}return{x:0,y:0}},rO=(e,t)=>t==="horizontal"?e.x:t==="vertical"?e.y:t==="centric"?e.angle:e.radius,Us=e=>e.layout.width,$s=e=>e.layout.height,nO=e=>e.layout.scale,C3=e=>e.layout.margin,h2=ke(e=>e.cartesianAxis.xAxis,e=>Object.values(e)),d2=ke(e=>e.cartesianAxis.yAxis,e=>Object.values(e)),O3="data-recharts-item-index",L3="data-recharts-item-data-key",tp=60;function $y(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ao(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?$y(Object(r),!0).forEach(function(n){iO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):$y(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iO(e,t,r){return(t=aO(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aO(e){var t=sO(e,"string");return typeof t=="symbol"?t:t+""}function sO(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oO=e=>e.brush.height,Jn=ke([Us,$s,C3,oO,h2,d2,n3,Ck],(e,t,r,n,i,a,s,o)=>{var l=a.reduce((v,g)=>{var{orientation:y}=g;if(!g.mirror&&!g.hide){var b=typeof g.width=="number"?g.width:tp;return ao(ao({},v),{},{[y]:v[y]+b})}return v},{left:r.left||0,right:r.right||0}),c=i.reduce((v,g)=>{var{orientation:y}=g;return!g.mirror&&!g.hide?ao(ao({},v),{},{[y]:Lc(v,"".concat(y))+g.height}):v},{top:r.top||0,bottom:r.bottom||0}),u=ao(ao({},c),l),h=u.bottom;u.bottom+=n,u=qC(u,s,o);var p=e-u.left-u.right,d=t-u.top-u.bottom;return ao(ao({brushBottom:h},u),{},{width:Math.max(p,0),height:Math.max(d,0)})}),lO=ke(Jn,e=>({x:e.left,y:e.top,width:e.width,height:e.height}));ke(Us,$s,(e,t)=>({x:0,y:0,width:e,height:t}));var cO=z.createContext(null),Vc=()=>z.useContext(cO)!=null,rp=e=>e.brush,np=ke([rp,Jn,C3],(e,t,r)=>({height:e.height,x:Vt(e.x)?e.x:t.left,y:Vt(e.y)?e.y:t.top+t.height+t.brushBottom-((r==null?void 0:r.bottom)||0),width:Vt(e.width)?e.width:t.width})),F3=()=>{var e,t=Vc(),r=qt(lO),n=qt(np),i=(e=qt(rp))===null||e===void 0?void 0:e.padding;return!t||!n||!i?r:{width:n.width-i.left-i.right,height:n.height-i.top-i.bottom,x:i.left,y:i.top}},uO={top:0,bottom:0,left:0,right:0,width:0,height:0,brushBottom:0},fO=()=>{var e;return(e=qt(Jn))!==null&&e!==void 0?e:uO},hO=()=>qt(Us),dO=()=>qt($s),Ar=e=>e.layout.layoutType,D3=()=>qt(Ar),pO={settings:{layout:"horizontal",align:"center",verticalAlign:"middle",itemSorter:"value"},size:{width:0,height:0},payload:[]},I3=Gi({name:"legend",initialState:pO,reducers:{setLegendSize(e,t){e.size.width=t.payload.width,e.size.height=t.payload.height},setLegendSettings(e,t){e.settings.align=t.payload.align,e.settings.layout=t.payload.layout,e.settings.verticalAlign=t.payload.verticalAlign,e.settings.itemSorter=t.payload.itemSorter},addLegendPayload(e,t){e.payload.push(t.payload)},removeLegendPayload(e,t){var r=Ts(e).payload.indexOf(t.payload);r>-1&&e.payload.splice(r,1)}}}),{setLegendSize:fJ,setLegendSettings:hJ,addLegendPayload:mO,removeLegendPayload:gO}=I3.actions,vO=I3.reducer;function Hm(){return Hm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Hm.apply(null,arguments)}function zy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function E1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zy(Object(r),!0).forEach(function(n){xO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xO(e,t,r){return(t=yO(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yO(e){var t=bO(e,"string");return typeof t=="symbol"?t:t+""}function bO(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function wO(e){return Array.isArray(e)&&Os(e[0])&&Os(e[1])?e.join(" ~ "):e}var _O=e=>{var{separator:t=" : ",contentStyle:r={},itemStyle:n={},labelStyle:i={},payload:a,formatter:s,itemSorter:o,wrapperClassName:l,labelClassName:c,label:u,labelFormatter:h,accessibilityLayer:p=!1}=e,d=()=>{if(a&&a.length){var L={padding:0,margin:0},q=(o?Kd(a,o):a).map((C,R)=>{if(C.type==="none")return null;var k=C.formatter||s||wO,{value:G,name:_}=C,j=G,H=_;if(k){var X=k(G,_,C,R,a);if(Array.isArray(X))[j,H]=X;else if(X!=null)j=X;else return null}var ce=E1({display:"block",paddingTop:4,paddingBottom:4,color:C.color||"#000"},n);return z.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat(R),style:ce},Os(H)?z.createElement("span",{className:"recharts-tooltip-item-name"},H):null,Os(H)?z.createElement("span",{className:"recharts-tooltip-item-separator"},t):null,z.createElement("span",{className:"recharts-tooltip-item-value"},j),z.createElement("span",{className:"recharts-tooltip-item-unit"},C.unit||""))});return z.createElement("ul",{className:"recharts-tooltip-item-list",style:L},q)}return null},v=E1({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},r),g=E1({margin:0},i),y=!yl(u),b=y?u:"",E=An("recharts-default-tooltip",l),S=An("recharts-tooltip-label",c);y&&h&&a!==void 0&&a!==null&&(b=h(u,a));var P=p?{role:"status","aria-live":"assertive"}:{};return z.createElement("div",Hm({className:E,style:v},P),z.createElement("p",{className:S,style:g},z.isValidElement(b)?b:"".concat(b)),d())},Ru="recharts-tooltip-wrapper",NO={visibility:"hidden"};function SO(e){var{coordinate:t,translateX:r,translateY:n}=e;return An(Ru,{["".concat(Ru,"-right")]:Vt(r)&&t&&Vt(t.x)&&r>=t.x,["".concat(Ru,"-left")]:Vt(r)&&t&&Vt(t.x)&&r<t.x,["".concat(Ru,"-bottom")]:Vt(n)&&t&&Vt(t.y)&&n>=t.y,["".concat(Ru,"-top")]:Vt(n)&&t&&Vt(t.y)&&n<t.y})}function Wy(e){var{allowEscapeViewBox:t,coordinate:r,key:n,offsetTopLeft:i,position:a,reverseDirection:s,tooltipDimension:o,viewBox:l,viewBoxDimension:c}=e;if(a&&Vt(a[n]))return a[n];var u=r[n]-o-(i>0?i:0),h=r[n]+i;if(t[n])return s[n]?u:h;var p=l[n];if(p==null)return 0;if(s[n]){var d=u,v=p;return d<v?Math.max(h,p):Math.max(u,p)}if(c==null)return 0;var g=h+o,y=p+c;return g>y?Math.max(u,p):Math.max(h,p)}function AO(e){var{translateX:t,translateY:r,useTranslate3d:n}=e;return{transform:n?"translate3d(".concat(t,"px, ").concat(r,"px, 0)"):"translate(".concat(t,"px, ").concat(r,"px)")}}function EO(e){var{allowEscapeViewBox:t,coordinate:r,offsetTopLeft:n,position:i,reverseDirection:a,tooltipBox:s,useTranslate3d:o,viewBox:l}=e,c,u,h;return s.height>0&&s.width>0&&r?(u=Wy({allowEscapeViewBox:t,coordinate:r,key:"x",offsetTopLeft:n,position:i,reverseDirection:a,tooltipDimension:s.width,viewBox:l,viewBoxDimension:l.width}),h=Wy({allowEscapeViewBox:t,coordinate:r,key:"y",offsetTopLeft:n,position:i,reverseDirection:a,tooltipDimension:s.height,viewBox:l,viewBoxDimension:l.height}),c=AO({translateX:u,translateY:h,useTranslate3d:o})):c=NO,{cssProperties:c,cssClasses:SO({translateX:u,translateY:h,coordinate:r})}}function qy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function q0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qy(Object(r),!0).forEach(function(n){Gm(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function Gm(e,t,r){return(t=TO(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function TO(e){var t=PO(e,"string");return typeof t=="symbol"?t:t+""}function PO(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class jO extends z.PureComponent{constructor(){super(...arguments),Gm(this,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0}}),Gm(this,"handleKeyDown",t=>{if(t.key==="Escape"){var r,n,i,a;this.setState({dismissed:!0,dismissedAtCoordinate:{x:(r=(n=this.props.coordinate)===null||n===void 0?void 0:n.x)!==null&&r!==void 0?r:0,y:(i=(a=this.props.coordinate)===null||a===void 0?void 0:a.y)!==null&&i!==void 0?i:0}})}})}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}componentDidUpdate(){var t,r;this.state.dismissed&&(((t=this.props.coordinate)===null||t===void 0?void 0:t.x)!==this.state.dismissedAtCoordinate.x||((r=this.props.coordinate)===null||r===void 0?void 0:r.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}render(){var{active:t,allowEscapeViewBox:r,animationDuration:n,animationEasing:i,children:a,coordinate:s,hasPayload:o,isAnimationActive:l,offset:c,position:u,reverseDirection:h,useTranslate3d:p,viewBox:d,wrapperStyle:v,lastBoundingBox:g,innerRef:y,hasPortalFromProps:b}=this.props,{cssClasses:E,cssProperties:S}=EO({allowEscapeViewBox:r,coordinate:s,offsetTopLeft:c,position:u,reverseDirection:h,tooltipBox:{height:g.height,width:g.width},useTranslate3d:p,viewBox:d}),P=b?{}:q0(q0({transition:l&&t?"transform ".concat(n,"ms ").concat(i):void 0},S),{},{pointerEvents:"none",visibility:!this.state.dismissed&&t&&o?"visible":"hidden",position:"absolute",top:0,left:0}),L=q0(q0({},P),{},{visibility:!this.state.dismissed&&t&&o?"visible":"hidden"},v);return z.createElement("div",{xmlns:"http://www.w3.org/1999/xhtml",tabIndex:-1,className:E,style:L,ref:y},a)}}var kO=()=>!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout),ip={isSsr:kO()},M3=()=>qt(e=>e.rootProps.accessibilityLayer);function Oa(e){return Number.isFinite(e)}function Uh(e){return typeof e=="number"&&e>0&&Number.isFinite(e)}function Vm(){return Vm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Vm.apply(null,arguments)}function Hy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Gy(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Hy(Object(r),!0).forEach(function(n){CO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function CO(e,t,r){return(t=OO(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function OO(e){var t=LO(e,"string");return typeof t=="symbol"?t:t+""}function LO(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Vy={curveBasisClosed:Sj,curveBasisOpen:Aj,curveBasis:Nj,curveBumpX:cj,curveBumpY:uj,curveLinearClosed:Ej,curveLinear:zd,curveMonotoneX:Tj,curveMonotoneY:Pj,curveNatural:jj,curveStep:kj,curveStepAfter:Oj,curveStepBefore:Cj},H0=e=>Oa(e.x)&&Oa(e.y),Bu=e=>e.x,Uu=e=>e.y,FO=(e,t)=>{if(typeof e=="function")return e;var r="curve".concat(Hf(e));return(r==="curveMonotone"||r==="curveBump")&&t?Vy["".concat(r).concat(t==="vertical"?"Y":"X")]:Vy[r]||zd},DO=e=>{var{type:t="linear",points:r=[],baseLine:n,layout:i,connectNulls:a=!1}=e,s=FO(t,i),o=a?r.filter(H0):r,l;if(Array.isArray(n)){var c=a?n.filter(h=>H0(h)):n,u=o.map((h,p)=>Gy(Gy({},h),{},{base:c[p]}));return i==="vertical"?l=B0().y(Uu).x1(Bu).x0(h=>h.base.x):l=B0().x(Bu).y1(Uu).y0(h=>h.base.y),l.defined(H0).curve(s),l(u)}return i==="vertical"&&Vt(n)?l=B0().y(Uu).x1(Bu).x0(n):Vt(n)?l=B0().x(Bu).y1(Uu).y0(n):l=y4().x(Bu).y(Uu),l.defined(H0).curve(s),l(o)},R3=e=>{var{className:t,points:r,path:n,pathRef:i}=e;if((!r||!r.length)&&!n)return null;var a=r&&r.length?DO(e):n;return z.createElement("path",Vm({},Ud(e),KP(e),{className:An("recharts-curve",t),d:a===null?void 0:a,ref:i}))},IO=["x","y","top","left","width","height","className"];function Km(){return Km=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Km.apply(null,arguments)}function Ky(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function MO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ky(Object(r),!0).forEach(function(n){RO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ky(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function RO(e,t,r){return(t=BO(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BO(e){var t=UO(e,"string");return typeof t=="symbol"?t:t+""}function UO(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function $O(e,t){if(e==null)return{};var r,n,i=zO(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function zO(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var WO=(e,t,r,n,i,a)=>"M".concat(e,",").concat(i,"v").concat(n,"M").concat(a,",").concat(t,"h").concat(r),qO=e=>{var{x:t=0,y:r=0,top:n=0,left:i=0,width:a=0,height:s=0,className:o}=e,l=$O(e,IO),c=MO({x:t,y:r,top:n,left:i,width:a,height:s},l);return!Vt(t)||!Vt(r)||!Vt(a)||!Vt(s)||!Vt(n)||!Vt(i)?null:z.createElement("path",Km({},$i(c,!0),{className:An("recharts-cross",o),d:WO(t,r,a,s,n,i)}))};function HO(e,t,r,n){var i=n/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-i:r.left+.5,y:e==="horizontal"?r.top+.5:t.y-i,width:e==="horizontal"?n:r.width-1,height:e==="horizontal"?r.height-1:n}}function Yy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function GO(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Yy(Object(r),!0).forEach(function(n){VO(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function VO(e,t,r){return(t=KO(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function KO(e){var t=YO(e,"string");return typeof t=="symbol"?t:t+""}function YO(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Co(e,t){var r=GO({},e),n=t,i=Object.keys(t),a=i.reduce((s,o)=>(s[o]===void 0&&n[o]!==void 0&&(s[o]=n[o]),s),r);return a}var B3={},U3={},$3={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){if(!r||typeof r!="object")return!1;const n=Object.getPrototypeOf(r);return n===null||n===Object.prototype||Object.getPrototypeOf(n)===null?Object.prototype.toString.call(r)==="[object Object]":!1}e.isPlainObject=t})($3);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=$3,r=r2,n=Hd,i=Gd,a=qd;function s(c,u,h){return o(c,u,void 0,void 0,void 0,void 0,h)}function o(c,u,h,p,d,v,g){const y=g(c,u,h,p,d,v);if(y!==void 0)return y;if(typeof c==typeof u)switch(typeof c){case"bigint":case"string":case"boolean":case"symbol":case"undefined":return c===u;case"number":return c===u||Object.is(c,u);case"function":return c===u;case"object":return l(c,u,v,g)}return l(c,u,v,g)}function l(c,u,h,p){if(Object.is(c,u))return!0;let d=n.getTag(c),v=n.getTag(u);if(d===i.argumentsTag&&(d=i.objectTag),v===i.argumentsTag&&(v=i.objectTag),d!==v)return!1;switch(d){case i.stringTag:return c.toString()===u.toString();case i.numberTag:{const b=c.valueOf(),E=u.valueOf();return a.eq(b,E)}case i.booleanTag:case i.dateTag:case i.symbolTag:return Object.is(c.valueOf(),u.valueOf());case i.regexpTag:return c.source===u.source&&c.flags===u.flags;case i.functionTag:return c===u}h=h??new Map;const g=h.get(c),y=h.get(u);if(g!=null&&y!=null)return g===u;h.set(c,u),h.set(u,c);try{switch(d){case i.mapTag:{if(c.size!==u.size)return!1;for(const[b,E]of c.entries())if(!u.has(b)||!o(E,u.get(b),b,c,u,h,p))return!1;return!0}case i.setTag:{if(c.size!==u.size)return!1;const b=Array.from(c.values()),E=Array.from(u.values());for(let S=0;S<b.length;S++){const P=b[S],L=E.findIndex(q=>o(P,q,void 0,c,u,h,p));if(L===-1)return!1;E.splice(L,1)}return!0}case i.arrayTag:case i.uint8ArrayTag:case i.uint8ClampedArrayTag:case i.uint16ArrayTag:case i.uint32ArrayTag:case i.bigUint64ArrayTag:case i.int8ArrayTag:case i.int16ArrayTag:case i.int32ArrayTag:case i.bigInt64ArrayTag:case i.float32ArrayTag:case i.float64ArrayTag:{if(typeof Buffer<"u"&&Buffer.isBuffer(c)!==Buffer.isBuffer(u)||c.length!==u.length)return!1;for(let b=0;b<c.length;b++)if(!o(c[b],u[b],b,c,u,h,p))return!1;return!0}case i.arrayBufferTag:return c.byteLength!==u.byteLength?!1:l(new Uint8Array(c),new Uint8Array(u),h,p);case i.dataViewTag:return c.byteLength!==u.byteLength||c.byteOffset!==u.byteOffset?!1:l(new Uint8Array(c),new Uint8Array(u),h,p);case i.errorTag:return c.name===u.name&&c.message===u.message;case i.objectTag:{if(!(l(c.constructor,u.constructor,h,p)||t.isPlainObject(c)&&t.isPlainObject(u)))return!1;const E=[...Object.keys(c),...r.getSymbols(c)],S=[...Object.keys(u),...r.getSymbols(u)];if(E.length!==S.length)return!1;for(let P=0;P<E.length;P++){const L=E[P],q=c[L];if(!Object.hasOwn(u,L))return!1;const C=u[L];if(!o(q,C,L,c,u,h,p))return!1}return!0}default:return!1}}finally{h.delete(c),h.delete(u)}}e.isEqualWith=s})(U3);var z3={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(){}e.noop=t})(z3);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=U3,r=z3;function n(i,a){return t.isEqualWith(i,a,r.noop)}e.isEqual=n})(B3);var XO=B3.isEqual;const ZO=ko(XO);var $h=1e-4,W3=(e,t)=>[0,3*e,3*t-6*e,3*e-3*t+1],q3=(e,t)=>e.map((r,n)=>r*t**n).reduce((r,n)=>r+n),Xy=(e,t)=>r=>{var n=W3(e,t);return q3(n,r)},JO=(e,t)=>r=>{var n=W3(e,t),i=[...n.map((a,s)=>a*s).slice(1),0];return q3(i,r)},Zy=function(){for(var t,r,n,i,a=arguments.length,s=new Array(a),o=0;o<a;o++)s[o]=arguments[o];if(s.length===1)switch(s[0]){case"linear":[t,n,r,i]=[0,0,1,1];break;case"ease":[t,n,r,i]=[.25,.1,.25,1];break;case"ease-in":[t,n,r,i]=[.42,0,1,1];break;case"ease-out":[t,n,r,i]=[.42,0,.58,1];break;case"ease-in-out":[t,n,r,i]=[0,0,.58,1];break;default:{var l=s[0].split("(");l[0]==="cubic-bezier"&&l[1].split(")")[0].split(",").length===4&&([t,n,r,i]=l[1].split(")")[0].split(",").map(v=>parseFloat(v)))}}else s.length===4&&([t,n,r,i]=s);var c=Xy(t,r),u=Xy(n,i),h=JO(t,r),p=v=>v>1?1:v<0?0:v,d=v=>{for(var g=v>1?1:v,y=g,b=0;b<8;++b){var E=c(y)-g,S=h(y);if(Math.abs(E-g)<$h||S<$h)return u(y);y=p(y-E/S)}return u(y)};return d.isStepper=!1,d},QO=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},{stiff:r=100,damping:n=8,dt:i=17}=t,a=(s,o,l)=>{var c=-(s-o)*r,u=l*n,h=l+(c-u)*i/1e3,p=l*i/1e3+s;return Math.abs(p-o)<$h&&Math.abs(h)<$h?[o,0]:[p,h]};return a.isStepper=!0,a.dt=i,a},H3=e=>{if(typeof e=="string")switch(e){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return Zy(e);case"spring":return QO();default:if(e.split("(")[0]==="cubic-bezier")return Zy(e)}return typeof e=="function"?e:null};function Jy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Qy(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Jy(Object(r),!0).forEach(function(n){e7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Jy(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function e7(e,t,r){return(t=t7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function t7(e){var t=r7(e,"string");return typeof t=="symbol"?t:t+""}function r7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var n7=e=>e.replace(/([A-Z])/g,t=>"-".concat(t.toLowerCase())),i7=(e,t,r)=>e.map(n=>"".concat(n7(n)," ").concat(t,"ms ").concat(r)).join(","),a7=(e,t)=>[Object.keys(e),Object.keys(t)].reduce((r,n)=>r.filter(i=>n.includes(i))),wf=(e,t)=>Object.keys(t).reduce((r,n)=>Qy(Qy({},r),{},{[n]:e(n,t[n])}),{});function eb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function In(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?eb(Object(r),!0).forEach(function(n){s7(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):eb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function s7(e,t,r){return(t=o7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o7(e){var t=l7(e,"string");return typeof t=="symbol"?t:t+""}function l7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var zh=(e,t,r)=>e+(t-e)*r,Ym=e=>{var{from:t,to:r}=e;return t!==r},G3=(e,t,r)=>{var n=wf((i,a)=>{if(Ym(a)){var[s,o]=e(a.from,a.to,a.velocity);return In(In({},a),{},{from:s,velocity:o})}return a},t);return r<1?wf((i,a)=>Ym(a)?In(In({},a),{},{velocity:zh(a.velocity,n[i].velocity,r),from:zh(a.from,n[i].from,r)}):a,t):G3(e,n,r-1)};function c7(e,t,r,n,i,a){var s,o=n.reduce((p,d)=>In(In({},p),{},{[d]:{from:e[d],velocity:0,to:t[d]}}),{}),l=()=>wf((p,d)=>d.from,o),c=()=>!Object.values(o).filter(Ym).length,u=null,h=p=>{s||(s=p);var d=p-s,v=d/r.dt;o=G3(r,o,v),i(In(In(In({},e),t),l())),s=p,c()||(u=a.setTimeout(h))};return()=>(u=a.setTimeout(h),()=>{u()})}function u7(e,t,r,n,i,a,s){var o=null,l=i.reduce((h,p)=>In(In({},h),{},{[p]:[e[p],t[p]]}),{}),c,u=h=>{c||(c=h);var p=(h-c)/n,d=wf((g,y)=>zh(...y,r(p)),l);if(a(In(In(In({},e),t),d)),p<1)o=s.setTimeout(u);else{var v=wf((g,y)=>zh(...y,r(1)),l);a(In(In(In({},e),t),v))}};return()=>(o=s.setTimeout(u),()=>{o()})}const V3=(e,t,r,n,i,a)=>{var s=a7(e,t);return r.isStepper===!0?c7(e,t,r,s,i,a):u7(e,t,r,n,s,i,a)};function f7(e){var t,r=()=>null,n=!1,i=null,a=s=>{if(!n){if(Array.isArray(s)){if(!s.length)return;var o=s,[l,...c]=o;if(typeof l=="number"){i=e.setTimeout(a.bind(null,c),l);return}a(l),i=e.setTimeout(a.bind(null,c));return}typeof s=="string"&&(t=s,r(t)),typeof s=="object"&&(t=s,r(t)),typeof s=="function"&&s()}};return{stop:()=>{n=!0},start:s=>{n=!1,i&&(i(),i=null),a(s)},subscribe:s=>(r=s,()=>{r=()=>null}),getTimeoutController:()=>e}}class h7{setTimeout(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=performance.now(),i=null,a=s=>{s-n>=r?t(s):typeof requestAnimationFrame=="function"&&(i=requestAnimationFrame(a))};return i=requestAnimationFrame(a),()=>{cancelAnimationFrame(i)}}}function d7(){return f7(new h7)}var p7=z.createContext(d7);function K3(e,t){var r=z.useContext(p7);return z.useMemo(()=>t??r(e),[e,t,r])}var m7=["children","begin","duration","attributeName","easing","isActive","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart","animationManager"];function Xm(){return Xm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Xm.apply(null,arguments)}function g7(e,t){if(e==null)return{};var r,n,i=v7(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function v7(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function tb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function so(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?tb(Object(r),!0).forEach(function(n){nl(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):tb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function nl(e,t,r){return(t=x7(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function x7(e){var t=y7(e,"string");return typeof t=="symbol"?t:t+""}function y7(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class p2 extends z.PureComponent{constructor(t,r){super(t,r),nl(this,"mounted",!1),nl(this,"manager",void 0),nl(this,"stopJSAnimation",null),nl(this,"unSubscribe",null);var{isActive:n,attributeName:i,from:a,to:s,children:o,duration:l,animationManager:c}=this.props;if(this.manager=c,this.handleStyleChange=this.handleStyleChange.bind(this),this.changeStyle=this.changeStyle.bind(this),!n||l<=0){this.state={style:{}},typeof o=="function"&&(this.state={style:s});return}if(a){if(typeof o=="function"){this.state={style:a};return}this.state={style:i?{[i]:a}:a}}else this.state={style:{}}}componentDidMount(){var{isActive:t,canBegin:r}=this.props;this.mounted=!0,!(!t||!r)&&this.runAnimation(this.props)}componentDidUpdate(t){var{isActive:r,canBegin:n,attributeName:i,shouldReAnimate:a,to:s,from:o}=this.props,{style:l}=this.state;if(n){if(!r){var c={style:i?{[i]:s}:s};this.state&&l&&(i&&l[i]!==s||!i&&l!==s)&&this.setState(c);return}if(!(ZO(t.to,s)&&t.canBegin&&t.isActive)){var u=!t.canBegin||!t.isActive;this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var h=u||a?o:t.to;if(this.state&&l){var p={style:i?{[i]:h}:h};(i&&l[i]!==h||!i&&l!==h)&&this.setState(p)}this.runAnimation(so(so({},this.props),{},{from:h,begin:0}))}}}componentWillUnmount(){this.mounted=!1;var{onAnimationEnd:t}=this.props;this.unSubscribe&&this.unSubscribe(),this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation(),t&&t()}handleStyleChange(t){this.changeStyle(t)}changeStyle(t){this.mounted&&this.setState({style:t})}runJSAnimation(t){var{from:r,to:n,duration:i,easing:a,begin:s,onAnimationEnd:o,onAnimationStart:l}=t,c=V3(r,n,H3(a),i,this.changeStyle,this.manager.getTimeoutController()),u=()=>{this.stopJSAnimation=c()};this.manager.start([l,s,u,i,o])}runAnimation(t){var{begin:r,duration:n,attributeName:i,to:a,easing:s,onAnimationStart:o,onAnimationEnd:l,children:c}=t;if(this.unSubscribe=this.manager.subscribe(this.handleStyleChange),typeof s=="function"||typeof c=="function"||s==="spring"){this.runJSAnimation(t);return}var u=i?{[i]:a}:a,h=i7(Object.keys(u),n,s);this.manager.start([o,r,so(so({},u),{},{transition:h}),n,l])}render(){var t=this.props,{children:r,begin:n,duration:i,attributeName:a,easing:s,isActive:o,from:l,to:c,canBegin:u,onAnimationEnd:h,shouldReAnimate:p,onAnimationReStart:d,animationManager:v}=t,g=g7(t,m7),y=z.Children.count(r),b=this.state.style;if(typeof r=="function")return r(b);if(!o||y===0||i<=0)return r;var E=S=>{var{style:P={},className:L}=S.props,q=z.cloneElement(S,so(so({},g),{},{style:so(so({},P),b),className:L}));return q};return y===1?E(z.Children.only(r)):z.createElement("div",null,z.Children.map(r,S=>E(S)))}}nl(p2,"displayName","Animate");nl(p2,"defaultProps",{begin:0,duration:1e3,attributeName:"",easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}});function Wh(e){var t,r=K3((t=e.attributeName)!==null&&t!==void 0?t:Object.keys(e.to).join(","),e.animationManager);return z.createElement(p2,Xm({},e,{animationManager:r}))}function qh(){return qh=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},qh.apply(null,arguments)}var rb=(e,t,r,n,i)=>{var a=Math.min(Math.abs(r)/2,Math.abs(n)/2),s=n>=0?1:-1,o=r>=0?1:-1,l=n>=0&&r>=0||n<0&&r<0?1:0,c;if(a>0&&i instanceof Array){for(var u=[0,0,0,0],h=0,p=4;h<p;h++)u[h]=i[h]>a?a:i[h];c="M".concat(e,",").concat(t+s*u[0]),u[0]>0&&(c+="A ".concat(u[0],",").concat(u[0],",0,0,").concat(l,",").concat(e+o*u[0],",").concat(t)),c+="L ".concat(e+r-o*u[1],",").concat(t),u[1]>0&&(c+="A ".concat(u[1],",").concat(u[1],",0,0,").concat(l,`,
        `).concat(e+r,",").concat(t+s*u[1])),c+="L ".concat(e+r,",").concat(t+n-s*u[2]),u[2]>0&&(c+="A ".concat(u[2],",").concat(u[2],",0,0,").concat(l,`,
        `).concat(e+r-o*u[2],",").concat(t+n)),c+="L ".concat(e+o*u[3],",").concat(t+n),u[3]>0&&(c+="A ".concat(u[3],",").concat(u[3],",0,0,").concat(l,`,
        `).concat(e,",").concat(t+n-s*u[3])),c+="Z"}else if(a>0&&i===+i&&i>0){var d=Math.min(a,i);c="M ".concat(e,",").concat(t+s*d,`
            A `).concat(d,",").concat(d,",0,0,").concat(l,",").concat(e+o*d,",").concat(t,`
            L `).concat(e+r-o*d,",").concat(t,`
            A `).concat(d,",").concat(d,",0,0,").concat(l,",").concat(e+r,",").concat(t+s*d,`
            L `).concat(e+r,",").concat(t+n-s*d,`
            A `).concat(d,",").concat(d,",0,0,").concat(l,",").concat(e+r-o*d,",").concat(t+n,`
            L `).concat(e+o*d,",").concat(t+n,`
            A `).concat(d,",").concat(d,",0,0,").concat(l,",").concat(e,",").concat(t+n-s*d," Z")}else c="M ".concat(e,",").concat(t," h ").concat(r," v ").concat(n," h ").concat(-r," Z");return c},b7={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},Y3=e=>{var t=Co(e,b7),r=z.useRef(null),[n,i]=z.useState(-1);z.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var b=r.current.getTotalLength();b&&i(b)}catch{}},[]);var{x:a,y:s,width:o,height:l,radius:c,className:u}=t,{animationEasing:h,animationDuration:p,animationBegin:d,isAnimationActive:v,isUpdateAnimationActive:g}=t;if(a!==+a||s!==+s||o!==+o||l!==+l||o===0||l===0)return null;var y=An("recharts-rectangle",u);return g?z.createElement(Wh,{canBegin:n>0,from:{width:o,height:l,x:a,y:s},to:{width:o,height:l,x:a,y:s},duration:p,animationEasing:h,isActive:g},b=>{var{width:E,height:S,x:P,y:L}=b;return z.createElement(Wh,{canBegin:n>0,from:"0px ".concat(n===-1?1:n,"px"),to:"".concat(n,"px 0px"),attributeName:"strokeDasharray",begin:d,duration:p,isActive:v,easing:h},z.createElement("path",qh({},$i(t,!0),{className:y,d:rb(P,L,E,S,c),ref:r})))}):z.createElement("path",qh({},$i(t,!0),{className:y,d:rb(a,s,o,l,c)}))};function X3(e){var{cx:t,cy:r,radius:n,startAngle:i,endAngle:a}=e,s=Kn(t,r,n,i),o=Kn(t,r,n,a);return{points:[s,o],cx:t,cy:r,radius:n,startAngle:i,endAngle:a}}function Zm(){return Zm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Zm.apply(null,arguments)}var w7=(e,t)=>{var r=Mi(t-e),n=Math.min(Math.abs(t-e),359.999);return r*n},G0=e=>{var{cx:t,cy:r,radius:n,angle:i,sign:a,isExternal:s,cornerRadius:o,cornerIsExternal:l}=e,c=o*(s?1:-1)+n,u=Math.asin(o/c)/Bh,h=l?i:i+a*u,p=Kn(t,r,c,h),d=Kn(t,r,n,h),v=l?i-a*u:i,g=Kn(t,r,c*Math.cos(u*Bh),v);return{center:p,circleTangency:d,lineTangency:g,theta:u}},Z3=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:i,startAngle:a,endAngle:s}=e,o=w7(a,s),l=a+o,c=Kn(t,r,i,a),u=Kn(t,r,i,l),h="M ".concat(c.x,",").concat(c.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(o)>180),",").concat(+(a>l),`,
    `).concat(u.x,",").concat(u.y,`
  `);if(n>0){var p=Kn(t,r,n,a),d=Kn(t,r,n,l);h+="L ".concat(d.x,",").concat(d.y,`
            A `).concat(n,",").concat(n,`,0,
            `).concat(+(Math.abs(o)>180),",").concat(+(a<=l),`,
            `).concat(p.x,",").concat(p.y," Z")}else h+="L ".concat(t,",").concat(r," Z");return h},_7=e=>{var{cx:t,cy:r,innerRadius:n,outerRadius:i,cornerRadius:a,forceCornerRadius:s,cornerIsExternal:o,startAngle:l,endAngle:c}=e,u=Mi(c-l),{circleTangency:h,lineTangency:p,theta:d}=G0({cx:t,cy:r,radius:i,angle:l,sign:u,cornerRadius:a,cornerIsExternal:o}),{circleTangency:v,lineTangency:g,theta:y}=G0({cx:t,cy:r,radius:i,angle:c,sign:-u,cornerRadius:a,cornerIsExternal:o}),b=o?Math.abs(l-c):Math.abs(l-c)-d-y;if(b<0)return s?"M ".concat(p.x,",").concat(p.y,`
        a`).concat(a,",").concat(a,",0,0,1,").concat(a*2,`,0
        a`).concat(a,",").concat(a,",0,0,1,").concat(-a*2,`,0
      `):Z3({cx:t,cy:r,innerRadius:n,outerRadius:i,startAngle:l,endAngle:c});var E="M ".concat(p.x,",").concat(p.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(u<0),",").concat(h.x,",").concat(h.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(b>180),",").concat(+(u<0),",").concat(v.x,",").concat(v.y,`
    A`).concat(a,",").concat(a,",0,0,").concat(+(u<0),",").concat(g.x,",").concat(g.y,`
  `);if(n>0){var{circleTangency:S,lineTangency:P,theta:L}=G0({cx:t,cy:r,radius:n,angle:l,sign:u,isExternal:!0,cornerRadius:a,cornerIsExternal:o}),{circleTangency:q,lineTangency:C,theta:R}=G0({cx:t,cy:r,radius:n,angle:c,sign:-u,isExternal:!0,cornerRadius:a,cornerIsExternal:o}),k=o?Math.abs(l-c):Math.abs(l-c)-L-R;if(k<0&&a===0)return"".concat(E,"L").concat(t,",").concat(r,"Z");E+="L".concat(C.x,",").concat(C.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(u<0),",").concat(q.x,",").concat(q.y,`
      A`).concat(n,",").concat(n,",0,").concat(+(k>180),",").concat(+(u>0),",").concat(S.x,",").concat(S.y,`
      A`).concat(a,",").concat(a,",0,0,").concat(+(u<0),",").concat(P.x,",").concat(P.y,"Z")}else E+="L".concat(t,",").concat(r,"Z");return E},N7={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},J3=e=>{var t=Co(e,N7),{cx:r,cy:n,innerRadius:i,outerRadius:a,cornerRadius:s,forceCornerRadius:o,cornerIsExternal:l,startAngle:c,endAngle:u,className:h}=t;if(a<i||c===u)return null;var p=An("recharts-sector",h),d=a-i,v=es(s,d,0,!0),g;return v>0&&Math.abs(c-u)<360?g=_7({cx:r,cy:n,innerRadius:i,outerRadius:a,cornerRadius:Math.min(v,d/2),forceCornerRadius:o,cornerIsExternal:l,startAngle:c,endAngle:u}):g=Z3({cx:r,cy:n,innerRadius:i,outerRadius:a,startAngle:c,endAngle:u}),z.createElement("path",Zm({},$i(t,!0),{className:p,d:g}))};function S7(e,t,r){var n,i,a,s;if(e==="horizontal")n=t.x,a=n,i=r.top,s=r.top+r.height;else if(e==="vertical")i=t.y,s=i,n=r.left,a=r.left+r.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var{cx:o,cy:l,innerRadius:c,outerRadius:u,angle:h}=t,p=Kn(o,l,c,h),d=Kn(o,l,u,h);n=p.x,i=p.y,a=d.x,s=d.y}else return X3(t);return[{x:n,y:i},{x:a,y:s}]}var Q3={},eN={},tN={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=a2;function r(n){return t.isSymbol(n)?NaN:Number(n)}e.toNumber=r})(tN);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=tN;function r(n){return n?(n=t.toNumber(n),n===1/0||n===-1/0?(n<0?-1:1)*Number.MAX_VALUE:n===n?n:0):n===0?n:0}e.toFinite=r})(eN);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=s2,r=eN;function n(i,a,s){s&&typeof s!="number"&&t.isIterateeCall(i,a,s)&&(a=s=void 0),i=r.toFinite(i),a===void 0?(a=i,i=0):a=r.toFinite(a),s=s===void 0?i<a?1:-1:r.toFinite(s);const o=Math.max(Math.ceil((a-i)/(s||1)),0),l=new Array(o);for(let c=0;c<o;c++)l[c]=i,i+=s;return l}e.range=n})(Q3);var A7=Q3.range;const rN=ko(A7);function bo(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function E7(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function m2(e){let t,r,n;e.length!==2?(t=bo,r=(o,l)=>bo(e(o),l),n=(o,l)=>e(o)-l):(t=e===bo||e===E7?e:T7,r=e,n=e);function i(o,l,c=0,u=o.length){if(c<u){if(t(l,l)!==0)return u;do{const h=c+u>>>1;r(o[h],l)<0?c=h+1:u=h}while(c<u)}return c}function a(o,l,c=0,u=o.length){if(c<u){if(t(l,l)!==0)return u;do{const h=c+u>>>1;r(o[h],l)<=0?c=h+1:u=h}while(c<u)}return c}function s(o,l,c=0,u=o.length){const h=i(o,l,c,u-1);return h>c&&n(o[h-1],l)>-n(o[h],l)?h-1:h}return{left:i,center:s,right:a}}function T7(){return 0}function nN(e){return e===null?NaN:+e}function*P7(e,t){for(let r of e)r!=null&&(r=+r)>=r&&(yield r)}const j7=m2(bo),Vf=j7.right;m2(nN).center;class nb extends Map{constructor(t,r=O7){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:r}}),t!=null)for(const[n,i]of t)this.set(n,i)}get(t){return super.get(ib(this,t))}has(t){return super.has(ib(this,t))}set(t,r){return super.set(k7(this,t),r)}delete(t){return super.delete(C7(this,t))}}function ib({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):r}function k7({_intern:e,_key:t},r){const n=t(r);return e.has(n)?e.get(n):(e.set(n,r),r)}function C7({_intern:e,_key:t},r){const n=t(r);return e.has(n)&&(r=e.get(n),e.delete(n)),r}function O7(e){return e!==null&&typeof e=="object"?e.valueOf():e}function L7(e=bo){if(e===bo)return iN;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,r)=>{const n=e(t,r);return n||n===0?n:(e(r,r)===0)-(e(t,t)===0)}}function iN(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const F7=Math.sqrt(50),D7=Math.sqrt(10),I7=Math.sqrt(2);function Hh(e,t,r){const n=(t-e)/Math.max(0,r),i=Math.floor(Math.log10(n)),a=n/Math.pow(10,i),s=a>=F7?10:a>=D7?5:a>=I7?2:1;let o,l,c;return i<0?(c=Math.pow(10,-i)/s,o=Math.round(e*c),l=Math.round(t*c),o/c<e&&++o,l/c>t&&--l,c=-c):(c=Math.pow(10,i)*s,o=Math.round(e/c),l=Math.round(t/c),o*c<e&&++o,l*c>t&&--l),l<o&&.5<=r&&r<2?Hh(e,t,r*2):[o,l,c]}function Jm(e,t,r){if(t=+t,e=+e,r=+r,!(r>0))return[];if(e===t)return[e];const n=t<e,[i,a,s]=n?Hh(t,e,r):Hh(e,t,r);if(!(a>=i))return[];const o=a-i+1,l=new Array(o);if(n)if(s<0)for(let c=0;c<o;++c)l[c]=(a-c)/-s;else for(let c=0;c<o;++c)l[c]=(a-c)*s;else if(s<0)for(let c=0;c<o;++c)l[c]=(i+c)/-s;else for(let c=0;c<o;++c)l[c]=(i+c)*s;return l}function Qm(e,t,r){return t=+t,e=+e,r=+r,Hh(e,t,r)[2]}function eg(e,t,r){t=+t,e=+e,r=+r;const n=t<e,i=n?Qm(t,e,r):Qm(e,t,r);return(n?-1:1)*(i<0?1/-i:i)}function ab(e,t){let r;for(const n of e)n!=null&&(r<n||r===void 0&&n>=n)&&(r=n);return r}function sb(e,t){let r;for(const n of e)n!=null&&(r>n||r===void 0&&n>=n)&&(r=n);return r}function aN(e,t,r=0,n=1/0,i){if(t=Math.floor(t),r=Math.floor(Math.max(0,r)),n=Math.floor(Math.min(e.length-1,n)),!(r<=t&&t<=n))return e;for(i=i===void 0?iN:L7(i);n>r;){if(n-r>600){const l=n-r+1,c=t-r+1,u=Math.log(l),h=.5*Math.exp(2*u/3),p=.5*Math.sqrt(u*h*(l-h)/l)*(c-l/2<0?-1:1),d=Math.max(r,Math.floor(t-c*h/l+p)),v=Math.min(n,Math.floor(t+(l-c)*h/l+p));aN(e,t,d,v,i)}const a=e[t];let s=r,o=n;for($u(e,r,t),i(e[n],a)>0&&$u(e,r,n);s<o;){for($u(e,s,o),++s,--o;i(e[s],a)<0;)++s;for(;i(e[o],a)>0;)--o}i(e[r],a)===0?$u(e,r,o):(++o,$u(e,o,n)),o<=t&&(r=o+1),t<=o&&(n=o-1)}return e}function $u(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function M7(e,t,r){if(e=Float64Array.from(P7(e)),!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return sb(e);if(t>=1)return ab(e);var n,i=(n-1)*t,a=Math.floor(i),s=ab(aN(e,a).subarray(0,a+1)),o=sb(e.subarray(a+1));return s+(o-s)*(i-a)}}function R7(e,t,r=nN){if(!(!(n=e.length)||isNaN(t=+t))){if(t<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,i=(n-1)*t,a=Math.floor(i),s=+r(e[a],a,e),o=+r(e[a+1],a+1,e);return s+(o-s)*(i-a)}}function B7(e,t,r){e=+e,t=+t,r=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+r;for(var n=-1,i=Math.max(0,Math.ceil((t-e)/r))|0,a=new Array(i);++n<i;)a[n]=e+n*r;return a}function fa(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function zs(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const tg=Symbol("implicit");function g2(){var e=new nb,t=[],r=[],n=tg;function i(a){let s=e.get(a);if(s===void 0){if(n!==tg)return n;e.set(a,s=t.push(a)-1)}return r[s%r.length]}return i.domain=function(a){if(!arguments.length)return t.slice();t=[],e=new nb;for(const s of a)e.has(s)||e.set(s,t.push(s)-1);return i},i.range=function(a){return arguments.length?(r=Array.from(a),i):r.slice()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return g2(t,r).unknown(n)},fa.apply(i,arguments),i}function v2(){var e=g2().unknown(void 0),t=e.domain,r=e.range,n=0,i=1,a,s,o=!1,l=0,c=0,u=.5;delete e.unknown;function h(){var p=t().length,d=i<n,v=d?i:n,g=d?n:i;a=(g-v)/Math.max(1,p-l+c*2),o&&(a=Math.floor(a)),v+=(g-v-a*(p-l))*u,s=a*(1-l),o&&(v=Math.round(v),s=Math.round(s));var y=B7(p).map(function(b){return v+a*b});return r(d?y.reverse():y)}return e.domain=function(p){return arguments.length?(t(p),h()):t()},e.range=function(p){return arguments.length?([n,i]=p,n=+n,i=+i,h()):[n,i]},e.rangeRound=function(p){return[n,i]=p,n=+n,i=+i,o=!0,h()},e.bandwidth=function(){return s},e.step=function(){return a},e.round=function(p){return arguments.length?(o=!!p,h()):o},e.padding=function(p){return arguments.length?(l=Math.min(1,c=+p),h()):l},e.paddingInner=function(p){return arguments.length?(l=Math.min(1,p),h()):l},e.paddingOuter=function(p){return arguments.length?(c=+p,h()):c},e.align=function(p){return arguments.length?(u=Math.max(0,Math.min(1,p)),h()):u},e.copy=function(){return v2(t(),[n,i]).round(o).paddingInner(l).paddingOuter(c).align(u)},fa.apply(h(),arguments)}function sN(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return sN(t())},e}function U7(){return sN(v2.apply(null,arguments).paddingInner(1))}function x2(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function oN(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Kf(){}var _f=.7,Gh=1/_f,yc="\\s*([+-]?\\d+)\\s*",Nf="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ts="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",$7=/^#([0-9a-f]{3,8})$/,z7=new RegExp(`^rgb\\(${yc},${yc},${yc}\\)$`),W7=new RegExp(`^rgb\\(${ts},${ts},${ts}\\)$`),q7=new RegExp(`^rgba\\(${yc},${yc},${yc},${Nf}\\)$`),H7=new RegExp(`^rgba\\(${ts},${ts},${ts},${Nf}\\)$`),G7=new RegExp(`^hsl\\(${Nf},${ts},${ts}\\)$`),V7=new RegExp(`^hsla\\(${Nf},${ts},${ts},${Nf}\\)$`),ob={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};x2(Kf,Sf,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:lb,formatHex:lb,formatHex8:K7,formatHsl:Y7,formatRgb:cb,toString:cb});function lb(){return this.rgb().formatHex()}function K7(){return this.rgb().formatHex8()}function Y7(){return lN(this).formatHsl()}function cb(){return this.rgb().formatRgb()}function Sf(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=$7.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?ub(t):r===3?new mi(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?V0(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?V0(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=z7.exec(e))?new mi(t[1],t[2],t[3],1):(t=W7.exec(e))?new mi(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=q7.exec(e))?V0(t[1],t[2],t[3],t[4]):(t=H7.exec(e))?V0(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=G7.exec(e))?db(t[1],t[2]/100,t[3]/100,1):(t=V7.exec(e))?db(t[1],t[2]/100,t[3]/100,t[4]):ob.hasOwnProperty(e)?ub(ob[e]):e==="transparent"?new mi(NaN,NaN,NaN,0):null}function ub(e){return new mi(e>>16&255,e>>8&255,e&255,1)}function V0(e,t,r,n){return n<=0&&(e=t=r=NaN),new mi(e,t,r,n)}function X7(e){return e instanceof Kf||(e=Sf(e)),e?(e=e.rgb(),new mi(e.r,e.g,e.b,e.opacity)):new mi}function rg(e,t,r,n){return arguments.length===1?X7(e):new mi(e,t,r,n??1)}function mi(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}x2(mi,rg,oN(Kf,{brighter(e){return e=e==null?Gh:Math.pow(Gh,e),new mi(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?_f:Math.pow(_f,e),new mi(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new mi(pl(this.r),pl(this.g),pl(this.b),Vh(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:fb,formatHex:fb,formatHex8:Z7,formatRgb:hb,toString:hb}));function fb(){return`#${il(this.r)}${il(this.g)}${il(this.b)}`}function Z7(){return`#${il(this.r)}${il(this.g)}${il(this.b)}${il((isNaN(this.opacity)?1:this.opacity)*255)}`}function hb(){const e=Vh(this.opacity);return`${e===1?"rgb(":"rgba("}${pl(this.r)}, ${pl(this.g)}, ${pl(this.b)}${e===1?")":`, ${e})`}`}function Vh(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function pl(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function il(e){return e=pl(e),(e<16?"0":"")+e.toString(16)}function db(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new Ea(e,t,r,n)}function lN(e){if(e instanceof Ea)return new Ea(e.h,e.s,e.l,e.opacity);if(e instanceof Kf||(e=Sf(e)),!e)return new Ea;if(e instanceof Ea)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),a=Math.max(t,r,n),s=NaN,o=a-i,l=(a+i)/2;return o?(t===a?s=(r-n)/o+(r<n)*6:r===a?s=(n-t)/o+2:s=(t-r)/o+4,o/=l<.5?a+i:2-a-i,s*=60):o=l>0&&l<1?0:s,new Ea(s,o,l,e.opacity)}function J7(e,t,r,n){return arguments.length===1?lN(e):new Ea(e,t,r,n??1)}function Ea(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}x2(Ea,J7,oN(Kf,{brighter(e){return e=e==null?Gh:Math.pow(Gh,e),new Ea(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?_f:Math.pow(_f,e),new Ea(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new mi(T1(e>=240?e-240:e+120,i,n),T1(e,i,n),T1(e<120?e+240:e-120,i,n),this.opacity)},clamp(){return new Ea(pb(this.h),K0(this.s),K0(this.l),Vh(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Vh(this.opacity);return`${e===1?"hsl(":"hsla("}${pb(this.h)}, ${K0(this.s)*100}%, ${K0(this.l)*100}%${e===1?")":`, ${e})`}`}}));function pb(e){return e=(e||0)%360,e<0?e+360:e}function K0(e){return Math.max(0,Math.min(1,e||0))}function T1(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}const y2=e=>()=>e;function Q7(e,t){return function(r){return e+r*t}}function eL(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function tL(e){return(e=+e)==1?cN:function(t,r){return r-t?eL(t,r,e):y2(isNaN(t)?r:t)}}function cN(e,t){var r=t-e;return r?Q7(e,r):y2(isNaN(e)?t:e)}const mb=function e(t){var r=tL(t);function n(i,a){var s=r((i=rg(i)).r,(a=rg(a)).r),o=r(i.g,a.g),l=r(i.b,a.b),c=cN(i.opacity,a.opacity);return function(u){return i.r=s(u),i.g=o(u),i.b=l(u),i.opacity=c(u),i+""}}return n.gamma=e,n}(1);function rL(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),i;return function(a){for(i=0;i<r;++i)n[i]=e[i]*(1-a)+t[i]*a;return n}}function nL(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function iL(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,i=new Array(n),a=new Array(r),s;for(s=0;s<n;++s)i[s]=Kc(e[s],t[s]);for(;s<r;++s)a[s]=t[s];return function(o){for(s=0;s<n;++s)a[s]=i[s](o);return a}}function aL(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function Kh(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function sL(e,t){var r={},n={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?r[i]=Kc(e[i],t[i]):n[i]=t[i];return function(a){for(i in r)n[i]=r[i](a);return n}}var ng=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,P1=new RegExp(ng.source,"g");function oL(e){return function(){return e}}function lL(e){return function(t){return e(t)+""}}function cL(e,t){var r=ng.lastIndex=P1.lastIndex=0,n,i,a,s=-1,o=[],l=[];for(e=e+"",t=t+"";(n=ng.exec(e))&&(i=P1.exec(t));)(a=i.index)>r&&(a=t.slice(r,a),o[s]?o[s]+=a:o[++s]=a),(n=n[0])===(i=i[0])?o[s]?o[s]+=i:o[++s]=i:(o[++s]=null,l.push({i:s,x:Kh(n,i)})),r=P1.lastIndex;return r<t.length&&(a=t.slice(r),o[s]?o[s]+=a:o[++s]=a),o.length<2?l[0]?lL(l[0].x):oL(t):(t=l.length,function(c){for(var u=0,h;u<t;++u)o[(h=l[u]).i]=h.x(c);return o.join("")})}function Kc(e,t){var r=typeof t,n;return t==null||r==="boolean"?y2(t):(r==="number"?Kh:r==="string"?(n=Sf(t))?(t=n,mb):cL:t instanceof Sf?mb:t instanceof Date?aL:nL(t)?rL:Array.isArray(t)?iL:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?sL:Kh)(e,t)}function b2(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function uL(e,t){t===void 0&&(t=e,e=Kc);for(var r=0,n=t.length-1,i=t[0],a=new Array(n<0?0:n);r<n;)a[r]=e(i,i=t[++r]);return function(s){var o=Math.max(0,Math.min(n-1,Math.floor(s*=n)));return a[o](s-o)}}function fL(e){return function(){return e}}function Yh(e){return+e}var gb=[0,1];function ai(e){return e}function ig(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:fL(isNaN(t)?NaN:.5)}function hL(e,t){var r;return e>t&&(r=e,e=t,t=r),function(n){return Math.max(e,Math.min(t,n))}}function dL(e,t,r){var n=e[0],i=e[1],a=t[0],s=t[1];return i<n?(n=ig(i,n),a=r(s,a)):(n=ig(n,i),a=r(a,s)),function(o){return a(n(o))}}function pL(e,t,r){var n=Math.min(e.length,t.length)-1,i=new Array(n),a=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<n;)i[s]=ig(e[s],e[s+1]),a[s]=r(t[s],t[s+1]);return function(o){var l=Vf(e,o,1,n)-1;return a[l](i[l](o))}}function Yf(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function ap(){var e=gb,t=gb,r=Kc,n,i,a,s=ai,o,l,c;function u(){var p=Math.min(e.length,t.length);return s!==ai&&(s=hL(e[0],e[p-1])),o=p>2?pL:dL,l=c=null,h}function h(p){return p==null||isNaN(p=+p)?a:(l||(l=o(e.map(n),t,r)))(n(s(p)))}return h.invert=function(p){return s(i((c||(c=o(t,e.map(n),Kh)))(p)))},h.domain=function(p){return arguments.length?(e=Array.from(p,Yh),u()):e.slice()},h.range=function(p){return arguments.length?(t=Array.from(p),u()):t.slice()},h.rangeRound=function(p){return t=Array.from(p),r=b2,u()},h.clamp=function(p){return arguments.length?(s=p?!0:ai,u()):s!==ai},h.interpolate=function(p){return arguments.length?(r=p,u()):r},h.unknown=function(p){return arguments.length?(a=p,h):a},function(p,d){return n=p,i=d,u()}}function w2(){return ap()(ai,ai)}function mL(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Xh(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Rc(e){return e=Xh(Math.abs(e)),e?e[1]:NaN}function gL(e,t){return function(r,n){for(var i=r.length,a=[],s=0,o=e[0],l=0;i>0&&o>0&&(l+o+1>n&&(o=Math.max(1,n-l)),a.push(r.substring(i-=o,i+o)),!((l+=o+1)>n));)o=e[s=(s+1)%e.length];return a.reverse().join(t)}}function vL(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var xL=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Af(e){if(!(t=xL.exec(e)))throw new Error("invalid format: "+e);var t;return new _2({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Af.prototype=_2.prototype;function _2(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}_2.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function yL(e){e:for(var t=e.length,r=1,n=-1,i;r<t;++r)switch(e[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(i+1):e}var uN;function bL(e,t){var r=Xh(e,t);if(!r)return e+"";var n=r[0],i=r[1],a=i-(uN=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,s=n.length;return a===s?n:a>s?n+new Array(a-s+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+Xh(e,Math.max(0,t+a-1))[0]}function vb(e,t){var r=Xh(e,t);if(!r)return e+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}const xb={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:mL,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>vb(e*100,t),r:vb,s:bL,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function yb(e){return e}var bb=Array.prototype.map,wb=["y","z","a","f","p","n","¬µ","m","","k","M","G","T","P","E","Z","Y"];function wL(e){var t=e.grouping===void 0||e.thousands===void 0?yb:gL(bb.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",i=e.decimal===void 0?".":e.decimal+"",a=e.numerals===void 0?yb:vL(bb.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"‚àí":e.minus+"",l=e.nan===void 0?"NaN":e.nan+"";function c(h){h=Af(h);var p=h.fill,d=h.align,v=h.sign,g=h.symbol,y=h.zero,b=h.width,E=h.comma,S=h.precision,P=h.trim,L=h.type;L==="n"?(E=!0,L="g"):xb[L]||(S===void 0&&(S=12),P=!0,L="g"),(y||p==="0"&&d==="=")&&(y=!0,p="0",d="=");var q=g==="$"?r:g==="#"&&/[boxX]/.test(L)?"0"+L.toLowerCase():"",C=g==="$"?n:/[%p]/.test(L)?s:"",R=xb[L],k=/[defgprs%]/.test(L);S=S===void 0?6:/[gprs]/.test(L)?Math.max(1,Math.min(21,S)):Math.max(0,Math.min(20,S));function G(_){var j=q,H=C,X,ce,pe;if(L==="c")H=R(_)+H,_="";else{_=+_;var ye=_<0||1/_<0;if(_=isNaN(_)?l:R(Math.abs(_),S),P&&(_=yL(_)),ye&&+_==0&&v!=="+"&&(ye=!1),j=(ye?v==="("?v:o:v==="-"||v==="("?"":v)+j,H=(L==="s"?wb[8+uN/3]:"")+H+(ye&&v==="("?")":""),k){for(X=-1,ce=_.length;++X<ce;)if(pe=_.charCodeAt(X),48>pe||pe>57){H=(pe===46?i+_.slice(X+1):_.slice(X))+H,_=_.slice(0,X);break}}}E&&!y&&(_=t(_,1/0));var me=j.length+_.length+H.length,be=me<b?new Array(b-me+1).join(p):"";switch(E&&y&&(_=t(be+_,be.length?b-H.length:1/0),be=""),d){case"<":_=j+_+H+be;break;case"=":_=j+be+_+H;break;case"^":_=be.slice(0,me=be.length>>1)+j+_+H+be.slice(me);break;default:_=be+j+_+H;break}return a(_)}return G.toString=function(){return h+""},G}function u(h,p){var d=c((h=Af(h),h.type="f",h)),v=Math.max(-8,Math.min(8,Math.floor(Rc(p)/3)))*3,g=Math.pow(10,-v),y=wb[8+v/3];return function(b){return d(g*b)+y}}return{format:c,formatPrefix:u}}var Y0,N2,fN;_L({thousands:",",grouping:[3],currency:["$",""]});function _L(e){return Y0=wL(e),N2=Y0.format,fN=Y0.formatPrefix,Y0}function NL(e){return Math.max(0,-Rc(Math.abs(e)))}function SL(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Rc(t)/3)))*3-Rc(Math.abs(e)))}function AL(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Rc(t)-Rc(e))+1}function hN(e,t,r,n){var i=eg(e,t,r),a;switch(n=Af(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(a=SL(i,s))&&(n.precision=a),fN(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(a=AL(i,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=a-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(a=NL(i))&&(n.precision=a-(n.type==="%")*2);break}}return N2(n)}function Oo(e){var t=e.domain;return e.ticks=function(r){var n=t();return Jm(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var i=t();return hN(i[0],i[i.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),i=0,a=n.length-1,s=n[i],o=n[a],l,c,u=10;for(o<s&&(c=s,s=o,o=c,c=i,i=a,a=c);u-- >0;){if(c=Qm(s,o,r),c===l)return n[i]=s,n[a]=o,t(n);if(c>0)s=Math.floor(s/c)*c,o=Math.ceil(o/c)*c;else if(c<0)s=Math.ceil(s*c)/c,o=Math.floor(o*c)/c;else break;l=c}return e},e}function dN(){var e=w2();return e.copy=function(){return Yf(e,dN())},fa.apply(e,arguments),Oo(e)}function pN(e){var t;function r(n){return n==null||isNaN(n=+n)?t:n}return r.invert=r,r.domain=r.range=function(n){return arguments.length?(e=Array.from(n,Yh),r):e.slice()},r.unknown=function(n){return arguments.length?(t=n,r):t},r.copy=function(){return pN(e).unknown(t)},e=arguments.length?Array.from(e,Yh):[0,1],Oo(r)}function mN(e,t){e=e.slice();var r=0,n=e.length-1,i=e[r],a=e[n],s;return a<i&&(s=r,r=n,n=s,s=i,i=a,a=s),e[r]=t.floor(i),e[n]=t.ceil(a),e}function _b(e){return Math.log(e)}function Nb(e){return Math.exp(e)}function EL(e){return-Math.log(-e)}function TL(e){return-Math.exp(-e)}function PL(e){return isFinite(e)?+("1e"+e):e<0?0:e}function jL(e){return e===10?PL:e===Math.E?Math.exp:t=>Math.pow(e,t)}function kL(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function Sb(e){return(t,r)=>-e(-t,r)}function S2(e){const t=e(_b,Nb),r=t.domain;let n=10,i,a;function s(){return i=kL(n),a=jL(n),r()[0]<0?(i=Sb(i),a=Sb(a),e(EL,TL)):e(_b,Nb),t}return t.base=function(o){return arguments.length?(n=+o,s()):n},t.domain=function(o){return arguments.length?(r(o),s()):r()},t.ticks=o=>{const l=r();let c=l[0],u=l[l.length-1];const h=u<c;h&&([c,u]=[u,c]);let p=i(c),d=i(u),v,g;const y=o==null?10:+o;let b=[];if(!(n%1)&&d-p<y){if(p=Math.floor(p),d=Math.ceil(d),c>0){for(;p<=d;++p)for(v=1;v<n;++v)if(g=p<0?v/a(-p):v*a(p),!(g<c)){if(g>u)break;b.push(g)}}else for(;p<=d;++p)for(v=n-1;v>=1;--v)if(g=p>0?v/a(-p):v*a(p),!(g<c)){if(g>u)break;b.push(g)}b.length*2<y&&(b=Jm(c,u,y))}else b=Jm(p,d,Math.min(d-p,y)).map(a);return h?b.reverse():b},t.tickFormat=(o,l)=>{if(o==null&&(o=10),l==null&&(l=n===10?"s":","),typeof l!="function"&&(!(n%1)&&(l=Af(l)).precision==null&&(l.trim=!0),l=N2(l)),o===1/0)return l;const c=Math.max(1,n*o/t.ticks().length);return u=>{let h=u/a(Math.round(i(u)));return h*n<n-.5&&(h*=n),h<=c?l(u):""}},t.nice=()=>r(mN(r(),{floor:o=>a(Math.floor(i(o))),ceil:o=>a(Math.ceil(i(o)))})),t}function gN(){const e=S2(ap()).domain([1,10]);return e.copy=()=>Yf(e,gN()).base(e.base()),fa.apply(e,arguments),e}function Ab(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Eb(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function A2(e){var t=1,r=e(Ab(t),Eb(t));return r.constant=function(n){return arguments.length?e(Ab(t=+n),Eb(t)):t},Oo(r)}function vN(){var e=A2(ap());return e.copy=function(){return Yf(e,vN()).constant(e.constant())},fa.apply(e,arguments)}function Tb(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function CL(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function OL(e){return e<0?-e*e:e*e}function E2(e){var t=e(ai,ai),r=1;function n(){return r===1?e(ai,ai):r===.5?e(CL,OL):e(Tb(r),Tb(1/r))}return t.exponent=function(i){return arguments.length?(r=+i,n()):r},Oo(t)}function T2(){var e=E2(ap());return e.copy=function(){return Yf(e,T2()).exponent(e.exponent())},fa.apply(e,arguments),e}function LL(){return T2.apply(null,arguments).exponent(.5)}function Pb(e){return Math.sign(e)*e*e}function FL(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function xN(){var e=w2(),t=[0,1],r=!1,n;function i(a){var s=FL(e(a));return isNaN(s)?n:r?Math.round(s):s}return i.invert=function(a){return e.invert(Pb(a))},i.domain=function(a){return arguments.length?(e.domain(a),i):e.domain()},i.range=function(a){return arguments.length?(e.range((t=Array.from(a,Yh)).map(Pb)),i):t.slice()},i.rangeRound=function(a){return i.range(a).round(!0)},i.round=function(a){return arguments.length?(r=!!a,i):r},i.clamp=function(a){return arguments.length?(e.clamp(a),i):e.clamp()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return xN(e.domain(),t).round(r).clamp(e.clamp()).unknown(n)},fa.apply(i,arguments),Oo(i)}function yN(){var e=[],t=[],r=[],n;function i(){var s=0,o=Math.max(1,t.length);for(r=new Array(o-1);++s<o;)r[s-1]=R7(e,s/o);return a}function a(s){return s==null||isNaN(s=+s)?n:t[Vf(r,s)]}return a.invertExtent=function(s){var o=t.indexOf(s);return o<0?[NaN,NaN]:[o>0?r[o-1]:e[0],o<r.length?r[o]:e[e.length-1]]},a.domain=function(s){if(!arguments.length)return e.slice();e=[];for(let o of s)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(bo),i()},a.range=function(s){return arguments.length?(t=Array.from(s),i()):t.slice()},a.unknown=function(s){return arguments.length?(n=s,a):n},a.quantiles=function(){return r.slice()},a.copy=function(){return yN().domain(e).range(t).unknown(n)},fa.apply(a,arguments)}function bN(){var e=0,t=1,r=1,n=[.5],i=[0,1],a;function s(l){return l!=null&&l<=l?i[Vf(n,l,0,r)]:a}function o(){var l=-1;for(n=new Array(r);++l<r;)n[l]=((l+1)*t-(l-r)*e)/(r+1);return s}return s.domain=function(l){return arguments.length?([e,t]=l,e=+e,t=+t,o()):[e,t]},s.range=function(l){return arguments.length?(r=(i=Array.from(l)).length-1,o()):i.slice()},s.invertExtent=function(l){var c=i.indexOf(l);return c<0?[NaN,NaN]:c<1?[e,n[0]]:c>=r?[n[r-1],t]:[n[c-1],n[c]]},s.unknown=function(l){return arguments.length&&(a=l),s},s.thresholds=function(){return n.slice()},s.copy=function(){return bN().domain([e,t]).range(i).unknown(a)},fa.apply(Oo(s),arguments)}function wN(){var e=[.5],t=[0,1],r,n=1;function i(a){return a!=null&&a<=a?t[Vf(e,a,0,n)]:r}return i.domain=function(a){return arguments.length?(e=Array.from(a),n=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(a){return arguments.length?(t=Array.from(a),n=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(a){var s=t.indexOf(a);return[e[s-1],e[s]]},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return wN().domain(e).range(t).unknown(r)},fa.apply(i,arguments)}const j1=new Date,k1=new Date;function mn(e,t,r,n){function i(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=a=>(e(a=new Date(+a)),a),i.ceil=a=>(e(a=new Date(a-1)),t(a,1),e(a),a),i.round=a=>{const s=i(a),o=i.ceil(a);return a-s<o-a?s:o},i.offset=(a,s)=>(t(a=new Date(+a),s==null?1:Math.floor(s)),a),i.range=(a,s,o)=>{const l=[];if(a=i.ceil(a),o=o==null?1:Math.floor(o),!(a<s)||!(o>0))return l;let c;do l.push(c=new Date(+a)),t(a,o),e(a);while(c<a&&a<s);return l},i.filter=a=>mn(s=>{if(s>=s)for(;e(s),!a(s);)s.setTime(s-1)},(s,o)=>{if(s>=s)if(o<0)for(;++o<=0;)for(;t(s,-1),!a(s););else for(;--o>=0;)for(;t(s,1),!a(s););}),r&&(i.count=(a,s)=>(j1.setTime(+a),k1.setTime(+s),e(j1),e(k1),Math.floor(r(j1,k1))),i.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(n?s=>n(s)%a===0:s=>i.count(0,s)%a===0):i)),i}const Zh=mn(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);Zh.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?mn(t=>{t.setTime(Math.floor(t/e)*e)},(t,r)=>{t.setTime(+t+r*e)},(t,r)=>(r-t)/e):Zh);Zh.range;const Ss=1e3,sa=Ss*60,As=sa*60,Fs=As*24,P2=Fs*7,jb=Fs*30,C1=Fs*365,al=mn(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*Ss)},(e,t)=>(t-e)/Ss,e=>e.getUTCSeconds());al.range;const j2=mn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ss)},(e,t)=>{e.setTime(+e+t*sa)},(e,t)=>(t-e)/sa,e=>e.getMinutes());j2.range;const k2=mn(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*sa)},(e,t)=>(t-e)/sa,e=>e.getUTCMinutes());k2.range;const C2=mn(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*Ss-e.getMinutes()*sa)},(e,t)=>{e.setTime(+e+t*As)},(e,t)=>(t-e)/As,e=>e.getHours());C2.range;const O2=mn(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*As)},(e,t)=>(t-e)/As,e=>e.getUTCHours());O2.range;const Xf=mn(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*sa)/Fs,e=>e.getDate()-1);Xf.range;const sp=mn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Fs,e=>e.getUTCDate()-1);sp.range;const _N=mn(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Fs,e=>Math.floor(e/Fs));_N.range;function kl(e){return mn(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,r)=>{t.setDate(t.getDate()+r*7)},(t,r)=>(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*sa)/P2)}const op=kl(0),Jh=kl(1),DL=kl(2),IL=kl(3),Bc=kl(4),ML=kl(5),RL=kl(6);op.range;Jh.range;DL.range;IL.range;Bc.range;ML.range;RL.range;function Cl(e){return mn(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCDate(t.getUTCDate()+r*7)},(t,r)=>(r-t)/P2)}const lp=Cl(0),Qh=Cl(1),BL=Cl(2),UL=Cl(3),Uc=Cl(4),$L=Cl(5),zL=Cl(6);lp.range;Qh.range;BL.range;UL.range;Uc.range;$L.range;zL.range;const L2=mn(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());L2.range;const F2=mn(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());F2.range;const Ds=mn(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Ds.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:mn(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,r)=>{t.setFullYear(t.getFullYear()+r*e)});Ds.range;const Is=mn(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Is.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:mn(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,r)=>{t.setUTCFullYear(t.getUTCFullYear()+r*e)});Is.range;function NN(e,t,r,n,i,a){const s=[[al,1,Ss],[al,5,5*Ss],[al,15,15*Ss],[al,30,30*Ss],[a,1,sa],[a,5,5*sa],[a,15,15*sa],[a,30,30*sa],[i,1,As],[i,3,3*As],[i,6,6*As],[i,12,12*As],[n,1,Fs],[n,2,2*Fs],[r,1,P2],[t,1,jb],[t,3,3*jb],[e,1,C1]];function o(c,u,h){const p=u<c;p&&([c,u]=[u,c]);const d=h&&typeof h.range=="function"?h:l(c,u,h),v=d?d.range(c,+u+1):[];return p?v.reverse():v}function l(c,u,h){const p=Math.abs(u-c)/h,d=m2(([,,y])=>y).right(s,p);if(d===s.length)return e.every(eg(c/C1,u/C1,h));if(d===0)return Zh.every(Math.max(eg(c,u,h),1));const[v,g]=s[p/s[d-1][2]<s[d][2]/p?d-1:d];return v.every(g)}return[o,l]}const[WL,qL]=NN(Is,F2,lp,_N,O2,k2),[HL,GL]=NN(Ds,L2,op,Xf,C2,j2);function O1(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function L1(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function zu(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function VL(e){var t=e.dateTime,r=e.date,n=e.time,i=e.periods,a=e.days,s=e.shortDays,o=e.months,l=e.shortMonths,c=Wu(i),u=qu(i),h=Wu(a),p=qu(a),d=Wu(s),v=qu(s),g=Wu(o),y=qu(o),b=Wu(l),E=qu(l),S={a:ye,A:me,b:be,B:Ue,c:null,d:Db,e:Db,f:gF,g:EF,G:PF,H:dF,I:pF,j:mF,L:SN,m:vF,M:xF,p:Fe,q:A,Q:Rb,s:Bb,S:yF,u:bF,U:wF,V:_F,w:NF,W:SF,x:null,X:null,y:AF,Y:TF,Z:jF,"%":Mb},P={a:F,A:O,b:M,B:J,c:null,d:Ib,e:Ib,f:LF,g:WF,G:HF,H:kF,I:CF,j:OF,L:EN,m:FF,M:DF,p:fe,q:ve,Q:Rb,s:Bb,S:IF,u:MF,U:RF,V:BF,w:UF,W:$F,x:null,X:null,y:zF,Y:qF,Z:GF,"%":Mb},L={a:G,A:_,b:j,B:H,c:X,d:Lb,e:Lb,f:cF,g:Ob,G:Cb,H:Fb,I:Fb,j:aF,L:lF,m:iF,M:sF,p:k,q:nF,Q:fF,s:hF,S:oF,u:JL,U:QL,V:eF,w:ZL,W:tF,x:ce,X:pe,y:Ob,Y:Cb,Z:rF,"%":uF};S.x=q(r,S),S.X=q(n,S),S.c=q(t,S),P.x=q(r,P),P.X=q(n,P),P.c=q(t,P);function q(ae,ue){return function(oe){var le=[],Be=-1,ge=0,Q=ae.length,tt,Re,it;for(oe instanceof Date||(oe=new Date(+oe));++Be<Q;)ae.charCodeAt(Be)===37&&(le.push(ae.slice(ge,Be)),(Re=kb[tt=ae.charAt(++Be)])!=null?tt=ae.charAt(++Be):Re=tt==="e"?" ":"0",(it=ue[tt])&&(tt=it(oe,Re)),le.push(tt),ge=Be+1);return le.push(ae.slice(ge,Be)),le.join("")}}function C(ae,ue){return function(oe){var le=zu(1900,void 0,1),Be=R(le,ae,oe+="",0),ge,Q;if(Be!=oe.length)return null;if("Q"in le)return new Date(le.Q);if("s"in le)return new Date(le.s*1e3+("L"in le?le.L:0));if(ue&&!("Z"in le)&&(le.Z=0),"p"in le&&(le.H=le.H%12+le.p*12),le.m===void 0&&(le.m="q"in le?le.q:0),"V"in le){if(le.V<1||le.V>53)return null;"w"in le||(le.w=1),"Z"in le?(ge=L1(zu(le.y,0,1)),Q=ge.getUTCDay(),ge=Q>4||Q===0?Qh.ceil(ge):Qh(ge),ge=sp.offset(ge,(le.V-1)*7),le.y=ge.getUTCFullYear(),le.m=ge.getUTCMonth(),le.d=ge.getUTCDate()+(le.w+6)%7):(ge=O1(zu(le.y,0,1)),Q=ge.getDay(),ge=Q>4||Q===0?Jh.ceil(ge):Jh(ge),ge=Xf.offset(ge,(le.V-1)*7),le.y=ge.getFullYear(),le.m=ge.getMonth(),le.d=ge.getDate()+(le.w+6)%7)}else("W"in le||"U"in le)&&("w"in le||(le.w="u"in le?le.u%7:"W"in le?1:0),Q="Z"in le?L1(zu(le.y,0,1)).getUTCDay():O1(zu(le.y,0,1)).getDay(),le.m=0,le.d="W"in le?(le.w+6)%7+le.W*7-(Q+5)%7:le.w+le.U*7-(Q+6)%7);return"Z"in le?(le.H+=le.Z/100|0,le.M+=le.Z%100,L1(le)):O1(le)}}function R(ae,ue,oe,le){for(var Be=0,ge=ue.length,Q=oe.length,tt,Re;Be<ge;){if(le>=Q)return-1;if(tt=ue.charCodeAt(Be++),tt===37){if(tt=ue.charAt(Be++),Re=L[tt in kb?ue.charAt(Be++):tt],!Re||(le=Re(ae,oe,le))<0)return-1}else if(tt!=oe.charCodeAt(le++))return-1}return le}function k(ae,ue,oe){var le=c.exec(ue.slice(oe));return le?(ae.p=u.get(le[0].toLowerCase()),oe+le[0].length):-1}function G(ae,ue,oe){var le=d.exec(ue.slice(oe));return le?(ae.w=v.get(le[0].toLowerCase()),oe+le[0].length):-1}function _(ae,ue,oe){var le=h.exec(ue.slice(oe));return le?(ae.w=p.get(le[0].toLowerCase()),oe+le[0].length):-1}function j(ae,ue,oe){var le=b.exec(ue.slice(oe));return le?(ae.m=E.get(le[0].toLowerCase()),oe+le[0].length):-1}function H(ae,ue,oe){var le=g.exec(ue.slice(oe));return le?(ae.m=y.get(le[0].toLowerCase()),oe+le[0].length):-1}function X(ae,ue,oe){return R(ae,t,ue,oe)}function ce(ae,ue,oe){return R(ae,r,ue,oe)}function pe(ae,ue,oe){return R(ae,n,ue,oe)}function ye(ae){return s[ae.getDay()]}function me(ae){return a[ae.getDay()]}function be(ae){return l[ae.getMonth()]}function Ue(ae){return o[ae.getMonth()]}function Fe(ae){return i[+(ae.getHours()>=12)]}function A(ae){return 1+~~(ae.getMonth()/3)}function F(ae){return s[ae.getUTCDay()]}function O(ae){return a[ae.getUTCDay()]}function M(ae){return l[ae.getUTCMonth()]}function J(ae){return o[ae.getUTCMonth()]}function fe(ae){return i[+(ae.getUTCHours()>=12)]}function ve(ae){return 1+~~(ae.getUTCMonth()/3)}return{format:function(ae){var ue=q(ae+="",S);return ue.toString=function(){return ae},ue},parse:function(ae){var ue=C(ae+="",!1);return ue.toString=function(){return ae},ue},utcFormat:function(ae){var ue=q(ae+="",P);return ue.toString=function(){return ae},ue},utcParse:function(ae){var ue=C(ae+="",!0);return ue.toString=function(){return ae},ue}}}var kb={"-":"",_:" ",0:"0"},En=/^\s*\d+/,KL=/^%/,YL=/[\\^$*+?|[\]().{}]/g;function Jt(e,t,r){var n=e<0?"-":"",i=(n?-e:e)+"",a=i.length;return n+(a<r?new Array(r-a+1).join(t)+i:i)}function XL(e){return e.replace(YL,"\\$&")}function Wu(e){return new RegExp("^(?:"+e.map(XL).join("|")+")","i")}function qu(e){return new Map(e.map((t,r)=>[t.toLowerCase(),r]))}function ZL(e,t,r){var n=En.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function JL(e,t,r){var n=En.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function QL(e,t,r){var n=En.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function eF(e,t,r){var n=En.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function tF(e,t,r){var n=En.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function Cb(e,t,r){var n=En.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function Ob(e,t,r){var n=En.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function rF(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function nF(e,t,r){var n=En.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function iF(e,t,r){var n=En.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function Lb(e,t,r){var n=En.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function aF(e,t,r){var n=En.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function Fb(e,t,r){var n=En.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function sF(e,t,r){var n=En.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function oF(e,t,r){var n=En.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function lF(e,t,r){var n=En.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function cF(e,t,r){var n=En.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function uF(e,t,r){var n=KL.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function fF(e,t,r){var n=En.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function hF(e,t,r){var n=En.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function Db(e,t){return Jt(e.getDate(),t,2)}function dF(e,t){return Jt(e.getHours(),t,2)}function pF(e,t){return Jt(e.getHours()%12||12,t,2)}function mF(e,t){return Jt(1+Xf.count(Ds(e),e),t,3)}function SN(e,t){return Jt(e.getMilliseconds(),t,3)}function gF(e,t){return SN(e,t)+"000"}function vF(e,t){return Jt(e.getMonth()+1,t,2)}function xF(e,t){return Jt(e.getMinutes(),t,2)}function yF(e,t){return Jt(e.getSeconds(),t,2)}function bF(e){var t=e.getDay();return t===0?7:t}function wF(e,t){return Jt(op.count(Ds(e)-1,e),t,2)}function AN(e){var t=e.getDay();return t>=4||t===0?Bc(e):Bc.ceil(e)}function _F(e,t){return e=AN(e),Jt(Bc.count(Ds(e),e)+(Ds(e).getDay()===4),t,2)}function NF(e){return e.getDay()}function SF(e,t){return Jt(Jh.count(Ds(e)-1,e),t,2)}function AF(e,t){return Jt(e.getFullYear()%100,t,2)}function EF(e,t){return e=AN(e),Jt(e.getFullYear()%100,t,2)}function TF(e,t){return Jt(e.getFullYear()%1e4,t,4)}function PF(e,t){var r=e.getDay();return e=r>=4||r===0?Bc(e):Bc.ceil(e),Jt(e.getFullYear()%1e4,t,4)}function jF(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+Jt(t/60|0,"0",2)+Jt(t%60,"0",2)}function Ib(e,t){return Jt(e.getUTCDate(),t,2)}function kF(e,t){return Jt(e.getUTCHours(),t,2)}function CF(e,t){return Jt(e.getUTCHours()%12||12,t,2)}function OF(e,t){return Jt(1+sp.count(Is(e),e),t,3)}function EN(e,t){return Jt(e.getUTCMilliseconds(),t,3)}function LF(e,t){return EN(e,t)+"000"}function FF(e,t){return Jt(e.getUTCMonth()+1,t,2)}function DF(e,t){return Jt(e.getUTCMinutes(),t,2)}function IF(e,t){return Jt(e.getUTCSeconds(),t,2)}function MF(e){var t=e.getUTCDay();return t===0?7:t}function RF(e,t){return Jt(lp.count(Is(e)-1,e),t,2)}function TN(e){var t=e.getUTCDay();return t>=4||t===0?Uc(e):Uc.ceil(e)}function BF(e,t){return e=TN(e),Jt(Uc.count(Is(e),e)+(Is(e).getUTCDay()===4),t,2)}function UF(e){return e.getUTCDay()}function $F(e,t){return Jt(Qh.count(Is(e)-1,e),t,2)}function zF(e,t){return Jt(e.getUTCFullYear()%100,t,2)}function WF(e,t){return e=TN(e),Jt(e.getUTCFullYear()%100,t,2)}function qF(e,t){return Jt(e.getUTCFullYear()%1e4,t,4)}function HF(e,t){var r=e.getUTCDay();return e=r>=4||r===0?Uc(e):Uc.ceil(e),Jt(e.getUTCFullYear()%1e4,t,4)}function GF(){return"+0000"}function Mb(){return"%"}function Rb(e){return+e}function Bb(e){return Math.floor(+e/1e3)}var Ql,PN,jN;VF({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function VF(e){return Ql=VL(e),PN=Ql.format,Ql.parse,jN=Ql.utcFormat,Ql.utcParse,Ql}function KF(e){return new Date(e)}function YF(e){return e instanceof Date?+e:+new Date(+e)}function D2(e,t,r,n,i,a,s,o,l,c){var u=w2(),h=u.invert,p=u.domain,d=c(".%L"),v=c(":%S"),g=c("%I:%M"),y=c("%I %p"),b=c("%a %d"),E=c("%b %d"),S=c("%B"),P=c("%Y");function L(q){return(l(q)<q?d:o(q)<q?v:s(q)<q?g:a(q)<q?y:n(q)<q?i(q)<q?b:E:r(q)<q?S:P)(q)}return u.invert=function(q){return new Date(h(q))},u.domain=function(q){return arguments.length?p(Array.from(q,YF)):p().map(KF)},u.ticks=function(q){var C=p();return e(C[0],C[C.length-1],q??10)},u.tickFormat=function(q,C){return C==null?L:c(C)},u.nice=function(q){var C=p();return(!q||typeof q.range!="function")&&(q=t(C[0],C[C.length-1],q??10)),q?p(mN(C,q)):u},u.copy=function(){return Yf(u,D2(e,t,r,n,i,a,s,o,l,c))},u}function XF(){return fa.apply(D2(HL,GL,Ds,L2,op,Xf,C2,j2,al,PN).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function ZF(){return fa.apply(D2(WL,qL,Is,F2,lp,sp,O2,k2,al,jN).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function cp(){var e=0,t=1,r,n,i,a,s=ai,o=!1,l;function c(h){return h==null||isNaN(h=+h)?l:s(i===0?.5:(h=(a(h)-r)*i,o?Math.max(0,Math.min(1,h)):h))}c.domain=function(h){return arguments.length?([e,t]=h,r=a(e=+e),n=a(t=+t),i=r===n?0:1/(n-r),c):[e,t]},c.clamp=function(h){return arguments.length?(o=!!h,c):o},c.interpolator=function(h){return arguments.length?(s=h,c):s};function u(h){return function(p){var d,v;return arguments.length?([d,v]=p,s=h(d,v),c):[s(0),s(1)]}}return c.range=u(Kc),c.rangeRound=u(b2),c.unknown=function(h){return arguments.length?(l=h,c):l},function(h){return a=h,r=h(e),n=h(t),i=r===n?0:1/(n-r),c}}function Lo(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function kN(){var e=Oo(cp()(ai));return e.copy=function(){return Lo(e,kN())},zs.apply(e,arguments)}function CN(){var e=S2(cp()).domain([1,10]);return e.copy=function(){return Lo(e,CN()).base(e.base())},zs.apply(e,arguments)}function ON(){var e=A2(cp());return e.copy=function(){return Lo(e,ON()).constant(e.constant())},zs.apply(e,arguments)}function I2(){var e=E2(cp());return e.copy=function(){return Lo(e,I2()).exponent(e.exponent())},zs.apply(e,arguments)}function JF(){return I2.apply(null,arguments).exponent(.5)}function LN(){var e=[],t=ai;function r(n){if(n!=null&&!isNaN(n=+n))return t((Vf(e,n,1)-1)/(e.length-1))}return r.domain=function(n){if(!arguments.length)return e.slice();e=[];for(let i of n)i!=null&&!isNaN(i=+i)&&e.push(i);return e.sort(bo),r},r.interpolator=function(n){return arguments.length?(t=n,r):t},r.range=function(){return e.map((n,i)=>t(i/(e.length-1)))},r.quantiles=function(n){return Array.from({length:n+1},(i,a)=>M7(e,a/n))},r.copy=function(){return LN(t).domain(e)},zs.apply(r,arguments)}function up(){var e=0,t=.5,r=1,n=1,i,a,s,o,l,c=ai,u,h=!1,p;function d(g){return isNaN(g=+g)?p:(g=.5+((g=+u(g))-a)*(n*g<n*a?o:l),c(h?Math.max(0,Math.min(1,g)):g))}d.domain=function(g){return arguments.length?([e,t,r]=g,i=u(e=+e),a=u(t=+t),s=u(r=+r),o=i===a?0:.5/(a-i),l=a===s?0:.5/(s-a),n=a<i?-1:1,d):[e,t,r]},d.clamp=function(g){return arguments.length?(h=!!g,d):h},d.interpolator=function(g){return arguments.length?(c=g,d):c};function v(g){return function(y){var b,E,S;return arguments.length?([b,E,S]=y,c=uL(g,[b,E,S]),d):[c(0),c(.5),c(1)]}}return d.range=v(Kc),d.rangeRound=v(b2),d.unknown=function(g){return arguments.length?(p=g,d):p},function(g){return u=g,i=g(e),a=g(t),s=g(r),o=i===a?0:.5/(a-i),l=a===s?0:.5/(s-a),n=a<i?-1:1,d}}function FN(){var e=Oo(up()(ai));return e.copy=function(){return Lo(e,FN())},zs.apply(e,arguments)}function DN(){var e=S2(up()).domain([.1,1,10]);return e.copy=function(){return Lo(e,DN()).base(e.base())},zs.apply(e,arguments)}function IN(){var e=A2(up());return e.copy=function(){return Lo(e,IN()).constant(e.constant())},zs.apply(e,arguments)}function M2(){var e=E2(up());return e.copy=function(){return Lo(e,M2()).exponent(e.exponent())},zs.apply(e,arguments)}function QF(){return M2.apply(null,arguments).exponent(.5)}const Qu=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:v2,scaleDiverging:FN,scaleDivergingLog:DN,scaleDivergingPow:M2,scaleDivergingSqrt:QF,scaleDivergingSymlog:IN,scaleIdentity:pN,scaleImplicit:tg,scaleLinear:dN,scaleLog:gN,scaleOrdinal:g2,scalePoint:U7,scalePow:T2,scaleQuantile:yN,scaleQuantize:bN,scaleRadial:xN,scaleSequential:kN,scaleSequentialLog:CN,scaleSequentialPow:I2,scaleSequentialQuantile:LN,scaleSequentialSqrt:JF,scaleSequentialSymlog:ON,scaleSqrt:LL,scaleSymlog:vN,scaleThreshold:wN,scaleTime:XF,scaleUtc:ZF,tickFormat:hN},Symbol.toStringTag,{value:"Module"}));var Fo=e=>e.chartData,R2=ke([Fo],e=>{var t=e.chartData!=null?e.chartData.length-1:0;return{chartData:e.chartData,computedData:e.computedData,dataEndIndex:t,dataStartIndex:0}}),MN=(e,t,r,n)=>n?R2(e):Fo(e);function $c(e){if(Array.isArray(e)&&e.length===2){var[t,r]=e;if(Oa(t)&&Oa(r))return!0}return!1}function Ub(e,t,r){return r?e:[Math.min(e[0],t[0]),Math.max(e[1],t[1])]}function eD(e,t){if(t&&typeof e!="function"&&Array.isArray(e)&&e.length===2){var[r,n]=e,i,a;if(Oa(r))i=r;else if(typeof r=="function")return;if(Oa(n))a=n;else if(typeof n=="function")return;var s=[i,a];if($c(s))return s}}function tD(e,t,r){if(!(!r&&t==null)){if(typeof e=="function"&&t!=null)try{var n=e(t,r);if($c(n))return Ub(n,t,r)}catch{}if(Array.isArray(e)&&e.length===2){var[i,a]=e,s,o;if(i==="auto")t!=null&&(s=Math.min(...t));else if(Vt(i))s=i;else if(typeof i=="function")try{t!=null&&(s=i(t==null?void 0:t[0]))}catch{}else if(typeof i=="string"&&Ry.test(i)){var l=Ry.exec(i);if(l==null||t==null)s=void 0;else{var c=+l[1];s=t[0]-c}}else s=t==null?void 0:t[0];if(a==="auto")t!=null&&(o=Math.max(...t));else if(Vt(a))o=a;else if(typeof a=="function")try{t!=null&&(o=a(t==null?void 0:t[1]))}catch{}else if(typeof a=="string"&&By.test(a)){var u=By.exec(a);if(u==null||t==null)o=void 0;else{var h=+u[1];o=t[1]+h}}else o=t==null?void 0:t[1];var p=[s,o];if($c(p))return t==null?p:Ub(p,t,r)}}}var Yc=1e9,rD={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},U2,Or=!0,la="[DecimalError] ",ml=la+"Invalid argument: ",B2=la+"Exponent out of range: ",Xc=Math.floor,Zo=Math.pow,nD=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Ii,bn=1e7,Tr=7,RN=9007199254740991,ed=Xc(RN/Tr),lt={};lt.absoluteValue=lt.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};lt.comparedTo=lt.cmp=function(e){var t,r,n,i,a=this;if(e=new a.constructor(e),a.s!==e.s)return a.s||-e.s;if(a.e!==e.e)return a.e>e.e^a.s<0?1:-1;for(n=a.d.length,i=e.d.length,t=0,r=n<i?n:i;t<r;++t)if(a.d[t]!==e.d[t])return a.d[t]>e.d[t]^a.s<0?1:-1;return n===i?0:n>i^a.s<0?1:-1};lt.decimalPlaces=lt.dp=function(){var e=this,t=e.d.length-1,r=(t-e.e)*Tr;if(t=e.d[t],t)for(;t%10==0;t/=10)r--;return r<0?0:r};lt.dividedBy=lt.div=function(e){return Ps(this,new this.constructor(e))};lt.dividedToIntegerBy=lt.idiv=function(e){var t=this,r=t.constructor;return yr(Ps(t,new r(e),0,1),r.precision)};lt.equals=lt.eq=function(e){return!this.cmp(e)};lt.exponent=function(){return sn(this)};lt.greaterThan=lt.gt=function(e){return this.cmp(e)>0};lt.greaterThanOrEqualTo=lt.gte=function(e){return this.cmp(e)>=0};lt.isInteger=lt.isint=function(){return this.e>this.d.length-2};lt.isNegative=lt.isneg=function(){return this.s<0};lt.isPositive=lt.ispos=function(){return this.s>0};lt.isZero=function(){return this.s===0};lt.lessThan=lt.lt=function(e){return this.cmp(e)<0};lt.lessThanOrEqualTo=lt.lte=function(e){return this.cmp(e)<1};lt.logarithm=lt.log=function(e){var t,r=this,n=r.constructor,i=n.precision,a=i+5;if(e===void 0)e=new n(10);else if(e=new n(e),e.s<1||e.eq(Ii))throw Error(la+"NaN");if(r.s<1)throw Error(la+(r.s?"NaN":"-Infinity"));return r.eq(Ii)?new n(0):(Or=!1,t=Ps(Ef(r,a),Ef(e,a),a),Or=!0,yr(t,i))};lt.minus=lt.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?$N(t,e):BN(t,(e.s=-e.s,e))};lt.modulo=lt.mod=function(e){var t,r=this,n=r.constructor,i=n.precision;if(e=new n(e),!e.s)throw Error(la+"NaN");return r.s?(Or=!1,t=Ps(r,e,0,1).times(e),Or=!0,r.minus(t)):yr(new n(r),i)};lt.naturalExponential=lt.exp=function(){return UN(this)};lt.naturalLogarithm=lt.ln=function(){return Ef(this)};lt.negated=lt.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};lt.plus=lt.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?BN(t,e):$N(t,(e.s=-e.s,e))};lt.precision=lt.sd=function(e){var t,r,n,i=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(ml+e);if(t=sn(i)+1,n=i.d.length-1,r=n*Tr+1,n=i.d[n],n){for(;n%10==0;n/=10)r--;for(n=i.d[0];n>=10;n/=10)r++}return e&&t>r?t:r};lt.squareRoot=lt.sqrt=function(){var e,t,r,n,i,a,s,o=this,l=o.constructor;if(o.s<1){if(!o.s)return new l(0);throw Error(la+"NaN")}for(e=sn(o),Or=!1,i=Math.sqrt(+o),i==0||i==1/0?(t=Za(o.d),(t.length+e)%2==0&&(t+="0"),i=Math.sqrt(t),e=Xc((e+1)/2)-(e<0||e%2),i==1/0?t="5e"+e:(t=i.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),n=new l(t)):n=new l(i.toString()),r=l.precision,i=s=r+3;;)if(a=n,n=a.plus(Ps(o,a,s+2)).times(.5),Za(a.d).slice(0,s)===(t=Za(n.d)).slice(0,s)){if(t=t.slice(s-3,s+1),i==s&&t=="4999"){if(yr(a,r+1,0),a.times(a).eq(o)){n=a;break}}else if(t!="9999")break;s+=4}return Or=!0,yr(n,r)};lt.times=lt.mul=function(e){var t,r,n,i,a,s,o,l,c,u=this,h=u.constructor,p=u.d,d=(e=new h(e)).d;if(!u.s||!e.s)return new h(0);for(e.s*=u.s,r=u.e+e.e,l=p.length,c=d.length,l<c&&(a=p,p=d,d=a,s=l,l=c,c=s),a=[],s=l+c,n=s;n--;)a.push(0);for(n=c;--n>=0;){for(t=0,i=l+n;i>n;)o=a[i]+d[n]*p[i-n-1]+t,a[i--]=o%bn|0,t=o/bn|0;a[i]=(a[i]+t)%bn|0}for(;!a[--s];)a.pop();return t?++r:a.shift(),e.d=a,e.e=r,Or?yr(e,h.precision):e};lt.toDecimalPlaces=lt.todp=function(e,t){var r=this,n=r.constructor;return r=new n(r),e===void 0?r:(is(e,0,Yc),t===void 0?t=n.rounding:is(t,0,8),yr(r,e+sn(r)+1,t))};lt.toExponential=function(e,t){var r,n=this,i=n.constructor;return e===void 0?r=_l(n,!0):(is(e,0,Yc),t===void 0?t=i.rounding:is(t,0,8),n=yr(new i(n),e+1,t),r=_l(n,!0,e+1)),r};lt.toFixed=function(e,t){var r,n,i=this,a=i.constructor;return e===void 0?_l(i):(is(e,0,Yc),t===void 0?t=a.rounding:is(t,0,8),n=yr(new a(i),e+sn(i)+1,t),r=_l(n.abs(),!1,e+sn(n)+1),i.isneg()&&!i.isZero()?"-"+r:r)};lt.toInteger=lt.toint=function(){var e=this,t=e.constructor;return yr(new t(e),sn(e)+1,t.rounding)};lt.toNumber=function(){return+this};lt.toPower=lt.pow=function(e){var t,r,n,i,a,s,o=this,l=o.constructor,c=12,u=+(e=new l(e));if(!e.s)return new l(Ii);if(o=new l(o),!o.s){if(e.s<1)throw Error(la+"Infinity");return o}if(o.eq(Ii))return o;if(n=l.precision,e.eq(Ii))return yr(o,n);if(t=e.e,r=e.d.length-1,s=t>=r,a=o.s,s){if((r=u<0?-u:u)<=RN){for(i=new l(Ii),t=Math.ceil(n/Tr+4),Or=!1;r%2&&(i=i.times(o),zb(i.d,t)),r=Xc(r/2),r!==0;)o=o.times(o),zb(o.d,t);return Or=!0,e.s<0?new l(Ii).div(i):yr(i,n)}}else if(a<0)throw Error(la+"NaN");return a=a<0&&e.d[Math.max(t,r)]&1?-1:1,o.s=1,Or=!1,i=e.times(Ef(o,n+c)),Or=!0,i=UN(i),i.s=a,i};lt.toPrecision=function(e,t){var r,n,i=this,a=i.constructor;return e===void 0?(r=sn(i),n=_l(i,r<=a.toExpNeg||r>=a.toExpPos)):(is(e,1,Yc),t===void 0?t=a.rounding:is(t,0,8),i=yr(new a(i),e,t),r=sn(i),n=_l(i,e<=r||r<=a.toExpNeg,e)),n};lt.toSignificantDigits=lt.tosd=function(e,t){var r=this,n=r.constructor;return e===void 0?(e=n.precision,t=n.rounding):(is(e,1,Yc),t===void 0?t=n.rounding:is(t,0,8)),yr(new n(r),e,t)};lt.toString=lt.valueOf=lt.val=lt.toJSON=lt[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=sn(e),r=e.constructor;return _l(e,t<=r.toExpNeg||t>=r.toExpPos)};function BN(e,t){var r,n,i,a,s,o,l,c,u=e.constructor,h=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),Or?yr(t,h):t;if(l=e.d,c=t.d,s=e.e,i=t.e,l=l.slice(),a=s-i,a){for(a<0?(n=l,a=-a,o=c.length):(n=c,i=s,o=l.length),s=Math.ceil(h/Tr),o=s>o?s+1:o+1,a>o&&(a=o,n.length=1),n.reverse();a--;)n.push(0);n.reverse()}for(o=l.length,a=c.length,o-a<0&&(a=o,n=c,c=l,l=n),r=0;a;)r=(l[--a]=l[a]+c[a]+r)/bn|0,l[a]%=bn;for(r&&(l.unshift(r),++i),o=l.length;l[--o]==0;)l.pop();return t.d=l,t.e=i,Or?yr(t,h):t}function is(e,t,r){if(e!==~~e||e<t||e>r)throw Error(ml+e)}function Za(e){var t,r,n,i=e.length-1,a="",s=e[0];if(i>0){for(a+=s,t=1;t<i;t++)n=e[t]+"",r=Tr-n.length,r&&(a+=uo(r)),a+=n;s=e[t],n=s+"",r=Tr-n.length,r&&(a+=uo(r))}else if(s===0)return"0";for(;s%10===0;)s/=10;return a+s}var Ps=function(){function e(n,i){var a,s=0,o=n.length;for(n=n.slice();o--;)a=n[o]*i+s,n[o]=a%bn|0,s=a/bn|0;return s&&n.unshift(s),n}function t(n,i,a,s){var o,l;if(a!=s)l=a>s?1:-1;else for(o=l=0;o<a;o++)if(n[o]!=i[o]){l=n[o]>i[o]?1:-1;break}return l}function r(n,i,a){for(var s=0;a--;)n[a]-=s,s=n[a]<i[a]?1:0,n[a]=s*bn+n[a]-i[a];for(;!n[0]&&n.length>1;)n.shift()}return function(n,i,a,s){var o,l,c,u,h,p,d,v,g,y,b,E,S,P,L,q,C,R,k=n.constructor,G=n.s==i.s?1:-1,_=n.d,j=i.d;if(!n.s)return new k(n);if(!i.s)throw Error(la+"Division by zero");for(l=n.e-i.e,C=j.length,L=_.length,d=new k(G),v=d.d=[],c=0;j[c]==(_[c]||0);)++c;if(j[c]>(_[c]||0)&&--l,a==null?E=a=k.precision:s?E=a+(sn(n)-sn(i))+1:E=a,E<0)return new k(0);if(E=E/Tr+2|0,c=0,C==1)for(u=0,j=j[0],E++;(c<L||u)&&E--;c++)S=u*bn+(_[c]||0),v[c]=S/j|0,u=S%j|0;else{for(u=bn/(j[0]+1)|0,u>1&&(j=e(j,u),_=e(_,u),C=j.length,L=_.length),P=C,g=_.slice(0,C),y=g.length;y<C;)g[y++]=0;R=j.slice(),R.unshift(0),q=j[0],j[1]>=bn/2&&++q;do u=0,o=t(j,g,C,y),o<0?(b=g[0],C!=y&&(b=b*bn+(g[1]||0)),u=b/q|0,u>1?(u>=bn&&(u=bn-1),h=e(j,u),p=h.length,y=g.length,o=t(h,g,p,y),o==1&&(u--,r(h,C<p?R:j,p))):(u==0&&(o=u=1),h=j.slice()),p=h.length,p<y&&h.unshift(0),r(g,h,y),o==-1&&(y=g.length,o=t(j,g,C,y),o<1&&(u++,r(g,C<y?R:j,y))),y=g.length):o===0&&(u++,g=[0]),v[c++]=u,o&&g[0]?g[y++]=_[P]||0:(g=[_[P]],y=1);while((P++<L||g[0]!==void 0)&&E--)}return v[0]||v.shift(),d.e=l,yr(d,s?a+sn(d)+1:a)}}();function UN(e,t){var r,n,i,a,s,o,l=0,c=0,u=e.constructor,h=u.precision;if(sn(e)>16)throw Error(B2+sn(e));if(!e.s)return new u(Ii);for(t==null?(Or=!1,o=h):o=t,s=new u(.03125);e.abs().gte(.1);)e=e.times(s),c+=5;for(n=Math.log(Zo(2,c))/Math.LN10*2+5|0,o+=n,r=i=a=new u(Ii),u.precision=o;;){if(i=yr(i.times(e),o),r=r.times(++l),s=a.plus(Ps(i,r,o)),Za(s.d).slice(0,o)===Za(a.d).slice(0,o)){for(;c--;)a=yr(a.times(a),o);return u.precision=h,t==null?(Or=!0,yr(a,h)):a}a=s}}function sn(e){for(var t=e.e*Tr,r=e.d[0];r>=10;r/=10)t++;return t}function F1(e,t,r){if(t>e.LN10.sd())throw Or=!0,r&&(e.precision=r),Error(la+"LN10 precision limit exceeded");return yr(new e(e.LN10),t)}function uo(e){for(var t="";e--;)t+="0";return t}function Ef(e,t){var r,n,i,a,s,o,l,c,u,h=1,p=10,d=e,v=d.d,g=d.constructor,y=g.precision;if(d.s<1)throw Error(la+(d.s?"NaN":"-Infinity"));if(d.eq(Ii))return new g(0);if(t==null?(Or=!1,c=y):c=t,d.eq(10))return t==null&&(Or=!0),F1(g,c);if(c+=p,g.precision=c,r=Za(v),n=r.charAt(0),a=sn(d),Math.abs(a)<15e14){for(;n<7&&n!=1||n==1&&r.charAt(1)>3;)d=d.times(e),r=Za(d.d),n=r.charAt(0),h++;a=sn(d),n>1?(d=new g("0."+r),a++):d=new g(n+"."+r.slice(1))}else return l=F1(g,c+2,y).times(a+""),d=Ef(new g(n+"."+r.slice(1)),c-p).plus(l),g.precision=y,t==null?(Or=!0,yr(d,y)):d;for(o=s=d=Ps(d.minus(Ii),d.plus(Ii),c),u=yr(d.times(d),c),i=3;;){if(s=yr(s.times(u),c),l=o.plus(Ps(s,new g(i),c)),Za(l.d).slice(0,c)===Za(o.d).slice(0,c))return o=o.times(2),a!==0&&(o=o.plus(F1(g,c+2,y).times(a+""))),o=Ps(o,new g(h),c),g.precision=y,t==null?(Or=!0,yr(o,y)):o;o=l,i+=2}}function $b(e,t){var r,n,i;for((r=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(r<0&&(r=n),r+=+t.slice(n+1),t=t.substring(0,n)):r<0&&(r=t.length),n=0;t.charCodeAt(n)===48;)++n;for(i=t.length;t.charCodeAt(i-1)===48;)--i;if(t=t.slice(n,i),t){if(i-=n,r=r-n-1,e.e=Xc(r/Tr),e.d=[],n=(r+1)%Tr,r<0&&(n+=Tr),n<i){for(n&&e.d.push(+t.slice(0,n)),i-=Tr;n<i;)e.d.push(+t.slice(n,n+=Tr));t=t.slice(n),n=Tr-t.length}else n-=i;for(;n--;)t+="0";if(e.d.push(+t),Or&&(e.e>ed||e.e<-ed))throw Error(B2+r)}else e.s=0,e.e=0,e.d=[0];return e}function yr(e,t,r){var n,i,a,s,o,l,c,u,h=e.d;for(s=1,a=h[0];a>=10;a/=10)s++;if(n=t-s,n<0)n+=Tr,i=t,c=h[u=0];else{if(u=Math.ceil((n+1)/Tr),a=h.length,u>=a)return e;for(c=a=h[u],s=1;a>=10;a/=10)s++;n%=Tr,i=n-Tr+s}if(r!==void 0&&(a=Zo(10,s-i-1),o=c/a%10|0,l=t<0||h[u+1]!==void 0||c%a,l=r<4?(o||l)&&(r==0||r==(e.s<0?3:2)):o>5||o==5&&(r==4||l||r==6&&(n>0?i>0?c/Zo(10,s-i):0:h[u-1])%10&1||r==(e.s<0?8:7))),t<1||!h[0])return l?(a=sn(e),h.length=1,t=t-a-1,h[0]=Zo(10,(Tr-t%Tr)%Tr),e.e=Xc(-t/Tr)||0):(h.length=1,h[0]=e.e=e.s=0),e;if(n==0?(h.length=u,a=1,u--):(h.length=u+1,a=Zo(10,Tr-n),h[u]=i>0?(c/Zo(10,s-i)%Zo(10,i)|0)*a:0),l)for(;;)if(u==0){(h[0]+=a)==bn&&(h[0]=1,++e.e);break}else{if(h[u]+=a,h[u]!=bn)break;h[u--]=0,a=1}for(n=h.length;h[--n]===0;)h.pop();if(Or&&(e.e>ed||e.e<-ed))throw Error(B2+sn(e));return e}function $N(e,t){var r,n,i,a,s,o,l,c,u,h,p=e.constructor,d=p.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new p(e),Or?yr(t,d):t;if(l=e.d,h=t.d,n=t.e,c=e.e,l=l.slice(),s=c-n,s){for(u=s<0,u?(r=l,s=-s,o=h.length):(r=h,n=c,o=l.length),i=Math.max(Math.ceil(d/Tr),o)+2,s>i&&(s=i,r.length=1),r.reverse(),i=s;i--;)r.push(0);r.reverse()}else{for(i=l.length,o=h.length,u=i<o,u&&(o=i),i=0;i<o;i++)if(l[i]!=h[i]){u=l[i]<h[i];break}s=0}for(u&&(r=l,l=h,h=r,t.s=-t.s),o=l.length,i=h.length-o;i>0;--i)l[o++]=0;for(i=h.length;i>s;){if(l[--i]<h[i]){for(a=i;a&&l[--a]===0;)l[a]=bn-1;--l[a],l[i]+=bn}l[i]-=h[i]}for(;l[--o]===0;)l.pop();for(;l[0]===0;l.shift())--n;return l[0]?(t.d=l,t.e=n,Or?yr(t,d):t):new p(0)}function _l(e,t,r){var n,i=sn(e),a=Za(e.d),s=a.length;return t?(r&&(n=r-s)>0?a=a.charAt(0)+"."+a.slice(1)+uo(n):s>1&&(a=a.charAt(0)+"."+a.slice(1)),a=a+(i<0?"e":"e+")+i):i<0?(a="0."+uo(-i-1)+a,r&&(n=r-s)>0&&(a+=uo(n))):i>=s?(a+=uo(i+1-s),r&&(n=r-i-1)>0&&(a=a+"."+uo(n))):((n=i+1)<s&&(a=a.slice(0,n)+"."+a.slice(n)),r&&(n=r-s)>0&&(i+1===s&&(a+="."),a+=uo(n))),e.s<0?"-"+a:a}function zb(e,t){if(e.length>t)return e.length=t,!0}function zN(e){var t,r,n;function i(a){var s=this;if(!(s instanceof i))return new i(a);if(s.constructor=i,a instanceof i){s.s=a.s,s.e=a.e,s.d=(a=a.d)?a.slice():a;return}if(typeof a=="number"){if(a*0!==0)throw Error(ml+a);if(a>0)s.s=1;else if(a<0)a=-a,s.s=-1;else{s.s=0,s.e=0,s.d=[0];return}if(a===~~a&&a<1e7){s.e=0,s.d=[a];return}return $b(s,a.toString())}else if(typeof a!="string")throw Error(ml+a);if(a.charCodeAt(0)===45?(a=a.slice(1),s.s=-1):s.s=1,nD.test(a))$b(s,a);else throw Error(ml+a)}if(i.prototype=lt,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=zN,i.config=i.set=iD,e===void 0&&(e={}),e)for(n=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<n.length;)e.hasOwnProperty(r=n[t++])||(e[r]=this[r]);return i.config(e),i}function iD(e){if(!e||typeof e!="object")throw Error(la+"Object expected");var t,r,n,i=["precision",1,Yc,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<i.length;t+=3)if((n=e[r=i[t]])!==void 0)if(Xc(n)===n&&n>=i[t+1]&&n<=i[t+2])this[r]=n;else throw Error(ml+r+": "+n);if((n=e[r="LN10"])!==void 0)if(n==Math.LN10)this[r]=new this(n);else throw Error(ml+r+": "+n);return this}var U2=zN(rD);Ii=new U2(1);const ur=U2;var aD=e=>e,WN={"@@functional/placeholder":!0},qN=e=>e===WN,Wb=e=>function t(){return arguments.length===0||arguments.length===1&&qN(arguments.length<=0?void 0:arguments[0])?t:e(...arguments)},HN=(e,t)=>e===1?t:Wb(function(){for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];var a=n.filter(s=>s!==WN).length;return a>=e?t(...n):HN(e-a,Wb(function(){for(var s=arguments.length,o=new Array(s),l=0;l<s;l++)o[l]=arguments[l];var c=n.map(u=>qN(u)?o.shift():u);return t(...c,...o)}))}),fp=e=>HN(e.length,e),ag=(e,t)=>{for(var r=[],n=e;n<t;++n)r[n-e]=n;return r},sD=fp((e,t)=>Array.isArray(t)?t.map(e):Object.keys(t).map(r=>t[r]).map(e)),oD=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];if(!r.length)return aD;var i=r.reverse(),a=i[0],s=i.slice(1);return function(){return s.reduce((o,l)=>l(o),a(...arguments))}},sg=e=>Array.isArray(e)?e.reverse():e.split("").reverse().join(""),GN=e=>{var t=null,r=null;return function(){for(var n=arguments.length,i=new Array(n),a=0;a<n;a++)i[a]=arguments[a];return t&&i.every((s,o)=>{var l;return s===((l=t)===null||l===void 0?void 0:l[o])})||(t=i,r=e(...i)),r}};function VN(e){var t;return e===0?t=1:t=Math.floor(new ur(e).abs().log(10).toNumber())+1,t}function KN(e,t,r){for(var n=new ur(e),i=0,a=[];n.lt(t)&&i<1e5;)a.push(n.toNumber()),n=n.add(r),i++;return a}fp((e,t,r)=>{var n=+e,i=+t;return n+r*(i-n)});fp((e,t,r)=>{var n=t-+e;return n=n||1/0,(r-e)/n});fp((e,t,r)=>{var n=t-+e;return n=n||1/0,Math.max(0,Math.min(1,(r-e)/n))});var YN=e=>{var[t,r]=e,[n,i]=[t,r];return t>r&&([n,i]=[r,t]),[n,i]},XN=(e,t,r)=>{if(e.lte(0))return new ur(0);var n=VN(e.toNumber()),i=new ur(10).pow(n),a=e.div(i),s=n!==1?.05:.1,o=new ur(Math.ceil(a.div(s).toNumber())).add(r).mul(s),l=o.mul(i);return t?new ur(l.toNumber()):new ur(Math.ceil(l.toNumber()))},lD=(e,t,r)=>{var n=new ur(1),i=new ur(e);if(!i.isint()&&r){var a=Math.abs(e);a<1?(n=new ur(10).pow(VN(e)-1),i=new ur(Math.floor(i.div(n).toNumber())).mul(n)):a>1&&(i=new ur(Math.floor(e)))}else e===0?i=new ur(Math.floor((t-1)/2)):r||(i=new ur(Math.floor(e)));var s=Math.floor((t-1)/2),o=oD(sD(l=>i.add(new ur(l-s).mul(n)).toNumber()),ag);return o(0,t)},ZN=function(t,r,n,i){var a=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((r-t)/(n-1)))return{step:new ur(0),tickMin:new ur(0),tickMax:new ur(0)};var s=XN(new ur(r).sub(t).div(n-1),i,a),o;t<=0&&r>=0?o=new ur(0):(o=new ur(t).add(r).div(2),o=o.sub(new ur(o).mod(s)));var l=Math.ceil(o.sub(t).div(s).toNumber()),c=Math.ceil(new ur(r).sub(o).div(s).toNumber()),u=l+c+1;return u>n?ZN(t,r,n,i,a+1):(u<n&&(c=r>0?c+(n-u):c,l=r>0?l:l+(n-u)),{step:s,tickMin:o.sub(new ur(l).mul(s)),tickMax:o.add(new ur(c).mul(s))})};function cD(e){var[t,r]=e,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,a=Math.max(n,2),[s,o]=YN([t,r]);if(s===-1/0||o===1/0){var l=o===1/0?[s,...ag(0,n-1).map(()=>1/0)]:[...ag(0,n-1).map(()=>-1/0),o];return t>r?sg(l):l}if(s===o)return lD(s,n,i);var{step:c,tickMin:u,tickMax:h}=ZN(s,o,a,i,0),p=KN(u,h.add(new ur(.1).mul(c)),c);return t>r?sg(p):p}function uD(e,t){var[r,n]=e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,[a,s]=YN([r,n]);if(a===-1/0||s===1/0)return[r,n];if(a===s)return[a];var o=Math.max(t,2),l=XN(new ur(s).sub(a).div(o-1),i,0),c=[...KN(new ur(a),new ur(s),l),s];return i===!1&&(c=c.map(u=>Math.round(u))),r>n?sg(c):c}var fD=GN(cD),hD=GN(uD),dD=e=>e.rootProps.barCategoryGap,Zf=e=>e.rootProps.stackOffset,$2=e=>e.options.chartName,z2=e=>e.rootProps.syncId,JN=e=>e.rootProps.syncMethod,W2=e=>e.options.eventEmitter,Ns={allowDuplicatedCategory:!0,angleAxisId:0,axisLine:!0,cx:0,cy:0,orientation:"outer",reversed:!1,scale:"auto",tick:!0,tickLine:!0,tickSize:8,type:"category"},Oi={allowDataOverflow:!1,allowDuplicatedCategory:!0,angle:0,axisLine:!0,cx:0,cy:0,orientation:"right",radiusAxisId:0,scale:"auto",stroke:"#ccc",tick:!0,tickCount:5,type:"number"},hp=(e,t)=>{if(!(!e||!t))return e!=null&&e.reversed?[t[1],t[0]]:t},pD={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:!1,dataKey:void 0,domain:void 0,id:Ns.angleAxisId,includeHidden:!1,name:void 0,reversed:Ns.reversed,scale:Ns.scale,tick:Ns.tick,tickCount:void 0,ticks:void 0,type:Ns.type,unit:void 0},mD={allowDataOverflow:Oi.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Oi.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Oi.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Oi.scale,tick:Oi.tick,tickCount:Oi.tickCount,ticks:void 0,type:Oi.type,unit:void 0},gD={allowDataOverflow:!1,allowDecimals:!1,allowDuplicatedCategory:Ns.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Ns.angleAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Ns.scale,tick:Ns.tick,tickCount:void 0,ticks:void 0,type:"number",unit:void 0},vD={allowDataOverflow:Oi.allowDataOverflow,allowDecimals:!1,allowDuplicatedCategory:Oi.allowDuplicatedCategory,dataKey:void 0,domain:void 0,id:Oi.radiusAxisId,includeHidden:!1,name:void 0,reversed:!1,scale:Oi.scale,tick:Oi.tick,tickCount:Oi.tickCount,ticks:void 0,type:"category",unit:void 0},q2=(e,t)=>e.polarAxis.angleAxis[t]!=null?e.polarAxis.angleAxis[t]:e.layout.layoutType==="radial"?gD:pD,H2=(e,t)=>e.polarAxis.radiusAxis[t]!=null?e.polarAxis.radiusAxis[t]:e.layout.layoutType==="radial"?vD:mD,dp=e=>e.polarOptions,G2=ke([Us,$s,Jn],P3),QN=ke([dp,G2],(e,t)=>{if(e!=null)return es(e.innerRadius,t,0)}),eS=ke([dp,G2],(e,t)=>{if(e!=null)return es(e.outerRadius,t,t*.8)}),xD=e=>{if(e==null)return[0,0];var{startAngle:t,endAngle:r}=e;return[t,r]},tS=ke([dp],xD);ke([q2,tS],hp);var rS=ke([G2,QN,eS],(e,t,r)=>{if(!(e==null||t==null||r==null))return[t,r]});ke([H2,rS],hp);var yD=ke([Ar,dp,QN,eS,Us,$s],(e,t,r,n,i,a)=>{if(!(e!=="centric"&&e!=="radial"||t==null||r==null||n==null)){var{cx:s,cy:o,startAngle:l,endAngle:c}=t;return{cx:es(s,i,i/2),cy:es(o,a,a/2),innerRadius:r,outerRadius:n,startAngle:l,endAngle:c,clockWise:!1}}}),Lr=(e,t)=>t,Jf=(e,t,r)=>r;function nS(e){return e==null?void 0:e.id}var gn=e=>{var t=Ar(e);return t==="horizontal"?"xAxis":t==="vertical"?"yAxis":t==="centric"?"angleAxis":"radiusAxis"},Zc=e=>e.tooltip.settings.axisId,vn=e=>{var t=gn(e),r=Zc(e);return Qf(e,t,r)};function iS(e,t,r){var{chartData:n=[]}=t,i=r==null?void 0:r.dataKey,a=new Map;return e.forEach(s=>{var o,l=(o=s.data)!==null&&o!==void 0?o:n;if(!(l==null||l.length===0)){var c=nS(s);l.forEach((u,h)=>{var p=i==null?h:String(an(u,i,null)),d=an(u,s.dataKey,0),v;a.has(p)?v=a.get(p):v={},Object.assign(v,{[c]:d}),a.set(p,v)})}}),Array.from(a.values())}function V2(e){return e.stackId!=null&&e.dataKey!=null}function qb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function td(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?qb(Object(r),!0).forEach(function(n){bD(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):qb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function bD(e,t,r){return(t=wD(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wD(e){var t=_D(e,"string");return typeof t=="symbol"?t:t+""}function _D(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var og=[0,"auto"],ND={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:void 0,height:30,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"bottom",padding:{left:0,right:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"category",unit:void 0},Jc=(e,t)=>{var r=e.cartesianAxis.xAxis[t];return r??ND},SD={allowDataOverflow:!1,allowDecimals:!0,allowDuplicatedCategory:!0,angle:0,dataKey:void 0,domain:og,hide:!0,id:0,includeHidden:!1,interval:"preserveEnd",minTickGap:5,mirror:!1,name:void 0,orientation:"left",padding:{top:0,bottom:0},reversed:!1,scale:"auto",tick:!0,tickCount:5,tickFormatter:void 0,ticks:void 0,type:"number",unit:void 0,width:tp},Qc=(e,t)=>{var r=e.cartesianAxis.yAxis[t];return r??SD},AD={domain:[0,"auto"],includeHidden:!1,reversed:!1,allowDataOverflow:!1,allowDuplicatedCategory:!1,dataKey:void 0,id:0,name:"",range:[64,64],scale:"auto",type:"number",unit:""},K2=(e,t)=>{var r=e.cartesianAxis.zAxis[t];return r??AD},Jr=(e,t,r)=>{switch(t){case"xAxis":return Jc(e,r);case"yAxis":return Qc(e,r);case"zAxis":return K2(e,r);case"angleAxis":return q2(e,r);case"radiusAxis":return H2(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},ED=(e,t,r)=>{switch(t){case"xAxis":return Jc(e,r);case"yAxis":return Qc(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},Qf=(e,t,r)=>{switch(t){case"xAxis":return Jc(e,r);case"yAxis":return Qc(e,r);case"angleAxis":return q2(e,r);case"radiusAxis":return H2(e,r);default:throw new Error("Unexpected axis type: ".concat(t))}},aS=e=>e.graphicalItems.cartesianItems.some(t=>t.type==="bar")||e.graphicalItems.polarItems.some(t=>t.type==="radialBar");function Y2(e,t){return r=>{switch(e){case"xAxis":return"xAxisId"in r&&r.xAxisId===t;case"yAxis":return"yAxisId"in r&&r.yAxisId===t;case"zAxis":return"zAxisId"in r&&r.zAxisId===t;case"angleAxis":return"angleAxisId"in r&&r.angleAxisId===t;case"radiusAxis":return"radiusAxisId"in r&&r.radiusAxisId===t;default:return!1}}}var TD=e=>e.graphicalItems.cartesianItems,PD=ke([Lr,Jf],Y2),X2=(e,t,r)=>e.filter(r).filter(n=>(t==null?void 0:t.includeHidden)===!0?!0:!n.hide),e0=ke([TD,Jr,PD],X2),sS=ke([e0],e=>e.filter(t=>t.type==="area"||t.type==="bar").filter(V2)),oS=e=>e.filter(t=>!("stackId"in t)||t.stackId===void 0),lS=ke([e0],oS),Z2=e=>e.map(t=>t.data).filter(Boolean).flat(1),jD=ke([e0],Z2),J2=(e,t)=>{var{chartData:r=[],dataStartIndex:n,dataEndIndex:i}=t;return e.length>0?e:r.slice(n,i+1)},Q2=ke([jD,MN],J2),ev=(e,t,r)=>(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:an(n,t.dataKey)})):r.length>0?r.map(n=>n.dataKey).flatMap(n=>e.map(i=>({value:an(i,n)}))):e.map(n=>({value:n})),pp=ke([Q2,Jr,e0],ev);function cS(e,t){switch(e){case"xAxis":return t.direction==="x";case"yAxis":return t.direction==="y";default:return!1}}function Ol(e){return e.filter(t=>Os(t)||t instanceof Date).map(Number).filter(t=>Ca(t)===!1)}function kD(e,t,r){return!r||typeof t!="number"||Ca(t)?[]:r.length?Ol(r.flatMap(n=>{var i=an(e,n.dataKey),a,s;if(Array.isArray(i)?[a,s]=i:a=s=i,!(!Oa(a)||!Oa(s)))return[t-a,t+s]})):[]}var CD=ke([sS,MN,vn],iS),uS=(e,t,r)=>{var n={},i=t.reduce((a,s)=>(s.stackId==null||(a[s.stackId]==null&&(a[s.stackId]=[]),a[s.stackId].push(s)),a),n);return Object.fromEntries(Object.entries(i).map(a=>{var[s,o]=a,l=o.map(nS);return[s,{stackedData:YC(e,l,r),graphicalItems:o}]}))},OD=ke([CD,sS,Zf],uS),fS=(e,t,r)=>{var{dataStartIndex:n,dataEndIndex:i}=t;if(r!=="zAxis"){var a=JC(e,n,i);if(!(a!=null&&a[0]===0&&a[1]===0))return a}},LD=ke([OD,Fo,Lr],fS),hS=(e,t,r,n,i)=>r.length>0?e.flatMap(a=>r.flatMap(s=>{var o,l,c=(o=n[s.id])===null||o===void 0?void 0:o.filter(h=>cS(i,h)),u=an(a,(l=t.dataKey)!==null&&l!==void 0?l:s.dataKey);return{value:u,errorDomain:kD(a,u,c)}})).filter(Boolean):(t==null?void 0:t.dataKey)!=null?e.map(a=>({value:an(a,t.dataKey),errorDomain:[]})):e.map(a=>({value:a,errorDomain:[]})),mp=e=>e.errorBars,dS=(e,t,r)=>e.flatMap(n=>t[n.id]).filter(Boolean).filter(n=>cS(r,n));ke([lS,mp,Lr],dS);var FD=ke([Q2,Jr,lS,mp,Lr],hS);function DD(e){var{value:t}=e;if(Os(t)||t instanceof Date)return t}var Hb=e=>{var t=e.flatMap(n=>[n.value,n.errorDomain]).flat(1),r=Ol(t);if(r.length!==0)return[Math.min(...r),Math.max(...r)]},ID=(e,t,r)=>{var n=e.map(DD).filter(i=>i!=null);return r&&(t.dataKey==null||t.allowDuplicatedCategory&&c4(n))?rN(0,e.length):t.allowDuplicatedCategory?n:Array.from(new Set(n))},tv=e=>{var t;if(e==null||!("domain"in e))return og;if(e.domain!=null)return e.domain;if(e.ticks!=null){if(e.type==="number"){var r=Ol(e.ticks);return[Math.min(...r),Math.max(...r)]}if(e.type==="category")return e.ticks.map(String)}return(t=e==null?void 0:e.domain)!==null&&t!==void 0?t:og},rd=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];var i=r.filter(Boolean);if(i.length!==0){var a=i.flat(),s=Math.min(...a),o=Math.max(...a);return[s,o]}},pS=e=>e.referenceElements.dots,eu=(e,t,r)=>e.filter(n=>n.ifOverflow==="extendDomain").filter(n=>t==="xAxis"?n.xAxisId===r:n.yAxisId===r),MD=ke([pS,Lr,Jf],eu),mS=e=>e.referenceElements.areas,RD=ke([mS,Lr,Jf],eu),gS=e=>e.referenceElements.lines,BD=ke([gS,Lr,Jf],eu),vS=(e,t)=>{var r=Ol(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},UD=ke(MD,Lr,vS),xS=(e,t)=>{var r=Ol(e.flatMap(n=>[t==="xAxis"?n.x1:n.y1,t==="xAxis"?n.x2:n.y2]));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},$D=ke([RD,Lr],xS),yS=(e,t)=>{var r=Ol(e.map(n=>t==="xAxis"?n.x:n.y));if(r.length!==0)return[Math.min(...r),Math.max(...r)]},zD=ke(BD,Lr,yS),WD=ke(UD,zD,$D,(e,t,r)=>rd(e,r,t)),bS=ke([Jr],tv),rv=(e,t,r,n,i,a,s)=>{var o=eD(t,e.allowDataOverflow);if(o!=null)return o;var l=a==="vertical"&&s==="xAxis"||a==="horizontal"&&s==="yAxis",c=l?rd(r,i,Hb(n)):rd(i,Hb(n));return tD(t,c,e.allowDataOverflow)},qD=ke([Jr,bS,LD,FD,WD,Ar,Lr],rv),HD=[0,1],nv=(e,t,r,n,i,a,s)=>{if(!((e==null||r==null||r.length===0)&&s===void 0)){var{dataKey:o,type:l}=e,c=jl(t,a);return c&&o==null?rN(0,r.length):l==="category"?ID(n,e,c):i==="expand"?HD:s}},iv=ke([Jr,Ar,Q2,pp,Zf,Lr,qD],nv),wS=(e,t,r,n,i)=>{if(e!=null){var{scale:a,type:s}=e;if(a==="auto")return t==="radial"&&i==="radiusAxis"?"band":t==="radial"&&i==="angleAxis"?"linear":s==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?"point":s==="category"?"band":"linear";if(typeof a=="string"){var o="scale".concat(Hf(a));return o in Qu?o:"point"}}},tu=ke([Jr,Ar,aS,$2,Lr],wS);function GD(e){if(e!=null){if(e in Qu)return Qu[e]();var t="scale".concat(Hf(e));if(t in Qu)return Qu[t]()}}function av(e,t,r,n){if(!(r==null||n==null)){if(typeof e.scale=="function")return e.scale.copy().domain(r).range(n);var i=GD(t);if(i!=null){var a=i.domain(r).range(n);return HC(a),a}}}var sv=(e,t,r)=>{var n=tv(t);if(!(r!=="auto"&&r!=="linear")){if(t!=null&&t.tickCount&&Array.isArray(n)&&(n[0]==="auto"||n[1]==="auto")&&$c(e))return fD(e,t.tickCount,t.allowDecimals);if(t!=null&&t.tickCount&&t.type==="number"&&$c(e))return hD(e,t.tickCount,t.allowDecimals)}},ov=ke([iv,Qf,tu],sv),lv=(e,t,r,n)=>{if(n!=="angleAxis"&&(e==null?void 0:e.type)==="number"&&$c(t)&&Array.isArray(r)&&r.length>0){var i=t[0],a=r[0],s=t[1],o=r[r.length-1];return[Math.min(i,a),Math.max(s,o)]}return t},VD=ke([Jr,iv,ov,Lr],lv),KD=ke(pp,Jr,(e,t)=>{if(!(!t||t.type!=="number")){var r=1/0,n=Array.from(Ol(e.map(o=>o.value))).sort((o,l)=>o-l);if(n.length<2)return 1/0;var i=n[n.length-1]-n[0];if(i===0)return 1/0;for(var a=0;a<n.length-1;a++){var s=n[a+1]-n[a];r=Math.min(r,s)}return r/i}}),_S=ke(KD,Ar,dD,Jn,(e,t,r,n)=>n,(e,t,r,n,i)=>{if(!Oa(e))return 0;var a=t==="vertical"?n.height:n.width;if(i==="gap")return e*a/2;if(i==="no-gap"){var s=es(r,e*a),o=e*a/2;return o-s-(o-s)/a*s}return 0}),YD=(e,t)=>{var r=Jc(e,t);return r==null||typeof r.padding!="string"?0:_S(e,"xAxis",t,r.padding)},XD=(e,t)=>{var r=Qc(e,t);return r==null||typeof r.padding!="string"?0:_S(e,"yAxis",t,r.padding)},ZD=ke(Jc,YD,(e,t)=>{var r,n;if(e==null)return{left:0,right:0};var{padding:i}=e;return typeof i=="string"?{left:t,right:t}:{left:((r=i.left)!==null&&r!==void 0?r:0)+t,right:((n=i.right)!==null&&n!==void 0?n:0)+t}}),JD=ke(Qc,XD,(e,t)=>{var r,n;if(e==null)return{top:0,bottom:0};var{padding:i}=e;return typeof i=="string"?{top:t,bottom:t}:{top:((r=i.top)!==null&&r!==void 0?r:0)+t,bottom:((n=i.bottom)!==null&&n!==void 0?n:0)+t}}),QD=ke([Jn,ZD,np,rp,(e,t,r)=>r],(e,t,r,n,i)=>{var{padding:a}=n;return i?[a.left,r.width-a.right]:[e.left+t.left,e.left+e.width-t.right]}),eI=ke([Jn,Ar,JD,np,rp,(e,t,r)=>r],(e,t,r,n,i,a)=>{var{padding:s}=i;return a?[n.height-s.bottom,s.top]:t==="horizontal"?[e.top+e.height-r.bottom,e.top+r.top]:[e.top+r.top,e.top+e.height-r.bottom]}),t0=(e,t,r,n)=>{var i;switch(t){case"xAxis":return QD(e,r,n);case"yAxis":return eI(e,r,n);case"zAxis":return(i=K2(e,r))===null||i===void 0?void 0:i.range;case"angleAxis":return tS(e);case"radiusAxis":return rS(e,r);default:return}},NS=ke([Jr,t0],hp),gp=ke([Jr,tu,VD,NS],av);ke([e0,mp,Lr],dS);function SS(e,t){return e.id<t.id?-1:e.id>t.id?1:0}var vp=(e,t)=>t,xp=(e,t,r)=>r,tI=ke(h2,vp,xp,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(SS)),rI=ke(d2,vp,xp,(e,t,r)=>e.filter(n=>n.orientation===t).filter(n=>n.mirror===r).sort(SS)),AS=(e,t)=>({width:e.width,height:t.height}),nI=(e,t)=>{var r=typeof t.width=="number"?t.width:tp;return{width:r,height:e.height}};ke(Jn,Jc,AS);var iI=(e,t,r)=>{switch(t){case"top":return e.top;case"bottom":return r-e.bottom;default:return 0}},aI=(e,t,r)=>{switch(t){case"left":return e.left;case"right":return r-e.right;default:return 0}};ke($s,Jn,tI,vp,xp,(e,t,r,n,i)=>{var a={},s;return r.forEach(o=>{var l=AS(t,o);s==null&&(s=iI(t,n,e));var c=n==="top"&&!i||n==="bottom"&&i;a[o.id]=s-Number(c)*l.height,s+=(c?-1:1)*l.height}),a});ke(Us,Jn,rI,vp,xp,(e,t,r,n,i)=>{var a={},s;return r.forEach(o=>{var l=nI(t,o);s==null&&(s=aI(t,n,e));var c=n==="left"&&!i||n==="right"&&i;a[o.id]=s-Number(c)*l.width,s+=(c?-1:1)*l.width}),a});ke(Jn,Qc,(e,t)=>{var r=typeof t.width=="number"?t.width:tp;return{width:r,height:e.height}});var ES=(e,t,r,n)=>{if(r!=null){var{allowDuplicatedCategory:i,type:a,dataKey:s}=r,o=jl(e,n),l=t.map(c=>c.value);if(s&&o&&a==="category"&&i&&c4(l))return l}},cv=ke([Ar,pp,Jr,Lr],ES),TS=(e,t,r,n)=>{if(!(r==null||r.dataKey==null)){var{type:i,scale:a}=r,s=jl(e,n);if(s&&(i==="number"||a!=="auto"))return t.map(o=>o.value)}},uv=ke([Ar,pp,Qf,Lr],TS);ke([Ar,ED,tu,gp,cv,uv,t0,ov,Lr],(e,t,r,n,i,a,s,o,l)=>{if(t==null)return null;var c=jl(e,l);return{angle:t.angle,interval:t.interval,minTickGap:t.minTickGap,orientation:t.orientation,tick:t.tick,tickCount:t.tickCount,tickFormatter:t.tickFormatter,ticks:t.ticks,type:t.type,unit:t.unit,axisType:l,categoricalDomain:a,duplicateDomain:i,isCategorical:c,niceTicks:o,range:s,realScaleType:r,scale:n}});var sI=(e,t,r,n,i,a,s,o,l)=>{if(!(t==null||n==null)){var c=jl(e,l),{type:u,ticks:h,tickCount:p}=t,d=r==="scaleBand"&&typeof n.bandwidth=="function"?n.bandwidth()/2:2,v=u==="category"&&n.bandwidth?n.bandwidth()/d:0;v=l==="angleAxis"&&a!=null&&a.length>=2?Mi(a[0]-a[1])*2*v:v;var g=h||i;if(g){var y=g.map((b,E)=>{var S=s?s.indexOf(b):b;return{index:E,coordinate:n(S)+v,value:b,offset:v}});return y.filter(b=>!Ca(b.coordinate))}return c&&o?o.map((b,E)=>({coordinate:n(b)+v,value:b,index:E,offset:v})):n.ticks?n.ticks(p).map(b=>({coordinate:n(b)+v,value:b,offset:v})):n.domain().map((b,E)=>({coordinate:n(b)+v,value:s?s[b]:b,index:E,offset:v}))}};ke([Ar,Qf,tu,gp,ov,t0,cv,uv,Lr],sI);var oI=(e,t,r,n,i,a,s)=>{if(!(t==null||r==null||n==null||n[0]===n[1])){var o=jl(e,s),{tickCount:l}=t,c=0;return c=s==="angleAxis"&&(n==null?void 0:n.length)>=2?Mi(n[0]-n[1])*2*c:c,o&&a?a.map((u,h)=>({coordinate:r(u)+c,value:u,index:h,offset:c})):r.ticks?r.ticks(l).map(u=>({coordinate:r(u)+c,value:u,offset:c})):r.domain().map((u,h)=>({coordinate:r(u)+c,value:i?i[u]:u,index:h,offset:c}))}};ke([Ar,Qf,gp,t0,cv,uv,Lr],oI);ke(Jr,gp,(e,t)=>{if(!(e==null||t==null))return td(td({},e),{},{scale:t})});var lI=ke([Jr,tu,iv,NS],av);ke((e,t,r)=>K2(e,r),lI,(e,t)=>{if(!(e==null||t==null))return td(td({},e),{},{scale:t})});var cI=ke([Ar,h2,d2],(e,t,r)=>{switch(e){case"horizontal":return t.some(n=>n.reversed)?"right-to-left":"left-to-right";case"vertical":return r.some(n=>n.reversed)?"bottom-to-top":"top-to-bottom";case"centric":case"radial":return"left-to-right";default:return}}),PS=e=>e.options.defaultTooltipEventType,jS=e=>e.options.validateTooltipEventTypes;function kS(e,t,r){if(e==null)return t;var n=e?"axis":"item";return r==null?t:r.includes(n)?n:t}function fv(e,t){var r=PS(e),n=jS(e);return kS(t,r,n)}function uI(e){return qt(t=>fv(t,e))}var CS=(e,t)=>{var r,n=Number(t);if(!(Ca(n)||t==null))return n>=0?e==null||(r=e[n])===null||r===void 0?void 0:r.value:void 0},fI=e=>e.tooltip.settings,ho={active:!1,index:null,dataKey:void 0,coordinate:void 0},hI={itemInteraction:{click:ho,hover:ho},axisInteraction:{click:ho,hover:ho},keyboardInteraction:ho,syncInteraction:{active:!1,index:null,dataKey:void 0,label:void 0,coordinate:void 0},tooltipItemPayloads:[],settings:{shared:void 0,trigger:"hover",axisId:0,active:!1,defaultIndex:void 0}},OS=Gi({name:"tooltip",initialState:hI,reducers:{addTooltipEntrySettings(e,t){e.tooltipItemPayloads.push(t.payload)},removeTooltipEntrySettings(e,t){var r=Ts(e).tooltipItemPayloads.indexOf(t.payload);r>-1&&e.tooltipItemPayloads.splice(r,1)},setTooltipSettingsState(e,t){e.settings=t.payload},setActiveMouseOverItemIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.itemInteraction.hover.active=!0,e.itemInteraction.hover.index=t.payload.activeIndex,e.itemInteraction.hover.dataKey=t.payload.activeDataKey,e.itemInteraction.hover.coordinate=t.payload.activeCoordinate},mouseLeaveChart(e){e.itemInteraction.hover.active=!1,e.axisInteraction.hover.active=!1},mouseLeaveItem(e){e.itemInteraction.hover.active=!1},setActiveClickItemIndex(e,t){e.syncInteraction.active=!1,e.itemInteraction.click.active=!0,e.keyboardInteraction.active=!1,e.itemInteraction.click.index=t.payload.activeIndex,e.itemInteraction.click.dataKey=t.payload.activeDataKey,e.itemInteraction.click.coordinate=t.payload.activeCoordinate},setMouseOverAxisIndex(e,t){e.syncInteraction.active=!1,e.axisInteraction.hover.active=!0,e.keyboardInteraction.active=!1,e.axisInteraction.hover.index=t.payload.activeIndex,e.axisInteraction.hover.dataKey=t.payload.activeDataKey,e.axisInteraction.hover.coordinate=t.payload.activeCoordinate},setMouseClickAxisIndex(e,t){e.syncInteraction.active=!1,e.keyboardInteraction.active=!1,e.axisInteraction.click.active=!0,e.axisInteraction.click.index=t.payload.activeIndex,e.axisInteraction.click.dataKey=t.payload.activeDataKey,e.axisInteraction.click.coordinate=t.payload.activeCoordinate},setSyncInteraction(e,t){e.syncInteraction=t.payload},setKeyboardInteraction(e,t){e.keyboardInteraction.active=t.payload.active,e.keyboardInteraction.index=t.payload.activeIndex,e.keyboardInteraction.coordinate=t.payload.activeCoordinate,e.keyboardInteraction.dataKey=t.payload.activeDataKey}}}),{addTooltipEntrySettings:dI,removeTooltipEntrySettings:pI,setTooltipSettingsState:mI,setActiveMouseOverItemIndex:LS,mouseLeaveItem:gI,mouseLeaveChart:FS,setActiveClickItemIndex:vI,setMouseOverAxisIndex:DS,setMouseClickAxisIndex:xI,setSyncInteraction:lg,setKeyboardInteraction:cg}=OS.actions,yI=OS.reducer;function Gb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function X0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Gb(Object(r),!0).forEach(function(n){bI(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Gb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function bI(e,t,r){return(t=wI(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wI(e){var t=_I(e,"string");return typeof t=="symbol"?t:t+""}function _I(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function NI(e,t,r){return t==="axis"?r==="click"?e.axisInteraction.click:e.axisInteraction.hover:r==="click"?e.itemInteraction.click:e.itemInteraction.hover}function SI(e){return e.index!=null}var IS=(e,t,r,n)=>{if(t==null)return ho;var i=NI(e,t,r);if(i==null)return ho;if(i.active)return i;if(e.keyboardInteraction.active)return e.keyboardInteraction;if(e.syncInteraction.active&&e.syncInteraction.index!=null)return e.syncInteraction;var a=e.settings.active===!0;if(SI(i)){if(a)return X0(X0({},i),{},{active:!0})}else if(n!=null)return{active:!0,coordinate:void 0,dataKey:void 0,index:n};return X0(X0({},ho),{},{coordinate:i.coordinate})},hv=(e,t)=>{var r=e==null?void 0:e.index;if(r==null)return null;var n=Number(r);if(!Oa(n))return r;var i=0,a=1/0;return t.length>0&&(a=t.length-1),String(Math.max(i,Math.min(n,a)))},MS=(e,t,r,n,i,a,s,o)=>{if(!(a==null||o==null)){var l=s[0],c=l==null?void 0:o(l.positions,a);if(c!=null)return c;var u=i==null?void 0:i[Number(a)];if(u)switch(r){case"horizontal":return{x:u.coordinate,y:(n.top+t)/2};default:return{x:(n.left+e)/2,y:u.coordinate}}}},RS=(e,t,r,n)=>{if(t==="axis")return e.tooltipItemPayloads;if(e.tooltipItemPayloads.length===0)return[];var i;return r==="hover"?i=e.itemInteraction.hover.dataKey:i=e.itemInteraction.click.dataKey,i==null&&n!=null?[e.tooltipItemPayloads[0]]:e.tooltipItemPayloads.filter(a=>{var s;return((s=a.settings)===null||s===void 0?void 0:s.dataKey)===i})},r0=e=>e.options.tooltipPayloadSearcher,ru=e=>e.tooltip;function Vb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Kb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Vb(Object(r),!0).forEach(function(n){AI(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Vb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function AI(e,t,r){return(t=EI(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function EI(e){var t=TI(e,"string");return typeof t=="symbol"?t:t+""}function TI(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function PI(e,t){return e??t}var BS=(e,t,r,n,i,a,s)=>{if(!(t==null||a==null)){var{chartData:o,computedData:l,dataStartIndex:c,dataEndIndex:u}=r,h=[];return e.reduce((p,d)=>{var v,{dataDefinedOnItem:g,settings:y}=d,b=PI(g,o),E=Array.isArray(b)?j3(b,c,u):b,S=(v=y==null?void 0:y.dataKey)!==null&&v!==void 0?v:n==null?void 0:n.dataKey,P=y==null?void 0:y.nameKey,L;if(n!=null&&n.dataKey&&Array.isArray(E)&&!Array.isArray(E[0])&&s==="axis"?L=HP(E,n.dataKey,i):L=a(E,t,l,P),Array.isArray(L))L.forEach(C=>{var R=Kb(Kb({},y),{},{name:C.name,unit:C.unit,color:void 0,fill:void 0});p.push(Uy({tooltipEntrySettings:R,dataKey:C.dataKey,payload:C.payload,value:an(C.payload,C.dataKey),name:C.name}))});else{var q;p.push(Uy({tooltipEntrySettings:y,dataKey:S,payload:L,value:an(L,S),name:(q=an(L,P))!==null&&q!==void 0?q:y==null?void 0:y.name}))}return p},h)}},dv=ke([vn,Ar,aS,$2,gn],wS),jI=ke([e=>e.graphicalItems.cartesianItems,e=>e.graphicalItems.polarItems],(e,t)=>[...e,...t]),kI=ke([gn,Zc],Y2),n0=ke([jI,vn,kI],X2),CI=ke([n0],e=>e.filter(V2)),OI=ke([n0],Z2),nu=ke([OI,Fo],J2),LI=ke([CI,Fo,vn],iS),pv=ke([nu,vn,n0],ev),FI=ke([vn],tv),DI=ke([n0],e=>e.filter(V2)),II=ke([LI,DI,Zf],uS),MI=ke([II,Fo,gn],fS),RI=ke([n0],oS),BI=ke([nu,vn,RI,mp,gn],hS),UI=ke([pS,gn,Zc],eu),$I=ke([UI,gn],vS),zI=ke([mS,gn,Zc],eu),WI=ke([zI,gn],xS),qI=ke([gS,gn,Zc],eu),HI=ke([qI,gn],yS),GI=ke([$I,HI,WI],rd),VI=ke([vn,FI,MI,BI,GI,Ar,gn],rv),US=ke([vn,Ar,nu,pv,Zf,gn,VI],nv),KI=ke([US,vn,dv],sv),YI=ke([vn,US,KI,gn],lv),$S=e=>{var t=gn(e),r=Zc(e),n=!1;return t0(e,t,r,n)},zS=ke([vn,$S],hp),WS=ke([vn,dv,YI,zS],av),XI=ke([Ar,pv,vn,gn],ES),ZI=ke([Ar,pv,vn,gn],TS),JI=(e,t,r,n,i,a,s,o)=>{if(t){var{type:l}=t,c=jl(e,o);if(n){var u=r==="scaleBand"&&n.bandwidth?n.bandwidth()/2:2,h=l==="category"&&n.bandwidth?n.bandwidth()/u:0;return h=o==="angleAxis"&&i!=null&&(i==null?void 0:i.length)>=2?Mi(i[0]-i[1])*2*h:h,c&&s?s.map((p,d)=>({coordinate:n(p)+h,value:p,index:d,offset:h})):n.domain().map((p,d)=>({coordinate:n(p)+h,value:a?a[p]:p,index:d,offset:h}))}}},Ws=ke([Ar,vn,dv,WS,$S,XI,ZI,gn],JI),mv=ke([PS,jS,fI],(e,t,r)=>kS(r.shared,e,t)),qS=e=>e.tooltip.settings.trigger,gv=e=>e.tooltip.settings.defaultIndex,yp=ke([ru,mv,qS,gv],IS),Tf=ke([yp,nu],hv),HS=ke([Ws,Tf],CS),QI=ke([yp],e=>{if(e)return e.dataKey}),GS=ke([ru,mv,qS,gv],RS),eM=ke([Us,$s,Ar,Jn,Ws,gv,GS,r0],MS),tM=ke([yp,eM],(e,t)=>e!=null&&e.coordinate?e.coordinate:t),rM=ke([yp],e=>e.active),nM=ke([GS,Tf,Fo,vn,HS,r0,mv],BS);ke([nM],e=>{if(e!=null){var t=e.map(r=>r.payload).filter(r=>r!=null);return Array.from(new Set(t))}});function Yb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Xb(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Yb(Object(r),!0).forEach(function(n){iM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function iM(e,t,r){return(t=aM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function aM(e){var t=sM(e,"string");return typeof t=="symbol"?t:t+""}function sM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var oM=()=>qt(vn),lM=()=>{var e=oM(),t=qt(Ws),r=qt(WS);return QC(Xb(Xb({},e),{},{scale:r}),t)},cM=()=>qt($2),vv=(e,t)=>t,VS=(e,t,r)=>r,xv=(e,t,r,n)=>n,uM=ke(Ws,e=>Kd(e,t=>t.coordinate)),yv=ke([ru,vv,VS,xv],IS),KS=ke([yv,nu],hv),fM=(e,t,r)=>{if(t!=null){var n=ru(e);return t==="axis"?r==="hover"?n.axisInteraction.hover.dataKey:n.axisInteraction.click.dataKey:r==="hover"?n.itemInteraction.hover.dataKey:n.itemInteraction.click.dataKey}},YS=ke([ru,vv,VS,xv],RS),nd=ke([Us,$s,Ar,Jn,Ws,xv,YS,r0],MS),hM=ke([yv,nd],(e,t)=>{var r;return(r=e.coordinate)!==null&&r!==void 0?r:t}),XS=ke(Ws,KS,CS),dM=ke([YS,KS,Fo,vn,XS,r0,vv],BS),pM=ke([yv],e=>({isActive:e.active,activeIndex:e.index})),mM=(e,t,r,n,i,a,s,o)=>{if(!(!e||!t||!n||!i||!a)){var l=eO(e.chartX,e.chartY,t,r,o);if(l){var c=rO(l,t),u=WC(c,s,a,n,i),h=tO(t,a,u,l);return{activeIndex:String(u),activeCoordinate:h}}}};function ug(){return ug=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ug.apply(null,arguments)}function Zb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Z0(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Zb(Object(r),!0).forEach(function(n){gM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zb(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function gM(e,t,r){return(t=vM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function vM(e){var t=xM(e,"string");return typeof t=="symbol"?t:t+""}function xM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yM(e){var{coordinate:t,payload:r,index:n,offset:i,tooltipAxisBandSize:a,layout:s,cursor:o,tooltipEventType:l,chartName:c}=e,u=t,h=r,p=n;if(!o||!u||c!=="ScatterChart"&&l!=="axis")return null;var d,v;if(c==="ScatterChart")d=u,v=qO;else if(c==="BarChart")d=HO(s,u,i,a),v=Y3;else if(s==="radial"){var{cx:g,cy:y,radius:b,startAngle:E,endAngle:S}=X3(u);d={cx:g,cy:y,startAngle:E,endAngle:S,innerRadius:b,outerRadius:b},v=J3}else d={points:S7(s,u,i)},v=R3;var P=typeof o=="object"&&"className"in o?o.className:void 0,L=Z0(Z0(Z0(Z0({stroke:"#ccc",pointerEvents:"none"},i),d),$i(o,!1)),{},{payload:h,payloadIndex:p,className:An("recharts-tooltip-cursor",P)});return z.isValidElement(o)?z.cloneElement(o,L):z.createElement(v,L)}function bM(e){var t=lM(),r=fO(),n=D3(),i=cM();return z.createElement(yM,ug({},e,{coordinate:e.coordinate,index:e.index,payload:e.payload,offset:r,layout:n,tooltipAxisBandSize:t,chartName:i}))}var ZS=z.createContext(null),wM=()=>z.useContext(ZS),JS={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function a(l,c,u,h,p){if(typeof u!="function")throw new TypeError("The listener must be a function");var d=new i(u,h||l,p),v=r?r+c:c;return l._events[v]?l._events[v].fn?l._events[v]=[l._events[v],d]:l._events[v].push(d):(l._events[v]=d,l._eventsCount++),l}function s(l,c){--l._eventsCount===0?l._events=new n:delete l._events[c]}function o(){this._events=new n,this._eventsCount=0}o.prototype.eventNames=function(){var c=[],u,h;if(this._eventsCount===0)return c;for(h in u=this._events)t.call(u,h)&&c.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},o.prototype.listeners=function(c){var u=r?r+c:c,h=this._events[u];if(!h)return[];if(h.fn)return[h.fn];for(var p=0,d=h.length,v=new Array(d);p<d;p++)v[p]=h[p].fn;return v},o.prototype.listenerCount=function(c){var u=r?r+c:c,h=this._events[u];return h?h.fn?1:h.length:0},o.prototype.emit=function(c,u,h,p,d,v){var g=r?r+c:c;if(!this._events[g])return!1;var y=this._events[g],b=arguments.length,E,S;if(y.fn){switch(y.once&&this.removeListener(c,y.fn,void 0,!0),b){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,u),!0;case 3:return y.fn.call(y.context,u,h),!0;case 4:return y.fn.call(y.context,u,h,p),!0;case 5:return y.fn.call(y.context,u,h,p,d),!0;case 6:return y.fn.call(y.context,u,h,p,d,v),!0}for(S=1,E=new Array(b-1);S<b;S++)E[S-1]=arguments[S];y.fn.apply(y.context,E)}else{var P=y.length,L;for(S=0;S<P;S++)switch(y[S].once&&this.removeListener(c,y[S].fn,void 0,!0),b){case 1:y[S].fn.call(y[S].context);break;case 2:y[S].fn.call(y[S].context,u);break;case 3:y[S].fn.call(y[S].context,u,h);break;case 4:y[S].fn.call(y[S].context,u,h,p);break;default:if(!E)for(L=1,E=new Array(b-1);L<b;L++)E[L-1]=arguments[L];y[S].fn.apply(y[S].context,E)}}return!0},o.prototype.on=function(c,u,h){return a(this,c,u,h,!1)},o.prototype.once=function(c,u,h){return a(this,c,u,h,!0)},o.prototype.removeListener=function(c,u,h,p){var d=r?r+c:c;if(!this._events[d])return this;if(!u)return s(this,d),this;var v=this._events[d];if(v.fn)v.fn===u&&(!p||v.once)&&(!h||v.context===h)&&s(this,d);else{for(var g=0,y=[],b=v.length;g<b;g++)(v[g].fn!==u||p&&!v[g].once||h&&v[g].context!==h)&&y.push(v[g]);y.length?this._events[d]=y.length===1?y[0]:y:s(this,d)}return this},o.prototype.removeAllListeners=function(c){var u;return c?(u=r?r+c:c,this._events[u]&&s(this,u)):(this._events=new n,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,e.exports=o})(JS);var _M=JS.exports;const NM=ko(_M);var Pf=new NM,fg="recharts.syncEvent.tooltip",Jb="recharts.syncEvent.brush";function SM(e,t){if(t){var r=Number.parseInt(t,10);if(!Ca(r))return e==null?void 0:e[r]}}var AM={chartName:"",tooltipPayloadSearcher:void 0,eventEmitter:void 0,defaultTooltipEventType:"axis"},QS=Gi({name:"options",initialState:AM,reducers:{createEventEmitter:e=>{e.eventEmitter==null&&(e.eventEmitter=Symbol("rechartsEventEmitter"))}}}),EM=QS.reducer,{createEventEmitter:TM}=QS.actions;function PM(e){return e.tooltip.syncInteraction}var jM={chartData:void 0,computedData:void 0,dataStartIndex:0,dataEndIndex:0},eA=Gi({name:"chartData",initialState:jM,reducers:{setChartData(e,t){if(e.chartData=t.payload,t.payload==null){e.dataStartIndex=0,e.dataEndIndex=0;return}t.payload.length>0&&e.dataEndIndex!==t.payload.length-1&&(e.dataEndIndex=t.payload.length-1)},setComputedData(e,t){e.computedData=t.payload},setDataStartEndIndexes(e,t){var{startIndex:r,endIndex:n}=t.payload;r!=null&&(e.dataStartIndex=r),n!=null&&(e.dataEndIndex=n)}}}),{setChartData:Qb,setDataStartEndIndexes:kM,setComputedData:dJ}=eA.actions,CM=eA.reducer,tA=()=>{};function OM(){var e=qt(z2),t=qt(W2),r=Zn(),n=qt(JN),i=qt(Ws),a=D3(),s=F3(),o=qt(l=>l.rootProps.className);z.useEffect(()=>{if(e==null)return tA;var l=(c,u,h)=>{if(t!==h&&e===c){if(n==="index"){r(u);return}if(i!=null){var p;if(typeof n=="function"){var d={activeTooltipIndex:u.payload.index==null?void 0:Number(u.payload.index),isTooltipActive:u.payload.active,activeIndex:u.payload.index==null?void 0:Number(u.payload.index),activeLabel:u.payload.label,activeDataKey:u.payload.dataKey,activeCoordinate:u.payload.coordinate},v=n(i,d);p=i[v]}else n==="value"&&(p=i.find(q=>String(q.value)===u.payload.label));var{coordinate:g}=u.payload;if(p==null||u.payload.active===!1||g==null||s==null){r(lg({active:!1,coordinate:void 0,dataKey:void 0,index:null,label:void 0}));return}var{x:y,y:b}=g,E=Math.min(y,s.x+s.width),S=Math.min(b,s.y+s.height),P={x:a==="horizontal"?p.coordinate:E,y:a==="horizontal"?S:p.coordinate},L=lg({active:u.payload.active,coordinate:P,dataKey:u.payload.dataKey,index:String(p.index),label:u.payload.label});r(L)}}};return Pf.on(fg,l),()=>{Pf.off(fg,l)}},[o,r,t,e,n,i,a,s])}function LM(){var e=qt(z2),t=qt(W2),r=Zn();z.useEffect(()=>{if(e==null)return tA;var n=(i,a,s)=>{t!==s&&e===i&&r(kM(a))};return Pf.on(Jb,n),()=>{Pf.off(Jb,n)}},[r,t,e])}function FM(){var e=Zn();z.useEffect(()=>{e(TM())},[e]),OM(),LM()}function DM(e,t,r,n,i,a){var s=qt(p=>fM(p,e,t)),o=qt(W2),l=qt(z2),c=qt(JN),u=qt(PM),h=u==null?void 0:u.active;z.useEffect(()=>{if(!h&&l!=null&&o!=null){var p=lg({active:a,coordinate:r,dataKey:s,index:i,label:typeof n=="number"?String(n):n});Pf.emit(fg,l,p,o)}},[h,r,s,i,n,o,l,c,a])}function e5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function t5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?e5(Object(r),!0).forEach(function(n){IM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):e5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function IM(e,t,r){return(t=MM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function MM(e){var t=RM(e,"string");return typeof t=="symbol"?t:t+""}function RM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function BM(e){return e.dataKey}function UM(e,t){return z.isValidElement(e)?z.cloneElement(e,t):typeof e=="function"?z.createElement(e,t):z.createElement(_O,t)}var r5=[],$M={allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",axisId:0,contentStyle:{},cursor:!0,filterNull:!0,isAnimationActive:!ip.isSsr,itemSorter:"name",itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,wrapperStyle:{}};function zM(e){var t=Co(e,$M),{active:r,allowEscapeViewBox:n,animationDuration:i,animationEasing:a,content:s,filterNull:o,isAnimationActive:l,offset:c,payloadUniqBy:u,position:h,reverseDirection:p,useTranslate3d:d,wrapperStyle:v,cursor:g,shared:y,trigger:b,defaultIndex:E,portal:S,axisId:P}=t,L=Zn(),q=typeof E=="number"?String(E):E;z.useEffect(()=>{L(mI({shared:y,trigger:b,axisId:P,active:r,defaultIndex:q}))},[L,y,b,P,r,q]);var C=F3(),R=M3(),k=uI(y),{activeIndex:G,isActive:_}=qt(M=>pM(M,k,b,q)),j=qt(M=>dM(M,k,b,q)),H=qt(M=>XS(M,k,b,q)),X=qt(M=>hM(M,k,b,q)),ce=j,pe=wM(),ye=r??_,[me,be]=Lk([ce,ye]),Ue=k==="axis"?H:void 0;DM(k,b,X,Ue,G,ye);var Fe=S??pe;if(Fe==null)return null;var A=ce??r5;ye||(A=r5),o&&A.length&&(A=Zj(ce.filter(M=>M.value!=null&&(M.hide!==!0||t.includeHidden)),u,BM));var F=A.length>0,O=z.createElement(jO,{allowEscapeViewBox:n,animationDuration:i,animationEasing:a,isAnimationActive:l,active:ye,coordinate:X,hasPayload:F,offset:c,position:h,reverseDirection:p,useTranslate3d:d,viewBox:C,wrapperStyle:v,lastBoundingBox:me,innerRef:be,hasPortalFromProps:!!S},UM(s,t5(t5({},t),{},{payload:A,label:Ue,active:ye,coordinate:X,accessibilityLayer:R})));return z.createElement(z.Fragment,null,U_.createPortal(O,Fe),ye&&z.createElement(bM,{cursor:g,tooltipEventType:k,coordinate:X,payload:ce,index:G}))}var rA={},nA={},iA={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r,n,{signal:i,edges:a}={}){let s,o=null;const l=a!=null&&a.includes("leading"),c=a==null||a.includes("trailing"),u=()=>{o!==null&&(r.apply(s,o),s=void 0,o=null)},h=()=>{c&&u(),g()};let p=null;const d=()=>{p!=null&&clearTimeout(p),p=setTimeout(()=>{p=null,h()},n)},v=()=>{p!==null&&(clearTimeout(p),p=null)},g=()=>{v(),s=void 0,o=null},y=()=>{u()},b=function(...E){if(i!=null&&i.aborted)return;s=this,o=E;const S=p==null;d(),l&&S&&u()};return b.schedule=d,b.cancel=g,b.flush=y,i==null||i.addEventListener("abort",g,{once:!0}),b}e.debounce=t})(iA);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=iA;function r(n,i=0,a={}){typeof a!="object"&&(a={});const{leading:s=!1,trailing:o=!0,maxWait:l}=a,c=Array(2);s&&(c[0]="leading"),o&&(c[1]="trailing");let u,h=null;const p=t.debounce(function(...g){u=n.apply(this,g),h=null},i,{edges:c}),d=function(...g){return l!=null&&(h===null&&(h=Date.now()),Date.now()-h>=l)?(u=n.apply(this,g),h=Date.now(),p.cancel(),p.schedule(),u):(p.apply(this,g),u)},v=()=>(p.flush(),u);return d.cancel=p.cancel,d.flush=v,d}e.debounce=r})(nA);(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=nA;function r(n,i=0,a={}){const{leading:s=!0,trailing:o=!0}=a;return t.debounce(n,i,{leading:s,maxWait:i,trailing:o})}e.throttle=r})(rA);var WM=rA.throttle;const qM=ko(WM);var D1=function(t,r){for(var n=arguments.length,i=new Array(n>2?n-2:0),a=2;a<n;a++)i[a-2]=arguments[a]};function n5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function I1(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?n5(Object(r),!0).forEach(function(n){HM(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):n5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function HM(e,t,r){return(t=GM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function GM(e){var t=VM(e,"string");return typeof t=="symbol"?t:t+""}function VM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var KM=z.forwardRef((e,t)=>{var{aspect:r,initialDimension:n={width:-1,height:-1},width:i="100%",height:a="100%",minWidth:s=0,minHeight:o,maxHeight:l,children:c,debounce:u=0,id:h,className:p,onResize:d,style:v={}}=e,g=z.useRef(null),y=z.useRef();y.current=d,z.useImperativeHandle(t,()=>g.current);var[b,E]=z.useState({containerWidth:n.width,containerHeight:n.height}),S=z.useCallback((L,q)=>{E(C=>{var R=Math.round(L),k=Math.round(q);return C.containerWidth===R&&C.containerHeight===k?C:{containerWidth:R,containerHeight:k}})},[]);z.useEffect(()=>{var L=k=>{var G,{width:_,height:j}=k[0].contentRect;S(_,j),(G=y.current)===null||G===void 0||G.call(y,_,j)};u>0&&(L=qM(L,u,{trailing:!0,leading:!1}));var q=new ResizeObserver(L),{width:C,height:R}=g.current.getBoundingClientRect();return S(C,R),q.observe(g.current),()=>{q.disconnect()}},[S,u]);var P=z.useMemo(()=>{var{containerWidth:L,containerHeight:q}=b;if(L<0||q<0)return null;D1(Zu(i)||Zu(a),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,i,a),D1(!r||r>0,"The aspect(%s) must be greater than zero.",r);var C=Zu(i)?L:i,R=Zu(a)?q:a;return r&&r>0&&(C?R=C/r:R&&(C=R*r),l&&R>l&&(R=l)),D1(C>0||R>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,C,R,i,a,s,o,r),z.Children.map(c,k=>z.cloneElement(k,{width:C,height:R,style:I1({width:C,height:R},k.props.style)}))},[r,c,a,l,o,s,b,i]);return z.createElement("div",{id:h?"".concat(h):void 0,className:An("recharts-responsive-container",p),style:I1(I1({},v),{},{width:i,height:a,minWidth:s,minHeight:o,maxHeight:l}),ref:g},z.createElement("div",{style:{width:0,height:0,overflow:"visible"}},P))}),bp=e=>null;bp.displayName="Cell";function YM(e,t,r){return(t=XM(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function XM(e){var t=ZM(e,"string");return typeof t=="symbol"?t:t+""}function ZM(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}class JM{constructor(t){YM(this,"cache",new Map),this.maxSize=t}get(t){var r=this.cache.get(t);return r!==void 0&&(this.cache.delete(t),this.cache.set(t,r)),r}set(t,r){if(this.cache.has(t))this.cache.delete(t);else if(this.cache.size>=this.maxSize){var n=this.cache.keys().next().value;this.cache.delete(n)}this.cache.set(t,r)}clear(){this.cache.clear()}size(){return this.cache.size}}function i5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function QM(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?i5(Object(r),!0).forEach(function(n){e9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function e9(e,t,r){return(t=t9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function t9(e){var t=r9(e,"string");return typeof t=="symbol"?t:t+""}function r9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var n9={cacheSize:2e3,enableCache:!0},aA=QM({},n9),a5=new JM(aA.cacheSize),i9={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},s5="recharts_measurement_span";function a9(e,t){var r=t.fontSize||"",n=t.fontFamily||"",i=t.fontWeight||"",a=t.fontStyle||"",s=t.letterSpacing||"",o=t.textTransform||"";return"".concat(e,"|").concat(r,"|").concat(n,"|").concat(i,"|").concat(a,"|").concat(s,"|").concat(o)}var o5=(e,t)=>{try{var r=document.getElementById(s5);r||(r=document.createElement("span"),r.setAttribute("id",s5),r.setAttribute("aria-hidden","true"),document.body.appendChild(r)),Object.assign(r.style,i9,t),r.textContent="".concat(e);var n=r.getBoundingClientRect();return{width:n.width,height:n.height}}catch{return{width:0,height:0}}},l5=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||ip.isSsr)return{width:0,height:0};if(!aA.enableCache)return o5(t,r);var n=a9(t,r),i=a5.get(n);if(i)return i;var a=o5(t,r);return a5.set(n,a),a},c5=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,u5=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,s9=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,o9=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,sA={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},l9=Object.keys(sA),hc="NaN";function c9(e,t){return e*sA[t]}class di{static parse(t){var r,[,n,i]=(r=o9.exec(t))!==null&&r!==void 0?r:[];return new di(parseFloat(n),i??"")}constructor(t,r){this.num=t,this.unit=r,this.num=t,this.unit=r,Ca(t)&&(this.unit=""),r!==""&&!s9.test(r)&&(this.num=NaN,this.unit=""),l9.includes(r)&&(this.num=c9(t,r),this.unit="px")}add(t){return this.unit!==t.unit?new di(NaN,""):new di(this.num+t.num,this.unit)}subtract(t){return this.unit!==t.unit?new di(NaN,""):new di(this.num-t.num,this.unit)}multiply(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new di(NaN,""):new di(this.num*t.num,this.unit||t.unit)}divide(t){return this.unit!==""&&t.unit!==""&&this.unit!==t.unit?new di(NaN,""):new di(this.num/t.num,this.unit||t.unit)}toString(){return"".concat(this.num).concat(this.unit)}isNaN(){return Ca(this.num)}}function oA(e){if(e.includes(hc))return hc;for(var t=e;t.includes("*")||t.includes("/");){var r,[,n,i,a]=(r=c5.exec(t))!==null&&r!==void 0?r:[],s=di.parse(n??""),o=di.parse(a??""),l=i==="*"?s.multiply(o):s.divide(o);if(l.isNaN())return hc;t=t.replace(c5,l.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var c,[,u,h,p]=(c=u5.exec(t))!==null&&c!==void 0?c:[],d=di.parse(u??""),v=di.parse(p??""),g=h==="+"?d.add(v):d.subtract(v);if(g.isNaN())return hc;t=t.replace(u5,g.toString())}return t}var f5=/\(([^()]*)\)/;function u9(e){for(var t=e,r;(r=f5.exec(t))!=null;){var[,n]=r;t=t.replace(f5,oA(n))}return t}function f9(e){var t=e.replace(/\s+/g,"");return t=u9(t),t=oA(t),t}function h9(e){try{return f9(e)}catch{return hc}}function M1(e){var t=h9(e.slice(5,-1));return t===hc?"":t}var d9=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],p9=["dx","dy","angle","className","breakAll"];function hg(){return hg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},hg.apply(null,arguments)}function h5(e,t){if(e==null)return{};var r,n,i=m9(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function m9(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var lA=/[ \f\n\r\t\v\u2028\u2029]+/,cA=e=>{var{children:t,breakAll:r,style:n}=e;try{var i=[];yl(t)||(r?i=t.toString().split(""):i=t.toString().split(lA));var a=i.map(o=>({word:o,width:l5(o,n).width})),s=r?0:l5("¬†",n).width;return{wordsWithComputedWidth:a,spaceWidth:s}}catch{return null}},g9=(e,t,r,n,i)=>{var{maxLines:a,children:s,style:o,breakAll:l}=e,c=Vt(a),u=s,h=function(){var _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return _.reduce((j,H)=>{var{word:X,width:ce}=H,pe=j[j.length-1];if(pe&&(n==null||i||pe.width+ce+r<Number(n)))pe.words.push(X),pe.width+=ce+r;else{var ye={words:[X],width:ce};j.push(ye)}return j},[])},p=h(t),d=G=>G.reduce((_,j)=>_.width>j.width?_:j);if(!c||i)return p;var v=p.length>a||d(p).width>Number(n);if(!v)return p;for(var g="‚Ä¶",y=G=>{var _=u.slice(0,G),j=cA({breakAll:l,style:o,children:_+g}).wordsWithComputedWidth,H=h(j),X=H.length>a||d(H).width>Number(n);return[X,H]},b=0,E=u.length-1,S=0,P;b<=E&&S<=u.length-1;){var L=Math.floor((b+E)/2),q=L-1,[C,R]=y(q),[k]=y(L);if(!C&&!k&&(b=L+1),C&&k&&(E=L-1),!C&&k){P=R;break}S++}return P||p},d5=e=>{var t=yl(e)?[]:e.toString().split(lA);return[{words:t}]},v9=e=>{var{width:t,scaleToFit:r,children:n,style:i,breakAll:a,maxLines:s}=e;if((t||r)&&!ip.isSsr){var o,l,c=cA({breakAll:a,children:n,style:i});if(c){var{wordsWithComputedWidth:u,spaceWidth:h}=c;o=u,l=h}else return d5(n);return g9({breakAll:a,children:n,maxLines:s,style:i},o,l,t,r)}return d5(n)},p5="#808080",uA=z.forwardRef((e,t)=>{var{x:r=0,y:n=0,lineHeight:i="1em",capHeight:a="0.71em",scaleToFit:s=!1,textAnchor:o="start",verticalAnchor:l="end",fill:c=p5}=e,u=h5(e,d9),h=z.useMemo(()=>v9({breakAll:u.breakAll,children:u.children,maxLines:u.maxLines,scaleToFit:s,style:u.style,width:u.width}),[u.breakAll,u.children,u.maxLines,s,u.style,u.width]),{dx:p,dy:d,angle:v,className:g,breakAll:y}=u,b=h5(u,p9);if(!Os(r)||!Os(n))return null;var E=r+(Vt(p)?p:0),S=n+(Vt(d)?d:0),P;switch(l){case"start":P=M1("calc(".concat(a,")"));break;case"middle":P=M1("calc(".concat((h.length-1)/2," * -").concat(i," + (").concat(a," / 2))"));break;default:P=M1("calc(".concat(h.length-1," * -").concat(i,")"));break}var L=[];if(s){var q=h[0].width,{width:C}=u;L.push("scale(".concat(Vt(C)?C/q:1,")"))}return v&&L.push("rotate(".concat(v,", ").concat(E,", ").concat(S,")")),L.length&&(b.transform=L.join(" ")),z.createElement("text",hg({},$i(b,!0),{ref:t,x:E,y:S,className:An("recharts-text",g),textAnchor:o,fill:c.includes("url")?p5:c}),h.map((R,k)=>{var G=R.words.join(y?"":" ");return z.createElement("tspan",{x:E,dy:k===0?P:i,key:"".concat(G,"-").concat(k)},G)}))});uA.displayName="Text";var fA=e=>e.graphicalItems.polarItems,x9=ke([Lr,Jf],Y2),bv=ke([fA,Jr,x9],X2),y9=ke([bv],Z2),wv=ke([y9,R2],J2),b9=ke([wv,Jr,bv],ev),w9=ke([wv,Jr,bv],(e,t,r)=>r.length>0?e.flatMap(n=>r.flatMap(i=>{var a,s=an(n,(a=t.dataKey)!==null&&a!==void 0?a:i.dataKey);return{value:s,errorDomain:[]}})).filter(Boolean):(t==null?void 0:t.dataKey)!=null?e.map(n=>({value:an(n,t.dataKey),errorDomain:[]})):e.map(n=>({value:n,errorDomain:[]}))),m5=()=>{},_9=ke([Jr,bS,m5,w9,m5,Ar,Lr],rv),hA=ke([Jr,Ar,wv,b9,Zf,Lr,_9],nv),N9=ke([hA,Jr,tu],sv);ke([Jr,hA,N9,Lr],lv);var S9={radiusAxis:{},angleAxis:{}},A9=Gi({name:"polarAxis",initialState:S9,reducers:{addRadiusAxis(e,t){e.radiusAxis[t.payload.id]=t.payload},removeRadiusAxis(e,t){delete e.radiusAxis[t.payload.id]},addAngleAxis(e,t){e.angleAxis[t.payload.id]=t.payload},removeAngleAxis(e,t){delete e.angleAxis[t.payload.id]}}}),E9=A9.reducer;function g5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function v5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?g5(Object(r),!0).forEach(function(n){T9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function T9(e,t,r){return(t=P9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function P9(e){var t=j9(e,"string");return typeof t=="symbol"?t:t+""}function j9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var k9=(e,t)=>t,_v=ke([fA,k9],(e,t)=>e.filter(r=>r.type==="pie").find(r=>r.id===t)),C9=[],Nv=(e,t,r)=>(r==null?void 0:r.length)===0?C9:r,dA=ke([R2,_v,Nv],(e,t,r)=>{var{chartData:n}=e;if(t!=null){var i;if((t==null?void 0:t.data)!=null&&t.data.length>0?i=t.data:i=n,(!i||!i.length)&&r!=null&&(i=r.map(a=>v5(v5({},t.presentationProps),a.props))),i!=null)return i}}),O9=ke([dA,_v,Nv],(e,t,r)=>{if(!(e==null||t==null))return e.map((n,i)=>{var a,s=an(n,t.nameKey,t.name),o;return r!=null&&(a=r[i])!==null&&a!==void 0&&(a=a.props)!==null&&a!==void 0&&a.fill?o=r[i].props.fill:typeof n=="object"&&n!=null&&"fill"in n?o=n.fill:o=t.fill,{value:k3(s,t.dataKey),color:o,payload:n,type:t.legendType}})}),L9=ke([dA,_v,Nv,Jn],(e,t,r,n)=>{if(!(t==null||e==null))return kR({offset:n,pieSettings:t,displayedData:e,cells:r})}),pA={};(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(r){var i;if(typeof r!="object"||r==null)return!1;if(Object.getPrototypeOf(r)===null)return!0;if(Object.prototype.toString.call(r)!=="[object Object]"){const a=r[Symbol.toStringTag];return a==null||!((i=Object.getOwnPropertyDescriptor(r,Symbol.toStringTag))!=null&&i.writable)?!1:r.toString()===`[object ${a}]`}let n=r;for(;Object.getPrototypeOf(n)!==null;)n=Object.getPrototypeOf(n);return Object.getPrototypeOf(r)===n}e.isPlainObject=t})(pA);var F9=pA.isPlainObject;const D9=ko(F9);function id(){return id=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},id.apply(null,arguments)}var x5=(e,t,r,n,i)=>{var a=r-n,s;return s="M ".concat(e,",").concat(t),s+="L ".concat(e+r,",").concat(t),s+="L ".concat(e+r-a/2,",").concat(t+i),s+="L ".concat(e+r-a/2-n,",").concat(t+i),s+="L ".concat(e,",").concat(t," Z"),s},I9={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},M9=e=>{var t=Co(e,I9),r=z.useRef(),[n,i]=z.useState(-1);z.useEffect(()=>{if(r.current&&r.current.getTotalLength)try{var y=r.current.getTotalLength();y&&i(y)}catch{}},[]);var{x:a,y:s,upperWidth:o,lowerWidth:l,height:c,className:u}=t,{animationEasing:h,animationDuration:p,animationBegin:d,isUpdateAnimationActive:v}=t;if(a!==+a||s!==+s||o!==+o||l!==+l||c!==+c||o===0&&l===0||c===0)return null;var g=An("recharts-trapezoid",u);return v?z.createElement(Wh,{canBegin:n>0,from:{upperWidth:0,lowerWidth:0,height:c,x:a,y:s},to:{upperWidth:o,lowerWidth:l,height:c,x:a,y:s},duration:p,animationEasing:h,isActive:v},y=>{var{upperWidth:b,lowerWidth:E,height:S,x:P,y:L}=y;return z.createElement(Wh,{canBegin:n>0,from:"0px ".concat(n===-1?1:n,"px"),to:"".concat(n,"px 0px"),attributeName:"strokeDasharray",begin:d,duration:p,easing:h},z.createElement("path",id({},$i(t,!0),{className:g,d:x5(P,L,b,E,S),ref:r})))}):z.createElement("g",null,z.createElement("path",id({},$i(t,!0),{className:g,d:x5(a,s,o,l,c)})))},R9=["option","shapeType","propTransformer","activeClassName","isActive"];function B9(e,t){if(e==null)return{};var r,n,i=U9(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function U9(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function y5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function ad(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?y5(Object(r),!0).forEach(function(n){$9(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):y5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function $9(e,t,r){return(t=z9(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function z9(e){var t=W9(e,"string");return typeof t=="symbol"?t:t+""}function W9(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function q9(e,t){return ad(ad({},t),e)}function H9(e,t){return e==="symbols"}function b5(e){var{shapeType:t,elementProps:r}=e;switch(t){case"rectangle":return z.createElement(Y3,r);case"trapezoid":return z.createElement(M9,r);case"sector":return z.createElement(J3,r);case"symbols":if(H9(t))return z.createElement(C4,r);break;default:return null}}function G9(e){return z.isValidElement(e)?e.props:e}function V9(e){var{option:t,shapeType:r,propTransformer:n=q9,activeClassName:i="recharts-active-shape",isActive:a}=e,s=B9(e,R9),o;if(z.isValidElement(t))o=z.cloneElement(t,ad(ad({},s),G9(t)));else if(typeof t=="function")o=t(s);else if(D9(t)&&typeof t!="boolean"){var l=n(t,s);o=z.createElement(b5,{shapeType:r,elementProps:l})}else{var c=s;o=z.createElement(b5,{shapeType:r,elementProps:c})}return a?z.createElement(Fc,{className:i},o):o}var K9=(e,t)=>{var r=Zn();return(n,i)=>a=>{e==null||e(n,i,a),r(LS({activeIndex:String(i),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}},Y9=e=>{var t=Zn();return(r,n)=>i=>{e==null||e(r,n,i),t(gI())}},X9=(e,t)=>{var r=Zn();return(n,i)=>a=>{e==null||e(n,i,a),r(vI({activeIndex:String(i),activeDataKey:t,activeCoordinate:n.tooltipPosition}))}};function Z9(e){var{fn:t,args:r}=e,n=Zn(),i=Vc();return z.useEffect(()=>{if(!i){var a=t(r);return n(dI(a)),()=>{n(pI(a))}}},[t,r,n,i]),null}var J9=()=>{};function Q9(e){var{legendPayload:t}=e,r=Zn(),n=qt(Ar);return z.useEffect(()=>n!=="centric"&&n!=="radial"?J9:(r(mO(t)),()=>{r(gO(t))}),[r,n,t]),null}function eR(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"animation-",r=z.useRef(Eh(t)),n=z.useRef(e);return n.current!==e&&(r.current=Eh(t),n.current=e),r.current}var R1,tR=()=>{var[e]=z.useState(()=>Eh("uid-"));return e},rR=(R1=i8.useId)!==null&&R1!==void 0?R1:tR;function nR(e,t){var r=rR();return t||(e?"".concat(e,"-").concat(r):r)}var iR=z.createContext(void 0),aR=e=>{var{id:t,type:r,children:n}=e,i=nR("recharts-".concat(r),t);return z.createElement(iR.Provider,{value:i},n(i))},sR={cartesianItems:[],polarItems:[]},mA=Gi({name:"graphicalItems",initialState:sR,reducers:{addCartesianGraphicalItem(e,t){e.cartesianItems.push(t.payload)},replaceCartesianGraphicalItem(e,t){var{prev:r,next:n}=t.payload,i=Ts(e).cartesianItems.indexOf(r);i>-1&&(e.cartesianItems[i]=n)},removeCartesianGraphicalItem(e,t){var r=Ts(e).cartesianItems.indexOf(t.payload);r>-1&&e.cartesianItems.splice(r,1)},addPolarGraphicalItem(e,t){e.polarItems.push(t.payload)},removePolarGraphicalItem(e,t){var r=Ts(e).polarItems.indexOf(t.payload);r>-1&&e.polarItems.splice(r,1)}}}),{addCartesianGraphicalItem:pJ,replaceCartesianGraphicalItem:mJ,removeCartesianGraphicalItem:gJ,addPolarGraphicalItem:oR,removePolarGraphicalItem:lR}=mA.actions,cR=mA.reducer;function uR(e){var t=Zn();return z.useEffect(()=>(t(oR(e)),()=>{t(lR(e))}),[t,e]),null}function fR(){}var hR={begin:0,duration:1e3,easing:"ease",isActive:!0,canBegin:!0,onAnimationEnd:()=>{},onAnimationStart:()=>{}},w5={t:0},B1={t:1};function dR(e){var t=Co(e,hR),{isActive:r,canBegin:n,duration:i,easing:a,begin:s,onAnimationEnd:o,onAnimationStart:l,children:c}=t,u=K3("JavascriptAnimate",t.animationManager),[h,p]=z.useState(r?w5:B1),d=z.useRef(null);return z.useEffect(()=>{r||p(B1)},[r]),z.useEffect(()=>{if(!r||!n)return fR;var v=V3(w5,B1,H3(a),i,p,u.getTimeoutController()),g=()=>{d.current=v()};return u.start([l,s,g,i,o]),()=>{u.stop(),d.current&&d.current(),o()}},[r,n,i,a,s,l,o,u]),c(h.t)}var pR=["onMouseEnter","onClick","onMouseLeave"],mR=["id"],gR=["id"];function Sv(e,t){if(e==null)return{};var r,n,i=vR(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function vR(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function _5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ur(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?_5(Object(r),!0).forEach(function(n){xR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function xR(e,t,r){return(t=yR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yR(e){var t=bR(e,"string");return typeof t=="symbol"?t:t+""}function bR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ms(){return Ms=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Ms.apply(null,arguments)}function wR(e){var t=z.useMemo(()=>h4(e.children,bp),[e.children]),r=qt(n=>O9(n,e.id,t));return r==null?null:z.createElement(Q9,{legendPayload:r})}function _R(e){var{dataKey:t,nameKey:r,sectors:n,stroke:i,strokeWidth:a,fill:s,name:o,hide:l,tooltipType:c}=e;return{dataDefinedOnItem:n==null?void 0:n.map(u=>u.tooltipPayload),positions:n==null?void 0:n.map(u=>u.tooltipPosition),settings:{stroke:i,strokeWidth:a,fill:s,dataKey:t,nameKey:r,name:k3(o,t),hide:l,type:c,color:s,unit:""}}}var NR=(e,t)=>e>t?"start":e<t?"end":"middle",SR=(e,t,r)=>typeof t=="function"?t(e):es(t,r,r*.8),AR=(e,t,r)=>{var{top:n,left:i,width:a,height:s}=t,o=P3(a,s),l=i+es(e.cx,a,a/2),c=n+es(e.cy,s,s/2),u=es(e.innerRadius,o,0),h=SR(r,e.outerRadius,o),p=e.maxRadius||Math.sqrt(a*a+s*s)/2;return{cx:l,cy:c,innerRadius:u,outerRadius:h,maxRadius:p}},ER=(e,t)=>{var r=Mi(t-e),n=Math.min(Math.abs(t-e),360);return r*n},TR=(e,t)=>{if(z.isValidElement(e))return z.cloneElement(e,t);if(typeof e=="function")return e(t);var r=An("recharts-pie-label-line",typeof e!="boolean"?e.className:"");return z.createElement(R3,Ms({},t,{type:"linear",className:r}))},PR=(e,t,r)=>{if(z.isValidElement(e))return z.cloneElement(e,t);var n=r;if(typeof e=="function"&&(n=e(t),z.isValidElement(n)))return n;var i=An("recharts-pie-label-text",typeof e!="boolean"&&typeof e!="function"?e.className:"");return z.createElement(uA,Ms({},t,{alignmentBaseline:"middle",className:i}),n)};function jR(e){var{sectors:t,props:r,showLabels:n}=e,{label:i,labelLine:a,dataKey:s}=r;if(!n||!i||!t)return null;var o=Ud(r),l=$i(i,!1),c=$i(a,!1),u=typeof i=="object"&&"offsetRadius"in i&&i.offsetRadius||20,h=t.map((p,d)=>{var v=(p.startAngle+p.endAngle)/2,g=Kn(p.cx,p.cy,p.outerRadius+u,v),y=Ur(Ur(Ur(Ur({},o),p),{},{stroke:"none"},l),{},{index:d,textAnchor:NR(g.x,p.cx)},g),b=Ur(Ur(Ur(Ur({},o),p),{},{fill:"none",stroke:p.fill},c),{},{index:d,points:[Kn(p.cx,p.cy,p.outerRadius,v),g],key:"line"});return z.createElement(Fc,{key:"label-".concat(p.startAngle,"-").concat(p.endAngle,"-").concat(p.midAngle,"-").concat(d)},a&&TR(a,b),PR(i,y,an(p,s)))});return z.createElement(Fc,{className:"recharts-pie-labels"},h)}function gA(e){var{sectors:t,activeShape:r,inactiveShape:n,allOtherPieProps:i,showLabels:a}=e,s=qt(Tf),{onMouseEnter:o,onClick:l,onMouseLeave:c}=i,u=Sv(i,pR),h=K9(o,i.dataKey),p=Y9(c),d=X9(l,i.dataKey);return t==null?null:z.createElement(z.Fragment,null,t.map((v,g)=>{if((v==null?void 0:v.startAngle)===0&&(v==null?void 0:v.endAngle)===0&&t.length!==1)return null;var y=r&&String(g)===s,b=s?n:null,E=y?r:b,S=Ur(Ur({},v),{},{stroke:v.stroke,tabIndex:-1,[O3]:g,[L3]:i.dataKey});return z.createElement(Fc,Ms({tabIndex:-1,className:"recharts-pie-sector"},XP(u,v,g),{onMouseEnter:h(v,g),onMouseLeave:p(v,g),onClick:d(v,g),key:"sector-".concat(v==null?void 0:v.startAngle,"-").concat(v==null?void 0:v.endAngle,"-").concat(v.midAngle,"-").concat(g)}),z.createElement(V9,Ms({option:E,isActive:y,shapeType:"sector"},S)))}),z.createElement(jR,{sectors:t,props:i,showLabels:a}))}function kR(e){var t,{pieSettings:r,displayedData:n,cells:i,offset:a}=e,{cornerRadius:s,startAngle:o,endAngle:l,dataKey:c,nameKey:u,tooltipType:h}=r,p=Math.abs(r.minAngle),d=ER(o,l),v=Math.abs(d),g=n.length<=1?0:(t=r.paddingAngle)!==null&&t!==void 0?t:0,y=n.filter(q=>an(q,c,0)!==0).length,b=(v>=360?y:y-1)*g,E=v-y*p-b,S=n.reduce((q,C)=>{var R=an(C,c,0);return q+(Vt(R)?R:0)},0),P;if(S>0){var L;P=n.map((q,C)=>{var R=an(q,c,0),k=an(q,u,C),G=AR(r,a,q),_=(Vt(R)?R:0)/S,j,H=Ur(Ur({},q),i&&i[C]&&i[C].props);C?j=L.endAngle+Mi(d)*g*(R!==0?1:0):j=o;var X=j+Mi(d)*((R!==0?p:0)+_*E),ce=(j+X)/2,pe=(G.innerRadius+G.outerRadius)/2,ye=[{name:k,value:R,payload:H,dataKey:c,type:h}],me=Kn(G.cx,G.cy,pe,ce);return L=Ur(Ur(Ur(Ur({},r.presentationProps),{},{percent:_,cornerRadius:s,name:k,tooltipPayload:ye,midAngle:ce,middleRadius:pe,tooltipPosition:me},H),G),{},{value:an(q,c),startAngle:j,endAngle:X,payload:H,paddingAngle:Mi(d)*g}),L})}return P}function CR(e){var{props:t,previousSectorsRef:r}=e,{sectors:n,isAnimationActive:i,animationBegin:a,animationDuration:s,animationEasing:o,activeShape:l,inactiveShape:c,onAnimationStart:u,onAnimationEnd:h}=t,p=eR(t,"recharts-pie-"),d=r.current,[v,g]=z.useState(!0),y=z.useCallback(()=>{typeof h=="function"&&h(),g(!1)},[h]),b=z.useCallback(()=>{typeof u=="function"&&u(),g(!0)},[u]);return z.createElement(dR,{begin:a,duration:s,isActive:i,easing:o,onAnimationStart:b,onAnimationEnd:y,key:p},E=>{var S=[],P=n&&n[0],L=P.startAngle;return n.forEach((q,C)=>{var R=d&&d[C],k=C>0?Lc(q,"paddingAngle",0):0;if(R){var G=ly(R.endAngle-R.startAngle,q.endAngle-q.startAngle),_=Ur(Ur({},q),{},{startAngle:L+k,endAngle:L+G(E)+k});S.push(_),L=_.endAngle}else{var{endAngle:j,startAngle:H}=q,X=ly(0,j-H),ce=X(E),pe=Ur(Ur({},q),{},{startAngle:L+k,endAngle:L+ce+k});S.push(pe),L=pe.endAngle}}),r.current=S,z.createElement(Fc,null,z.createElement(gA,{sectors:S,activeShape:l,inactiveShape:c,allOtherPieProps:t,showLabels:!v}))})}function OR(e){var{sectors:t,isAnimationActive:r,activeShape:n,inactiveShape:i}=e,a=z.useRef(null),s=a.current;return r&&t&&t.length&&(!s||s!==t)?z.createElement(CR,{props:e,previousSectorsRef:a}):z.createElement(gA,{sectors:t,activeShape:n,inactiveShape:i,allOtherPieProps:e,showLabels:!0})}function LR(e){var{hide:t,className:r,rootTabIndex:n}=e,i=An("recharts-pie",r);return t?null:z.createElement(Fc,{tabIndex:n,className:i},z.createElement(OR,e))}var FR={animationBegin:400,animationDuration:1500,animationEasing:"ease",cx:"50%",cy:"50%",dataKey:"value",endAngle:360,fill:"#808080",hide:!1,innerRadius:0,isAnimationActive:!ip.isSsr,labelLine:!0,legendType:"rect",minAngle:0,nameKey:"name",outerRadius:"80%",paddingAngle:0,rootTabIndex:0,startAngle:0,stroke:"#fff"};function DR(e){var{id:t}=e,r=Sv(e,mR),n=z.useMemo(()=>h4(e.children,bp),[e.children]),i=qt(a=>L9(a,t,n));return z.createElement(z.Fragment,null,z.createElement(Z9,{fn:_R,args:Ur(Ur({},e),{},{sectors:i})}),z.createElement(LR,Ms({},r,{sectors:i})))}function vA(e){var t=Co(e,FR),{id:r}=t,n=Sv(t,gR),i=Ud(n);return z.createElement(aR,{id:r,type:"pie"},a=>z.createElement(z.Fragment,null,z.createElement(uR,{type:"pie",id:a,data:n.data,dataKey:n.dataKey,hide:n.hide,angleAxisId:0,radiusAxisId:0,name:n.name,nameKey:n.nameKey,tooltipType:n.tooltipType,legendType:n.legendType,fill:n.fill,cx:n.cx,cy:n.cy,startAngle:n.startAngle,endAngle:n.endAngle,paddingAngle:n.paddingAngle,minAngle:n.minAngle,innerRadius:n.innerRadius,outerRadius:n.outerRadius,cornerRadius:n.cornerRadius,presentationProps:i}),z.createElement(wR,Ms({},n,{id:a})),z.createElement(DR,Ms({},n,{id:a})),n.children))}vA.displayName="Pie";var IR=ke([Jn],e=>{if(e)return{top:e.top,bottom:e.bottom,left:e.left,right:e.right}}),MR=ke([IR,Us,$s],(e,t,r)=>{if(!(!e||t==null||r==null))return{x:e.left,y:e.top,width:Math.max(0,t-e.left-e.right),height:Math.max(0,r-e.top-e.bottom)}}),RR=()=>qt(MR),BR={},UR=Gi({name:"errorBars",initialState:BR,reducers:{addErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]||(e[r]=[]),e[r].push(n)},removeErrorBar:(e,t)=>{var{itemId:r,errorBar:n}=t.payload;e[r]&&(e[r]=e[r].filter(i=>i.dataKey!==n.dataKey||i.direction!==n.direction))}}}),$R=UR.reducer,zR=e=>{var{chartData:t}=e,r=Zn(),n=Vc();return z.useEffect(()=>n?()=>{}:(r(Qb(t)),()=>{r(Qb(void 0))}),[t,r,n]),null},N5={x:0,y:0,width:0,height:0,padding:{top:0,right:0,bottom:0,left:0}},WR=Gi({name:"brush",initialState:N5,reducers:{setBrushSettings(e,t){return t.payload==null?N5:t.payload}}}),qR=WR.reducer,HR={dots:[],areas:[],lines:[]},GR=Gi({name:"referenceElements",initialState:HR,reducers:{addDot:(e,t)=>{e.dots.push(t.payload)},removeDot:(e,t)=>{var r=Ts(e).dots.findIndex(n=>n===t.payload);r!==-1&&e.dots.splice(r,1)},addArea:(e,t)=>{e.areas.push(t.payload)},removeArea:(e,t)=>{var r=Ts(e).areas.findIndex(n=>n===t.payload);r!==-1&&e.areas.splice(r,1)},addLine:(e,t)=>{e.lines.push(t.payload)},removeLine:(e,t)=>{var r=Ts(e).lines.findIndex(n=>n===t.payload);r!==-1&&e.lines.splice(r,1)}}}),VR=GR.reducer,KR=z.createContext(void 0),YR=e=>{var{children:t}=e,[r]=z.useState("".concat(Eh("recharts"),"-clip")),n=RR();if(n==null)return null;var{x:i,y:a,width:s,height:o}=n;return z.createElement(KR.Provider,{value:r},z.createElement("defs",null,z.createElement("clipPath",{id:r},z.createElement("rect",{x:i,y:a,height:o,width:s}))),t)};function S5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function A5(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?S5(Object(r),!0).forEach(function(n){XR(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):S5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function XR(e,t,r){return(t=ZR(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ZR(e){var t=JR(e,"string");return typeof t=="symbol"?t:t+""}function JR(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var QR={xAxis:{},yAxis:{},zAxis:{}},eB=Gi({name:"cartesianAxis",initialState:QR,reducers:{addXAxis(e,t){e.xAxis[t.payload.id]=t.payload},removeXAxis(e,t){delete e.xAxis[t.payload.id]},addYAxis(e,t){e.yAxis[t.payload.id]=t.payload},removeYAxis(e,t){delete e.yAxis[t.payload.id]},addZAxis(e,t){e.zAxis[t.payload.id]=t.payload},removeZAxis(e,t){delete e.zAxis[t.payload.id]},updateYAxisWidth(e,t){var{id:r,width:n}=t.payload;e.yAxis[r]&&(e.yAxis[r]=A5(A5({},e.yAxis[r]),{},{width:n}))}}}),tB=eB.reducer,rB={};/**
 * @license React
 * use-sync-external-store-with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var i0=z;function nB(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var iB=typeof Object.is=="function"?Object.is:nB,aB=i0.useSyncExternalStore,sB=i0.useRef,oB=i0.useEffect,lB=i0.useMemo,cB=i0.useDebugValue;rB.useSyncExternalStoreWithSelector=function(e,t,r,n,i){var a=sB(null);if(a.current===null){var s={hasValue:!1,value:null};a.current=s}else s=a.current;a=lB(function(){function l(d){if(!c){if(c=!0,u=d,d=n(d),i!==void 0&&s.hasValue){var v=s.value;if(i(v,d))return h=v}return h=d}if(v=h,iB(u,d))return v;var g=n(d);return i!==void 0&&i(v,g)?(u=d,v):(u=d,h=g)}var c=!1,u,h,p=r===void 0?null:r;return[function(){return l(t())},p===null?void 0:function(){return l(p())}]},[t,r,n,i]);var o=aB(e,a[0],a[1]);return oB(function(){s.hasValue=!0,s.value=o},[o]),cB(o),o};function uB(e){e()}function fB(){let e=null,t=null;return{clear(){e=null,t=null},notify(){uB(()=>{let r=e;for(;r;)r.callback(),r=r.next})},get(){const r=[];let n=e;for(;n;)r.push(n),n=n.next;return r},subscribe(r){let n=!0;const i=t={callback:r,next:null,prev:t};return i.prev?i.prev.next=i:e=i,function(){!n||e===null||(n=!1,i.next?i.next.prev=i.prev:t=i.prev,i.prev?i.prev.next=i.next:e=i.next)}}}}var E5={notify(){},get:()=>[]};function hB(e,t){let r,n=E5,i=0,a=!1;function s(g){u();const y=n.subscribe(g);let b=!1;return()=>{b||(b=!0,y(),h())}}function o(){n.notify()}function l(){v.onStateChange&&v.onStateChange()}function c(){return a}function u(){i++,r||(r=e.subscribe(l),n=fB())}function h(){i--,r&&i===0&&(r(),r=void 0,n.clear(),n=E5)}function p(){a||(a=!0,u())}function d(){a&&(a=!1,h())}const v={addNestedSub:s,notifyNestedSubs:o,handleChangeWrapper:l,isSubscribed:c,trySubscribe:p,tryUnsubscribe:d,getListeners:()=>n};return v}var dB=()=>typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",pB=dB(),mB=()=>typeof navigator<"u"&&navigator.product==="ReactNative",gB=mB(),vB=()=>pB||gB?z.useLayoutEffect:z.useEffect,xB=vB(),U1=Symbol.for("react-redux-context"),$1=typeof globalThis<"u"?globalThis:{};function yB(){if(!z.createContext)return{};const e=$1[U1]??($1[U1]=new Map);let t=e.get(z.createContext);return t||(t=z.createContext(null),e.set(z.createContext,t)),t}var bB=yB();function wB(e){const{children:t,context:r,serverState:n,store:i}=e,a=z.useMemo(()=>{const l=hB(i);return{store:i,subscription:l,getServerState:n?()=>n:void 0}},[i,n]),s=z.useMemo(()=>i.getState(),[i]);xB(()=>{const{subscription:l}=a;return l.onStateChange=l.notifyNestedSubs,l.trySubscribe(),s!==i.getState()&&l.notifyNestedSubs(),()=>{l.tryUnsubscribe(),l.onStateChange=void 0}},[a,s]);const o=r||bB;return z.createElement(o.Provider,{value:a},t)}var _B=wB,NB=(e,t)=>t,Av=ke([NB,Ar,yD,gn,zS,Ws,uM,Jn],mM),Ev=e=>{var t=e.currentTarget.getBoundingClientRect(),r=t.width/e.currentTarget.offsetWidth,n=t.height/e.currentTarget.offsetHeight;return{chartX:Math.round((e.clientX-t.left)/r),chartY:Math.round((e.clientY-t.top)/n)}},xA=oa("mouseClick"),yA=Gf();yA.startListening({actionCreator:xA,effect:(e,t)=>{var r=e.payload,n=Av(t.getState(),Ev(r));(n==null?void 0:n.activeIndex)!=null&&t.dispatch(xI({activeIndex:n.activeIndex,activeDataKey:void 0,activeCoordinate:n.activeCoordinate}))}});var dg=oa("mouseMove"),bA=Gf();bA.startListening({actionCreator:dg,effect:(e,t)=>{var r=e.payload,n=t.getState(),i=fv(n,n.tooltip.settings.shared),a=Av(n,Ev(r));i==="axis"&&((a==null?void 0:a.activeIndex)!=null?t.dispatch(DS({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate})):t.dispatch(FS()))}});function SB(e,t){return t instanceof HTMLElement?"HTMLElement <".concat(t.tagName,' class="').concat(t.className,'">'):t===window?"global.window":t}var T5={accessibilityLayer:!0,barCategoryGap:"10%",barGap:4,barSize:void 0,className:void 0,maxBarSize:void 0,stackOffset:"none",syncId:void 0,syncMethod:"index"},wA=Gi({name:"rootProps",initialState:T5,reducers:{updateOptions:(e,t)=>{var r;e.accessibilityLayer=t.payload.accessibilityLayer,e.barCategoryGap=t.payload.barCategoryGap,e.barGap=(r=t.payload.barGap)!==null&&r!==void 0?r:T5.barGap,e.barSize=t.payload.barSize,e.maxBarSize=t.payload.maxBarSize,e.stackOffset=t.payload.stackOffset,e.syncId=t.payload.syncId,e.syncMethod=t.payload.syncMethod,e.className=t.payload.className}}}),AB=wA.reducer,{updateOptions:EB}=wA.actions,_A=Gi({name:"polarOptions",initialState:null,reducers:{updatePolarOptions:(e,t)=>t.payload}}),{updatePolarOptions:TB}=_A.actions,PB=_A.reducer,NA=oa("keyDown"),SA=oa("focus"),Tv=Gf();Tv.startListening({actionCreator:NA,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:i}=r.tooltip,a=e.payload;if(!(a!=="ArrowRight"&&a!=="ArrowLeft"&&a!=="Enter")){var s=Number(hv(i,nu(r))),o=Ws(r);if(a==="Enter"){var l=nd(r,"axis","hover",String(i.index));t.dispatch(cg({active:!i.active,activeIndex:i.index,activeDataKey:i.dataKey,activeCoordinate:l}));return}var c=cI(r),u=c==="left-to-right"?1:-1,h=a==="ArrowRight"?1:-1,p=s+h*u;if(!(o==null||p>=o.length||p<0)){var d=nd(r,"axis","hover",String(p));t.dispatch(cg({active:!0,activeIndex:p.toString(),activeDataKey:void 0,activeCoordinate:d}))}}}}});Tv.startListening({actionCreator:SA,effect:(e,t)=>{var r=t.getState(),n=r.rootProps.accessibilityLayer!==!1;if(n){var{keyboardInteraction:i}=r.tooltip;if(!i.active&&i.index==null){var a="0",s=nd(r,"axis","hover",String(a));t.dispatch(cg({activeDataKey:void 0,active:!0,activeIndex:a,activeCoordinate:s}))}}}});var ta=oa("externalEvent"),AA=Gf();AA.startListening({actionCreator:ta,effect:(e,t)=>{if(e.payload.handler!=null){var r=t.getState(),n={activeCoordinate:tM(r),activeDataKey:QI(r),activeIndex:Tf(r),activeLabel:HS(r),activeTooltipIndex:Tf(r),isTooltipActive:rM(r)};e.payload.handler(n,e.payload.reactEvent)}}});var jB=ke([ru],e=>e.tooltipItemPayloads),kB=ke([jB,r0,(e,t,r)=>t,(e,t,r)=>r],(e,t,r,n)=>{var i=e.find(o=>o.settings.dataKey===n);if(i!=null){var{positions:a}=i;if(a!=null){var s=t(a,r);return s}}}),EA=oa("touchMove"),TA=Gf();TA.startListening({actionCreator:EA,effect:(e,t)=>{var r=e.payload,n=t.getState(),i=fv(n,n.tooltip.settings.shared);if(i==="axis"){var a=Av(n,Ev({clientX:r.touches[0].clientX,clientY:r.touches[0].clientY,currentTarget:r.currentTarget}));(a==null?void 0:a.activeIndex)!=null&&t.dispatch(DS({activeIndex:a.activeIndex,activeDataKey:void 0,activeCoordinate:a.activeCoordinate}))}else if(i==="item"){var s,o=r.touches[0],l=document.elementFromPoint(o.clientX,o.clientY);if(!l||!l.getAttribute)return;var c=l.getAttribute(O3),u=(s=l.getAttribute(L3))!==null&&s!==void 0?s:void 0,h=kB(t.getState(),c,u);t.dispatch(LS({activeDataKey:u,activeIndex:c,activeCoordinate:h}))}}});var CB=a3({brush:qR,cartesianAxis:tB,chartData:CM,errorBars:$R,graphicalItems:cR,layout:kC,legend:vO,options:EM,polarAxis:E9,polarOptions:PB,referenceElements:VR,rootProps:AB,tooltip:yI}),OB=function(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"Chart";return tC({reducer:CB,preloadedState:t,middleware:n=>n({serializableCheck:!1}).concat([yA.middleware,bA.middleware,Tv.middleware,AA.middleware,TA.middleware]),devTools:{serialize:{replacer:SB},name:"recharts-".concat(r)}})};function LB(e){var{preloadedState:t,children:r,reduxStoreName:n}=e,i=Vc(),a=z.useRef(null);if(i)return r;a.current==null&&(a.current=OB(t,n));var s=i2;return z.createElement(_B,{context:s,store:a.current},r)}function FB(e){var{layout:t,width:r,height:n,margin:i}=e,a=Zn(),s=Vc();return z.useEffect(()=>{s||(a(TC(t)),a(PC({width:r,height:n})),a(EC(i)))},[a,s,t,r,n,i]),null}function DB(e){var t=Zn();return z.useEffect(()=>{t(EB(e))},[t,e]),null}var IB=["children"];function MB(e,t){if(e==null)return{};var r,n,i=RB(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function RB(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function sd(){return sd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},sd.apply(null,arguments)}var BB={width:"100%",height:"100%"},UB=z.forwardRef((e,t)=>{var r=hO(),n=dO(),i=M3();if(!Uh(r)||!Uh(n))return null;var{children:a,otherAttributes:s,title:o,desc:l}=e,c,u;return typeof s.tabIndex=="number"?c=s.tabIndex:c=i?0:void 0,typeof s.role=="string"?u=s.role:u=i?"application":void 0,z.createElement(d4,sd({},s,{title:o,desc:l,role:u,tabIndex:c,width:r,height:n,style:BB,ref:t}),a)}),$B=e=>{var{children:t}=e,r=qt(np);if(!r)return null;var{width:n,height:i,y:a,x:s}=r;return z.createElement(d4,{width:n,height:i,x:s,y:a},t)},P5=z.forwardRef((e,t)=>{var{children:r}=e,n=MB(e,IB),i=Vc();return i?z.createElement($B,null,r):z.createElement(UB,sd({ref:t},n),r)});function zB(){var e=Zn(),[t,r]=z.useState(null),n=qt(nO);return z.useEffect(()=>{if(t!=null){var i=t.getBoundingClientRect(),a=i.width/t.offsetWidth;Oa(a)&&a!==n&&e(jC(a))}},[t,e,n]),r}function j5(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function WB(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?j5(Object(r),!0).forEach(function(n){qB(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):j5(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function qB(e,t,r){return(t=HB(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function HB(e){var t=GB(e,"string");return typeof t=="symbol"?t:t+""}function GB(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var VB=z.forwardRef((e,t)=>{var{children:r,className:n,height:i,onClick:a,onContextMenu:s,onDoubleClick:o,onMouseDown:l,onMouseEnter:c,onMouseLeave:u,onMouseMove:h,onMouseUp:p,onTouchEnd:d,onTouchMove:v,onTouchStart:g,style:y,width:b}=e,E=Zn(),[S,P]=z.useState(null),[L,q]=z.useState(null);FM();var C=zB(),R=z.useCallback(A=>{C(A),typeof t=="function"&&t(A),P(A),q(A)},[C,t,P,q]),k=z.useCallback(A=>{E(xA(A)),E(ta({handler:a,reactEvent:A}))},[E,a]),G=z.useCallback(A=>{E(dg(A)),E(ta({handler:c,reactEvent:A}))},[E,c]),_=z.useCallback(A=>{E(FS()),E(ta({handler:u,reactEvent:A}))},[E,u]),j=z.useCallback(A=>{E(dg(A)),E(ta({handler:h,reactEvent:A}))},[E,h]),H=z.useCallback(()=>{E(SA())},[E]),X=z.useCallback(A=>{E(NA(A.key))},[E]),ce=z.useCallback(A=>{E(ta({handler:s,reactEvent:A}))},[E,s]),pe=z.useCallback(A=>{E(ta({handler:o,reactEvent:A}))},[E,o]),ye=z.useCallback(A=>{E(ta({handler:l,reactEvent:A}))},[E,l]),me=z.useCallback(A=>{E(ta({handler:p,reactEvent:A}))},[E,p]),be=z.useCallback(A=>{E(ta({handler:g,reactEvent:A}))},[E,g]),Ue=z.useCallback(A=>{E(EA(A)),E(ta({handler:v,reactEvent:A}))},[E,v]),Fe=z.useCallback(A=>{E(ta({handler:d,reactEvent:A}))},[E,d]);return z.createElement(ZS.Provider,{value:S},z.createElement(aj.Provider,{value:L},z.createElement("div",{className:An("recharts-wrapper",n),style:WB({position:"relative",cursor:"default",width:b,height:i},y),onClick:k,onContextMenu:ce,onDoubleClick:pe,onFocus:H,onKeyDown:X,onMouseDown:ye,onMouseEnter:G,onMouseLeave:_,onMouseMove:j,onMouseUp:me,onTouchEnd:Fe,onTouchMove:Ue,onTouchStart:be,ref:R},r)))}),KB=["children","className","width","height","style","compact","title","desc"];function YB(e,t){if(e==null)return{};var r,n,i=XB(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function XB(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var ZB=z.forwardRef((e,t)=>{var{children:r,className:n,width:i,height:a,style:s,compact:o,title:l,desc:c}=e,u=YB(e,KB),h=Ud(u);return o?z.createElement(P5,{otherAttributes:h,title:l,desc:c},r):z.createElement(VB,{className:n,style:s,width:i,height:a,onClick:e.onClick,onMouseLeave:e.onMouseLeave,onMouseEnter:e.onMouseEnter,onMouseMove:e.onMouseMove,onMouseDown:e.onMouseDown,onMouseUp:e.onMouseUp,onContextMenu:e.onContextMenu,onDoubleClick:e.onDoubleClick,onTouchStart:e.onTouchStart,onTouchMove:e.onTouchMove,onTouchEnd:e.onTouchEnd},z.createElement(P5,{otherAttributes:h,title:l,desc:c,ref:t},z.createElement(YR,null,r)))});function JB(e){var t=Zn();return z.useEffect(()=>{t(TB(e))},[t,e]),null}var QB=["width","height","layout"];function pg(){return pg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},pg.apply(null,arguments)}function eU(e,t){if(e==null)return{};var r,n,i=tU(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function tU(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}var rU={top:5,right:5,bottom:5,left:5},nU={accessibilityLayer:!0,stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:rU,reverseStackOrder:!1,syncMethod:"index",layout:"radial"},iU=z.forwardRef(function(t,r){var n,i=Co(t.categoricalChartProps,nU),{width:a,height:s,layout:o}=i,l=eU(i,QB);if(!Uh(a)||!Uh(s))return null;var{chartName:c,defaultTooltipEventType:u,validateTooltipEventTypes:h,tooltipPayloadSearcher:p}=t,d={chartName:c,defaultTooltipEventType:u,validateTooltipEventTypes:h,tooltipPayloadSearcher:p,eventEmitter:void 0};return z.createElement(LB,{preloadedState:{options:d},reduxStoreName:(n=i.id)!==null&&n!==void 0?n:c},z.createElement(zR,{chartData:i.data}),z.createElement(FB,{width:a,height:s,layout:o,margin:i.margin}),z.createElement(DB,{accessibilityLayer:i.accessibilityLayer,barCategoryGap:i.barCategoryGap,maxBarSize:i.maxBarSize,stackOffset:i.stackOffset,barGap:i.barGap,barSize:i.barSize,syncId:i.syncId,syncMethod:i.syncMethod,className:i.className}),z.createElement(JB,{cx:i.cx,cy:i.cy,startAngle:i.startAngle,endAngle:i.endAngle,innerRadius:i.innerRadius,outerRadius:i.outerRadius}),z.createElement(ZB,pg({width:a,height:s},l,{ref:r})))}),aU=["item"],sU={layout:"centric",startAngle:0,endAngle:360,cx:"50%",cy:"50%",innerRadius:0,outerRadius:"80%"},oU=z.forwardRef((e,t)=>{var r=Co(e,sU);return z.createElement(iU,{chartName:"PieChart",defaultTooltipEventType:"item",validateTooltipEventTypes:aU,tooltipPayloadSearcher:SM,categoricalChartProps:r,ref:t})});/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var od={};od.version="0.18.5";var PA=1252,lU=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],jA=function(e){lU.indexOf(e)!=-1&&(PA=e)};function cU(){jA(1252)}var jf=function(e){jA(e)};function uU(){jf(1200),cU()}var J0=function(t){return String.fromCharCode(t)},k5=function(t){return String.fromCharCode(t)},el,go="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function kf(e){for(var t="",r=0,n=0,i=0,a=0,s=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),a=r>>2,n=e.charCodeAt(c++),s=(r&3)<<4|n>>4,i=e.charCodeAt(c++),o=(n&15)<<2|i>>6,l=i&63,isNaN(n)?o=l=64:isNaN(i)&&(l=64),t+=go.charAt(a)+go.charAt(s)+go.charAt(o)+go.charAt(l);return t}function Rs(e){var t="",r=0,n=0,i=0,a=0,s=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)a=go.indexOf(e.charAt(c++)),s=go.indexOf(e.charAt(c++)),r=a<<2|s>>4,t+=String.fromCharCode(r),o=go.indexOf(e.charAt(c++)),n=(s&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=go.indexOf(e.charAt(c++)),i=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(i));return t}var nr=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),qs=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Nl(e){return nr?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function C5(e){return nr?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Ta=function(t){return nr?qs(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function wp(e){if(typeof ArrayBuffer>"u")return Ta(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function a0(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function fU(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}var Mn=nr?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:qs(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),i=0;for(t=0,r=0;t<e.length;r+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(a){return Array.isArray(a)?a:[].slice.call(a)}))};function hU(e){for(var t=[],r=0,n=e.length+250,i=Nl(e.length+255),a=0;a<e.length;++a){var s=e.charCodeAt(a);if(s<128)i[r++]=s;else if(s<2048)i[r++]=192|s>>6&31,i[r++]=128|s&63;else if(s>=55296&&s<57344){s=(s&1023)+64;var o=e.charCodeAt(++a)&1023;i[r++]=240|s>>8&7,i[r++]=128|s>>2&63,i[r++]=128|o>>6&15|(s&3)<<4,i[r++]=128|o&63}else i[r++]=224|s>>12&15,i[r++]=128|s>>6&63,i[r++]=128|s&63;r>n&&(t.push(i.slice(0,r)),r=0,i=Nl(65535),n=65530)}return t.push(i.slice(0,r)),Mn(t)}var of=/\u0000/g,Q0=/[\u0001-\u0006]/g;function bc(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Pa(e,t){var r=""+e;return r.length>=t?r:$r("0",t-r.length)+r}function Pv(e,t){var r=""+e;return r.length>=t?r:$r(" ",t-r.length)+r}function ld(e,t){var r=""+e;return r.length>=t?r:r+$r(" ",t-r.length)}function dU(e,t){var r=""+Math.round(e);return r.length>=t?r:$r("0",t-r.length)+r}function pU(e,t){var r=""+e;return r.length>=t?r:$r("0",t-r.length)+r}var O5=Math.pow(2,32);function ec(e,t){if(e>O5||e<-O5)return dU(e,t);var r=Math.round(e);return pU(r,t)}function cd(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var L5=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],z1=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function mU(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"‰∏äÂçà/‰∏ãÂçà "hh"ÊôÇ"mm"ÂàÜ"ss"Áßí "',e}var zr={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"‰∏äÂçà/‰∏ãÂçà "hh"ÊôÇ"mm"ÂàÜ"ss"Áßí "'},F5={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},gU={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function ud(e,t,r){for(var n=e<0?-1:1,i=e*n,a=0,s=1,o=0,l=1,c=0,u=0,h=Math.floor(i);c<t&&(h=Math.floor(i),o=h*s+a,u=h*c+l,!(i-h<5e-8));)i=1/(i-h),a=s,s=o,l=c,c=u;if(u>t&&(c>t?(u=l,o=a):(u=c,o=s)),!r)return[0,n*o,u];var p=Math.floor(n*o/u);return[p,n*o-p*u,u]}function eh(e,t,r){if(e>2958465||e<0)return null;var n=e|0,i=Math.floor(86400*(e-n)),a=0,s=[],o={D:n,T:i,u:86400*(e-n)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++n,++o.D)),n===60)s=r?[1317,10,29]:[1900,2,29],a=3;else if(n===0)s=r?[1317,8,29]:[1900,1,0],a=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),s=[l.getFullYear(),l.getMonth()+1,l.getDate()],a=l.getDay(),n<60&&(a=(a+6)%7),r&&(a=NU(l,s))}return o.y=s[0],o.m=s[1],o.d=s[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=a,o}var kA=new Date(1899,11,31,0,0,0),vU=kA.getTime(),xU=new Date(1900,2,1,0,0,0);function CA(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=xU&&(r+=24*60*60*1e3),(r-(vU+(e.getTimezoneOffset()-kA.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function jv(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function yU(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function bU(e){var t=e<0?12:11,r=jv(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function wU(e){var t=jv(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function _U(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=bU(e):t===10?r=e.toFixed(10).substr(0,12):r=wU(e),jv(yU(r.toUpperCase()))}function mg(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):_U(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return Eo(14,CA(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function NU(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function SU(e,t,r,n){var i="",a=0,s=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return z1[r.m-1][1];case 5:return z1[r.m-1][0];default:return z1[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return L5[r.q][0];default:return L5[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Pa(r.S,t.length):(n>=2?s=n===3?1e3:100:s=n===1?10:1,a=Math.round(s*(r.S+r.u)),a>=60*s&&(a=0),t==="s"?a===0?"0":""+a/s:(i=Pa(a,2+n),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var u=c>0?Pa(l,c):"";return u}function vo(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var OA=/%/g;function AU(e,t,r){var n=t.replace(OA,""),i=t.length-n.length;return js(e,n,r*Math.pow(10,2*i))+$r("%",i)}function EU(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return js(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function LA(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+LA(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),r.indexOf("e")===-1){var s=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+a):r+="E+"+(s-a);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,i)+"."+r.substr(2+i),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+a)%i)+"."+u.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var FA=/# (\?+)( ?)\/( ?)(\d+)/;function TU(e,t,r){var n=parseInt(e[4],10),i=Math.round(t*n),a=Math.floor(i/n),s=i-a*n,o=n;return r+(a===0?"":""+a)+" "+(s===0?$r(" ",e[1].length+1+e[4].length):Pv(s,e[1].length)+e[2]+"/"+e[3]+Pa(o,e[4].length))}function PU(e,t,r){return r+(t===0?"":""+t)+$r(" ",e[1].length+2+e[4].length)}var DA=/^#*0*\.([0#]+)/,IA=/\).*[0#]/,MA=/\(###\) ###\\?-####/;function ni(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function D5(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function I5(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function jU(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function kU(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function ra(e,t,r){if(e.charCodeAt(0)===40&&!t.match(IA)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ra("n",n,r):"("+ra("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return EU(e,t,r);if(t.indexOf("%")!==-1)return AU(e,t,r);if(t.indexOf("E")!==-1)return LA(t,r);if(t.charCodeAt(0)===36)return"$"+ra(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,s,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+ec(l,t.length);if(t.match(/^[#?]+$/))return i=ec(r,0),i==="0"&&(i=""),i.length>t.length?i:ni(t.substr(0,t.length-i.length))+i;if(a=t.match(FA))return TU(a,l,c);if(t.match(/^#+0+$/))return c+ec(l,t.length-t.indexOf("0"));if(a=t.match(DA))return i=D5(r,a[1].length).replace(/^([^\.]+)$/,"$1."+ni(a[1])).replace(/\.$/,"."+ni(a[1])).replace(/\.(\d*)$/,function(v,g){return"."+g+$r("0",ni(a[1]).length-g.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+D5(l,a[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+vo(ec(l,0));if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ra(e,t,-r):vo(""+(Math.floor(r)+jU(r,a[1].length)))+"."+Pa(I5(r,a[1].length),a[1].length);if(a=t.match(/^#,#*,#0/))return ra(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=bc(ra(e,t.replace(/[\\-]/g,""),r)),s=0,bc(bc(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return s<i.length?i.charAt(s++):v==="0"?"0":""}));if(t.match(MA))return i=ra(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=ud(l,Math.pow(10,s)-1,!1),i=""+c,u=js("n",a[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+a[2]+"/"+a[3],u=ld(o[2],s),u.length<a[4].length&&(u=ni(a[4].substr(a[4].length-u.length))+u),i+=u,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),o=ud(l,Math.pow(10,s)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Pv(o[1],s)+a[2]+"/"+a[3]+ld(o[2],s):$r(" ",2*s+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=ec(r,0),t.length<=i.length?i:ni(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var h=t.indexOf(".")-s,p=t.length-i.length-h;return ni(t.substr(0,h)+i+t.substr(t.length-p))}if(a=t.match(/^00,000\.([#0]*0)$/))return s=I5(r,a[1].length),r<0?"-"+ra(e,t,-r):vo(kU(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Pa(0,3-v.length):"")+v})+"."+Pa(s,a[1].length);switch(t){case"###,##0.00":return ra(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var d=vo(ec(l,0));return d!=="0"?c+d:"";case"###,###.00":return ra(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return ra(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function CU(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return js(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function OU(e,t,r){var n=t.replace(OA,""),i=t.length-n.length;return js(e,n,r*Math.pow(10,2*i))+$r("%",i)}function RA(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+RA(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var a=Math.floor(Math.log(t)*Math.LOG10E)%i;if(a<0&&(a+=i),r=(t/Math.pow(10,a)).toPrecision(n+1+(i+a)%i),!r.match(/[Ee]/)){var s=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(s-r.length+a):r+="E+"+(s-a),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,u){return l+c+u.substr(0,(i+a)%i)+"."+u.substr(a)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function Va(e,t,r){if(e.charCodeAt(0)===40&&!t.match(IA)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?Va("n",n,r):"("+Va("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return CU(e,t,r);if(t.indexOf("%")!==-1)return OU(e,t,r);if(t.indexOf("E")!==-1)return RA(t,r);if(t.charCodeAt(0)===36)return"$"+Va(e,t.substr(t.charAt(1)==" "?2:1),r);var i,a,s,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Pa(l,t.length);if(t.match(/^[#?]+$/))return i=""+r,r===0&&(i=""),i.length>t.length?i:ni(t.substr(0,t.length-i.length))+i;if(a=t.match(FA))return PU(a,l,c);if(t.match(/^#+0+$/))return c+Pa(l,t.length-t.indexOf("0"));if(a=t.match(DA))return i=(""+r).replace(/^([^\.]+)$/,"$1."+ni(a[1])).replace(/\.$/,"."+ni(a[1])),i=i.replace(/\.(\d*)$/,function(v,g){return"."+g+$r("0",ni(a[1]).length-g.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),a=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,a[1].length?"0.":".");if(a=t.match(/^#{1,3},##0(\.?)$/))return c+vo(""+l);if(a=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+Va(e,t,-r):vo(""+r)+"."+$r("0",a[1].length);if(a=t.match(/^#,#*,#0/))return Va(e,t.replace(/^#,#*,/,""),r);if(a=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=bc(Va(e,t.replace(/[\\-]/g,""),r)),s=0,bc(bc(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return s<i.length?i.charAt(s++):v==="0"?"0":""}));if(t.match(MA))return i=Va(e,"##########",r),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var u="";if(a=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(a[4].length,7),o=ud(l,Math.pow(10,s)-1,!1),i=""+c,u=js("n",a[1],o[1]),u.charAt(u.length-1)==" "&&(u=u.substr(0,u.length-1)+"0"),i+=u+a[2]+"/"+a[3],u=ld(o[2],s),u.length<a[4].length&&(u=ni(a[4].substr(a[4].length-u.length))+u),i+=u,i;if(a=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return s=Math.min(Math.max(a[1].length,a[4].length),7),o=ud(l,Math.pow(10,s)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Pv(o[1],s)+a[2]+"/"+a[3]+ld(o[2],s):$r(" ",2*s+1+a[2].length+a[3].length));if(a=t.match(/^[#0?]+$/))return i=""+r,t.length<=i.length?i:ni(t.substr(0,t.length-i.length))+i;if(a=t.match(/^([#0]+)\.([#0]+)$/)){i=""+r.toFixed(Math.min(a[2].length,10)).replace(/([^0])0+$/,"$1"),s=i.indexOf(".");var h=t.indexOf(".")-s,p=t.length-i.length-h;return ni(t.substr(0,h)+i+t.substr(t.length-p))}if(a=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+Va(e,t,-r):vo(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Pa(0,3-v.length):"")+v})+"."+Pa(0,a[1].length);switch(t){case"###,###":case"##,###":case"#,###":var d=vo(""+l);return d!=="0"?c+d:"";default:if(t.match(/\.[0#?]*$/))return Va(e,t.slice(0,t.lastIndexOf(".")),r)+ni(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function js(e,t,r){return(r|0)===r?Va(e,t,r):ra(e,t,r)}function LU(e){for(var t=[],r=!1,n=0,i=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(i,n-i),i=n+1}if(t[t.length]=e.substr(i),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var BA=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function UA(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":cd(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"‰∏ä":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="‰∏äÂçà/‰∏ãÂçà")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(BA))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function FU(e,t,r,n){for(var i=[],a="",s=0,o="",l="t",c,u,h,p="H";s<e.length;)switch(o=e.charAt(s)){case"G":if(!cd(e,s))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},s+=7;break;case'"':for(a="";(h=e.charCodeAt(++s))!==34&&s<e.length;)a+=String.fromCharCode(h);i[i.length]={t:"t",v:a},++s;break;case"\\":var d=e.charAt(++s),v=d==="("||d===")"?d:"t";i[i.length]={t:v,v:d},++s;break;case"_":i[i.length]={t:"t",v:" "},s+=2;break;case"@":i[i.length]={t:"T",v:t},++s;break;case"B":case"b":if(e.charAt(s+1)==="1"||e.charAt(s+1)==="2"){if(c==null&&(c=eh(t,r,e.charAt(s+1)==="2"),c==null))return"";i[i.length]={t:"X",v:e.substr(s,2)},l=o,s+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=eh(t,r),c==null))return"";for(a=o;++s<e.length&&e.charAt(s).toLowerCase()===o;)a+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=p),i[i.length]={t:o,v:a},l=o;break;case"A":case"a":case"‰∏ä":var g={t:o,v:o};if(c==null&&(c=eh(t,r)),e.substr(s,3).toUpperCase()==="A/P"?(c!=null&&(g.v=c.H>=12?"P":"A"),g.t="T",p="h",s+=3):e.substr(s,5).toUpperCase()==="AM/PM"?(c!=null&&(g.v=c.H>=12?"PM":"AM"),g.t="T",s+=5,p="h"):e.substr(s,5).toUpperCase()==="‰∏äÂçà/‰∏ãÂçà"?(c!=null&&(g.v=c.H>=12?"‰∏ãÂçà":"‰∏äÂçà"),g.t="T",s+=5,p="h"):(g.t="t",++s),c==null&&g.t==="T")return"";i[i.length]=g,l=o;break;case"[":for(a=o;e.charAt(s++)!=="]"&&s<e.length;)a+=e.charAt(s);if(a.slice(-1)!=="]")throw'unterminated "[" block: |'+a+"|";if(a.match(BA)){if(c==null&&(c=eh(t,r),c==null))return"";i[i.length]={t:"Z",v:a.toLowerCase()},l=a.charAt(1)}else a.indexOf("$")>-1&&(a=(a.match(/\$([^-\[\]]*)/)||[])[1]||"$",UA(e)||(i[i.length]={t:"t",v:a}));break;case".":if(c!=null){for(a=o;++s<e.length&&(o=e.charAt(s))==="0";)a+=o;i[i.length]={t:"s",v:a};break}case"0":case"#":for(a=o;++s<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(s))>-1;)a+=o;i[i.length]={t:"n",v:a};break;case"?":for(a=o;e.charAt(++s)===o;)a+=o;i[i.length]={t:o,v:a},l=o;break;case"*":++s,(e.charAt(s)==" "||e.charAt(s)=="*")&&++s;break;case"(":case")":i[i.length]={t:n===1?"t":o,v:o},++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(a=o;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;)a+=e.charAt(s);i[i.length]={t:"D",v:a};break;case" ":i[i.length]={t:o,v:o},++s;break;case"$":i[i.length]={t:"t",v:"$"},++s;break;default:if(",$-+/():!^&'~{}<>=‚Ç¨acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++s;break}var y=0,b=0,E;for(s=i.length-1,l="t";s>=0;--s)switch(i[s].t){case"h":case"H":i[s].t=p,l="h",y<1&&(y=1);break;case"s":(E=i[s].v.match(/\.0+$/))&&(b=Math.max(b,E[0].length-1)),y<3&&(y=3);case"d":case"y":case"M":case"e":l=i[s].t;break;case"m":l==="s"&&(i[s].t="M",y<2&&(y=2));break;case"X":break;case"Z":y<1&&i[s].v.match(/[Hh]/)&&(y=1),y<2&&i[s].v.match(/[Mm]/)&&(y=2),y<3&&i[s].v.match(/[Ss]/)&&(y=3)}switch(y){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var S="",P;for(s=0;s<i.length;++s)switch(i[s].t){case"t":case"T":case" ":case"D":break;case"X":i[s].v="",i[s].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[s].v=SU(i[s].t.charCodeAt(0),i[s].v,c,b),i[s].t="t";break;case"n":case"?":for(P=s+1;i[P]!=null&&((o=i[P].t)==="?"||o==="D"||(o===" "||o==="t")&&i[P+1]!=null&&(i[P+1].t==="?"||i[P+1].t==="t"&&i[P+1].v==="/")||i[s].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[P].v==="/"||i[P].v===" "&&i[P+1]!=null&&i[P+1].t=="?"));)i[s].v+=i[P].v,i[P]={v:"",t:";"},++P;S+=i[s].v,s=P-1;break;case"G":i[s].t="t",i[s].v=mg(t,r);break}var L="",q,C;if(S.length>0){S.charCodeAt(0)==40?(q=t<0&&S.charCodeAt(0)===45?-t:t,C=js("n",S,q)):(q=t<0&&n>1?-t:t,C=js("n",S,q),q<0&&i[0]&&i[0].t=="t"&&(C=C.substr(1),i[0].v="-"+i[0].v)),P=C.length-1;var R=i.length;for(s=0;s<i.length;++s)if(i[s]!=null&&i[s].t!="t"&&i[s].v.indexOf(".")>-1){R=s;break}var k=i.length;if(R===i.length&&C.indexOf("E")===-1){for(s=i.length-1;s>=0;--s)i[s]==null||"n?".indexOf(i[s].t)===-1||(P>=i[s].v.length-1?(P-=i[s].v.length,i[s].v=C.substr(P+1,i[s].v.length)):P<0?i[s].v="":(i[s].v=C.substr(0,P+1),P=-1),i[s].t="t",k=s);P>=0&&k<i.length&&(i[k].v=C.substr(0,P+1)+i[k].v)}else if(R!==i.length&&C.indexOf("E")===-1){for(P=C.indexOf(".")-1,s=R;s>=0;--s)if(!(i[s]==null||"n?".indexOf(i[s].t)===-1)){for(u=i[s].v.indexOf(".")>-1&&s===R?i[s].v.indexOf(".")-1:i[s].v.length-1,L=i[s].v.substr(u+1);u>=0;--u)P>=0&&(i[s].v.charAt(u)==="0"||i[s].v.charAt(u)==="#")&&(L=C.charAt(P--)+L);i[s].v=L,i[s].t="t",k=s}for(P>=0&&k<i.length&&(i[k].v=C.substr(0,P+1)+i[k].v),P=C.indexOf(".")+1,s=R;s<i.length;++s)if(!(i[s]==null||"n?(".indexOf(i[s].t)===-1&&s!==R)){for(u=i[s].v.indexOf(".")>-1&&s===R?i[s].v.indexOf(".")+1:0,L=i[s].v.substr(0,u);u<i[s].v.length;++u)P<C.length&&(L+=C.charAt(P++));i[s].v=L,i[s].t="t",k=s}}}for(s=0;s<i.length;++s)i[s]!=null&&"n?".indexOf(i[s].t)>-1&&(q=n>1&&t<0&&s>0&&i[s-1].v==="-"?-t:t,i[s].v=js(i[s].t,i[s].v,q),i[s].t="t");var G="";for(s=0;s!==i.length;++s)i[s]!=null&&(G+=i[s].v);return G}var M5=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function R5(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function DU(e,t){var r=LU(e),n=r.length,i=r[n-1].indexOf("@");if(n<4&&i>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||i>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=i>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=i>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=i>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var a=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,a];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var s=r[0].match(M5),o=r[1].match(M5);return R5(t,s)?[n,r[0]]:R5(t,o)?[n,r[1]]:[n,r[s!=null&&o!=null?2:1]]}return[n,a]}function Eo(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:zr)[e],n==null&&(n=r.table&&r.table[F5[e]]||zr[F5[e]]),n==null&&(n=gU[e]||"General");break}if(cd(n,0))return mg(t,r);t instanceof Date&&(t=CA(t,r.date1904));var i=DU(n,t);if(cd(i[1]))return mg(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return FU(i[1],t,r,i[0])}function $A(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(zr[r]==null){t<0&&(t=r);continue}if(zr[r]==e){t=r;break}}t<0&&(t=391)}return zr[t]=e,t}function _p(e){for(var t=0;t!=392;++t)e[t]!==void 0&&$A(e[t],t)}function Np(){zr=mU()}var zA=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function IU(e){var t=typeof e=="number"?zr[e]:e;return t=t.replace(zA,"(\\d+)"),new RegExp("^"+t+"$")}function MU(e,t,r){var n=-1,i=-1,a=-1,s=-1,o=-1,l=-1;(t.match(zA)||[]).forEach(function(h,p){var d=parseInt(r[p+1],10);switch(h.toLowerCase().charAt(0)){case"y":n=d;break;case"d":a=d;break;case"h":s=d;break;case"s":l=d;break;case"m":s>=0?o=d:i=d;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(a>=1?a:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var u=("00"+(s>=0?s:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return s==-1&&o==-1&&l==-1?c:n==-1&&i==-1&&a==-1?u:c+"T"+u}var RU=function(){var e={};e.version="1.2.0";function t(){for(var C=0,R=new Array(256),k=0;k!=256;++k)C=k,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,R[k]=C;return typeof Int32Array<"u"?new Int32Array(R):R}var r=t();function n(C){var R=0,k=0,G=0,_=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(G=0;G!=256;++G)_[G]=C[G];for(G=0;G!=256;++G)for(k=C[G],R=256+G;R<4096;R+=256)k=_[R]=k>>>8^C[k&255];var j=[];for(G=1;G!=16;++G)j[G-1]=typeof Int32Array<"u"?_.subarray(G*256,G*256+256):_.slice(G*256,G*256+256);return j}var i=n(r),a=i[0],s=i[1],o=i[2],l=i[3],c=i[4],u=i[5],h=i[6],p=i[7],d=i[8],v=i[9],g=i[10],y=i[11],b=i[12],E=i[13],S=i[14];function P(C,R){for(var k=R^-1,G=0,_=C.length;G<_;)k=k>>>8^r[(k^C.charCodeAt(G++))&255];return~k}function L(C,R){for(var k=R^-1,G=C.length-15,_=0;_<G;)k=S[C[_++]^k&255]^E[C[_++]^k>>8&255]^b[C[_++]^k>>16&255]^y[C[_++]^k>>>24]^g[C[_++]]^v[C[_++]]^d[C[_++]]^p[C[_++]]^h[C[_++]]^u[C[_++]]^c[C[_++]]^l[C[_++]]^o[C[_++]]^s[C[_++]]^a[C[_++]]^r[C[_++]];for(G+=15;_<G;)k=k>>>8^r[(k^C[_++])&255];return~k}function q(C,R){for(var k=R^-1,G=0,_=C.length,j=0,H=0;G<_;)j=C.charCodeAt(G++),j<128?k=k>>>8^r[(k^j)&255]:j<2048?(k=k>>>8^r[(k^(192|j>>6&31))&255],k=k>>>8^r[(k^(128|j&63))&255]):j>=55296&&j<57344?(j=(j&1023)+64,H=C.charCodeAt(G++)&1023,k=k>>>8^r[(k^(240|j>>8&7))&255],k=k>>>8^r[(k^(128|j>>2&63))&255],k=k>>>8^r[(k^(128|H>>6&15|(j&3)<<4))&255],k=k>>>8^r[(k^(128|H&63))&255]):(k=k>>>8^r[(k^(224|j>>12&15))&255],k=k>>>8^r[(k^(128|j>>6&63))&255],k=k>>>8^r[(k^(128|j&63))&255]);return~k}return e.table=r,e.bstr=P,e.buf=L,e.str=q,e}(),gr=function(){var t={};t.version="1.2.1";function r(B,re){for(var K=B.split("/"),Z=re.split("/"),ne=0,se=0,Ne=Math.min(K.length,Z.length);ne<Ne;++ne){if(se=K[ne].length-Z[ne].length)return se;if(K[ne]!=Z[ne])return K[ne]<Z[ne]?-1:1}return K.length-Z.length}function n(B){if(B.charAt(B.length-1)=="/")return B.slice(0,-1).indexOf("/")===-1?B:n(B.slice(0,-1));var re=B.lastIndexOf("/");return re===-1?B:B.slice(0,re+1)}function i(B){if(B.charAt(B.length-1)=="/")return i(B.slice(0,-1));var re=B.lastIndexOf("/");return re===-1?B:B.slice(re+1)}function a(B,re){typeof re=="string"&&(re=new Date(re));var K=re.getHours();K=K<<6|re.getMinutes(),K=K<<5|re.getSeconds()>>>1,B.write_shift(2,K);var Z=re.getFullYear()-1980;Z=Z<<4|re.getMonth()+1,Z=Z<<5|re.getDate(),B.write_shift(2,Z)}function s(B){var re=B.read_shift(2)&65535,K=B.read_shift(2)&65535,Z=new Date,ne=K&31;K>>>=5;var se=K&15;K>>>=4,Z.setMilliseconds(0),Z.setFullYear(K+1980),Z.setMonth(se-1),Z.setDate(ne);var Ne=re&31;re>>>=5;var Ce=re&63;return re>>>=6,Z.setHours(re),Z.setMinutes(Ce),Z.setSeconds(Ne<<1),Z}function o(B){Li(B,0);for(var re={},K=0;B.l<=B.length-4;){var Z=B.read_shift(2),ne=B.read_shift(2),se=B.l+ne,Ne={};switch(Z){case 21589:K=B.read_shift(1),K&1&&(Ne.mtime=B.read_shift(4)),ne>5&&(K&2&&(Ne.atime=B.read_shift(4)),K&4&&(Ne.ctime=B.read_shift(4))),Ne.mtime&&(Ne.mt=new Date(Ne.mtime*1e3));break}B.l=se,re[Z]=Ne}return re}var l;function c(){return l||(l={})}function u(B,re){if(B[0]==80&&B[1]==75)return ir(B,re);if((B[0]|32)==109&&(B[1]|32)==105)return Nt(B,re);if(B.length<512)throw new Error("CFB file size "+B.length+" < 512");var K=3,Z=512,ne=0,se=0,Ne=0,Ce=0,Se=0,Ae=[],Pe=B.slice(0,512);Li(Pe,0);var He=h(Pe);switch(K=He[0],K){case 3:Z=512;break;case 4:Z=4096;break;case 0:if(He[1]==0)return ir(B,re);default:throw new Error("Major Version: Expected 3 or 4 saw "+K)}Z!==512&&(Pe=B.slice(0,Z),Li(Pe,28));var Ke=B.slice(0,Z);p(Pe,K);var rt=Pe.read_shift(4,"i");if(K===3&&rt!==0)throw new Error("# Directory Sectors: Expected 0 saw "+rt);Pe.l+=4,Ne=Pe.read_shift(4,"i"),Pe.l+=4,Pe.chk("00100000","Mini Stream Cutoff Size: "),Ce=Pe.read_shift(4,"i"),ne=Pe.read_shift(4,"i"),Se=Pe.read_shift(4,"i"),se=Pe.read_shift(4,"i");for(var Ve=-1,Qe=0;Qe<109&&(Ve=Pe.read_shift(4,"i"),!(Ve<0));++Qe)Ae[Qe]=Ve;var Tt=d(B,Z);y(Se,se,Tt,Z,Ae);var pr=E(Tt,Ne,Ae,Z);pr[Ne].name="!Directory",ne>0&&Ce!==H&&(pr[Ce].name="!MiniFAT"),pr[Ae[0]].name="!FAT",pr.fat_addrs=Ae,pr.ssz=Z;var Wt={},Ir=[],Ma=[],ga=[];S(Ne,pr,Tt,Ir,ne,Wt,Ma,Ce),v(Ma,ga,Ir),Ir.shift();var Ra={FileIndex:Ma,FullPaths:ga};return re&&re.raw&&(Ra.raw={header:Ke,sectors:Tt}),Ra}function h(B){if(B[B.l]==80&&B[B.l+1]==75)return[0,0];B.chk(X,"Header Signature: "),B.l+=16;var re=B.read_shift(2,"u");return[B.read_shift(2,"u"),re]}function p(B,re){var K=9;switch(B.l+=2,K=B.read_shift(2)){case 9:if(re!=3)throw new Error("Sector Shift: Expected 9 saw "+K);break;case 12:if(re!=4)throw new Error("Sector Shift: Expected 12 saw "+K);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+K)}B.chk("0600","Mini Sector Shift: "),B.chk("000000000000","Reserved: ")}function d(B,re){for(var K=Math.ceil(B.length/re)-1,Z=[],ne=1;ne<K;++ne)Z[ne-1]=B.slice(ne*re,(ne+1)*re);return Z[K-1]=B.slice(K*re),Z}function v(B,re,K){for(var Z=0,ne=0,se=0,Ne=0,Ce=0,Se=K.length,Ae=[],Pe=[];Z<Se;++Z)Ae[Z]=Pe[Z]=Z,re[Z]=K[Z];for(;Ce<Pe.length;++Ce)Z=Pe[Ce],ne=B[Z].L,se=B[Z].R,Ne=B[Z].C,Ae[Z]===Z&&(ne!==-1&&Ae[ne]!==ne&&(Ae[Z]=Ae[ne]),se!==-1&&Ae[se]!==se&&(Ae[Z]=Ae[se])),Ne!==-1&&(Ae[Ne]=Z),ne!==-1&&Z!=Ae[Z]&&(Ae[ne]=Ae[Z],Pe.lastIndexOf(ne)<Ce&&Pe.push(ne)),se!==-1&&Z!=Ae[Z]&&(Ae[se]=Ae[Z],Pe.lastIndexOf(se)<Ce&&Pe.push(se));for(Z=1;Z<Se;++Z)Ae[Z]===Z&&(se!==-1&&Ae[se]!==se?Ae[Z]=Ae[se]:ne!==-1&&Ae[ne]!==ne&&(Ae[Z]=Ae[ne]));for(Z=1;Z<Se;++Z)if(B[Z].type!==0){if(Ce=Z,Ce!=Ae[Ce])do Ce=Ae[Ce],re[Z]=re[Ce]+"/"+re[Z];while(Ce!==0&&Ae[Ce]!==-1&&Ce!=Ae[Ce]);Ae[Z]=-1}for(re[0]+="/",Z=1;Z<Se;++Z)B[Z].type!==2&&(re[Z]+="/")}function g(B,re,K){for(var Z=B.start,ne=B.size,se=[],Ne=Z;K&&ne>0&&Ne>=0;)se.push(re.slice(Ne*j,Ne*j+j)),ne-=j,Ne=tl(K,Ne*4);return se.length===0?Oe(0):Mn(se).slice(0,B.size)}function y(B,re,K,Z,ne){var se=H;if(B===H){if(re!==0)throw new Error("DIFAT chain shorter than expected")}else if(B!==-1){var Ne=K[B],Ce=(Z>>>2)-1;if(!Ne)return;for(var Se=0;Se<Ce&&(se=tl(Ne,Se*4))!==H;++Se)ne.push(se);y(tl(Ne,Z-4),re-1,K,Z,ne)}}function b(B,re,K,Z,ne){var se=[],Ne=[];ne||(ne=[]);var Ce=Z-1,Se=0,Ae=0;for(Se=re;Se>=0;){ne[Se]=!0,se[se.length]=Se,Ne.push(B[Se]);var Pe=K[Math.floor(Se*4/Z)];if(Ae=Se*4&Ce,Z<4+Ae)throw new Error("FAT boundary crossed: "+Se+" 4 "+Z);if(!B[Pe])break;Se=tl(B[Pe],Ae)}return{nodes:se,data:G5([Ne])}}function E(B,re,K,Z){var ne=B.length,se=[],Ne=[],Ce=[],Se=[],Ae=Z-1,Pe=0,He=0,Ke=0,rt=0;for(Pe=0;Pe<ne;++Pe)if(Ce=[],Ke=Pe+re,Ke>=ne&&(Ke-=ne),!Ne[Ke]){Se=[];var Ve=[];for(He=Ke;He>=0;){Ve[He]=!0,Ne[He]=!0,Ce[Ce.length]=He,Se.push(B[He]);var Qe=K[Math.floor(He*4/Z)];if(rt=He*4&Ae,Z<4+rt)throw new Error("FAT boundary crossed: "+He+" 4 "+Z);if(!B[Qe]||(He=tl(B[Qe],rt),Ve[He]))break}se[Ke]={nodes:Ce,data:G5([Se])}}return se}function S(B,re,K,Z,ne,se,Ne,Ce){for(var Se=0,Ae=Z.length?2:0,Pe=re[B].data,He=0,Ke=0,rt;He<Pe.length;He+=128){var Ve=Pe.slice(He,He+128);Li(Ve,64),Ke=Ve.read_shift(2),rt=Fv(Ve,0,Ke-Ae),Z.push(rt);var Qe={name:rt,type:Ve.read_shift(1),color:Ve.read_shift(1),L:Ve.read_shift(4,"i"),R:Ve.read_shift(4,"i"),C:Ve.read_shift(4,"i"),clsid:Ve.read_shift(16),state:Ve.read_shift(4,"i"),start:0,size:0},Tt=Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2);Tt!==0&&(Qe.ct=P(Ve,Ve.l-8));var pr=Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2)+Ve.read_shift(2);pr!==0&&(Qe.mt=P(Ve,Ve.l-8)),Qe.start=Ve.read_shift(4,"i"),Qe.size=Ve.read_shift(4,"i"),Qe.size<0&&Qe.start<0&&(Qe.size=Qe.type=0,Qe.start=H,Qe.name=""),Qe.type===5?(Se=Qe.start,ne>0&&Se!==H&&(re[Se].name="!StreamData")):Qe.size>=4096?(Qe.storage="fat",re[Qe.start]===void 0&&(re[Qe.start]=b(K,Qe.start,re.fat_addrs,re.ssz)),re[Qe.start].name=Qe.name,Qe.content=re[Qe.start].data.slice(0,Qe.size)):(Qe.storage="minifat",Qe.size<0?Qe.size=0:Se!==H&&Qe.start!==H&&re[Se]&&(Qe.content=g(Qe,re[Se].data,(re[Ce]||{}).data))),Qe.content&&Li(Qe.content,0),se[rt]=Qe,Ne.push(Qe)}}function P(B,re){return new Date((Di(B,re+4)/1e7*Math.pow(2,32)+Di(B,re)/1e7-11644473600)*1e3)}function L(B,re){return c(),u(l.readFileSync(B),re)}function q(B,re){var K=re&&re.type;switch(K||nr&&Buffer.isBuffer(B)&&(K="buffer"),K||"base64"){case"file":return L(B,re);case"base64":return u(Ta(Rs(B)),re);case"binary":return u(Ta(B),re)}return u(B,re)}function C(B,re){var K=re||{},Z=K.root||"Root Entry";if(B.FullPaths||(B.FullPaths=[]),B.FileIndex||(B.FileIndex=[]),B.FullPaths.length!==B.FileIndex.length)throw new Error("inconsistent CFB structure");B.FullPaths.length===0&&(B.FullPaths[0]=Z+"/",B.FileIndex[0]={name:Z,type:5}),K.CLSID&&(B.FileIndex[0].clsid=K.CLSID),R(B)}function R(B){var re="Sh33tJ5";if(!gr.find(B,"/"+re)){var K=Oe(4);K[0]=55,K[1]=K[3]=50,K[2]=54,B.FileIndex.push({name:re,type:2,content:K,size:4,L:69,R:69,C:69}),B.FullPaths.push(B.FullPaths[0]+re),k(B)}}function k(B,re){C(B);for(var K=!1,Z=!1,ne=B.FullPaths.length-1;ne>=0;--ne){var se=B.FileIndex[ne];switch(se.type){case 0:Z?K=!0:(B.FileIndex.pop(),B.FullPaths.pop());break;case 1:case 2:case 5:Z=!0,isNaN(se.R*se.L*se.C)&&(K=!0),se.R>-1&&se.L>-1&&se.R==se.L&&(K=!0);break;default:K=!0;break}}if(!(!K&&!re)){var Ne=new Date(1987,1,19),Ce=0,Se=Object.create?Object.create(null):{},Ae=[];for(ne=0;ne<B.FullPaths.length;++ne)Se[B.FullPaths[ne]]=!0,B.FileIndex[ne].type!==0&&Ae.push([B.FullPaths[ne],B.FileIndex[ne]]);for(ne=0;ne<Ae.length;++ne){var Pe=n(Ae[ne][0]);Z=Se[Pe],Z||(Ae.push([Pe,{name:i(Pe).replace("/",""),type:1,clsid:pe,ct:Ne,mt:Ne,content:null}]),Se[Pe]=!0)}for(Ae.sort(function(rt,Ve){return r(rt[0],Ve[0])}),B.FullPaths=[],B.FileIndex=[],ne=0;ne<Ae.length;++ne)B.FullPaths[ne]=Ae[ne][0],B.FileIndex[ne]=Ae[ne][1];for(ne=0;ne<Ae.length;++ne){var He=B.FileIndex[ne],Ke=B.FullPaths[ne];if(He.name=i(Ke).replace("/",""),He.L=He.R=He.C=-(He.color=1),He.size=He.content?He.content.length:0,He.start=0,He.clsid=He.clsid||pe,ne===0)He.C=Ae.length>1?1:-1,He.size=0,He.type=5;else if(Ke.slice(-1)=="/"){for(Ce=ne+1;Ce<Ae.length&&n(B.FullPaths[Ce])!=Ke;++Ce);for(He.C=Ce>=Ae.length?-1:Ce,Ce=ne+1;Ce<Ae.length&&n(B.FullPaths[Ce])!=n(Ke);++Ce);He.R=Ce>=Ae.length?-1:Ce,He.type=1}else n(B.FullPaths[ne+1]||"")==n(Ke)&&(He.R=ne+1),He.type=2}}}function G(B,re){var K=re||{};if(K.fileType=="mad")return pa(B,K);switch(k(B),K.fileType){case"zip":return zt(B,K)}var Z=function(rt){for(var Ve=0,Qe=0,Tt=0;Tt<rt.FileIndex.length;++Tt){var pr=rt.FileIndex[Tt];if(pr.content){var Wt=pr.content.length;Wt>0&&(Wt<4096?Ve+=Wt+63>>6:Qe+=Wt+511>>9)}}for(var Ir=rt.FullPaths.length+3>>2,Ma=Ve+7>>3,ga=Ve+127>>7,Ra=Ma+Qe+Ir+ga,Ki=Ra+127>>7,Hs=Ki<=109?0:Math.ceil((Ki-109)/127);Ra+Ki+Hs+127>>7>Ki;)Hs=++Ki<=109?0:Math.ceil((Ki-109)/127);var zn=[1,Hs,Ki,ga,Ir,Qe,Ve,0];return rt.FileIndex[0].size=Ve<<6,zn[7]=(rt.FileIndex[0].start=zn[0]+zn[1]+zn[2]+zn[3]+zn[4]+zn[5])+(zn[6]+7>>3),zn}(B),ne=Oe(Z[7]<<9),se=0,Ne=0;{for(se=0;se<8;++se)ne.write_shift(1,ce[se]);for(se=0;se<8;++se)ne.write_shift(2,0);for(ne.write_shift(2,62),ne.write_shift(2,3),ne.write_shift(2,65534),ne.write_shift(2,9),ne.write_shift(2,6),se=0;se<3;++se)ne.write_shift(2,0);for(ne.write_shift(4,0),ne.write_shift(4,Z[2]),ne.write_shift(4,Z[0]+Z[1]+Z[2]+Z[3]-1),ne.write_shift(4,0),ne.write_shift(4,4096),ne.write_shift(4,Z[3]?Z[0]+Z[1]+Z[2]-1:H),ne.write_shift(4,Z[3]),ne.write_shift(-4,Z[1]?Z[0]-1:H),ne.write_shift(4,Z[1]),se=0;se<109;++se)ne.write_shift(-4,se<Z[2]?Z[1]+se:-1)}if(Z[1])for(Ne=0;Ne<Z[1];++Ne){for(;se<236+Ne*127;++se)ne.write_shift(-4,se<Z[2]?Z[1]+se:-1);ne.write_shift(-4,Ne===Z[1]-1?H:Ne+1)}var Ce=function(rt){for(Ne+=rt;se<Ne-1;++se)ne.write_shift(-4,se+1);rt&&(++se,ne.write_shift(-4,H))};for(Ne=se=0,Ne+=Z[1];se<Ne;++se)ne.write_shift(-4,ye.DIFSECT);for(Ne+=Z[2];se<Ne;++se)ne.write_shift(-4,ye.FATSECT);Ce(Z[3]),Ce(Z[4]);for(var Se=0,Ae=0,Pe=B.FileIndex[0];Se<B.FileIndex.length;++Se)Pe=B.FileIndex[Se],Pe.content&&(Ae=Pe.content.length,!(Ae<4096)&&(Pe.start=Ne,Ce(Ae+511>>9)));for(Ce(Z[6]+7>>3);ne.l&511;)ne.write_shift(-4,ye.ENDOFCHAIN);for(Ne=se=0,Se=0;Se<B.FileIndex.length;++Se)Pe=B.FileIndex[Se],Pe.content&&(Ae=Pe.content.length,!(!Ae||Ae>=4096)&&(Pe.start=Ne,Ce(Ae+63>>6)));for(;ne.l&511;)ne.write_shift(-4,ye.ENDOFCHAIN);for(se=0;se<Z[4]<<2;++se){var He=B.FullPaths[se];if(!He||He.length===0){for(Se=0;Se<17;++Se)ne.write_shift(4,0);for(Se=0;Se<3;++Se)ne.write_shift(4,-1);for(Se=0;Se<12;++Se)ne.write_shift(4,0);continue}Pe=B.FileIndex[se],se===0&&(Pe.start=Pe.size?Pe.start-1:H);var Ke=se===0&&K.root||Pe.name;if(Ae=2*(Ke.length+1),ne.write_shift(64,Ke,"utf16le"),ne.write_shift(2,Ae),ne.write_shift(1,Pe.type),ne.write_shift(1,Pe.color),ne.write_shift(-4,Pe.L),ne.write_shift(-4,Pe.R),ne.write_shift(-4,Pe.C),Pe.clsid)ne.write_shift(16,Pe.clsid,"hex");else for(Se=0;Se<4;++Se)ne.write_shift(4,0);ne.write_shift(4,Pe.state||0),ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(4,0),ne.write_shift(4,Pe.start),ne.write_shift(4,Pe.size),ne.write_shift(4,0)}for(se=1;se<B.FileIndex.length;++se)if(Pe=B.FileIndex[se],Pe.size>=4096)if(ne.l=Pe.start+1<<9,nr&&Buffer.isBuffer(Pe.content))Pe.content.copy(ne,ne.l,0,Pe.size),ne.l+=Pe.size+511&-512;else{for(Se=0;Se<Pe.size;++Se)ne.write_shift(1,Pe.content[Se]);for(;Se&511;++Se)ne.write_shift(1,0)}for(se=1;se<B.FileIndex.length;++se)if(Pe=B.FileIndex[se],Pe.size>0&&Pe.size<4096)if(nr&&Buffer.isBuffer(Pe.content))Pe.content.copy(ne,ne.l,0,Pe.size),ne.l+=Pe.size+63&-64;else{for(Se=0;Se<Pe.size;++Se)ne.write_shift(1,Pe.content[Se]);for(;Se&63;++Se)ne.write_shift(1,0)}if(nr)ne.l=ne.length;else for(;ne.l<ne.length;)ne.write_shift(1,0);return ne}function _(B,re){var K=B.FullPaths.map(function(Se){return Se.toUpperCase()}),Z=K.map(function(Se){var Ae=Se.split("/");return Ae[Ae.length-(Se.slice(-1)=="/"?2:1)]}),ne=!1;re.charCodeAt(0)===47?(ne=!0,re=K[0].slice(0,-1)+re):ne=re.indexOf("/")!==-1;var se=re.toUpperCase(),Ne=ne===!0?K.indexOf(se):Z.indexOf(se);if(Ne!==-1)return B.FileIndex[Ne];var Ce=!se.match(Q0);for(se=se.replace(of,""),Ce&&(se=se.replace(Q0,"!")),Ne=0;Ne<K.length;++Ne)if((Ce?K[Ne].replace(Q0,"!"):K[Ne]).replace(of,"")==se||(Ce?Z[Ne].replace(Q0,"!"):Z[Ne]).replace(of,"")==se)return B.FileIndex[Ne];return null}var j=64,H=-2,X="d0cf11e0a1b11ae1",ce=[208,207,17,224,161,177,26,225],pe="00000000000000000000000000000000",ye={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:H,FREESECT:-1,HEADER_SIGNATURE:X,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:pe,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function me(B,re,K){c();var Z=G(B,K);l.writeFileSync(re,Z)}function be(B){for(var re=new Array(B.length),K=0;K<B.length;++K)re[K]=String.fromCharCode(B[K]);return re.join("")}function Ue(B,re){var K=G(B,re);switch(re&&re.type||"buffer"){case"file":return c(),l.writeFileSync(re.filename,K),K;case"binary":return typeof K=="string"?K:be(K);case"base64":return kf(typeof K=="string"?K:be(K));case"buffer":if(nr)return Buffer.isBuffer(K)?K:qs(K);case"array":return typeof K=="string"?Ta(K):K}return K}var Fe;function A(B){try{var re=B.InflateRaw,K=new re;if(K._processChunk(new Uint8Array([3,0]),K._finishFlushFlag),K.bytesRead)Fe=B;else throw new Error("zlib does not expose bytesRead")}catch(Z){console.error("cannot use native zlib: "+(Z.message||Z))}}function F(B,re){if(!Fe)return Ct(B,re);var K=Fe.InflateRaw,Z=new K,ne=Z._processChunk(B.slice(B.l),Z._finishFlushFlag);return B.l+=Z.bytesRead,ne}function O(B){return Fe?Fe.deflateRawSync(B):_t(B)}var M=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],J=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],fe=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function ve(B){var re=(B<<1|B<<11)&139536|(B<<5|B<<15)&558144;return(re>>16|re>>8|re)&255}for(var ae=typeof Uint8Array<"u",ue=ae?new Uint8Array(256):[],oe=0;oe<256;++oe)ue[oe]=ve(oe);function le(B,re){var K=ue[B&255];return re<=8?K>>>8-re:(K=K<<8|ue[B>>8&255],re<=16?K>>>16-re:(K=K<<8|ue[B>>16&255],K>>>24-re))}function Be(B,re){var K=re&7,Z=re>>>3;return(B[Z]|(K<=6?0:B[Z+1]<<8))>>>K&3}function ge(B,re){var K=re&7,Z=re>>>3;return(B[Z]|(K<=5?0:B[Z+1]<<8))>>>K&7}function Q(B,re){var K=re&7,Z=re>>>3;return(B[Z]|(K<=4?0:B[Z+1]<<8))>>>K&15}function tt(B,re){var K=re&7,Z=re>>>3;return(B[Z]|(K<=3?0:B[Z+1]<<8))>>>K&31}function Re(B,re){var K=re&7,Z=re>>>3;return(B[Z]|(K<=1?0:B[Z+1]<<8))>>>K&127}function it(B,re,K){var Z=re&7,ne=re>>>3,se=(1<<K)-1,Ne=B[ne]>>>Z;return K<8-Z||(Ne|=B[ne+1]<<8-Z,K<16-Z)||(Ne|=B[ne+2]<<16-Z,K<24-Z)||(Ne|=B[ne+3]<<24-Z),Ne&se}function We(B,re,K){var Z=re&7,ne=re>>>3;return Z<=5?B[ne]|=(K&7)<<Z:(B[ne]|=K<<Z&255,B[ne+1]=(K&7)>>8-Z),re+3}function st(B,re,K){var Z=re&7,ne=re>>>3;return K=(K&1)<<Z,B[ne]|=K,re+1}function Ze(B,re,K){var Z=re&7,ne=re>>>3;return K<<=Z,B[ne]|=K&255,K>>>=8,B[ne+1]=K,re+8}function Pt(B,re,K){var Z=re&7,ne=re>>>3;return K<<=Z,B[ne]|=K&255,K>>>=8,B[ne+1]=K&255,B[ne+2]=K>>>8,re+16}function ft(B,re){var K=B.length,Z=2*K>re?2*K:re+5,ne=0;if(K>=re)return B;if(nr){var se=C5(Z);if(B.copy)B.copy(se);else for(;ne<B.length;++ne)se[ne]=B[ne];return se}else if(ae){var Ne=new Uint8Array(Z);if(Ne.set)Ne.set(B);else for(;ne<K;++ne)Ne[ne]=B[ne];return Ne}return B.length=Z,B}function Lt(B){for(var re=new Array(B),K=0;K<B;++K)re[K]=0;return re}function At(B,re,K){var Z=1,ne=0,se=0,Ne=0,Ce=0,Se=B.length,Ae=ae?new Uint16Array(32):Lt(32);for(se=0;se<32;++se)Ae[se]=0;for(se=Se;se<K;++se)B[se]=0;Se=B.length;var Pe=ae?new Uint16Array(Se):Lt(Se);for(se=0;se<Se;++se)Ae[ne=B[se]]++,Z<ne&&(Z=ne),Pe[se]=0;for(Ae[0]=0,se=1;se<=Z;++se)Ae[se+16]=Ce=Ce+Ae[se-1]<<1;for(se=0;se<Se;++se)Ce=B[se],Ce!=0&&(Pe[se]=Ae[Ce+16]++);var He=0;for(se=0;se<Se;++se)if(He=B[se],He!=0)for(Ce=le(Pe[se],Z)>>Z-He,Ne=(1<<Z+4-He)-1;Ne>=0;--Ne)re[Ce|Ne<<He]=He&15|se<<4;return Z}var Et=ae?new Uint16Array(512):Lt(512),Kt=ae?new Uint16Array(32):Lt(32);if(!ae){for(var yt=0;yt<512;++yt)Et[yt]=0;for(yt=0;yt<32;++yt)Kt[yt]=0}(function(){for(var B=[],re=0;re<32;re++)B.push(5);At(B,Kt,32);var K=[];for(re=0;re<=143;re++)K.push(8);for(;re<=255;re++)K.push(9);for(;re<=279;re++)K.push(7);for(;re<=287;re++)K.push(8);At(K,Et,288)})();var pt=function(){for(var re=ae?new Uint8Array(32768):[],K=0,Z=0;K<fe.length-1;++K)for(;Z<fe[K+1];++Z)re[Z]=K;for(;Z<32768;++Z)re[Z]=29;var ne=ae?new Uint8Array(259):[];for(K=0,Z=0;K<J.length-1;++K)for(;Z<J[K+1];++Z)ne[Z]=K;function se(Ce,Se){for(var Ae=0;Ae<Ce.length;){var Pe=Math.min(65535,Ce.length-Ae),He=Ae+Pe==Ce.length;for(Se.write_shift(1,+He),Se.write_shift(2,Pe),Se.write_shift(2,~Pe&65535);Pe-- >0;)Se[Se.l++]=Ce[Ae++]}return Se.l}function Ne(Ce,Se){for(var Ae=0,Pe=0,He=ae?new Uint16Array(32768):[];Pe<Ce.length;){var Ke=Math.min(65535,Ce.length-Pe);if(Ke<10){for(Ae=We(Se,Ae,+(Pe+Ke==Ce.length)),Ae&7&&(Ae+=8-(Ae&7)),Se.l=Ae/8|0,Se.write_shift(2,Ke),Se.write_shift(2,~Ke&65535);Ke-- >0;)Se[Se.l++]=Ce[Pe++];Ae=Se.l*8;continue}Ae=We(Se,Ae,+(Pe+Ke==Ce.length)+2);for(var rt=0;Ke-- >0;){var Ve=Ce[Pe];rt=(rt<<5^Ve)&32767;var Qe=-1,Tt=0;if((Qe=He[rt])&&(Qe|=Pe&-32768,Qe>Pe&&(Qe-=32768),Qe<Pe))for(;Ce[Qe+Tt]==Ce[Pe+Tt]&&Tt<250;)++Tt;if(Tt>2){Ve=ne[Tt],Ve<=22?Ae=Ze(Se,Ae,ue[Ve+1]>>1)-1:(Ze(Se,Ae,3),Ae+=5,Ze(Se,Ae,ue[Ve-23]>>5),Ae+=3);var pr=Ve<8?0:Ve-4>>2;pr>0&&(Pt(Se,Ae,Tt-J[Ve]),Ae+=pr),Ve=re[Pe-Qe],Ae=Ze(Se,Ae,ue[Ve]>>3),Ae-=3;var Wt=Ve<4?0:Ve-2>>1;Wt>0&&(Pt(Se,Ae,Pe-Qe-fe[Ve]),Ae+=Wt);for(var Ir=0;Ir<Tt;++Ir)He[rt]=Pe&32767,rt=(rt<<5^Ce[Pe])&32767,++Pe;Ke-=Tt-1}else Ve<=143?Ve=Ve+48:Ae=st(Se,Ae,1),Ae=Ze(Se,Ae,ue[Ve]),He[rt]=Pe&32767,++Pe}Ae=Ze(Se,Ae,0)-1}return Se.l=(Ae+7)/8|0,Se.l}return function(Se,Ae){return Se.length<8?se(Se,Ae):Ne(Se,Ae)}}();function _t(B){var re=Oe(50+Math.floor(B.length*1.1)),K=pt(B,re);return re.slice(0,K)}var mt=ae?new Uint16Array(32768):Lt(32768),Qt=ae?new Uint16Array(32768):Lt(32768),Ut=ae?new Uint16Array(128):Lt(128),ht=1,je=1;function nt(B,re){var K=tt(B,re)+257;re+=5;var Z=tt(B,re)+1;re+=5;var ne=Q(B,re)+4;re+=4;for(var se=0,Ne=ae?new Uint8Array(19):Lt(19),Ce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],Se=1,Ae=ae?new Uint8Array(8):Lt(8),Pe=ae?new Uint8Array(8):Lt(8),He=Ne.length,Ke=0;Ke<ne;++Ke)Ne[M[Ke]]=se=ge(B,re),Se<se&&(Se=se),Ae[se]++,re+=3;var rt=0;for(Ae[0]=0,Ke=1;Ke<=Se;++Ke)Pe[Ke]=rt=rt+Ae[Ke-1]<<1;for(Ke=0;Ke<He;++Ke)(rt=Ne[Ke])!=0&&(Ce[Ke]=Pe[rt]++);var Ve=0;for(Ke=0;Ke<He;++Ke)if(Ve=Ne[Ke],Ve!=0){rt=ue[Ce[Ke]]>>8-Ve;for(var Qe=(1<<7-Ve)-1;Qe>=0;--Qe)Ut[rt|Qe<<Ve]=Ve&7|Ke<<3}var Tt=[];for(Se=1;Tt.length<K+Z;)switch(rt=Ut[Re(B,re)],re+=rt&7,rt>>>=3){case 16:for(se=3+Be(B,re),re+=2,rt=Tt[Tt.length-1];se-- >0;)Tt.push(rt);break;case 17:for(se=3+ge(B,re),re+=3;se-- >0;)Tt.push(0);break;case 18:for(se=11+Re(B,re),re+=7;se-- >0;)Tt.push(0);break;default:Tt.push(rt),Se<rt&&(Se=rt);break}var pr=Tt.slice(0,K),Wt=Tt.slice(K);for(Ke=K;Ke<286;++Ke)pr[Ke]=0;for(Ke=Z;Ke<30;++Ke)Wt[Ke]=0;return ht=At(pr,mt,286),je=At(Wt,Qt,30),re}function ot(B,re){if(B[0]==3&&!(B[1]&3))return[Nl(re),2];for(var K=0,Z=0,ne=C5(re||1<<18),se=0,Ne=ne.length>>>0,Ce=0,Se=0;!(Z&1);){if(Z=ge(B,K),K+=3,Z>>>1)Z>>1==1?(Ce=9,Se=5):(K=nt(B,K),Ce=ht,Se=je);else{K&7&&(K+=8-(K&7));var Ae=B[K>>>3]|B[(K>>>3)+1]<<8;if(K+=32,Ae>0)for(!re&&Ne<se+Ae&&(ne=ft(ne,se+Ae),Ne=ne.length);Ae-- >0;)ne[se++]=B[K>>>3],K+=8;continue}for(;;){!re&&Ne<se+32767&&(ne=ft(ne,se+32767),Ne=ne.length);var Pe=it(B,K,Ce),He=Z>>>1==1?Et[Pe]:mt[Pe];if(K+=He&15,He>>>=4,!(He>>>8&255))ne[se++]=He;else{if(He==256)break;He-=257;var Ke=He<8?0:He-4>>2;Ke>5&&(Ke=0);var rt=se+J[He];Ke>0&&(rt+=it(B,K,Ke),K+=Ke),Pe=it(B,K,Se),He=Z>>>1==1?Kt[Pe]:Qt[Pe],K+=He&15,He>>>=4;var Ve=He<4?0:He-2>>1,Qe=fe[He];for(Ve>0&&(Qe+=it(B,K,Ve),K+=Ve),!re&&Ne<rt&&(ne=ft(ne,rt+100),Ne=ne.length);se<rt;)ne[se]=ne[se-Qe],++se}}}return re?[ne,K+7>>>3]:[ne.slice(0,se),K+7>>>3]}function Ct(B,re){var K=B.slice(B.l||0),Z=ot(K,re);return B.l+=Z[1],Z[0]}function St(B,re){if(B)typeof console<"u"&&console.error(re);else throw new Error(re)}function ir(B,re){var K=B;Li(K,0);var Z=[],ne=[],se={FileIndex:Z,FullPaths:ne};C(se,{root:re.root});for(var Ne=K.length-4;(K[Ne]!=80||K[Ne+1]!=75||K[Ne+2]!=5||K[Ne+3]!=6)&&Ne>=0;)--Ne;K.l=Ne+4,K.l+=4;var Ce=K.read_shift(2);K.l+=6;var Se=K.read_shift(4);for(K.l=Se,Ne=0;Ne<Ce;++Ne){K.l+=20;var Ae=K.read_shift(4),Pe=K.read_shift(4),He=K.read_shift(2),Ke=K.read_shift(2),rt=K.read_shift(2);K.l+=8;var Ve=K.read_shift(4),Qe=o(K.slice(K.l+He,K.l+He+Ke));K.l+=He+Ke+rt;var Tt=K.l;K.l=Ve+4,ar(K,Ae,Pe,se,Qe),K.l=Tt}return se}function ar(B,re,K,Z,ne){B.l+=2;var se=B.read_shift(2),Ne=B.read_shift(2),Ce=s(B);if(se&8257)throw new Error("Unsupported ZIP encryption");for(var Se=B.read_shift(4),Ae=B.read_shift(4),Pe=B.read_shift(4),He=B.read_shift(2),Ke=B.read_shift(2),rt="",Ve=0;Ve<He;++Ve)rt+=String.fromCharCode(B[B.l++]);if(Ke){var Qe=o(B.slice(B.l,B.l+Ke));(Qe[21589]||{}).mt&&(Ce=Qe[21589].mt),((ne||{})[21589]||{}).mt&&(Ce=ne[21589].mt)}B.l+=Ke;var Tt=B.slice(B.l,B.l+Ae);switch(Ne){case 8:Tt=F(B,Pe);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Ne)}var pr=!1;se&8&&(Se=B.read_shift(4),Se==134695760&&(Se=B.read_shift(4),pr=!0),Ae=B.read_shift(4),Pe=B.read_shift(4)),Ae!=re&&St(pr,"Bad compressed size: "+re+" != "+Ae),Pe!=K&&St(pr,"Bad uncompressed size: "+K+" != "+Pe),$n(Z,rt,Tt,{unsafe:!0,mt:Ce})}function zt(B,re){var K=re||{},Z=[],ne=[],se=Oe(1),Ne=K.compression?8:0,Ce=0,Se=0,Ae=0,Pe=0,He=0,Ke=B.FullPaths[0],rt=Ke,Ve=B.FileIndex[0],Qe=[],Tt=0;for(Se=1;Se<B.FullPaths.length;++Se)if(rt=B.FullPaths[Se].slice(Ke.length),Ve=B.FileIndex[Se],!(!Ve.size||!Ve.content||rt=="Sh33tJ5")){var pr=Pe,Wt=Oe(rt.length);for(Ae=0;Ae<rt.length;++Ae)Wt.write_shift(1,rt.charCodeAt(Ae)&127);Wt=Wt.slice(0,Wt.l),Qe[He]=RU.buf(Ve.content,0);var Ir=Ve.content;Ne==8&&(Ir=O(Ir)),se=Oe(30),se.write_shift(4,67324752),se.write_shift(2,20),se.write_shift(2,Ce),se.write_shift(2,Ne),Ve.mt?a(se,Ve.mt):se.write_shift(4,0),se.write_shift(-4,Qe[He]),se.write_shift(4,Ir.length),se.write_shift(4,Ve.content.length),se.write_shift(2,Wt.length),se.write_shift(2,0),Pe+=se.length,Z.push(se),Pe+=Wt.length,Z.push(Wt),Pe+=Ir.length,Z.push(Ir),se=Oe(46),se.write_shift(4,33639248),se.write_shift(2,0),se.write_shift(2,20),se.write_shift(2,Ce),se.write_shift(2,Ne),se.write_shift(4,0),se.write_shift(-4,Qe[He]),se.write_shift(4,Ir.length),se.write_shift(4,Ve.content.length),se.write_shift(2,Wt.length),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(4,0),se.write_shift(4,pr),Tt+=se.l,ne.push(se),Tt+=Wt.length,ne.push(Wt),++He}return se=Oe(22),se.write_shift(4,101010256),se.write_shift(2,0),se.write_shift(2,0),se.write_shift(2,He),se.write_shift(2,He),se.write_shift(4,Tt),se.write_shift(4,Pe),se.write_shift(2,0),Mn([Mn(Z),Mn(ne),se])}var at={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function $t(B,re){if(B.ctype)return B.ctype;var K=B.name||"",Z=K.match(/\.([^\.]+)$/);return Z&&at[Z[1]]||re&&(Z=(K=re).match(/[\.\\]([^\.\\])+$/),Z&&at[Z[1]])?at[Z[1]]:"application/octet-stream"}function Tn(B){for(var re=kf(B),K=[],Z=0;Z<re.length;Z+=76)K.push(re.slice(Z,Z+76));return K.join(`\r
`)+`\r
`}function Fr(B){var re=B.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(Ae){var Pe=Ae.charCodeAt(0).toString(16).toUpperCase();return"="+(Pe.length==1?"0"+Pe:Pe)});re=re.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),re.charAt(0)==`
`&&(re="=0D"+re.slice(1)),re=re.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var K=[],Z=re.split(`\r
`),ne=0;ne<Z.length;++ne){var se=Z[ne];if(se.length==0){K.push("");continue}for(var Ne=0;Ne<se.length;){var Ce=76,Se=se.slice(Ne,Ne+Ce);Se.charAt(Ce-1)=="="?Ce--:Se.charAt(Ce-2)=="="?Ce-=2:Se.charAt(Ce-3)=="="&&(Ce-=3),Se=se.slice(Ne,Ne+Ce),Ne+=Ce,Ne<se.length&&(Se+="="),K.push(Se)}}return K.join(`\r
`)}function da(B){for(var re=[],K=0;K<B.length;++K){for(var Z=B[K];K<=B.length&&Z.charAt(Z.length-1)=="=";)Z=Z.slice(0,Z.length-1)+B[++K];re.push(Z)}for(var ne=0;ne<re.length;++ne)re[ne]=re[ne].replace(/[=][0-9A-Fa-f]{2}/g,function(se){return String.fromCharCode(parseInt(se.slice(1),16))});return Ta(re.join(`\r
`))}function Vi(B,re,K){for(var Z="",ne="",se="",Ne,Ce=0;Ce<10;++Ce){var Se=re[Ce];if(!Se||Se.match(/^\s*$/))break;var Ae=Se.match(/^(.*?):\s*([^\s].*)$/);if(Ae)switch(Ae[1].toLowerCase()){case"content-location":Z=Ae[2].trim();break;case"content-type":se=Ae[2].trim();break;case"content-transfer-encoding":ne=Ae[2].trim();break}}switch(++Ce,ne.toLowerCase()){case"base64":Ne=Ta(Rs(re.slice(Ce).join("")));break;case"quoted-printable":Ne=da(re.slice(Ce));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+ne)}var Pe=$n(B,Z.slice(K.length),Ne,{unsafe:!0});se&&(Pe.ctype=se)}function Nt(B,re){if(be(B.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var K=re&&re.root||"",Z=(nr&&Buffer.isBuffer(B)?B.toString("binary"):be(B)).split(`\r
`),ne=0,se="";for(ne=0;ne<Z.length;++ne)if(se=Z[ne],!!/^Content-Location:/i.test(se)&&(se=se.slice(se.indexOf("file")),K||(K=se.slice(0,se.lastIndexOf("/")+1)),se.slice(0,K.length)!=K))for(;K.length>0&&(K=K.slice(0,K.length-1),K=K.slice(0,K.lastIndexOf("/")+1),se.slice(0,K.length)!=K););var Ne=(Z[1]||"").match(/boundary="(.*?)"/);if(!Ne)throw new Error("MAD cannot find boundary");var Ce="--"+(Ne[1]||""),Se=[],Ae=[],Pe={FileIndex:Se,FullPaths:Ae};C(Pe);var He,Ke=0;for(ne=0;ne<Z.length;++ne){var rt=Z[ne];rt!==Ce&&rt!==Ce+"--"||(Ke++&&Vi(Pe,Z.slice(He,ne),K),He=ne)}return Pe}function pa(B,re){var K=re||{},Z=K.boundary||"SheetJS";Z="------="+Z;for(var ne=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Z.slice(2)+'"',"","",""],se=B.FullPaths[0],Ne=se,Ce=B.FileIndex[0],Se=1;Se<B.FullPaths.length;++Se)if(Ne=B.FullPaths[Se].slice(se.length),Ce=B.FileIndex[Se],!(!Ce.size||!Ce.content||Ne=="Sh33tJ5")){Ne=Ne.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Tt){return"_x"+Tt.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Tt){return"_u"+Tt.charCodeAt(0).toString(16)+"_"});for(var Ae=Ce.content,Pe=nr&&Buffer.isBuffer(Ae)?Ae.toString("binary"):be(Ae),He=0,Ke=Math.min(1024,Pe.length),rt=0,Ve=0;Ve<=Ke;++Ve)(rt=Pe.charCodeAt(Ve))>=32&&rt<128&&++He;var Qe=He>=Ke*4/5;ne.push(Z),ne.push("Content-Location: "+(K.root||"file:///C:/SheetJS/")+Ne),ne.push("Content-Transfer-Encoding: "+(Qe?"quoted-printable":"base64")),ne.push("Content-Type: "+$t(Ce,Ne)),ne.push(""),ne.push(Qe?Fr(Pe):Tn(Pe))}return ne.push(Z+`--\r
`),ne.join(`\r
`)}function ma(B){var re={};return C(re,B),re}function $n(B,re,K,Z){var ne=Z&&Z.unsafe;ne||C(B);var se=!ne&&gr.find(B,re);if(!se){var Ne=B.FullPaths[0];re.slice(0,Ne.length)==Ne?Ne=re:(Ne.slice(-1)!="/"&&(Ne+="/"),Ne=(Ne+re).replace("//","/")),se={name:i(re),type:2},B.FileIndex.push(se),B.FullPaths.push(Ne),ne||gr.utils.cfb_gc(B)}return se.content=K,se.size=K?K.length:0,Z&&(Z.CLSID&&(se.clsid=Z.CLSID),Z.mt&&(se.mt=Z.mt),Z.ct&&(se.ct=Z.ct)),se}function li(B,re){C(B);var K=gr.find(B,re);if(K){for(var Z=0;Z<B.FileIndex.length;++Z)if(B.FileIndex[Z]==K)return B.FileIndex.splice(Z,1),B.FullPaths.splice(Z,1),!0}return!1}function kr(B,re,K){C(B);var Z=gr.find(B,re);if(Z){for(var ne=0;ne<B.FileIndex.length;++ne)if(B.FileIndex[ne]==Z)return B.FileIndex[ne].name=i(K),B.FullPaths[ne]=K,!0}return!1}function Qr(B){k(B,!0)}return t.find=_,t.read=q,t.parse=u,t.write=Ue,t.writeFile=me,t.utils={cfb_new:ma,cfb_add:$n,cfb_del:li,cfb_mov:kr,cfb_gc:Qr,ReadShift:cf,CheckField:s6,prep_blob:Li,bconcat:Mn,use_zlib:A,_deflateRaw:_t,_inflateRaw:Ct,consts:ye},t}();function BU(e){return typeof e=="string"?wp(e):Array.isArray(e)?fU(e):e}function s0(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=wp(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?Of(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var i=new Blob([BU(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var a=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),chrome.downloads.download({url:a,filename:e,saveAs:!0});var s=document.createElement("a");if(s.download!=null)return s.download=e,s.href=a,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(a)},6e4),a}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=a0(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function Un(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function B5(e,t){for(var r=[],n=Un(e),i=0;i!==n.length;++i)r[e[n[i]][t]]==null&&(r[e[n[i]][t]]=n[i]);return r}function kv(e){for(var t=[],r=Un(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function Sp(e){for(var t=[],r=Un(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function UU(e){for(var t=[],r=Un(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var fd=new Date(1899,11,30,0,0,0);function xi(e,t){var r=e.getTime(),n=fd.getTime()+(e.getTimezoneOffset()-fd.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var WA=new Date,$U=fd.getTime()+(WA.getTimezoneOffset()-fd.getTimezoneOffset())*6e4,U5=WA.getTimezoneOffset();function qA(e){var t=new Date;return t.setTime(e*24*60*60*1e3+$U),t.getTimezoneOffset()!==U5&&t.setTime(t.getTime()+(t.getTimezoneOffset()-U5)*6e4),t}var $5=new Date("2017-02-19T19:06:09.000Z"),HA=isNaN($5.getFullYear())?new Date("2/19/17"):$5,zU=HA.getFullYear()==2017;function oi(e,t){var r=new Date(e);if(zU)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(HA.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],a=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(a=new Date(a.getTime()-a.getTimezoneOffset()*60*1e3)),a}function Ap(e,t){if(nr&&Buffer.isBuffer(e))return e.toString("binary");if(typeof TextDecoder<"u")try{var r={"‚Ç¨":"¬Ä","‚Äö":"¬Ç",∆í:"¬É","‚Äû":"¬Ñ","‚Ä¶":"¬Ö","‚Ä†":"¬Ü","‚Ä°":"¬á","ÀÜ":"¬à","‚Ä∞":"¬â",≈†:"¬ä","‚Äπ":"¬ã",≈í:"¬å",≈Ω:"¬é","‚Äò":"¬ë","‚Äô":"¬í","‚Äú":"¬ì","‚Äù":"¬î","‚Ä¢":"¬ï","‚Äì":"¬ñ","‚Äî":"¬ó","Àú":"¬ò","‚Ñ¢":"¬ô",≈°:"¬ö","‚Ä∫":"¬õ",≈ì:"¬ú",≈æ:"¬û",≈∏:"¬ü"};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[‚Ç¨‚Äö∆í‚Äû‚Ä¶‚Ä†‚Ä°ÀÜ‚Ä∞≈†‚Äπ≈í≈Ω‚Äò‚Äô‚Äú‚Äù‚Ä¢‚Äì‚ÄîÀú‚Ñ¢≈°‚Ä∫≈ì≈æ≈∏]/g,function(a){return r[a]||a})}catch{}for(var n=[],i=0;i!=e.length;++i)n.push(String.fromCharCode(e[i]));return n.join("")}function yi(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=yi(e[r]));return t}function $r(e,t){for(var r="";r.length<t;)r+=e;return r}function ks(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(i,a){return r=-r,a}),!isNaN(t=Number(n)))?t/r:t}var WU=["january","february","march","april","may","june","july","august","september","october","november","december"];function Cf(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),i=t.getMonth(),a=t.getDate();if(isNaN(a))return r;var s=e.toLowerCase();if(s.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(s=s.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),s.length>3&&WU.indexOf(s)==-1)return r}else if(s.match(/[a-z]/))return r;return n<0||n>8099?r:(i>0||a>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}function Bt(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return nr?n=qs(r):n=hU(r),gr.utils.cfb_add(e,t,n)}gr.utils.cfb_add(e,t,r)}else e.file(t,r)}function Cv(){return gr.utils.cfb_new()}var ln=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,qU={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Ov=kv(qU),Lv=/[&<>'"]/g,HU=/[\u0000-\u0008\u000b-\u001f]/g;function hr(e){var t=e+"";return t.replace(Lv,function(r){return Ov[r]}).replace(HU,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function z5(e){return hr(e).replace(/ /g,"_x0020_")}var GA=/[\u0000-\u001f]/g;function GU(e){var t=e+"";return t.replace(Lv,function(r){return Ov[r]}).replace(/\n/g,"<br/>").replace(GA,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function VU(e){var t=e+"";return t.replace(Lv,function(r){return Ov[r]}).replace(GA,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}function KU(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function YU(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function W1(e){for(var t="",r=0,n=0,i=0,a=0,s=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(i=e.charCodeAt(r++),n>191&&n<224){s=(n&31)<<6,s|=i&63,t+=String.fromCharCode(s);continue}if(a=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(i&63)<<6|a&63);continue}s=e.charCodeAt(r++),o=((n&7)<<18|(i&63)<<12|(a&63)<<6|s&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function W5(e){var t=Nl(2*e.length),r,n,i=1,a=0,s=0,o;for(n=0;n<e.length;n+=i)i=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),i=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),i=3):(i=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,s=55296+(r>>>10&1023),r=56320+(r&1023)),s!==0&&(t[a++]=s&255,t[a++]=s>>>8,s=0),t[a++]=r%256,t[a++]=r>>>8;return t.slice(0,a).toString("ucs2")}function q5(e){return qs(e,"binary").toString("utf8")}var th="foo bar baz√¢¬ò¬É√∞¬ü¬ç¬£",lf=nr&&(q5(th)==W1(th)&&q5||W5(th)==W1(th)&&W5)||W1,Of=nr?function(e){return qs(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,i=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,i=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},XU=function(){var e=[["nbsp"," "],["middot","¬∑"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)n=n.replace(e[i][0],e[i][1]);return n}}(),VA=/(^\s|\s$|\n)/;function Rn(e,t){return"<"+e+(t.match(VA)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function Lf(e){return Un(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Ye(e,t,r){return"<"+e+(r!=null?Lf(r):"")+(t!=null?(t.match(VA)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function gg(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function ZU(e,t){switch(typeof e){case"string":var r=Ye("vt:lpwstr",hr(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return Ye((e|0)==e?"vt:i4":"vt:r8",hr(String(e)));case"boolean":return Ye("vt:bool",e?"true":"false")}if(e instanceof Date)return Ye("vt:filetime",gg(e));throw new Error("Unable to serialize "+e)}var _n={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",mx:"http://schemas.microsoft.com/office/mac/excel/2008/main",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",sjs:"http://schemas.openxmlformats.org/package/2006/sheetjs/core-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},iu=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Fi={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function JU(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,a=5;a>=0;--a)i=i*256+e[t+a];return n==2047?i==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,i+=Math.pow(2,52)),r*Math.pow(2,n-52)*i)}function QU(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,i=0,a=0,s=n?-t:t;isFinite(s)?s==0?i=a=0:(i=Math.floor(Math.log(s)/Math.LN2),a=s*Math.pow(2,52-i),i<=-1023&&(!isFinite(a)||a<Math.pow(2,52))?i=-1022:(a-=Math.pow(2,52),i+=1023)):(i=2047,a=isNaN(t)?26985:0);for(var o=0;o<=5;++o,a/=256)e[r+o]=a&255;e[r+6]=(i&15)<<4|a&15,e[r+7]=i>>4|n}var H5=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var i=0,a=e[0][n].length;i<a;i+=r)t.push.apply(t,e[0][n].slice(i,i+r));return t},G5=nr?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:qs(t)})):H5(e)}:H5,V5=function(e,t,r){for(var n=[],i=t;i<r;i+=2)n.push(String.fromCharCode(ef(e,i)));return n.join("").replace(of,"")},Fv=nr?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(of,""):V5(e,t,r)}:V5,K5=function(e,t,r){for(var n=[],i=t;i<t+r;++i)n.push(("0"+e[i].toString(16)).slice(-2));return n.join("")},KA=nr?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):K5(e,t,r)}:K5,Y5=function(e,t,r){for(var n=[],i=t;i<r;i++)n.push(String.fromCharCode(oc(e,i)));return n.join("")},o0=nr?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Y5(t,r,n)}:Y5,YA=function(e,t){var r=Di(e,t);return r>0?o0(e,t+4,t+4+r-1):""},XA=YA,ZA=function(e,t){var r=Di(e,t);return r>0?o0(e,t+4,t+4+r-1):""},JA=ZA,QA=function(e,t){var r=2*Di(e,t);return r>0?o0(e,t+4,t+4+r-1):""},e6=QA,t6=function(t,r){var n=Di(t,r);return n>0?Fv(t,r+4,r+4+n):""},r6=t6,n6=function(e,t){var r=Di(e,t);return r>0?o0(e,t+4,t+4+r):""},i6=n6,a6=function(e,t){return JU(e,t)},hd=a6,Dv=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};nr&&(XA=function(t,r){if(!Buffer.isBuffer(t))return YA(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},JA=function(t,r){if(!Buffer.isBuffer(t))return ZA(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},e6=function(t,r){if(!Buffer.isBuffer(t))return QA(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},r6=function(t,r){if(!Buffer.isBuffer(t))return t6(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},i6=function(t,r){if(!Buffer.isBuffer(t))return n6(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},hd=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):a6(t,r)},Dv=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var oc=function(e,t){return e[t]},ef=function(e,t){return e[t+1]*256+e[t]},e$=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Di=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},tl=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},t$=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function cf(e,t){var r="",n,i,a=[],s,o,l,c;switch(t){case"dbcs":if(c=this.l,nr&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(ef(this,c)),c+=2;e*=2;break;case"utf8":r=o0(this,this.l,this.l+e);break;case"utf16le":e*=2,r=Fv(this,this.l,this.l+e);break;case"wstr":return cf.call(this,e,"dbcs");case"lpstr-ansi":r=XA(this,this.l),e=4+Di(this,this.l);break;case"lpstr-cp":r=JA(this,this.l),e=4+Di(this,this.l);break;case"lpwstr":r=e6(this,this.l),e=4+2*Di(this,this.l);break;case"lpp4":e=4+Di(this,this.l),r=r6(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Di(this,this.l),r=i6(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(s=oc(this,this.l+e++))!==0;)a.push(J0(s));r=a.join("");break;case"_wstr":for(e=0,r="";(s=ef(this,this.l+e))!==0;)a.push(J0(s)),e+=2;e+=2,r=a.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=oc(this,c),this.l=c+1,o=cf.call(this,e-l,s?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(J0(ef(this,c))),c+=2}r=a.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return s=oc(this,c),this.l=c+1,o=cf.call(this,e-l,s?"dbcs-cont":"sbcs-cont"),a.join("")+o;a.push(J0(oc(this,c))),c+=1}r=a.join("");break;default:switch(e){case 1:return n=oc(this,this.l),this.l++,n;case 2:return n=(t==="i"?e$:ef)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?tl:t$)(this,this.l),this.l+=4,n):(i=Di(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=hd(this,this.l):i=hd([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:r=KA(this,this.l,e);break}}return this.l+=e,r}var r$=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},n$=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},i$=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function a$(e,t,r){var n=0,i=0;if(r==="dbcs"){for(i=0;i!=t.length;++i)i$(this,t.charCodeAt(i),this.l+2*i);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;n=t.length}else if(r==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(r==="utf16le"){var a=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var s=t.charCodeAt(i);this[this.l++]=s&255,this[this.l++]=s>>8}for(;this.l<a;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,r$(this,t,this.l);break;case 8:if(n=8,r==="f"){QU(this,t,this.l);break}case 16:break;case-4:n=4,n$(this,t,this.l);break}return this.l+=n,this}function s6(e,t){var r=KA(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function Li(e,t){e.l=t,e.read_shift=cf,e.chk=s6,e.write_shift=a$}function as(e,t){e.l+=t}function Oe(e){var t=Nl(e);return Li(t,0),t}function vi(){var e=[],t=nr?256:2048,r=function(c){var u=Oe(c);return Li(u,0),u},n=r(t),i=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},a=function(c){return n&&c<n.length-n.l?n:(i(),n=r(Math.max(c+1,t)))},s=function(){return i(),Mn(e)},o=function(c){i(),n=c,n.l==null&&(n.l=n.length),a(t)};return{next:a,push:o,end:s,_bufs:e}}function $e(e,t,r,n){var i=+t,a;if(!isNaN(i)){n||(n=JG[i].p||(r||[]).length||0),a=1+(i>=128?1:0)+1,n>=128&&++a,n>=16384&&++a,n>=2097152&&++a;var s=e.next(a);i<=127?s.write_shift(1,i):(s.write_shift(1,(i&127)+128),s.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(n>=128)s.write_shift(1,(n&127)+128),n>>=7;else{s.write_shift(1,n);break}n>0&&Dv(r)&&e.push(r)}}function uf(e,t,r){var n=yi(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function X5(e,t,r){var n=yi(e);return n.s=uf(n.s,t.s,r),n.e=uf(n.e,t.s,r),n}function ff(e,t){if(e.cRel&&e.c<0)for(e=yi(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=yi(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=dr(e);return!e.cRel&&e.cRel!=null&&(r=l$(r)),!e.rRel&&e.rRel!=null&&(r=s$(r)),r}function q1(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+Yn(e.s.c)+":"+(e.e.cRel?"":"$")+Yn(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Bn(e.s.r)+":"+(e.e.rRel?"":"$")+Bn(e.e.r):ff(e.s,t.biff)+":"+ff(e.e,t.biff)}function Iv(e){return parseInt(o$(e),10)-1}function Bn(e){return""+(e+1)}function s$(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function o$(e){return e.replace(/\$(\d+)$/,"$1")}function Mv(e){for(var t=c$(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function Yn(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function l$(e){return e.replace(/^([A-Z])/,"$$$1")}function c$(e){return e.replace(/^\$([A-Z])/,"$1")}function u$(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Nn(e){for(var t=0,r=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(r=26*r+(i-64))}return{c:r-1,r:t-1}}function dr(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function qi(e){var t=e.indexOf(":");return t==-1?{s:Nn(e),e:Nn(e)}:{s:Nn(e.slice(0,t)),e:Nn(e.slice(t+1))}}function on(e,t){return typeof t>"u"||typeof t=="number"?on(e.s,e.e):(typeof e!="string"&&(e=dr(e)),typeof t!="string"&&(t=dr(t)),e==t?e:e+":"+t)}function jr(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,i=0,a=e.length;for(r=0;n<a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.s.c=--r,r=0;n<a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;if(t.s.r=--r,n===a||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=a&&!((i=e.charCodeAt(n)-64)<1||i>26);++n)r=26*r+i;for(t.e.c=--r,r=0;n!=a&&!((i=e.charCodeAt(n)-48)<0||i>9);++n)r=10*r+i;return t.e.r=--r,t}function Z5(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=Eo(e.z,r?xi(t):t)}catch{}try{return e.w=Eo((e.XF||{}).numFmtId||(r?14:0),r?xi(t):t)}catch{return""+t}}function Bs(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?l0[e.v]||e.v:t==null?Z5(e,e.v):Z5(e,t))}function Ll(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function o6(e,t,r){var n=r||{},i=e?Array.isArray(e):n.dense,a=e||(i?[]:{}),s=0,o=0;if(a&&n.origin!=null){if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?Nn(n.origin):n.origin;s=l.r,o=l.c}a["!ref"]||(a["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(a["!ref"]){var u=jr(a["!ref"]);c.s.c=u.s.c,c.s.r=u.s.r,c.e.c=Math.max(c.e.c,u.e.c),c.e.r=Math.max(c.e.r,u.e.r),s==-1&&(c.e.r=s=u.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=t[h].length;++p)if(!(typeof t[h][p]>"u")){var d={v:t[h][p]},v=s+h,g=o+p;if(c.s.r>v&&(c.s.r=v),c.s.c>g&&(c.s.c=g),c.e.r<v&&(c.e.r=v),c.e.c<g&&(c.e.c=g),t[h][p]&&typeof t[h][p]=="object"&&!Array.isArray(t[h][p])&&!(t[h][p]instanceof Date))d=t[h][p];else if(Array.isArray(d.v)&&(d.f=t[h][p][1],d.v=d.v[0]),d.v===null)if(d.f)d.t="n";else if(n.nullError)d.t="e",d.v=0;else if(n.sheetStubs)d.t="z";else continue;else typeof d.v=="number"?d.t="n":typeof d.v=="boolean"?d.t="b":d.v instanceof Date?(d.z=n.dateNF||zr[14],n.cellDates?(d.t="d",d.w=Eo(d.z,xi(d.v))):(d.t="n",d.v=xi(d.v),d.w=Eo(d.z,d.v))):d.t="s";if(i)a[v]||(a[v]=[]),a[v][g]&&a[v][g].z&&(d.z=a[v][g].z),a[v][g]=d;else{var y=dr({c:g,r:v});a[y]&&a[y].z&&(d.z=a[y].z),a[y]=d}}}return c.s.c<1e7&&(a["!ref"]=on(c)),a}function au(e,t){return o6(null,e,t)}function f$(e){return e.read_shift(4,"i")}function ka(e,t){return t||(t=Oe(4)),t.write_shift(4,e),t}function Xn(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function Sn(e,t){var r=!1;return t==null&&(r=!0,t=Oe(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function h$(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function d$(e,t){return t||(t=Oe(4)),t.write_shift(2,0),t.write_shift(2,0),t}function Rv(e,t){var r=e.l,n=e.read_shift(1),i=Xn(e),a=[],s={t:i,h:i};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)a.push(h$(e));s.r=a}else s.r=[{ich:0,ifnt:0}];return e.l=r+t,s}function p$(e,t){var r=!1;return t==null&&(r=!0,t=Oe(15+4*e.t.length)),t.write_shift(1,0),Sn(e.t,t),r?t.slice(0,t.l):t}var m$=Rv;function g$(e,t){var r=!1;return t==null&&(r=!0,t=Oe(23+4*e.t.length)),t.write_shift(1,1),Sn(e.t,t),t.write_shift(4,1),d$({ich:0,ifnt:0},t),r?t.slice(0,t.l):t}function ha(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function Fl(e,t){return t==null&&(t=Oe(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Dl(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Il(e,t){return t==null&&(t=Oe(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var v$=Xn,l6=Sn;function Bv(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function dd(e,t){var r=!1;return t==null&&(r=!0,t=Oe(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var x$=Xn,vg=Bv,Uv=dd;function c6(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var i=n===0?hd([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):tl(t,0)>>2;return r?i/100:i}function u6(e,t){t==null&&(t=Oe(4));var r=0,n=0,i=e*100;if(e==(e|0)&&e>=-(1<<29)&&e<1<<29?n=1:i==(i|0)&&i>=-(1<<29)&&i<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?i:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function f6(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function y$(e,t){return t||(t=Oe(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var Ml=f6,su=y$;function ou(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Sl(e,t){return(t||Oe(8)).write_shift(8,e,"f")}function b$(e){var t={},r=e.read_shift(1),n=r>>>1,i=e.read_shift(1),a=e.read_shift(2,"i"),s=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=i;var c=j$[i];c&&(t.rgb=lw(c));break;case 2:t.rgb=lw([s,o,l]);break;case 3:t.theme=i;break}return a!=0&&(t.tint=a>0?a/32767:a/32768),t}function pd(e,t){if(t||(t=Oe(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function w$(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function _$(e,t){t||(t=Oe(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}var h6=2,Ci=3,rh=11,md=19,nh=64,N$=65,S$=71,A$=4108,E$=4126,Dn=80,J5={1:{n:"CodePage",t:h6},2:{n:"Category",t:Dn},3:{n:"PresentationFormat",t:Dn},4:{n:"ByteCount",t:Ci},5:{n:"LineCount",t:Ci},6:{n:"ParagraphCount",t:Ci},7:{n:"SlideCount",t:Ci},8:{n:"NoteCount",t:Ci},9:{n:"HiddenCount",t:Ci},10:{n:"MultimediaClipCount",t:Ci},11:{n:"ScaleCrop",t:rh},12:{n:"HeadingPairs",t:A$},13:{n:"TitlesOfParts",t:E$},14:{n:"Manager",t:Dn},15:{n:"Company",t:Dn},16:{n:"LinksUpToDate",t:rh},17:{n:"CharacterCount",t:Ci},19:{n:"SharedDoc",t:rh},22:{n:"HyperlinksChanged",t:rh},23:{n:"AppVersion",t:Ci,p:"version"},24:{n:"DigSig",t:N$},26:{n:"ContentType",t:Dn},27:{n:"ContentStatus",t:Dn},28:{n:"Language",t:Dn},29:{n:"Version",t:Dn},255:{},2147483648:{n:"Locale",t:md},2147483651:{n:"Behavior",t:md},1919054434:{}},Q5={1:{n:"CodePage",t:h6},2:{n:"Title",t:Dn},3:{n:"Subject",t:Dn},4:{n:"Author",t:Dn},5:{n:"Keywords",t:Dn},6:{n:"Comments",t:Dn},7:{n:"Template",t:Dn},8:{n:"LastAuthor",t:Dn},9:{n:"RevNumber",t:Dn},10:{n:"EditTime",t:nh},11:{n:"LastPrinted",t:nh},12:{n:"CreatedDate",t:nh},13:{n:"ModifiedDate",t:nh},14:{n:"PageCount",t:Ci},15:{n:"WordCount",t:Ci},16:{n:"CharCount",t:Ci},17:{n:"Thumbnail",t:S$},18:{n:"Application",t:Dn},19:{n:"DocSecurity",t:Ci},255:{},2147483648:{n:"Locale",t:md},2147483651:{n:"Behavior",t:md},1919054434:{}};function T$(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var P$=T$([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),j$=yi(P$),l0={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},k$={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ih={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function d6(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function p6(e,t){var r=UU(k$),n=[],i;n[n.length]=ln,n[n.length]=Ye("Types",null,{xmlns:_n.CT,"xmlns:xsd":_n.xsd,"xmlns:xsi":_n.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Ye("Default",null,{Extension:l[0],ContentType:l[1]})}));var a=function(l){e[l]&&e[l].length>0&&(i=e[l][0],n[n.length]=Ye("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:ih[l][t.bookType]||ih[l].xlsx}))},s=function(l){(e[l]||[]).forEach(function(c){n[n.length]=Ye("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:ih[l][t.bookType]||ih[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(c){n[n.length]=Ye("Override",null,{PartName:(c[0]=="/"?"":"/")+c,ContentType:r[l][0]})})};return a("workbooks"),s("sheets"),s("charts"),o("themes"),["strs","styles"].forEach(a),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),s("metadata"),o("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var Zt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function m6(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function wc(e){var t=[ln,Ye("Relationships",null,{xmlns:_n.RELS})];return Un(e["!id"]).forEach(function(r){t[t.length]=Ye("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function cr(e,t,r,n,i,a){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=n,i.Target=r,[Zt.HLINK,Zt.XPATH,Zt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}function C$(e){var t=[ln];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function ew(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function O$(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function L$(e){var t=[ln];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(ew(e[r][0],e[r][1])),t.push(O$("",e[r][0]));return t.push(ew("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function g6(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+od.version+"</meta:generator></office:meta></office:document-meta>"}var gl=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function H1(e,t,r,n,i){i[e]!=null||t==null||t===""||(i[e]=t,t=hr(t),n[n.length]=r?Ye(e,t,r):Rn(e,t))}function v6(e,t){var r=t||{},n=[ln,Ye("cp:coreProperties",null,{"xmlns:cp":_n.CORE_PROPS,"xmlns:dc":_n.dc,"xmlns:dcterms":_n.dcterms,"xmlns:dcmitype":_n.dcmitype,"xmlns:xsi":_n.xsi})],i={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&H1("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:gg(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i),e.ModifiedDate!=null&&H1("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:gg(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,i));for(var a=0;a!=gl.length;++a){var s=gl[a],o=r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:e?e[s[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&H1(s[0],o,null,n,i)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var _c=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],x6=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function y6(e){var t=[],r=Ye;return e||(e={}),e.Application="SheetJS",t[t.length]=ln,t[t.length]=Ye("Properties",null,{xmlns:_n.EXT_PROPS,"xmlns:vt":_n.vt}),_c.forEach(function(n){if(e[n[1]]!==void 0){var i;switch(n[2]){case"string":i=hr(String(e[n[1]]));break;case"bool":i=e[n[1]]?"true":"false";break}i!==void 0&&(t[t.length]=r(n[0],i))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+hr(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}function b6(e){var t=[ln,Ye("Properties",null,{xmlns:_n.CUST_PROPS,"xmlns:vt":_n.vt})];if(!e)return t.join("");var r=1;return Un(e).forEach(function(i){++r,t[t.length]=Ye("property",ZU(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:hr(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var tw={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function F$(e,t){var r=[];return Un(tw).map(function(n){for(var i=0;i<gl.length;++i)if(gl[i][1]==n)return gl[i];for(i=0;i<_c.length;++i)if(_c[i][1]==n)return _c[i];throw n}).forEach(function(n){if(e[n[1]]!=null){var i=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),r.push(Rn(tw[n[1]]||n[1],i))}}),Ye("DocumentProperties",r.join(""),{xmlns:Fi.o})}function D$(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",i=[];return e&&Un(e).forEach(function(a){if(Object.prototype.hasOwnProperty.call(e,a)){for(var s=0;s<gl.length;++s)if(a==gl[s][1])return;for(s=0;s<_c.length;++s)if(a==_c[s][1])return;for(s=0;s<r.length;++s)if(a==r[s])return;var o=e[a],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(Ye(z5(a),o,{"dt:dt":l}))}}),t&&Un(t).forEach(function(a){if(Object.prototype.hasOwnProperty.call(t,a)&&!(e&&Object.prototype.hasOwnProperty.call(e,a))){var s=t[a],o="string";typeof s=="number"?(o="float",s=String(s)):s===!0||s===!1?(o="boolean",s=s?"1":"0"):s instanceof Date?(o="dateTime.tz",s=s.toISOString()):s=String(s),i.push(Ye(z5(a),s,{"dt:dt":o}))}}),"<"+n+' xmlns="'+Fi.o+'">'+i.join("")+"</"+n+">"}function I$(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),i=(r-n)/Math.pow(2,32);n*=1e7,i*=1e7;var a=n/Math.pow(2,32)|0;a>0&&(n=n%Math.pow(2,32),i+=a);var s=Oe(8);return s.write_shift(4,n),s.write_shift(4,i),s}function rw(e,t){var r=Oe(4),n=Oe(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=Oe(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=I$(t);break;case 31:case 80:for(n=Oe(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Mn([r,n])}var w6=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function M$(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function nw(e,t,r){var n=Oe(8),i=[],a=[],s=8,o=0,l=Oe(8),c=Oe(8);if(l.write_shift(4,2),l.write_shift(4,1200),c.write_shift(4,1),a.push(l),i.push(c),s+=8+l.length,!t){c=Oe(8),c.write_shift(4,0),i.unshift(c);var u=[Oe(4)];for(u[0].write_shift(4,e.length),o=0;o<e.length;++o){var h=e[o][0];for(l=Oe(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);u.push(l)}l=Mn(u),a.unshift(l),s+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(w6.indexOf(e[o][0])>-1||x6.indexOf(e[o][0])>-1)&&e[o][1]!=null){var p=e[o][1],d=0;if(t){d=+t[e[o][0]];var v=r[d];if(v.p=="version"&&typeof p=="string"){var g=p.split(".");p=(+g[0]<<16)+(+g[1]||0)}l=rw(v.t,p)}else{var y=M$(p);y==-1&&(y=31,p=String(p)),l=rw(y,p)}a.push(l),c=Oe(8),c.write_shift(4,t?d:2+o),i.push(c),s+=8+l.length}var b=8*(a.length+1);for(o=0;o<a.length;++o)i[o].write_shift(4,b),b+=a[o].length;return n.write_shift(4,s),n.write_shift(4,a.length),Mn([n].concat(i).concat(a))}function iw(e,t,r,n,i,a){var s=Oe(i?68:48),o=[s];s.write_shift(2,65534),s.write_shift(2,0),s.write_shift(4,842412599),s.write_shift(16,gr.utils.consts.HEADER_CLSID,"hex"),s.write_shift(4,i?2:1),s.write_shift(16,t,"hex"),s.write_shift(4,i?68:48);var l=nw(e,r,n);if(o.push(l),i){var c=nw(i,null,null);s.write_shift(16,a,"hex"),s.write_shift(4,68+l.length),o.push(c)}return Mn(o)}function R$(e,t){t||(t=Oe(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function B$(e,t){return e.read_shift(t)===1}function ii(e,t){return t||(t=Oe(2)),t.write_shift(2,+!!e),t}function _6(e){return e.read_shift(2,"u")}function na(e,t){return t||(t=Oe(2)),t.write_shift(2,e),t}function N6(e,t,r){return r||(r=Oe(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function S6(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),i="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var a=e.read_shift(1);a&&(i="dbcs-cont")}else r.biff==12&&(i="wstr");r.biff>=2&&r.biff<=5&&(i="cpstr");var s=n?e.read_shift(n,i):"";return s}function U$(e){var t=e.t||"",r=Oe(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=Oe(2*t.length);n.write_shift(2*t.length,t,"utf16le");var i=[r,n];return Mn(i)}function $$(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function z$(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):$$(e,n,r)}function W$(e,t,r){if(r.biff>5)return z$(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function A6(e,t,r){return r||(r=Oe(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function aw(e,t){t||(t=Oe(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function q$(e){var t=Oe(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var i=n.indexOf("#"),a=i>-1?31:23;switch(n.charAt(0)){case"#":a=28;break;case".":a&=-3;break}t.write_shift(4,2),t.write_shift(4,a);var s=[8,6815827,6619237,4849780,83];for(r=0;r<s.length;++r)t.write_shift(4,s[r]);if(a==28)n=n.slice(1),aw(n,t);else if(a&2){for(s="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));var o=i>-1?n.slice(0,i):n;for(t.write_shift(4,2*(o.length+1)),r=0;r<o.length;++r)t.write_shift(2,o.charCodeAt(r));t.write_shift(2,0),a&8&&aw(i>-1?n.slice(i+1):"",t)}else{for(s="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<s.length;++r)t.write_shift(1,parseInt(s[r],16));for(var l=0;n.slice(l*3,l*3+3)=="../"||n.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,n.length-3*l+1),r=0;r<n.length-3*l;++r)t.write_shift(1,n.charCodeAt(r+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function Al(e,t,r,n){return n||(n=Oe(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function H$(e,t,r){var n=r.biff>8?4:2,i=e.read_shift(n),a=e.read_shift(n,"i"),s=e.read_shift(n,"i");return[i,a,s]}function G$(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2);return{s:{c:n,r:t},e:{c:i,r}}}function E6(e,t){return t||(t=Oe(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function $v(e,t,r){var n=1536,i=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,i=8;break;case"biff4":n=4,i=6;break;case"biff3":n=3,i=6;break;case"biff2":n=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var a=Oe(i);return a.write_shift(2,n),a.write_shift(2,t),i>4&&a.write_shift(2,29282),i>6&&a.write_shift(2,1997),i>8&&(a.write_shift(2,49161),a.write_shift(2,1),a.write_shift(2,1798),a.write_shift(2,0)),a}function V$(e,t){var r=!t||t.biff==8,n=Oe(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function K$(e,t){var r=!t||t.biff>=8?2:1,n=Oe(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=n.slice(0,n.l);return i.l=n.l,i}function Y$(e,t){var r=Oe(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],i=0;i<e.length;++i)n[i]=U$(e[i]);var a=Mn([r].concat(n));return a.parts=[r.length].concat(n.map(function(s){return s.length})),a}function X$(){var e=Oe(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function Z$(e){var t=Oe(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function J$(e,t){var r=e.name||"Arial",n=t&&t.biff==5,i=n?15+r.length:16+2*r.length,a=Oe(i);return a.write_shift(2,(e.sz||12)*20),a.write_shift(4,0),a.write_shift(2,400),a.write_shift(4,0),a.write_shift(2,0),a.write_shift(1,r.length),n||a.write_shift(1,1),a.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),a}function Q$(e,t,r,n){var i=Oe(10);return Al(e,t,n,i),i.write_shift(4,r),i}function ez(e,t,r,n,i){var a=!i||i.biff==8,s=Oe(8+ +a+(1+a)*r.length);return Al(e,t,n,s),s.write_shift(2,r.length),a&&s.write_shift(1,1),s.write_shift((1+a)*r.length,r,a?"utf16le":"sbcs"),s}function tz(e,t,r,n){var i=r&&r.biff==5;n||(n=Oe(i?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(i?1:2,t.length),i||n.write_shift(1,1),n.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var a=n.length>n.l?n.slice(0,n.l):n;return a.l==null&&(a.l=a.length),a}function rz(e,t){var r=t.biff==8||!t.biff?4:2,n=Oe(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function sw(e,t,r,n){var i=r&&r.biff==5;n||(n=Oe(i?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var a=0;return e.numFmtId>0&&i&&(a|=1024),n.write_shift(4,a),n.write_shift(4,0),i||n.write_shift(4,0),n.write_shift(2,0),n}function nz(e){var t=Oe(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function iz(e,t,r,n,i,a){var s=Oe(8);return Al(e,t,n,s),N6(r,a,s),s}function az(e,t,r,n){var i=Oe(14);return Al(e,t,n,i),Sl(r,i),i}function sz(e,t,r){if(r.biff<8)return oz(e,t,r);for(var n=[],i=e.l+t,a=e.read_shift(r.biff>8?4:2);a--!==0;)n.push(H$(e,r.biff>8?12:6,r));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return n}function oz(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=S6(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function lz(e){var t=Oe(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)E6(e[r],t);return t}function cz(e){var t=Oe(24),r=Nn(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(n[i],16));return Mn([t,q$(e[1])])}function uz(e){var t=e[1].Tooltip,r=Oe(10+2*(t.length+1));r.write_shift(2,2048);var n=Nn(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var i=0;i<t.length;++i)r.write_shift(2,t.charCodeAt(i));return r.write_shift(2,0),r}function fz(e){return e||(e=Oe(4)),e.write_shift(2,1),e.write_shift(2,1),e}function hz(e,t,r){if(!r.cellStyles)return as(e,t);var n=r&&r.biff>=12?4:2,i=e.read_shift(n),a=e.read_shift(n),s=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:i,e:a,w:s,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function dz(e,t){var r=Oe(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function pz(e){for(var t=Oe(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}function mz(e,t,r){var n=Oe(15);return u0(n,e,t),n.write_shift(8,r,"f"),n}function gz(e,t,r){var n=Oe(9);return u0(n,e,t),n.write_shift(2,r),n}var vz=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=kv({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],u=Nl(1);switch(l.type){case"base64":u=Ta(Rs(o));break;case"binary":u=Ta(o);break;case"buffer":case"array":u=o;break}Li(u,0);var h=u.read_shift(1),p=!!(h&136),d=!1,v=!1;switch(h){case 2:break;case 3:break;case 48:d=!0,p=!0;break;case 49:d=!0,p=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var g=0,y=521;h==2&&(g=u.read_shift(2)),u.l+=3,h!=2&&(g=u.read_shift(4)),g>1048576&&(g=1e6),h!=2&&(y=u.read_shift(2));var b=u.read_shift(2),E=l.codepage||1252;h!=2&&(u.l+=16,u.read_shift(1),u[u.l]!==0&&(E=e[u[u.l]]),u.l+=1,u.l+=2),v&&(u.l+=36);for(var S=[],P={},L=Math.min(u.length,h==2?521:y-10-(d?264:0)),q=v?32:11;u.l<L&&u[u.l]!=13;)switch(P={},P.name=el.utils.decode(E,u.slice(u.l,u.l+q)).replace(/[\u0000\r\n].*$/g,""),u.l+=q,P.type=String.fromCharCode(u.read_shift(1)),h!=2&&!v&&(P.offset=u.read_shift(4)),P.len=u.read_shift(1),h==2&&(P.offset=u.read_shift(2)),P.dec=u.read_shift(1),P.name.length&&S.push(P),h!=2&&(u.l+=v?13:14),P.type){case"B":(!d||P.len!=8)&&l.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+P.name+":"+P.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+P.type)}if(u[u.l]!==13&&(u.l=y-1),u.read_shift(1)!==13)throw new Error("DBF Terminator not found "+u.l+" "+u[u.l]);u.l=y;var C=0,R=0;for(c[0]=[],R=0;R!=S.length;++R)c[0][R]=S[R].name;for(;g-- >0;){if(u[u.l]===42){u.l+=b;continue}for(++u.l,c[++C]=[],R=0,R=0;R!=S.length;++R){var k=u.slice(u.l,u.l+S[R].len);u.l+=S[R].len,Li(k,0);var G=el.utils.decode(E,k);switch(S[R].type){case"C":G.trim().length&&(c[C][R]=G.replace(/\s+$/,""));break;case"D":G.length===8?c[C][R]=new Date(+G.slice(0,4),+G.slice(4,6)-1,+G.slice(6,8)):c[C][R]=G;break;case"F":c[C][R]=parseFloat(G.trim());break;case"+":case"I":c[C][R]=v?k.read_shift(-4,"i")^2147483648:k.read_shift(4,"i");break;case"L":switch(G.trim().toUpperCase()){case"Y":case"T":c[C][R]=!0;break;case"N":case"F":c[C][R]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+G+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));c[C][R]="##MEMO##"+(v?parseInt(G.trim(),10):k.read_shift(4));break;case"N":G=G.replace(/\u0000/g,"").trim(),G&&G!="."&&(c[C][R]=+G||0);break;case"@":c[C][R]=new Date(k.read_shift(-8,"f")-621356832e5);break;case"T":c[C][R]=new Date((k.read_shift(4)-2440588)*864e5+k.read_shift(4));break;case"Y":c[C][R]=k.read_shift(4,"i")/1e4+k.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[C][R]=-k.read_shift(-8,"f");break;case"B":if(d&&S[R].len==8){c[C][R]=k.read_shift(8,"f");break}case"G":case"P":k.l+=S[R].len;break;case"0":if(S[R].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+S[R].type)}}}if(h!=2&&u.l<u.length&&u[u.l++]!=26)throw new Error("DBF EOF Marker missing "+(u.l-1)+" of "+u.length+" "+u[u.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=S,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var u=au(r(o,c),c);return u["!cols"]=c.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete c.DBF,u}function i(o,l){try{return Ll(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var a={B:8,C:250,L:1,D:8,"?":0,"":0};function s(o,l){var c=l||{};if(+c.codepage>=0&&jf(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var u=vi(),h=bd(o,{header:1,raw:!0,cellDates:!0}),p=h[0],d=h.slice(1),v=o["!cols"]||[],g=0,y=0,b=0,E=1;for(g=0;g<p.length;++g){if(((v[g]||{}).DBF||{}).name){p[g]=v[g].DBF.name,++b;continue}if(p[g]!=null){if(++b,typeof p[g]=="number"&&(p[g]=p[g].toString(10)),typeof p[g]!="string")throw new Error("DBF Invalid column name "+p[g]+" |"+typeof p[g]+"|");if(p.indexOf(p[g])!==g){for(y=0;y<1024;++y)if(p.indexOf(p[g]+"_"+y)==-1){p[g]+="_"+y;break}}}}var S=jr(o["!ref"]),P=[],L=[],q=[];for(g=0;g<=S.e.c-S.s.c;++g){var C="",R="",k=0,G=[];for(y=0;y<d.length;++y)d[y][g]!=null&&G.push(d[y][g]);if(G.length==0||p[g]==null){P[g]="?";continue}for(y=0;y<G.length;++y){switch(typeof G[y]){case"number":R="B";break;case"string":R="C";break;case"boolean":R="L";break;case"object":R=G[y]instanceof Date?"D":"C";break;default:R="C"}k=Math.max(k,String(G[y]).length),C=C&&C!=R?"C":R}k>250&&(k=250),R=((v[g]||{}).DBF||{}).type,R=="C"&&v[g].DBF.len>k&&(k=v[g].DBF.len),C=="B"&&R=="N"&&(C="N",q[g]=v[g].DBF.dec,k=v[g].DBF.len),L[g]=C=="C"||R=="N"?k:a[C]||0,E+=L[g],P[g]=C}var _=u.next(32);for(_.write_shift(4,318902576),_.write_shift(4,d.length),_.write_shift(2,296+32*b),_.write_shift(2,E),g=0;g<4;++g)_.write_shift(4,0);for(_.write_shift(4,0|(+t[PA]||3)<<8),g=0,y=0;g<p.length;++g)if(p[g]!=null){var j=u.next(32),H=(p[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);j.write_shift(1,H,"sbcs"),j.write_shift(1,P[g]=="?"?"C":P[g],"sbcs"),j.write_shift(4,y),j.write_shift(1,L[g]||a[P[g]]||0),j.write_shift(1,q[g]||0),j.write_shift(1,2),j.write_shift(4,0),j.write_shift(1,0),j.write_shift(4,0),j.write_shift(4,0),y+=L[g]||a[P[g]]||0}var X=u.next(264);for(X.write_shift(4,13),g=0;g<65;++g)X.write_shift(4,0);for(g=0;g<d.length;++g){var ce=u.next(E);for(ce.write_shift(1,0),y=0;y<p.length;++y)if(p[y]!=null)switch(P[y]){case"L":ce.write_shift(1,d[g][y]==null?63:d[g][y]?84:70);break;case"B":ce.write_shift(8,d[g][y]||0,"f");break;case"N":var pe="0";for(typeof d[g][y]=="number"&&(pe=d[g][y].toFixed(q[y]||0)),b=0;b<L[y]-pe.length;++b)ce.write_shift(1,32);ce.write_shift(1,pe,"sbcs");break;case"D":d[g][y]?(ce.write_shift(4,("0000"+d[g][y].getFullYear()).slice(-4),"sbcs"),ce.write_shift(2,("00"+(d[g][y].getMonth()+1)).slice(-2),"sbcs"),ce.write_shift(2,("00"+d[g][y].getDate()).slice(-2),"sbcs")):ce.write_shift(8,"00000000","sbcs");break;case"C":var ye=String(d[g][y]!=null?d[g][y]:"").slice(0,L[y]);for(ce.write_shift(1,ye,"sbcs"),b=0;b<L[y]-ye.length;++b)ce.write_shift(1,32);break}}return u.next(1).write_shift(1,26),u.end()}return{to_workbook:i,to_sheet:n,from_sheet:s}}(),xz=function(){var e={AA:"√Ä",BA:"√Å",CA:"√Ç",DA:195,HA:"√Ñ",JA:197,AE:"√à",BE:"√â",CE:"√ä",HE:"√ã",AI:"√å",BI:"√ç",CI:"√é",HI:"√è",AO:"√í",BO:"√ì",CO:"√î",DO:213,HO:"√ñ",AU:"√ô",BU:"√ö",CU:"√õ",HU:"√ú",Aa:"√†",Ba:"√°",Ca:"√¢",Da:227,Ha:"√§",Ja:229,Ae:"√®",Be:"√©",Ce:"√™",He:"√´",Ai:"√¨",Bi:"√≠",Ci:"√Æ",Hi:"√Ø",Ao:"√≤",Bo:"√≥",Co:"√¥",Do:245,Ho:"√∂",Au:"√π",Bu:"√∫",Cu:"√ª",Hu:"√º",KC:"√á",Kc:"√ß",q:"√¶",z:"≈ì",a:"√Ü",j:"≈í",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Un(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(p,d){var v=e[d];return typeof v=="number"?k5(v):v},n=function(p,d,v){var g=d.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return g==59?p:k5(g)};e["|"]=254;function i(p,d){switch(d.type){case"base64":return a(Rs(p),d);case"binary":return a(p,d);case"buffer":return a(nr&&Buffer.isBuffer(p)?p.toString("binary"):a0(p),d);case"array":return a(Ap(p),d)}throw new Error("Unrecognized type "+d.type)}function a(p,d){var v=p.split(/[\n\r]+/),g=-1,y=-1,b=0,E=0,S=[],P=[],L=null,q={},C=[],R=[],k=[],G=0,_;for(+d.codepage>=0&&jf(+d.codepage);b!==v.length;++b){G=0;var j=v[b].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),H=j.replace(/;;/g,"\0").split(";").map(function(M){return M.replace(/\u0000/g,";")}),X=H[0],ce;if(j.length>0)switch(X){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":H[1].charAt(0)=="P"&&P.push(j.slice(3).replace(/;;/g,";"));break;case"C":var pe=!1,ye=!1,me=!1,be=!1,Ue=-1,Fe=-1;for(E=1;E<H.length;++E)switch(H[E].charAt(0)){case"A":break;case"X":y=parseInt(H[E].slice(1))-1,ye=!0;break;case"Y":for(g=parseInt(H[E].slice(1))-1,ye||(y=0),_=S.length;_<=g;++_)S[_]=[];break;case"K":ce=H[E].slice(1),ce.charAt(0)==='"'?ce=ce.slice(1,ce.length-1):ce==="TRUE"?ce=!0:ce==="FALSE"?ce=!1:isNaN(ks(ce))?isNaN(Cf(ce).getDate())||(ce=oi(ce)):(ce=ks(ce),L!==null&&UA(L)&&(ce=qA(ce))),pe=!0;break;case"E":be=!0;var A=gW(H[E].slice(1),{r:g,c:y});S[g][y]=[S[g][y],A];break;case"S":me=!0,S[g][y]=[S[g][y],"S5S"];break;case"G":break;case"R":Ue=parseInt(H[E].slice(1))-1;break;case"C":Fe=parseInt(H[E].slice(1))-1;break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+j)}if(pe&&(S[g][y]&&S[g][y].length==2?S[g][y][0]=ce:S[g][y]=ce,L=null),me){if(be)throw new Error("SYLK shared formula cannot have own formula");var F=Ue>-1&&S[Ue][Fe];if(!F||!F[1])throw new Error("SYLK shared formula cannot find base");S[g][y][1]=vW(F[1],{r:g-Ue,c:y-Fe})}break;case"F":var O=0;for(E=1;E<H.length;++E)switch(H[E].charAt(0)){case"X":y=parseInt(H[E].slice(1))-1,++O;break;case"Y":for(g=parseInt(H[E].slice(1))-1,_=S.length;_<=g;++_)S[_]=[];break;case"M":G=parseInt(H[E].slice(1))/20;break;case"F":break;case"G":break;case"P":L=P[parseInt(H[E].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(k=H[E].slice(1).split(" "),_=parseInt(k[0],10);_<=parseInt(k[1],10);++_)G=parseInt(k[2],10),R[_-1]=G===0?{hidden:!0}:{wch:G},zv(R[_-1]);break;case"C":y=parseInt(H[E].slice(1))-1,R[y]||(R[y]={});break;case"R":g=parseInt(H[E].slice(1))-1,C[g]||(C[g]={}),G>0?(C[g].hpt=G,C[g].hpx=C6(G)):G===0&&(C[g].hidden=!0);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+j)}O<1&&(L=null);break;default:if(d&&d.WTF)throw new Error("SYLK bad record "+j)}}return C.length>0&&(q["!rows"]=C),R.length>0&&(q["!cols"]=R),d&&d.sheetRows&&(S=S.slice(0,d.sheetRows)),[S,q]}function s(p,d){var v=i(p,d),g=v[0],y=v[1],b=au(g,d);return Un(y).forEach(function(E){b[E]=y[E]}),b}function o(p,d){return Ll(s(p,d),d)}function l(p,d,v,g){var y="C;Y"+(v+1)+";X"+(g+1)+";K";switch(p.t){case"n":y+=p.v||0,p.f&&!p.F&&(y+=";E"+qv(p.f,{r:v,c:g}));break;case"b":y+=p.v?"TRUE":"FALSE";break;case"e":y+=p.w||p.v;break;case"d":y+='"'+(p.w||p.v)+'"';break;case"s":y+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return y}function c(p,d){d.forEach(function(v,g){var y="F;W"+(g+1)+" "+(g+1)+" ";v.hidden?y+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=gd(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=vd(v.wpx)),typeof v.wch=="number"&&(y+=Math.round(v.wch))),y.charAt(y.length-1)!=" "&&p.push(y)})}function u(p,d){d.forEach(function(v,g){var y="F;";v.hidden?y+="M0;":v.hpt?y+="M"+20*v.hpt+";":v.hpx&&(y+="M"+20*xd(v.hpx)+";"),y.length>2&&p.push(y+"R"+(g+1))})}function h(p,d){var v=["ID;PWXL;N;E"],g=[],y=jr(p["!ref"]),b,E=Array.isArray(p),S=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),p["!cols"]&&c(v,p["!cols"]),p["!rows"]&&u(v,p["!rows"]),v.push("B;Y"+(y.e.r-y.s.r+1)+";X"+(y.e.c-y.s.c+1)+";D"+[y.s.c,y.s.r,y.e.c,y.e.r].join(" "));for(var P=y.s.r;P<=y.e.r;++P)for(var L=y.s.c;L<=y.e.c;++L){var q=dr({r:P,c:L});b=E?(p[P]||[])[L]:p[q],!(!b||b.v==null&&(!b.f||b.F))&&g.push(l(b,p,P,L))}return v.join(S)+S+g.join(S)+S+"E"+S}return{to_workbook:o,to_sheet:s,from_sheet:h}}(),yz=function(){function e(a,s){switch(s.type){case"base64":return t(Rs(a),s);case"binary":return t(a,s);case"buffer":return t(nr&&Buffer.isBuffer(a)?a.toString("binary"):a0(a),s);case"array":return t(Ap(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){for(var o=a.split(`
`),l=-1,c=-1,u=0,h=[];u!==o.length;++u){if(o[u].trim()==="BOT"){h[++l]=[],c=0;continue}if(!(l<0)){var p=o[u].trim().split(","),d=p[0],v=p[1];++u;for(var g=o[u]||"";(g.match(/["]/g)||[]).length&1&&u<o.length-1;)g+=`
`+o[++u];switch(g=g.trim(),+d){case-1:if(g==="BOT"){h[++l]=[],c=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?h[l][c]=!0:g==="FALSE"?h[l][c]=!1:isNaN(ks(v))?isNaN(Cf(v).getDate())?h[l][c]=v:h[l][c]=oi(v):h[l][c]=ks(v),++c;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),h[l][c++]=g!==""?g:null;break}if(g==="EOD")break}}return s&&s.sheetRows&&(h=h.slice(0,s.sheetRows)),h}function r(a,s){return au(e(a,s),s)}function n(a,s){return Ll(r(a,s),s)}var i=function(){var a=function(l,c,u,h,p){l.push(c),l.push(u+","+h),l.push('"'+p.replace(/"/g,'""')+'"')},s=function(l,c,u,h){l.push(c+","+u),l.push(c==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var c=[],u=jr(l["!ref"]),h,p=Array.isArray(l);a(c,"TABLE",0,1,"sheetjs"),a(c,"VECTORS",0,u.e.r-u.s.r+1,""),a(c,"TUPLES",0,u.e.c-u.s.c+1,""),a(c,"DATA",0,0,"");for(var d=u.s.r;d<=u.e.r;++d){s(c,-1,0,"BOT");for(var v=u.s.c;v<=u.e.c;++v){var g=dr({r:d,c:v});if(h=p?(l[d]||[])[v]:l[g],!h){s(c,1,0,"");continue}switch(h.t){case"n":var y=h.w;!y&&h.v!=null&&(y=h.v),y==null?h.f&&!h.F?s(c,1,0,"="+h.f):s(c,1,0,""):s(c,0,y,"V");break;case"b":s(c,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":s(c,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=Eo(h.z||zr[14],xi(oi(h.v)))),s(c,0,h.w,"V");break;default:s(c,1,0,"")}}}s(c,-1,0,"EOD");var b=`\r
`,E=c.join(b);return E}}();return{to_workbook:n,to_sheet:r,from_sheet:i}}(),T6=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(h,p){for(var d=h.split(`
`),v=-1,g=-1,y=0,b=[];y!==d.length;++y){var E=d[y].trim().split(":");if(E[0]==="cell"){var S=Nn(E[1]);if(b.length<=S.r)for(v=b.length;v<=S.r;++v)b[v]||(b[v]=[]);switch(v=S.r,g=S.c,E[2]){case"t":b[v][g]=e(E[3]);break;case"v":b[v][g]=+E[3];break;case"vtf":var P=E[E.length-1];case"vtc":switch(E[3]){case"nl":b[v][g]=!!+E[4];break;default:b[v][g]=+E[4];break}E[2]=="vtf"&&(b[v][g]=[b[v][g],P])}}}return p&&p.sheetRows&&(b=b.slice(0,p.sheetRows)),b}function n(h,p){return au(r(h,p),p)}function i(h,p){return Ll(n(h,p),p)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),s=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(h){if(!h||!h["!ref"])return"";for(var p=[],d=[],v,g="",y=qi(h["!ref"]),b=Array.isArray(h),E=y.s.r;E<=y.e.r;++E)for(var S=y.s.c;S<=y.e.c;++S)if(g=dr({r:E,c:S}),v=b?(h[E]||[])[S]:h[g],!(!v||v.v==null||v.t==="z")){switch(d=["cell",g,"t"],v.t){case"s":case"str":d.push(t(v.v));break;case"n":v.f?(d[2]="vtf",d[3]="n",d[4]=v.v,d[5]=t(v.f)):(d[2]="v",d[3]=v.v);break;case"b":d[2]="vt"+(v.f?"f":"c"),d[3]="nl",d[4]=v.v?"1":"0",d[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var P=xi(oi(v.v));d[2]="vtc",d[3]="nd",d[4]=""+P,d[5]=v.w||Eo(v.z||zr[14],P);break;case"e":continue}p.push(d.join(":"))}return p.push("sheet:c:"+(y.e.c-y.s.c+1)+":r:"+(y.e.r-y.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function u(h){return[a,s,o,s,c(h),l].join(`
`)}return{to_workbook:i,to_sheet:n,from_sheet:u}}(),bz=function(){function e(u,h,p,d,v){v.raw?h[p][d]=u:u===""||(u==="TRUE"?h[p][d]=!0:u==="FALSE"?h[p][d]=!1:isNaN(ks(u))?isNaN(Cf(u).getDate())?h[p][d]=u:h[p][d]=oi(u):h[p][d]=ks(u))}function t(u,h){var p=h||{},d=[];if(!u||u.length===0)return d;for(var v=u.split(/[\r\n]/),g=v.length-1;g>=0&&v[g].length===0;)--g;for(var y=10,b=0,E=0;E<=g;++E)b=v[E].indexOf(" "),b==-1?b=v[E].length:b++,y=Math.max(y,b);for(E=0;E<=g;++E){d[E]=[];var S=0;for(e(v[E].slice(0,y).trim(),d,E,S,p),S=1;S<=(v[E].length-y)/10+1;++S)e(v[E].slice(y+(S-1)*10,y+S*10).trim(),d,E,S,p)}return p.sheetRows&&(d=d.slice(0,p.sheetRows)),d}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function i(u){for(var h={},p=!1,d=0,v=0;d<u.length;++d)(v=u.charCodeAt(d))==34?p=!p:!p&&v in r&&(h[v]=(h[v]||0)+1);v=[];for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&v.push([h[d],d]);if(!v.length){h=n;for(d in h)Object.prototype.hasOwnProperty.call(h,d)&&v.push([h[d],d])}return v.sort(function(g,y){return g[0]-y[0]||n[g[1]]-n[y[1]]}),r[v.pop()[1]]||44}function a(u,h){var p=h||{},d="",v=p.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};u.slice(0,4)=="sep="?u.charCodeAt(5)==13&&u.charCodeAt(6)==10?(d=u.charAt(4),u=u.slice(7)):u.charCodeAt(5)==13||u.charCodeAt(5)==10?(d=u.charAt(4),u=u.slice(6)):d=i(u.slice(0,1024)):p&&p.FS?d=p.FS:d=i(u.slice(0,1024));var y=0,b=0,E=0,S=0,P=0,L=d.charCodeAt(0),q=!1,C=0,R=u.charCodeAt(0);u=u.replace(/\r\n/mg,`
`);var k=p.dateNF!=null?IU(p.dateNF):null;function G(){var _=u.slice(S,P),j={};if(_.charAt(0)=='"'&&_.charAt(_.length-1)=='"'&&(_=_.slice(1,-1).replace(/""/g,'"')),_.length===0)j.t="z";else if(p.raw)j.t="s",j.v=_;else if(_.trim().length===0)j.t="s",j.v=_;else if(_.charCodeAt(0)==61)_.charCodeAt(1)==34&&_.charCodeAt(_.length-1)==34?(j.t="s",j.v=_.slice(2,-1).replace(/""/g,'"')):xW(_)?(j.t="n",j.f=_.slice(1)):(j.t="s",j.v=_);else if(_=="TRUE")j.t="b",j.v=!0;else if(_=="FALSE")j.t="b",j.v=!1;else if(!isNaN(E=ks(_)))j.t="n",p.cellText!==!1&&(j.w=_),j.v=E;else if(!isNaN(Cf(_).getDate())||k&&_.match(k)){j.z=p.dateNF||zr[14];var H=0;k&&_.match(k)&&(_=MU(_,p.dateNF,_.match(k)||[]),H=1),p.cellDates?(j.t="d",j.v=oi(_,H)):(j.t="n",j.v=xi(oi(_,H))),p.cellText!==!1&&(j.w=Eo(j.z,j.v instanceof Date?xi(j.v):j.v)),p.cellNF||delete j.z}else j.t="s",j.v=_;if(j.t=="z"||(p.dense?(v[y]||(v[y]=[]),v[y][b]=j):v[dr({c:b,r:y})]=j),S=P+1,R=u.charCodeAt(S),g.e.c<b&&(g.e.c=b),g.e.r<y&&(g.e.r=y),C==L)++b;else if(b=0,++y,p.sheetRows&&p.sheetRows<=y)return!0}e:for(;P<u.length;++P)switch(C=u.charCodeAt(P)){case 34:R===34&&(q=!q);break;case L:case 10:case 13:if(!q&&G())break e;break}return P-S>0&&G(),v["!ref"]=on(g),v}function s(u,h){return!(h&&h.PRN)||h.FS||u.slice(0,4)=="sep="||u.indexOf("	")>=0||u.indexOf(",")>=0||u.indexOf(";")>=0?a(u,h):au(t(u,h),h)}function o(u,h){var p="",d=h.type=="string"?[0,0,0,0]:OV(u,h);switch(h.type){case"base64":p=Rs(u);break;case"binary":p=u;break;case"buffer":h.codepage==65001?p=u.toString("utf8"):h.codepage&&typeof el<"u"?p=el.utils.decode(h.codepage,u):p=nr&&Buffer.isBuffer(u)?u.toString("binary"):a0(u);break;case"array":p=Ap(u);break;case"string":p=u;break;default:throw new Error("Unrecognized type "+h.type)}return d[0]==239&&d[1]==187&&d[2]==191?p=lf(p.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?p=lf(p):h.type=="binary"&&typeof el<"u"&&h.codepage&&(p=el.utils.decode(h.codepage,el.utils.encode(28591,p))),p.slice(0,19)=="socialcalc:version:"?T6.to_sheet(h.type=="string"?p:lf(p),h):s(p,h)}function l(u,h){return Ll(o(u,h),h)}function c(u){for(var h=[],p=jr(u["!ref"]),d,v=Array.isArray(u),g=p.s.r;g<=p.e.r;++g){for(var y=[],b=p.s.c;b<=p.e.c;++b){var E=dr({r:g,c:b});if(d=v?(u[g]||[])[b]:u[E],!d||d.v==null){y.push("          ");continue}for(var S=(d.w||(Bs(d),d.w)||"").slice(0,10);S.length<10;)S+=" ";y.push(S+(b===0?" ":""))}h.push(y.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}(),ow=function(){function e(A,F,O){if(A){Li(A,A.l||0);for(var M=O.Enum||Ue;A.l<A.length;){var J=A.read_shift(2),fe=M[J]||M[65535],ve=A.read_shift(2),ae=A.l+ve,ue=fe.f&&fe.f(A,ve,O);if(A.l=ae,F(ue,fe,J))return}}}function t(A,F){switch(F.type){case"base64":return r(Ta(Rs(A)),F);case"binary":return r(Ta(A),F);case"buffer":case"array":return r(A,F)}throw"Unsupported type "+F.type}function r(A,F){if(!A)return A;var O=F||{},M=O.dense?[]:{},J="Sheet1",fe="",ve=0,ae={},ue=[],oe=[],le={s:{r:0,c:0},e:{r:0,c:0}},Be=O.sheetRows||0;if(A[2]==0&&(A[3]==8||A[3]==9)&&A.length>=16&&A[14]==5&&A[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(A[2]==2)O.Enum=Ue,e(A,function(Re,it,We){switch(We){case 0:O.vers=Re,Re>=4096&&(O.qpro=!0);break;case 6:le=Re;break;case 204:Re&&(fe=Re);break;case 222:fe=Re;break;case 15:case 51:O.qpro||(Re[1].v=Re[1].v.slice(1));case 13:case 14:case 16:We==14&&(Re[2]&112)==112&&(Re[2]&15)>1&&(Re[2]&15)<15&&(Re[1].z=O.dateNF||zr[14],O.cellDates&&(Re[1].t="d",Re[1].v=qA(Re[1].v))),O.qpro&&Re[3]>ve&&(M["!ref"]=on(le),ae[J]=M,ue.push(J),M=O.dense?[]:{},le={s:{r:0,c:0},e:{r:0,c:0}},ve=Re[3],J=fe||"Sheet"+(ve+1),fe="");var st=O.dense?(M[Re[0].r]||[])[Re[0].c]:M[dr(Re[0])];if(st){st.t=Re[1].t,st.v=Re[1].v,Re[1].z!=null&&(st.z=Re[1].z),Re[1].f!=null&&(st.f=Re[1].f);break}O.dense?(M[Re[0].r]||(M[Re[0].r]=[]),M[Re[0].r][Re[0].c]=Re[1]):M[dr(Re[0])]=Re[1];break}},O);else if(A[2]==26||A[2]==14)O.Enum=Fe,A[2]==14&&(O.qpro=!0,A.l=0),e(A,function(Re,it,We){switch(We){case 204:J=Re;break;case 22:Re[1].v=Re[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Re[3]>ve&&(M["!ref"]=on(le),ae[J]=M,ue.push(J),M=O.dense?[]:{},le={s:{r:0,c:0},e:{r:0,c:0}},ve=Re[3],J="Sheet"+(ve+1)),Be>0&&Re[0].r>=Be)break;O.dense?(M[Re[0].r]||(M[Re[0].r]=[]),M[Re[0].r][Re[0].c]=Re[1]):M[dr(Re[0])]=Re[1],le.e.c<Re[0].c&&(le.e.c=Re[0].c),le.e.r<Re[0].r&&(le.e.r=Re[0].r);break;case 27:Re[14e3]&&(oe[Re[14e3][0]]=Re[14e3][1]);break;case 1537:oe[Re[0]]=Re[1],Re[0]==ve&&(J=Re[1]);break}},O);else throw new Error("Unrecognized LOTUS BOF "+A[2]);if(M["!ref"]=on(le),ae[fe||J]=M,ue.push(fe||J),!oe.length)return{SheetNames:ue,Sheets:ae};for(var ge={},Q=[],tt=0;tt<oe.length;++tt)ae[ue[tt]]?(Q.push(oe[tt]||ue[tt]),ge[oe[tt]]=ae[oe[tt]]||ae[ue[tt]]):(Q.push(oe[tt]),ge[oe[tt]]={"!ref":"A1"});return{SheetNames:Q,Sheets:ge}}function n(A,F){var O=F||{};if(+O.codepage>=0&&jf(+O.codepage),O.type=="string")throw new Error("Cannot write WK1 to JS string");var M=vi(),J=jr(A["!ref"]),fe=Array.isArray(A),ve=[];Xe(M,0,a(1030)),Xe(M,6,l(J));for(var ae=Math.min(J.e.r,8191),ue=J.s.r;ue<=ae;++ue)for(var oe=Bn(ue),le=J.s.c;le<=J.e.c;++le){ue===J.s.r&&(ve[le]=Yn(le));var Be=ve[le]+oe,ge=fe?(A[ue]||[])[le]:A[Be];if(!(!ge||ge.t=="z"))if(ge.t=="n")(ge.v|0)==ge.v&&ge.v>=-32768&&ge.v<=32767?Xe(M,13,d(ue,le,ge.v)):Xe(M,14,g(ue,le,ge.v));else{var Q=Bs(ge);Xe(M,15,h(ue,le,Q.slice(0,239)))}}return Xe(M,1),M.end()}function i(A,F){var O=F||{};if(+O.codepage>=0&&jf(+O.codepage),O.type=="string")throw new Error("Cannot write WK3 to JS string");var M=vi();Xe(M,0,s(A));for(var J=0,fe=0;J<A.SheetNames.length;++J)(A.Sheets[A.SheetNames[J]]||{})["!ref"]&&Xe(M,27,be(A.SheetNames[J],fe++));var ve=0;for(J=0;J<A.SheetNames.length;++J){var ae=A.Sheets[A.SheetNames[J]];if(!(!ae||!ae["!ref"])){for(var ue=jr(ae["!ref"]),oe=Array.isArray(ae),le=[],Be=Math.min(ue.e.r,8191),ge=ue.s.r;ge<=Be;++ge)for(var Q=Bn(ge),tt=ue.s.c;tt<=ue.e.c;++tt){ge===ue.s.r&&(le[tt]=Yn(tt));var Re=le[tt]+Q,it=oe?(ae[ge]||[])[tt]:ae[Re];if(!(!it||it.t=="z"))if(it.t=="n")Xe(M,23,G(ge,tt,ve,it.v));else{var We=Bs(it);Xe(M,22,C(ge,tt,ve,We.slice(0,239)))}}++ve}}return Xe(M,1),M.end()}function a(A){var F=Oe(2);return F.write_shift(2,A),F}function s(A){var F=Oe(26);F.write_shift(2,4096),F.write_shift(2,4),F.write_shift(4,0);for(var O=0,M=0,J=0,fe=0;fe<A.SheetNames.length;++fe){var ve=A.SheetNames[fe],ae=A.Sheets[ve];if(!(!ae||!ae["!ref"])){++J;var ue=qi(ae["!ref"]);O<ue.e.r&&(O=ue.e.r),M<ue.e.c&&(M=ue.e.c)}}return O>8191&&(O=8191),F.write_shift(2,O),F.write_shift(1,J),F.write_shift(1,M),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(1,1),F.write_shift(1,2),F.write_shift(4,0),F.write_shift(4,0),F}function o(A,F,O){var M={s:{c:0,r:0},e:{c:0,r:0}};return F==8&&O.qpro?(M.s.c=A.read_shift(1),A.l++,M.s.r=A.read_shift(2),M.e.c=A.read_shift(1),A.l++,M.e.r=A.read_shift(2),M):(M.s.c=A.read_shift(2),M.s.r=A.read_shift(2),F==12&&O.qpro&&(A.l+=2),M.e.c=A.read_shift(2),M.e.r=A.read_shift(2),F==12&&O.qpro&&(A.l+=2),M.s.c==65535&&(M.s.c=M.e.c=M.s.r=M.e.r=0),M)}function l(A){var F=Oe(8);return F.write_shift(2,A.s.c),F.write_shift(2,A.s.r),F.write_shift(2,A.e.c),F.write_shift(2,A.e.r),F}function c(A,F,O){var M=[{c:0,r:0},{t:"n",v:0},0,0];return O.qpro&&O.vers!=20768?(M[0].c=A.read_shift(1),M[3]=A.read_shift(1),M[0].r=A.read_shift(2),A.l+=2):(M[2]=A.read_shift(1),M[0].c=A.read_shift(2),M[0].r=A.read_shift(2)),M}function u(A,F,O){var M=A.l+F,J=c(A,F,O);if(J[1].t="s",O.vers==20768){A.l++;var fe=A.read_shift(1);return J[1].v=A.read_shift(fe,"utf8"),J}return O.qpro&&A.l++,J[1].v=A.read_shift(M-A.l,"cstr"),J}function h(A,F,O){var M=Oe(7+O.length);M.write_shift(1,255),M.write_shift(2,F),M.write_shift(2,A),M.write_shift(1,39);for(var J=0;J<M.length;++J){var fe=O.charCodeAt(J);M.write_shift(1,fe>=128?95:fe)}return M.write_shift(1,0),M}function p(A,F,O){var M=c(A,F,O);return M[1].v=A.read_shift(2,"i"),M}function d(A,F,O){var M=Oe(7);return M.write_shift(1,255),M.write_shift(2,F),M.write_shift(2,A),M.write_shift(2,O,"i"),M}function v(A,F,O){var M=c(A,F,O);return M[1].v=A.read_shift(8,"f"),M}function g(A,F,O){var M=Oe(13);return M.write_shift(1,255),M.write_shift(2,F),M.write_shift(2,A),M.write_shift(8,O,"f"),M}function y(A,F,O){var M=A.l+F,J=c(A,F,O);if(J[1].v=A.read_shift(8,"f"),O.qpro)A.l=M;else{var fe=A.read_shift(2);P(A.slice(A.l,A.l+fe),J),A.l+=fe}return J}function b(A,F,O){var M=F&32768;return F&=-32769,F=(M?A:0)+(F>=8192?F-16384:F),(M?"":"$")+(O?Yn(F):Bn(F))}var E={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},S=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function P(A,F){Li(A,0);for(var O=[],M=0,J="",fe="",ve="",ae="";A.l<A.length;){var ue=A[A.l++];switch(ue){case 0:O.push(A.read_shift(8,"f"));break;case 1:fe=b(F[0].c,A.read_shift(2),!0),J=b(F[0].r,A.read_shift(2),!1),O.push(fe+J);break;case 2:{var oe=b(F[0].c,A.read_shift(2),!0),le=b(F[0].r,A.read_shift(2),!1);fe=b(F[0].c,A.read_shift(2),!0),J=b(F[0].r,A.read_shift(2),!1),O.push(oe+le+":"+fe+J)}break;case 3:if(A.l<A.length){console.error("WK1 premature formula end");return}break;case 4:O.push("("+O.pop()+")");break;case 5:O.push(A.read_shift(2));break;case 6:{for(var Be="";ue=A[A.l++];)Be+=String.fromCharCode(ue);O.push('"'+Be.replace(/"/g,'""')+'"')}break;case 8:O.push("-"+O.pop());break;case 23:O.push("+"+O.pop());break;case 22:O.push("NOT("+O.pop()+")");break;case 20:case 21:ae=O.pop(),ve=O.pop(),O.push(["AND","OR"][ue-20]+"("+ve+","+ae+")");break;default:if(ue<32&&S[ue])ae=O.pop(),ve=O.pop(),O.push(ve+S[ue]+ae);else if(E[ue]){if(M=E[ue][1],M==69&&(M=A[A.l++]),M>O.length){console.error("WK1 bad formula parse 0x"+ue.toString(16)+":|"+O.join("|")+"|");return}var ge=O.slice(-M);O.length-=M,O.push(E[ue][0]+"("+ge.join(",")+")")}else return ue<=7?console.error("WK1 invalid opcode "+ue.toString(16)):ue<=24?console.error("WK1 unsupported op "+ue.toString(16)):ue<=30?console.error("WK1 invalid opcode "+ue.toString(16)):ue<=115?console.error("WK1 unsupported function opcode "+ue.toString(16)):console.error("WK1 unrecognized opcode "+ue.toString(16))}}O.length==1?F[1].f=""+O[0]:console.error("WK1 bad formula parse |"+O.join("|")+"|")}function L(A){var F=[{c:0,r:0},{t:"n",v:0},0];return F[0].r=A.read_shift(2),F[3]=A[A.l++],F[0].c=A[A.l++],F}function q(A,F){var O=L(A);return O[1].t="s",O[1].v=A.read_shift(F-4,"cstr"),O}function C(A,F,O,M){var J=Oe(6+M.length);J.write_shift(2,A),J.write_shift(1,O),J.write_shift(1,F),J.write_shift(1,39);for(var fe=0;fe<M.length;++fe){var ve=M.charCodeAt(fe);J.write_shift(1,ve>=128?95:ve)}return J.write_shift(1,0),J}function R(A,F){var O=L(A);O[1].v=A.read_shift(2);var M=O[1].v>>1;if(O[1].v&1)switch(M&7){case 0:M=(M>>3)*5e3;break;case 1:M=(M>>3)*500;break;case 2:M=(M>>3)/20;break;case 3:M=(M>>3)/200;break;case 4:M=(M>>3)/2e3;break;case 5:M=(M>>3)/2e4;break;case 6:M=(M>>3)/16;break;case 7:M=(M>>3)/64;break}return O[1].v=M,O}function k(A,F){var O=L(A),M=A.read_shift(4),J=A.read_shift(4),fe=A.read_shift(2);if(fe==65535)return M===0&&J===3221225472?(O[1].t="e",O[1].v=15):M===0&&J===3489660928?(O[1].t="e",O[1].v=42):O[1].v=0,O;var ve=fe&32768;return fe=(fe&32767)-16446,O[1].v=(1-ve*2)*(J*Math.pow(2,fe+32)+M*Math.pow(2,fe)),O}function G(A,F,O,M){var J=Oe(14);if(J.write_shift(2,A),J.write_shift(1,O),J.write_shift(1,F),M==0)return J.write_shift(4,0),J.write_shift(4,0),J.write_shift(2,65535),J;var fe=0,ve=0,ae=0,ue=0;return M<0&&(fe=1,M=-M),ve=Math.log2(M)|0,M/=Math.pow(2,ve-31),ue=M>>>0,ue&2147483648||(M/=2,++ve,ue=M>>>0),M-=ue,ue|=2147483648,ue>>>=0,M*=Math.pow(2,32),ae=M>>>0,J.write_shift(4,ae),J.write_shift(4,ue),ve+=16383+(fe?32768:0),J.write_shift(2,ve),J}function _(A,F){var O=k(A);return A.l+=F-14,O}function j(A,F){var O=L(A),M=A.read_shift(4);return O[1].v=M>>6,O}function H(A,F){var O=L(A),M=A.read_shift(8,"f");return O[1].v=M,O}function X(A,F){var O=H(A);return A.l+=F-10,O}function ce(A,F){return A[A.l+F-1]==0?A.read_shift(F,"cstr"):""}function pe(A,F){var O=A[A.l++];O>F-1&&(O=F-1);for(var M="";M.length<O;)M+=String.fromCharCode(A[A.l++]);return M}function ye(A,F,O){if(!(!O.qpro||F<21)){var M=A.read_shift(1);A.l+=17,A.l+=1,A.l+=2;var J=A.read_shift(F-21,"cstr");return[M,J]}}function me(A,F){for(var O={},M=A.l+F;A.l<M;){var J=A.read_shift(2);if(J==14e3){for(O[J]=[0,""],O[J][0]=A.read_shift(2);A[A.l];)O[J][1]+=String.fromCharCode(A[A.l]),A.l++;A.l++}}return O}function be(A,F){var O=Oe(5+A.length);O.write_shift(2,14e3),O.write_shift(2,F);for(var M=0;M<A.length;++M){var J=A.charCodeAt(M);O[O.l++]=J>127?95:J}return O[O.l++]=0,O}var Ue={0:{n:"BOF",f:_6},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:u},16:{n:"FORMULA",f:y},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:u},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ce},222:{n:"SHEETNAMELP",f:pe},65535:{n:""}},Fe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:q},23:{n:"NUMBER17",f:k},24:{n:"NUMBER18",f:R},25:{n:"FORMULA19",f:_},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:me},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:j},38:{n:"??"},39:{n:"NUMBER27",f:H},40:{n:"FORMULA28",f:X},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ce},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ye},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:i,to_workbook:t}}(),wz=/^\s|\s$|[\t\n\r]/;function P6(e,t){if(!t.bookSST)return"";var r=[ln];r[r.length]=Ye("sst",null,{xmlns:iu[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var i=e[n],a="<si>";i.r?a+=i.r:(a+="<t",i.t||(i.t=""),i.t.match(wz)&&(a+=' xml:space="preserve"'),a+=">"+hr(i.t)+"</t>"),a+="</si>",r[r.length]=a}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function _z(e){return[e.read_shift(4),e.read_shift(4)]}function Nz(e,t){return t||(t=Oe(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var Sz=p$;function Az(e){var t=vi();$e(t,159,Nz(e));for(var r=0;r<e.length;++r)$e(t,19,Sz(e[r]));return $e(t,160),t.end()}function Ez(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function j6(e){var t=0,r,n=Ez(e),i=n.length+1,a,s,o,l,c;for(r=Nl(i),r[0]=n.length,a=1;a!=i;++a)r[a]=n[a-1];for(a=i-1;a>=0;--a)s=r[a],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^s;return t^52811}var Tz=function(){function e(i,a){switch(a.type){case"base64":return t(Rs(i),a);case"binary":return t(i,a);case"buffer":return t(nr&&Buffer.isBuffer(i)?i.toString("binary"):a0(i),a);case"array":return t(Ap(i),a)}throw new Error("Unrecognized type "+a.type)}function t(i,a){var s=a||{},o=s.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(u,h){Array.isArray(o)&&(o[h]=[]);for(var p=/\\\w+\b/g,d=0,v,g=-1;v=p.exec(u);){switch(v[0]){case"\\cell":var y=u.slice(d,p.lastIndex-v[0].length);if(y[0]==" "&&(y=y.slice(1)),++g,y.length){var b={v:y,t:"s"};Array.isArray(o)?o[h][g]=b:o[dr({r:h,c:g})]=b}break}d=p.lastIndex}g>c.e.c&&(c.e.c=g)}),o["!ref"]=on(c),o}function r(i,a){return Ll(e(i,a),a)}function n(i){for(var a=["{\\rtf1\\ansi"],s=jr(i["!ref"]),o,l=Array.isArray(i),c=s.s.r;c<=s.e.r;++c){a.push("\\trowd\\trautofit1");for(var u=s.s.c;u<=s.e.c;++u)a.push("\\cellx"+(u+1));for(a.push("\\pard\\intbl"),u=s.s.c;u<=s.e.c;++u){var h=dr({r:c,c:u});o=l?(i[c]||[])[u]:i[h],!(!o||o.v==null&&(!o.f||o.F))&&(a.push(" "+(o.w||(Bs(o),o.w))),a.push("\\cell"))}a.push("\\pard\\intbl\\row")}return a.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function lw(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}var Pz=6,Cs=Pz;function gd(e){return Math.floor((e+Math.round(128/Cs)/256)*Cs)}function vd(e){return Math.floor((e-5)/Cs*100+.5)/100}function xg(e){return Math.round((e*Cs+5)/Cs*256)/256}function zv(e){e.width?(e.wpx=gd(e.width),e.wch=vd(e.wpx),e.MDW=Cs):e.wpx?(e.wch=vd(e.wpx),e.width=xg(e.wch),e.MDW=Cs):typeof e.wch=="number"&&(e.width=xg(e.wch),e.wpx=gd(e.width),e.MDW=Cs),e.customWidth&&delete e.customWidth}var jz=96,k6=jz;function xd(e){return e*96/k6}function C6(e){return e*k6/96}function kz(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=Ye("numFmt",null,{numFmtId:n,formatCode:hr(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Ye("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function Cz(e){var t=[];return t[t.length]=Ye("cellXfs",null),e.forEach(function(r){t[t.length]=Ye("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Ye("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}function O6(e,t){var r=[ln,Ye("styleSheet",null,{xmlns:iu[0],"xmlns:vt":_n.vt})],n;return e.SSF&&(n=kz(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=Cz(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function Oz(e,t){var r=e.read_shift(2),n=Xn(e);return[r,n]}function Lz(e,t,r){r||(r=Oe(6+4*t.length)),r.write_shift(2,e),Sn(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function Fz(e,t,r){var n={};n.sz=e.read_shift(2)/20;var i=w$(e);i.fItalic&&(n.italic=1),i.fCondense&&(n.condense=1),i.fExtend&&(n.extend=1),i.fShadow&&(n.shadow=1),i.fOutline&&(n.outline=1),i.fStrikeout&&(n.strike=1);var a=e.read_shift(2);switch(a===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var s=e.read_shift(1);s!=0&&(n.underline=s);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=b$(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=Xn(e),n}function Dz(e,t){t||(t=Oe(25+4*32)),t.write_shift(2,e.sz*20),_$(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),pd(e.color,t);var n=0;return e.scheme=="major"&&(n=1),e.scheme=="minor"&&(n=2),t.write_shift(1,n),Sn(e.name,t),t.length>t.l?t.slice(0,t.l):t}var Iz=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],G1,Mz=as;function cw(e,t){t||(t=Oe(4*3+8*7+16*1)),G1||(G1=kv(Iz));var r=G1[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(pd({auto:1},t),pd({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function Rz(e,t){var r=e.l+t,n=e.read_shift(2),i=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:i}}function L6(e,t,r){r||(r=Oe(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function Hu(e,t){return t||(t=Oe(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var Bz=as;function Uz(e,t){return t||(t=Oe(51)),t.write_shift(1,0),Hu(null,t),Hu(null,t),Hu(null,t),Hu(null,t),Hu(null,t),t.length>t.l?t.slice(0,t.l):t}function $z(e,t){return t||(t=Oe(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,+e.builtinId),t.write_shift(1,0),dd(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function zz(e,t,r){var n=Oe(2052);return n.write_shift(4,e),dd(t,n),dd(r,n),n.length>n.l?n.slice(0,n.l):n}function Wz(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&++r}),r!=0&&($e(e,615,ka(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&$e(e,44,Lz(i,t[i]))}),$e(e,616))}}function qz(e){var t=1;$e(e,611,ka(t)),$e(e,43,Dz({sz:12,color:{theme:1},name:"Calibri",family:2,scheme:"minor"})),$e(e,612)}function Hz(e){var t=2;$e(e,603,ka(t)),$e(e,45,cw({patternType:"none"})),$e(e,45,cw({patternType:"gray125"})),$e(e,604)}function Gz(e){var t=1;$e(e,613,ka(t)),$e(e,46,Uz()),$e(e,614)}function Vz(e){var t=1;$e(e,626,ka(t)),$e(e,47,L6({numFmtId:0,fontId:0,fillId:0,borderId:0},65535)),$e(e,627)}function Kz(e,t){$e(e,617,ka(t.length)),t.forEach(function(r){$e(e,47,L6(r,0))}),$e(e,618)}function Yz(e){var t=1;$e(e,619,ka(t)),$e(e,48,$z({xfId:0,builtinId:0,name:"Normal"})),$e(e,620)}function Xz(e){var t=0;$e(e,505,ka(t)),$e(e,506)}function Zz(e){var t=0;$e(e,508,zz(t,"TableStyleMedium9","PivotStyleMedium4")),$e(e,509)}function Jz(e,t){var r=vi();return $e(r,278),Wz(r,e.SSF),qz(r),Hz(r),Gz(r),Vz(r),Kz(r,t.cellXfs),Yz(r),Xz(r),Zz(r),$e(r,279),r.end()}function F6(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[ln];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="Ôº≠Ôº≥ Ôº∞„Ç¥„Ç∑„ÉÉ„ÇØ"/>',r[r.length]='<a:font script="Hang" typeface="ÎßëÏùÄ Í≥†Îîï"/>',r[r.length]='<a:font script="Hans" typeface="ÂÆã‰Ωì"/>',r[r.length]='<a:font script="Hant" typeface="Êñ∞Á¥∞ÊòéÈ´î"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="Ôº≠Ôº≥ Ôº∞„Ç¥„Ç∑„ÉÉ„ÇØ"/>',r[r.length]='<a:font script="Hang" typeface="ÎßëÏùÄ Í≥†Îîï"/>',r[r.length]='<a:font script="Hans" typeface="ÂÆã‰Ωì"/>',r[r.length]='<a:font script="Hant" typeface="Êñ∞Á¥∞ÊòéÈ´î"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Qz(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:Xn(e)}}function eW(e){var t=Oe(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),Sn(e.name,t),t.slice(0,t.l)}function tW(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function rW(e){var t=Oe(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function nW(e,t){var r=Oe(8+2*t.length);return r.write_shift(4,e),Sn(t,r),r.slice(0,r.l)}function iW(e){return e.l+=4,e.read_shift(4)!=0}function aW(e,t){var r=Oe(8);return r.write_shift(4,e),r.write_shift(4,1),r}function sW(){var e=vi();return $e(e,332),$e(e,334,ka(1)),$e(e,335,eW({name:"XLDAPR",version:12e4,flags:3496657072})),$e(e,336),$e(e,339,nW(1,"XLDAPR")),$e(e,52),$e(e,35,ka(514)),$e(e,4096,ka(0)),$e(e,4097,na(1)),$e(e,36),$e(e,53),$e(e,340),$e(e,337,aW(1)),$e(e,51,rW([[1,0]])),$e(e,338),$e(e,333),e.end()}function D6(){var e=[ln];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function oW(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=dr(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}var dc=1024;function I6(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),i=[Ye("xml",null,{"xmlns:v":Fi.v,"xmlns:o":Fi.o,"xmlns:x":Fi.x,"xmlns:mv":Fi.mv}).replace(/\/>/,">"),Ye("o:shapelayout",Ye("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Ye("v:shapetype",[Ye("v:stroke",null,{joinstyle:"miter"}),Ye("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];dc<e*1e3;)dc+=1e3;return t.forEach(function(a){var s=Nn(a[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?Ye("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,c=Ye("v:fill",l,o),u={on:"t",obscured:"t"};++dc,i=i.concat(["<v:shape"+Lf({id:"_x0000_s"+dc,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(a[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",c,Ye("v:shadow",null,u),Ye("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Rn("x:Anchor",[s.c+1,0,s.r+1,0,s.c+3,20,s.r+5,20].join(",")),Rn("x:AutoFill","False"),Rn("x:Row",String(s.r)),Rn("x:Column",String(s.c)),a[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function M6(e){var t=[ln,Ye("comments",null,{xmlns:iu[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(i){var a=hr(i.a);r.indexOf(a)==-1&&(r.push(a),t.push("<author>"+a+"</author>")),i.T&&i.ID&&r.indexOf("tc="+i.ID)==-1&&(r.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var i=0,a=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?i=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(l){l.a&&(i=r.indexOf(hr(l.a))),a.push(l.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+i+'"><text>'),a.length<=1)t.push(Rn("t",hr(a[0]||"")));else{for(var s=`Comment:
    `+a[0]+`
`,o=1;o<a.length;++o)s+=`Reply:
    `+a[o]+`
`;t.push(Rn("t",hr(s)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function lW(e,t,r){var n=[ln,Ye("ThreadedComments",null,{xmlns:_n.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var a="";(i[1]||[]).forEach(function(s,o){if(!s.T){delete s.ID;return}s.a&&t.indexOf(s.a)==-1&&t.push(s.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};o==0?a=l.id:l.parentId=a,s.ID=l.id,s.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(s.a)).slice(-12)+"}"),n.push(Ye("threadedComment",Rn("text",s.t||""),l))})}),n.push("</ThreadedComments>"),n.join("")}function cW(e){var t=[ln,Ye("personList",null,{xmlns:_n.TCMNT,"xmlns:x":iu[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(Ye("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function uW(e){var t={};t.iauthor=e.read_shift(4);var r=Ml(e);return t.rfx=r.s,t.ref=dr(r.s),e.l+=16,t}function fW(e,t){return t==null&&(t=Oe(36)),t.write_shift(4,e[1].iauthor),su(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var hW=Xn;function dW(e){return Sn(e.slice(0,54))}function pW(e){var t=vi(),r=[];return $e(t,628),$e(t,630),e.forEach(function(n){n[1].forEach(function(i){r.indexOf(i.a)>-1||(r.push(i.a.slice(0,54)),$e(t,632,dW(i.a)))})}),$e(t,631),$e(t,633),e.forEach(function(n){n[1].forEach(function(i){i.iauthor=r.indexOf(i.a);var a={s:Nn(n[0]),e:Nn(n[0])};$e(t,635,fW([a,i])),i.t&&i.t.length>0&&$e(t,637,g$(i)),$e(t,636),delete i.iauthor})}),$e(t,634),$e(t,629),t.end()}function mW(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var i=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&gr.utils.cfb_add(e,i,t.FileIndex[n].content)}})}var R6=["xlsb","xlsm","xlam","biff8","xla"],gW=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,i,a,s){var o=!1,l=!1;a.length==0?l=!0:a.charAt(0)=="["&&(l=!0,a=a.slice(1,-1)),s.length==0?o=!0:s.charAt(0)=="["&&(o=!0,s=s.slice(1,-1));var c=a.length>0?parseInt(a,10)|0:0,u=s.length>0?parseInt(s,10)|0:0;return o?u+=t.c:--u,l?c+=t.r:--c,i+(o?"":"$")+Yn(u)+(l?"":"$")+Bn(c)}return function(i,a){return t=a,i.replace(e,r)}}(),Wv=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,qv=function(){return function(t,r){return t.replace(Wv,function(n,i,a,s,o,l){var c=Mv(s)-(a?0:r.c),u=Iv(l)-(o?0:r.r),h=u==0?"":o?u+1:"["+u+"]",p=c==0?"":a?c+1:"["+c+"]";return i+"R"+h+"C"+p})}}();function vW(e,t){return e.replace(Wv,function(r,n,i,a,s,o){return n+(i=="$"?i+a:Yn(Mv(a)+t.c))+(s=="$"?s+o:Bn(Iv(o)+t.r))})}function xW(e){return e.length!=1}function nn(e){e.l+=1}function To(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function B6(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return U6(e);r.biff==12&&(n=4)}var i=e.read_shift(n),a=e.read_shift(n),s=To(e),o=To(e);return{s:{r:i,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function U6(e){var t=To(e),r=To(e),n=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:i,cRel:r[1],rRel:r[2]}}}function yW(e,t,r){if(r.biff<8)return U6(e);var n=e.read_shift(r.biff==12?4:2),i=e.read_shift(r.biff==12?4:2),a=To(e),s=To(e);return{s:{r:n,c:a[0],cRel:a[1],rRel:a[2]},e:{r:i,c:s[0],cRel:s[1],rRel:s[2]}}}function $6(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return bW(e);var n=e.read_shift(r&&r.biff==12?4:2),i=To(e);return{r:n,c:i[0],cRel:i[1],rRel:i[2]}}function bW(e){var t=To(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function wW(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function _W(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return NW(e);var i=e.read_shift(n>=12?4:2),a=e.read_shift(2),s=(a&16384)>>14,o=(a&32768)>>15;if(a&=16383,o==1)for(;i>524287;)i-=1048576;if(s==1)for(;a>8191;)a=a-16384;return{r:i,c:a,cRel:s,rRel:o}}function NW(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),i==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:i,rRel:n}}function SW(e,t,r){var n=(e[e.l++]&96)>>5,i=B6(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,i]}function AW(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}var s=B6(e,a,r);return[n,i,s]}function EW(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function TW(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=8;if(r)switch(r.biff){case 5:e.l+=12,a=6;break;case 12:a=12;break}return e.l+=a,[n,i]}function PW(e,t,r){var n=(e[e.l++]&96)>>5,i=yW(e,t-1,r);return[n,i]}function jW(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function uw(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function kW(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),i=[],a=0;a<=n;++a)i.push(e.read_shift(r&&r.biff==2?1:2));return i}function CW(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function OW(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function LW(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function FW(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function z6(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function DW(e){return e.read_shift(2),z6(e)}function IW(e){return e.read_shift(2),z6(e)}function MW(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=$6(e,0,r);return[n,i]}function RW(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=_W(e,0,r);return[n,i]}function BW(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var a=$6(e,0,r);return[n,i,a]}function UW(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(r&&r.biff<=3?1:2);return[Uq[i],H6[i],n]}function $W(e,t,r){var n=e[e.l++],i=e.read_shift(1),a=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:zW(e);return[i,(a[0]===0?H6:Bq)[a[1]]]}function zW(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function WW(e,t,r){e.l+=r&&r.biff==2?3:4}function qW(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function HW(e){return e.l++,l0[e.read_shift(1)]}function GW(e){return e.l++,e.read_shift(2)}function VW(e){return e.l++,e.read_shift(1)!==0}function KW(e){return e.l++,ou(e)}function YW(e,t,r){return e.l++,S6(e,t-1,r)}function XW(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=B$(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=l0[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=ou(e);break;case 2:r[1]=W$(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function ZW(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),i=[],a=0;a!=n;++a)i.push((r.biff==12?Ml:G$)(e));return i}function JW(e,t,r){var n=0,i=0;r.biff==12?(n=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--i==0&&(i=256));for(var a=0,s=[];a!=n&&(s[a]=[]);++a)for(var o=0;o!=i;++o)s[a][o]=XW(e,r.biff);return s}function QW(e,t,r){var n=e.read_shift(1)>>>5&3,i=!r||r.biff>=8?4:2,a=e.read_shift(i);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,a]}function eq(e,t,r){if(r.biff==5)return tq(e);var n=e.read_shift(1)>>>5&3,i=e.read_shift(2),a=e.read_shift(4);return[n,i,a]}function tq(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function rq(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function nq(e,t,r){var n=e.read_shift(1)>>>5&3,i=e.read_shift(r&&r.biff==2?1:2);return[n,i]}function iq(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function aq(e,t,r){var n=(e[e.l++]&96)>>5,i=e.read_shift(2),a=4;if(r)switch(r.biff){case 5:a=15;break;case 12:a=6;break}return e.l+=a,[n,i]}var sq=as,oq=as,lq=as;function c0(e,t,r){return e.l+=2,[wW(e)]}function Hv(e){return e.l+=6,[]}var cq=c0,uq=Hv,fq=Hv,hq=c0;function W6(e){return e.l+=2,[_6(e),e.read_shift(2)&1]}var dq=c0,pq=W6,mq=Hv,gq=c0,vq=c0,xq=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function yq(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),i=e.read_shift(2),a=e.read_shift(2),s=xq[r>>2&31];return{ixti:t,coltype:r&3,rt:s,idx:n,c:i,C:a}}function bq(e){return e.l+=2,[e.read_shift(4)]}function wq(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function _q(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function Nq(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Sq(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function Aq(e){return e.l+=4,[0,0]}var fw={1:{n:"PtgExp",f:qW},2:{n:"PtgTbl",f:lq},3:{n:"PtgAdd",f:nn},4:{n:"PtgSub",f:nn},5:{n:"PtgMul",f:nn},6:{n:"PtgDiv",f:nn},7:{n:"PtgPower",f:nn},8:{n:"PtgConcat",f:nn},9:{n:"PtgLt",f:nn},10:{n:"PtgLe",f:nn},11:{n:"PtgEq",f:nn},12:{n:"PtgGe",f:nn},13:{n:"PtgGt",f:nn},14:{n:"PtgNe",f:nn},15:{n:"PtgIsect",f:nn},16:{n:"PtgUnion",f:nn},17:{n:"PtgRange",f:nn},18:{n:"PtgUplus",f:nn},19:{n:"PtgUminus",f:nn},20:{n:"PtgPercent",f:nn},21:{n:"PtgParen",f:nn},22:{n:"PtgMissArg",f:nn},23:{n:"PtgStr",f:YW},26:{n:"PtgSheet",f:wq},27:{n:"PtgEndSheet",f:_q},28:{n:"PtgErr",f:HW},29:{n:"PtgBool",f:VW},30:{n:"PtgInt",f:GW},31:{n:"PtgNum",f:KW},32:{n:"PtgArray",f:jW},33:{n:"PtgFunc",f:UW},34:{n:"PtgFuncVar",f:$W},35:{n:"PtgName",f:QW},36:{n:"PtgRef",f:MW},37:{n:"PtgArea",f:SW},38:{n:"PtgMemArea",f:rq},39:{n:"PtgMemErr",f:sq},40:{n:"PtgMemNoMem",f:oq},41:{n:"PtgMemFunc",f:nq},42:{n:"PtgRefErr",f:iq},43:{n:"PtgAreaErr",f:EW},44:{n:"PtgRefN",f:RW},45:{n:"PtgAreaN",f:PW},46:{n:"PtgMemAreaN",f:Nq},47:{n:"PtgMemNoMemN",f:Sq},57:{n:"PtgNameX",f:eq},58:{n:"PtgRef3d",f:BW},59:{n:"PtgArea3d",f:AW},60:{n:"PtgRefErr3d",f:aq},61:{n:"PtgAreaErr3d",f:TW},255:{}},Eq={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Tq={1:{n:"PtgElfLel",f:W6},2:{n:"PtgElfRw",f:gq},3:{n:"PtgElfCol",f:cq},6:{n:"PtgElfRwV",f:vq},7:{n:"PtgElfColV",f:hq},10:{n:"PtgElfRadical",f:dq},11:{n:"PtgElfRadicalS",f:mq},13:{n:"PtgElfColS",f:uq},15:{n:"PtgElfColSV",f:fq},16:{n:"PtgElfRadicalLel",f:pq},25:{n:"PtgList",f:yq},29:{n:"PtgSxName",f:bq},255:{}},Pq={0:{n:"PtgAttrNoop",f:Aq},1:{n:"PtgAttrSemi",f:FW},2:{n:"PtgAttrIf",f:OW},4:{n:"PtgAttrChoose",f:kW},8:{n:"PtgAttrGoto",f:CW},16:{n:"PtgAttrSum",f:WW},32:{n:"PtgAttrBaxcel",f:uw},33:{n:"PtgAttrBaxcel",f:uw},64:{n:"PtgAttrSpace",f:DW},65:{n:"PtgAttrSpaceSemi",f:IW},128:{n:"PtgAttrIfError",f:LW},255:{}};function jq(e,t,r,n){if(n.biff<8)return as(e,t);for(var i=e.l+t,a=[],s=0;s!==r.length;++s)switch(r[s][0]){case"PtgArray":r[s][1]=JW(e,0,n),a.push(r[s][1]);break;case"PtgMemArea":r[s][2]=ZW(e,r[s][1],n),a.push(r[s][2]);break;case"PtgExp":n&&n.biff==12&&(r[s][1][1]=e.read_shift(4),a.push(r[s][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[s][0]}return t=i-e.l,t!==0&&a.push(as(e,t)),a}function kq(e,t,r){for(var n=e.l+t,i,a,s=[];n!=e.l;)t=n-e.l,a=e[e.l],i=fw[a]||fw[Eq[a]],(a===24||a===25)&&(i=(a===24?Tq:Pq)[e[e.l+1]]),!i||!i.f?as(e,t):s.push([i.n,i.f(e,t,r)]);return s}function Cq(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],i=[],a=0;a<n.length;++a){var s=n[a];if(s)switch(s[0]){case 2:i.push('"'+s[1].replace(/"/g,'""')+'"');break;default:i.push(s[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var Oq={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Lq(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function q6(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var i="";if(r.biff>8)switch(e[n[0]][0]){case 357:return i=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return i=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?i:i+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(a){return a.Name}).join(";;");default:return e[n[0]][0][3]?(i=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?i:i+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function hw(e,t,r){var n=q6(e,t,r);return n=="#REF"?n:Lq(n,r)}function zc(e,t,r,n,i){var a=i&&i.biff||8,s={s:{c:0,r:0},e:{c:0,r:0}},o=[],l,c,u,h=0,p=0,d,v="";if(!e[0]||!e[0][0])return"";for(var g=-1,y="",b=0,E=e[0].length;b<E;++b){var S=e[0][b];switch(S[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),g>=0){switch(e[0][g][1][0]){case 0:y=$r(" ",e[0][g][1][1]);break;case 1:y=$r("\r",e[0][g][1][1]);break;default:if(y="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}c=c+y,g=-1}o.push(c+Oq[S[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":u=uf(S[1][1],s,i),o.push(ff(u,a));break;case"PtgRefN":u=r?uf(S[1][1],r,i):S[1][1],o.push(ff(u,a));break;case"PtgRef3d":h=S[1][1],u=uf(S[1][2],s,i),v=hw(n,h,i),o.push(v+"!"+ff(u,a));break;case"PtgFunc":case"PtgFuncVar":var P=S[1][0],L=S[1][1];P||(P=0),P&=127;var q=P==0?[]:o.slice(-P);o.length-=P,L==="User"&&(L=q.shift()),o.push(L+"("+q.join(",")+")");break;case"PtgBool":o.push(S[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(S[1]);break;case"PtgNum":o.push(String(S[1]));break;case"PtgStr":o.push('"'+S[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(S[1]);break;case"PtgAreaN":d=X5(S[1][1],r?{s:r}:s,i),o.push(q1(d,i));break;case"PtgArea":d=X5(S[1][1],s,i),o.push(q1(d,i));break;case"PtgArea3d":h=S[1][1],d=S[1][2],v=hw(n,h,i),o.push(v+"!"+q1(d,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=S[1][2];var C=(n.names||[])[p-1]||(n[0]||[])[p],R=C?C.Name:"SH33TJSNAME"+String(p);R&&R.slice(0,6)=="_xlfn."&&!i.xlfn&&(R=R.slice(6)),o.push(R);break;case"PtgNameX":var k=S[1][1];p=S[1][2];var G;if(i.biff<=5)k<0&&(k=-k),n[k]&&(G=n[k][p]);else{var _="";if(((n[k]||[])[0]||[])[0]==14849||(((n[k]||[])[0]||[])[0]==1025?n[k][p]&&n[k][p].itab>0&&(_=n.SheetNames[n[k][p].itab-1]+"!"):_=n.SheetNames[p-1]+"!"),n[k]&&n[k][p])_+=n[k][p].Name;else if(n[0]&&n[0][p])_+=n[0][p].Name;else{var j=(q6(n,k,i)||"").split(";;");j[p-1]?_=j[p-1]:_+="SH33TJSERRX"}o.push(_);break}G||(G={Name:"SH33TJSERRY"}),o.push(G.Name);break;case"PtgParen":var H="(",X=")";if(g>=0){switch(y="",e[0][g][1][0]){case 2:H=$r(" ",e[0][g][1][1])+H;break;case 3:H=$r("\r",e[0][g][1][1])+H;break;case 4:X=$r(" ",e[0][g][1][1])+X;break;case 5:X=$r("\r",e[0][g][1][1])+X;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}o.push(H+o.pop()+X);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":u={c:S[1][1],r:S[1][0]};var ce={c:r.c,r:r.r};if(n.sharedf[dr(u)]){var pe=n.sharedf[dr(u)];o.push(zc(pe,s,ce,n,i))}else{var ye=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(u.c<c[0].s.c||u.c>c[0].e.c)&&!(u.r<c[0].s.r||u.r>c[0].e.r)){o.push(zc(c[1],s,ce,n,i)),ye=!0;break}ye||o.push(S[1])}break;case"PtgArray":o.push("{"+Cq(S[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=b;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+S[1].idx+"[#"+S[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(S));default:throw new Error("Unrecognized Formula Token: "+String(S))}var me=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&g>=0&&me.indexOf(e[0][b][0])==-1){S=e[0][g];var be=!0;switch(S[1][0]){case 4:be=!1;case 0:y=$r(" ",S[1][1]);break;case 5:be=!1;case 1:y=$r("\r",S[1][1]);break;default:if(y="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+S[1][0])}o.push((be?y:"")+o.pop()+(be?"":y)),g=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function Fq(e){if(e==null){var t=Oe(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Sl(e);return Sl(0)}function Dq(e,t,r,n,i){var a=Al(t,r,i),s=Fq(e.v),o=Oe(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var c=Oe(e.bf.length),u=0;u<e.bf.length;++u)c[u]=e.bf[u];var h=Mn([a,s,o,c]);return h}function Ep(e,t,r){var n=e.read_shift(4),i=kq(e,n,r),a=e.read_shift(4),s=a>0?jq(e,a,i,r):null;return[i,s]}var Iq=Ep,Tp=Ep,Mq=Ep,Rq=Ep,Bq={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},H6={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},Uq={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function $q(e){var t="of:="+e.replace(Wv,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function zq(e){return e.replace(/\./,"!")}var hf=typeof Map<"u";function Gv(e,t,r){var n=0,i=e.length;if(r){if(hf?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var a=hf?r.get(t):r[t];n<a.length;++n)if(e[a[n]].t===t)return e.Count++,a[n]}}else for(;n<i;++n)if(e[n].t===t)return e.Count++,n;return e[i]={t},e.Count++,e.Unique++,r&&(hf?(r.has(t)||r.set(t,[]),r.get(t).push(i)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(i))),i}function Pp(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(Cs=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=vd(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=xg(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function G6(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function Do(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],i=60,a=e.length;if(n==null&&r.ssf){for(;i<392;++i)if(r.ssf[i]==null){$A(t.z,i),r.ssf[i]=t.z,r.revssf[t.z]=n=i;break}}for(i=0;i!=a;++i)if(e[i].numFmtId===n)return i;return e[a]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},a}function Wq(e,t,r){if(e&&e["!ref"]){var n=jr(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function qq(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+on(e[r])+'"/>';return t+"</mergeCells>"}function Hq(e,t,r,n,i){var a=!1,s={},o=null;if(n.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[r];try{t.Workbook&&(l=t.Workbook.Sheets[r].CodeName||l)}catch{}a=!0,s.codeName=Of(hr(l))}if(e&&e["!outline"]){var c={summaryBelow:1,summaryRight:1};e["!outline"].above&&(c.summaryBelow=0),e["!outline"].left&&(c.summaryRight=0),o=(o||"")+Ye("outlinePr",null,c)}!a&&!o||(i[i.length]=Ye("sheetPr",o,s))}var Gq=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Vq=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Kq(e){var t={sheet:1};return Gq.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),Vq.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=j6(e.password).toString(16).toUpperCase()),Ye("sheetProtection",null,t)}function Yq(e){return G6(e),Ye("pageMargins",null,e)}function Xq(e,t){for(var r=["<cols>"],n,i=0;i!=t.length;++i)(n=t[i])&&(r[r.length]=Ye("col",null,Pp(i,n)));return r[r.length]="</cols>",r.join("")}function Zq(e,t,r,n){var i=typeof e.ref=="string"?e.ref:on(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var a=r.Workbook.Names,s=qi(i);s.s.r==s.e.r&&(s.e.r=qi(t["!ref"]).e.r,i=on(s));for(var o=0;o<a.length;++o){var l=a[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==n){l.Ref="'"+r.SheetNames[n]+"'!"+i;break}}return o==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+i}),Ye("autoFilter",null,{ref:i})}function Jq(e,t,r,n){var i={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),Ye("sheetViews",Ye("sheetView",null,i),{})}function Qq(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",a=e.t,s=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=l0[e.v];break;case"d":n&&n.cellDates?i=oi(e.v,-1).toISOString():(e=yi(e),e.t="n",i=""+(e.v=xi(oi(e.v)))),typeof e.z>"u"&&(e.z=zr[14]);break;default:i=e.v;break}var o=Rn("v",hr(i)),l={r:t},c=Do(n.cellXfs,e,n);switch(c!==0&&(l.s=c),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){o=Rn("v",""+Gv(n.Strings,e.v,n.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=a&&(e.t=a,e.v=s),typeof e.f=="string"&&e.f){var u=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Ye("f",hr(e.f),u)+(e.v!=null?o:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(l.cm=1),Ye("c",o,l)}function eH(e,t,r,n){var i=[],a=[],s=jr(e["!ref"]),o="",l,c="",u=[],h=0,p=0,d=e["!rows"],v=Array.isArray(e),g={r:c},y,b=-1;for(p=s.s.c;p<=s.e.c;++p)u[p]=Yn(p);for(h=s.s.r;h<=s.e.r;++h){for(a=[],c=Bn(h),p=s.s.c;p<=s.e.c;++p){l=u[p]+c;var E=v?(e[h]||[])[p]:e[l];E!==void 0&&(o=Qq(E,l,e,t))!=null&&a.push(o)}(a.length>0||d&&d[h])&&(g={r:c},d&&d[h]&&(y=d[h],y.hidden&&(g.hidden=1),b=-1,y.hpx?b=xd(y.hpx):y.hpt&&(b=y.hpt),b>-1&&(g.ht=b,g.customHeight=1),y.level&&(g.outlineLevel=y.level)),i[i.length]=Ye("row",a.join(""),g))}if(d)for(;h<d.length;++h)d&&d[h]&&(g={r:h+1},y=d[h],y.hidden&&(g.hidden=1),b=-1,y.hpx?b=xd(y.hpx):y.hpt&&(b=y.hpt),b>-1&&(g.ht=b,g.customHeight=1),y.level&&(g.outlineLevel=y.level),i[i.length]=Ye("row","",g));return i.join("")}function V6(e,t,r,n){var i=[ln,Ye("worksheet",null,{xmlns:iu[0],"xmlns:r":_n.r})],a=r.SheetNames[e],s=0,o="",l=r.Sheets[a];l==null&&(l={});var c=l["!ref"]||"A1",u=jr(c);if(u.e.c>16383||u.e.r>1048575){if(t.WTF)throw new Error("Range "+c+" exceeds format limit A1:XFD1048576");u.e.c=Math.min(u.e.c,16383),u.e.r=Math.min(u.e.c,1048575),c=on(u)}n||(n={}),l["!comments"]=[];var h=[];Hq(l,r,e,t,i),i[i.length]=Ye("dimension",null,{ref:c}),i[i.length]=Jq(l,t,e,r),t.sheetFormat&&(i[i.length]=Ye("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=Xq(l,l["!cols"])),i[s=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=eH(l,t),o.length>0&&(i[i.length]=o)),i.length>s+1&&(i[i.length]="</sheetData>",i[s]=i[s].replace("/>",">")),l["!protect"]&&(i[i.length]=Kq(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=Zq(l["!autofilter"],l,r,e)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=qq(l["!merges"]));var p=-1,d,v=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(g){g[1].Target&&(d={ref:g[0]},g[1].Target.charAt(0)!="#"&&(v=cr(n,-1,hr(g[1].Target).replace(/#.*$/,""),Zt.HLINK),d["r:id"]="rId"+v),(p=g[1].Target.indexOf("#"))>-1&&(d.location=hr(g[1].Target.slice(p+1))),g[1].Tooltip&&(d.tooltip=hr(g[1].Tooltip)),i[i.length]=Ye("hyperlink",null,d))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=Yq(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=Rn("ignoredErrors",Ye("ignoredError",null,{numberStoredAsText:1,sqref:c}))),h.length>0&&(v=cr(n,-1,"../drawings/drawing"+(e+1)+".xml",Zt.DRAW),i[i.length]=Ye("drawing",null,{"r:id":"rId"+v}),l["!drawing"]=h),l["!comments"].length>0&&(v=cr(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Zt.VML),i[i.length]=Ye("legacyDrawing",null,{"r:id":"rId"+v}),l["!legacy"]=v),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function tH(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var a=e.read_shift(1);return e.l=n,a&7&&(r.level=a&7),a&16&&(r.hidden=!0),a&32&&(r.hpt=i/20),r}function rH(e,t,r){var n=Oe(145),i=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var a=320;i.hpx?a=xd(i.hpx)*20:i.hpt&&(a=i.hpt*20),n.write_shift(2,a),n.write_shift(1,0);var s=0;i.level&&(s|=i.level),i.hidden&&(s|=16),(i.hpx||i.hpt)&&(s|=32),n.write_shift(1,s),n.write_shift(1,0);var o=0,l=n.l;n.l+=4;for(var c={r:e,c:0},u=0;u<16;++u)if(!(t.s.c>u+1<<10||t.e.c<u<<10)){for(var h=-1,p=-1,d=u<<10;d<u+1<<10;++d){c.c=d;var v=Array.isArray(r)?(r[c.r]||[])[c.c]:r[dr(c)];v&&(h<0&&(h=d),p=d)}h<0||(++o,n.write_shift(4,h),n.write_shift(4,p))}var g=n.l;return n.l=l,n.write_shift(4,o),n.l=g,n.length>n.l?n.slice(0,n.l):n}function nH(e,t,r,n){var i=rH(n,r,t);(i.length>17||(t["!rows"]||[])[n])&&$e(e,0,i)}var iH=Ml,aH=su;function sH(){}function oH(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=v$(e),r}function lH(e,t,r){r==null&&(r=Oe(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var i=1;i<3;++i)r.write_shift(1,0);return pd({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),l6(e,r),r.slice(0,r.l)}function cH(e){var t=ha(e);return[t]}function uH(e,t,r){return r==null&&(r=Oe(8)),Fl(t,r)}function fH(e){var t=Dl(e);return[t]}function hH(e,t,r){return r==null&&(r=Oe(4)),Il(t,r)}function dH(e){var t=ha(e),r=e.read_shift(1);return[t,r,"b"]}function pH(e,t,r){return r==null&&(r=Oe(9)),Fl(t,r),r.write_shift(1,e.v?1:0),r}function mH(e){var t=Dl(e),r=e.read_shift(1);return[t,r,"b"]}function gH(e,t,r){return r==null&&(r=Oe(5)),Il(t,r),r.write_shift(1,e.v?1:0),r}function vH(e){var t=ha(e),r=e.read_shift(1);return[t,r,"e"]}function xH(e,t,r){return r==null&&(r=Oe(9)),Fl(t,r),r.write_shift(1,e.v),r}function yH(e){var t=Dl(e),r=e.read_shift(1);return[t,r,"e"]}function bH(e,t,r){return r==null&&(r=Oe(8)),Il(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function wH(e){var t=ha(e),r=e.read_shift(4);return[t,r,"s"]}function _H(e,t,r){return r==null&&(r=Oe(12)),Fl(t,r),r.write_shift(4,t.v),r}function NH(e){var t=Dl(e),r=e.read_shift(4);return[t,r,"s"]}function SH(e,t,r){return r==null&&(r=Oe(8)),Il(t,r),r.write_shift(4,t.v),r}function AH(e){var t=ha(e),r=ou(e);return[t,r,"n"]}function EH(e,t,r){return r==null&&(r=Oe(16)),Fl(t,r),Sl(e.v,r),r}function TH(e){var t=Dl(e),r=ou(e);return[t,r,"n"]}function PH(e,t,r){return r==null&&(r=Oe(12)),Il(t,r),Sl(e.v,r),r}function jH(e){var t=ha(e),r=c6(e);return[t,r,"n"]}function kH(e,t,r){return r==null&&(r=Oe(12)),Fl(t,r),u6(e.v,r),r}function CH(e){var t=Dl(e),r=c6(e);return[t,r,"n"]}function OH(e,t,r){return r==null&&(r=Oe(8)),Il(t,r),u6(e.v,r),r}function LH(e){var t=ha(e),r=Rv(e);return[t,r,"is"]}function FH(e){var t=ha(e),r=Xn(e);return[t,r,"str"]}function DH(e,t,r){return r==null&&(r=Oe(12+4*e.v.length)),Fl(t,r),Sn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function IH(e){var t=Dl(e),r=Xn(e);return[t,r,"str"]}function MH(e,t,r){return r==null&&(r=Oe(8+4*e.v.length)),Il(t,r),Sn(e.v,r),r.length>r.l?r.slice(0,r.l):r}function RH(e,t,r){var n=e.l+t,i=ha(e);i.r=r["!row"];var a=e.read_shift(1),s=[i,a,"b"];if(r.cellFormula){e.l+=2;var o=Tp(e,n-e.l,r);s[3]=zc(o,null,i,r.supbooks,r)}else e.l=n;return s}function BH(e,t,r){var n=e.l+t,i=ha(e);i.r=r["!row"];var a=e.read_shift(1),s=[i,a,"e"];if(r.cellFormula){e.l+=2;var o=Tp(e,n-e.l,r);s[3]=zc(o,null,i,r.supbooks,r)}else e.l=n;return s}function UH(e,t,r){var n=e.l+t,i=ha(e);i.r=r["!row"];var a=ou(e),s=[i,a,"n"];if(r.cellFormula){e.l+=2;var o=Tp(e,n-e.l,r);s[3]=zc(o,null,i,r.supbooks,r)}else e.l=n;return s}function $H(e,t,r){var n=e.l+t,i=ha(e);i.r=r["!row"];var a=Xn(e),s=[i,a,"str"];if(r.cellFormula){e.l+=2;var o=Tp(e,n-e.l,r);s[3]=zc(o,null,i,r.supbooks,r)}else e.l=n;return s}var zH=Ml,WH=su;function qH(e,t){return t==null&&(t=Oe(4)),t.write_shift(4,e),t}function HH(e,t){var r=e.l+t,n=Ml(e),i=Bv(e),a=Xn(e),s=Xn(e),o=Xn(e);e.l=r;var l={rfx:n,relId:i,loc:a,display:o};return s&&(l.Tooltip=s),l}function GH(e,t){var r=Oe(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));su({s:Nn(e[0]),e:Nn(e[0])},r),Uv("rId"+t,r);var n=e[1].Target.indexOf("#"),i=n==-1?"":e[1].Target.slice(n+1);return Sn(i||"",r),Sn(e[1].Tooltip||"",r),Sn("",r),r.slice(0,r.l)}function VH(){}function KH(e,t,r){var n=e.l+t,i=f6(e),a=e.read_shift(1),s=[i];if(s[2]=a,r.cellFormula){var o=Iq(e,n-e.l,r);s[1]=o}else e.l=n;return s}function YH(e,t,r){var n=e.l+t,i=Ml(e),a=[i];if(r.cellFormula){var s=Rq(e,n-e.l,r);a[1]=s,e.l=n}else e.l=n;return a}function XH(e,t,r){r==null&&(r=Oe(18));var n=Pp(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof n.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),r.write_shift(2,i),r}var K6=["left","right","top","bottom","header","footer"];function ZH(e){var t={};return K6.forEach(function(r){t[r]=ou(e)}),t}function JH(e,t){return t==null&&(t=Oe(6*8)),G6(e),K6.forEach(function(r){Sl(e[r],t)}),t}function QH(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function eG(e,t,r){r==null&&(r=Oe(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function tG(e){var t=Oe(24);return t.write_shift(4,4),t.write_shift(4,1),su(e,t),t}function rG(e,t){return t==null&&(t=Oe(16*4+2)),t.write_shift(2,e.password?j6(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function nG(){}function iG(){}function aG(e,t,r,n,i,a,s){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=yi(t),t.z=t.z||zr[14],t.v=xi(oi(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r,c:n};switch(l.s=Do(i.cellXfs,t,i),t.l&&a["!links"].push([dr(l),t.l]),t.c&&a["!comments"].push([dr(l),t.c]),t.t){case"s":case"str":return i.bookSST?(o=Gv(i.Strings,t.v,i.revStrings),l.t="s",l.v=o,s?$e(e,18,SH(t,l)):$e(e,7,_H(t,l))):(l.t="str",s?$e(e,17,MH(t,l)):$e(e,6,DH(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?s?$e(e,13,OH(t,l)):$e(e,2,kH(t,l)):s?$e(e,16,PH(t,l)):$e(e,5,EH(t,l)),!0;case"b":return l.t="b",s?$e(e,15,gH(t,l)):$e(e,4,pH(t,l)),!0;case"e":return l.t="e",s?$e(e,14,bH(t,l)):$e(e,3,xH(t,l)),!0}return s?$e(e,12,hH(t,l)):$e(e,1,uH(t,l)),!0}function sG(e,t,r,n){var i=jr(t["!ref"]||"A1"),a,s="",o=[];$e(e,145);var l=Array.isArray(t),c=i.e.r;t["!rows"]&&(c=Math.max(i.e.r,t["!rows"].length-1));for(var u=i.s.r;u<=c;++u){s=Bn(u),nH(e,t,i,u);var h=!1;if(u<=i.e.r)for(var p=i.s.c;p<=i.e.c;++p){u===i.s.r&&(o[p]=Yn(p)),a=o[p]+s;var d=l?(t[u]||[])[p]:t[a];if(!d){h=!1;continue}h=aG(e,d,u,p,n,t,h)}}$e(e,146)}function oG(e,t){!t||!t["!merges"]||($e(e,177,qH(t["!merges"].length)),t["!merges"].forEach(function(r){$e(e,176,WH(r))}),$e(e,178))}function lG(e,t){!t||!t["!cols"]||($e(e,390),t["!cols"].forEach(function(r,n){r&&$e(e,60,XH(n,r))}),$e(e,391))}function cG(e,t){!t||!t["!ref"]||($e(e,648),$e(e,649,tG(jr(t["!ref"]))),$e(e,650))}function uG(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var i=cr(r,-1,n[1].Target.replace(/#.*$/,""),Zt.HLINK);$e(e,494,GH(n,i))}}),delete t["!links"]}function fG(e,t,r,n){if(t["!comments"].length>0){var i=cr(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",Zt.VML);$e(e,551,Uv("rId"+i)),t["!legacy"]=i}}function hG(e,t,r,n){if(t["!autofilter"]){var i=t["!autofilter"],a=typeof i.ref=="string"?i.ref:on(i.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var s=r.Workbook.Names,o=qi(a);o.s.r==o.e.r&&(o.e.r=qi(t["!ref"]).e.r,a=on(o));for(var l=0;l<s.length;++l){var c=s[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==n){c.Ref="'"+r.SheetNames[n]+"'!"+a;break}}l==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+a}),$e(e,161,su(jr(a))),$e(e,162)}}function dG(e,t,r){$e(e,133),$e(e,137,eG(t,r)),$e(e,138),$e(e,134)}function pG(e,t){t["!protect"]&&$e(e,535,rG(t["!protect"]))}function mG(e,t,r,n){var i=vi(),a=r.SheetNames[e],s=r.Sheets[a]||{},o=a;try{r&&r.Workbook&&(o=r.Workbook.Sheets[e].CodeName||o)}catch{}var l=jr(s["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return s["!links"]=[],s["!comments"]=[],$e(i,129),(r.vbaraw||s["!outline"])&&$e(i,147,lH(o,s["!outline"])),$e(i,148,aH(l)),dG(i,s,r.Workbook),lG(i,s),sG(i,s,e,t),pG(i,s),hG(i,s,r,e),oG(i,s),uG(i,s,n),s["!margins"]&&$e(i,476,JH(s["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&cG(i,s),fG(i,s,e,n),$e(i,130),i.end()}function gG(e,t){e.l+=10;var r=Xn(e);return{name:r}}var vG=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function xG(e){return!e.Workbook||!e.Workbook.WBProps?"false":YU(e.Workbook.WBProps.date1904)?"true":"false"}var yG="][*?/\\".split("");function Y6(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return yG.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function bG(e,t,r){e.forEach(function(n,i){Y6(n);for(var a=0;a<i;++a)if(n==e[a])throw new Error("Duplicate Sheet Name: "+n);if(r){var s=t&&t[i]&&t[i].CodeName||n;if(s.charCodeAt(0)==95&&s.length>22)throw new Error("Bad Code Name: Worksheet"+s)}})}function wG(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];bG(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)Wq(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}function X6(e){var t=[ln];t[t.length]=Ye("workbook",null,{xmlns:iu[0],"xmlns:r":_n.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(vG.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(n[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=Ye("workbookPr",null,n);var i=e.Workbook&&e.Workbook.Sheets||[],a=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",a=0;a!=e.SheetNames.length&&!(!i[a]||!i[a].Hidden);++a);a==e.SheetNames.length&&(a=0),t[t.length]='<workbookView firstSheet="'+a+'" activeTab="'+a+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",a=0;a!=e.SheetNames.length;++a){var s={name:hr(e.SheetNames[a].slice(0,31))};if(s.sheetId=""+(a+1),s["r:id"]="rId"+(a+1),i[a])switch(i[a].Hidden){case 1:s.state="hidden";break;case 2:s.state="veryHidden";break}t[t.length]=Ye("sheet",null,s)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=Ye("definedName",hr(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function _G(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=vg(e),r.name=Xn(e),r}function NG(e,t){return t||(t=Oe(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),Uv(e.strRelID,t),Sn(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function SG(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var i=t>8?Xn(e):"";return i.length>0&&(r.CodeName=i),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function AG(e,t){t||(t=Oe(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),l6(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function EG(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),a=x$(e),s=Mq(e,0,r),o=Bv(e);e.l=n;var l={Name:a,Ptg:s};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function TG(e,t){$e(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,i={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};$e(e,156,NG(i))}$e(e,144)}function PG(e,t){t||(t=Oe(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return Sn("SheetJS",t),Sn(od.version,t),Sn(od.version,t),Sn("7262",t),t.length>t.l?t.slice(0,t.l):t}function jG(e,t){t||(t=Oe(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function kG(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,i=-1,a=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&i==-1?i=n:r[n].Hidden==1&&a==-1&&(a=n);a>i||($e(e,135),$e(e,158,jG(i)),$e(e,136))}}function CG(e,t){var r=vi();return $e(r,131),$e(r,128,PG()),$e(r,153,AG(e.Workbook&&e.Workbook.WBProps||null)),kG(r,e),TG(r,e),$e(r,132),r.end()}function OG(e,t,r){return(t.slice(-4)===".bin"?CG:X6)(e)}function LG(e,t,r,n,i){return(t.slice(-4)===".bin"?mG:V6)(e,r,n,i)}function FG(e,t,r){return(t.slice(-4)===".bin"?Jz:O6)(e,r)}function DG(e,t,r){return(t.slice(-4)===".bin"?Az:P6)(e,r)}function IG(e,t,r){return(t.slice(-4)===".bin"?pW:M6)(e)}function MG(e){return(e.slice(-4)===".bin"?sW:D6)()}function RG(e,t){var r=[];return e.Props&&r.push(F$(e.Props,t)),e.Custprops&&r.push(D$(e.Props,e.Custprops)),r.join("")}function BG(){return""}function UG(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,i){var a=[];a.push(Ye("NumberFormat",null,{"ss:Format":hr(zr[n.numFmtId])}));var s={"ss:ID":"s"+(21+i)};r.push(Ye("Style",a.join(""),s))}),Ye("Styles",r.join(""))}function Z6(e){return Ye("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+qv(e.Ref,{r:0,c:0})})}function $G(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var i=t[n];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||r.push(Z6(i)))}return Ye("Names",r.join(""))}function zG(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var i=n.Workbook.Names,a=[],s=0;s<i.length;++s){var o=i[s];o.Sheet==r&&(o.Name.match(/^_xlfn\./)||a.push(Z6(o)))}return a.join("")}function WG(e,t,r,n){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(Ye("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(Ye("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(Ye("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)i.push(Ye("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var a=0;a<r&&!(n.Workbook.Sheets[a]&&!n.Workbook.Sheets[a].Hidden);++a);a==r&&i.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(Rn("ProtectContents","True")),e["!protect"].objects&&i.push(Rn("ProtectObjects","True")),e["!protect"].scenarios&&i.push(Rn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(Rn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(Rn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(s){e["!protect"][s[0]]&&i.push("<"+s[1]+"/>")})),i.length==0?"":Ye("WorksheetOptions",i.join(""),{xmlns:Fi.x})}function qG(e){return e.map(function(t){var r=KU(t.t||""),n=Ye("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ye("Comment",n,{"ss:Author":t.a})}).join("")}function HG(e,t,r,n,i,a,s){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+hr(qv(e.f,s))),e.F&&e.F.slice(0,t.length)==t){var l=Nn(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==s.r?"":"["+(l.r-s.r)+"]")+"C"+(l.c==s.c?"":"["+(l.c-s.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=hr(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=hr(e.l.Tooltip))),r["!merges"])for(var c=r["!merges"],u=0;u!=c.length;++u)c[u].s.c!=s.c||c[u].s.r!=s.r||(c[u].e.c>c[u].s.c&&(o["ss:MergeAcross"]=c[u].e.c-c[u].s.c),c[u].e.r>c[u].s.r&&(o["ss:MergeDown"]=c[u].e.r-c[u].s.r));var h="",p="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":h="Number",p=String(e.v);break;case"b":h="Boolean",p=e.v?"1":"0";break;case"e":h="Error",p=l0[e.v];break;case"d":h="DateTime",p=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||zr[14]);break;case"s":h="String",p=VU(e.v||"");break}var d=Do(n.cellXfs,e,n);o["ss:StyleID"]="s"+(21+d),o["ss:Index"]=s.c+1;var v=e.v!=null?p:"",g=e.t=="z"?"":'<Data ss:Type="'+h+'">'+v+"</Data>";return(e.c||[]).length>0&&(g+=qG(e.c)),Ye("Cell",g,o)}function GG(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=C6(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function VG(e,t,r,n){if(!e["!ref"])return"";var i=jr(e["!ref"]),a=e["!merges"]||[],s=0,o=[];e["!cols"]&&e["!cols"].forEach(function(y,b){zv(y);var E=!!y.width,S=Pp(b,y),P={"ss:Index":b+1};E&&(P["ss:Width"]=gd(S.width)),y.hidden&&(P["ss:Hidden"]="1"),o.push(Ye("Column",null,P))});for(var l=Array.isArray(e),c=i.s.r;c<=i.e.r;++c){for(var u=[GG(c,(e["!rows"]||[])[c])],h=i.s.c;h<=i.e.c;++h){var p=!1;for(s=0;s!=a.length;++s)if(!(a[s].s.c>h)&&!(a[s].s.r>c)&&!(a[s].e.c<h)&&!(a[s].e.r<c)){(a[s].s.c!=h||a[s].s.r!=c)&&(p=!0);break}if(!p){var d={r:c,c:h},v=dr(d),g=l?(e[c]||[])[h]:e[v];u.push(HG(g,v,e,t,r,n,d))}}u.push("</Row>"),u.length>2&&o.push(u.join(""))}return o.join("")}function KG(e,t,r){var n=[],i=r.SheetNames[e],a=r.Sheets[i],s=a?zG(a,t,e,r):"";return s.length>0&&n.push("<Names>"+s+"</Names>"),s=a?VG(a,t,e,r):"",s.length>0&&n.push("<Table>"+s+"</Table>"),n.push(WG(a,t,e,r)),n.join("")}function YG(e,t){t||(t={}),e.SSF||(e.SSF=yi(zr)),e.SSF&&(Np(),_p(e.SSF),t.revssf=Sp(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],Do(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(RG(e,t)),r.push(BG()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(Ye("Worksheet",KG(n,t,e),{"ss:Name":hr(e.SheetNames[n])}));return r[2]=UG(e,t),r[3]=$G(e),ln+Ye("Workbook",r.join(""),{xmlns:Fi.ss,"xmlns:o":Fi.o,"xmlns:x":Fi.x,"xmlns:ss":Fi.ss,"xmlns:dt":Fi.dt,"xmlns:html":Fi.html})}var V1={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function XG(e,t){var r=[],n=[],i=[],a=0,s,o=B5(J5,"n"),l=B5(Q5,"n");if(e.Props)for(s=Un(e.Props),a=0;a<s.length;++a)(Object.prototype.hasOwnProperty.call(o,s[a])?r:Object.prototype.hasOwnProperty.call(l,s[a])?n:i).push([s[a],e.Props[s[a]]]);if(e.Custprops)for(s=Un(e.Custprops),a=0;a<s.length;++a)Object.prototype.hasOwnProperty.call(e.Props||{},s[a])||(Object.prototype.hasOwnProperty.call(o,s[a])?r:Object.prototype.hasOwnProperty.call(l,s[a])?n:i).push([s[a],e.Custprops[s[a]]]);var c=[];for(a=0;a<i.length;++a)w6.indexOf(i[a][0])>-1||x6.indexOf(i[a][0])>-1||i[a][1]!=null&&c.push(i[a]);n.length&&gr.utils.cfb_add(t,"/SummaryInformation",iw(n,V1.SI,l,Q5)),(r.length||c.length)&&gr.utils.cfb_add(t,"/DocumentSummaryInformation",iw(r,V1.DSI,o,J5,c.length?c:null,V1.UDI))}function ZG(e,t){var r=t||{},n=gr.utils.cfb_new({root:"R"}),i="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":i="/Workbook",r.biff=8;break;case"biff5":i="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return gr.utils.cfb_add(n,i,J6(e,r)),r.biff==8&&(e.Props||e.Custprops)&&XG(e,n),r.biff==8&&e.vbaraw&&mW(n,gr.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var JG={0:{f:tH},1:{f:cH},2:{f:jH},3:{f:vH},4:{f:dH},5:{f:AH},6:{f:FH},7:{f:wH},8:{f:$H},9:{f:UH},10:{f:RH},11:{f:BH},12:{f:fH},13:{f:CH},14:{f:yH},15:{f:mH},16:{f:TH},17:{f:IH},18:{f:NH},19:{f:Rv},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:EG},40:{},42:{},43:{f:Fz},44:{f:Oz},45:{f:Mz},46:{f:Bz},47:{f:Rz},48:{},49:{f:f$},50:{},51:{f:tW},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:hz},62:{f:LH},63:{f:oW},64:{f:nG},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:as,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:QH},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:oH},148:{f:iH,p:16},151:{f:VH},152:{},153:{f:SG},154:{},155:{},156:{f:_G},157:{},158:{},159:{T:1,f:_z},160:{T:-1},161:{T:1,f:Ml},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:zH},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Qz},336:{T:-1},337:{f:iW,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:vg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:sz},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:KH},427:{f:YH},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:ZH},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:sH},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:HH},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:vg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:hW},633:{T:1},634:{T:-1},635:{T:1,f:uW},636:{T:-1},637:{f:m$},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:gG},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:iG},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Xe(e,t,r,n){var i=t;if(!isNaN(i)){var a=n||(r||[]).length||0,s=e.next(4);s.write_shift(2,i),s.write_shift(2,a),a>0&&Dv(r)&&e.push(r)}}function QG(e,t,r,n){var i=(r||[]).length||0;if(i<=8224)return Xe(e,t,r,i);var a=t;if(!isNaN(a)){for(var s=r.parts||[],o=0,l=0,c=0;c+(s[o]||8224)<=8224;)c+=s[o]||8224,o++;var u=e.next(4);for(u.write_shift(2,a),u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c;l<i;){for(u=e.next(4),u.write_shift(2,60),c=0;c+(s[o]||8224)<=8224;)c+=s[o]||8224,o++;u.write_shift(2,c),e.push(r.slice(l,l+c)),l+=c}}}function u0(e,t,r){return e||(e=Oe(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function eV(e,t,r,n){var i=Oe(9);return u0(i,e,t),N6(r,n||"b",i),i}function tV(e,t,r){var n=Oe(8+2*r.length);return u0(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function rV(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?xi(oi(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?Xe(e,2,gz(r,n,i)):Xe(e,3,mz(r,n,i));return;case"b":case"e":Xe(e,5,eV(r,n,t.v,t.t));return;case"s":case"str":Xe(e,4,tV(r,n,(t.v||"").slice(0,255)));return}Xe(e,1,u0(null,r,n))}function nV(e,t,r,n){var i=Array.isArray(t),a=jr(t["!ref"]||"A1"),s,o="",l=[];if(a.e.c>255||a.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");a.e.c=Math.min(a.e.c,255),a.e.r=Math.min(a.e.c,16383),s=on(a)}for(var c=a.s.r;c<=a.e.r;++c){o=Bn(c);for(var u=a.s.c;u<=a.e.c;++u){c===a.s.r&&(l[u]=Yn(u)),s=l[u]+o;var h=i?(t[c]||[])[u]:t[s];h&&rV(e,h,c,u)}}}function iV(e,t){for(var r=t||{},n=vi(),i=0,a=0;a<e.SheetNames.length;++a)e.SheetNames[a]==r.sheet&&(i=a);if(i==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return Xe(n,r.biff==4?1033:r.biff==3?521:9,$v(e,16,r)),nV(n,e.Sheets[e.SheetNames[i]],i,r),Xe(n,10),n.end()}function aV(e,t,r){Xe(e,49,J$({sz:12,color:{theme:1},name:"Arial",family:2,scheme:"minor"},r))}function sV(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var i=n[0];i<=n[1];++i)t[i]!=null&&Xe(e,1054,tz(i,t[i],r))})}function oV(e,t){var r=Oe(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),Xe(e,2151,r),r=Oe(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),E6(jr(t["!ref"]||"A1"),r),r.write_shift(4,4),Xe(e,2152,r)}function lV(e,t){for(var r=0;r<16;++r)Xe(e,224,sw({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){Xe(e,224,sw(n,0,t))})}function cV(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];Xe(e,440,cz(n)),n[1].Tooltip&&Xe(e,2048,uz(n))}delete t["!links"]}function uV(e,t){if(t){var r=0;t.forEach(function(n,i){++r<=256&&n&&Xe(e,125,dz(Pp(i,n),i))})}}function fV(e,t,r,n,i){var a=16+Do(i.cellXfs,t,i);if(t.v==null&&!t.bf){Xe(e,513,Al(r,n,a));return}if(t.bf)Xe(e,6,Dq(t,r,n,i,a));else switch(t.t){case"d":case"n":var s=t.t=="d"?xi(oi(t.v)):t.v;Xe(e,515,az(r,n,s,a));break;case"b":case"e":Xe(e,517,iz(r,n,t.v,a,i,t.t));break;case"s":case"str":if(i.bookSST){var o=Gv(i.Strings,t.v,i.revStrings);Xe(e,253,Q$(r,n,o,a))}else Xe(e,516,ez(r,n,(t.v||"").slice(0,255),a,i));break;default:Xe(e,513,Al(r,n,a))}}function hV(e,t,r){var n=vi(),i=r.SheetNames[e],a=r.Sheets[i]||{},s=(r||{}).Workbook||{},o=(s.Sheets||[])[e]||{},l=Array.isArray(a),c=t.biff==8,u,h="",p=[],d=jr(a["!ref"]||"A1"),v=c?65536:16384;if(d.e.c>255||d.e.r>=v){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:IV16384");d.e.c=Math.min(d.e.c,255),d.e.r=Math.min(d.e.c,v-1)}Xe(n,2057,$v(r,16,t)),Xe(n,13,na(1)),Xe(n,12,na(100)),Xe(n,15,ii(!0)),Xe(n,17,ii(!1)),Xe(n,16,Sl(.001)),Xe(n,95,ii(!0)),Xe(n,42,ii(!1)),Xe(n,43,ii(!1)),Xe(n,130,na(1)),Xe(n,128,nz()),Xe(n,131,ii(!1)),Xe(n,132,ii(!1)),c&&uV(n,a["!cols"]),Xe(n,512,rz(d,t)),c&&(a["!links"]=[]);for(var g=d.s.r;g<=d.e.r;++g){h=Bn(g);for(var y=d.s.c;y<=d.e.c;++y){g===d.s.r&&(p[y]=Yn(y)),u=p[y]+h;var b=l?(a[g]||[])[y]:a[u];b&&(fV(n,b,g,y,t),c&&b.l&&a["!links"].push([u,b.l]))}}var E=o.CodeName||o.name||i;return c&&Xe(n,574,Z$((s.Views||[])[0])),c&&(a["!merges"]||[]).length&&Xe(n,229,lz(a["!merges"])),c&&cV(n,a),Xe(n,442,A6(E)),c&&oV(n,a),Xe(n,10),n.end()}function dV(e,t,r){var n=vi(),i=(e||{}).Workbook||{},a=i.Sheets||[],s=i.WBProps||{},o=r.biff==8,l=r.biff==5;if(Xe(n,2057,$v(e,5,r)),r.bookType=="xla"&&Xe(n,135),Xe(n,225,o?na(1200):null),Xe(n,193,R$(2)),l&&Xe(n,191),l&&Xe(n,192),Xe(n,226),Xe(n,92,V$("SheetJS",r)),Xe(n,66,na(o?1200:1252)),o&&Xe(n,353,na(0)),o&&Xe(n,448),Xe(n,317,pz(e.SheetNames.length)),o&&e.vbaraw&&Xe(n,211),o&&e.vbaraw){var c=s.CodeName||"ThisWorkbook";Xe(n,442,A6(c))}Xe(n,156,na(17)),Xe(n,25,ii(!1)),Xe(n,18,ii(!1)),Xe(n,19,na(0)),o&&Xe(n,431,ii(!1)),o&&Xe(n,444,na(0)),Xe(n,61,X$()),Xe(n,64,ii(!1)),Xe(n,141,na(0)),Xe(n,34,ii(xG(e)=="true")),Xe(n,14,ii(!0)),o&&Xe(n,439,ii(!1)),Xe(n,218,na(0)),aV(n,e,r),sV(n,e.SSF,r),lV(n,r),o&&Xe(n,352,ii(!1));var u=n.end(),h=vi();o&&Xe(h,140,fz()),o&&r.Strings&&QG(h,252,Y$(r.Strings)),Xe(h,10);var p=h.end(),d=vi(),v=0,g=0;for(g=0;g<e.SheetNames.length;++g)v+=(o?12:11)+(o?2:1)*e.SheetNames[g].length;var y=u.length+v+p.length;for(g=0;g<e.SheetNames.length;++g){var b=a[g]||{};Xe(d,133,K$({pos:y,hs:b.Hidden||0,dt:0,name:e.SheetNames[g]},r)),y+=t[g].length}var E=d.end();if(v!=E.length)throw new Error("BS8 "+v+" != "+E.length);var S=[];return u.length&&S.push(u),E.length&&S.push(E),p.length&&S.push(p),Mn(S)}function pV(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=yi(zr)),e&&e.SSF&&(Np(),_p(e.SSF),r.revssf=Sp(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Vv(r),r.cellXfs=[],Do(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)n[n.length]=hV(i,r,e);return n.unshift(dV(e,n,r)),Mn(n)}function J6(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var i=qi(n["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var a=t||{};switch(a.biff||2){case 8:case 5:return pV(e,t);case 4:case 3:case 2:return iV(e,t)}throw new Error("invalid type "+a.bookType+" for BIFF")}function mV(e,t,r,n){for(var i=e["!merges"]||[],a=[],s=t.s.c;s<=t.e.c;++s){for(var o=0,l=0,c=0;c<i.length;++c)if(!(i[c].s.r>r||i[c].s.c>s)&&!(i[c].e.r<r||i[c].e.c<s)){if(i[c].s.r<r||i[c].s.c<s){o=-1;break}o=i[c].e.r-i[c].s.r+1,l=i[c].e.c-i[c].s.c+1;break}if(!(o<0)){var u=dr({r,c:s}),h=n.dense?(e[r]||[])[s]:e[u],p=h&&h.v!=null&&(h.h||GU(h.w||(Bs(h),h.w)||""))||"",d={};o>1&&(d.rowspan=o),l>1&&(d.colspan=l),n.editable?p='<span contenteditable="true">'+p+"</span>":h&&(d["data-t"]=h&&h.t||"z",h.v!=null&&(d["data-v"]=h.v),h.z!=null&&(d["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+h.l.Target+'">'+p+"</a>")),d.id=(n.id||"sjs")+"-"+u,a.push(Ye("td",p,d))}}var v="<tr>";return v+a.join("")+"</tr>"}var gV='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',vV="</body></html>";function xV(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Q6(e,t){var r=t||{},n=r.header!=null?r.header:gV,i=r.footer!=null?r.footer:vV,a=[n],s=qi(e["!ref"]);r.dense=Array.isArray(e),a.push(xV(e,s,r));for(var o=s.s.r;o<=s.e.r;++o)a.push(mV(e,s,o,r));return a.push("</table>"+i),a.join("")}function eE(e,t,r){var n=r||{},i=0,a=0;if(n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var s=typeof n.origin=="string"?Nn(n.origin):n.origin;i=s.r,a=s.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:i,c:a}};if(e["!ref"]){var u=qi(e["!ref"]);c.s.r=Math.min(c.s.r,u.s.r),c.s.c=Math.min(c.s.c,u.s.c),c.e.r=Math.max(c.e.r,u.e.r),c.e.c=Math.max(c.e.c,u.e.c),i==-1&&(c.e.r=i=u.e.r+1)}var h=[],p=0,d=e["!rows"]||(e["!rows"]=[]),v=0,g=0,y=0,b=0,E=0,S=0;for(e["!cols"]||(e["!cols"]=[]);v<o.length&&g<l;++v){var P=o[v];if(dw(P)){if(n.display)continue;d[g]={hidden:!0}}var L=P.children;for(y=b=0;y<L.length;++y){var q=L[y];if(!(n.display&&dw(q))){var C=q.hasAttribute("data-v")?q.getAttribute("data-v"):q.hasAttribute("v")?q.getAttribute("v"):XU(q.innerHTML),R=q.getAttribute("data-z")||q.getAttribute("z");for(p=0;p<h.length;++p){var k=h[p];k.s.c==b+a&&k.s.r<g+i&&g+i<=k.e.r&&(b=k.e.c+1-a,p=-1)}S=+q.getAttribute("colspan")||1,((E=+q.getAttribute("rowspan")||1)>1||S>1)&&h.push({s:{r:g+i,c:b+a},e:{r:g+i+(E||1)-1,c:b+a+(S||1)-1}});var G={t:"s",v:C},_=q.getAttribute("data-t")||q.getAttribute("t")||"";C!=null&&(C.length==0?G.t=_||"z":n.raw||C.trim().length==0||_=="s"||(C==="TRUE"?G={t:"b",v:!0}:C==="FALSE"?G={t:"b",v:!1}:isNaN(ks(C))?isNaN(Cf(C).getDate())||(G={t:"d",v:oi(C)},n.cellDates||(G={t:"n",v:xi(G.v)}),G.z=n.dateNF||zr[14]):G={t:"n",v:ks(C)})),G.z===void 0&&R!=null&&(G.z=R);var j="",H=q.getElementsByTagName("A");if(H&&H.length)for(var X=0;X<H.length&&!(H[X].hasAttribute("href")&&(j=H[X].getAttribute("href"),j.charAt(0)!="#"));++X);j&&j.charAt(0)!="#"&&(G.l={Target:j}),n.dense?(e[g+i]||(e[g+i]=[]),e[g+i][b+a]=G):e[dr({c:b+a,r:g+i})]=G,c.e.c<b+a&&(c.e.c=b+a),b+=S}}++g}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),c.e.r=Math.max(c.e.r,g-1+i),e["!ref"]=on(c),g>=l&&(e["!fullref"]=on((c.e.r=o.length-v+g-1+i,c))),e}function tE(e,t){var r=t||{},n=r.dense?[]:{};return eE(n,e,t)}function yV(e,t){return Ll(tE(e,t),t)}function dw(e){var t="",r=bV(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function bV(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var wV=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+Lf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return ln+t}}(),pw=function(){var e=function(a){return hr(a).replace(/  +/g,function(s){return'<text:s text:c="'+s.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(a,s,o){var l=[];l.push('      <table:table table:name="'+hr(s.SheetNames[o])+`" table:style-name="ta1">
`);var c=0,u=0,h=qi(a["!ref"]||"A1"),p=a["!merges"]||[],d=0,v=Array.isArray(a);if(a["!cols"])for(u=0;u<=h.e.c;++u)l.push("        <table:table-column"+(a["!cols"][u]?' table:style-name="co'+a["!cols"][u].ods+'"':"")+`></table:table-column>
`);var g="",y=a["!rows"]||[];for(c=0;c<h.s.r;++c)g=y[c]?' table:style-name="ro'+y[c].ods+'"':"",l.push("        <table:table-row"+g+`></table:table-row>
`);for(;c<=h.e.r;++c){for(g=y[c]?' table:style-name="ro'+y[c].ods+'"':"",l.push("        <table:table-row"+g+`>
`),u=0;u<h.s.c;++u)l.push(t);for(;u<=h.e.c;++u){var b=!1,E={},S="";for(d=0;d!=p.length;++d)if(!(p[d].s.c>u)&&!(p[d].s.r>c)&&!(p[d].e.c<u)&&!(p[d].e.r<c)){(p[d].s.c!=u||p[d].s.r!=c)&&(b=!0),E["table:number-columns-spanned"]=p[d].e.c-p[d].s.c+1,E["table:number-rows-spanned"]=p[d].e.r-p[d].s.r+1;break}if(b){l.push(r);continue}var P=dr({r:c,c:u}),L=v?(a[c]||[])[u]:a[P];if(L&&L.f&&(E["table:formula"]=hr($q(L.f)),L.F&&L.F.slice(0,P.length)==P)){var q=qi(L.F);E["table:number-matrix-columns-spanned"]=q.e.c-q.s.c+1,E["table:number-matrix-rows-spanned"]=q.e.r-q.s.r+1}if(!L){l.push(t);continue}switch(L.t){case"b":S=L.v?"TRUE":"FALSE",E["office:value-type"]="boolean",E["office:boolean-value"]=L.v?"true":"false";break;case"n":S=L.w||String(L.v||0),E["office:value-type"]="float",E["office:value"]=L.v||0;break;case"s":case"str":S=L.v==null?"":L.v,E["office:value-type"]="string";break;case"d":S=L.w||oi(L.v).toISOString(),E["office:value-type"]="date",E["office:date-value"]=oi(L.v).toISOString(),E["table:style-name"]="ce1";break;default:l.push(t);continue}var C=e(S);if(L.l&&L.l.Target){var R=L.l.Target;R=R.charAt(0)=="#"?"#"+zq(R.slice(1)):R,R.charAt(0)!="#"&&!R.match(/^\w+:/)&&(R="../"+R),C=Ye("text:a",C,{"xlink:href":R.replace(/&/g,"&amp;")})}l.push("          "+Ye("table:table-cell",Ye("text:p",C,{}),E)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(a,s){a.push(` <office:automatic-styles>
`),a.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),a.push(`   <number:month number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:day number:style="long"/>
`),a.push(`   <number:text>/</number:text>
`),a.push(`   <number:year/>
`),a.push(`  </number:date-style>
`);var o=0;s.SheetNames.map(function(c){return s.Sheets[c]}).forEach(function(c){if(c&&c["!cols"]){for(var u=0;u<c["!cols"].length;++u)if(c["!cols"][u]){var h=c["!cols"][u];if(h.width==null&&h.wpx==null&&h.wch==null)continue;zv(h),h.ods=o;var p=c["!cols"][u].wpx+"px";a.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),a.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),a.push(`  </style:style>
`),++o}}});var l=0;s.SheetNames.map(function(c){return s.Sheets[c]}).forEach(function(c){if(c&&c["!rows"]){for(var u=0;u<c["!rows"].length;++u)if(c["!rows"][u]){c["!rows"][u].ods=l;var h=c["!rows"][u].hpx+"px";a.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),a.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),a.push(`  </style:style>
`),++l}}}),a.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),a.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),a.push(`  </style:style>
`),a.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),a.push(` </office:automatic-styles>
`)};return function(s,o){var l=[ln],c=Lf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),u=Lf({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+c+u+`>
`),l.push(g6().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+c+`>
`),i(l,s),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=s.SheetNames.length;++h)l.push(n(s.Sheets[s.SheetNames[h]],s,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function rE(e,t){if(t.bookType=="fods")return pw(e,t);var r=Cv(),n="",i=[],a=[];return n="mimetype",Bt(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",Bt(r,n,pw(e,t)),i.push([n,"text/xml"]),a.push([n,"ContentFile"]),n="styles.xml",Bt(r,n,wV(e,t)),i.push([n,"text/xml"]),a.push([n,"StylesFile"]),n="meta.xml",Bt(r,n,ln+g6()),i.push([n,"text/xml"]),a.push([n,"MetadataFile"]),n="manifest.rdf",Bt(r,n,L$(a)),i.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",Bt(r,n,C$(i)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function yd(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function _V(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Ta(Of(e))}function NV(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function Po(e){var t=e.reduce(function(i,a){return i+a.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(i){r.set(i,n),n+=i.length}),r}function SV(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,i=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var a=0;i>=1;++a,i/=256)e[t+a]=i&255;e[t+15]|=r>=0?0:128}function Ff(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function lr(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function Nc(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function pn(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],i=Ff(e,r),a=i&7;i=Math.floor(i/8);var s=0,o;if(i==0)break;switch(a){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:s=4,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 1:s=8,o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 2:s=Ff(e,r),o=e.slice(r[0],r[0]+s),r[0]+=s;break;case 3:case 4:default:throw new Error("PB Type ".concat(a," for Field ").concat(i," at offset ").concat(n))}var c={data:o,type:a};t[i]==null?t[i]=[c]:t[i].push(c)}return t}function On(e){var t=[];return e.forEach(function(r,n){r.forEach(function(i){i.data&&(t.push(lr(n*8+i.type)),i.type==2&&t.push(lr(i.data.length)),t.push(i.data))})}),Po(t)}function _a(e){for(var t,r=[],n=[0];n[0]<e.length;){var i=Ff(e,n),a=pn(e.slice(n[0],n[0]+i));n[0]+=i;var s={id:Nc(a[1][0].data),messages:[]};a[2].forEach(function(o){var l=pn(o.data),c=Nc(l[3][0].data);s.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=a[3])!=null&&t[0]&&(s.merge=Nc(a[3][0].data)>>>0>0),r.push(s)}return r}function tc(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:lr(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:lr(+!!r.merge),type:0}]);var i=[];r.messages.forEach(function(s){i.push(s.data),s.meta[3]=[{type:0,data:lr(s.data.length)}],n[2].push({data:On(s.meta),type:2})});var a=On(n);t.push(lr(a.length)),t.push(a),i.forEach(function(s){return t.push(s)})}),Po(t)}function AV(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Ff(t,r),i=[];r[0]<t.length;){var a=t[r[0]]&3;if(a==0){var s=t[r[0]++]>>2;if(s<60)++s;else{var o=s-59;s=t[r[0]],o>1&&(s|=t[r[0]+1]<<8),o>2&&(s|=t[r[0]+2]<<16),o>3&&(s|=t[r[0]+3]<<24),s>>>=0,s++,r[0]+=o}i.push(t.slice(r[0],r[0]+s)),r[0]+=s;continue}else{var l=0,c=0;if(a==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,a==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),i=[Po(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(i.push(i[0].slice(-l)),c-=l;c>=i[i.length-1].length;)i.push(i[i.length-1]),c-=i[i.length-1].length;i.push(i[0].slice(-l,-l+c))}}var u=Po(i);if(u.length!=n)throw new Error("Unexpected length: ".concat(u.length," != ").concat(n));return u}function Na(e){for(var t=[],r=0;r<e.length;){var n=e[r++],i=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(AV(n,e.slice(r,r+i))),r+=i}if(r!==e.length)throw new Error("data is not a valid framed stream!");return Po(t)}function rc(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),i=new Uint8Array(4);t.push(i);var a=lr(n),s=a.length;t.push(a),n<=60?(s++,t.push(new Uint8Array([n-1<<2]))):n<=256?(s+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(s+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(s+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(s+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),s+=n,i[0]=0,i[1]=s&255,i[2]=s>>8&255,i[3]=s>>16&255,r+=n}return Po(t)}function K1(e,t){var r=new Uint8Array(32),n=yd(r),i=12,a=0;switch(r[0]=5,e.t){case"n":r[1]=2,SV(r,i,e.v),a|=1,i+=16;break;case"b":r[1]=6,n.setFloat64(i,e.v?1:0,!0),a|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(i,t.indexOf(e.v),!0),a|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,a,!0),r.slice(0,i)}function Y1(e,t){var r=new Uint8Array(32),n=yd(r),i=12,a=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(i,e.v,!0),a|=32,i+=8;break;case"b":r[2]=6,n.setFloat64(i,e.v?1:0,!0),a|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(i,t.indexOf(e.v),!0),a|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,a,!0),r.slice(0,i)}function oo(e){var t=pn(e);return Ff(t[1][0].data)}function EV(e,t,r){var n,i,a,s;if(!((n=e[6])!=null&&n[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((s=(a=e[8])==null?void 0:a[0])==null?void 0:s.data)&&Nc(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,c=yd(e[7][0].data),u=0,h=[],p=yd(e[4][0].data),d=0,v=[],g=0;g<t.length;++g){if(t[g]==null){c.setUint16(g*2,65535,!0),p.setUint16(g*2,65535);continue}c.setUint16(g*2,u,!0),p.setUint16(g*2,d,!0);var y,b;switch(typeof t[g]){case"string":y=K1({t:"s",v:t[g]},r),b=Y1({t:"s",v:t[g]},r);break;case"number":y=K1({t:"n",v:t[g]},r),b=Y1({t:"n",v:t[g]},r);break;case"boolean":y=K1({t:"b",v:t[g]},r),b=Y1({t:"b",v:t[g]},r);break;default:throw new Error("Unsupported value "+t[g])}h.push(y),u+=y.length,v.push(b),d+=b.length,++l}for(e[2][0].data=lr(l);g<e[7][0].data.length/2;++g)c.setUint16(g*2,65535,!0),p.setUint16(g*2,65535,!0);return e[6][0].data=Po(h),e[3][0].data=Po(v),l}function TV(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=qi(r["!ref"]);n.s.r=n.s.c=0;var i=!1;n.e.c>9&&(i=!0,n.e.c=9),n.e.r>49&&(i=!0,n.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(on(n)));var a=bd(r,{range:n,header:1}),s=["~Sh33tJ5~"];a.forEach(function(F){return F.forEach(function(O){typeof O=="string"&&s.push(O)})});var o={},l=[],c=gr.read(t.numbers,{type:"base64"});c.FileIndex.map(function(F,O){return[F,c.FullPaths[O]]}).forEach(function(F){var O=F[0],M=F[1];if(O.type==2&&O.name.match(/\.iwa/)){var J=O.content,fe=Na(J),ve=_a(fe);ve.forEach(function(ae){l.push(ae.id),o[ae.id]={deps:[],location:M,type:Nc(ae.messages[0].meta[1][0].data)}})}}),l.sort(function(F,O){return F-O});var u=l.filter(function(F){return F>1}).map(function(F){return[F,lr(F)]});c.FileIndex.map(function(F,O){return[F,c.FullPaths[O]]}).forEach(function(F){var O=F[0];if(F[1],!!O.name.match(/\.iwa/)){var M=_a(Na(O.content));M.forEach(function(J){J.messages.forEach(function(fe){u.forEach(function(ve){J.messages.some(function(ae){return Nc(ae.meta[1][0].data)!=11006&&NV(ae.data,ve[1])})&&o[ve[0]].deps.push(J.id)})})})}});for(var h=gr.find(c,o[1].location),p=_a(Na(h.content)),d,v=0;v<p.length;++v){var g=p[v];g.id==1&&(d=g)}var y=oo(pn(d.messages[0].data)[1][0].data);for(h=gr.find(c,o[y].location),p=_a(Na(h.content)),v=0;v<p.length;++v)g=p[v],g.id==y&&(d=g);for(y=oo(pn(d.messages[0].data)[2][0].data),h=gr.find(c,o[y].location),p=_a(Na(h.content)),v=0;v<p.length;++v)g=p[v],g.id==y&&(d=g);for(y=oo(pn(d.messages[0].data)[2][0].data),h=gr.find(c,o[y].location),p=_a(Na(h.content)),v=0;v<p.length;++v)g=p[v],g.id==y&&(d=g);var b=pn(d.messages[0].data);{b[6][0].data=lr(n.e.r+1),b[7][0].data=lr(n.e.c+1);var E=oo(b[46][0].data),S=gr.find(c,o[E].location),P=_a(Na(S.content));{for(var L=0;L<P.length&&P[L].id!=E;++L);if(P[L].id!=E)throw"Bad ColumnRowUIDMapArchive";var q=pn(P[L].messages[0].data);q[1]=[],q[2]=[],q[3]=[];for(var C=0;C<=n.e.c;++C){var R=[];R[1]=R[2]=[{type:0,data:lr(C+420690)}],q[1].push({type:2,data:On(R)}),q[2].push({type:0,data:lr(C)}),q[3].push({type:0,data:lr(C)})}q[4]=[],q[5]=[],q[6]=[];for(var k=0;k<=n.e.r;++k)R=[],R[1]=R[2]=[{type:0,data:lr(k+726270)}],q[4].push({type:2,data:On(R)}),q[5].push({type:0,data:lr(k)}),q[6].push({type:0,data:lr(k)});P[L].messages[0].data=On(q)}S.content=rc(tc(P)),S.size=S.content.length,delete b[46];var G=pn(b[4][0].data);{G[7][0].data=lr(n.e.r+1);var _=pn(G[1][0].data),j=oo(_[2][0].data);S=gr.find(c,o[j].location),P=_a(Na(S.content));{if(P[0].id!=j)throw"Bad HeaderStorageBucket";var H=pn(P[0].messages[0].data);for(k=0;k<a.length;++k){var X=pn(H[2][0].data);X[1][0].data=lr(k),X[4][0].data=lr(a[k].length),H[2][k]={type:H[2][0].type,data:On(X)}}P[0].messages[0].data=On(H)}S.content=rc(tc(P)),S.size=S.content.length;var ce=oo(G[2][0].data);S=gr.find(c,o[ce].location),P=_a(Na(S.content));{if(P[0].id!=ce)throw"Bad HeaderStorageBucket";for(H=pn(P[0].messages[0].data),C=0;C<=n.e.c;++C)X=pn(H[2][0].data),X[1][0].data=lr(C),X[4][0].data=lr(n.e.r+1),H[2][C]={type:H[2][0].type,data:On(X)};P[0].messages[0].data=On(H)}S.content=rc(tc(P)),S.size=S.content.length;var pe=oo(G[4][0].data);(function(){for(var F=gr.find(c,o[pe].location),O=_a(Na(F.content)),M,J=0;J<O.length;++J){var fe=O[J];fe.id==pe&&(M=fe)}var ve=pn(M.messages[0].data);{ve[3]=[];var ae=[];s.forEach(function(le,Be){ae[1]=[{type:0,data:lr(Be)}],ae[2]=[{type:0,data:lr(1)}],ae[3]=[{type:2,data:_V(le)}],ve[3].push({type:2,data:On(ae)})})}M.messages[0].data=On(ve);var ue=tc(O),oe=rc(ue);F.content=oe,F.size=F.content.length})();var ye=pn(G[3][0].data);{var me=ye[1][0];delete ye[2];var be=pn(me.data);{var Ue=oo(be[2][0].data);(function(){for(var F=gr.find(c,o[Ue].location),O=_a(Na(F.content)),M,J=0;J<O.length;++J){var fe=O[J];fe.id==Ue&&(M=fe)}var ve=pn(M.messages[0].data);{delete ve[6],delete ye[7];var ae=new Uint8Array(ve[5][0].data);ve[5]=[];for(var ue=0,oe=0;oe<=n.e.r;++oe){var le=pn(ae);ue+=EV(le,a[oe],s),le[1][0].data=lr(oe),ve[5].push({data:On(le),type:2})}ve[1]=[{type:0,data:lr(n.e.c+1)}],ve[2]=[{type:0,data:lr(n.e.r+1)}],ve[3]=[{type:0,data:lr(ue)}],ve[4]=[{type:0,data:lr(n.e.r+1)}]}M.messages[0].data=On(ve);var Be=tc(O),ge=rc(Be);F.content=ge,F.size=F.content.length})()}me.data=On(be)}G[3][0].data=On(ye)}b[4][0].data=On(G)}d.messages[0].data=On(b);var Fe=tc(p),A=rc(Fe);return h.content=A,h.size=h.content.length,c}function PV(e){return function(r){for(var n=0;n!=e.length;++n){var i=e[n];r[i[0]]===void 0&&(r[i[0]]=i[1]),i[2]==="n"&&(r[i[0]]=Number(r[i[0]]))}}}function Vv(e){PV([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function jV(e,t){return t.bookType=="ods"?rE(e,t):t.bookType=="numbers"?TV(e,t):t.bookType=="xlsb"?kV(e,t):CV(e,t)}function kV(e,t){dc=1024,e&&!e.SSF&&(e.SSF=yi(zr)),e&&e.SSF&&(Np(),_p(e.SSF),t.revssf=Sp(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,hf?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=R6.indexOf(t.bookType)>-1,i=d6();Vv(t=t||{});var a=Cv(),s="",o=0;if(t.cellXfs=[],Do(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Bt(a,s,v6(e.Props,t)),i.coreprops.push(s),cr(t.rels,2,s,Zt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,Bt(a,s,y6(e.Props)),i.extprops.push(s),cr(t.rels,3,s,Zt.EXT_PROPS),e.Custprops!==e.Props&&Un(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Bt(a,s,b6(e.Custprops)),i.custprops.push(s),cr(t.rels,4,s,Zt.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var u={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,Bt(a,s,LG(o-1,s,t,e,u)),i.sheets.push(s),cr(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Zt.WS[0])}if(h){var d=h["!comments"],v=!1,g="";d&&d.length>0&&(g="xl/comments"+o+"."+r,Bt(a,g,IG(d,g)),i.comments.push(g),cr(u,-1,"../comments"+o+"."+r,Zt.CMNT),v=!0),h["!legacy"]&&v&&Bt(a,"xl/drawings/vmlDrawing"+o+".vml",I6(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}u["!id"].rId1&&Bt(a,m6(s),wc(u))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,Bt(a,s,DG(t.Strings,s,t)),i.strs.push(s),cr(t.wbrels,-1,"sharedStrings."+r,Zt.SST)),s="xl/workbook."+r,Bt(a,s,OG(e,s)),i.workbooks.push(s),cr(t.rels,1,s,Zt.WB),s="xl/theme/theme1.xml",Bt(a,s,F6(e.Themes,t)),i.themes.push(s),cr(t.wbrels,-1,"theme/theme1.xml",Zt.THEME),s="xl/styles."+r,Bt(a,s,FG(e,s,t)),i.styles.push(s),cr(t.wbrels,-1,"styles."+r,Zt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",Bt(a,s,e.vbaraw),i.vba.push(s),cr(t.wbrels,-1,"vbaProject.bin",Zt.VBA)),s="xl/metadata."+r,Bt(a,s,MG(s)),i.metadata.push(s),cr(t.wbrels,-1,"metadata."+r,Zt.XLMETA),Bt(a,"[Content_Types].xml",p6(i,t)),Bt(a,"_rels/.rels",wc(t.rels)),Bt(a,"xl/_rels/workbook."+r+".rels",wc(t.wbrels)),delete t.revssf,delete t.ssf,a}function CV(e,t){dc=1024,e&&!e.SSF&&(e.SSF=yi(zr)),e&&e.SSF&&(Np(),_p(e.SSF),t.revssf=Sp(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,hf?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=R6.indexOf(t.bookType)>-1,i=d6();Vv(t=t||{});var a=Cv(),s="",o=0;if(t.cellXfs=[],Do(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),s="docProps/core.xml",Bt(a,s,v6(e.Props,t)),i.coreprops.push(s),cr(t.rels,2,s,Zt.CORE_PROPS),s="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],c=0;c<e.SheetNames.length;++c)(e.Workbook.Sheets[c]||{}).Hidden!=2&&l.push(e.SheetNames[c]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,Bt(a,s,y6(e.Props)),i.extprops.push(s),cr(t.rels,3,s,Zt.EXT_PROPS),e.Custprops!==e.Props&&Un(e.Custprops||{}).length>0&&(s="docProps/custom.xml",Bt(a,s,b6(e.Custprops)),i.custprops.push(s),cr(t.rels,4,s,Zt.CUST_PROPS));var u=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var h={"!id":{}},p=e.Sheets[e.SheetNames[o-1]],d=(p||{})["!type"]||"sheet";switch(d){case"chart":default:s="xl/worksheets/sheet"+o+"."+r,Bt(a,s,V6(o-1,t,e,h)),i.sheets.push(s),cr(t.wbrels,-1,"worksheets/sheet"+o+"."+r,Zt.WS[0])}if(p){var v=p["!comments"],g=!1,y="";if(v&&v.length>0){var b=!1;v.forEach(function(E){E[1].forEach(function(S){S.T==!0&&(b=!0)})}),b&&(y="xl/threadedComments/threadedComment"+o+"."+r,Bt(a,y,lW(v,u,t)),i.threadedcomments.push(y),cr(h,-1,"../threadedComments/threadedComment"+o+"."+r,Zt.TCMNT)),y="xl/comments"+o+"."+r,Bt(a,y,M6(v)),i.comments.push(y),cr(h,-1,"../comments"+o+"."+r,Zt.CMNT),g=!0}p["!legacy"]&&g&&Bt(a,"xl/drawings/vmlDrawing"+o+".vml",I6(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}h["!id"].rId1&&Bt(a,m6(s),wc(h))}return t.Strings!=null&&t.Strings.length>0&&(s="xl/sharedStrings."+r,Bt(a,s,P6(t.Strings,t)),i.strs.push(s),cr(t.wbrels,-1,"sharedStrings."+r,Zt.SST)),s="xl/workbook."+r,Bt(a,s,X6(e)),i.workbooks.push(s),cr(t.rels,1,s,Zt.WB),s="xl/theme/theme1.xml",Bt(a,s,F6(e.Themes,t)),i.themes.push(s),cr(t.wbrels,-1,"theme/theme1.xml",Zt.THEME),s="xl/styles."+r,Bt(a,s,O6(e,t)),i.styles.push(s),cr(t.wbrels,-1,"styles."+r,Zt.STY),e.vbaraw&&n&&(s="xl/vbaProject.bin",Bt(a,s,e.vbaraw),i.vba.push(s),cr(t.wbrels,-1,"vbaProject.bin",Zt.VBA)),s="xl/metadata."+r,Bt(a,s,D6()),i.metadata.push(s),cr(t.wbrels,-1,"metadata."+r,Zt.XLMETA),u.length>1&&(s="xl/persons/person.xml",Bt(a,s,cW(u)),i.people.push(s),cr(t.wbrels,-1,"persons/person.xml",Zt.PEOPLE)),Bt(a,"[Content_Types].xml",p6(i,t)),Bt(a,"_rels/.rels",wc(t.rels)),Bt(a,"xl/_rels/workbook."+r+".rels",wc(t.wbrels)),delete t.revssf,delete t.ssf,a}function OV(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Rs(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function nE(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return s0(t.file,gr.write(e,{type:nr?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return gr.write(e,t)}function LV(e,t){var r=yi(t||{}),n=jV(e,r);return FV(n,r)}function FV(e,t){var r={},n=nr?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?gr.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(wp(i))}return t.password&&typeof encrypt_agile<"u"?nE(encrypt_agile(i,t.password),t):t.type==="file"?s0(t.file,i):t.type=="string"?lf(i):i}function DV(e,t){var r=t||{},n=ZG(e,r);return nE(n,r)}function Ka(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return kf(Of(n));case"binary":return Of(n);case"string":return e;case"file":return s0(t.file,n,"utf8");case"buffer":return nr?qs(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):Ka(n,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function IV(e,t){switch(t.type){case"base64":return kf(e);case"binary":return e;case"string":return e;case"file":return s0(t.file,e,"binary");case"buffer":return nr?qs(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function ah(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?kf(r):t.type=="string"?lf(r):r;case"file":return s0(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function iE(e,t){uU(),wG(e);var r=yi(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=iE(e,r);return r.type="array",wp(n)}var i=0;if(r.sheet&&(typeof r.sheet=="number"?i=r.sheet:i=e.SheetNames.indexOf(r.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return Ka(YG(e,r),r);case"slk":case"sylk":return Ka(xz.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"htm":case"html":return Ka(Q6(e.Sheets[e.SheetNames[i]],r),r);case"txt":return IV(aE(e.Sheets[e.SheetNames[i]],r),r);case"csv":return Ka(Kv(e.Sheets[e.SheetNames[i]],r),r,"\uFEFF");case"dif":return Ka(yz.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"dbf":return ah(vz.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"prn":return Ka(bz.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"rtf":return Ka(Tz.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"eth":return Ka(T6.from_sheet(e.Sheets[e.SheetNames[i]],r),r);case"fods":return Ka(rE(e,r),r);case"wk1":return ah(ow.sheet_to_wk1(e.Sheets[e.SheetNames[i]],r),r);case"wk3":return ah(ow.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),ah(J6(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),DV(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return LV(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function MV(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function RV(e,t,r){var n={};return n.type="file",n.file=t,MV(n),iE(e,n)}function BV(e,t,r,n,i,a,s,o){var l=Bn(r),c=o.defval,u=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,p=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:r,enumerable:!1})}catch{p.__rowNum__=r}else p.__rowNum__=r;if(!s||e[r])for(var d=t.s.c;d<=t.e.c;++d){var v=s?e[r][d]:e[n[d]+l];if(v===void 0||v.t===void 0){if(c===void 0)continue;a[d]!=null&&(p[a[d]]=c);continue}var g=v.v;switch(v.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(a[d]!=null){if(g==null)if(v.t=="e"&&g===null)p[a[d]]=null;else if(c!==void 0)p[a[d]]=c;else if(u&&g===null)p[a[d]]=null;else continue;else p[a[d]]=u&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?g:Bs(v,g,o);g!=null&&(h=!1)}}return{row:p,isempty:h}}function bd(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,i=1,a=[],s=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},u=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof u){case"string":l=jr(u);break;case"number":l=jr(e["!ref"]),l.s.r=u;break;default:l=u}n>0&&(i=0);var h=Bn(l.s.r),p=[],d=[],v=0,g=0,y=Array.isArray(e),b=l.s.r,E=0,S={};y&&!e[b]&&(e[b]=[]);var P=c.skipHidden&&e["!cols"]||[],L=c.skipHidden&&e["!rows"]||[];for(E=l.s.c;E<=l.e.c;++E)if(!(P[E]||{}).hidden)switch(p[E]=Yn(E),r=y?e[b][E]:e[p[E]+h],n){case 1:a[E]=E-l.s.c;break;case 2:a[E]=p[E];break;case 3:a[E]=c.header[E-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=s=Bs(r,null,c),g=S[s]||0,!g)S[s]=1;else{do o=s+"_"+g++;while(S[o]);S[s]=g,S[o]=1}a[E]=o}for(b=l.s.r+i;b<=l.e.r;++b)if(!(L[b]||{}).hidden){var q=BV(e,l,b,p,n,a,y,c);(q.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(d[v++]=q.row)}return d.length=v,d}var mw=/"/g;function UV(e,t,r,n,i,a,s,o){for(var l=!0,c=[],u="",h=Bn(r),p=t.s.c;p<=t.e.c;++p)if(n[p]){var d=o.dense?(e[r]||[])[p]:e[n[p]+h];if(d==null)u="";else if(d.v!=null){l=!1,u=""+(o.rawNumbers&&d.t=="n"?d.v:Bs(d,null,o));for(var v=0,g=0;v!==u.length;++v)if((g=u.charCodeAt(v))===i||g===a||g===34||o.forceQuotes){u='"'+u.replace(mw,'""')+'"';break}u=="ID"&&(u='"ID"')}else d.f!=null&&!d.F?(l=!1,u="="+d.f,u.indexOf(",")>=0&&(u='"'+u.replace(mw,'""')+'"')):u="";c.push(u)}return o.blankrows===!1&&l?null:c.join(s)}function Kv(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var i=jr(e["!ref"]),a=n.FS!==void 0?n.FS:",",s=a.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((a=="|"?"\\|":a)+"+$"),u="",h=[];n.dense=Array.isArray(e);for(var p=n.skipHidden&&e["!cols"]||[],d=n.skipHidden&&e["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(p[v]||{}).hidden||(h[v]=Yn(v));for(var g=0,y=i.s.r;y<=i.e.r;++y)(d[y]||{}).hidden||(u=UV(e,i,y,h,s,l,a,n),u!=null&&(n.strip&&(u=u.replace(c,"")),(u||n.blankrows!==!1)&&r.push((g++?o:"")+u)));return delete n.dense,r.join("")}function aE(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=Kv(e,t);return r}function $V(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var i=jr(e["!ref"]),a="",s=[],o,l=[],c=Array.isArray(e);for(o=i.s.c;o<=i.e.c;++o)s[o]=Yn(o);for(var u=i.s.r;u<=i.e.r;++u)for(a=Bn(u),o=i.s.c;o<=i.e.c;++o)if(t=s[o]+a,r=c?(e[u]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function sE(e,t,r){var n=r||{},i=+!n.skipHeader,a=e||{},s=0,o=0;if(a&&n.origin!=null)if(typeof n.origin=="number")s=n.origin;else{var l=typeof n.origin=="string"?Nn(n.origin):n.origin;s=l.r,o=l.c}var c,u={s:{c:0,r:0},e:{c:o,r:s+t.length-1+i}};if(a["!ref"]){var h=jr(a["!ref"]);u.e.c=Math.max(u.e.c,h.e.c),u.e.r=Math.max(u.e.r,h.e.r),s==-1&&(s=h.e.r+1,u.e.r=s+t.length-1+i)}else s==-1&&(s=0,u.e.r=t.length-1+i);var p=n.header||[],d=0;t.forEach(function(g,y){Un(g).forEach(function(b){(d=p.indexOf(b))==-1&&(p[d=p.length]=b);var E=g[b],S="z",P="",L=dr({c:o+d,r:s+y+i});c=Df(a,L),E&&typeof E=="object"&&!(E instanceof Date)?a[L]=E:(typeof E=="number"?S="n":typeof E=="boolean"?S="b":typeof E=="string"?S="s":E instanceof Date?(S="d",n.cellDates||(S="n",E=xi(E)),P=n.dateNF||zr[14]):E===null&&n.nullError&&(S="e",E=0),c?(c.t=S,c.v=E,delete c.w,delete c.R,P&&(c.z=P)):a[L]=c={t:S,v:E},P&&(c.z=P))})}),u.e.c=Math.max(u.e.c,o+p.length-1);var v=Bn(s);if(i)for(d=0;d<p.length;++d)a[Yn(d+o)+v]={t:"s",v:p[d]};return a["!ref"]=on(u),a}function zV(e,t){return sE(null,e,t)}function Df(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Nn(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Df(e,dr(t)):Df(e,dr({r:t,c:r||0}))}function WV(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function qV(){return{SheetNames:[],Sheets:{}}}function HV(e,t,r,n){var i=1;if(!r)for(;i<=65535&&e.SheetNames.indexOf(r="Sheet"+i)!=-1;++i,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var a=r.match(/(^.*?)(\d+)$/);i=a&&+a[2]||0;var s=a&&a[1]||r;for(++i;i<=65535&&e.SheetNames.indexOf(r=s+i)!=-1;++i);}if(Y6(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function GV(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=WV(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function VV(e,t){return e.z=t,e}function oE(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function KV(e,t,r){return oE(e,"#"+t,r)}function YV(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function XV(e,t,r,n){for(var i=typeof t!="string"?t:jr(t),a=typeof t=="string"?t:on(t),s=i.s.r;s<=i.e.r;++s)for(var o=i.s.c;o<=i.e.c;++o){var l=Df(e,s,o);l.t="n",l.F=a,delete l.v,s==i.s.r&&o==i.s.c&&(l.f=r,n&&(l.D=!0))}return e}var Gu={encode_col:Yn,encode_row:Bn,encode_cell:dr,encode_range:on,decode_col:Mv,decode_row:Iv,split_cell:u$,decode_cell:Nn,decode_range:qi,format_cell:Bs,sheet_add_aoa:o6,sheet_add_json:sE,sheet_add_dom:eE,aoa_to_sheet:au,json_to_sheet:zV,table_to_sheet:tE,table_to_book:yV,sheet_to_csv:Kv,sheet_to_txt:aE,sheet_to_json:bd,sheet_to_html:Q6,sheet_to_formulae:$V,sheet_to_row_object_array:bd,sheet_get_cell:Df,book_new:qV,book_append_sheet:HV,book_set_sheet_visibility:GV,cell_set_number_format:VV,cell_set_hyperlink:oE,cell_set_internal_link:KV,cell_add_comment:YV,sheet_set_array_formula:XV,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function fr(e){"@babel/helpers - typeof";return fr=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fr(e)}var La=Uint8Array,Ri=Uint16Array,Yv=Int32Array,Xv=new La([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Zv=new La([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),gw=new La([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),lE=function(e,t){for(var r=new Ri(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var i=new Yv(r[30]),n=1;n<30;++n)for(var a=r[n];a<r[n+1];++a)i[a]=a-r[n]<<5|n;return{b:r,r:i}},cE=lE(Xv,2),ZV=cE.b,yg=cE.r;ZV[28]=258,yg[258]=28;var JV=lE(Zv,0),vw=JV.r,bg=new Ri(32768);for(var Pr=0;Pr<32768;++Pr){var lo=(Pr&43690)>>1|(Pr&21845)<<1;lo=(lo&52428)>>2|(lo&13107)<<2,lo=(lo&61680)>>4|(lo&3855)<<4,bg[Pr]=((lo&65280)>>8|(lo&255)<<8)>>1}var df=function(e,t,r){for(var n=e.length,i=0,a=new Ri(t);i<n;++i)e[i]&&++a[e[i]-1];var s=new Ri(t);for(i=1;i<t;++i)s[i]=s[i-1]+a[i-1]<<1;var o;if(r){o=new Ri(1<<t);var l=15-t;for(i=0;i<n;++i)if(e[i])for(var c=i<<4|e[i],u=t-e[i],h=s[e[i]-1]++<<u,p=h|(1<<u)-1;h<=p;++h)o[bg[h]>>l]=c}else for(o=new Ri(n),i=0;i<n;++i)e[i]&&(o[i]=bg[s[e[i]-1]++]>>15-e[i]);return o},El=new La(288);for(var Pr=0;Pr<144;++Pr)El[Pr]=8;for(var Pr=144;Pr<256;++Pr)El[Pr]=9;for(var Pr=256;Pr<280;++Pr)El[Pr]=7;for(var Pr=280;Pr<288;++Pr)El[Pr]=8;var wd=new La(32);for(var Pr=0;Pr<32;++Pr)wd[Pr]=5;var QV=df(El,9,0),eK=df(wd,5,0),uE=function(e){return(e+7)/8|0},tK=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new La(e.subarray(t,r))},xs=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},Vu=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},X1=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var i=r.length,a=r.slice();if(!i)return{t:hE,l:0};if(i==1){var s=new La(r[0].s+1);return s[r[0].s]=1,{t:s,l:1}}r.sort(function(L,q){return L.f-q.f}),r.push({s:-1,f:25001});var o=r[0],l=r[1],c=0,u=1,h=2;for(r[0]={s:-1,f:o.f+l.f,l:o,r:l};u!=i-1;)o=r[r[c].f<r[h].f?c++:h++],l=r[c!=u&&r[c].f<r[h].f?c++:h++],r[u++]={s:-1,f:o.f+l.f,l:o,r:l};for(var p=a[0].s,n=1;n<i;++n)a[n].s>p&&(p=a[n].s);var d=new Ri(p+1),v=wg(r[u-1],d,0);if(v>t){var n=0,g=0,y=v-t,b=1<<y;for(a.sort(function(q,C){return d[C.s]-d[q.s]||q.f-C.f});n<i;++n){var E=a[n].s;if(d[E]>t)g+=b-(1<<v-d[E]),d[E]=t;else break}for(g>>=y;g>0;){var S=a[n].s;d[S]<t?g-=1<<t-d[S]++-1:++n}for(;n>=0&&g;--n){var P=a[n].s;d[P]==t&&(--d[P],++g)}v=t}return{t:new La(d),l:v}},wg=function(e,t,r){return e.s==-1?Math.max(wg(e.l,t,r+1),wg(e.r,t,r+1)):t[e.s]=r},xw=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new Ri(++t),n=0,i=e[0],a=1,s=function(l){r[n++]=l},o=1;o<=t;++o)if(e[o]==i&&o!=t)++a;else{if(!i&&a>2){for(;a>138;a-=138)s(32754);a>2&&(s(a>10?a-11<<5|28690:a-3<<5|12305),a=0)}else if(a>3){for(s(i),--a;a>6;a-=6)s(8304);a>2&&(s(a-3<<5|8208),a=0)}for(;a--;)s(i);a=1,i=e[o]}return{c:r.subarray(0,n),n:t}},Ku=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},fE=function(e,t,r){var n=r.length,i=uE(t+2);e[i]=n&255,e[i+1]=n>>8,e[i+2]=e[i]^255,e[i+3]=e[i+1]^255;for(var a=0;a<n;++a)e[i+a+4]=r[a];return(i+4+n)*8},yw=function(e,t,r,n,i,a,s,o,l,c,u){xs(t,u++,r),++i[256];for(var h=X1(i,15),p=h.t,d=h.l,v=X1(a,15),g=v.t,y=v.l,b=xw(p),E=b.c,S=b.n,P=xw(g),L=P.c,q=P.n,C=new Ri(19),R=0;R<E.length;++R)++C[E[R]&31];for(var R=0;R<L.length;++R)++C[L[R]&31];for(var k=X1(C,7),G=k.t,_=k.l,j=19;j>4&&!G[gw[j-1]];--j);var H=c+5<<3,X=Ku(i,El)+Ku(a,wd)+s,ce=Ku(i,p)+Ku(a,g)+s+14+3*j+Ku(C,G)+2*C[16]+3*C[17]+7*C[18];if(l>=0&&H<=X&&H<=ce)return fE(t,u,e.subarray(l,l+c));var pe,ye,me,be;if(xs(t,u,1+(ce<X)),u+=2,ce<X){pe=df(p,d,0),ye=p,me=df(g,y,0),be=g;var Ue=df(G,_,0);xs(t,u,S-257),xs(t,u+5,q-1),xs(t,u+10,j-4),u+=14;for(var R=0;R<j;++R)xs(t,u+3*R,G[gw[R]]);u+=3*j;for(var Fe=[E,L],A=0;A<2;++A)for(var F=Fe[A],R=0;R<F.length;++R){var O=F[R]&31;xs(t,u,Ue[O]),u+=G[O],O>15&&(xs(t,u,F[R]>>5&127),u+=F[R]>>12)}}else pe=QV,ye=El,me=eK,be=wd;for(var R=0;R<o;++R){var M=n[R];if(M>255){var O=M>>18&31;Vu(t,u,pe[O+257]),u+=ye[O+257],O>7&&(xs(t,u,M>>23&31),u+=Xv[O]);var J=M&31;Vu(t,u,me[J]),u+=be[J],J>3&&(Vu(t,u,M>>5&8191),u+=Zv[J])}else Vu(t,u,pe[M]),u+=ye[M]}return Vu(t,u,pe[256]),u+ye[256]},rK=new Yv([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),hE=new La(0),nK=function(e,t,r,n,i,a){var s=a.z||e.length,o=new La(n+s+5*(1+Math.ceil(s/7e3))+i),l=o.subarray(n,o.length-i),c=a.l,u=(a.r||0)&7;if(t){u&&(l[0]=a.r>>3);for(var h=rK[t-1],p=h>>13,d=h&8191,v=(1<<r)-1,g=a.p||new Ri(32768),y=a.h||new Ri(v+1),b=Math.ceil(r/3),E=2*b,S=function(ge){return(e[ge]^e[ge+1]<<b^e[ge+2]<<E)&v},P=new Yv(25e3),L=new Ri(288),q=new Ri(32),C=0,R=0,k=a.i||0,G=0,_=a.w||0,j=0;k+2<s;++k){var H=S(k),X=k&32767,ce=y[H];if(g[X]=ce,y[H]=X,_<=k){var pe=s-k;if((C>7e3||G>24576)&&(pe>423||!c)){u=yw(e,l,0,P,L,q,R,G,j,k-j,u),G=C=R=0,j=k;for(var ye=0;ye<286;++ye)L[ye]=0;for(var ye=0;ye<30;++ye)q[ye]=0}var me=2,be=0,Ue=d,Fe=X-ce&32767;if(pe>2&&H==S(k-Fe))for(var A=Math.min(p,pe)-1,F=Math.min(32767,k),O=Math.min(258,pe);Fe<=F&&--Ue&&X!=ce;){if(e[k+me]==e[k+me-Fe]){for(var M=0;M<O&&e[k+M]==e[k+M-Fe];++M);if(M>me){if(me=M,be=Fe,M>A)break;for(var J=Math.min(Fe,M-2),fe=0,ye=0;ye<J;++ye){var ve=k-Fe+ye&32767,ae=g[ve],ue=ve-ae&32767;ue>fe&&(fe=ue,ce=ve)}}}X=ce,ce=g[X],Fe+=X-ce&32767}if(be){P[G++]=268435456|yg[me]<<18|vw[be];var oe=yg[me]&31,le=vw[be]&31;R+=Xv[oe]+Zv[le],++L[257+oe],++q[le],_=k+me,++C}else P[G++]=e[k],++L[e[k]]}}for(k=Math.max(k,_);k<s;++k)P[G++]=e[k],++L[e[k]];u=yw(e,l,c,P,L,q,R,G,j,k-j,u),c||(a.r=u&7|l[u/8|0]<<3,u-=7,a.h=y,a.p=g,a.i=k,a.w=_)}else{for(var k=a.w||0;k<s+c;k+=65535){var Be=k+65535;Be>=s&&(l[u/8|0]=c,Be=s),u=fE(l,u+1,e.subarray(k,Be))}a.i=s}return tK(o,0,n+uE(u)+i)},dE=function(){var e=1,t=0;return{p:function(r){for(var n=e,i=t,a=r.length|0,s=0;s!=a;){for(var o=Math.min(s+2655,a);s<o;++s)i+=n+=r[s];n=(n&65535)+15*(n>>16),i=(i&65535)+15*(i>>16)}e=n,t=i},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},iK=function(e,t,r,n,i){if(!i&&(i={l:1},t.dictionary)){var a=t.dictionary.subarray(-32768),s=new La(a.length+e.length);s.set(a),s.set(e,a.length),e=s,i.w=a.length}return nK(e,t.level==null?6:t.level,t.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,i)},pE=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},aK=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var i=dE();i.p(t.dictionary),pE(e,2,i.d())}};function _g(e,t){t||(t={});var r=dE();r.p(e);var n=iK(e,t,t.dictionary?6:2,4);return aK(n,t),pE(n,n.length-4,r.d()),n}var sK=typeof TextDecoder<"u"&&new TextDecoder,oK=0;try{sK.decode(hE,{stream:!0}),oK=1}catch{}function lK(e){if(Array.isArray(e))return e}function cK(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,s,o=[],l=!0,c=!1;try{if(a=(r=r.call(e)).next,t!==0)for(;!(l=(n=a.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(u){c=!0,i=u}finally{try{if(!l&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(c)throw i}}return o}}function bw(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function uK(e,t){if(e){if(typeof e=="string")return bw(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?bw(e,t):void 0}}function fK(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ww(e,t){return lK(e)||cK(e,t)||uK(e,t)||fK()}function _w(e,t="utf8"){return new TextDecoder(t).decode(e)}const hK=new TextEncoder;function dK(e){return hK.encode(e)}const pK=1024*8,mK=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),Z1={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class Jv{constructor(t=pK,r={}){tr(this,"buffer");tr(this,"byteLength");tr(this,"byteOffset");tr(this,"length");tr(this,"offset");tr(this,"lastWrittenByte");tr(this,"littleEndian");tr(this,"_data");tr(this,"_mark");tr(this,"_marks");let n=!1;typeof t=="number"?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const i=r.offset?r.offset>>>0:0,a=t.byteLength-i;let s=i;(ArrayBuffer.isView(t)||t instanceof Jv)&&(t.byteLength!==t.buffer.byteLength&&(s=t.byteOffset+i),t=t.buffer),n?this.lastWrittenByte=a:this.lastWrittenByte=0,this.buffer=t,this.length=a,this.byteLength=a,this.byteOffset=s,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,s,a),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const n=(this.offset+t)*2,i=new Uint8Array(n);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const n=Z1[r].BYTES_PER_ELEMENT*t,i=this.byteOffset+this.offset,a=this.buffer.slice(i,i+n);if(this.littleEndian===mK&&r!=="uint8"&&r!=="int8"){const o=new Uint8Array(this.buffer.slice(i,i+n));o.reverse();const l=new Z1[r](o.buffer);return this.offset+=n,l.reverse(),l}const s=new Z1[r](a);return this.offset+=n,s}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let n=0;n<t;n++)r+=this.readChar();return r}readUtf8(t=1){return _w(this.readBytes(t))}decodeText(t=1,r="utf8"){return _w(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(dK(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */const gK=4,Nw=0,Sw=1,vK=2;function lu(e){let t=e.length;for(;--t>=0;)e[t]=0}const xK=0,mE=1,yK=2,bK=3,wK=258,Qv=29,f0=256,If=f0+1+Qv,Sc=30,ex=19,gE=2*If+1,sl=15,J1=16,_K=7,tx=256,vE=16,xE=17,yE=18,Ng=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),yh=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),NK=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),bE=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),SK=512,bs=new Array((If+2)*2);lu(bs);const pf=new Array(Sc*2);lu(pf);const Mf=new Array(SK);lu(Mf);const Rf=new Array(wK-bK+1);lu(Rf);const rx=new Array(Qv);lu(rx);const _d=new Array(Sc);lu(_d);function Q1(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}let wE,_E,NE;function em(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}const SE=e=>e<256?Mf[e]:Mf[256+(e>>>7)],Bf=(e,t)=>{e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255},gi=(e,t,r)=>{e.bi_valid>J1-r?(e.bi_buf|=t<<e.bi_valid&65535,Bf(e,e.bi_buf),e.bi_buf=t>>J1-e.bi_valid,e.bi_valid+=r-J1):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)},Xa=(e,t,r)=>{gi(e,r[t*2],r[t*2+1])},AE=(e,t)=>{let r=0;do r|=e&1,e>>>=1,r<<=1;while(--t>0);return r>>>1},AK=e=>{e.bi_valid===16?(Bf(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)},EK=(e,t)=>{const r=t.dyn_tree,n=t.max_code,i=t.stat_desc.static_tree,a=t.stat_desc.has_stree,s=t.stat_desc.extra_bits,o=t.stat_desc.extra_base,l=t.stat_desc.max_length;let c,u,h,p,d,v,g=0;for(p=0;p<=sl;p++)e.bl_count[p]=0;for(r[e.heap[e.heap_max]*2+1]=0,c=e.heap_max+1;c<gE;c++)u=e.heap[c],p=r[r[u*2+1]*2+1]+1,p>l&&(p=l,g++),r[u*2+1]=p,!(u>n)&&(e.bl_count[p]++,d=0,u>=o&&(d=s[u-o]),v=r[u*2],e.opt_len+=v*(p+d),a&&(e.static_len+=v*(i[u*2+1]+d)));if(g!==0){do{for(p=l-1;e.bl_count[p]===0;)p--;e.bl_count[p]--,e.bl_count[p+1]+=2,e.bl_count[l]--,g-=2}while(g>0);for(p=l;p!==0;p--)for(u=e.bl_count[p];u!==0;)h=e.heap[--c],!(h>n)&&(r[h*2+1]!==p&&(e.opt_len+=(p-r[h*2+1])*r[h*2],r[h*2+1]=p),u--)}},EE=(e,t,r)=>{const n=new Array(sl+1);let i=0,a,s;for(a=1;a<=sl;a++)i=i+r[a-1]<<1,n[a]=i;for(s=0;s<=t;s++){let o=e[s*2+1];o!==0&&(e[s*2]=AE(n[o]++,o))}},TK=()=>{let e,t,r,n,i;const a=new Array(sl+1);for(r=0,n=0;n<Qv-1;n++)for(rx[n]=r,e=0;e<1<<Ng[n];e++)Rf[r++]=n;for(Rf[r-1]=n,i=0,n=0;n<16;n++)for(_d[n]=i,e=0;e<1<<yh[n];e++)Mf[i++]=n;for(i>>=7;n<Sc;n++)for(_d[n]=i<<7,e=0;e<1<<yh[n]-7;e++)Mf[256+i++]=n;for(t=0;t<=sl;t++)a[t]=0;for(e=0;e<=143;)bs[e*2+1]=8,e++,a[8]++;for(;e<=255;)bs[e*2+1]=9,e++,a[9]++;for(;e<=279;)bs[e*2+1]=7,e++,a[7]++;for(;e<=287;)bs[e*2+1]=8,e++,a[8]++;for(EE(bs,If+1,a),e=0;e<Sc;e++)pf[e*2+1]=5,pf[e*2]=AE(e,5);wE=new Q1(bs,Ng,f0+1,If,sl),_E=new Q1(pf,yh,0,Sc,sl),NE=new Q1(new Array(0),NK,0,ex,_K)},TE=e=>{let t;for(t=0;t<If;t++)e.dyn_ltree[t*2]=0;for(t=0;t<Sc;t++)e.dyn_dtree[t*2]=0;for(t=0;t<ex;t++)e.bl_tree[t*2]=0;e.dyn_ltree[tx*2]=1,e.opt_len=e.static_len=0,e.sym_next=e.matches=0},PE=e=>{e.bi_valid>8?Bf(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0},Aw=(e,t,r,n)=>{const i=t*2,a=r*2;return e[i]<e[a]||e[i]===e[a]&&n[t]<=n[r]},tm=(e,t,r)=>{const n=e.heap[r];let i=r<<1;for(;i<=e.heap_len&&(i<e.heap_len&&Aw(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!Aw(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n},Ew=(e,t,r)=>{let n,i,a=0,s,o;if(e.sym_next!==0)do n=e.pending_buf[e.sym_buf+a++]&255,n+=(e.pending_buf[e.sym_buf+a++]&255)<<8,i=e.pending_buf[e.sym_buf+a++],n===0?Xa(e,i,t):(s=Rf[i],Xa(e,s+f0+1,t),o=Ng[s],o!==0&&(i-=rx[s],gi(e,i,o)),n--,s=SE(n),Xa(e,s,r),o=yh[s],o!==0&&(n-=_d[s],gi(e,n,o)));while(a<e.sym_next);Xa(e,tx,t)},Sg=(e,t)=>{const r=t.dyn_tree,n=t.stat_desc.static_tree,i=t.stat_desc.has_stree,a=t.stat_desc.elems;let s,o,l=-1,c;for(e.heap_len=0,e.heap_max=gE,s=0;s<a;s++)r[s*2]!==0?(e.heap[++e.heap_len]=l=s,e.depth[s]=0):r[s*2+1]=0;for(;e.heap_len<2;)c=e.heap[++e.heap_len]=l<2?++l:0,r[c*2]=1,e.depth[c]=0,e.opt_len--,i&&(e.static_len-=n[c*2+1]);for(t.max_code=l,s=e.heap_len>>1;s>=1;s--)tm(e,r,s);c=a;do s=e.heap[1],e.heap[1]=e.heap[e.heap_len--],tm(e,r,1),o=e.heap[1],e.heap[--e.heap_max]=s,e.heap[--e.heap_max]=o,r[c*2]=r[s*2]+r[o*2],e.depth[c]=(e.depth[s]>=e.depth[o]?e.depth[s]:e.depth[o])+1,r[s*2+1]=r[o*2+1]=c,e.heap[1]=c++,tm(e,r,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],EK(e,t),EE(r,l,e.bl_count)},Tw=(e,t,r)=>{let n,i=-1,a,s=t[0*2+1],o=0,l=7,c=4;for(s===0&&(l=138,c=3),t[(r+1)*2+1]=65535,n=0;n<=r;n++)a=s,s=t[(n+1)*2+1],!(++o<l&&a===s)&&(o<c?e.bl_tree[a*2]+=o:a!==0?(a!==i&&e.bl_tree[a*2]++,e.bl_tree[vE*2]++):o<=10?e.bl_tree[xE*2]++:e.bl_tree[yE*2]++,o=0,i=a,s===0?(l=138,c=3):a===s?(l=6,c=3):(l=7,c=4))},Pw=(e,t,r)=>{let n,i=-1,a,s=t[0*2+1],o=0,l=7,c=4;for(s===0&&(l=138,c=3),n=0;n<=r;n++)if(a=s,s=t[(n+1)*2+1],!(++o<l&&a===s)){if(o<c)do Xa(e,a,e.bl_tree);while(--o!==0);else a!==0?(a!==i&&(Xa(e,a,e.bl_tree),o--),Xa(e,vE,e.bl_tree),gi(e,o-3,2)):o<=10?(Xa(e,xE,e.bl_tree),gi(e,o-3,3)):(Xa(e,yE,e.bl_tree),gi(e,o-11,7));o=0,i=a,s===0?(l=138,c=3):a===s?(l=6,c=3):(l=7,c=4)}},PK=e=>{let t;for(Tw(e,e.dyn_ltree,e.l_desc.max_code),Tw(e,e.dyn_dtree,e.d_desc.max_code),Sg(e,e.bl_desc),t=ex-1;t>=3&&e.bl_tree[bE[t]*2+1]===0;t--);return e.opt_len+=3*(t+1)+5+5+4,t},jK=(e,t,r,n)=>{let i;for(gi(e,t-257,5),gi(e,r-1,5),gi(e,n-4,4),i=0;i<n;i++)gi(e,e.bl_tree[bE[i]*2+1],3);Pw(e,e.dyn_ltree,t-1),Pw(e,e.dyn_dtree,r-1)},kK=e=>{let t=4093624447,r;for(r=0;r<=31;r++,t>>>=1)if(t&1&&e.dyn_ltree[r*2]!==0)return Nw;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return Sw;for(r=32;r<f0;r++)if(e.dyn_ltree[r*2]!==0)return Sw;return Nw};let jw=!1;const CK=e=>{jw||(TK(),jw=!0),e.l_desc=new em(e.dyn_ltree,wE),e.d_desc=new em(e.dyn_dtree,_E),e.bl_desc=new em(e.bl_tree,NE),e.bi_buf=0,e.bi_valid=0,TE(e)},jE=(e,t,r,n)=>{gi(e,(xK<<1)+(n?1:0),3),PE(e),Bf(e,r),Bf(e,~r),r&&e.pending_buf.set(e.window.subarray(t,t+r),e.pending),e.pending+=r},OK=e=>{gi(e,mE<<1,3),Xa(e,tx,bs),AK(e)},LK=(e,t,r,n)=>{let i,a,s=0;e.level>0?(e.strm.data_type===vK&&(e.strm.data_type=kK(e)),Sg(e,e.l_desc),Sg(e,e.d_desc),s=PK(e),i=e.opt_len+3+7>>>3,a=e.static_len+3+7>>>3,a<=i&&(i=a)):i=a=r+5,r+4<=i&&t!==-1?jE(e,t,r,n):e.strategy===gK||a===i?(gi(e,(mE<<1)+(n?1:0),3),Ew(e,bs,pf)):(gi(e,(yK<<1)+(n?1:0),3),jK(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),Ew(e,e.dyn_ltree,e.dyn_dtree)),TE(e),n&&PE(e)},FK=(e,t,r)=>(e.pending_buf[e.sym_buf+e.sym_next++]=t,e.pending_buf[e.sym_buf+e.sym_next++]=t>>8,e.pending_buf[e.sym_buf+e.sym_next++]=r,t===0?e.dyn_ltree[r*2]++:(e.matches++,t--,e.dyn_ltree[(Rf[r]+f0+1)*2]++,e.dyn_dtree[SE(t)*2]++),e.sym_next===e.sym_end);var DK=CK,IK=jE,MK=LK,RK=FK,BK=OK,UK={_tr_init:DK,_tr_stored_block:IK,_tr_flush_block:MK,_tr_tally:RK,_tr_align:BK};const $K=(e,t,r,n)=>{let i=e&65535|0,a=e>>>16&65535|0,s=0;for(;r!==0;){s=r>2e3?2e3:r,r-=s;do i=i+t[n++]|0,a=a+i|0;while(--s);i%=65521,a%=65521}return i|a<<16|0};var Uf=$K;const zK=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},WK=new Uint32Array(zK()),qK=(e,t,r,n)=>{const i=WK,a=n+r;e^=-1;for(let s=n;s<a;s++)e=e>>>8^i[(e^t[s])&255];return e^-1};var yn=qK,Wc={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},h0={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:HK,_tr_stored_block:Ag,_tr_flush_block:GK,_tr_tally:wo,_tr_align:VK}=UK,{Z_NO_FLUSH:_o,Z_PARTIAL_FLUSH:KK,Z_FULL_FLUSH:YK,Z_FINISH:aa,Z_BLOCK:kw,Z_OK:Fn,Z_STREAM_END:Cw,Z_STREAM_ERROR:rs,Z_DATA_ERROR:XK,Z_BUF_ERROR:rm,Z_DEFAULT_COMPRESSION:ZK,Z_FILTERED:JK,Z_HUFFMAN_ONLY:sh,Z_RLE:QK,Z_FIXED:eY,Z_DEFAULT_STRATEGY:tY,Z_UNKNOWN:rY,Z_DEFLATED:jp}=h0,nY=9,iY=15,aY=8,sY=29,oY=256,Eg=oY+1+sY,lY=30,cY=19,uY=2*Eg+1,fY=15,Gt=3,xo=258,ns=xo+Gt+1,hY=32,qc=42,nx=57,Tg=69,Pg=73,jg=91,kg=103,ol=113,tf=666,si=1,cu=2,Tl=3,uu=4,dY=3,ll=(e,t)=>(e.msg=Wc[t],t),Ow=e=>e*2-(e>4?9:0),po=e=>{let t=e.length;for(;--t>=0;)e[t]=0},pY=e=>{let t,r,n,i=e.w_size;t=e.hash_size,n=t;do r=e.head[--n],e.head[n]=r>=i?r-i:0;while(--t);t=i,n=t;do r=e.prev[--n],e.prev[n]=r>=i?r-i:0;while(--t)};let mY=(e,t,r)=>(t<<e.hash_shift^r)&e.hash_mask,No=mY;const ki=e=>{const t=e.state;let r=t.pending;r>e.avail_out&&(r=e.avail_out),r!==0&&(e.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+r),e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,t.pending===0&&(t.pending_out=0))},Bi=(e,t)=>{GK(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,ki(e.strm)},rr=(e,t)=>{e.pending_buf[e.pending++]=t},Yu=(e,t)=>{e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255},Cg=(e,t,r,n)=>{let i=e.avail_in;return i>n&&(i=n),i===0?0:(e.avail_in-=i,t.set(e.input.subarray(e.next_in,e.next_in+i),r),e.state.wrap===1?e.adler=Uf(e.adler,t,i,r):e.state.wrap===2&&(e.adler=yn(e.adler,t,i,r)),e.next_in+=i,e.total_in+=i,i)},kE=(e,t)=>{let r=e.max_chain_length,n=e.strstart,i,a,s=e.prev_length,o=e.nice_match;const l=e.strstart>e.w_size-ns?e.strstart-(e.w_size-ns):0,c=e.window,u=e.w_mask,h=e.prev,p=e.strstart+xo;let d=c[n+s-1],v=c[n+s];e.prev_length>=e.good_match&&(r>>=2),o>e.lookahead&&(o=e.lookahead);do if(i=t,!(c[i+s]!==v||c[i+s-1]!==d||c[i]!==c[n]||c[++i]!==c[n+1])){n+=2,i++;do;while(c[++n]===c[++i]&&c[++n]===c[++i]&&c[++n]===c[++i]&&c[++n]===c[++i]&&c[++n]===c[++i]&&c[++n]===c[++i]&&c[++n]===c[++i]&&c[++n]===c[++i]&&n<p);if(a=xo-(p-n),n=p-xo,a>s){if(e.match_start=t,s=a,a>=o)break;d=c[n+s-1],v=c[n+s]}}while((t=h[t&u])>l&&--r!==0);return s<=e.lookahead?s:e.lookahead},Hc=e=>{const t=e.w_size;let r,n,i;do{if(n=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-ns)&&(e.window.set(e.window.subarray(t,t+t-n),0),e.match_start-=t,e.strstart-=t,e.block_start-=t,e.insert>e.strstart&&(e.insert=e.strstart),pY(e),n+=t),e.strm.avail_in===0)break;if(r=Cg(e.strm,e.window,e.strstart+e.lookahead,n),e.lookahead+=r,e.lookahead+e.insert>=Gt)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=No(e,e.ins_h,e.window[i+1]);e.insert&&(e.ins_h=No(e,e.ins_h,e.window[i+Gt-1]),e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<Gt)););}while(e.lookahead<ns&&e.strm.avail_in!==0)},CE=(e,t)=>{let r=e.pending_buf_size-5>e.w_size?e.w_size:e.pending_buf_size-5,n,i,a,s=0,o=e.strm.avail_in;do{if(n=65535,a=e.bi_valid+42>>3,e.strm.avail_out<a||(a=e.strm.avail_out-a,i=e.strstart-e.block_start,n>i+e.strm.avail_in&&(n=i+e.strm.avail_in),n>a&&(n=a),n<r&&(n===0&&t!==aa||t===_o||n!==i+e.strm.avail_in)))break;s=t===aa&&n===i+e.strm.avail_in?1:0,Ag(e,0,0,s),e.pending_buf[e.pending-4]=n,e.pending_buf[e.pending-3]=n>>8,e.pending_buf[e.pending-2]=~n,e.pending_buf[e.pending-1]=~n>>8,ki(e.strm),i&&(i>n&&(i=n),e.strm.output.set(e.window.subarray(e.block_start,e.block_start+i),e.strm.next_out),e.strm.next_out+=i,e.strm.avail_out-=i,e.strm.total_out+=i,e.block_start+=i,n-=i),n&&(Cg(e.strm,e.strm.output,e.strm.next_out,n),e.strm.next_out+=n,e.strm.avail_out-=n,e.strm.total_out+=n)}while(s===0);return o-=e.strm.avail_in,o&&(o>=e.w_size?(e.matches=2,e.window.set(e.strm.input.subarray(e.strm.next_in-e.w_size,e.strm.next_in),0),e.strstart=e.w_size,e.insert=e.strstart):(e.window_size-e.strstart<=o&&(e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,e.insert>e.strstart&&(e.insert=e.strstart)),e.window.set(e.strm.input.subarray(e.strm.next_in-o,e.strm.next_in),e.strstart),e.strstart+=o,e.insert+=o>e.w_size-e.insert?e.w_size-e.insert:o),e.block_start=e.strstart),e.high_water<e.strstart&&(e.high_water=e.strstart),s?uu:t!==_o&&t!==aa&&e.strm.avail_in===0&&e.strstart===e.block_start?cu:(a=e.window_size-e.strstart,e.strm.avail_in>a&&e.block_start>=e.w_size&&(e.block_start-=e.w_size,e.strstart-=e.w_size,e.window.set(e.window.subarray(e.w_size,e.w_size+e.strstart),0),e.matches<2&&e.matches++,a+=e.w_size,e.insert>e.strstart&&(e.insert=e.strstart)),a>e.strm.avail_in&&(a=e.strm.avail_in),a&&(Cg(e.strm,e.window,e.strstart,a),e.strstart+=a,e.insert+=a>e.w_size-e.insert?e.w_size-e.insert:a),e.high_water<e.strstart&&(e.high_water=e.strstart),a=e.bi_valid+42>>3,a=e.pending_buf_size-a>65535?65535:e.pending_buf_size-a,r=a>e.w_size?e.w_size:a,i=e.strstart-e.block_start,(i>=r||(i||t===aa)&&t!==_o&&e.strm.avail_in===0&&i<=a)&&(n=i>a?a:i,s=t===aa&&e.strm.avail_in===0&&n===i?1:0,Ag(e,e.block_start,n,s),e.block_start+=n,ki(e.strm)),s?Tl:si)},nm=(e,t)=>{let r,n;for(;;){if(e.lookahead<ns){if(Hc(e),e.lookahead<ns&&t===_o)return si;if(e.lookahead===0)break}if(r=0,e.lookahead>=Gt&&(e.ins_h=No(e,e.ins_h,e.window[e.strstart+Gt-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),r!==0&&e.strstart-r<=e.w_size-ns&&(e.match_length=kE(e,r)),e.match_length>=Gt)if(n=wo(e,e.strstart-e.match_start,e.match_length-Gt),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=Gt){e.match_length--;do e.strstart++,e.ins_h=No(e,e.ins_h,e.window[e.strstart+Gt-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=No(e,e.ins_h,e.window[e.strstart+1]);else n=wo(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(Bi(e,!1),e.strm.avail_out===0))return si}return e.insert=e.strstart<Gt-1?e.strstart:Gt-1,t===aa?(Bi(e,!0),e.strm.avail_out===0?Tl:uu):e.sym_next&&(Bi(e,!1),e.strm.avail_out===0)?si:cu},nc=(e,t)=>{let r,n,i;for(;;){if(e.lookahead<ns){if(Hc(e),e.lookahead<ns&&t===_o)return si;if(e.lookahead===0)break}if(r=0,e.lookahead>=Gt&&(e.ins_h=No(e,e.ins_h,e.window[e.strstart+Gt-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=Gt-1,r!==0&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-ns&&(e.match_length=kE(e,r),e.match_length<=5&&(e.strategy===JK||e.match_length===Gt&&e.strstart-e.match_start>4096)&&(e.match_length=Gt-1)),e.prev_length>=Gt&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-Gt,n=wo(e,e.strstart-1-e.prev_match,e.prev_length-Gt),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=i&&(e.ins_h=No(e,e.ins_h,e.window[e.strstart+Gt-1]),r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=Gt-1,e.strstart++,n&&(Bi(e,!1),e.strm.avail_out===0))return si}else if(e.match_available){if(n=wo(e,0,e.window[e.strstart-1]),n&&Bi(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return si}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=wo(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<Gt-1?e.strstart:Gt-1,t===aa?(Bi(e,!0),e.strm.avail_out===0?Tl:uu):e.sym_next&&(Bi(e,!1),e.strm.avail_out===0)?si:cu},gY=(e,t)=>{let r,n,i,a;const s=e.window;for(;;){if(e.lookahead<=xo){if(Hc(e),e.lookahead<=xo&&t===_o)return si;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=Gt&&e.strstart>0&&(i=e.strstart-1,n=s[i],n===s[++i]&&n===s[++i]&&n===s[++i])){a=e.strstart+xo;do;while(n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&i<a);e.match_length=xo-(a-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=Gt?(r=wo(e,1,e.match_length-Gt),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=wo(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(Bi(e,!1),e.strm.avail_out===0))return si}return e.insert=0,t===aa?(Bi(e,!0),e.strm.avail_out===0?Tl:uu):e.sym_next&&(Bi(e,!1),e.strm.avail_out===0)?si:cu},vY=(e,t)=>{let r;for(;;){if(e.lookahead===0&&(Hc(e),e.lookahead===0)){if(t===_o)return si;break}if(e.match_length=0,r=wo(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(Bi(e,!1),e.strm.avail_out===0))return si}return e.insert=0,t===aa?(Bi(e,!0),e.strm.avail_out===0?Tl:uu):e.sym_next&&(Bi(e,!1),e.strm.avail_out===0)?si:cu};function Ga(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}const rf=[new Ga(0,0,0,0,CE),new Ga(4,4,8,4,nm),new Ga(4,5,16,8,nm),new Ga(4,6,32,32,nm),new Ga(4,4,16,16,nc),new Ga(8,16,32,32,nc),new Ga(8,16,128,128,nc),new Ga(8,32,128,256,nc),new Ga(32,128,258,1024,nc),new Ga(32,258,258,4096,nc)],xY=e=>{e.window_size=2*e.w_size,po(e.head),e.max_lazy_match=rf[e.level].max_lazy,e.good_match=rf[e.level].good_length,e.nice_match=rf[e.level].nice_length,e.max_chain_length=rf[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=Gt-1,e.match_available=0,e.ins_h=0};function yY(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=jp,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(uY*2),this.dyn_dtree=new Uint16Array((2*lY+1)*2),this.bl_tree=new Uint16Array((2*cY+1)*2),po(this.dyn_ltree),po(this.dyn_dtree),po(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(fY+1),this.heap=new Uint16Array(2*Eg+1),po(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Eg+1),po(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const d0=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.status!==qc&&t.status!==nx&&t.status!==Tg&&t.status!==Pg&&t.status!==jg&&t.status!==kg&&t.status!==ol&&t.status!==tf?1:0},OE=e=>{if(d0(e))return ll(e,rs);e.total_in=e.total_out=0,e.data_type=rY;const t=e.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap===2?nx:t.wrap?qc:ol,e.adler=t.wrap===2?0:1,t.last_flush=-2,HK(t),Fn},LE=e=>{const t=OE(e);return t===Fn&&xY(e.state),t},bY=(e,t)=>d0(e)||e.state.wrap!==2?rs:(e.state.gzhead=t,Fn),FE=(e,t,r,n,i,a)=>{if(!e)return rs;let s=1;if(t===ZK&&(t=6),n<0?(s=0,n=-n):n>15&&(s=2,n-=16),i<1||i>nY||r!==jp||n<8||n>15||t<0||t>9||a<0||a>eY||n===8&&s!==1)return ll(e,rs);n===8&&(n=9);const o=new yY;return e.state=o,o.strm=e,o.status=qc,o.wrap=s,o.gzhead=null,o.w_bits=n,o.w_size=1<<o.w_bits,o.w_mask=o.w_size-1,o.hash_bits=i+7,o.hash_size=1<<o.hash_bits,o.hash_mask=o.hash_size-1,o.hash_shift=~~((o.hash_bits+Gt-1)/Gt),o.window=new Uint8Array(o.w_size*2),o.head=new Uint16Array(o.hash_size),o.prev=new Uint16Array(o.w_size),o.lit_bufsize=1<<i+6,o.pending_buf_size=o.lit_bufsize*4,o.pending_buf=new Uint8Array(o.pending_buf_size),o.sym_buf=o.lit_bufsize,o.sym_end=(o.lit_bufsize-1)*3,o.level=t,o.strategy=a,o.method=r,LE(e)},wY=(e,t)=>FE(e,t,jp,iY,aY,tY),_Y=(e,t)=>{if(d0(e)||t>kw||t<0)return e?ll(e,rs):rs;const r=e.state;if(!e.output||e.avail_in!==0&&!e.input||r.status===tf&&t!==aa)return ll(e,e.avail_out===0?rm:rs);const n=r.last_flush;if(r.last_flush=t,r.pending!==0){if(ki(e),e.avail_out===0)return r.last_flush=-1,Fn}else if(e.avail_in===0&&Ow(t)<=Ow(n)&&t!==aa)return ll(e,rm);if(r.status===tf&&e.avail_in!==0)return ll(e,rm);if(r.status===qc&&r.wrap===0&&(r.status=ol),r.status===qc){let i=jp+(r.w_bits-8<<4)<<8,a=-1;if(r.strategy>=sh||r.level<2?a=0:r.level<6?a=1:r.level===6?a=2:a=3,i|=a<<6,r.strstart!==0&&(i|=hY),i+=31-i%31,Yu(r,i),r.strstart!==0&&(Yu(r,e.adler>>>16),Yu(r,e.adler&65535)),e.adler=1,r.status=ol,ki(e),r.pending!==0)return r.last_flush=-1,Fn}if(r.status===nx){if(e.adler=0,rr(r,31),rr(r,139),rr(r,8),r.gzhead)rr(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),rr(r,r.gzhead.time&255),rr(r,r.gzhead.time>>8&255),rr(r,r.gzhead.time>>16&255),rr(r,r.gzhead.time>>24&255),rr(r,r.level===9?2:r.strategy>=sh||r.level<2?4:0),rr(r,r.gzhead.os&255),r.gzhead.extra&&r.gzhead.extra.length&&(rr(r,r.gzhead.extra.length&255),rr(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(e.adler=yn(e.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=Tg;else if(rr(r,0),rr(r,0),rr(r,0),rr(r,0),rr(r,0),rr(r,r.level===9?2:r.strategy>=sh||r.level<2?4:0),rr(r,dY),r.status=ol,ki(e),r.pending!==0)return r.last_flush=-1,Fn}if(r.status===Tg){if(r.gzhead.extra){let i=r.pending,a=(r.gzhead.extra.length&65535)-r.gzindex;for(;r.pending+a>r.pending_buf_size;){let o=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+o),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>i&&(e.adler=yn(e.adler,r.pending_buf,r.pending-i,i)),r.gzindex+=o,ki(e),r.pending!==0)return r.last_flush=-1,Fn;i=0,a-=o}let s=new Uint8Array(r.gzhead.extra);r.pending_buf.set(s.subarray(r.gzindex,r.gzindex+a),r.pending),r.pending+=a,r.gzhead.hcrc&&r.pending>i&&(e.adler=yn(e.adler,r.pending_buf,r.pending-i,i)),r.gzindex=0}r.status=Pg}if(r.status===Pg){if(r.gzhead.name){let i=r.pending,a;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>i&&(e.adler=yn(e.adler,r.pending_buf,r.pending-i,i)),ki(e),r.pending!==0)return r.last_flush=-1,Fn;i=0}r.gzindex<r.gzhead.name.length?a=r.gzhead.name.charCodeAt(r.gzindex++)&255:a=0,rr(r,a)}while(a!==0);r.gzhead.hcrc&&r.pending>i&&(e.adler=yn(e.adler,r.pending_buf,r.pending-i,i)),r.gzindex=0}r.status=jg}if(r.status===jg){if(r.gzhead.comment){let i=r.pending,a;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>i&&(e.adler=yn(e.adler,r.pending_buf,r.pending-i,i)),ki(e),r.pending!==0)return r.last_flush=-1,Fn;i=0}r.gzindex<r.gzhead.comment.length?a=r.gzhead.comment.charCodeAt(r.gzindex++)&255:a=0,rr(r,a)}while(a!==0);r.gzhead.hcrc&&r.pending>i&&(e.adler=yn(e.adler,r.pending_buf,r.pending-i,i))}r.status=kg}if(r.status===kg){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(ki(e),r.pending!==0))return r.last_flush=-1,Fn;rr(r,e.adler&255),rr(r,e.adler>>8&255),e.adler=0}if(r.status=ol,ki(e),r.pending!==0)return r.last_flush=-1,Fn}if(e.avail_in!==0||r.lookahead!==0||t!==_o&&r.status!==tf){let i=r.level===0?CE(r,t):r.strategy===sh?vY(r,t):r.strategy===QK?gY(r,t):rf[r.level].func(r,t);if((i===Tl||i===uu)&&(r.status=tf),i===si||i===Tl)return e.avail_out===0&&(r.last_flush=-1),Fn;if(i===cu&&(t===KK?VK(r):t!==kw&&(Ag(r,0,0,!1),t===YK&&(po(r.head),r.lookahead===0&&(r.strstart=0,r.block_start=0,r.insert=0))),ki(e),e.avail_out===0))return r.last_flush=-1,Fn}return t!==aa?Fn:r.wrap<=0?Cw:(r.wrap===2?(rr(r,e.adler&255),rr(r,e.adler>>8&255),rr(r,e.adler>>16&255),rr(r,e.adler>>24&255),rr(r,e.total_in&255),rr(r,e.total_in>>8&255),rr(r,e.total_in>>16&255),rr(r,e.total_in>>24&255)):(Yu(r,e.adler>>>16),Yu(r,e.adler&65535)),ki(e),r.wrap>0&&(r.wrap=-r.wrap),r.pending!==0?Fn:Cw)},NY=e=>{if(d0(e))return rs;const t=e.state.status;return e.state=null,t===ol?ll(e,XK):Fn},SY=(e,t)=>{let r=t.length;if(d0(e))return rs;const n=e.state,i=n.wrap;if(i===2||i===1&&n.status!==qc||n.lookahead)return rs;if(i===1&&(e.adler=Uf(e.adler,t,r,0)),n.wrap=0,r>=n.w_size){i===0&&(po(n.head),n.strstart=0,n.block_start=0,n.insert=0);let l=new Uint8Array(n.w_size);l.set(t.subarray(r-n.w_size,r),0),t=l,r=n.w_size}const a=e.avail_in,s=e.next_in,o=e.input;for(e.avail_in=r,e.next_in=0,e.input=t,Hc(n);n.lookahead>=Gt;){let l=n.strstart,c=n.lookahead-(Gt-1);do n.ins_h=No(n,n.ins_h,n.window[l+Gt-1]),n.prev[l&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=l,l++;while(--c);n.strstart=l,n.lookahead=Gt-1,Hc(n)}return n.strstart+=n.lookahead,n.block_start=n.strstart,n.insert=n.lookahead,n.lookahead=0,n.match_length=n.prev_length=Gt-1,n.match_available=0,e.next_in=s,e.input=o,e.avail_in=a,n.wrap=i,Fn};var AY=wY,EY=FE,TY=LE,PY=OE,jY=bY,kY=_Y,CY=NY,OY=SY,LY="pako deflate (from Nodeca project)",mf={deflateInit:AY,deflateInit2:EY,deflateReset:TY,deflateResetKeep:PY,deflateSetHeader:jY,deflate:kY,deflateEnd:CY,deflateSetDictionary:OY,deflateInfo:LY};const FY=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var DY=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)FY(r,n)&&(e[n]=r[n])}}return e},IY=e=>{let t=0;for(let n=0,i=e.length;n<i;n++)t+=e[n].length;const r=new Uint8Array(t);for(let n=0,i=0,a=e.length;n<a;n++){let s=e[n];r.set(s,i),i+=s.length}return r},kp={assign:DY,flattenChunks:IY};let DE=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{DE=!1}const $f=new Uint8Array(256);for(let e=0;e<256;e++)$f[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;$f[254]=$f[254]=1;var MY=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,n,i,a,s=e.length,o=0;for(i=0;i<s;i++)r=e.charCodeAt(i),(r&64512)===55296&&i+1<s&&(n=e.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),o+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(o),a=0,i=0;a<o;i++)r=e.charCodeAt(i),(r&64512)===55296&&i+1<s&&(n=e.charCodeAt(i+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),i++)),r<128?t[a++]=r:r<2048?(t[a++]=192|r>>>6,t[a++]=128|r&63):r<65536?(t[a++]=224|r>>>12,t[a++]=128|r>>>6&63,t[a++]=128|r&63):(t[a++]=240|r>>>18,t[a++]=128|r>>>12&63,t[a++]=128|r>>>6&63,t[a++]=128|r&63);return t};const RY=(e,t)=>{if(t<65534&&e.subarray&&DE)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r};var BY=(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let n,i;const a=new Array(r*2);for(i=0,n=0;n<r;){let s=e[n++];if(s<128){a[i++]=s;continue}let o=$f[s];if(o>4){a[i++]=65533,n+=o-1;continue}for(s&=o===2?31:o===3?15:7;o>1&&n<r;)s=s<<6|e[n++]&63,o--;if(o>1){a[i++]=65533;continue}s<65536?a[i++]=s:(s-=65536,a[i++]=55296|s>>10&1023,a[i++]=56320|s&1023)}return RY(a,i)},UY=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+$f[e[r]]>t?r:t},zf={string2buf:MY,buf2string:BY,utf8border:UY};function $Y(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var IE=$Y;const ME=Object.prototype.toString,{Z_NO_FLUSH:zY,Z_SYNC_FLUSH:WY,Z_FULL_FLUSH:qY,Z_FINISH:HY,Z_OK:Nd,Z_STREAM_END:GY,Z_DEFAULT_COMPRESSION:VY,Z_DEFAULT_STRATEGY:KY,Z_DEFLATED:YY}=h0;function ix(e){this.options=kp.assign({level:VY,method:YY,chunkSize:16384,windowBits:15,memLevel:8,strategy:KY},e||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new IE,this.strm.avail_out=0;let r=mf.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==Nd)throw new Error(Wc[r]);if(t.header&&mf.deflateSetHeader(this.strm,t.header),t.dictionary){let n;if(typeof t.dictionary=="string"?n=zf.string2buf(t.dictionary):ME.call(t.dictionary)==="[object ArrayBuffer]"?n=new Uint8Array(t.dictionary):n=t.dictionary,r=mf.deflateSetDictionary(this.strm,n),r!==Nd)throw new Error(Wc[r]);this._dict_set=!0}}ix.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize;let i,a;if(this.ended)return!1;for(t===~~t?a=t:a=t===!0?HY:zY,typeof e=="string"?r.input=zf.string2buf(e):ME.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){if(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),(a===WY||a===qY)&&r.avail_out<=6){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(i=mf.deflate(r,a),i===GY)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),i=mf.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===Nd;if(r.avail_out===0){this.onData(r.output);continue}if(a>0&&r.next_out>0){this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;continue}if(r.avail_in===0)break}return!0};ix.prototype.onData=function(e){this.chunks.push(e)};ix.prototype.onEnd=function(e){e===Nd&&(this.result=kp.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};const oh=16209,XY=16191;var ZY=function(t,r){let n,i,a,s,o,l,c,u,h,p,d,v,g,y,b,E,S,P,L,q,C,R,k,G;const _=t.state;n=t.next_in,k=t.input,i=n+(t.avail_in-5),a=t.next_out,G=t.output,s=a-(r-t.avail_out),o=a+(t.avail_out-257),l=_.dmax,c=_.wsize,u=_.whave,h=_.wnext,p=_.window,d=_.hold,v=_.bits,g=_.lencode,y=_.distcode,b=(1<<_.lenbits)-1,E=(1<<_.distbits)-1;e:do{v<15&&(d+=k[n++]<<v,v+=8,d+=k[n++]<<v,v+=8),S=g[d&b];t:for(;;){if(P=S>>>24,d>>>=P,v-=P,P=S>>>16&255,P===0)G[a++]=S&65535;else if(P&16){L=S&65535,P&=15,P&&(v<P&&(d+=k[n++]<<v,v+=8),L+=d&(1<<P)-1,d>>>=P,v-=P),v<15&&(d+=k[n++]<<v,v+=8,d+=k[n++]<<v,v+=8),S=y[d&E];r:for(;;){if(P=S>>>24,d>>>=P,v-=P,P=S>>>16&255,P&16){if(q=S&65535,P&=15,v<P&&(d+=k[n++]<<v,v+=8,v<P&&(d+=k[n++]<<v,v+=8)),q+=d&(1<<P)-1,q>l){t.msg="invalid distance too far back",_.mode=oh;break e}if(d>>>=P,v-=P,P=a-s,q>P){if(P=q-P,P>u&&_.sane){t.msg="invalid distance too far back",_.mode=oh;break e}if(C=0,R=p,h===0){if(C+=c-P,P<L){L-=P;do G[a++]=p[C++];while(--P);C=a-q,R=G}}else if(h<P){if(C+=c+h-P,P-=h,P<L){L-=P;do G[a++]=p[C++];while(--P);if(C=0,h<L){P=h,L-=P;do G[a++]=p[C++];while(--P);C=a-q,R=G}}}else if(C+=h-P,P<L){L-=P;do G[a++]=p[C++];while(--P);C=a-q,R=G}for(;L>2;)G[a++]=R[C++],G[a++]=R[C++],G[a++]=R[C++],L-=3;L&&(G[a++]=R[C++],L>1&&(G[a++]=R[C++]))}else{C=a-q;do G[a++]=G[C++],G[a++]=G[C++],G[a++]=G[C++],L-=3;while(L>2);L&&(G[a++]=G[C++],L>1&&(G[a++]=G[C++]))}}else if(P&64){t.msg="invalid distance code",_.mode=oh;break e}else{S=y[(S&65535)+(d&(1<<P)-1)];continue r}break}}else if(P&64)if(P&32){_.mode=XY;break e}else{t.msg="invalid literal/length code",_.mode=oh;break e}else{S=g[(S&65535)+(d&(1<<P)-1)];continue t}break}}while(n<i&&a<o);L=v>>3,n-=L,v-=L<<3,d&=(1<<v)-1,t.next_in=n,t.next_out=a,t.avail_in=n<i?5+(i-n):5-(n-i),t.avail_out=a<o?257+(o-a):257-(a-o),_.hold=d,_.bits=v};const ic=15,Lw=852,Fw=592,Dw=0,im=1,Iw=2,JY=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),QY=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),eX=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),tX=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),rX=(e,t,r,n,i,a,s,o)=>{const l=o.bits;let c=0,u=0,h=0,p=0,d=0,v=0,g=0,y=0,b=0,E=0,S,P,L,q,C,R=null,k;const G=new Uint16Array(ic+1),_=new Uint16Array(ic+1);let j=null,H,X,ce;for(c=0;c<=ic;c++)G[c]=0;for(u=0;u<n;u++)G[t[r+u]]++;for(d=l,p=ic;p>=1&&G[p]===0;p--);if(d>p&&(d=p),p===0)return i[a++]=1<<24|64<<16|0,i[a++]=1<<24|64<<16|0,o.bits=1,0;for(h=1;h<p&&G[h]===0;h++);for(d<h&&(d=h),y=1,c=1;c<=ic;c++)if(y<<=1,y-=G[c],y<0)return-1;if(y>0&&(e===Dw||p!==1))return-1;for(_[1]=0,c=1;c<ic;c++)_[c+1]=_[c]+G[c];for(u=0;u<n;u++)t[r+u]!==0&&(s[_[t[r+u]]++]=u);if(e===Dw?(R=j=s,k=20):e===im?(R=JY,j=QY,k=257):(R=eX,j=tX,k=0),E=0,u=0,c=h,C=a,v=d,g=0,L=-1,b=1<<d,q=b-1,e===im&&b>Lw||e===Iw&&b>Fw)return 1;for(;;){H=c-g,s[u]+1<k?(X=0,ce=s[u]):s[u]>=k?(X=j[s[u]-k],ce=R[s[u]-k]):(X=96,ce=0),S=1<<c-g,P=1<<v,h=P;do P-=S,i[C+(E>>g)+P]=H<<24|X<<16|ce|0;while(P!==0);for(S=1<<c-1;E&S;)S>>=1;if(S!==0?(E&=S-1,E+=S):E=0,u++,--G[c]===0){if(c===p)break;c=t[r+s[u]]}if(c>d&&(E&q)!==L){for(g===0&&(g=d),C+=h,v=c-g,y=1<<v;v+g<p&&(y-=G[v+g],!(y<=0));)v++,y<<=1;if(b+=1<<v,e===im&&b>Lw||e===Iw&&b>Fw)return 1;L=E&q,i[L]=d<<24|v<<16|C-a|0}}return E!==0&&(i[C+E]=c-g<<24|64<<16|0),o.bits=d,0};var gf=rX;const nX=0,RE=1,BE=2,{Z_FINISH:Mw,Z_BLOCK:iX,Z_TREES:lh,Z_OK:Pl,Z_STREAM_END:aX,Z_NEED_DICT:sX,Z_STREAM_ERROR:ca,Z_DATA_ERROR:UE,Z_MEM_ERROR:$E,Z_BUF_ERROR:oX,Z_DEFLATED:Rw}=h0,Cp=16180,Bw=16181,Uw=16182,$w=16183,zw=16184,Ww=16185,qw=16186,Hw=16187,Gw=16188,Vw=16189,Sd=16190,ys=16191,am=16192,Kw=16193,sm=16194,Yw=16195,Xw=16196,Zw=16197,Jw=16198,ch=16199,uh=16200,Qw=16201,e_=16202,t_=16203,r_=16204,n_=16205,om=16206,i_=16207,a_=16208,Cr=16209,zE=16210,WE=16211,lX=852,cX=592,uX=15,fX=uX,s_=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function hX(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Rl=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<Cp||t.mode>WE?1:0},qE=e=>{if(Rl(e))return ca;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=Cp,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(lX),t.distcode=t.distdyn=new Int32Array(cX),t.sane=1,t.back=-1,Pl},HE=e=>{if(Rl(e))return ca;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,qE(e)},GE=(e,t)=>{let r;if(Rl(e))return ca;const n=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?ca:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,HE(e))},VE=(e,t)=>{if(!e)return ca;const r=new hX;e.state=r,r.strm=e,r.window=null,r.mode=Cp;const n=GE(e,t);return n!==Pl&&(e.state=null),n},dX=e=>VE(e,fX);let o_=!0,lm,cm;const pX=e=>{if(o_){lm=new Int32Array(512),cm=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(gf(RE,e.lens,0,288,lm,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;gf(BE,e.lens,0,32,cm,0,e.work,{bits:5}),o_=!1}e.lencode=lm,e.lenbits=9,e.distcode=cm,e.distbits=5},KE=(e,t,r,n)=>{let i;const a=e.state;return a.window===null&&(a.wsize=1<<a.wbits,a.wnext=0,a.whave=0,a.window=new Uint8Array(a.wsize)),n>=a.wsize?(a.window.set(t.subarray(r-a.wsize,r),0),a.wnext=0,a.whave=a.wsize):(i=a.wsize-a.wnext,i>n&&(i=n),a.window.set(t.subarray(r-n,r-n+i),a.wnext),n-=i,n?(a.window.set(t.subarray(r-n,r),0),a.wnext=n,a.whave=a.wsize):(a.wnext+=i,a.wnext===a.wsize&&(a.wnext=0),a.whave<a.wsize&&(a.whave+=i))),0},mX=(e,t)=>{let r,n,i,a,s,o,l,c,u,h,p,d,v,g,y=0,b,E,S,P,L,q,C,R;const k=new Uint8Array(4);let G,_;const j=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Rl(e)||!e.output||!e.input&&e.avail_in!==0)return ca;r=e.state,r.mode===ys&&(r.mode=am),s=e.next_out,i=e.output,l=e.avail_out,a=e.next_in,n=e.input,o=e.avail_in,c=r.hold,u=r.bits,h=o,p=l,R=Pl;e:for(;;)switch(r.mode){case Cp:if(r.wrap===0){r.mode=am;break}for(;u<16;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}if(r.wrap&2&&c===35615){r.wbits===0&&(r.wbits=15),r.check=0,k[0]=c&255,k[1]=c>>>8&255,r.check=yn(r.check,k,2,0),c=0,u=0,r.mode=Bw;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((c&255)<<8)+(c>>8))%31){e.msg="incorrect header check",r.mode=Cr;break}if((c&15)!==Rw){e.msg="unknown compression method",r.mode=Cr;break}if(c>>>=4,u-=4,C=(c&15)+8,r.wbits===0&&(r.wbits=C),C>15||C>r.wbits){e.msg="invalid window size",r.mode=Cr;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=c&512?Vw:ys,c=0,u=0;break;case Bw:for(;u<16;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}if(r.flags=c,(r.flags&255)!==Rw){e.msg="unknown compression method",r.mode=Cr;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=Cr;break}r.head&&(r.head.text=c>>8&1),r.flags&512&&r.wrap&4&&(k[0]=c&255,k[1]=c>>>8&255,r.check=yn(r.check,k,2,0)),c=0,u=0,r.mode=Uw;case Uw:for(;u<32;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}r.head&&(r.head.time=c),r.flags&512&&r.wrap&4&&(k[0]=c&255,k[1]=c>>>8&255,k[2]=c>>>16&255,k[3]=c>>>24&255,r.check=yn(r.check,k,4,0)),c=0,u=0,r.mode=$w;case $w:for(;u<16;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}r.head&&(r.head.xflags=c&255,r.head.os=c>>8),r.flags&512&&r.wrap&4&&(k[0]=c&255,k[1]=c>>>8&255,r.check=yn(r.check,k,2,0)),c=0,u=0,r.mode=zw;case zw:if(r.flags&1024){for(;u<16;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}r.length=c,r.head&&(r.head.extra_len=c),r.flags&512&&r.wrap&4&&(k[0]=c&255,k[1]=c>>>8&255,r.check=yn(r.check,k,2,0)),c=0,u=0}else r.head&&(r.head.extra=null);r.mode=Ww;case Ww:if(r.flags&1024&&(d=r.length,d>o&&(d=o),d&&(r.head&&(C=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(a,a+d),C)),r.flags&512&&r.wrap&4&&(r.check=yn(r.check,n,d,a)),o-=d,a+=d,r.length-=d),r.length))break e;r.length=0,r.mode=qw;case qw:if(r.flags&2048){if(o===0)break e;d=0;do C=n[a+d++],r.head&&C&&r.length<65536&&(r.head.name+=String.fromCharCode(C));while(C&&d<o);if(r.flags&512&&r.wrap&4&&(r.check=yn(r.check,n,d,a)),o-=d,a+=d,C)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=Hw;case Hw:if(r.flags&4096){if(o===0)break e;d=0;do C=n[a+d++],r.head&&C&&r.length<65536&&(r.head.comment+=String.fromCharCode(C));while(C&&d<o);if(r.flags&512&&r.wrap&4&&(r.check=yn(r.check,n,d,a)),o-=d,a+=d,C)break e}else r.head&&(r.head.comment=null);r.mode=Gw;case Gw:if(r.flags&512){for(;u<16;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}if(r.wrap&4&&c!==(r.check&65535)){e.msg="header crc mismatch",r.mode=Cr;break}c=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=ys;break;case Vw:for(;u<32;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}e.adler=r.check=s_(c),c=0,u=0,r.mode=Sd;case Sd:if(r.havedict===0)return e.next_out=s,e.avail_out=l,e.next_in=a,e.avail_in=o,r.hold=c,r.bits=u,sX;e.adler=r.check=1,r.mode=ys;case ys:if(t===iX||t===lh)break e;case am:if(r.last){c>>>=u&7,u-=u&7,r.mode=om;break}for(;u<3;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}switch(r.last=c&1,c>>>=1,u-=1,c&3){case 0:r.mode=Kw;break;case 1:if(pX(r),r.mode=ch,t===lh){c>>>=2,u-=2;break e}break;case 2:r.mode=Xw;break;case 3:e.msg="invalid block type",r.mode=Cr}c>>>=2,u-=2;break;case Kw:for(c>>>=u&7,u-=u&7;u<32;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}if((c&65535)!==(c>>>16^65535)){e.msg="invalid stored block lengths",r.mode=Cr;break}if(r.length=c&65535,c=0,u=0,r.mode=sm,t===lh)break e;case sm:r.mode=Yw;case Yw:if(d=r.length,d){if(d>o&&(d=o),d>l&&(d=l),d===0)break e;i.set(n.subarray(a,a+d),s),o-=d,a+=d,l-=d,s+=d,r.length-=d;break}r.mode=ys;break;case Xw:for(;u<14;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}if(r.nlen=(c&31)+257,c>>>=5,u-=5,r.ndist=(c&31)+1,c>>>=5,u-=5,r.ncode=(c&15)+4,c>>>=4,u-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=Cr;break}r.have=0,r.mode=Zw;case Zw:for(;r.have<r.ncode;){for(;u<3;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}r.lens[j[r.have++]]=c&7,c>>>=3,u-=3}for(;r.have<19;)r.lens[j[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,G={bits:r.lenbits},R=gf(nX,r.lens,0,19,r.lencode,0,r.work,G),r.lenbits=G.bits,R){e.msg="invalid code lengths set",r.mode=Cr;break}r.have=0,r.mode=Jw;case Jw:for(;r.have<r.nlen+r.ndist;){for(;y=r.lencode[c&(1<<r.lenbits)-1],b=y>>>24,E=y>>>16&255,S=y&65535,!(b<=u);){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}if(S<16)c>>>=b,u-=b,r.lens[r.have++]=S;else{if(S===16){for(_=b+2;u<_;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}if(c>>>=b,u-=b,r.have===0){e.msg="invalid bit length repeat",r.mode=Cr;break}C=r.lens[r.have-1],d=3+(c&3),c>>>=2,u-=2}else if(S===17){for(_=b+3;u<_;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}c>>>=b,u-=b,C=0,d=3+(c&7),c>>>=3,u-=3}else{for(_=b+7;u<_;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}c>>>=b,u-=b,C=0,d=11+(c&127),c>>>=7,u-=7}if(r.have+d>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=Cr;break}for(;d--;)r.lens[r.have++]=C}}if(r.mode===Cr)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=Cr;break}if(r.lenbits=9,G={bits:r.lenbits},R=gf(RE,r.lens,0,r.nlen,r.lencode,0,r.work,G),r.lenbits=G.bits,R){e.msg="invalid literal/lengths set",r.mode=Cr;break}if(r.distbits=6,r.distcode=r.distdyn,G={bits:r.distbits},R=gf(BE,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,G),r.distbits=G.bits,R){e.msg="invalid distances set",r.mode=Cr;break}if(r.mode=ch,t===lh)break e;case ch:r.mode=uh;case uh:if(o>=6&&l>=258){e.next_out=s,e.avail_out=l,e.next_in=a,e.avail_in=o,r.hold=c,r.bits=u,ZY(e,p),s=e.next_out,i=e.output,l=e.avail_out,a=e.next_in,n=e.input,o=e.avail_in,c=r.hold,u=r.bits,r.mode===ys&&(r.back=-1);break}for(r.back=0;y=r.lencode[c&(1<<r.lenbits)-1],b=y>>>24,E=y>>>16&255,S=y&65535,!(b<=u);){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}if(E&&!(E&240)){for(P=b,L=E,q=S;y=r.lencode[q+((c&(1<<P+L)-1)>>P)],b=y>>>24,E=y>>>16&255,S=y&65535,!(P+b<=u);){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}c>>>=P,u-=P,r.back+=P}if(c>>>=b,u-=b,r.back+=b,r.length=S,E===0){r.mode=n_;break}if(E&32){r.back=-1,r.mode=ys;break}if(E&64){e.msg="invalid literal/length code",r.mode=Cr;break}r.extra=E&15,r.mode=Qw;case Qw:if(r.extra){for(_=r.extra;u<_;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}r.length+=c&(1<<r.extra)-1,c>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=e_;case e_:for(;y=r.distcode[c&(1<<r.distbits)-1],b=y>>>24,E=y>>>16&255,S=y&65535,!(b<=u);){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}if(!(E&240)){for(P=b,L=E,q=S;y=r.distcode[q+((c&(1<<P+L)-1)>>P)],b=y>>>24,E=y>>>16&255,S=y&65535,!(P+b<=u);){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}c>>>=P,u-=P,r.back+=P}if(c>>>=b,u-=b,r.back+=b,E&64){e.msg="invalid distance code",r.mode=Cr;break}r.offset=S,r.extra=E&15,r.mode=t_;case t_:if(r.extra){for(_=r.extra;u<_;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}r.offset+=c&(1<<r.extra)-1,c>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=Cr;break}r.mode=r_;case r_:if(l===0)break e;if(d=p-l,r.offset>d){if(d=r.offset-d,d>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=Cr;break}d>r.wnext?(d-=r.wnext,v=r.wsize-d):v=r.wnext-d,d>r.length&&(d=r.length),g=r.window}else g=i,v=s-r.offset,d=r.length;d>l&&(d=l),l-=d,r.length-=d;do i[s++]=g[v++];while(--d);r.length===0&&(r.mode=uh);break;case n_:if(l===0)break e;i[s++]=r.length,l--,r.mode=uh;break;case om:if(r.wrap){for(;u<32;){if(o===0)break e;o--,c|=n[a++]<<u,u+=8}if(p-=l,e.total_out+=p,r.total+=p,r.wrap&4&&p&&(e.adler=r.check=r.flags?yn(r.check,i,p,s-p):Uf(r.check,i,p,s-p)),p=l,r.wrap&4&&(r.flags?c:s_(c))!==r.check){e.msg="incorrect data check",r.mode=Cr;break}c=0,u=0}r.mode=i_;case i_:if(r.wrap&&r.flags){for(;u<32;){if(o===0)break e;o--,c+=n[a++]<<u,u+=8}if(r.wrap&4&&c!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=Cr;break}c=0,u=0}r.mode=a_;case a_:R=aX;break e;case Cr:R=UE;break e;case zE:return $E;case WE:default:return ca}return e.next_out=s,e.avail_out=l,e.next_in=a,e.avail_in=o,r.hold=c,r.bits=u,(r.wsize||p!==e.avail_out&&r.mode<Cr&&(r.mode<om||t!==Mw))&&KE(e,e.output,e.next_out,p-e.avail_out),h-=e.avail_in,p-=e.avail_out,e.total_in+=h,e.total_out+=p,r.total+=p,r.wrap&4&&p&&(e.adler=r.check=r.flags?yn(r.check,i,p,e.next_out-p):Uf(r.check,i,p,e.next_out-p)),e.data_type=r.bits+(r.last?64:0)+(r.mode===ys?128:0)+(r.mode===ch||r.mode===sm?256:0),(h===0&&p===0||t===Mw)&&R===Pl&&(R=oX),R},gX=e=>{if(Rl(e))return ca;let t=e.state;return t.window&&(t.window=null),e.state=null,Pl},vX=(e,t)=>{if(Rl(e))return ca;const r=e.state;return r.wrap&2?(r.head=t,t.done=!1,Pl):ca},xX=(e,t)=>{const r=t.length;let n,i,a;return Rl(e)||(n=e.state,n.wrap!==0&&n.mode!==Sd)?ca:n.mode===Sd&&(i=1,i=Uf(i,t,r,0),i!==n.check)?UE:(a=KE(e,t,r,r),a?(n.mode=zE,$E):(n.havedict=1,Pl))};var yX=HE,bX=GE,wX=qE,_X=dX,NX=VE,SX=mX,AX=gX,EX=vX,TX=xX,PX="pako inflate (from Nodeca project)",ws={inflateReset:yX,inflateReset2:bX,inflateResetKeep:wX,inflateInit:_X,inflateInit2:NX,inflate:SX,inflateEnd:AX,inflateGetHeader:EX,inflateSetDictionary:TX,inflateInfo:PX};function jX(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var kX=jX;const YE=Object.prototype.toString,{Z_NO_FLUSH:CX,Z_FINISH:OX,Z_OK:Wf,Z_STREAM_END:um,Z_NEED_DICT:fm,Z_STREAM_ERROR:LX,Z_DATA_ERROR:l_,Z_MEM_ERROR:FX}=h0;function p0(e){this.options=kp.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new IE,this.strm.avail_out=0;let r=ws.inflateInit2(this.strm,t.windowBits);if(r!==Wf)throw new Error(Wc[r]);if(this.header=new kX,ws.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=zf.string2buf(t.dictionary):YE.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=ws.inflateSetDictionary(this.strm,t.dictionary),r!==Wf)))throw new Error(Wc[r])}p0.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,i=this.options.dictionary;let a,s,o;if(this.ended)return!1;for(t===~~t?s=t:s=t===!0?OX:CX,YE.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),a=ws.inflate(r,s),a===fm&&i&&(a=ws.inflateSetDictionary(r,i),a===Wf?a=ws.inflate(r,s):a===l_&&(a=fm));r.avail_in>0&&a===um&&r.state.wrap>0&&e[r.next_in]!==0;)ws.inflateReset(r),a=ws.inflate(r,s);switch(a){case LX:case l_:case fm:case FX:return this.onEnd(a),this.ended=!0,!1}if(o=r.avail_out,r.next_out&&(r.avail_out===0||a===um))if(this.options.to==="string"){let l=zf.utf8border(r.output,r.next_out),c=r.next_out-l,u=zf.buf2string(r.output,l);r.next_out=c,r.avail_out=n-c,c&&r.output.set(r.output.subarray(l,l+c),0),this.onData(u)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(a===Wf&&o===0)){if(a===um)return a=ws.inflateEnd(this.strm),this.onEnd(a),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};p0.prototype.onData=function(e){this.chunks.push(e)};p0.prototype.onEnd=function(e){e===Wf&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=kp.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function ax(e,t){const r=new p0(t);if(r.push(e),r.err)throw r.msg||Wc[r.err];return r.result}function DX(e,t){return t=t||{},t.raw=!0,ax(e,t)}var IX=p0,MX=ax,RX=DX,BX=ax,UX=h0,$X={Inflate:IX,inflate:MX,inflateRaw:RX,ungzip:BX,constants:UX};const{Inflate:zX,inflate:WX,inflateRaw:vJ,ungzip:xJ}=$X;var c_=zX,qX=WX;const XE=[];for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;XE[e]=t}const u_=4294967295;function HX(e,t,r){let n=e;for(let i=0;i<r;i++)n=XE[(n^t[i])&255]^n>>>8;return n}function GX(e,t){return(HX(u_,e,t)^u_)>>>0}function f_(e,t,r){const n=e.readUint32(),i=GX(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(i!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${i}`)}function ZE(e,t,r){for(let n=0;n<r;n++)t[n]=e[n]}function JE(e,t,r,n){let i=0;for(;i<n;i++)t[i]=e[i];for(;i<r;i++)t[i]=e[i]+t[i-n]&255}function QE(e,t,r,n){let i=0;if(r.length===0)for(;i<n;i++)t[i]=e[i];else for(;i<n;i++)t[i]=e[i]+r[i]&255}function eT(e,t,r,n,i){let a=0;if(r.length===0){for(;a<i;a++)t[a]=e[a];for(;a<n;a++)t[a]=e[a]+(t[a-i]>>1)&255}else{for(;a<i;a++)t[a]=e[a]+(r[a]>>1)&255;for(;a<n;a++)t[a]=e[a]+(t[a-i]+r[a]>>1)&255}}function tT(e,t,r,n,i){let a=0;if(r.length===0){for(;a<i;a++)t[a]=e[a];for(;a<n;a++)t[a]=e[a]+t[a-i]&255}else{for(;a<i;a++)t[a]=e[a]+r[a]&255;for(;a<n;a++)t[a]=e[a]+VX(t[a-i],r[a],r[a-i])&255}}function VX(e,t,r){const n=e+t-r,i=Math.abs(n-e),a=Math.abs(n-t),s=Math.abs(n-r);return i<=a&&i<=s?e:a<=s?t:r}function KX(e,t,r,n,i,a){switch(e){case 0:ZE(t,r,i);break;case 1:JE(t,r,i,a);break;case 2:QE(t,r,n,i);break;case 3:eT(t,r,n,i,a);break;case 4:tT(t,r,n,i,a);break;default:throw new Error(`Unsupported filter: ${e}`)}}const YX=new Uint16Array([255]),XX=new Uint8Array(YX.buffer),ZX=XX[0]===255;function JX(e){const{data:t,width:r,height:n,channels:i,depth:a}=e,s=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],o=Math.ceil(a/8)*i,l=new Uint8Array(n*r*o);let c=0;for(let u=0;u<7;u++){const h=s[u],p=Math.ceil((r-h.x)/h.xStep),d=Math.ceil((n-h.y)/h.yStep);if(p<=0||d<=0)continue;const v=p*o,g=new Uint8Array(v);for(let y=0;y<d;y++){const b=t[c++],E=t.subarray(c,c+v);c+=v;const S=new Uint8Array(v);KX(b,E,S,g,v,o),g.set(S);for(let P=0;P<p;P++){const L=h.x+P*h.xStep,q=h.y+y*h.yStep;if(!(L>=r||q>=n))for(let C=0;C<o;C++)l[(q*r+L)*o+C]=S[P*o+C]}}}if(a===16){const u=new Uint16Array(l.buffer);if(ZX)for(let h=0;h<u.length;h++)u[h]=QX(u[h]);return u}else return l}function QX(e){return(e&255)<<8|e>>8&255}const eZ=new Uint16Array([255]),tZ=new Uint8Array(eZ.buffer),rZ=tZ[0]===255,nZ=new Uint8Array(0);function h_(e){const{data:t,width:r,height:n,channels:i,depth:a}=e,s=Math.ceil(a/8)*i,o=Math.ceil(a/8*i*r),l=new Uint8Array(n*o);let c=nZ,u=0,h,p;for(let d=0;d<n;d++){switch(h=t.subarray(u+1,u+1+o),p=l.subarray(d*o,(d+1)*o),t[u]){case 0:ZE(h,p,o);break;case 1:JE(h,p,o,s);break;case 2:QE(h,p,c,o);break;case 3:eT(h,p,c,o,s);break;case 4:tT(h,p,c,o,s);break;default:throw new Error(`Unsupported filter: ${t[u]}`)}c=p,u+=o+1}if(a===16){const d=new Uint16Array(l.buffer);if(rZ)for(let v=0;v<d.length;v++)d[v]=iZ(d[v]);return d}else return l}function iZ(e){return(e&255)<<8|e>>8&255}const bh=Uint8Array.of(137,80,78,71,13,10,26,10);function d_(e){if(!aZ(e.readBytes(bh.length)))throw new Error("wrong PNG signature")}function aZ(e){if(e.length<bh.length)return!1;for(let t=0;t<bh.length;t++)if(e[t]!==bh[t])return!1;return!0}const sZ="tEXt",oZ=0,rT=new TextDecoder("latin1");function lZ(e){if(uZ(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const cZ=/^[\u0000-\u00FF]*$/;function uZ(e){if(!cZ.test(e))throw new Error("invalid latin1 text")}function fZ(e,t,r){const n=nT(t);e[n]=hZ(t,r-n.length-1)}function nT(e){for(e.mark();e.readByte()!==oZ;);const t=e.offset;e.reset();const r=rT.decode(e.readBytes(t-e.offset-1));return e.skip(1),lZ(r),r}function hZ(e,t){return rT.decode(e.readBytes(t))}const ji={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},hm={UNKNOWN:-1,DEFLATE:0},p_={UNKNOWN:-1,ADAPTIVE:0},dm={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},fh={NONE:0,BACKGROUND:1,PREVIOUS:2},pm={SOURCE:0,OVER:1};class dZ extends Jv{constructor(r,n={}){super(r);tr(this,"_checkCrc");tr(this,"_inflator");tr(this,"_png");tr(this,"_apng");tr(this,"_end");tr(this,"_hasPalette");tr(this,"_palette");tr(this,"_hasTransparency");tr(this,"_transparency");tr(this,"_compressionMethod");tr(this,"_filterMethod");tr(this,"_interlaceMethod");tr(this,"_colorType");tr(this,"_isAnimated");tr(this,"_numberOfFrames");tr(this,"_numberOfPlays");tr(this,"_frames");tr(this,"_writingDataChunks");const{checkCrc:i=!1}=n;this._checkCrc=i,this._inflator=new c_,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=hm.UNKNOWN,this._filterMethod=p_.UNKNOWN,this._interlaceMethod=dm.UNKNOWN,this._colorType=ji.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(d_(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeChunk(r,n)}return this.decodeImage(),this._png}decodeApng(){for(d_(this);!this._end;){const r=this.readUint32(),n=this.readChars(4);this.decodeApngChunk(r,n)}return this.decodeApngImage(),this._apng}decodeChunk(r,n){const i=this.offset;switch(n){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(r);break;case"IDAT":this.decodeIDAT(r);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(r);break;case"iCCP":this.decodeiCCP(r);break;case sZ:fZ(this._png.text,this,r);break;case"pHYs":this.decodepHYs();break;default:this.skip(r);break}if(this.offset-i!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?f_(this,r+4,n):this.skip(4)}decodeApngChunk(r,n){const i=this.offset;switch(n!=="fdAT"&&n!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),n){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(r);break;default:this.decodeChunk(r,n),this.offset=i+r;break}if(this.offset-i!==r)throw new Error(`Length mismatch while decoding chunk ${n}`);this._checkCrc?f_(this,r+4,n):this.skip(4)}decodeIHDR(){const r=this._png;r.width=this.readUint32(),r.height=this.readUint32(),r.depth=pZ(this.readUint8());const n=this.readUint8();this._colorType=n;let i;switch(n){case ji.GREYSCALE:i=1;break;case ji.TRUECOLOUR:i=3;break;case ji.INDEXED_COLOUR:i=1;break;case ji.GREYSCALE_ALPHA:i=2;break;case ji.TRUECOLOUR_ALPHA:i=4;break;case ji.UNKNOWN:default:throw new Error(`Unknown color type: ${n}`)}if(this._png.channels=i,this._compressionMethod=this.readUint8(),this._compressionMethod!==hm.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const r={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(r)}decodePLTE(r){if(r%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${r}`);const n=r/3;this._hasPalette=!0;const i=[];this._palette=i;for(let a=0;a<n;a++)i.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(r){this._writingDataChunks=!0;const n=r,i=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,i,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodeFDAT(r){this._writingDataChunks=!0;let n=r,i=this.offset+this.byteOffset;if(i+=4,n-=4,this._inflator.push(new Uint8Array(this.buffer,i,n)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(r)}decodetRNS(r){switch(this._colorType){case ji.GREYSCALE:case ji.TRUECOLOUR:{if(r%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${r}`);if(r/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${r/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(r/2);for(let n=0;n<r/2;n++)this._transparency[n]=this.readUint16();break}case ji.INDEXED_COLOUR:{if(r>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${r} vs ${this._palette.length})`);let n=0;for(;n<r;n++){const i=this.readByte();this._palette[n].push(i)}for(;n<this._palette.length;n++)this._palette[n].push(255);break}case ji.UNKNOWN:case ji.GREYSCALE_ALPHA:case ji.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(r){const n=nT(this),i=this.readUint8();if(i!==hm.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${i}`);const a=this.readBytes(r-n.length-2);this._png.iccEmbeddedProfile={name:n,profile:qX(a)}}decodepHYs(){const r=this.readUint32(),n=this.readUint32(),i=this.readByte();this._png.resolution={x:r,y:n,unit:i}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let r=0;r<this._numberOfFrames;r++){const n={sequenceNumber:this._frames[r].sequenceNumber,delayNumber:this._frames[r].delayNumber,delayDenominator:this._frames[r].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},i=this._frames.at(r);if(i){if(i.data=h_({data:i.data,width:i.width,height:i.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),r===0||i.xOffset===0&&i.yOffset===0&&i.width===this._png.width&&i.height===this._png.height)n.data=i.data;else{const a=this._apng.frames.at(r-1);this.disposeFrame(i,a,n),this.addFrameDataToCanvas(n,i)}this._apng.frames.push(n)}}return this._apng}disposeFrame(r,n,i){switch(r.disposeOp){case fh.NONE:break;case fh.BACKGROUND:for(let a=0;a<this._png.height;a++)for(let s=0;s<this._png.width;s++){const o=(a*r.width+s)*this._png.channels;for(let l=0;l<this._png.channels;l++)i.data[o+l]=0}break;case fh.PREVIOUS:i.data.set(n.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(r,n){const i=1<<this._png.depth,a=(s,o)=>{const l=((s+n.yOffset)*this._png.width+n.xOffset+o)*this._png.channels,c=(s*n.width+o)*this._png.channels;return{index:l,frameIndex:c}};switch(n.blendOp){case pm.SOURCE:for(let s=0;s<n.height;s++)for(let o=0;o<n.width;o++){const{index:l,frameIndex:c}=a(s,o);for(let u=0;u<this._png.channels;u++)r.data[l+u]=n.data[c+u]}break;case pm.OVER:for(let s=0;s<n.height;s++)for(let o=0;o<n.width;o++){const{index:l,frameIndex:c}=a(s,o);for(let u=0;u<this._png.channels;u++){const h=n.data[c+this._png.channels-1]/i,p=u%(this._png.channels-1)===0?1:n.data[c+u],d=Math.floor(h*p+(1-h)*r.data[l+u]);r.data[l+u]+=d}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var n;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const r=this._isAnimated?((n=this._frames)==null?void 0:n.at(0)).data:this._inflator.result;if(this._filterMethod!==p_.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===dm.NO_INTERLACE)this._png.data=h_({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===dm.ADAM7)this._png.data=JX({data:r,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const r=this._inflator.result,n=this._frames.at(-1);n?n.data=r:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:fh.NONE,blendOp:pm.SOURCE,data:r}),this._inflator=new c_,this._writingDataChunks=!1}}function pZ(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var m_;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(m_||(m_={}));function mZ(e,t){return new dZ(e,t).decode()}var kt=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function mm(){kt.console&&typeof kt.console.log=="function"&&kt.console.log.apply(kt.console,arguments)}var xr={log:mm,warn:function(e){kt.console&&(typeof kt.console.warn=="function"?kt.console.warn.apply(kt.console,arguments):mm.call(null,arguments))},error:function(e){kt.console&&(typeof kt.console.error=="function"?kt.console.error.apply(kt.console,arguments):mm(e))}};function gm(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){Jo(n.response,t,r)},n.onerror=function(){xr.error("could not download file")},n.send()}function g_(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function hh(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var Jo=kt.saveAs||((typeof window>"u"?"undefined":fr(window))!=="object"||window!==kt?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=kt.URL||kt.webkitURL,i=document.createElement("a");t=t||e.name||"download",i.download=t,i.rel="noopener",typeof e=="string"?(i.href=e,i.origin!==location.origin?g_(i.href)?gm(e,t,r):hh(i,i.target="_blank"):hh(i)):(i.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(i.href)},4e4),setTimeout(function(){hh(i)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(g_(e))gm(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){hh(n)})}else navigator.msSaveOrOpenBlob(function(i,a){return a===void 0?a={autoBom:!1}:fr(a)!=="object"&&(xr.warn("Deprecated: Expected third argument to be a object"),a={autoBom:!a}),a.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(i.type)?new Blob(["\uFEFF",i],{type:i.type}):i}(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return gm(e,t,r);var i=e.type==="application/octet-stream",a=/constructor/i.test(kt.HTMLElement)||kt.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent);if((s||i&&a)&&(typeof FileReader>"u"?"undefined":fr(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var u=o.result;u=s?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=u:location=u,n=null},o.readAsDataURL(e)}else{var l=kt.URL||kt.webkitURL,c=l.createObjectURL(e);n?n.location=c:location.href=c,n=null,setTimeout(function(){l.revokeObjectURL(c)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function iT(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],n=0;n<r.length;n++){var i=r[n].re,a=r[n].process,s=i.exec(e);s&&(t=a(s),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),l=this.g.toString(16),c=this.b.toString(16);return o.length==1&&(o="0"+o),l.length==1&&(l="0"+l),c.length==1&&(c="0"+c),"#"+o+l+c}}var wh=kt.atob.bind(kt),v_=kt.btoa.bind(kt);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function vm(e,t){var r=e[0],n=e[1],i=e[2],a=e[3];r=qn(r,n,i,a,t[0],7,-680876936),a=qn(a,r,n,i,t[1],12,-389564586),i=qn(i,a,r,n,t[2],17,606105819),n=qn(n,i,a,r,t[3],22,-1044525330),r=qn(r,n,i,a,t[4],7,-176418897),a=qn(a,r,n,i,t[5],12,1200080426),i=qn(i,a,r,n,t[6],17,-1473231341),n=qn(n,i,a,r,t[7],22,-45705983),r=qn(r,n,i,a,t[8],7,1770035416),a=qn(a,r,n,i,t[9],12,-1958414417),i=qn(i,a,r,n,t[10],17,-42063),n=qn(n,i,a,r,t[11],22,-1990404162),r=qn(r,n,i,a,t[12],7,1804603682),a=qn(a,r,n,i,t[13],12,-40341101),i=qn(i,a,r,n,t[14],17,-1502002290),r=Hn(r,n=qn(n,i,a,r,t[15],22,1236535329),i,a,t[1],5,-165796510),a=Hn(a,r,n,i,t[6],9,-1069501632),i=Hn(i,a,r,n,t[11],14,643717713),n=Hn(n,i,a,r,t[0],20,-373897302),r=Hn(r,n,i,a,t[5],5,-701558691),a=Hn(a,r,n,i,t[10],9,38016083),i=Hn(i,a,r,n,t[15],14,-660478335),n=Hn(n,i,a,r,t[4],20,-405537848),r=Hn(r,n,i,a,t[9],5,568446438),a=Hn(a,r,n,i,t[14],9,-1019803690),i=Hn(i,a,r,n,t[3],14,-187363961),n=Hn(n,i,a,r,t[8],20,1163531501),r=Hn(r,n,i,a,t[13],5,-1444681467),a=Hn(a,r,n,i,t[2],9,-51403784),i=Hn(i,a,r,n,t[7],14,1735328473),r=Gn(r,n=Hn(n,i,a,r,t[12],20,-1926607734),i,a,t[5],4,-378558),a=Gn(a,r,n,i,t[8],11,-2022574463),i=Gn(i,a,r,n,t[11],16,1839030562),n=Gn(n,i,a,r,t[14],23,-35309556),r=Gn(r,n,i,a,t[1],4,-1530992060),a=Gn(a,r,n,i,t[4],11,1272893353),i=Gn(i,a,r,n,t[7],16,-155497632),n=Gn(n,i,a,r,t[10],23,-1094730640),r=Gn(r,n,i,a,t[13],4,681279174),a=Gn(a,r,n,i,t[0],11,-358537222),i=Gn(i,a,r,n,t[3],16,-722521979),n=Gn(n,i,a,r,t[6],23,76029189),r=Gn(r,n,i,a,t[9],4,-640364487),a=Gn(a,r,n,i,t[12],11,-421815835),i=Gn(i,a,r,n,t[15],16,530742520),r=Vn(r,n=Gn(n,i,a,r,t[2],23,-995338651),i,a,t[0],6,-198630844),a=Vn(a,r,n,i,t[7],10,1126891415),i=Vn(i,a,r,n,t[14],15,-1416354905),n=Vn(n,i,a,r,t[5],21,-57434055),r=Vn(r,n,i,a,t[12],6,1700485571),a=Vn(a,r,n,i,t[3],10,-1894986606),i=Vn(i,a,r,n,t[10],15,-1051523),n=Vn(n,i,a,r,t[1],21,-2054922799),r=Vn(r,n,i,a,t[8],6,1873313359),a=Vn(a,r,n,i,t[15],10,-30611744),i=Vn(i,a,r,n,t[6],15,-1560198380),n=Vn(n,i,a,r,t[13],21,1309151649),r=Vn(r,n,i,a,t[4],6,-145523070),a=Vn(a,r,n,i,t[11],10,-1120210379),i=Vn(i,a,r,n,t[2],15,718787259),n=Vn(n,i,a,r,t[9],21,-343485551),e[0]=yo(r,e[0]),e[1]=yo(n,e[1]),e[2]=yo(i,e[2]),e[3]=yo(a,e[3])}function Op(e,t,r,n,i,a){return t=yo(yo(t,e),yo(n,a)),yo(t<<i|t>>>32-i,r)}function qn(e,t,r,n,i,a,s){return Op(t&r|~t&n,e,t,i,a,s)}function Hn(e,t,r,n,i,a,s){return Op(t&n|r&~n,e,t,i,a,s)}function Gn(e,t,r,n,i,a,s){return Op(t^r^n,e,t,i,a,s)}function Vn(e,t,r,n,i,a,s){return Op(r^(t|~n),e,t,i,a,s)}function aT(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)vm(n,gZ(e.substring(t-64,t)));e=e.substring(t-64);var i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)i[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(i[t>>2]|=128<<(t%4<<3),t>55)for(vm(n,i),t=0;t<16;t++)i[t]=0;return i[14]=8*r,vm(n,i),n}function gZ(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var x_="0123456789abcdef".split("");function vZ(e){for(var t="",r=0;r<4;r++)t+=x_[e>>8*r+4&15]+x_[e>>8*r&15];return t}function xZ(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function Og(e){return aT(e).map(xZ).join("")}var yZ=function(e){for(var t=0;t<e.length;t++)e[t]=vZ(e[t]);return e.join("")}(aT("hello"))!="5d41402abc4b2a76b9719d911017c592";function yo(e,t){if(yZ){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function Lg(e,t){var r,n,i,a;if(e!==r){for(var s=(i=e,a=1+(256/e.length|0),new Array(a+1).join(i)),o=[],l=0;l<256;l++)o[l]=l;var c=0;for(l=0;l<256;l++){var u=o[l];c=(c+u+s.charCodeAt(l))%256,o[l]=o[c],o[c]=u}r=e,n=o}else o=n;var h=t.length,p=0,d=0,v="";for(l=0;l<h;l++)d=(d+(u=o[p=(p+1)%256]))%256,o[p]=o[d],o[d]=u,s=o[(o[p]+o[d])%256],v+=String.fromCharCode(t.charCodeAt(l)^s);return v}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var y_={print:4,modify:8,copy:16,"annot-forms":32};function lc(e,t,r,n){this.v=1,this.r=2;var i=192;e.forEach(function(o){if(y_.perm!==void 0)throw new Error("Invalid permission: "+o);i+=y_[o]}),this.padding="(¬øN^Nu¬äAd\0NV√ø√∫\b..\0¬∂√êh>¬Ä/\f¬©√ædSiz";var a=(t+this.padding).substr(0,32),s=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(a,s),this.P=-(1+(255^i)),this.encryptionKey=Og(a+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=Lg(this.encryptionKey,this.padding)}function cc(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var i=e.charCodeAt(n);t+=i<33||i===35||i===37||i===40||i===41||i===47||i===60||i===62||i===91||i===93||i===123||i===125||i>126?"#"+("0"+i.toString(16)).slice(-2):e[n]}return t}function b_(e){if(fr(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,i){if(i=i||!1,typeof r!="string"||typeof n!="function"||typeof i!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var a=Math.random().toString(35);return t[r][a]=[n,!!i],a},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),i=[];for(var a in t[r]){var s=t[r][a];try{s[0].apply(e,n)}catch(o){kt.console&&xr.error("jsPDF PubSub Error",o.message,o)}s[1]&&i.push(a)}i.length&&i.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function Ad(e){if(!(this instanceof Ad))return new Ad(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function sT(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function rl(e,t,r,n,i){if(!(this instanceof rl))return new rl(e,t,r,n,i);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,sT.call(this,n,i)}function pc(e,t,r,n,i){if(!(this instanceof pc))return new pc(e,t,r,n,i);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,sT.call(this,n,i)}function wt(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],i=arguments[2],a=arguments[3],s=[],o=1,l=16,c="S",u=null;fr(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,i=e.format||i,a=e.compress||e.compressPdf||a,(u=e.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),o=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(l=e.floatPrecision),c=e.defaultPathOperation||"S"),s=e.filters||(a===!0?["FlateEncode"]:s),n=n||"mm",r=(""+(r||"P")).toLowerCase();var h=e.putOnlyUsedFonts||!1,p={},d={internal:{},__private__:{}};d.__private__.PubSub=b_;var v="1.3",g=d.__private__.getPdfVersion=function(){return v};d.__private__.setPdfVersion=function(w){v=w};var y={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};d.__private__.getPageFormats=function(){return y};var b=d.__private__.getPageFormat=function(w){return y[w]};i=i||"a4";var E="compat",S="advanced",P=E;function L(){this.saveGraphicsState(),Q(new Nt(_t,0,0,-_t,0,wi()*_t).toString()+" cm"),this.setFontSize(this.getFontSize()/_t),c="n",P=S}function q(){this.restoreGraphicsState(),c="S",P=E}var C=d.__private__.combineFontStyleAndFontWeight=function(w,I){if(w=="bold"&&I=="normal"||w=="bold"&&I==400||w=="normal"&&I=="italic"||w=="bold"&&I=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return I&&(w=I==400||I==="normal"?w==="italic"?"italic":"normal":I!=700&&I!=="bold"||w!=="normal"?(I==700?"bold":I)+""+w:"bold"),w};d.advancedAPI=function(w){var I=P===E;return I&&L.call(this),typeof w!="function"||(w(this),I&&q.call(this)),this},d.compatAPI=function(w){var I=P===S;return I&&q.call(this),typeof w!="function"||(w(this),I&&L.call(this)),this},d.isAdvancedAPI=function(){return P===S};var R,k=function(w){if(P!==S)throw new Error(w+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},G=d.roundToPrecision=d.__private__.roundToPrecision=function(w,I){var ie=t||I;if(isNaN(w)||isNaN(ie))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return w.toFixed(ie).replace(/0+$/,"")};R=d.hpf=d.__private__.hpf=typeof l=="number"?function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.hpf");return G(w,l)}:l==="smart"?function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.hpf");return G(w,w>-1&&w<1?16:5)}:function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.hpf");return G(w,16)};var _=d.f2=d.__private__.f2=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.f2");return G(w,2)},j=d.__private__.f3=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.f3");return G(w,3)},H=d.scale=d.__private__.scale=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.scale");return P===E?w*_t:P===S?w:void 0},X=function(w){return H(function(I){return P===E?wi()-I:P===S?I:void 0}(w))};d.__private__.setPrecision=d.setPrecision=function(w){typeof parseInt(w,10)=="number"&&(t=parseInt(w,10))};var ce,pe="00000000000000000000000000000000",ye=d.__private__.getFileId=function(){return pe},me=d.__private__.setFileId=function(w){return pe=w!==void 0&&/^[a-fA-F0-9]{32}$/.test(w)?w.toUpperCase():pe.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(Wr=new lc(u.userPermissions,u.userPassword,u.ownerPassword,pe)),pe};d.setFileId=function(w){return me(w),this},d.getFileId=function(){return ye()};var be=d.__private__.convertDateToPDFDate=function(w){var I=w.getTimezoneOffset(),ie=I<0?"+":"-",he=Math.floor(Math.abs(I/60)),we=Math.abs(I%60),Ie=[ie,O(he),"'",O(we),"'"].join("");return["D:",w.getFullYear(),O(w.getMonth()+1),O(w.getDate()),O(w.getHours()),O(w.getMinutes()),O(w.getSeconds()),Ie].join("")},Ue=d.__private__.convertPDFDateToDate=function(w){var I=parseInt(w.substr(2,4),10),ie=parseInt(w.substr(6,2),10)-1,he=parseInt(w.substr(8,2),10),we=parseInt(w.substr(10,2),10),Ie=parseInt(w.substr(12,2),10),qe=parseInt(w.substr(14,2),10);return new Date(I,ie,he,we,Ie,qe,0)},Fe=d.__private__.setCreationDate=function(w){var I;if(w===void 0&&(w=new Date),w instanceof Date)I=be(w);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(w))throw new Error("Invalid argument passed to jsPDF.setCreationDate");I=w}return ce=I},A=d.__private__.getCreationDate=function(w){var I=ce;return w==="jsDate"&&(I=Ue(ce)),I};d.setCreationDate=function(w){return Fe(w),this},d.getCreationDate=function(w){return A(w)};var F,O=d.__private__.padd2=function(w){return("0"+parseInt(w)).slice(-2)},M=d.__private__.padd2Hex=function(w){return("00"+(w=w.toString())).substr(w.length)},J=0,fe=[],ve=[],ae=0,ue=[],oe=[],le=!1,Be=ve;d.__private__.setCustomOutputDestination=function(w){le=!0,Be=w};var ge=function(w){le||(Be=w)};d.__private__.resetCustomOutputDestination=function(){le=!1,Be=ve};var Q=d.__private__.out=function(w){return w=w.toString(),ae+=w.length+1,Be.push(w),Be},tt=d.__private__.write=function(w){return Q(arguments.length===1?w.toString():Array.prototype.join.call(arguments," "))},Re=d.__private__.getArrayBuffer=function(w){for(var I=w.length,ie=new ArrayBuffer(I),he=new Uint8Array(ie);I--;)he[I]=w.charCodeAt(I);return ie},it=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];d.__private__.getStandardFonts=function(){return it};var We=e.fontSize||16;d.__private__.setFontSize=d.setFontSize=function(w){return We=P===S?w/_t:w,this};var st,Ze=d.__private__.getFontSize=d.getFontSize=function(){return P===E?We:We*_t},Pt=e.R2L||!1;d.__private__.setR2L=d.setR2L=function(w){return Pt=w,this},d.__private__.getR2L=d.getR2L=function(){return Pt};var ft,Lt=d.__private__.setZoomMode=function(w){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(w))st=w;else if(isNaN(w)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(w)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+w+'" is not recognized.');st=w}else st=parseInt(w,10)};d.__private__.getZoomMode=function(){return st};var At,Et=d.__private__.setPageMode=function(w){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(w)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+w+'" is not recognized.');ft=w};d.__private__.getPageMode=function(){return ft};var Kt=d.__private__.setLayoutMode=function(w){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(w)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+w+'" is not recognized.');At=w};d.__private__.getLayoutMode=function(){return At},d.__private__.setDisplayMode=d.setDisplayMode=function(w,I,ie){return Lt(w),Kt(I),Et(ie),this};var yt={title:"",subject:"",author:"",keywords:"",creator:""};d.__private__.getDocumentProperty=function(w){if(Object.keys(yt).indexOf(w)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return yt[w]},d.__private__.getDocumentProperties=function(){return yt},d.__private__.setDocumentProperties=d.setProperties=d.setDocumentProperties=function(w){for(var I in yt)yt.hasOwnProperty(I)&&w[I]&&(yt[I]=w[I]);return this},d.__private__.setDocumentProperty=function(w,I){if(Object.keys(yt).indexOf(w)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return yt[w]=I};var pt,_t,mt,Qt,Ut,ht={},je={},nt=[],ot={},Ct={},St={},ir={},ar=null,zt=0,at=[],$t=new b_(d),Tn=e.hotfixes||[],Fr={},da={},Vi=[],Nt=function w(I,ie,he,we,Ie,qe){if(!(this instanceof w))return new w(I,ie,he,we,Ie,qe);isNaN(I)&&(I=1),isNaN(ie)&&(ie=0),isNaN(he)&&(he=0),isNaN(we)&&(we=1),isNaN(Ie)&&(Ie=0),isNaN(qe)&&(qe=0),this._matrix=[I,ie,he,we,Ie,qe]};Object.defineProperty(Nt.prototype,"sx",{get:function(){return this._matrix[0]},set:function(w){this._matrix[0]=w}}),Object.defineProperty(Nt.prototype,"shy",{get:function(){return this._matrix[1]},set:function(w){this._matrix[1]=w}}),Object.defineProperty(Nt.prototype,"shx",{get:function(){return this._matrix[2]},set:function(w){this._matrix[2]=w}}),Object.defineProperty(Nt.prototype,"sy",{get:function(){return this._matrix[3]},set:function(w){this._matrix[3]=w}}),Object.defineProperty(Nt.prototype,"tx",{get:function(){return this._matrix[4]},set:function(w){this._matrix[4]=w}}),Object.defineProperty(Nt.prototype,"ty",{get:function(){return this._matrix[5]},set:function(w){this._matrix[5]=w}}),Object.defineProperty(Nt.prototype,"a",{get:function(){return this._matrix[0]},set:function(w){this._matrix[0]=w}}),Object.defineProperty(Nt.prototype,"b",{get:function(){return this._matrix[1]},set:function(w){this._matrix[1]=w}}),Object.defineProperty(Nt.prototype,"c",{get:function(){return this._matrix[2]},set:function(w){this._matrix[2]=w}}),Object.defineProperty(Nt.prototype,"d",{get:function(){return this._matrix[3]},set:function(w){this._matrix[3]=w}}),Object.defineProperty(Nt.prototype,"e",{get:function(){return this._matrix[4]},set:function(w){this._matrix[4]=w}}),Object.defineProperty(Nt.prototype,"f",{get:function(){return this._matrix[5]},set:function(w){this._matrix[5]=w}}),Object.defineProperty(Nt.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Nt.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Nt.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Nt.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Nt.prototype.join=function(w){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(R).join(w)},Nt.prototype.multiply=function(w){var I=w.sx*this.sx+w.shy*this.shx,ie=w.sx*this.shy+w.shy*this.sy,he=w.shx*this.sx+w.sy*this.shx,we=w.shx*this.shy+w.sy*this.sy,Ie=w.tx*this.sx+w.ty*this.shx+this.tx,qe=w.tx*this.shy+w.ty*this.sy+this.ty;return new Nt(I,ie,he,we,Ie,qe)},Nt.prototype.decompose=function(){var w=this.sx,I=this.shy,ie=this.shx,he=this.sy,we=this.tx,Ie=this.ty,qe=Math.sqrt(w*w+I*I),dt=(w/=qe)*ie+(I/=qe)*he;ie-=w*dt,he-=I*dt;var xt=Math.sqrt(ie*ie+he*he);return dt/=xt,w*(he/=xt)<I*(ie/=xt)&&(w=-w,I=-I,dt=-dt,qe=-qe),{scale:new Nt(qe,0,0,xt,0,0),translate:new Nt(1,0,0,1,we,Ie),rotate:new Nt(w,I,-I,w,0,0),skew:new Nt(1,0,dt,1,0,0)}},Nt.prototype.toString=function(w){return this.join(" ")},Nt.prototype.inversed=function(){var w=this.sx,I=this.shy,ie=this.shx,he=this.sy,we=this.tx,Ie=this.ty,qe=1/(w*he-I*ie),dt=he*qe,xt=-I*qe,jt=-ie*qe,It=w*qe;return new Nt(dt,xt,jt,It,-dt*we-jt*Ie,-xt*we-It*Ie)},Nt.prototype.applyToPoint=function(w){var I=w.x*this.sx+w.y*this.shx+this.tx,ie=w.x*this.shy+w.y*this.sy+this.ty;return new zo(I,ie)},Nt.prototype.applyToRectangle=function(w){var I=this.applyToPoint(w),ie=this.applyToPoint(new zo(w.x+w.w,w.y+w.h));return new xu(I.x,I.y,ie.x-I.x,ie.y-I.y)},Nt.prototype.clone=function(){var w=this.sx,I=this.shy,ie=this.shx,he=this.sy,we=this.tx,Ie=this.ty;return new Nt(w,I,ie,he,we,Ie)},d.Matrix=Nt;var pa=d.matrixMult=function(w,I){return I.multiply(w)},ma=new Nt(1,0,0,1,0,0);d.unitMatrix=d.identityMatrix=ma;var $n=function(w,I){if(!Ct[w]){var ie=(I instanceof rl?"Sh":"P")+(Object.keys(ot).length+1).toString(10);I.id=ie,Ct[w]=ie,ot[ie]=I,$t.publish("addPattern",I)}};d.ShadingPattern=rl,d.TilingPattern=pc,d.addShadingPattern=function(w,I){return k("addShadingPattern()"),$n(w,I),this},d.beginTilingPattern=function(w){k("beginTilingPattern()"),yu(w.boundingBox[0],w.boundingBox[1],w.boundingBox[2]-w.boundingBox[0],w.boundingBox[3]-w.boundingBox[1],w.matrix)},d.endTilingPattern=function(w,I){k("endTilingPattern()"),I.stream=oe[F].join(`
`),$n(w,I),$t.publish("endTilingPattern",I),Vi.pop().restore()};var li,kr=d.__private__.newObject=function(){var w=Qr();return B(w,!0),w},Qr=d.__private__.newObjectDeferred=function(){return J++,fe[J]=function(){return ae},J},B=function(w,I){return I=typeof I=="boolean"&&I,fe[w]=ae,I&&Q(w+" 0 obj"),w},re=d.__private__.newAdditionalObject=function(){var w={objId:Qr(),content:""};return ue.push(w),w},K=Qr(),Z=Qr(),ne=d.__private__.decodeColorString=function(w){var I=w.split(" ");if(I.length!==2||I[1]!=="g"&&I[1]!=="G")I.length!==5||I[4]!=="k"&&I[4]!=="K"||(I=[(1-I[0])*(1-I[3]),(1-I[1])*(1-I[3]),(1-I[2])*(1-I[3]),"r"]);else{var ie=parseFloat(I[0]);I=[ie,ie,ie,"r"]}for(var he="#",we=0;we<3;we++)he+=("0"+Math.floor(255*parseFloat(I[we])).toString(16)).slice(-2);return he},se=d.__private__.encodeColorString=function(w){var I;typeof w=="string"&&(w={ch1:w});var ie=w.ch1,he=w.ch2,we=w.ch3,Ie=w.ch4,qe=w.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof ie=="string"&&ie.charAt(0)!=="#"){var dt=new iT(ie);if(dt.ok)ie=dt.toHex();else if(!/^\d*\.?\d*$/.test(ie))throw new Error('Invalid color "'+ie+'" passed to jsPDF.encodeColorString.')}if(typeof ie=="string"&&/^#[0-9A-Fa-f]{3}$/.test(ie)&&(ie="#"+ie[1]+ie[1]+ie[2]+ie[2]+ie[3]+ie[3]),typeof ie=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ie)){var xt=parseInt(ie.substr(1),16);ie=xt>>16&255,he=xt>>8&255,we=255&xt}if(he===void 0||Ie===void 0&&ie===he&&he===we)I=typeof ie=="string"?ie+" "+qe[0]:w.precision===2?_(ie/255)+" "+qe[0]:j(ie/255)+" "+qe[0];else if(Ie===void 0||fr(Ie)==="object"){if(Ie&&!isNaN(Ie.a)&&Ie.a===0)return["1.","1.","1.",qe[1]].join(" ");I=typeof ie=="string"?[ie,he,we,qe[1]].join(" "):w.precision===2?[_(ie/255),_(he/255),_(we/255),qe[1]].join(" "):[j(ie/255),j(he/255),j(we/255),qe[1]].join(" ")}else I=typeof ie=="string"?[ie,he,we,Ie,qe[2]].join(" "):w.precision===2?[_(ie),_(he),_(we),_(Ie),qe[2]].join(" "):[j(ie),j(he),j(we),j(Ie),qe[2]].join(" ");return I},Ne=d.__private__.getFilters=function(){return s},Ce=d.__private__.putStream=function(w){var I=(w=w||{}).data||"",ie=w.filters||Ne(),he=w.alreadyAppliedFilters||[],we=w.addLength1||!1,Ie=I.length,qe=w.objectId,dt=function(cn){return cn};if(u!==null&&qe===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(dt=Wr.encryptor(qe,0));var xt={};ie===!0&&(ie=["FlateEncode"]);var jt=w.additionalKeyValues||[],It=(xt=wt.API.processDataByFilters!==void 0?wt.API.processDataByFilters(I,ie):{data:I,reverseChain:[]}).reverseChain+(Array.isArray(he)?he.join(" "):he.toString());if(xt.data.length!==0&&(jt.push({key:"Length",value:xt.data.length}),we===!0&&jt.push({key:"Length1",value:Ie})),It.length!=0)if(It.split("/").length-1==1)jt.push({key:"Filter",value:It});else{jt.push({key:"Filter",value:"["+It+"]"});for(var er=0;er<jt.length;er+=1)if(jt[er].key==="DecodeParms"){for(var Dr=[],tn=0;tn<xt.reverseChain.split("/").length-1;tn+=1)Dr.push("null");Dr.push(jt[er].value),jt[er].value="["+Dr.join(" ")+"]"}}Q("<<");for(var mr=0;mr<jt.length;mr++)Q("/"+jt[mr].key+" "+jt[mr].value);Q(">>"),xt.data.length!==0&&(Q("stream"),Q(dt(xt.data)),Q("endstream"))},Se=d.__private__.putPage=function(w){var I=w.number,ie=w.data,he=w.objId,we=w.contentsObjId;B(he,!0),Q("<</Type /Page"),Q("/Parent "+w.rootDictionaryObjId+" 0 R"),Q("/Resources "+w.resourceDictionaryObjId+" 0 R"),Q("/MediaBox ["+parseFloat(R(w.mediaBox.bottomLeftX))+" "+parseFloat(R(w.mediaBox.bottomLeftY))+" "+R(w.mediaBox.topRightX)+" "+R(w.mediaBox.topRightY)+"]"),w.cropBox!==null&&Q("/CropBox ["+R(w.cropBox.bottomLeftX)+" "+R(w.cropBox.bottomLeftY)+" "+R(w.cropBox.topRightX)+" "+R(w.cropBox.topRightY)+"]"),w.bleedBox!==null&&Q("/BleedBox ["+R(w.bleedBox.bottomLeftX)+" "+R(w.bleedBox.bottomLeftY)+" "+R(w.bleedBox.topRightX)+" "+R(w.bleedBox.topRightY)+"]"),w.trimBox!==null&&Q("/TrimBox ["+R(w.trimBox.bottomLeftX)+" "+R(w.trimBox.bottomLeftY)+" "+R(w.trimBox.topRightX)+" "+R(w.trimBox.topRightY)+"]"),w.artBox!==null&&Q("/ArtBox ["+R(w.artBox.bottomLeftX)+" "+R(w.artBox.bottomLeftY)+" "+R(w.artBox.topRightX)+" "+R(w.artBox.topRightY)+"]"),typeof w.userUnit=="number"&&w.userUnit!==1&&Q("/UserUnit "+w.userUnit),$t.publish("putPage",{objId:he,pageContext:at[I],pageNumber:I,page:ie}),Q("/Contents "+we+" 0 R"),Q(">>"),Q("endobj");var Ie=ie.join(`
`);return P===S&&(Ie+=`
Q`),B(we,!0),Ce({data:Ie,filters:Ne(),objectId:we}),Q("endobj"),he},Ae=d.__private__.putPages=function(){var w,I,ie=[];for(w=1;w<=zt;w++)at[w].objId=Qr(),at[w].contentsObjId=Qr();for(w=1;w<=zt;w++)ie.push(Se({number:w,data:oe[w],objId:at[w].objId,contentsObjId:at[w].contentsObjId,mediaBox:at[w].mediaBox,cropBox:at[w].cropBox,bleedBox:at[w].bleedBox,trimBox:at[w].trimBox,artBox:at[w].artBox,userUnit:at[w].userUnit,rootDictionaryObjId:K,resourceDictionaryObjId:Z}));B(K,!0),Q("<</Type /Pages");var he="/Kids [";for(I=0;I<zt;I++)he+=ie[I]+" 0 R ";Q(he+"]"),Q("/Count "+zt),Q(">>"),Q("endobj"),$t.publish("postPutPages")},Pe=function(w){$t.publish("putFont",{font:w,out:Q,newObject:kr,putStream:Ce}),w.isAlreadyPutted!==!0&&(w.objectNumber=kr(),Q("<<"),Q("/Type /Font"),Q("/BaseFont /"+cc(w.postScriptName)),Q("/Subtype /Type1"),typeof w.encoding=="string"&&Q("/Encoding /"+w.encoding),Q("/FirstChar 32"),Q("/LastChar 255"),Q(">>"),Q("endobj"))},He=function(w){w.objectNumber=kr();var I=[];I.push({key:"Type",value:"/XObject"}),I.push({key:"Subtype",value:"/Form"}),I.push({key:"BBox",value:"["+[R(w.x),R(w.y),R(w.x+w.width),R(w.y+w.height)].join(" ")+"]"}),I.push({key:"Matrix",value:"["+w.matrix.toString()+"]"});var ie=w.pages[1].join(`
`);Ce({data:ie,additionalKeyValues:I,objectId:w.objectNumber}),Q("endobj")},Ke=function(w,I){I||(I=21);var ie=kr(),he=function(qe,dt){var xt,jt=[],It=1/(dt-1);for(xt=0;xt<1;xt+=It)jt.push(xt);if(jt.push(1),qe[0].offset!=0){var er={offset:0,color:qe[0].color};qe.unshift(er)}if(qe[qe.length-1].offset!=1){var Dr={offset:1,color:qe[qe.length-1].color};qe.push(Dr)}for(var tn="",mr=0,cn=0;cn<jt.length;cn++){for(xt=jt[cn];xt>qe[mr+1].offset;)mr++;var rn=qe[mr].offset,Pn=(xt-rn)/(qe[mr+1].offset-rn),us=qe[mr].color,Ks=qe[mr+1].color;tn+=M(Math.round((1-Pn)*us[0]+Pn*Ks[0]).toString(16))+M(Math.round((1-Pn)*us[1]+Pn*Ks[1]).toString(16))+M(Math.round((1-Pn)*us[2]+Pn*Ks[2]).toString(16))}return tn.trim()}(w.colors,I),we=[];we.push({key:"FunctionType",value:"0"}),we.push({key:"Domain",value:"[0.0 1.0]"}),we.push({key:"Size",value:"["+I+"]"}),we.push({key:"BitsPerSample",value:"8"}),we.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),we.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ce({data:he,additionalKeyValues:we,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:ie}),Q("endobj"),w.objectNumber=kr(),Q("<< /ShadingType "+w.type),Q("/ColorSpace /DeviceRGB");var Ie="/Coords ["+R(parseFloat(w.coords[0]))+" "+R(parseFloat(w.coords[1]))+" ";w.type===2?Ie+=R(parseFloat(w.coords[2]))+" "+R(parseFloat(w.coords[3])):Ie+=R(parseFloat(w.coords[2]))+" "+R(parseFloat(w.coords[3]))+" "+R(parseFloat(w.coords[4]))+" "+R(parseFloat(w.coords[5])),Q(Ie+="]"),w.matrix&&Q("/Matrix ["+w.matrix.toString()+"]"),Q("/Function "+ie+" 0 R"),Q("/Extend [true true]"),Q(">>"),Q("endobj")},rt=function(w,I){var ie=Qr(),he=kr();I.push({resourcesOid:ie,objectOid:he}),w.objectNumber=he;var we=[];we.push({key:"Type",value:"/Pattern"}),we.push({key:"PatternType",value:"1"}),we.push({key:"PaintType",value:"1"}),we.push({key:"TilingType",value:"1"}),we.push({key:"BBox",value:"["+w.boundingBox.map(R).join(" ")+"]"}),we.push({key:"XStep",value:R(w.xStep)}),we.push({key:"YStep",value:R(w.yStep)}),we.push({key:"Resources",value:ie+" 0 R"}),w.matrix&&we.push({key:"Matrix",value:"["+w.matrix.toString()+"]"}),Ce({data:w.stream,additionalKeyValues:we,objectId:w.objectNumber}),Q("endobj")},Ve=function(w){for(var I in w.objectNumber=kr(),Q("<<"),w)switch(I){case"opacity":Q("/ca "+_(w[I]));break;case"stroke-opacity":Q("/CA "+_(w[I]))}Q(">>"),Q("endobj")},Qe=function(w){B(w.resourcesOid,!0),Q("<<"),Q("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var I in Q("/Font <<"),ht)ht.hasOwnProperty(I)&&(h===!1||h===!0&&p.hasOwnProperty(I))&&Q("/"+I+" "+ht[I].objectNumber+" 0 R");Q(">>")}(),function(){if(Object.keys(ot).length>0){for(var I in Q("/Shading <<"),ot)ot.hasOwnProperty(I)&&ot[I]instanceof rl&&ot[I].objectNumber>=0&&Q("/"+I+" "+ot[I].objectNumber+" 0 R");$t.publish("putShadingPatternDict"),Q(">>")}}(),function(I){if(Object.keys(ot).length>0){for(var ie in Q("/Pattern <<"),ot)ot.hasOwnProperty(ie)&&ot[ie]instanceof d.TilingPattern&&ot[ie].objectNumber>=0&&ot[ie].objectNumber<I&&Q("/"+ie+" "+ot[ie].objectNumber+" 0 R");$t.publish("putTilingPatternDict"),Q(">>")}}(w.objectOid),function(){if(Object.keys(St).length>0){var I;for(I in Q("/ExtGState <<"),St)St.hasOwnProperty(I)&&St[I].objectNumber>=0&&Q("/"+I+" "+St[I].objectNumber+" 0 R");$t.publish("putGStateDict"),Q(">>")}}(),function(){for(var I in Q("/XObject <<"),Fr)Fr.hasOwnProperty(I)&&Fr[I].objectNumber>=0&&Q("/"+I+" "+Fr[I].objectNumber+" 0 R");$t.publish("putXobjectDict"),Q(">>")}(),Q(">>"),Q("endobj")},Tt=function(w){je[w.fontName]=je[w.fontName]||{},je[w.fontName][w.fontStyle]=w.id},pr=function(w,I,ie,he,we){var Ie={id:"F"+(Object.keys(ht).length+1).toString(10),postScriptName:w,fontName:I,fontStyle:ie,encoding:he,isStandardFont:we||!1,metadata:{}};return $t.publish("addFont",{font:Ie,instance:this}),ht[Ie.id]=Ie,Tt(Ie),Ie.id},Wt=d.__private__.pdfEscape=d.pdfEscape=function(w,I){return function(ie,he){var we,Ie,qe,dt,xt,jt,It,er,Dr;if(qe=(he=he||{}).sourceEncoding||"Unicode",xt=he.outputEncoding,(he.autoencode||xt)&&ht[pt].metadata&&ht[pt].metadata[qe]&&ht[pt].metadata[qe].encoding&&(dt=ht[pt].metadata[qe].encoding,!xt&&ht[pt].encoding&&(xt=ht[pt].encoding),!xt&&dt.codePages&&(xt=dt.codePages[0]),typeof xt=="string"&&(xt=dt[xt]),xt)){for(It=!1,jt=[],we=0,Ie=ie.length;we<Ie;we++)(er=xt[ie.charCodeAt(we)])?jt.push(String.fromCharCode(er)):jt.push(ie[we]),jt[we].charCodeAt(0)>>8&&(It=!0);ie=jt.join("")}for(we=ie.length;It===void 0&&we!==0;)ie.charCodeAt(we-1)>>8&&(It=!0),we--;if(!It)return ie;for(jt=he.noBOM?[]:[254,255],we=0,Ie=ie.length;we<Ie;we++){if((Dr=(er=ie.charCodeAt(we))>>8)>>8)throw new Error("Character at position "+we+" of string '"+ie+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");jt.push(Dr),jt.push(er-(Dr<<8))}return String.fromCharCode.apply(void 0,jt)}(w,I).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Ir=d.__private__.beginPage=function(w){oe[++zt]=[],at[zt]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(w[0]),topRightY:Number(w[1])}},Ra(zt),ge(oe[F])},Ma=function(w,I){var ie,he,we;switch(r=I||r,typeof w=="string"&&(ie=b(w.toLowerCase()),Array.isArray(ie)&&(he=ie[0],we=ie[1])),Array.isArray(w)&&(he=w[0]*_t,we=w[1]*_t),isNaN(he)&&(he=i[0],we=i[1]),(he>14400||we>14400)&&(xr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),he=Math.min(14400,he),we=Math.min(14400,we)),i=[he,we],r.substr(0,1)){case"l":we>he&&(i=[we,he]);break;case"p":he>we&&(i=[we,he])}Ir(i),$p(pu),Q(Ul),gu!==0&&Q(gu+" J"),vu!==0&&Q(vu+" j"),$t.publish("addPage",{pageNumber:zt})},ga=function(w){w>0&&w<=zt&&(oe.splice(w,1),at.splice(w,1),zt--,F>zt&&(F=zt),this.setPage(F))},Ra=function(w){w>0&&w<=zt&&(F=w)},Ki=d.__private__.getNumberOfPages=d.getNumberOfPages=function(){return oe.length-1},Hs=function(w,I,ie){var he,we=void 0;return ie=ie||{},w=w!==void 0?w:ht[pt].fontName,I=I!==void 0?I:ht[pt].fontStyle,he=w.toLowerCase(),je[he]!==void 0&&je[he][I]!==void 0?we=je[he][I]:je[w]!==void 0&&je[w][I]!==void 0?we=je[w][I]:ie.disableWarning===!1&&xr.warn("Unable to look up font label for font '"+w+"', '"+I+"'. Refer to getFontList() for available fonts."),we||ie.noFallback||(we=je.times[I])==null&&(we=je.times.normal),we},zn=d.__private__.putInfo=function(){var w=kr(),I=function(he){return he};for(var ie in u!==null&&(I=Wr.encryptor(w,0)),Q("<<"),Q("/Producer ("+Wt(I("jsPDF "+wt.version))+")"),yt)yt.hasOwnProperty(ie)&&yt[ie]&&Q("/"+ie.substr(0,1).toUpperCase()+ie.substr(1)+" ("+Wt(I(yt[ie]))+")");Q("/CreationDate ("+Wt(I(ce))+")"),Q(">>"),Q("endobj")},Lp=d.__private__.putCatalog=function(w){var I=(w=w||{}).rootDictionaryObjId||K;switch(kr(),Q("<<"),Q("/Type /Catalog"),Q("/Pages "+I+" 0 R"),st||(st="fullwidth"),st){case"fullwidth":Q("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Q("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Q("/OpenAction [3 0 R /Fit]");break;case"original":Q("/OpenAction [3 0 R /XYZ null null 1]");break;default:var ie=""+st;ie.substr(ie.length-1)==="%"&&(st=parseInt(st)/100),typeof st=="number"&&Q("/OpenAction [3 0 R /XYZ null null "+_(st)+"]")}switch(At||(At="continuous"),At){case"continuous":Q("/PageLayout /OneColumn");break;case"single":Q("/PageLayout /SinglePage");break;case"two":case"twoleft":Q("/PageLayout /TwoColumnLeft");break;case"tworight":Q("/PageLayout /TwoColumnRight")}ft&&Q("/PageMode /"+ft),$t.publish("putCatalog"),Q(">>"),Q("endobj")},en=d.__private__.putTrailer=function(){Q("trailer"),Q("<<"),Q("/Size "+(J+1)),Q("/Root "+J+" 0 R"),Q("/Info "+(J-1)+" 0 R"),u!==null&&Q("/Encrypt "+Wr.oid+" 0 R"),Q("/ID [ <"+pe+"> <"+pe+"> ]"),Q(">>")},m0=d.__private__.putHeader=function(){Q("%PDF-"+v),Q("%¬∫√ü¬¨√†")},g0=d.__private__.putXRef=function(){var w="0000000000";Q("xref"),Q("0 "+(J+1)),Q("0000000000 65535 f ");for(var I=1;I<=J;I++)typeof fe[I]=="function"?Q((w+fe[I]()).slice(-10)+" 00000 n "):fe[I]!==void 0?Q((w+fe[I]).slice(-10)+" 00000 n "):Q("0000000000 00000 n ")},os=d.__private__.buildDocument=function(){var w;J=0,ae=0,ve=[],fe=[],ue=[],K=Qr(),Z=Qr(),ge(ve),$t.publish("buildDocument"),m0(),Ae(),function(){$t.publish("putAdditionalObjects");for(var ie=0;ie<ue.length;ie++){var he=ue[ie];B(he.objId,!0),Q(he.content),Q("endobj")}$t.publish("postPutAdditionalObjects")}(),w=[],function(){for(var ie in ht)ht.hasOwnProperty(ie)&&(h===!1||h===!0&&p.hasOwnProperty(ie))&&Pe(ht[ie])}(),function(){var ie;for(ie in St)St.hasOwnProperty(ie)&&Ve(St[ie])}(),function(){for(var ie in Fr)Fr.hasOwnProperty(ie)&&He(Fr[ie])}(),function(ie){var he;for(he in ot)ot.hasOwnProperty(he)&&(ot[he]instanceof rl?Ke(ot[he]):ot[he]instanceof pc&&rt(ot[he],ie))}(w),$t.publish("putResources"),w.forEach(Qe),Qe({resourcesOid:Z,objectOid:Number.MAX_SAFE_INTEGER}),$t.publish("postPutResources"),u!==null&&(Wr.oid=kr(),Q("<<"),Q("/Filter /Standard"),Q("/V "+Wr.v),Q("/R "+Wr.r),Q("/U <"+Wr.toHexString(Wr.U)+">"),Q("/O <"+Wr.toHexString(Wr.O)+">"),Q("/P "+Wr.P),Q(">>"),Q("endobj")),zn(),Lp();var I=ae;return g0(),en(),Q("startxref"),Q(""+I),Q("%%EOF"),ge(oe[F]),ve.join(`
`)},Io=d.__private__.getBlob=function(w){return new Blob([Re(w)],{type:"application/pdf"})},va=d.output=d.__private__.output=(li=function(w,I){switch(typeof(I=I||{})=="string"?I={filename:I}:I.filename=I.filename||"generated.pdf",w){case void 0:return os();case"save":d.save(I.filename);break;case"arraybuffer":return Re(os());case"blob":return Io(os());case"bloburi":case"bloburl":if(kt.URL!==void 0&&typeof kt.URL.createObjectURL=="function")return kt.URL&&kt.URL.createObjectURL(Io(os()))||void 0;xr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var ie="",he=os();try{ie=v_(he)}catch{ie=v_(unescape(encodeURIComponent(he)))}return"data:application/pdf;filename="+I.filename+";base64,"+ie;case"pdfobjectnewwindow":if(Object.prototype.toString.call(kt)==="[object Window]"){var we="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Ie=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';I.pdfObjectUrl&&(we=I.pdfObjectUrl,Ie="");var qe='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+we+'"'+Ie+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(I)+");<\/script></body></html>",dt=kt.open();return dt!==null&&dt.document.write(qe),dt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(kt)==="[object Window]"){var xt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(I.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+I.filename+'" width="500px" height="400px" /></body></html>',jt=kt.open();if(jt!==null){jt.document.write(xt);var It=this;jt.document.documentElement.querySelector("#pdfViewer").onload=function(){jt.document.title=I.filename,jt.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(It.output("bloburl"))}}return jt}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(kt)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var er='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",I)+'"></iframe></body></html>',Dr=kt.open();if(Dr!==null&&(Dr.document.write(er),Dr.document.title=I.filename),Dr||typeof safari>"u")return Dr;break;case"datauri":case"dataurl":return kt.document.location.href=this.output("datauristring",I);default:return null}},li.foo=function(){try{return li.apply(this,arguments)}catch(ie){var w=ie.stack||"";~w.indexOf(" at ")&&(w=w.split(" at ")[1]);var I="Error in function "+w.split(`
`)[0].split("<")[0]+": "+ie.message;if(!kt.console)throw new Error(I);kt.console.error(I,ie),kt.alert&&alert(I)}},li.foo.bar=li,li.foo),Mo=function(w){return Array.isArray(Tn)===!0&&Tn.indexOf(w)>-1};switch(n){case"pt":_t=1;break;case"mm":_t=72/25.4;break;case"cm":_t=72/2.54;break;case"in":_t=72;break;case"px":_t=Mo("px_scaling")==1?.75:96/72;break;case"pc":case"em":_t=12;break;case"ex":_t=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);_t=n}var Wr=null;Fe(),me();var fu=d.__private__.getPageInfo=d.getPageInfo=function(w){if(isNaN(w)||w%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:at[w].objId,pageNumber:w,pageContext:at[w]}},Fp=d.__private__.getPageInfoByObjId=function(w){if(isNaN(w)||w%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var I in at)if(at[I].objId===w)break;return fu(I)},Dp=d.__private__.getCurrentPageInfo=d.getCurrentPageInfo=function(){return{objId:at[F].objId,pageNumber:F,pageContext:at[F]}};d.addPage=function(){return Ma.apply(this,arguments),this},d.setPage=function(){return Ra.apply(this,arguments),ge.call(this,oe[F]),this},d.insertPage=function(w){return this.addPage(),this.movePage(F,w),this},d.movePage=function(w,I){var ie,he;if(w>I){ie=oe[w],he=at[w];for(var we=w;we>I;we--)oe[we]=oe[we-1],at[we]=at[we-1];oe[I]=ie,at[I]=he,this.setPage(I)}else if(w<I){ie=oe[w],he=at[w];for(var Ie=w;Ie<I;Ie++)oe[Ie]=oe[Ie+1],at[Ie]=at[Ie+1];oe[I]=ie,at[I]=he,this.setPage(I)}return this},d.deletePage=function(){return ga.apply(this,arguments),this},d.__private__.text=d.text=function(w,I,ie,he,we){var Ie,qe,dt,xt,jt,It,er,Dr,tn,mr=(he=he||{}).scope||this;if(typeof w=="number"&&typeof I=="number"&&(typeof ie=="string"||Array.isArray(ie))){var cn=ie;ie=I,I=w,w=cn}if(arguments[3]instanceof Nt==0?(dt=arguments[4],xt=arguments[5],fr(er=arguments[3])==="object"&&er!==null||(typeof dt=="string"&&(xt=dt,dt=null),typeof er=="string"&&(xt=er,er=null),typeof er=="number"&&(dt=er,er=null),he={flags:er,angle:dt,align:xt})):(k("The transform parameter of text() with a Matrix value"),tn=we),isNaN(I)||isNaN(ie)||w==null)throw new Error("Invalid arguments passed to jsPDF.text");if(w.length===0)return mr;var rn,Pn="",us=typeof he.lineHeightFactor=="number"?he.lineHeightFactor:Bo,Ks=mr.internal.scaleFactor;function Kp(wr){return wr=wr.split("	").join(Array(he.TabLen||9).join(" ")),Wt(wr,er)}function y0(wr){for(var _r,Hr=wr.concat(),Gr=[],ps=Hr.length;ps--;)typeof(_r=Hr.shift())=="string"?Gr.push(_r):Array.isArray(wr)&&(_r.length===1||_r[1]===void 0&&_r[2]===void 0)?Gr.push(_r[0]):Gr.push([_r[0],_r[1],_r[2]]);return Gr}function qo(wr,_r){var Hr;if(typeof wr=="string")Hr=_r(wr)[0];else if(Array.isArray(wr)){for(var Gr,ps,Zl=wr.concat(),Ha=[],ju=Zl.length;ju--;)typeof(Gr=Zl.shift())=="string"?Ha.push(_r(Gr)[0]):Array.isArray(Gr)&&typeof Gr[0]=="string"&&(ps=_r(Gr[0],Gr[1],Gr[2]),Ha.push([ps[0],ps[1],ps[2]]));Hr=Ha}return Hr}var xa=!1,_u=!0;if(typeof w=="string")xa=!0;else if(Array.isArray(w)){var ql=w.concat();qe=[];for(var Ys,xn=ql.length;xn--;)(typeof(Ys=ql.shift())!="string"||Array.isArray(Ys)&&typeof Ys[0]!="string")&&(_u=!1);xa=_u}if(xa===!1)throw new Error('Type of text must be string or Array. "'+w+'" is not recognized.');typeof w=="string"&&(w=w.match(/[\r?\n]/)?w.split(/\r\n|\r|\n/g):[w]);var fs=We/mr.internal.scaleFactor,hs=fs*(us-1);switch(he.baseline){case"bottom":ie-=hs;break;case"top":ie+=fs-hs;break;case"hanging":ie+=fs-2*hs;break;case"middle":ie+=fs/2-hs}if((It=he.maxWidth||0)>0&&(typeof w=="string"?w=mr.splitTextToSize(w,It):Object.prototype.toString.call(w)==="[object Array]"&&(w=w.reduce(function(wr,_r){return wr.concat(mr.splitTextToSize(_r,It))},[]))),Ie={text:w,x:I,y:ie,options:he,mutex:{pdfEscape:Wt,activeFontKey:pt,fonts:ht,activeFontSize:We}},$t.publish("preProcessText",Ie),w=Ie.text,dt=(he=Ie.options).angle,tn instanceof Nt==0&&dt&&typeof dt=="number"){dt*=Math.PI/180,he.rotationDirection===0&&(dt=-dt),P===S&&(dt=-dt);var Hl=Math.cos(dt),Nu=Math.sin(dt);tn=new Nt(Hl,Nu,-Nu,Hl,0,0)}else dt&&dt instanceof Nt&&(tn=dt);P!==S||tn||(tn=ma),(jt=he.charSpace||zl)!==void 0&&(Pn+=R(H(jt))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Dr=he.horizontalScale)!==void 0&&(Pn+=R(100*Dr)+` Tz
`),he.lang;var Qn=-1,b0=he.renderingMode!==void 0?he.renderingMode:he.stroke,Gl=mr.internal.getCurrentPageInfo().pageContext;switch(b0){case 0:case!1:case"fill":Qn=0;break;case 1:case!0:case"stroke":Qn=1;break;case 2:case"fillThenStroke":Qn=2;break;case 3:case"invisible":Qn=3;break;case 4:case"fillAndAddForClipping":Qn=4;break;case 5:case"strokeAndAddPathForClipping":Qn=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":Qn=6;break;case 7:case"addToPathForClipping":Qn=7}var w0=Gl.usedRenderingMode!==void 0?Gl.usedRenderingMode:-1;Qn!==-1?Pn+=Qn+` Tr
`:w0!==-1&&(Pn+=`0 Tr
`),Qn!==-1&&(Gl.usedRenderingMode=Qn),xt=he.align||"left";var un,Yi=We*us,Su=mr.internal.pageSize.getWidth(),Au=ht[pt];jt=he.charSpace||zl,It=he.maxWidth||0,er=Object.assign({autoencode:!0,noBOM:!0},he.flags);var Xs=[],Vl=function(wr){return mr.getStringUnitWidth(wr,{font:Au,charSpace:jt,fontSize:We,doKerning:!1})*We/Ks};if(Object.prototype.toString.call(w)==="[object Array]"){var ci;qe=y0(w),xt!=="left"&&(un=qe.map(Vl));var ui,Ho=0;if(xt==="right"){I-=un[0],w=[],xn=qe.length;for(var $a=0;$a<xn;$a++)$a===0?(ui=ls(I),ci=cs(ie)):(ui=H(Ho-un[$a]),ci=-Yi),w.push([qe[$a],ui,ci]),Ho=un[$a]}else if(xt==="center"){I-=un[0]/2,w=[],xn=qe.length;for(var Zs=0;Zs<xn;Zs++)Zs===0?(ui=ls(I),ci=cs(ie)):(ui=H((Ho-un[Zs])/2),ci=-Yi),w.push([qe[Zs],ui,ci]),Ho=un[Zs]}else if(xt==="left"){w=[],xn=qe.length;for(var Eu=0;Eu<xn;Eu++)w.push(qe[Eu])}else if(xt==="justify"&&Au.encoding==="Identity-H"){w=[],xn=qe.length,It=It!==0?It:Su;for(var Js=0,qr=0;qr<xn;qr++)if(ci=qr===0?cs(ie):-Yi,ui=qr===0?ls(I):Js,qr<xn-1){var Yp=H((It-un[qr])/(qe[qr].split(" ").length-1)),za=qe[qr].split(" ");w.push([za[0]+" ",ui,ci]),Js=0;for(var Wa=1;Wa<za.length;Wa++){var Kl=(Vl(za[Wa-1]+" "+za[Wa])-Vl(za[Wa]))*Ks+Yp;Wa==za.length-1?w.push([za[Wa],Kl,0]):w.push([za[Wa]+" ",Kl,0]),Js-=Kl}}else w.push([qe[qr],ui,ci]);w.push(["",Js,0])}else{if(xt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(w=[],xn=qe.length,It=It!==0?It:Su,qr=0;qr<xn;qr++)ci=qr===0?cs(ie):-Yi,ui=qr===0?ls(I):0,qr<xn-1?Xs.push(R(H((It-un[qr])/(qe[qr].split(" ").length-1)))):Xs.push(0),w.push([qe[qr],ui,ci])}}(typeof he.R2L=="boolean"?he.R2L:Pt)===!0&&(w=qo(w,function(wr,_r,Hr){return[wr.split("").reverse().join(""),_r,Hr]})),Ie={text:w,x:I,y:ie,options:he,mutex:{pdfEscape:Wt,activeFontKey:pt,fonts:ht,activeFontSize:We}},$t.publish("postProcessText",Ie),w=Ie.text,rn=Ie.mutex.isHex||!1;var Tu=ht[pt].encoding;Tu!=="WinAnsiEncoding"&&Tu!=="StandardEncoding"||(w=qo(w,function(wr,_r,Hr){return[Kp(wr),_r,Hr]})),qe=y0(w),w=[];for(var Yl,Xl,Go,Vo=Array.isArray(qe[0])?1:0,ds="",Pu=function(wr,_r,Hr){var Gr="";return Hr instanceof Nt?(Hr=typeof he.angle=="number"?pa(Hr,new Nt(1,0,0,1,wr,_r)):pa(new Nt(1,0,0,1,wr,_r),Hr),P===S&&(Hr=pa(new Nt(1,0,0,-1,0,0),Hr)),Gr=Hr.join(" ")+` Tm
`):Gr=R(wr)+" "+R(_r)+` Td
`,Gr},_i=0;_i<qe.length;_i++){switch(ds="",Vo){case 1:Go=(rn?"<":"(")+qe[_i][0]+(rn?">":")"),Yl=parseFloat(qe[_i][1]),Xl=parseFloat(qe[_i][2]);break;case 0:Go=(rn?"<":"(")+qe[_i]+(rn?">":")"),Yl=ls(I),Xl=cs(ie)}Xs!==void 0&&Xs[_i]!==void 0&&(ds=Xs[_i]+` Tw
`),_i===0?w.push(ds+Pu(Yl,Xl,tn)+Go):Vo===0?w.push(ds+Go):Vo===1&&w.push(ds+Pu(Yl,Xl,tn)+Go)}w=Vo===0?w.join(` Tj
T* `):w.join(` Tj
`),w+=` Tj
`;var qa=`BT
/`;return qa+=pt+" "+We+` Tf
`,qa+=R(We*us)+` TL
`,qa+=Uo+`
`,qa+=Pn,qa+=w,Q(qa+="ET"),p[pt]=!0,mr};var Ip=d.__private__.clip=d.clip=function(w){return Q(w==="evenodd"?"W*":"W"),this};d.clipEvenOdd=function(){return Ip("evenodd")},d.__private__.discardPath=d.discardPath=function(){return Q("n"),this};var Ba=d.__private__.isValidStyle=function(w){var I=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(w)!==-1&&(I=!0),I};d.__private__.setDefaultPathOperation=d.setDefaultPathOperation=function(w){return Ba(w)&&(c=w),this};var v0=d.__private__.getStyle=d.getStyle=function(w){var I=c;switch(w){case"D":case"S":I="S";break;case"F":I="f";break;case"FD":case"DF":I="B";break;case"f":case"f*":case"B":case"B*":I=w}return I},x0=d.close=function(){return Q("h"),this};d.stroke=function(){return Q("S"),this},d.fill=function(w){return Gs("f",w),this},d.fillEvenOdd=function(w){return Gs("f*",w),this},d.fillStroke=function(w){return Gs("B",w),this},d.fillStrokeEvenOdd=function(w){return Gs("B*",w),this};var Gs=function(w,I){fr(I)==="object"?Rp(I,w):Q(w)},hu=function(w){w===null||P===S&&w===void 0||(w=v0(w),Q(w))};function Mp(w,I,ie,he,we){var Ie=new pc(I||this.boundingBox,ie||this.xStep,he||this.yStep,this.gState,we||this.matrix);Ie.stream=this.stream;var qe=w+"$$"+this.cloneIndex+++"$$";return $n(qe,Ie),Ie}var Rp=function(w,I){var ie=Ct[w.key],he=ot[ie];if(he instanceof rl)Q("q"),Q(Bp(I)),he.gState&&d.setGState(he.gState),Q(w.matrix.toString()+" cm"),Q("/"+ie+" sh"),Q("Q");else if(he instanceof pc){var we=new Nt(1,0,0,-1,0,wi());w.matrix&&(we=we.multiply(w.matrix||ma),ie=Mp.call(he,w.key,w.boundingBox,w.xStep,w.yStep,we).id),Q("q"),Q("/Pattern cs"),Q("/"+ie+" scn"),he.gState&&d.setGState(he.gState),Q(I),Q("Q")}},Bp=function(w){switch(w){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},du=d.moveTo=function(w,I){return Q(R(H(w))+" "+R(X(I))+" m"),this},Ro=d.lineTo=function(w,I){return Q(R(H(w))+" "+R(X(I))+" l"),this},Vs=d.curveTo=function(w,I,ie,he,we,Ie){return Q([R(H(w)),R(X(I)),R(H(ie)),R(X(he)),R(H(we)),R(X(Ie)),"c"].join(" ")),this};d.__private__.line=d.line=function(w,I,ie,he,we){if(isNaN(w)||isNaN(I)||isNaN(ie)||isNaN(he)||!Ba(we))throw new Error("Invalid arguments passed to jsPDF.line");return P===E?this.lines([[ie-w,he-I]],w,I,[1,1],we||"S"):this.lines([[ie-w,he-I]],w,I,[1,1]).stroke()},d.__private__.lines=d.lines=function(w,I,ie,he,we,Ie){var qe,dt,xt,jt,It,er,Dr,tn,mr,cn,rn,Pn;if(typeof w=="number"&&(Pn=ie,ie=I,I=w,w=Pn),he=he||[1,1],Ie=Ie||!1,isNaN(I)||isNaN(ie)||!Array.isArray(w)||!Array.isArray(he)||!Ba(we)||typeof Ie!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(du(I,ie),qe=he[0],dt=he[1],jt=w.length,cn=I,rn=ie,xt=0;xt<jt;xt++)(It=w[xt]).length===2?(cn=It[0]*qe+cn,rn=It[1]*dt+rn,Ro(cn,rn)):(er=It[0]*qe+cn,Dr=It[1]*dt+rn,tn=It[2]*qe+cn,mr=It[3]*dt+rn,cn=It[4]*qe+cn,rn=It[5]*dt+rn,Vs(er,Dr,tn,mr,cn,rn));return Ie&&x0(),hu(we),this},d.path=function(w){for(var I=0;I<w.length;I++){var ie=w[I],he=ie.c;switch(ie.op){case"m":du(he[0],he[1]);break;case"l":Ro(he[0],he[1]);break;case"c":Vs.apply(this,he);break;case"h":x0()}}return this},d.__private__.rect=d.rect=function(w,I,ie,he,we){if(isNaN(w)||isNaN(I)||isNaN(ie)||isNaN(he)||!Ba(we))throw new Error("Invalid arguments passed to jsPDF.rect");return P===E&&(he=-he),Q([R(H(w)),R(X(I)),R(H(ie)),R(H(he)),"re"].join(" ")),hu(we),this},d.__private__.triangle=d.triangle=function(w,I,ie,he,we,Ie,qe){if(isNaN(w)||isNaN(I)||isNaN(ie)||isNaN(he)||isNaN(we)||isNaN(Ie)||!Ba(qe))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[ie-w,he-I],[we-ie,Ie-he],[w-we,I-Ie]],w,I,[1,1],qe,!0),this},d.__private__.roundedRect=d.roundedRect=function(w,I,ie,he,we,Ie,qe){if(isNaN(w)||isNaN(I)||isNaN(ie)||isNaN(he)||isNaN(we)||isNaN(Ie)||!Ba(qe))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var dt=4/3*(Math.SQRT2-1);return we=Math.min(we,.5*ie),Ie=Math.min(Ie,.5*he),this.lines([[ie-2*we,0],[we*dt,0,we,Ie-Ie*dt,we,Ie],[0,he-2*Ie],[0,Ie*dt,-we*dt,Ie,-we,Ie],[2*we-ie,0],[-we*dt,0,-we,-Ie*dt,-we,-Ie],[0,2*Ie-he],[0,-Ie*dt,we*dt,-Ie,we,-Ie]],w+we,I,[1,1],qe,!0),this},d.__private__.ellipse=d.ellipse=function(w,I,ie,he,we){if(isNaN(w)||isNaN(I)||isNaN(ie)||isNaN(he)||!Ba(we))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Ie=4/3*(Math.SQRT2-1)*ie,qe=4/3*(Math.SQRT2-1)*he;return du(w+ie,I),Vs(w+ie,I-qe,w+Ie,I-he,w,I-he),Vs(w-Ie,I-he,w-ie,I-qe,w-ie,I),Vs(w-ie,I+qe,w-Ie,I+he,w,I+he),Vs(w+Ie,I+he,w+ie,I+qe,w+ie,I),hu(we),this},d.__private__.circle=d.circle=function(w,I,ie,he){if(isNaN(w)||isNaN(I)||isNaN(ie)||!Ba(he))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(w,I,ie,ie,he)},d.setFont=function(w,I,ie){return ie&&(I=C(I,ie)),pt=Hs(w,I,{disableWarning:!1}),this};var Up=d.__private__.getFont=d.getFont=function(){return ht[Hs.apply(d,arguments)]};d.__private__.getFontList=d.getFontList=function(){var w,I,ie={};for(w in je)if(je.hasOwnProperty(w))for(I in ie[w]=[],je[w])je[w].hasOwnProperty(I)&&ie[w].push(I);return ie},d.addFont=function(w,I,ie,he,we){var Ie=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Ie.indexOf(arguments[3])!==-1?we=arguments[3]:arguments[3]&&Ie.indexOf(arguments[3])==-1&&(ie=C(ie,he)),pr.call(this,w,I,ie,we=we||"Identity-H")};var Bo,pu=e.lineWidth||.200025,Ot=d.__private__.getLineWidth=d.getLineWidth=function(){return pu},$p=d.__private__.setLineWidth=d.setLineWidth=function(w){return pu=w,Q(R(H(w))+" w"),this};d.__private__.setLineDash=wt.API.setLineDash=wt.API.setLineDashPattern=function(w,I){if(w=w||[],I=I||0,isNaN(I)||!Array.isArray(w))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return w=w.map(function(ie){return R(H(ie))}).join(" "),I=R(H(I)),Q("["+w+"] "+I+" d"),this};var zp=d.__private__.getLineHeight=d.getLineHeight=function(){return We*Bo};d.__private__.getLineHeight=d.getLineHeight=function(){return We*Bo};var Wp=d.__private__.setLineHeightFactor=d.setLineHeightFactor=function(w){return typeof(w=w||1.15)=="number"&&(Bo=w),this},qp=d.__private__.getLineHeightFactor=d.getLineHeightFactor=function(){return Bo};Wp(e.lineHeight);var ls=d.__private__.getHorizontalCoordinate=function(w){return H(w)},cs=d.__private__.getVerticalCoordinate=function(w){return P===S?w:at[F].mediaBox.topRightY-at[F].mediaBox.bottomLeftY-H(w)},Hp=d.__private__.getHorizontalCoordinateString=d.getHorizontalCoordinateString=function(w){return R(ls(w))},Gp=d.__private__.getVerticalCoordinateString=d.getVerticalCoordinateString=function(w){return R(cs(w))},Ul=e.strokeColor||"0 G";d.__private__.getStrokeColor=d.getDrawColor=function(){return ne(Ul)},d.__private__.setStrokeColor=d.setDrawColor=function(w,I,ie,he){return Ul=se({ch1:w,ch2:I,ch3:ie,ch4:he,pdfColorType:"draw",precision:2}),Q(Ul),this};var mu=e.fillColor||"0 g";d.__private__.getFillColor=d.getFillColor=function(){return ne(mu)},d.__private__.setFillColor=d.setFillColor=function(w,I,ie,he){return mu=se({ch1:w,ch2:I,ch3:ie,ch4:he,pdfColorType:"fill",precision:2}),Q(mu),this};var Uo=e.textColor||"0 g",$l=d.__private__.getTextColor=d.getTextColor=function(){return ne(Uo)};d.__private__.setTextColor=d.setTextColor=function(w,I,ie,he){return Uo=se({ch1:w,ch2:I,ch3:ie,ch4:he,pdfColorType:"text",precision:3}),this};var zl=e.charSpace,Vp=d.__private__.getCharSpace=d.getCharSpace=function(){return parseFloat(zl||0)};d.__private__.setCharSpace=d.setCharSpace=function(w){if(isNaN(w))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return zl=w,this};var gu=0;d.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},d.__private__.setLineCap=d.setLineCap=function(w){var I=d.CapJoinStyles[w];if(I===void 0)throw new Error("Line cap style of '"+w+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return gu=I,Q(I+" J"),this};var vu=0;d.__private__.setLineJoin=d.setLineJoin=function(w){var I=d.CapJoinStyles[w];if(I===void 0)throw new Error("Line join style of '"+w+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return vu=I,Q(I+" j"),this},d.__private__.setLineMiterLimit=d.__private__.setMiterLimit=d.setLineMiterLimit=d.setMiterLimit=function(w){if(w=w||0,isNaN(w))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Q(R(H(w))+" M"),this},d.GState=Ad,d.setGState=function(w){(w=typeof w=="string"?St[ir[w]]:$o(null,w)).equals(ar)||(Q("/"+w.id+" gs"),ar=w)};var $o=function(w,I){if(!w||!ir[w]){var ie=!1;for(var he in St)if(St.hasOwnProperty(he)&&St[he].equals(I)){ie=!0;break}if(ie)I=St[he];else{var we="GS"+(Object.keys(St).length+1).toString(10);St[we]=I,I.id=we}return w&&(ir[w]=I.id),$t.publish("addGState",I),I}};d.addGState=function(w,I){return $o(w,I),this},d.saveGraphicsState=function(){return Q("q"),nt.push({key:pt,size:We,color:Uo}),this},d.restoreGraphicsState=function(){Q("Q");var w=nt.pop();return pt=w.key,We=w.size,Uo=w.color,ar=null,this},d.setCurrentTransformationMatrix=function(w){return Q(w.toString()+" cm"),this},d.comment=function(w){return Q("#"+w),this};var zo=function(w,I){var ie=w||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ie},set:function(Ie){isNaN(Ie)||(ie=parseFloat(Ie))}});var he=I||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return he},set:function(Ie){isNaN(Ie)||(he=parseFloat(Ie))}});var we="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return we},set:function(Ie){we=Ie.toString()}}),this},xu=function(w,I,ie,he){zo.call(this,w,I),this.type="rect";var we=ie||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return we},set:function(qe){isNaN(qe)||(we=parseFloat(qe))}});var Ie=he||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Ie},set:function(qe){isNaN(qe)||(Ie=parseFloat(qe))}}),this},Wl=function(){this.page=zt,this.currentPage=F,this.pages=oe.slice(0),this.pagesContext=at.slice(0),this.x=mt,this.y=Qt,this.matrix=Ut,this.width=bu(F),this.height=wi(F),this.outputDestination=Be,this.id="",this.objectNumber=-1};Wl.prototype.restore=function(){zt=this.page,F=this.currentPage,at=this.pagesContext,oe=this.pages,mt=this.x,Qt=this.y,Ut=this.matrix,wu(F,this.width),Ua(F,this.height),Be=this.outputDestination};var yu=function(w,I,ie,he,we){Vi.push(new Wl),zt=F=0,oe=[],mt=w,Qt=I,Ut=we,Ir([ie,he])};for(var Wo in d.beginFormObject=function(w,I,ie,he,we){return yu(w,I,ie,he,we),this},d.endFormObject=function(w){return function(I){if(da[I])Vi.pop().restore();else{var ie=new Wl,he="Xo"+(Object.keys(Fr).length+1).toString(10);ie.id=he,da[I]=he,Fr[he]=ie,$t.publish("addFormObject",ie),Vi.pop().restore()}}(w),this},d.doFormObject=function(w,I){var ie=Fr[da[w]];return Q("q"),Q(I.toString()+" cm"),Q("/"+ie.id+" Do"),Q("Q"),this},d.getFormObject=function(w){var I=Fr[da[w]];return{x:I.x,y:I.y,width:I.width,height:I.height,matrix:I.matrix}},d.save=function(w,I){return w=w||"generated.pdf",(I=I||{}).returnPromise=I.returnPromise||!1,I.returnPromise===!1?(Jo(Io(os()),w),typeof Jo.unload=="function"&&kt.setTimeout&&setTimeout(Jo.unload,911),this):new Promise(function(ie,he){try{var we=Jo(Io(os()),w);typeof Jo.unload=="function"&&kt.setTimeout&&setTimeout(Jo.unload,911),ie(we)}catch(Ie){he(Ie.message)}})},wt.API)wt.API.hasOwnProperty(Wo)&&(Wo==="events"&&wt.API.events.length?function(w,I){var ie,he,we;for(we=I.length-1;we!==-1;we--)ie=I[we][0],he=I[we][1],w.subscribe.apply(w,[ie].concat(typeof he=="function"?[he]:he))}($t,wt.API.events):d[Wo]=wt.API[Wo]);var bu=d.getPageWidth=function(w){return(at[w=w||F].mediaBox.topRightX-at[w].mediaBox.bottomLeftX)/_t},wu=d.setPageWidth=function(w,I){at[w].mediaBox.topRightX=I*_t+at[w].mediaBox.bottomLeftX},wi=d.getPageHeight=function(w){return(at[w=w||F].mediaBox.topRightY-at[w].mediaBox.bottomLeftY)/_t},Ua=d.setPageHeight=function(w,I){at[w].mediaBox.topRightY=I*_t+at[w].mediaBox.bottomLeftY};return d.internal={pdfEscape:Wt,getStyle:v0,getFont:Up,getFontSize:Ze,getCharSpace:Vp,getTextColor:$l,getLineHeight:zp,getLineHeightFactor:qp,getLineWidth:Ot,write:tt,getHorizontalCoordinate:ls,getVerticalCoordinate:cs,getCoordinateString:Hp,getVerticalCoordinateString:Gp,collections:{},newObject:kr,newAdditionalObject:re,newObjectDeferred:Qr,newObjectDeferredBegin:B,getFilters:Ne,putStream:Ce,events:$t,scaleFactor:_t,pageSize:{getWidth:function(){return bu(F)},setWidth:function(w){wu(F,w)},getHeight:function(){return wi(F)},setHeight:function(w){Ua(F,w)}},encryptionOptions:u,encryption:Wr,getEncryptor:function(w){return u!==null?Wr.encryptor(w,0):function(I){return I}},output:va,getNumberOfPages:Ki,pages:oe,out:Q,f2:_,f3:j,getPageInfo:fu,getPageInfoByObjId:Fp,getCurrentPageInfo:Dp,getPDFVersion:g,Point:zo,Rectangle:xu,Matrix:Nt,hasHotfix:Mo},Object.defineProperty(d.internal.pageSize,"width",{get:function(){return bu(F)},set:function(w){wu(F,w)},enumerable:!0,configurable:!0}),Object.defineProperty(d.internal.pageSize,"height",{get:function(){return wi(F)},set:function(w){Ua(F,w)},enumerable:!0,configurable:!0}),(function(w){for(var I=0,ie=it.length;I<ie;I++){var he=pr.call(this,w[I][0],w[I][1],w[I][2],it[I][3],!0);h===!1&&(p[he]=!0);var we=w[I][0].split("-");Tt({id:he,fontName:we[0],fontStyle:we[1]||""})}$t.publish("addFonts",{fonts:ht,dictionary:je})}).call(d,it),pt="F1",Ma(i,r),$t.publish("initialized"),d}lc.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},lc.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},lc.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},lc.prototype.processOwnerPassword=function(e,t){return Lg(Og(t).substr(0,5),e)},lc.prototype.encryptor=function(e,t){var r=Og(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return Lg(r,n)}},Ad.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||fr(e)!==fr(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},wt.API={events:[]},wt.version="3.0.2";var Br=wt.API,sx=1,Bl=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ac=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},Ft=function(e){return e.toFixed(2)},co=function(e){return e.toFixed(5)};Br.__acroform__={};var bi=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},w_=function(e){return e*sx},Ya=function(e){var t=new lT,r=ut.internal.getHeight(e)||0,n=ut.internal.getWidth(e)||0;return t.BBox=[0,0,Number(Ft(n)),Number(Ft(r))],t},bZ=Br.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},wZ=Br.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},_Z=Br.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},Yr=Br.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return _Z(e,t-1)},Xr=Br.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return bZ(e,t-1)},Zr=Br.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return wZ(e,t-1)},NZ=Br.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,i=e[0],a=e[1],s=e[2],o=e[3],l={};return l.lowerLeft_X=r(i)||0,l.lowerLeft_Y=n(a+o)||0,l.upperRight_X=r(i+s)||0,l.upperRight_Y=n(a)||0,[Number(Ft(l.lowerLeft_X)),Number(Ft(l.lowerLeft_Y)),Number(Ft(l.upperRight_X)),Number(Ft(l.upperRight_Y))]},SZ=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=Fg(e,r),i=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+i+" "+Ft(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var a=Ya(e);return a.scope=e.scope,a.stream=t.join(`
`),a}},Fg=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},i=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");i=e.multiline?i.map(function(_){return _.split(`
`)}):i.map(function(_){return[_]});var a=r,s=ut.internal.getHeight(e)||0;s=s<0?-s:s;var o=ut.internal.getWidth(e)||0;o=o<0?-o:o;var l=function(_,j,H){if(_+1<i.length){var X=j+" "+i[_+1][0];return dh(X,e,H).width<=o-4}return!1};a++;e:for(;a>0;){t="",a--;var c,u,h=dh("3",e,a).height,p=e.multiline?s-a:(s-h)/2,d=p+=2,v=0,g=0,y=0;if(a<=0){t=`(...) Tj
`,t+="% Width of Text: "+dh(t,e,a=12).width+", FieldWidth:"+o+`
`;break}for(var b="",E=0,S=0;S<i.length;S++)if(i.hasOwnProperty(S)){var P=!1;if(i[S].length!==1&&y!==i[S].length-1){if((h+2)*(E+2)+2>s)continue e;b+=i[S][y],P=!0,g=S,S--}else{b=(b+=i[S][y]+" ").substr(b.length-1)==" "?b.substr(0,b.length-1):b;var L=parseInt(S),q=l(L,b,a),C=S>=i.length-1;if(q&&!C){b+=" ",y=0;continue}if(q||C){if(C)g=L;else if(e.multiline&&(h+2)*(E+2)+2>s)continue e}else{if(!e.multiline||(h+2)*(E+2)+2>s)continue e;g=L}}for(var R="",k=v;k<=g;k++){var G=i[k];if(e.multiline){if(k===g){R+=G[y]+" ",y=(y+1)%G.length;continue}if(k===v){R+=G[G.length-1]+" ";continue}}R+=G[0]+" "}switch(R=R.substr(R.length-1)==" "?R.substr(0,R.length-1):R,u=dh(R,e,a).width,e.textAlign){case"right":c=o-u-2;break;case"center":c=(o-u)/2;break;default:c=2}t+=Ft(c)+" "+Ft(d)+` Td
`,t+="("+Bl(R)+`) Tj
`,t+=-Ft(c)+` 0 Td
`,d=-(a+2),u=0,v=P?g:g+1,E++,b=""}break}return n.text=t,n.fontSize=a,n},dh=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),i=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:i}},AZ={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},EZ=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},TZ=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(Da.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(AZ)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");sx=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new cT,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var i in n)if(n.hasOwnProperty(i)){var a=n[i];a.objId=void 0,a.hasAnnotation&&EZ(a,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,i){var a=!n;for(var s in n||(i.internal.newObjectDeferredBegin(i.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),i.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||i.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(s)){var o=n[s],l=[],c=o.Rect;if(o.Rect&&(o.Rect=NZ(o.Rect,i)),i.internal.newObjectDeferredBegin(o.objId,!0),o.DA=ut.createDefaultAppearanceStream(o),fr(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(l=o.getKeyValueListForStream()),o.Rect=c,o.hasAppearanceStream&&!o.appearanceStreamContent){var u=SZ(o);l.push({key:"AP",value:"<</N "+u+">>"}),i.internal.acroformPlugin.xForms.push(u)}if(o.appearanceStreamContent){var h="";for(var p in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(p)){var d=o.appearanceStreamContent[p];if(h+="/"+p+" ",h+="<<",Object.keys(d).length>=1||Array.isArray(d)){for(var s in d)if(d.hasOwnProperty(s)){var v=d[s];typeof v=="function"&&(v=v.call(i,o)),h+="/"+s+" "+v+" ",i.internal.acroformPlugin.xForms.indexOf(v)>=0||i.internal.acroformPlugin.xForms.push(v)}}else typeof(v=d)=="function"&&(v=v.call(i,o)),h+="/"+s+" "+v,i.internal.acroformPlugin.xForms.indexOf(v)>=0||i.internal.acroformPlugin.xForms.push(v);h+=">>"}l.push({key:"AP",value:`<<
`+h+">>"})}i.internal.putStream({additionalKeyValues:l,objectId:o.objId}),i.internal.out("endobj")}a&&function(g,y){for(var b in g)if(g.hasOwnProperty(b)){var E=b,S=g[b];y.internal.newObjectDeferredBegin(S.objId,!0),fr(S)==="object"&&typeof S.putStream=="function"&&S.putStream(),delete g[E]}}(i.internal.acroformPlugin.xForms,i)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},oT=Br.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(s){return s};if(Array.isArray(e)){for(var i="[",a=0;a<e.length;a++)switch(a!==0&&(i+=" "),fr(e[a])){case"boolean":case"number":case"object":i+=e[a].toString();break;case"string":e[a].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),i+="("+Bl(n(e[a].toString()))+")"):i+=e[a].toString()}return i+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},xm=function(e,t,r){var n=function(i){return i};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),"("+Bl(n(e))+")"},Ja=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Ja.prototype.toString=function(){return this.objId+" 0 R"},Ja.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Ja.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(a){return a!="content"&&a!="appearanceStreamContent"&&a!="scope"&&a!="objId"&&a.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],i=this[n];i&&(Array.isArray(i)?e.push({key:n,value:oT(i,this.objId,this.scope)}):i instanceof Ja?(i.scope=this.scope,e.push({key:n,value:i.objId+" 0 R"})):typeof i!="function"&&e.push({key:n,value:i}))}return e};var lT=function(){Ja.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};bi(lT,Ja);var cT=function(){Ja.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+Bl(r(e))+")"}},set:function(r){e=r}})};bi(cT,Ja);var Da=function e(){Ja.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute F supplied.');t=b}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Yr(t,3)},set:function(b){b?this.F=Xr(t,3):this.F=Zr(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(b){if(isNaN(b))throw new Error('Invalid value "'+b+'" for attribute Ff supplied.');r=b}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(b){n=b!==void 0?b:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(b){n[0]=b}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(b){n[1]=b}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(b){n[2]=b}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(b){n[3]=b}});var i="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return i},set:function(b){switch(b){case"/Btn":case"/Tx":case"/Ch":case"/Sig":i=b;break;default:throw new Error('Invalid value "'+b+'" for attribute FT supplied.')}}});var a=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!a||a.length<1){if(this instanceof Ed)return;a="FieldObject"+e.FieldNum++}var b=function(E){return E};return this.scope&&(b=this.scope.internal.getEncryptor(this.objId)),"("+Bl(b(a))+")"},set:function(b){a=b.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return a},set:function(b){a=b}});var s="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return s},set:function(b){s=b}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(b){o=b}});var l=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return l},set:function(b){l=b}});var c=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return c===void 0?50/sx:c},set:function(b){c=b}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(b){u=b}});var h="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!h||this instanceof Ed||this instanceof vl))return xm(h,this.objId,this.scope)},set:function(b){b=b.toString(),h=b}});var p=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(p)return this instanceof wn==0?xm(p,this.objId,this.scope):p},set:function(b){b=b.toString(),p=this instanceof wn==0?b.substr(0,1)==="("?ac(b.substr(1,b.length-2)):ac(b):b}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof wn==1?ac(p.substr(1,p.length-1)):p},set:function(b){b=b.toString(),p=this instanceof wn==1?"/"+b:b}});var d=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(d)return d},set:function(b){this.V=b}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(d)return this instanceof wn==0?xm(d,this.objId,this.scope):d},set:function(b){b=b.toString(),d=this instanceof wn==0?b.substr(0,1)==="("?ac(b.substr(1,b.length-2)):ac(b):b}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof wn==1?ac(d.substr(1,d.length-1)):d},set:function(b){b=b.toString(),d=this instanceof wn==1?"/"+b:b}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var v,g=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return g},set:function(b){b=!!b,g=b}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(v)return v},set:function(b){v=b}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,1)},set:function(b){b?this.Ff=Xr(this.Ff,1):this.Ff=Zr(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,2)},set:function(b){b?this.Ff=Xr(this.Ff,2):this.Ff=Zr(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,3)},set:function(b){b?this.Ff=Xr(this.Ff,3):this.Ff=Zr(this.Ff,3)}});var y=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(y!==null)return y},set:function(b){if([0,1,2].indexOf(b)===-1)throw new Error('Invalid value "'+b+'" for attribute Q supplied.');y=b}}),Object.defineProperty(this,"textAlign",{get:function(){var b;switch(y){case 0:default:b="left";break;case 1:b="center";break;case 2:b="right"}return b},configurable:!0,enumerable:!0,set:function(b){switch(b){case"right":case 2:y=2;break;case"center":case 1:y=1;break;default:y=0}}})};bi(Da,Ja);var Ac=function(){Da.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return oT(t,this.objId,this.scope)},set:function(r){var n,i;i=[],typeof(n=r)=="string"&&(i=function(a,s,o){o||(o=1);for(var l,c=[];l=s.exec(a);)c.push(l[o]);return c}(n,/\((.*?)\)/g)),t=i}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,18)},set:function(r){r?this.Ff=Xr(this.Ff,18):this.Ff=Zr(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Xr(this.Ff,19):this.Ff=Zr(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,20)},set:function(r){r?(this.Ff=Xr(this.Ff,20),t.sort()):this.Ff=Zr(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,22)},set:function(r){r?this.Ff=Xr(this.Ff,22):this.Ff=Zr(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,23)},set:function(r){r?this.Ff=Xr(this.Ff,23):this.Ff=Zr(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,27)},set:function(r){r?this.Ff=Xr(this.Ff,27):this.Ff=Zr(this.Ff,27)}}),this.hasAppearanceStream=!1};bi(Ac,Da);var Ec=function(){Ac.call(this),this.fontName="helvetica",this.combo=!1};bi(Ec,Ac);var Tc=function(){Ec.call(this),this.combo=!0};bi(Tc,Ec);var _h=function(){Tc.call(this),this.edit=!0};bi(_h,Tc);var wn=function(){Da.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,15)},set:function(r){r?this.Ff=Xr(this.Ff,15):this.Ff=Zr(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,16)},set:function(r){r?this.Ff=Xr(this.Ff,16):this.Ff=Zr(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,17)},set:function(r){r?this.Ff=Xr(this.Ff,17):this.Ff=Zr(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,26)},set:function(r){r?this.Ff=Xr(this.Ff,26):this.Ff=Zr(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(a){return a};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,i=[];for(n in i.push("<<"),t)i.push("/"+n+" ("+Bl(r(t[n]))+")");return i.push(">>"),i.join(`
`)}},set:function(r){fr(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};bi(wn,Da);var Nh=function(){wn.call(this),this.pushButton=!0};bi(Nh,wn);var Pc=function(){wn.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};bi(Pc,wn);var Ed=function(){var e,t;Da.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(i){e=i}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(i){t=i}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var i=function(o){return o};this.scope&&(i=this.scope.internal.getEncryptor(this.objId));var a,s=[];for(a in s.push("<<"),n)s.push("/"+a+" ("+Bl(i(n[a]))+")");return s.push(">>"),s.join(`
`)},set:function(i){fr(i)==="object"&&(n=i)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(i){typeof i=="string"&&(n.CA=i)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(i){r=i}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(i){r="/"+i}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=ut.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};bi(Ed,Da),Pc.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},Pc.prototype.createOption=function(e){var t=new Ed;return t.Parent=this,t.optionName=e,this.Kids.push(t),PZ.call(this.scope,t),t};var Sh=function(){wn.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=ut.CheckBox.createAppearanceStream()};bi(Sh,wn);var vl=function(){Da.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,13)},set:function(t){t?this.Ff=Xr(this.Ff,13):this.Ff=Zr(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,21)},set:function(t){t?this.Ff=Xr(this.Ff,21):this.Ff=Zr(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,23)},set:function(t){t?this.Ff=Xr(this.Ff,23):this.Ff=Zr(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,24)},set:function(t){t?this.Ff=Xr(this.Ff,24):this.Ff=Zr(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,25)},set:function(t){t?this.Ff=Xr(this.Ff,25):this.Ff=Zr(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,26)},set:function(t){t?this.Ff=Xr(this.Ff,26):this.Ff=Zr(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};bi(vl,Da);var Ah=function(){vl.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Yr(this.Ff,14)},set:function(e){e?this.Ff=Xr(this.Ff,14):this.Ff=Zr(this.Ff,14)}}),this.password=!0};bi(Ah,vl);var ut={CheckBox:{createAppearanceStream:function(){return{N:{On:ut.CheckBox.YesNormal},D:{On:ut.CheckBox.YesPushDown,Off:ut.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=Ya(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,i=e.scope.__private__.encodeColorString(e.color),a=Fg(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+Ft(ut.internal.getWidth(e))+" "+Ft(ut.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+Ft(a.fontSize)+" Tf "+i),r.push("BT"),r.push(a.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=Ya(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),i=[],a=ut.internal.getHeight(e),s=ut.internal.getWidth(e),o=Fg(e,e.caption);return i.push("1 g"),i.push("0 0 "+Ft(s)+" "+Ft(a)+" re"),i.push("f"),i.push("q"),i.push("0 0 1 rg"),i.push("0 0 "+Ft(s-1)+" "+Ft(a-1)+" re"),i.push("W"),i.push("n"),i.push("0 g"),i.push("BT"),i.push("/"+r+" "+Ft(o.fontSize)+" Tf "+n),i.push(o.text),i.push("ET"),i.push("Q"),t.stream=i.join(`
`),t},OffPushDown:function(e){var t=Ya(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Ft(ut.internal.getWidth(e))+" "+Ft(ut.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:ut.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=ut.RadioButton.Circle.YesNormal,t.D[e]=ut.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=Ya(e);t.scope=e.scope;var r=[],n=ut.internal.getWidth(e)<=ut.internal.getHeight(e)?ut.internal.getWidth(e)/4:ut.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=ut.internal.Bezier_C,a=Number((n*i).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+co(ut.internal.getWidth(e)/2)+" "+co(ut.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+a+" "+a+" "+n+" 0 "+n+" c"),r.push("-"+a+" "+n+" -"+n+" "+a+" -"+n+" 0 c"),r.push("-"+n+" -"+a+" -"+a+" -"+n+" 0 -"+n+" c"),r.push(a+" -"+n+" "+n+" -"+a+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Ya(e);t.scope=e.scope;var r=[],n=ut.internal.getWidth(e)<=ut.internal.getHeight(e)?ut.internal.getWidth(e)/4:ut.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),a=Number((i*ut.internal.Bezier_C).toFixed(5)),s=Number((n*ut.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+co(ut.internal.getWidth(e)/2)+" "+co(ut.internal.getHeight(e)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),r.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),r.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),r.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+co(ut.internal.getWidth(e)/2)+" "+co(ut.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+s+" "+s+" "+n+" 0 "+n+" c"),r.push("-"+s+" "+n+" -"+n+" "+s+" -"+n+" 0 c"),r.push("-"+n+" -"+s+" -"+s+" -"+n+" 0 -"+n+" c"),r.push(s+" -"+n+" "+n+" -"+s+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=Ya(e);t.scope=e.scope;var r=[],n=ut.internal.getWidth(e)<=ut.internal.getHeight(e)?ut.internal.getWidth(e)/4:ut.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var i=Number((2*n).toFixed(5)),a=Number((i*ut.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+co(ut.internal.getWidth(e)/2)+" "+co(ut.internal.getHeight(e)/2)+" cm"),r.push(i+" 0 m"),r.push(i+" "+a+" "+a+" "+i+" 0 "+i+" c"),r.push("-"+a+" "+i+" -"+i+" "+a+" -"+i+" 0 c"),r.push("-"+i+" -"+a+" -"+a+" -"+i+" 0 -"+i+" c"),r.push(a+" -"+i+" "+i+" -"+a+" "+i+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:ut.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=ut.RadioButton.Cross.YesNormal,t.D[e]=ut.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=Ya(e);t.scope=e.scope;var r=[],n=ut.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+Ft(ut.internal.getWidth(e)-2)+" "+Ft(ut.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(Ft(n.x1.x)+" "+Ft(n.x1.y)+" m"),r.push(Ft(n.x2.x)+" "+Ft(n.x2.y)+" l"),r.push(Ft(n.x4.x)+" "+Ft(n.x4.y)+" m"),r.push(Ft(n.x3.x)+" "+Ft(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=Ya(e);t.scope=e.scope;var r=ut.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+Ft(ut.internal.getWidth(e))+" "+Ft(ut.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+Ft(ut.internal.getWidth(e)-2)+" "+Ft(ut.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(Ft(r.x1.x)+" "+Ft(r.x1.y)+" m"),n.push(Ft(r.x2.x)+" "+Ft(r.x2.y)+" l"),n.push(Ft(r.x4.x)+" "+Ft(r.x4.y)+" m"),n.push(Ft(r.x3.x)+" "+Ft(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=Ya(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+Ft(ut.internal.getWidth(e))+" "+Ft(ut.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};ut.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=ut.internal.getWidth(e),r=ut.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},ut.internal.getWidth=function(e){var t=0;return fr(e)==="object"&&(t=w_(e.Rect[2])),t},ut.internal.getHeight=function(e){var t=0;return fr(e)==="object"&&(t=w_(e.Rect[3])),t};var PZ=Br.addField=function(e){if(TZ(this,e),!(e instanceof Da))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};Br.AcroFormChoiceField=Ac,Br.AcroFormListBox=Ec,Br.AcroFormComboBox=Tc,Br.AcroFormEditBox=_h,Br.AcroFormButton=wn,Br.AcroFormPushButton=Nh,Br.AcroFormRadioButton=Pc,Br.AcroFormCheckBox=Sh,Br.AcroFormTextField=vl,Br.AcroFormPasswordField=Ah,Br.AcroFormAppearance=ut,Br.AcroForm={ChoiceField:Ac,ListBox:Ec,ComboBox:Tc,EditBox:_h,Button:wn,PushButton:Nh,RadioButton:Pc,CheckBox:Sh,TextField:vl,PasswordField:Ah,Appearance:ut},wt.AcroForm={ChoiceField:Ac,ListBox:Ec,ComboBox:Tc,EditBox:_h,Button:wn,PushButton:Nh,RadioButton:Pc,CheckBox:Sh,TextField:vl,PasswordField:Ah,Appearance:ut};function uT(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){var t="addImage_";e.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},i=e.__addimage__.getImageFileTypeByImageData=function(_,j){var H,X,ce,pe,ye,me=r;if((j=j||r)==="RGBA"||_.data!==void 0&&_.data instanceof Uint8ClampedArray&&"height"in _&&"width"in _)return"RGBA";if(q(_))for(ye in n)for(ce=n[ye],H=0;H<ce.length;H+=1){for(pe=!0,X=0;X<ce[H].length;X+=1)if(ce[H][X]!==void 0&&ce[H][X]!==_[X]){pe=!1;break}if(pe===!0){me=ye;break}}else for(ye in n)for(ce=n[ye],H=0;H<ce.length;H+=1){for(pe=!0,X=0;X<ce[H].length;X+=1)if(ce[H][X]!==void 0&&ce[H][X]!==_.charCodeAt(X)){pe=!1;break}if(pe===!0){me=ye;break}}return me===r&&j!==r&&(me=j),me},a=function _(j){for(var H=this.internal.write,X=this.internal.putStream,ce=(0,this.internal.getFilters)();ce.indexOf("FlateEncode")!==-1;)ce.splice(ce.indexOf("FlateEncode"),1);j.objectId=this.internal.newObject();var pe=[];if(pe.push({key:"Type",value:"/XObject"}),pe.push({key:"Subtype",value:"/Image"}),pe.push({key:"Width",value:j.width}),pe.push({key:"Height",value:j.height}),j.colorSpace===b.INDEXED?pe.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(j.palette.length/3-1)+" "+("sMask"in j&&j.sMask!==void 0?j.objectId+2:j.objectId+1)+" 0 R]"}):(pe.push({key:"ColorSpace",value:"/"+j.colorSpace}),j.colorSpace===b.DEVICE_CMYK&&pe.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),pe.push({key:"BitsPerComponent",value:j.bitsPerComponent}),"decodeParameters"in j&&j.decodeParameters!==void 0&&pe.push({key:"DecodeParms",value:"<<"+j.decodeParameters+">>"}),"transparency"in j&&Array.isArray(j.transparency)){for(var ye="",me=0,be=j.transparency.length;me<be;me++)ye+=j.transparency[me]+" "+j.transparency[me]+" ";pe.push({key:"Mask",value:"["+ye+"]"})}j.sMask!==void 0&&pe.push({key:"SMask",value:j.objectId+1+" 0 R"});var Ue=j.filter!==void 0?["/"+j.filter]:void 0;if(X({data:j.data,additionalKeyValues:pe,alreadyAppliedFilters:Ue,objectId:j.objectId}),H("endobj"),"sMask"in j&&j.sMask!==void 0){var Fe=(j.predictor!=null?"/Predictor "+j.predictor:"")+" /Colors 1 /BitsPerComponent 8 /Columns "+j.width,A={width:j.width,height:j.height,colorSpace:"DeviceGray",bitsPerComponent:j.bitsPerComponent,decodeParameters:Fe,data:j.sMask};"filter"in j&&(A.filter=j.filter),_.call(this,A)}if(j.colorSpace===b.INDEXED){var F=this.internal.newObject();X({data:R(new Uint8Array(j.palette)),objectId:F}),H("endobj")}},s=function(){var _=this.internal.collections[t+"images"];for(var j in _)a.call(this,_[j])},o=function(){var _,j=this.internal.collections[t+"images"],H=this.internal.write;for(var X in j)H("/I"+(_=j[X]).index,_.objectId,"0","R")},l=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",s),this.internal.events.subscribe("putXobjectDict",o))},c=function(){var _=this.internal.collections[t+"images"];return l.call(this),_},u=function(){return Object.keys(this.internal.collections[t+"images"]).length},h=function(_){return typeof e["process"+_.toUpperCase()]=="function"},p=function(_){return fr(_)==="object"&&_.nodeType===1},d=function(_,j){if(_.nodeName==="IMG"&&_.hasAttribute("src")){var H=""+_.getAttribute("src");if(H.indexOf("data:image/")===0)return wh(unescape(H).split("base64,").pop());var X=e.loadFile(H,!0);if(X!==void 0)return X}if(_.nodeName==="CANVAS"){if(_.width===0||_.height===0)throw new Error("Given canvas must have data. Canvas width: "+_.width+", height: "+_.height);var ce;switch(j){case"PNG":ce="image/png";break;case"WEBP":ce="image/webp";break;default:ce="image/jpeg"}return wh(_.toDataURL(ce,1).split("base64,").pop())}},v=function(_){var j=this.internal.collections[t+"images"];if(j){for(var H in j)if(_===j[H].alias)return j[H]}},g=function(_,j,H){return _||j||(_=-96,j=-96),_<0&&(_=-1*H.width*72/_/this.internal.scaleFactor),j<0&&(j=-1*H.height*72/j/this.internal.scaleFactor),_===0&&(_=j*H.width/H.height),j===0&&(j=_*H.height/H.width),[_,j]},y=function(_,j,H,X,ce,pe){var ye=g.call(this,H,X,ce),me=this.internal.getCoordinateString,be=this.internal.getVerticalCoordinateString,Ue=c.call(this);if(H=ye[0],X=ye[1],Ue[ce.index]=ce,pe){pe*=Math.PI/180;var Fe=Math.cos(pe),A=Math.sin(pe),F=function(M){return M.toFixed(4)},O=[F(Fe),F(A),F(-1*A),F(Fe),0,0,"cm"]}this.internal.write("q"),pe?(this.internal.write([1,"0","0",1,me(_),be(j+X),"cm"].join(" ")),this.internal.write(O.join(" ")),this.internal.write([me(H),"0","0",me(X),"0","0","cm"].join(" "))):this.internal.write([me(H),"0","0",me(X),me(_),be(j+X),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+ce.index+" Do"),this.internal.write("Q")},b=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var E=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},S=e.__addimage__.sHashCode=function(_){var j,H,X=0;if(typeof _=="string")for(H=_.length,j=0;j<H;j++)X=(X<<5)-X+_.charCodeAt(j),X|=0;else if(q(_))for(H=_.byteLength/2,j=0;j<H;j++)X=(X<<5)-X+_[j],X|=0;return X},P=e.__addimage__.validateStringAsBase64=function(_){(_=_||"").toString().trim();var j=!0;return _.length===0&&(j=!1),_.length%4!=0&&(j=!1),/^[A-Za-z0-9+/]+$/.test(_.substr(0,_.length-2))===!1&&(j=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(_.substr(-2))===!1&&(j=!1),j},L=e.__addimage__.extractImageFromDataUrl=function(_){if(_==null||!(_=_.trim()).startsWith("data:"))return null;var j=_.indexOf(",");return j<0?null:_.substring(0,j).trim().endsWith("base64")?_.substring(j+1):null};e.__addimage__.isArrayBuffer=function(_){return _ instanceof ArrayBuffer};var q=e.__addimage__.isArrayBufferView=function(_){return _ instanceof Int8Array||_ instanceof Uint8Array||_ instanceof Uint8ClampedArray||_ instanceof Int16Array||_ instanceof Uint16Array||_ instanceof Int32Array||_ instanceof Uint32Array||_ instanceof Float32Array||_ instanceof Float64Array},C=e.__addimage__.binaryStringToUint8Array=function(_){for(var j=_.length,H=new Uint8Array(j),X=0;X<j;X++)H[X]=_.charCodeAt(X);return H},R=e.__addimage__.arrayBufferToBinaryString=function(_){for(var j="",H=q(_)?_:new Uint8Array(_),X=0;X<H.length;X+=8192)j+=String.fromCharCode.apply(null,H.subarray(X,X+8192));return j};e.addImage=function(){var _,j,H,X,ce,pe,ye,me,be;if(typeof arguments[1]=="number"?(j=r,H=arguments[1],X=arguments[2],ce=arguments[3],pe=arguments[4],ye=arguments[5],me=arguments[6],be=arguments[7]):(j=arguments[1],H=arguments[2],X=arguments[3],ce=arguments[4],pe=arguments[5],ye=arguments[6],me=arguments[7],be=arguments[8]),fr(_=arguments[0])==="object"&&!p(_)&&"imageData"in _){var Ue=_;_=Ue.imageData,j=Ue.format||j||r,H=Ue.x||H||0,X=Ue.y||X||0,ce=Ue.w||Ue.width||ce,pe=Ue.h||Ue.height||pe,ye=Ue.alias||ye,me=Ue.compression||me,be=Ue.rotation||Ue.angle||be}var Fe=this.internal.getFilters();if(me===void 0&&Fe.indexOf("FlateEncode")!==-1&&(me="SLOW"),isNaN(H)||isNaN(X))throw new Error("Invalid coordinates passed to jsPDF.addImage");l.call(this);var A=k.call(this,_,j,ye,me);return y.call(this,H,X,ce,pe,A,be),this};var k=function(_,j,H,X){var ce,pe,ye;if(typeof _=="string"&&i(_)===r){_=unescape(_);var me=G(_,!1);(me!==""||(me=e.loadFile(_,!0))!==void 0)&&(_=me)}if(p(_)&&(_=d(_,j)),j=i(_,j),!h(j))throw new Error("addImage does not support files of type '"+j+"', please ensure that a plugin for '"+j+"' support is added.");if(((ye=H)==null||ye.length===0)&&(H=function(be){return typeof be=="string"||q(be)?S(be):q(be.data)?S(be.data):null}(_)),(ce=v.call(this,H))||(_ instanceof Uint8Array||j==="RGBA"||(pe=_,_=C(_)),ce=this["process"+j.toUpperCase()](_,u.call(this),H,function(be){return be&&typeof be=="string"&&(be=be.toUpperCase()),be in e.image_compression?be:E.NONE}(X),pe)),!ce)throw new Error("An unknown error occurred whilst processing the image.");return ce},G=e.__addimage__.convertBase64ToBinaryString=function(_,j){j=typeof j!="boolean"||j;var H,X="";if(typeof _=="string"){var ce;H=(ce=L(_))!==null&&ce!==void 0?ce:_;try{X=wh(H)}catch(pe){if(j)throw P(H)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+pe.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return X};e.getImageProperties=function(_){var j,H,X="";if(p(_)&&(_=d(_)),typeof _=="string"&&i(_)===r&&((X=G(_,!1))===""&&(X=e.loadFile(_)||""),_=X),H=i(_),!h(H))throw new Error("addImage does not support files of type '"+H+"', please ensure that a plugin for '"+H+"' support is added.");if(_ instanceof Uint8Array||(_=C(_)),!(j=this["process"+H.toUpperCase()](_)))throw new Error("An unknown error occurred whilst processing the image");return j.fileType=H,j}})(wt.API),function(e){var t=function(r){if(r!==void 0&&r!="")return!0};wt.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,i,a,s=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,l=this.internal.getPageInfoByObjId(r.objId),c=r.pageContext.annotations,u=!1,h=0;h<c.length&&!u;h++)switch((n=c[h]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var p=0;p<c.length;p++){n=c[p];var d=this.internal.pdfEscape,v=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var g=this.internal.newAdditionalObject(),y=this.internal.newAdditionalObject(),b=this.internal.getEncryptor(g.objId),E=n.title||"Note";a="<</Type /Annot /Subtype /Text "+(i="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y)+"] ")+"/Contents ("+d(b(n.contents))+")",a+=" /Popup "+y.objId+" 0 R",a+=" /P "+l.objId+" 0 R",a+=" /T ("+d(b(E))+") >>",g.content=a;var S=g.objId+" 0 R";a="<</Type /Annot /Subtype /Popup "+(i="/Rect ["+s(n.bounds.x+30)+" "+o(n.bounds.y+n.bounds.h)+" "+s(n.bounds.x+n.bounds.w+30)+" "+o(n.bounds.y)+"] ")+" /Parent "+S,n.open&&(a+=" /Open true"),a+=" >>",y.content=a,this.internal.write(g.objId,"0 R",y.objId,"0 R");break;case"freetext":i="/Rect ["+s(n.bounds.x)+" "+o(n.bounds.y)+" "+s(n.bounds.x+n.bounds.w)+" "+o(n.bounds.y+n.bounds.h)+"] ";var P=n.color||"#000000";a="<</Type /Annot /Subtype /FreeText "+i+"/Contents ("+d(v(n.contents))+")",a+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+P+")",a+=" /Border [0 0 0]",a+=" >>",this.internal.write(a);break;case"link":if(n.options.name){var L=this.annotations._nameMap[n.options.name];n.options.pageNumber=L.page,n.options.top=L.y}else n.options.top||(n.options.top=0);if(i="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",a="",n.options.url)a="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /A <</S /URI /URI ("+d(v(n.options.url))+") >>";else if(n.options.pageNumber)switch(a="<</Type /Annot /Subtype /Link "+i+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":a+=" /Fit]";break;case"FitH":a+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,a+=" /FitV "+n.options.left+"]";break;default:var q=o(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),a+=" /XYZ "+n.options.left+" "+q+" "+n.options.zoom+"]"}a!=""&&(a+=" >>",this.internal.write(a))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,i,a,s){var o=this.internal.getCurrentPageInfo(),l=this.internal.getCoordinateString,c=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:l(r),y:c(n),w:l(r+i),h:c(n+a)},options:s,type:"link"})},e.textWithLink=function(r,n,i,a){var s,o,l=this.getTextWidth(r),c=this.internal.getLineHeight()/this.internal.scaleFactor;if(a.maxWidth!==void 0){o=a.maxWidth;var u=this.splitTextToSize(r,o).length;s=Math.ceil(c*u)}else o=l,s=c;return this.text(r,n,i,a),i+=.2*c,a.align==="center"&&(n-=l/2),a.align==="right"&&(n-=l),this.link(n,i-c,o,s,a),l},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}}(wt.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},i=[1570,1571,1573,1575];e.__arabicParser__={};var a=e.__arabicParser__.isInArabicSubstitutionA=function(g){return t[g.charCodeAt(0)]!==void 0},s=e.__arabicParser__.isArabicLetter=function(g){return typeof g=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(g)},o=e.__arabicParser__.isArabicEndLetter=function(g){return s(g)&&a(g)&&t[g.charCodeAt(0)].length<=2},l=e.__arabicParser__.isArabicAlfLetter=function(g){return s(g)&&i.indexOf(g.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(g){return s(g)&&a(g)&&t[g.charCodeAt(0)].length>=1};var c=e.__arabicParser__.arabicLetterHasFinalForm=function(g){return s(g)&&a(g)&&t[g.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(g){return s(g)&&a(g)&&t[g.charCodeAt(0)].length>=3};var u=e.__arabicParser__.arabicLetterHasMedialForm=function(g){return s(g)&&a(g)&&t[g.charCodeAt(0)].length==4},h=e.__arabicParser__.resolveLigatures=function(g){var y=0,b=r,E="",S=0;for(y=0;y<g.length;y+=1)b[g.charCodeAt(y)]!==void 0?(S++,typeof(b=b[g.charCodeAt(y)])=="number"&&(E+=String.fromCharCode(b),b=r,S=0),y===g.length-1&&(b=r,E+=g.charAt(y-(S-1)),y-=S-1,S=0)):(b=r,E+=g.charAt(y-S),y-=S,S=0);return E};e.__arabicParser__.isArabicDiacritic=function(g){return g!==void 0&&n[g.charCodeAt(0)]!==void 0};var p=e.__arabicParser__.getCorrectForm=function(g,y,b){return s(g)?a(g)===!1?-1:!c(g)||!s(y)&&!s(b)||!s(b)&&o(y)||o(g)&&!s(y)||o(g)&&l(y)||o(g)&&o(y)?0:u(g)&&s(y)&&!o(y)&&s(b)&&c(b)?3:o(g)||!s(b)?1:2:-1},d=function(g){var y=0,b=0,E=0,S="",P="",L="",q=(g=g||"").split("\\s+"),C=[];for(y=0;y<q.length;y+=1){for(C.push(""),b=0;b<q[y].length;b+=1)S=q[y][b],P=q[y][b-1],L=q[y][b+1],s(S)?(E=p(S,P,L),C[y]+=E!==-1?String.fromCharCode(t[S.charCodeAt(0)][E]):S):C[y]+=S;C[y]=h(C[y])}return C.join(" ")},v=e.__arabicParser__.processArabic=e.processArabic=function(){var g,y=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,b=[];if(Array.isArray(y)){var E=0;for(b=[],E=0;E<y.length;E+=1)Array.isArray(y[E])?b.push([d(y[E][0]),y[E][1],y[E][2]]):b.push([d(y[E])]);g=b}else g=d(y);return typeof arguments[0]=="string"?g:(arguments[0].text=g,arguments[0])};e.events.push(["preProcessText",v])}(wt.API),wt.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(o){r=o}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(o){n=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var i=300;Object.defineProperty(this,"height",{get:function(){return i},set:function(o){i=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=i+1)}});var a=[];Object.defineProperty(this,"childNodes",{get:function(){return a},set:function(o){a=o}});var s={};Object.defineProperty(this,"style",{get:function(){return s},set:function(o){s=o}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var i;if((r=r||"2d")!=="2d")return null;for(i in n)this.pdf.context2d.hasOwnProperty(i)&&(this.pdf.context2d[i]=n[i]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(wt.API),function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),i.call(this))},i=function(){this.internal.__cell__.lastCell=new a,this.internal.__cell__.pages=1},a=function(){var l=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return l},set:function(g){l=g}});var c=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return c},set:function(g){c=g}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(g){u=g}});var h=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return h},set:function(g){h=g}});var p=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return p},set:function(g){p=g}});var d=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return d},set:function(g){d=g}});var v=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return v},set:function(g){v=g}}),this};a.prototype.clone=function(){return new a(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},a.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(l){return n.call(this),this.internal.__cell__.headerFunction=typeof l=="function"?l:void 0,this},e.getTextDimensions=function(l,c){n.call(this);var u=(c=c||{}).fontSize||this.getFontSize(),h=c.font||this.getFont(),p=c.scaleFactor||this.internal.scaleFactor,d=0,v=0,g=0,y=this;if(!Array.isArray(l)&&typeof l!="string"){if(typeof l!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");l=String(l)}var b=c.maxWidth;b>0?typeof l=="string"?l=this.splitTextToSize(l,b):Object.prototype.toString.call(l)==="[object Array]"&&(l=l.reduce(function(S,P){return S.concat(y.splitTextToSize(P,b))},[])):l=Array.isArray(l)?l:[l];for(var E=0;E<l.length;E++)d<(g=this.getStringUnitWidth(l[E],{font:h})*u)&&(d=g);return d!==0&&(v=l.length),{w:d/=p,h:Math.max((v*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/p,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var l=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new a(l.left,l.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var s=e.cell=function(){var l;l=arguments[0]instanceof a?arguments[0]:new a(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),n.call(this);var c=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,h=this.internal.__cell__.margins||t,p=this.internal.__cell__.tableHeaderRow,d=this.internal.__cell__.printHeaders;return c.lineNumber!==void 0&&(c.lineNumber===l.lineNumber?(l.x=(c.x||0)+(c.width||0),l.y=c.y||0):c.y+c.height+l.height+h.bottom>this.getPageHeight()?(this.cellAddPage(),l.y=h.top,d&&p&&(this.printHeaderRow(l.lineNumber,!0),l.y+=p[0].height)):l.y=c.y+c.height||l.y),l.text[0]!==void 0&&(this.rect(l.x,l.y,l.width,l.height,r===!0?"FD":void 0),l.align==="right"?this.text(l.text,l.x+l.width-u,l.y+u,{align:"right",baseline:"top"}):l.align==="center"?this.text(l.text,l.x+l.width/2,l.y+u,{align:"center",baseline:"top",maxWidth:l.width-u-u}):this.text(l.text,l.x+u,l.y+u,{align:"left",baseline:"top",maxWidth:l.width-u-u})),this.internal.__cell__.lastCell=l,this};e.table=function(l,c,u,h,p){if(n.call(this),!u)throw new Error("No data for PDF table.");var d,v,g,y,b=[],E=[],S=[],P={},L={},q=[],C=[],R=(p=p||{}).autoSize||!1,k=p.printHeaders!==!1,G=p.css&&p.css["font-size"]!==void 0?16*p.css["font-size"]:p.fontSize||12,_=p.margins||Object.assign({width:this.getPageWidth()},t),j=typeof p.padding=="number"?p.padding:3,H=p.headerBackgroundColor||"#c8c8c8",X=p.headerTextColor||"#000";if(i.call(this),this.internal.__cell__.printHeaders=k,this.internal.__cell__.margins=_,this.internal.__cell__.table_font_size=G,this.internal.__cell__.padding=j,this.internal.__cell__.headerBackgroundColor=H,this.internal.__cell__.headerTextColor=X,this.setFontSize(G),h==null)E=b=Object.keys(u[0]),S=b.map(function(){return"left"});else if(Array.isArray(h)&&fr(h[0])==="object")for(b=h.map(function(Ue){return Ue.name}),E=h.map(function(Ue){return Ue.prompt||Ue.name||""}),S=h.map(function(Ue){return Ue.align||"left"}),d=0;d<h.length;d+=1)L[h[d].name]=.7499990551181103*h[d].width;else Array.isArray(h)&&typeof h[0]=="string"&&(E=b=h,S=b.map(function(){return"left"}));if(R||Array.isArray(h)&&typeof h[0]=="string")for(d=0;d<b.length;d+=1){for(P[y=b[d]]=u.map(function(Ue){return Ue[y]}),this.setFont(void 0,"bold"),q.push(this.getTextDimensions(E[d],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),v=P[y],this.setFont(void 0,"normal"),g=0;g<v.length;g+=1)q.push(this.getTextDimensions(v[g],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);L[y]=Math.max.apply(null,q)+j+j,q=[]}if(k){var ce={};for(d=0;d<b.length;d+=1)ce[b[d]]={},ce[b[d]].text=E[d],ce[b[d]].align=S[d];var pe=o.call(this,ce,L);C=b.map(function(Ue){return new a(l,c,L[Ue],pe,ce[Ue].text,void 0,ce[Ue].align)}),this.setTableHeaderRow(C),this.printHeaderRow(1,!1)}var ye=h.reduce(function(Ue,Fe){return Ue[Fe.name]=Fe.align,Ue},{});for(d=0;d<u.length;d+=1){"rowStart"in p&&p.rowStart instanceof Function&&p.rowStart({row:d,data:u[d]},this);var me=o.call(this,u[d],L);for(g=0;g<b.length;g+=1){var be=u[d][b[g]];"cellStart"in p&&p.cellStart instanceof Function&&p.cellStart({row:d,col:g,data:be},this),s.call(this,new a(l,c,L[b[g]],me,be,d+2,ye[b[g]]))}}return this.internal.__cell__.table_x=l,this.internal.__cell__.table_y=c,this};var o=function(l,c){var u=this.internal.__cell__.padding,h=this.internal.__cell__.table_font_size,p=this.internal.scaleFactor;return Object.keys(l).map(function(d){var v=l[d];return this.splitTextToSize(v.hasOwnProperty("text")?v.text:v,c[d]-u-u)},this).map(function(d){return this.getLineHeightFactor()*d.length*h/p+u+u},this).reduce(function(d,v){return Math.max(d,v)},0)};e.setTableHeaderRow=function(l){n.call(this),this.internal.__cell__.tableHeaderRow=l},e.printHeaderRow=function(l,c){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var h=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new a(h[0],h[1],h[2],h[3],void 0,-1)}this.setFont(void 0,"bold");for(var p=[],d=0;d<this.internal.__cell__.tableHeaderRow.length;d+=1){u=this.internal.__cell__.tableHeaderRow[d].clone(),c&&(u.y=this.internal.__cell__.margins.top||0,p.push(u)),u.lineNumber=l;var v=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),s.call(this,u),this.setTextColor(v)}p.length>0&&this.setTableHeaderRow(p),this.setFont(void 0,"normal"),r=!1}}(wt.API);var fT={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},hT=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Dg=uT(hT),dT=[100,200,300,400,500,600,700,800,900],jZ=uT(dT);function ym(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=function(a){return fT[a=a||"normal"]?a:"normal"}(e.style),n=function(a){return a?typeof a=="number"?a>=100&&a<=900&&a%100==0?a:400:/^\d00$/.test(a)?parseInt(a):a==="bold"?700:400:400}(e.weight),i=function(a){return typeof Dg[a=a||"normal"]=="number"?a:"normal"}(e.stretch);return{family:t,style:r,weight:n,stretch:i,src:e.src||[],ref:e.ref||{name:t,style:[i,r,n].join(" ")}}}function __(e,t,r,n){var i;for(i=r;i>=0&&i<t.length;i+=n)if(e[t[i]])return e[t[i]];for(i=r;i>=0&&i<t.length;i-=n)if(e[t[i]])return e[t[i]]}var kZ={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},N_={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function S_(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function A_(e){return e.trimLeft()}function CZ(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function OZ(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var ph,E_,T_,sc,mh,P_,j_,k_,bm=["times"];function C_(e,t,r,n){var i=4,a=L_;switch(n){case wt.API.image_compression.FAST:i=1,a=O_;break;case wt.API.image_compression.MEDIUM:i=6,a=F_;break;case wt.API.image_compression.SLOW:i=9,a=D_}e=function(o,l,c,u){for(var h,p=o.length/l,d=new Uint8Array(o.length+p),v=[LZ,O_,L_,F_,D_],g=0;g<p;g+=1){var y=g*l,b=o.subarray(y,y+l);if(u)d.set(u(b,c,h),y+g);else{for(var E=v.length,S=[],P=0;P<E;P+=1)S[P]=v[P](b,c,h);var L=DZ(S.concat());d.set(S[L],y+g)}h=b}return d}(e,t,r,a);var s=_g(e,{level:i});return wt.API.__addimage__.arrayBufferToBinaryString(s)}function LZ(e){var t=Array.apply([],e);return t.unshift(0),t}function O_(e,t){var r=e.length,n=[];n[0]=1;for(var i=0;i<r;i+=1){var a=e[i-t]||0;n[i+1]=e[i]-a+256&255}return n}function L_(e,t,r){var n=e.length,i=[];i[0]=2;for(var a=0;a<n;a+=1){var s=r&&r[a]||0;i[a+1]=e[a]-s+256&255}return i}function F_(e,t,r){var n=e.length,i=[];i[0]=3;for(var a=0;a<n;a+=1){var s=e[a-t]||0,o=r&&r[a]||0;i[a+1]=e[a]+256-(s+o>>>1)&255}return i}function D_(e,t,r){var n=e.length,i=[];i[0]=4;for(var a=0;a<n;a+=1){var s=FZ(e[a-t]||0,r&&r[a]||0,r&&r[a-t]||0);i[a+1]=e[a]-s+256&255}return i}function FZ(e,t,r){if(e===t&&t===r)return e;var n=Math.abs(t-r),i=Math.abs(e-r),a=Math.abs(e+t-r-r);return n<=i&&n<=a?e:i<=a?t:r}function DZ(e){var t=e.map(function(r){return r.reduce(function(n,i){return n+Math.abs(i)},0)});return t.indexOf(Math.min.apply(null,t))}function wm(e,t,r){var n=t*r,i=Math.floor(n/8),a=16-(n-8*i+r),s=(1<<r)-1;return pT(e,i)>>a&s}function I_(e,t,r,n){var i=r*n,a=Math.floor(i/8),s=16-(i-8*a+n),o=(1<<n)-1,l=(t&o)<<s;(function(c,u,h){if(u+1<c.byteLength)c.setUint16(u,h,!1);else{var p=h>>8&255;c.setUint8(u,p)}})(e,a,pT(e,a)&~(o<<s)&65535|l)}function pT(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function IZ(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,i=e[t++],a=i>>7,s=1<<1+(7&i);e[t++],e[t++];var o=null,l=null;a&&(o=t,l=s,t+=3*s);var c=!0,u=[],h=0,p=null,d=0,v=null;for(this.width=r,this.height=n;c&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,v=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((_=e[t++])>=0))throw Error("Invalid block size");if(_===0)break;t+=_}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var g=e[t++];h=e[t++]|e[t++]<<8,p=e[t++],1&g||(p=null),d=g>>2&7,t++;break;case 254:for(;;){if(!((_=e[t++])>=0))throw Error("Invalid block size");if(_===0)break;t+=_}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var y=e[t++]|e[t++]<<8,b=e[t++]|e[t++]<<8,E=e[t++]|e[t++]<<8,S=e[t++]|e[t++]<<8,P=e[t++],L=P>>6&1,q=1<<1+(7&P),C=o,R=l,k=!1;P>>7&&(k=!0,C=t,R=q,t+=3*q);var G=t;for(t++;;){var _;if(!((_=e[t++])>=0))throw Error("Invalid block size");if(_===0)break;t+=_}u.push({x:y,y:b,width:E,height:S,has_local_palette:k,palette_offset:C,palette_size:R,data_offset:G,data_length:t-G,transparent_index:p,interlaced:!!L,delay:h,disposal:d});break;case 59:c=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return v},this.frameInfo=function(j){if(j<0||j>=u.length)throw new Error("Frame index out of range.");return u[j]},this.decodeAndBlitFrameBGRA=function(j,H){var X=this.frameInfo(j),ce=X.width*X.height,pe=new Uint8Array(ce);M_(e,X.data_offset,pe,ce);var ye=X.palette_offset,me=X.transparent_index;me===null&&(me=256);var be=X.width,Ue=r-be,Fe=be,A=4*(X.y*r+X.x),F=4*((X.y+X.height)*r+X.x),O=A,M=4*Ue;X.interlaced===!0&&(M+=4*r*7);for(var J=8,fe=0,ve=pe.length;fe<ve;++fe){var ae=pe[fe];if(Fe===0&&(Fe=be,(O+=M)>=F&&(M=4*Ue+4*r*(J-1),O=A+(be+Ue)*(J<<1),J>>=1)),ae===me)O+=4;else{var ue=e[ye+3*ae],oe=e[ye+3*ae+1],le=e[ye+3*ae+2];H[O++]=le,H[O++]=oe,H[O++]=ue,H[O++]=255}--Fe}},this.decodeAndBlitFrameRGBA=function(j,H){var X=this.frameInfo(j),ce=X.width*X.height,pe=new Uint8Array(ce);M_(e,X.data_offset,pe,ce);var ye=X.palette_offset,me=X.transparent_index;me===null&&(me=256);var be=X.width,Ue=r-be,Fe=be,A=4*(X.y*r+X.x),F=4*((X.y+X.height)*r+X.x),O=A,M=4*Ue;X.interlaced===!0&&(M+=4*r*7);for(var J=8,fe=0,ve=pe.length;fe<ve;++fe){var ae=pe[fe];if(Fe===0&&(Fe=be,(O+=M)>=F&&(M=4*Ue+4*r*(J-1),O=A+(be+Ue)*(J<<1),J>>=1)),ae===me)O+=4;else{var ue=e[ye+3*ae],oe=e[ye+3*ae+1],le=e[ye+3*ae+2];H[O++]=ue,H[O++]=oe,H[O++]=le,H[O++]=255}--Fe}}}function M_(e,t,r,n){for(var i=e[t++],a=1<<i,s=a+1,o=s+1,l=i+1,c=(1<<l)-1,u=0,h=0,p=0,d=e[t++],v=new Int32Array(4096),g=null;;){for(;u<16&&d!==0;)h|=e[t++]<<u,u+=8,d===1?d=e[t++]:--d;if(u<l)break;var y=h&c;if(h>>=l,u-=l,y!==a){if(y===s)break;for(var b=y<o?y:g,E=0,S=b;S>a;)S=v[S]>>8,++E;var P=S;if(p+E+(b!==y?1:0)>n)return void xr.log("Warning, gif stream longer than expected.");r[p++]=P;var L=p+=E;for(b!==y&&(r[p++]=P),S=b;E--;)S=v[S],r[--L]=255&S,S>>=8;g!==null&&o<4096&&(v[o++]=g<<8|P,o>=c+1&&l<12&&(++l,c=c<<1|1)),g=y}else o=s+1,c=(1<<(l=i+1))-1,g=null}return p!==n&&xr.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function _m(e){var t,r,n,i,a,s=Math.floor,o=new Array(64),l=new Array(64),c=new Array(64),u=new Array(64),h=new Array(65535),p=new Array(65535),d=new Array(64),v=new Array(64),g=[],y=0,b=7,E=new Array(64),S=new Array(64),P=new Array(64),L=new Array(256),q=new Array(2048),C=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],R=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],k=[0,1,2,3,4,5,6,7,8,9,10,11],G=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],_=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],j=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],H=[0,1,2,3,4,5,6,7,8,9,10,11],X=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],ce=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function pe(A,F){for(var O=0,M=0,J=new Array,fe=1;fe<=16;fe++){for(var ve=1;ve<=A[fe];ve++)J[F[M]]=[],J[F[M]][0]=O,J[F[M]][1]=fe,M++,O++;O*=2}return J}function ye(A){for(var F=A[0],O=A[1]-1;O>=0;)F&1<<O&&(y|=1<<b),O--,--b<0&&(y==255?(me(255),me(0)):me(y),b=7,y=0)}function me(A){g.push(A)}function be(A){me(A>>8&255),me(255&A)}function Ue(A,F,O,M,J){for(var fe,ve=J[0],ae=J[240],ue=function(We,st){var Ze,Pt,ft,Lt,At,Et,Kt,yt,pt,_t,mt=0;for(pt=0;pt<8;++pt){Ze=We[mt],Pt=We[mt+1],ft=We[mt+2],Lt=We[mt+3],At=We[mt+4],Et=We[mt+5],Kt=We[mt+6];var Qt=Ze+(yt=We[mt+7]),Ut=Ze-yt,ht=Pt+Kt,je=Pt-Kt,nt=ft+Et,ot=ft-Et,Ct=Lt+At,St=Lt-At,ir=Qt+Ct,ar=Qt-Ct,zt=ht+nt,at=ht-nt;We[mt]=ir+zt,We[mt+4]=ir-zt;var $t=.707106781*(at+ar);We[mt+2]=ar+$t,We[mt+6]=ar-$t;var Tn=.382683433*((ir=St+ot)-(at=je+Ut)),Fr=.5411961*ir+Tn,da=1.306562965*at+Tn,Vi=.707106781*(zt=ot+je),Nt=Ut+Vi,pa=Ut-Vi;We[mt+5]=pa+Fr,We[mt+3]=pa-Fr,We[mt+1]=Nt+da,We[mt+7]=Nt-da,mt+=8}for(mt=0,pt=0;pt<8;++pt){Ze=We[mt],Pt=We[mt+8],ft=We[mt+16],Lt=We[mt+24],At=We[mt+32],Et=We[mt+40],Kt=We[mt+48];var ma=Ze+(yt=We[mt+56]),$n=Ze-yt,li=Pt+Kt,kr=Pt-Kt,Qr=ft+Et,B=ft-Et,re=Lt+At,K=Lt-At,Z=ma+re,ne=ma-re,se=li+Qr,Ne=li-Qr;We[mt]=Z+se,We[mt+32]=Z-se;var Ce=.707106781*(Ne+ne);We[mt+16]=ne+Ce,We[mt+48]=ne-Ce;var Se=.382683433*((Z=K+B)-(Ne=kr+$n)),Ae=.5411961*Z+Se,Pe=1.306562965*Ne+Se,He=.707106781*(se=B+kr),Ke=$n+He,rt=$n-He;We[mt+40]=rt+Ae,We[mt+24]=rt-Ae,We[mt+8]=Ke+Pe,We[mt+56]=Ke-Pe,mt++}for(pt=0;pt<64;++pt)_t=We[pt]*st[pt],d[pt]=_t>0?_t+.5|0:_t-.5|0;return d}(A,F),oe=0;oe<64;++oe)v[C[oe]]=ue[oe];var le=v[0]-O;O=v[0],le==0?ye(M[0]):(ye(M[p[fe=32767+le]]),ye(h[fe]));for(var Be=63;Be>0&&v[Be]==0;)Be--;if(Be==0)return ye(ve),O;for(var ge,Q=1;Q<=Be;){for(var tt=Q;v[Q]==0&&Q<=Be;)++Q;var Re=Q-tt;if(Re>=16){ge=Re>>4;for(var it=1;it<=ge;++it)ye(ae);Re&=15}fe=32767+v[Q],ye(J[(Re<<4)+p[fe]]),ye(h[fe]),Q++}return Be!=63&&ye(ve),O}function Fe(A){A=Math.min(Math.max(A,1),100),a!=A&&(function(F){for(var O=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],M=0;M<64;M++){var J=s((O[M]*F+50)/100);J=Math.min(Math.max(J,1),255),o[C[M]]=J}for(var fe=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ve=0;ve<64;ve++){var ae=s((fe[ve]*F+50)/100);ae=Math.min(Math.max(ae,1),255),l[C[ve]]=ae}for(var ue=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],oe=0,le=0;le<8;le++)for(var Be=0;Be<8;Be++)c[oe]=1/(o[C[oe]]*ue[le]*ue[Be]*8),u[oe]=1/(l[C[oe]]*ue[le]*ue[Be]*8),oe++}(A<50?Math.floor(5e3/A):Math.floor(200-2*A)),a=A)}this.encode=function(A,F){F&&Fe(F),g=new Array,y=0,b=7,be(65496),be(65504),be(16),me(74),me(70),me(73),me(70),me(0),me(1),me(1),me(0),be(1),be(1),me(0),me(0),function(){be(65499),be(132),me(0);for(var Pt=0;Pt<64;Pt++)me(o[Pt]);me(1);for(var ft=0;ft<64;ft++)me(l[ft])}(),function(Pt,ft){be(65472),be(17),me(8),be(ft),be(Pt),me(3),me(1),me(17),me(0),me(2),me(17),me(1),me(3),me(17),me(1)}(A.width,A.height),function(){be(65476),be(418),me(0);for(var Pt=0;Pt<16;Pt++)me(R[Pt+1]);for(var ft=0;ft<=11;ft++)me(k[ft]);me(16);for(var Lt=0;Lt<16;Lt++)me(G[Lt+1]);for(var At=0;At<=161;At++)me(_[At]);me(1);for(var Et=0;Et<16;Et++)me(j[Et+1]);for(var Kt=0;Kt<=11;Kt++)me(H[Kt]);me(17);for(var yt=0;yt<16;yt++)me(X[yt+1]);for(var pt=0;pt<=161;pt++)me(ce[pt])}(),be(65498),be(12),me(3),me(1),me(0),me(2),me(17),me(3),me(17),me(0),me(63),me(0);var O=0,M=0,J=0;y=0,b=7,this.encode.displayName="_encode_";for(var fe,ve,ae,ue,oe,le,Be,ge,Q,tt=A.data,Re=A.width,it=A.height,We=4*Re,st=0;st<it;){for(fe=0;fe<We;){for(oe=We*st+fe,Be=-1,ge=0,Q=0;Q<64;Q++)le=oe+(ge=Q>>3)*We+(Be=4*(7&Q)),st+ge>=it&&(le-=We*(st+1+ge-it)),fe+Be>=We&&(le-=fe+Be-We+4),ve=tt[le++],ae=tt[le++],ue=tt[le++],E[Q]=(q[ve]+q[ae+256|0]+q[ue+512|0]>>16)-128,S[Q]=(q[ve+768|0]+q[ae+1024|0]+q[ue+1280|0]>>16)-128,P[Q]=(q[ve+1280|0]+q[ae+1536|0]+q[ue+1792|0]>>16)-128;O=Ue(E,c,O,t,n),M=Ue(S,u,M,r,i),J=Ue(P,u,J,r,i),fe+=32}st+=8}if(b>=0){var Ze=[];Ze[1]=b+1,Ze[0]=(1<<b+1)-1,ye(Ze)}return be(65497),new Uint8Array(g)},e=e||50,function(){for(var A=String.fromCharCode,F=0;F<256;F++)L[F]=A(F)}(),t=pe(R,k),r=pe(j,H),n=pe(G,_),i=pe(X,ce),function(){for(var A=1,F=2,O=1;O<=15;O++){for(var M=A;M<F;M++)p[32767+M]=O,h[32767+M]=[],h[32767+M][1]=O,h[32767+M][0]=M;for(var J=-(F-1);J<=-A;J++)p[32767+J]=O,h[32767+J]=[],h[32767+J][1]=O,h[32767+J][0]=F-1+J;A<<=1,F<<=1}}(),function(){for(var A=0;A<256;A++)q[A]=19595*A,q[A+256|0]=38470*A,q[A+512|0]=7471*A+32768,q[A+768|0]=-11059*A,q[A+1024|0]=-21709*A,q[A+1280|0]=32768*A+8421375,q[A+1536|0]=-27439*A,q[A+1792|0]=-5329*A}(),Fe(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Sa(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function R_(e){function t(k){if(!k)throw Error("assert :P")}function r(k,G,_){for(var j=0;4>j;j++)if(k[G+j]!=_.charCodeAt(j))return!0;return!1}function n(k,G,_,j,H){for(var X=0;X<H;X++)k[G+X]=_[j+X]}function i(k,G,_,j){for(var H=0;H<j;H++)k[G+H]=_}function a(k){return new Int32Array(k)}function s(k,G){for(var _=[],j=0;j<k;j++)_.push(new G);return _}function o(k,G){var _=[];return function j(H,X,ce){for(var pe=ce[X],ye=0;ye<pe&&(H.push(ce.length>X+1?[]:new G),!(ce.length<X+1));ye++)j(H[ye],X+1,ce)}(_,0,k),_}var l=function(){var k=this;function G(m,x){for(var N=1<<x-1>>>0;m&N;)N>>>=1;return N?(m&N-1)+N:m}function _(m,x,N,T,D){t(!(T%N));do m[x+(T-=N)]=D;while(0<T)}function j(m,x,N,T,D){if(t(2328>=D),512>=D)var U=a(512);else if((U=a(D))==null)return 0;return function(W,V,Y,ee,de,Te){var te,xe,_e=V,Le=1<<Y,Ee=a(16),De=a(16);for(t(de!=0),t(ee!=null),t(W!=null),t(0<Y),xe=0;xe<de;++xe){if(15<ee[xe])return 0;++Ee[ee[xe]]}if(Ee[0]==de)return 0;for(De[1]=0,te=1;15>te;++te){if(Ee[te]>1<<te)return 0;De[te+1]=De[te]+Ee[te]}for(xe=0;xe<de;++xe)te=ee[xe],0<ee[xe]&&(Te[De[te]++]=xe);if(De[15]==1)return(ee=new H).g=0,ee.value=Te[0],_(W,_e,1,Le,ee),Le;var Me,Ge=-1,ze=Le-1,bt=0,ct=1,Mt=1,gt=1<<Y;for(xe=0,te=1,de=2;te<=Y;++te,de<<=1){if(ct+=Mt<<=1,0>(Mt-=Ee[te]))return 0;for(;0<Ee[te];--Ee[te])(ee=new H).g=te,ee.value=Te[xe++],_(W,_e+bt,de,gt,ee),bt=G(bt,te)}for(te=Y+1,de=2;15>=te;++te,de<<=1){if(ct+=Mt<<=1,0>(Mt-=Ee[te]))return 0;for(;0<Ee[te];--Ee[te]){if(ee=new H,(bt&ze)!=Ge){for(_e+=gt,Me=1<<(Ge=te)-Y;15>Ge&&!(0>=(Me-=Ee[Ge]));)++Ge,Me<<=1;Le+=gt=1<<(Me=Ge-Y),W[V+(Ge=bt&ze)].g=Me+Y,W[V+Ge].value=_e-V-Ge}ee.g=te-Y,ee.value=Te[xe++],_(W,_e+(bt>>Y),de,gt,ee),bt=G(bt,te)}}return ct!=2*De[15]-1?0:Le}(m,x,N,T,D,U)}function H(){this.value=this.g=0}function X(){this.value=this.g=0}function ce(){this.G=s(5,H),this.H=a(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=s($a,X)}function pe(m,x,N,T){t(m!=null),t(x!=null),t(2147483648>T),m.Ca=254,m.I=0,m.b=-8,m.Ka=0,m.oa=x,m.pa=N,m.Jd=x,m.Yc=N+T,m.Zc=4<=T?N+T-4+1:N,ve(m)}function ye(m,x){for(var N=0;0<x--;)N|=ue(m,128)<<x;return N}function me(m,x){var N=ye(m,x);return ae(m)?-N:N}function be(m,x,N,T){var D,U=0;for(t(m!=null),t(x!=null),t(4294967288>T),m.Sb=T,m.Ra=0,m.u=0,m.h=0,4<T&&(T=4),D=0;D<T;++D)U+=x[N+D]<<8*D;m.Ra=U,m.bb=T,m.oa=x,m.pa=N}function Ue(m){for(;8<=m.u&&m.bb<m.Sb;)m.Ra>>>=8,m.Ra+=m.oa[m.pa+m.bb]<<Js-8>>>0,++m.bb,m.u-=8;M(m)&&(m.h=1,m.u=0)}function Fe(m,x){if(t(0<=x),!m.h&&x<=Eu){var N=O(m)&Zs[x];return m.u+=x,Ue(m),N}return m.h=1,m.u=0}function A(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function F(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function O(m){return m.Ra>>>(m.u&Js-1)>>>0}function M(m){return t(m.bb<=m.Sb),m.h||m.bb==m.Sb&&m.u>Js}function J(m,x){m.u=x,m.h=M(m)}function fe(m){m.u>=qr&&(t(m.u>=qr),Ue(m))}function ve(m){t(m!=null&&m.oa!=null),m.pa<m.Zc?(m.I=(m.oa[m.pa++]|m.I<<8)>>>0,m.b+=8):(t(m!=null&&m.oa!=null),m.pa<m.Yc?(m.b+=8,m.I=m.oa[m.pa++]|m.I<<8):m.Ka?m.b=0:(m.I<<=8,m.b+=8,m.Ka=1))}function ae(m){return ye(m,1)}function ue(m,x){var N=m.Ca;0>m.b&&ve(m);var T=m.b,D=N*x>>>8,U=(m.I>>>T>D)+0;for(U?(N-=D,m.I-=D+1<<T>>>0):N=D+1,T=N,D=0;256<=T;)D+=8,T>>=8;return T=7^D+Yp[T],m.b-=T,m.Ca=(N<<T)-1,U}function oe(m,x,N){m[x+0]=N>>24&255,m[x+1]=N>>16&255,m[x+2]=N>>8&255,m[x+3]=255&N}function le(m,x){return m[x+0]|m[x+1]<<8}function Be(m,x){return le(m,x)|m[x+2]<<16}function ge(m,x){return le(m,x)|le(m,x+2)<<16}function Q(m,x){var N=1<<x;return t(m!=null),t(0<x),m.X=a(N),m.X==null?0:(m.Mb=32-x,m.Xa=x,1)}function tt(m,x){t(m!=null),t(x!=null),t(m.Xa==x.Xa),n(x.X,0,m.X,0,1<<x.Xa)}function Re(){this.X=[],this.Xa=this.Mb=0}function it(m,x,N,T){t(N!=null),t(T!=null);var D=N[0],U=T[0];return D==0&&(D=(m*U+x/2)/x),U==0&&(U=(x*D+m/2)/m),0>=D||0>=U?0:(N[0]=D,T[0]=U,1)}function We(m,x){return m+(1<<x)-1>>>x}function st(m,x){return((4278255360&m)+(4278255360&x)>>>0&4278255360)+((16711935&m)+(16711935&x)>>>0&16711935)>>>0}function Ze(m,x){k[x]=function(N,T,D,U,W,V,Y){var ee;for(ee=0;ee<W;++ee){var de=k[m](V[Y+ee-1],D,U+ee);V[Y+ee]=st(N[T+ee],de)}}}function Pt(){this.ud=this.hd=this.jd=0}function ft(m,x){return((4278124286&(m^x))>>>1)+(m&x)>>>0}function Lt(m){return 0<=m&&256>m?m:0>m?0:255<m?255:void 0}function At(m,x){return Lt(m+(m-x+.5>>1))}function Et(m,x,N){return Math.abs(x-N)-Math.abs(m-N)}function Kt(m,x,N,T,D,U,W){for(T=U[W-1],N=0;N<D;++N)U[W+N]=T=st(m[x+N],T)}function yt(m,x,N,T,D){var U;for(U=0;U<N;++U){var W=m[x+U],V=W>>8&255,Y=16711935&(Y=(Y=16711935&W)+((V<<16)+V));T[D+U]=(4278255360&W)+Y>>>0}}function pt(m,x){x.jd=255&m,x.hd=m>>8&255,x.ud=m>>16&255}function _t(m,x,N,T,D,U){var W;for(W=0;W<T;++W){var V=x[N+W],Y=V>>>8,ee=V,de=255&(de=(de=V>>>16)+((m.jd<<24>>24)*(Y<<24>>24)>>>5));ee=255&(ee=(ee+=(m.hd<<24>>24)*(Y<<24>>24)>>>5)+((m.ud<<24>>24)*(de<<24>>24)>>>5)),D[U+W]=(4278255360&V)+(de<<16)+ee}}function mt(m,x,N,T,D){k[x]=function(U,W,V,Y,ee,de,Te,te,xe){for(Y=Te;Y<te;++Y)for(Te=0;Te<xe;++Te)ee[de++]=D(V[T(U[W++])])},k[m]=function(U,W,V,Y,ee,de,Te){var te=8>>U.b,xe=U.Ea,_e=U.K[0],Le=U.w;if(8>te)for(U=(1<<U.b)-1,Le=(1<<te)-1;W<V;++W){var Ee,De=0;for(Ee=0;Ee<xe;++Ee)Ee&U||(De=T(Y[ee++])),de[Te++]=D(_e[De&Le]),De>>=te}else k["VP8LMapColor"+N](Y,ee,_e,Le,de,Te,W,V,xe)}}function Qt(m,x,N,T,D){for(N=x+N;x<N;){var U=m[x++];T[D++]=U>>16&255,T[D++]=U>>8&255,T[D++]=255&U}}function Ut(m,x,N,T,D){for(N=x+N;x<N;){var U=m[x++];T[D++]=U>>16&255,T[D++]=U>>8&255,T[D++]=255&U,T[D++]=U>>24&255}}function ht(m,x,N,T,D){for(N=x+N;x<N;){var U=(W=m[x++])>>16&240|W>>12&15,W=240&W|W>>28&15;T[D++]=U,T[D++]=W}}function je(m,x,N,T,D){for(N=x+N;x<N;){var U=(W=m[x++])>>16&248|W>>13&7,W=W>>5&224|W>>3&31;T[D++]=U,T[D++]=W}}function nt(m,x,N,T,D){for(N=x+N;x<N;){var U=m[x++];T[D++]=255&U,T[D++]=U>>8&255,T[D++]=U>>16&255}}function ot(m,x,N,T,D,U){if(U==0)for(N=x+N;x<N;)oe(T,((U=m[x++])[0]>>24|U[1]>>8&65280|U[2]<<8&16711680|U[3]<<24)>>>0),D+=32;else n(T,D,m,x,N)}function Ct(m,x){k[x][0]=k[m+"0"],k[x][1]=k[m+"1"],k[x][2]=k[m+"2"],k[x][3]=k[m+"3"],k[x][4]=k[m+"4"],k[x][5]=k[m+"5"],k[x][6]=k[m+"6"],k[x][7]=k[m+"7"],k[x][8]=k[m+"8"],k[x][9]=k[m+"9"],k[x][10]=k[m+"10"],k[x][11]=k[m+"11"],k[x][12]=k[m+"12"],k[x][13]=k[m+"13"],k[x][14]=k[m+"0"],k[x][15]=k[m+"0"]}function St(m){return m==Jp||m==Qp||m==T0||m==e1}function ir(){this.eb=[],this.size=this.A=this.fb=0}function ar(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function zt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new ir,this.f.kb=new ar,this.sd=null}function at(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function $t(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Tn(m){return alert("todo:WebPSamplerProcessPlane"),m.T}function Fr(m,x){var N=m.T,T=x.ba.f.RGBA,D=T.eb,U=T.fb+m.ka*T.A,W=Zi[x.ba.S],V=m.y,Y=m.O,ee=m.f,de=m.N,Te=m.ea,te=m.W,xe=x.cc,_e=x.dc,Le=x.Mc,Ee=x.Nc,De=m.ka,Me=m.ka+m.T,Ge=m.U,ze=Ge+1>>1;for(De==0?W(V,Y,null,null,ee,de,Te,te,ee,de,Te,te,D,U,null,null,Ge):(W(x.ec,x.fc,V,Y,xe,_e,Le,Ee,ee,de,Te,te,D,U-T.A,D,U,Ge),++N);De+2<Me;De+=2)xe=ee,_e=de,Le=Te,Ee=te,de+=m.Rc,te+=m.Rc,U+=2*T.A,W(V,(Y+=2*m.fa)-m.fa,V,Y,xe,_e,Le,Ee,ee,de,Te,te,D,U-T.A,D,U,Ge);return Y+=m.fa,m.j+Me<m.o?(n(x.ec,x.fc,V,Y,Ge),n(x.cc,x.dc,ee,de,ze),n(x.Mc,x.Nc,Te,te,ze),N--):1&Me||W(V,Y,null,null,ee,de,Te,te,ee,de,Te,te,D,U+T.A,null,null,Ge),N}function da(m,x,N){var T=m.F,D=[m.J];if(T!=null){var U=m.U,W=x.ba.S,V=W==E0||W==T0;x=x.ba.f.RGBA;var Y=[0],ee=m.ka;Y[0]=m.T,m.Kb&&(ee==0?--Y[0]:(--ee,D[0]-=m.width),m.j+m.ka+m.T==m.o&&(Y[0]=m.o-m.j-ee));var de=x.eb;ee=x.fb+ee*x.A,m=bx(T,D[0],m.width,U,Y,de,ee+(V?0:3),x.A),t(N==Y),m&&St(W)&&ku(de,ee,V,U,Y,x.A)}return 0}function Vi(m){var x=m.ma,N=x.ba.S,T=11>N,D=N==S0||N==A0||N==E0||N==Zp||N==12||St(N);if(x.memory=null,x.Ib=null,x.Jb=null,x.Nd=null,!ci(x.Oa,m,D?11:12))return 0;if(D&&St(N)&&_u(),m.da)alert("todo:use_scaling");else{if(T){if(x.Ib=Tn,m.Kb){if(N=m.U+1>>1,x.memory=a(m.U+2*N),x.memory==null)return 0;x.ec=x.memory,x.fc=0,x.cc=x.ec,x.dc=x.fc+m.U,x.Mc=x.cc,x.Nc=x.dc+N,x.Ib=Fr,_u()}}else alert("todo:EmitYUV");D&&(x.Jb=da,T&&qo())}if(T&&!Mx){for(m=0;256>m;++m)IT[m]=89858*(m-128)+j0>>P0,BT[m]=-22014*(m-128)+j0,RT[m]=-45773*(m-128),MT[m]=113618*(m-128)+j0>>P0;for(m=Ou;m<n1;++m)x=76283*(m-16)+j0>>P0,UT[m-Ou]=un(x,255),$T[m-Ou]=un(x+8>>4,15);Mx=1}return 1}function Nt(m){var x=m.ma,N=m.U,T=m.T;return t(!(1&m.ka)),0>=N||0>=T?0:(N=x.Ib(m,x),x.Jb!=null&&x.Jb(m,x,N),x.Dc+=N,1)}function pa(m){m.ma.memory=null}function ma(m,x,N,T){return Fe(m,8)!=47?0:(x[0]=Fe(m,14)+1,N[0]=Fe(m,14)+1,T[0]=Fe(m,1),Fe(m,3)!=0?0:!m.h)}function $n(m,x){if(4>m)return m+1;var N=m-2>>1;return(2+(1&m)<<N)+Fe(x,N)+1}function li(m,x){return 120<x?x-120:1<=(N=((N=_T[x-1])>>4)*m+(8-(15&N)))?N:1;var N}function kr(m,x,N){var T=O(N),D=m[x+=255&T].g-8;return 0<D&&(J(N,N.u+8),T=O(N),x+=m[x].value,x+=T&(1<<D)-1),J(N,N.u+m[x].g),m[x].value}function Qr(m,x,N){return N.g+=m.g,N.value+=m.value<<x>>>0,t(8>=N.g),m.g}function B(m,x,N){var T=m.xc;return t((x=T==0?0:m.vc[m.md*(N>>T)+(x>>T)])<m.Wb),m.Ya[x]}function re(m,x,N,T){var D=m.ab,U=m.c*x,W=m.C;x=W+x;var V=N,Y=T;for(T=m.Ta,N=m.Ua;0<D--;){var ee=m.gc[D],de=W,Te=x,te=V,xe=Y,_e=(Y=T,V=N,ee.Ea);switch(t(de<Te),t(Te<=ee.nc),ee.hc){case 2:Kl(te,xe,(Te-de)*_e,Y,V);break;case 0:var Le=de,Ee=Te,De=Y,Me=V,Ge=(gt=ee).Ea;Le==0&&(za(te,xe,null,null,1,De,Me),Kt(te,xe+1,0,0,Ge-1,De,Me+1),xe+=Ge,Me+=Ge,++Le);for(var ze=1<<gt.b,bt=ze-1,ct=We(Ge,gt.b),Mt=gt.K,gt=gt.w+(Le>>gt.b)*ct;Le<Ee;){var Ht=Mt,fn=gt,Rt=1;for(Wa(te,xe,De,Me-Ge,1,De,Me);Rt<Ge;){var vt=(Rt&~bt)+ze;vt>Ge&&(vt=Ge),(0,Vo[Ht[fn++]>>8&15])(te,xe+ +Rt,De,Me+Rt-Ge,vt-Rt,De,Me+Rt),Rt=vt}xe+=Ge,Me+=Ge,++Le&bt||(gt+=ct)}Te!=ee.nc&&n(Y,V-_e,Y,V+(Te-de-1)*_e,_e);break;case 1:for(_e=te,Ee=xe,Ge=(te=ee.Ea)-(Me=te&~(De=(xe=1<<ee.b)-1)),Le=We(te,ee.b),ze=ee.K,ee=ee.w+(de>>ee.b)*Le;de<Te;){for(bt=ze,ct=ee,Mt=new Pt,gt=Ee+Me,Ht=Ee+te;Ee<gt;)pt(bt[ct++],Mt),ds(Mt,_e,Ee,xe,Y,V),Ee+=xe,V+=xe;Ee<Ht&&(pt(bt[ct++],Mt),ds(Mt,_e,Ee,Ge,Y,V),Ee+=Ge,V+=Ge),++de&De||(ee+=Le)}break;case 3:if(te==Y&&xe==V&&0<ee.b){for(Ee=Y,te=_e=V+(Te-de)*_e-(Me=(Te-de)*We(ee.Ea,ee.b)),xe=Y,De=V,Le=[],Me=(Ge=Me)-1;0<=Me;--Me)Le[Me]=xe[De+Me];for(Me=Ge-1;0<=Me;--Me)Ee[te+Me]=Le[Me];Tu(ee,de,Te,Y,_e,Y,V)}else Tu(ee,de,Te,te,xe,Y,V)}V=T,Y=N}Y!=N&&n(T,N,V,Y,U)}function K(m,x){var N=m.V,T=m.Ba+m.c*m.C,D=x-m.C;if(t(x<=m.l.o),t(16>=D),0<D){var U=m.l,W=m.Ta,V=m.Ua,Y=U.width;if(re(m,D,N,T),D=V=[V],t((N=m.C)<(T=x)),t(U.v<U.va),T>U.o&&(T=U.o),N<U.j){var ee=U.j-N;N=U.j,D[0]+=ee*Y}if(N>=T?N=0:(D[0]+=4*U.v,U.ka=N-U.j,U.U=U.va-U.v,U.T=T-N,N=1),N){if(V=V[0],11>(N=m.ca).S){var de=N.f.RGBA,Te=(T=N.S,D=U.U,U=U.T,ee=de.eb,de.A),te=U;for(de=de.fb+m.Ma*de.A;0<te--;){var xe=W,_e=V,Le=D,Ee=ee,De=de;switch(T){case N0:Pu(xe,_e,Le,Ee,De);break;case S0:_i(xe,_e,Le,Ee,De);break;case Jp:_i(xe,_e,Le,Ee,De),ku(Ee,De,0,Le,1,0);break;case Tx:_r(xe,_e,Le,Ee,De);break;case A0:ot(xe,_e,Le,Ee,De,1);break;case Qp:ot(xe,_e,Le,Ee,De,1),ku(Ee,De,0,Le,1,0);break;case E0:ot(xe,_e,Le,Ee,De,0);break;case T0:ot(xe,_e,Le,Ee,De,0),ku(Ee,De,1,Le,1,0);break;case Zp:qa(xe,_e,Le,Ee,De);break;case e1:qa(xe,_e,Le,Ee,De),yx(Ee,De,Le,1,0);break;case Px:wr(xe,_e,Le,Ee,De);break;default:t(0)}V+=Y,de+=Te}m.Ma+=U}else alert("todo:EmitRescaledRowsYUVA");t(m.Ma<=N.height)}}m.C=x,t(m.C<=m.i)}function Z(m){var x;if(0<m.ua)return 0;for(x=0;x<m.Wb;++x){var N=m.Ya[x].G,T=m.Ya[x].H;if(0<N[1][T[1]+0].g||0<N[2][T[2]+0].g||0<N[3][T[3]+0].g)return 0}return 1}function ne(m,x,N,T,D,U){if(m.Z!=0){var W=m.qd,V=m.rd;for(t(eo[m.Z]!=null);x<N;++x)eo[m.Z](W,V,T,D,T,D,U),W=T,V=D,D+=U;m.qd=W,m.rd=V}}function se(m,x){var N=m.l.ma,T=N.Z==0||N.Z==1?m.l.j:m.C;if(T=m.C<T?T:m.C,t(x<=m.l.o),x>T){var D=m.l.width,U=N.ca,W=N.tb+D*T,V=m.V,Y=m.Ba+m.c*T,ee=m.gc;t(m.ab==1),t(ee[0].hc==3),Xl(ee[0],T,x,V,Y,U,W),ne(N,T,x,U,W,D)}m.C=m.Ma=x}function Ne(m,x,N,T,D,U,W){var V=m.$/T,Y=m.$%T,ee=m.m,de=m.s,Te=N+m.$,te=Te;D=N+T*D;var xe=N+T*U,_e=280+de.ua,Le=m.Pb?V:16777216,Ee=0<de.ua?de.Wa:null,De=de.wc,Me=Te<xe?B(de,Y,V):null;t(m.C<U),t(xe<=D);var Ge=!1;e:for(;;){for(;Ge||Te<xe;){var ze=0;if(V>=Le){var bt=Te-N;t((Le=m).Pb),Le.wd=Le.m,Le.xd=bt,0<Le.s.ua&&tt(Le.s.Wa,Le.s.vb),Le=V+ST}if(Y&De||(Me=B(de,Y,V)),t(Me!=null),Me.Qb&&(x[Te]=Me.qb,Ge=!0),!Ge)if(fe(ee),Me.jc){ze=ee,bt=x;var ct=Te,Mt=Me.pd[O(ze)&$a-1];t(Me.jc),256>Mt.g?(J(ze,ze.u+Mt.g),bt[ct]=Mt.value,ze=0):(J(ze,ze.u+Mt.g-256),t(256<=Mt.value),ze=Mt.value),ze==0&&(Ge=!0)}else ze=kr(Me.G[0],Me.H[0],ee);if(ee.h)break;if(Ge||256>ze){if(!Ge)if(Me.nd)x[Te]=(Me.qb|ze<<8)>>>0;else{if(fe(ee),Ge=kr(Me.G[1],Me.H[1],ee),fe(ee),bt=kr(Me.G[2],Me.H[2],ee),ct=kr(Me.G[3],Me.H[3],ee),ee.h)break;x[Te]=(ct<<24|Ge<<16|ze<<8|bt)>>>0}if(Ge=!1,++Te,++Y>=T&&(Y=0,++V,W!=null&&V<=U&&!(V%16)&&W(m,V),Ee!=null))for(;te<Te;)ze=x[te++],Ee.X[(506832829*ze&4294967295)>>>Ee.Mb]=ze}else if(280>ze){if(ze=$n(ze-256,ee),bt=kr(Me.G[4],Me.H[4],ee),fe(ee),bt=li(T,bt=$n(bt,ee)),ee.h)break;if(Te-N<bt||D-Te<ze)break e;for(ct=0;ct<ze;++ct)x[Te+ct]=x[Te+ct-bt];for(Te+=ze,Y+=ze;Y>=T;)Y-=T,++V,W!=null&&V<=U&&!(V%16)&&W(m,V);if(t(Te<=D),Y&De&&(Me=B(de,Y,V)),Ee!=null)for(;te<Te;)ze=x[te++],Ee.X[(506832829*ze&4294967295)>>>Ee.Mb]=ze}else{if(!(ze<_e))break e;for(Ge=ze-280,t(Ee!=null);te<Te;)ze=x[te++],Ee.X[(506832829*ze&4294967295)>>>Ee.Mb]=ze;ze=Te,t(!(Ge>>>(bt=Ee).Xa)),x[ze]=bt.X[Ge],Ge=!0}Ge||t(ee.h==M(ee))}if(m.Pb&&ee.h&&Te<D)t(m.m.h),m.a=5,m.m=m.wd,m.$=m.xd,0<m.s.ua&&tt(m.s.vb,m.s.Wa);else{if(ee.h)break e;W!=null&&W(m,V>U?U:V),m.a=0,m.$=Te-N}return 1}return m.a=3,0}function Ce(m){t(m!=null),m.vc=null,m.yc=null,m.Ya=null;var x=m.Wa;x!=null&&(x.X=null),m.vb=null,t(m!=null)}function Se(){var m=new Dr;return m==null?null:(m.a=0,m.xb=Cx,Ct("Predictor","VP8LPredictors"),Ct("Predictor","VP8LPredictors_C"),Ct("PredictorAdd","VP8LPredictorsAdd"),Ct("PredictorAdd","VP8LPredictorsAdd_C"),Kl=yt,ds=_t,Pu=Qt,_i=Ut,qa=ht,wr=je,_r=nt,k.VP8LMapColor32b=Yl,k.VP8LMapColor8b=Go,m)}function Ae(m,x,N,T,D){var U=1,W=[m],V=[x],Y=T.m,ee=T.s,de=null,Te=0;e:for(;;){if(N)for(;U&&Fe(Y,1);){var te=W,xe=V,_e=T,Le=1,Ee=_e.m,De=_e.gc[_e.ab],Me=Fe(Ee,2);if(_e.Oc&1<<Me)U=0;else{switch(_e.Oc|=1<<Me,De.hc=Me,De.Ea=te[0],De.nc=xe[0],De.K=[null],++_e.ab,t(4>=_e.ab),Me){case 0:case 1:De.b=Fe(Ee,3)+2,Le=Ae(We(De.Ea,De.b),We(De.nc,De.b),0,_e,De.K),De.K=De.K[0];break;case 3:var Ge,ze=Fe(Ee,8)+1,bt=16<ze?0:4<ze?1:2<ze?2:3;if(te[0]=We(De.Ea,bt),De.b=bt,Ge=Le=Ae(ze,1,0,_e,De.K)){var ct,Mt=ze,gt=De,Ht=1<<(8>>gt.b),fn=a(Ht);if(fn==null)Ge=0;else{var Rt=gt.K[0],vt=gt.w;for(fn[0]=gt.K[0][0],ct=1;ct<1*Mt;++ct)fn[ct]=st(Rt[vt+ct],fn[ct-1]);for(;ct<4*Ht;++ct)fn[ct]=0;gt.K[0]=null,gt.K[0]=fn,Ge=1}}Le=Ge;break;case 2:break;default:t(0)}U=Le}}if(W=W[0],V=V[0],U&&Fe(Y,1)&&!(U=1<=(Te=Fe(Y,4))&&11>=Te)){T.a=3;break e}var Je;if(Je=U)t:{var Vr,Dt,Yt,Er=T,jn=W,ei=V,Mr=Te,Wn=N,ti=Er.m,hn=Er.s,Xt=[null],sr=1,Rr=0,or=NT[Mr];r:for(;;){if(Wn&&Fe(ti,1)){var kn=Fe(ti,3)+2,ba=We(jn,kn),Kr=We(ei,kn),fi=ba*Kr;if(!Ae(ba,Kr,0,Er,Xt))break r;for(Xt=Xt[0],hn.xc=kn,Vr=0;Vr<fi;++Vr){var vr=Xt[Vr]>>8&65535;Xt[Vr]=vr,vr>=sr&&(sr=vr+1)}}if(ti.h)break r;for(Dt=0;5>Dt;++Dt){var dn=jx[Dt];!Dt&&0<Mr&&(dn+=1<<Mr),Rr<dn&&(Rr=dn)}var Si=s(sr*or,H),ri=sr,Ai=s(ri,ce);if(Ai==null)var Ei=null;else t(65536>=ri),Ei=Ai;var hi=a(Rr);if(Ei==null||hi==null||Si==null){Er.a=1;break r}var Ti=Si;for(Vr=Yt=0;Vr<sr;++Vr){var Nr=Ei[Vr],Pi=Nr.G,wa=Nr.H,Ko=0,gs=1,Cn=0;for(Dt=0;5>Dt;++Dt){dn=jx[Dt],Pi[Dt]=Ti,wa[Dt]=Yt,!Dt&&0<Mr&&(dn+=1<<Mr);i:{var C0,i1=dn,O0=Er,Lu=hi,qT=Ti,HT=Yt,a1=0,to=O0.m,GT=Fe(to,1);if(i(Lu,0,0,i1),GT){var VT=Fe(to,1)+1,KT=Fe(to,1),Ux=Fe(to,KT==0?1:8);Lu[Ux]=1,VT==2&&(Lu[Ux=Fe(to,8)]=1);var L0=1}else{var $x=a(19),zx=Fe(to,4)+4;if(19<zx){O0.a=3;var F0=0;break i}for(C0=0;C0<zx;++C0)$x[wT[C0]]=Fe(to,3);var s1=void 0,Fu=void 0,Wx=O0,YT=$x,D0=i1,qx=Lu,o1=0,ro=Wx.m,Hx=8,Gx=s(128,H);n:for(;j(Gx,0,7,YT,19);){if(Fe(ro,1)){var XT=2+2*Fe(ro,3);if((s1=2+Fe(ro,XT))>D0)break n}else s1=D0;for(Fu=0;Fu<D0&&s1--;){fe(ro);var Vx=Gx[0+(127&O(ro))];J(ro,ro.u+Vx.g);var Jl=Vx.value;if(16>Jl)qx[Fu++]=Jl,Jl!=0&&(Hx=Jl);else{var ZT=Jl==16,Kx=Jl-16,JT=yT[Kx],Yx=Fe(ro,xT[Kx])+JT;if(Fu+Yx>D0)break n;for(var QT=ZT?Hx:0;0<Yx--;)qx[Fu++]=QT}}o1=1;break n}o1||(Wx.a=3),L0=o1}(L0=L0&&!to.h)&&(a1=j(qT,HT,8,Lu,i1)),L0&&a1!=0?F0=a1:(O0.a=3,F0=0)}if(F0==0)break r;if(gs&&bT[Dt]==1&&(gs=Ti[Yt].g==0),Ko+=Ti[Yt].g,Yt+=F0,3>=Dt){var Du,l1=hi[0];for(Du=1;Du<dn;++Du)hi[Du]>l1&&(l1=hi[Du]);Cn+=l1}}if(Nr.nd=gs,Nr.Qb=0,gs&&(Nr.qb=(Pi[3][wa[3]+0].value<<24|Pi[1][wa[1]+0].value<<16|Pi[2][wa[2]+0].value)>>>0,Ko==0&&256>Pi[0][wa[0]+0].value&&(Nr.Qb=1,Nr.qb+=Pi[0][wa[0]+0].value<<8)),Nr.jc=!Nr.Qb&&6>Cn,Nr.jc){var I0,vs=Nr;for(I0=0;I0<$a;++I0){var no=I0,io=vs.pd[no],M0=vs.G[0][vs.H[0]+no];256<=M0.value?(io.g=M0.g+256,io.value=M0.value):(io.g=0,io.value=0,no>>=Qr(M0,8,io),no>>=Qr(vs.G[1][vs.H[1]+no],16,io),no>>=Qr(vs.G[2][vs.H[2]+no],0,io),Qr(vs.G[3][vs.H[3]+no],24,io))}}}hn.vc=Xt,hn.Wb=sr,hn.Ya=Ei,hn.yc=Si,Je=1;break t}Je=0}if(!(U=Je)){T.a=3;break e}if(0<Te){if(ee.ua=1<<Te,!Q(ee.Wa,Te)){T.a=1,U=0;break e}}else ee.ua=0;var c1=T,Xx=W,e8=V,u1=c1.s,f1=u1.xc;if(c1.c=Xx,c1.i=e8,u1.md=We(Xx,f1),u1.wc=f1==0?-1:(1<<f1)-1,N){T.xb=CT;break e}if((de=a(W*V))==null){T.a=1,U=0;break e}U=(U=Ne(T,de,0,W,V,V,null))&&!Y.h;break e}return U?(D!=null?D[0]=de:(t(de==null),t(N)),T.$=0,N||Ce(ee)):Ce(ee),U}function Pe(m,x){var N=m.c*m.i,T=N+x+16*x;return t(m.c<=x),m.V=a(T),m.V==null?(m.Ta=null,m.Ua=0,m.a=1,0):(m.Ta=m.V,m.Ua=m.Ba+N+x,1)}function He(m,x){var N=m.C,T=x-N,D=m.V,U=m.Ba+m.c*N;for(t(x<=m.l.o);0<T;){var W=16<T?16:T,V=m.l.ma,Y=m.l.width,ee=Y*W,de=V.ca,Te=V.tb+Y*N,te=m.Ta,xe=m.Ua;re(m,W,D,U),wx(te,xe,de,Te,ee),ne(V,N,N+W,de,Te,Y),T-=W,D+=W*m.c,N+=W}t(N==x),m.C=m.Ma=x}function Ke(){this.ub=this.yd=this.td=this.Rb=0}function rt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Ve(){this.Fb=this.Bb=this.Cb=0,this.Zb=a(4),this.Lb=a(4)}function Qe(){this.Yb=function(){var m=[];return function x(N,T,D){for(var U=D[T],W=0;W<U&&(N.push(D.length>T+1?[]:0),!(D.length<T+1));W++)x(N[W],T+1,D)}(m,0,[3,11]),m}()}function Tt(){this.jb=a(3),this.Wc=o([4,8],Qe),this.Xc=o([4,17],Qe)}function pr(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new a(4),this.od=new a(4)}function Wt(){this.ld=this.La=this.dd=this.tc=0}function Ir(){this.Na=this.la=0}function Ma(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function ga(){this.ad=a(384),this.Za=0,this.Ob=a(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Ra(){this.uc=this.M=this.Nb=0,this.wa=Array(new Wt),this.Y=0,this.ya=Array(new ga),this.aa=0,this.l=new zn}function Ki(){this.y=a(16),this.f=a(8),this.ea=a(8)}function Hs(){this.cb=this.a=0,this.sc="",this.m=new A,this.Od=new Ke,this.Kc=new rt,this.ed=new pr,this.Qa=new Ve,this.Ic=this.$c=this.Aa=0,this.D=new Ra,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=s(8,A),this.ia=0,this.pb=s(4,Ma),this.Pa=new Tt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Ki),this.Hd=0,this.rb=Array(new Ir),this.sb=0,this.wa=Array(new Wt),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new ga),this.L=this.aa=0,this.gd=o([4,2],Wt),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function zn(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Lp(){var m=new Hs;return m!=null&&(m.a=0,m.sc="OK",m.cb=0,m.Xb=0,Cu||(Cu=os)),m}function en(m,x,N){return m.a==0&&(m.a=x,m.sc=N,m.cb=0),0}function m0(m,x,N){return 3<=N&&m[x+0]==157&&m[x+1]==1&&m[x+2]==42}function g0(m,x){if(m==null)return 0;if(m.a=0,m.sc="OK",x==null)return en(m,2,"null VP8Io passed to VP8GetHeaders()");var N=x.data,T=x.w,D=x.ha;if(4>D)return en(m,7,"Truncated header.");var U=N[T+0]|N[T+1]<<8|N[T+2]<<16,W=m.Od;if(W.Rb=!(1&U),W.td=U>>1&7,W.yd=U>>4&1,W.ub=U>>5,3<W.td)return en(m,3,"Incorrect keyframe parameters.");if(!W.yd)return en(m,4,"Frame not displayable.");T+=3,D-=3;var V=m.Kc;if(W.Rb){if(7>D)return en(m,7,"cannot parse picture header");if(!m0(N,T,D))return en(m,3,"Bad code word");V.c=16383&(N[T+4]<<8|N[T+3]),V.Td=N[T+4]>>6,V.i=16383&(N[T+6]<<8|N[T+5]),V.Ud=N[T+6]>>6,T+=7,D-=7,m.za=V.c+15>>4,m.Ub=V.i+15>>4,x.width=V.c,x.height=V.i,x.Da=0,x.j=0,x.v=0,x.va=x.width,x.o=x.height,x.da=0,x.ib=x.width,x.hb=x.height,x.U=x.width,x.T=x.height,i((U=m.Pa).jb,0,255,U.jb.length),t((U=m.Qa)!=null),U.Cb=0,U.Bb=0,U.Fb=1,i(U.Zb,0,0,U.Zb.length),i(U.Lb,0,0,U.Lb)}if(W.ub>D)return en(m,7,"bad partition length");pe(U=m.m,N,T,W.ub),T+=W.ub,D-=W.ub,W.Rb&&(V.Ld=ae(U),V.Kd=ae(U)),V=m.Qa;var Y,ee=m.Pa;if(t(U!=null),t(V!=null),V.Cb=ae(U),V.Cb){if(V.Bb=ae(U),ae(U)){for(V.Fb=ae(U),Y=0;4>Y;++Y)V.Zb[Y]=ae(U)?me(U,7):0;for(Y=0;4>Y;++Y)V.Lb[Y]=ae(U)?me(U,6):0}if(V.Bb)for(Y=0;3>Y;++Y)ee.jb[Y]=ae(U)?ye(U,8):255}else V.Bb=0;if(U.Ka)return en(m,3,"cannot parse segment header");if((V=m.ed).zd=ae(U),V.Tb=ye(U,6),V.wb=ye(U,3),V.Pc=ae(U),V.Pc&&ae(U)){for(ee=0;4>ee;++ee)ae(U)&&(V.vd[ee]=me(U,6));for(ee=0;4>ee;++ee)ae(U)&&(V.od[ee]=me(U,6))}if(m.L=V.Tb==0?0:V.zd?1:2,U.Ka)return en(m,3,"cannot parse filter header");var de=D;if(D=Y=T,T=Y+de,V=de,m.Xb=(1<<ye(m.m,2))-1,de<3*(ee=m.Xb))N=7;else{for(Y+=3*ee,V-=3*ee,de=0;de<ee;++de){var Te=N[D+0]|N[D+1]<<8|N[D+2]<<16;Te>V&&(Te=V),pe(m.Jc[+de],N,Y,Te),Y+=Te,V-=Te,D+=3}pe(m.Jc[+ee],N,Y,V),N=Y<T?0:5}if(N!=0)return en(m,N,"cannot parse partitions");for(N=ye(Y=m.m,7),D=ae(Y)?me(Y,4):0,T=ae(Y)?me(Y,4):0,V=ae(Y)?me(Y,4):0,ee=ae(Y)?me(Y,4):0,Y=ae(Y)?me(Y,4):0,de=m.Qa,Te=0;4>Te;++Te){if(de.Cb){var te=de.Zb[Te];de.Fb||(te+=N)}else{if(0<Te){m.pb[Te]=m.pb[0];continue}te=N}var xe=m.pb[Te];xe.Sc[0]=t1[un(te+D,127)],xe.Sc[1]=r1[un(te+0,127)],xe.Eb[0]=2*t1[un(te+T,127)],xe.Eb[1]=101581*r1[un(te+V,127)]>>16,8>xe.Eb[1]&&(xe.Eb[1]=8),xe.Qc[0]=t1[un(te+ee,117)],xe.Qc[1]=r1[un(te+Y,127)],xe.lc=te+Y}if(!W.Rb)return en(m,4,"Not a key frame.");for(ae(U),W=m.Pa,N=0;4>N;++N){for(D=0;8>D;++D)for(T=0;3>T;++T)for(V=0;11>V;++V)ee=ue(U,jT[N][D][T][V])?ye(U,8):TT[N][D][T][V],W.Wc[N][D].Yb[T][V]=ee;for(D=0;17>D;++D)W.Xc[N][D]=W.Wc[N][kT[D]]}return m.kc=ae(U),m.kc&&(m.Bd=ye(U,8)),m.cb=1}function os(m,x,N,T,D,U,W){var V=x[D].Yb[N];for(N=0;16>D;++D){if(!ue(m,V[N+0]))return D;for(;!ue(m,V[N+1]);)if(V=x[++D].Yb[0],N=0,D==16)return 16;var Y=x[D+1].Yb;if(ue(m,V[N+2])){var ee=m,de=0;if(ue(ee,(te=V)[(Te=N)+3]))if(ue(ee,te[Te+6])){for(V=0,Te=2*(de=ue(ee,te[Te+8]))+(te=ue(ee,te[Te+9+de])),de=0,te=AT[Te];te[V];++V)de+=de+ue(ee,te[V]);de+=3+(8<<Te)}else ue(ee,te[Te+7])?(de=7+2*ue(ee,165),de+=ue(ee,145)):de=5+ue(ee,159);else de=ue(ee,te[Te+4])?3+ue(ee,te[Te+5]):2;V=Y[2]}else de=1,V=Y[1];Y=W+ET[D],0>(ee=m).b&&ve(ee);var Te,te=ee.b,xe=(Te=ee.Ca>>1)-(ee.I>>te)>>31;--ee.b,ee.Ca+=xe,ee.Ca|=1,ee.I-=(Te+1&xe)<<te,U[Y]=((de^xe)-xe)*T[(0<D)+0]}return 16}function Io(m){var x=m.rb[m.sb-1];x.la=0,x.Na=0,i(m.zc,0,0,m.zc.length),m.ja=0}function va(m,x,N,T,D){D=m[x+N+32*T]+(D>>3),m[x+N+32*T]=-256&D?0>D?0:255:D}function Mo(m,x,N,T,D,U){va(m,x,0,N,T+D),va(m,x,1,N,T+U),va(m,x,2,N,T-U),va(m,x,3,N,T-D)}function Wr(m){return(20091*m>>16)+m}function fu(m,x,N,T){var D,U=0,W=a(16);for(D=0;4>D;++D){var V=m[x+0]+m[x+8],Y=m[x+0]-m[x+8],ee=(35468*m[x+4]>>16)-Wr(m[x+12]),de=Wr(m[x+4])+(35468*m[x+12]>>16);W[U+0]=V+de,W[U+1]=Y+ee,W[U+2]=Y-ee,W[U+3]=V-de,U+=4,x++}for(D=U=0;4>D;++D)V=(m=W[U+0]+4)+W[U+8],Y=m-W[U+8],ee=(35468*W[U+4]>>16)-Wr(W[U+12]),va(N,T,0,0,V+(de=Wr(W[U+4])+(35468*W[U+12]>>16))),va(N,T,1,0,Y+ee),va(N,T,2,0,Y-ee),va(N,T,3,0,V-de),U++,T+=32}function Fp(m,x,N,T){var D=m[x+0]+4,U=35468*m[x+4]>>16,W=Wr(m[x+4]),V=35468*m[x+1]>>16;Mo(N,T,0,D+W,m=Wr(m[x+1]),V),Mo(N,T,1,D+U,m,V),Mo(N,T,2,D-U,m,V),Mo(N,T,3,D-W,m,V)}function Dp(m,x,N,T,D){fu(m,x,N,T),D&&fu(m,x+16,N,T+4)}function Ip(m,x,N,T){Gr(m,x+0,N,T,1),Gr(m,x+32,N,T+128,1)}function Ba(m,x,N,T){var D;for(m=m[x+0]+4,D=0;4>D;++D)for(x=0;4>x;++x)va(N,T,x,D,m)}function v0(m,x,N,T){m[x+0]&&Ha(m,x+0,N,T),m[x+16]&&Ha(m,x+16,N,T+4),m[x+32]&&Ha(m,x+32,N,T+128),m[x+48]&&Ha(m,x+48,N,T+128+4)}function x0(m,x,N,T){var D,U=a(16);for(D=0;4>D;++D){var W=m[x+0+D]+m[x+12+D],V=m[x+4+D]+m[x+8+D],Y=m[x+4+D]-m[x+8+D],ee=m[x+0+D]-m[x+12+D];U[0+D]=W+V,U[8+D]=W-V,U[4+D]=ee+Y,U[12+D]=ee-Y}for(D=0;4>D;++D)W=(m=U[0+4*D]+3)+U[3+4*D],V=U[1+4*D]+U[2+4*D],Y=U[1+4*D]-U[2+4*D],ee=m-U[3+4*D],N[T+0]=W+V>>3,N[T+16]=ee+Y>>3,N[T+32]=W-V>>3,N[T+48]=ee-Y>>3,T+=64}function Gs(m,x,N){var T,D=x-32,U=Ni,W=255-m[D-1];for(T=0;T<N;++T){var V,Y=U,ee=W+m[x-1];for(V=0;V<N;++V)m[x+V]=Y[ee+m[D+V]];x+=32}}function hu(m,x){Gs(m,x,4)}function Mp(m,x){Gs(m,x,8)}function Rp(m,x){Gs(m,x,16)}function Bp(m,x){var N;for(N=0;16>N;++N)n(m,x+32*N,m,x-32,16)}function du(m,x){var N;for(N=16;0<N;--N)i(m,x,m[x-1],16),x+=32}function Ro(m,x,N){var T;for(T=0;16>T;++T)i(x,N+32*T,m,16)}function Vs(m,x){var N,T=16;for(N=0;16>N;++N)T+=m[x-1+32*N]+m[x+N-32];Ro(T>>5,m,x)}function Up(m,x){var N,T=8;for(N=0;16>N;++N)T+=m[x-1+32*N];Ro(T>>4,m,x)}function Bo(m,x){var N,T=8;for(N=0;16>N;++N)T+=m[x+N-32];Ro(T>>4,m,x)}function pu(m,x){Ro(128,m,x)}function Ot(m,x,N){return m+2*x+N+2>>2}function $p(m,x){var N,T=x-32;for(T=new Uint8Array([Ot(m[T-1],m[T+0],m[T+1]),Ot(m[T+0],m[T+1],m[T+2]),Ot(m[T+1],m[T+2],m[T+3]),Ot(m[T+2],m[T+3],m[T+4])]),N=0;4>N;++N)n(m,x+32*N,T,0,T.length)}function zp(m,x){var N=m[x-1],T=m[x-1+32],D=m[x-1+64],U=m[x-1+96];oe(m,x+0,16843009*Ot(m[x-1-32],N,T)),oe(m,x+32,16843009*Ot(N,T,D)),oe(m,x+64,16843009*Ot(T,D,U)),oe(m,x+96,16843009*Ot(D,U,U))}function Wp(m,x){var N,T=4;for(N=0;4>N;++N)T+=m[x+N-32]+m[x-1+32*N];for(T>>=3,N=0;4>N;++N)i(m,x+32*N,T,4)}function qp(m,x){var N=m[x-1+0],T=m[x-1+32],D=m[x-1+64],U=m[x-1-32],W=m[x+0-32],V=m[x+1-32],Y=m[x+2-32],ee=m[x+3-32];m[x+0+96]=Ot(T,D,m[x-1+96]),m[x+1+96]=m[x+0+64]=Ot(N,T,D),m[x+2+96]=m[x+1+64]=m[x+0+32]=Ot(U,N,T),m[x+3+96]=m[x+2+64]=m[x+1+32]=m[x+0+0]=Ot(W,U,N),m[x+3+64]=m[x+2+32]=m[x+1+0]=Ot(V,W,U),m[x+3+32]=m[x+2+0]=Ot(Y,V,W),m[x+3+0]=Ot(ee,Y,V)}function ls(m,x){var N=m[x+1-32],T=m[x+2-32],D=m[x+3-32],U=m[x+4-32],W=m[x+5-32],V=m[x+6-32],Y=m[x+7-32];m[x+0+0]=Ot(m[x+0-32],N,T),m[x+1+0]=m[x+0+32]=Ot(N,T,D),m[x+2+0]=m[x+1+32]=m[x+0+64]=Ot(T,D,U),m[x+3+0]=m[x+2+32]=m[x+1+64]=m[x+0+96]=Ot(D,U,W),m[x+3+32]=m[x+2+64]=m[x+1+96]=Ot(U,W,V),m[x+3+64]=m[x+2+96]=Ot(W,V,Y),m[x+3+96]=Ot(V,Y,Y)}function cs(m,x){var N=m[x-1+0],T=m[x-1+32],D=m[x-1+64],U=m[x-1-32],W=m[x+0-32],V=m[x+1-32],Y=m[x+2-32],ee=m[x+3-32];m[x+0+0]=m[x+1+64]=U+W+1>>1,m[x+1+0]=m[x+2+64]=W+V+1>>1,m[x+2+0]=m[x+3+64]=V+Y+1>>1,m[x+3+0]=Y+ee+1>>1,m[x+0+96]=Ot(D,T,N),m[x+0+64]=Ot(T,N,U),m[x+0+32]=m[x+1+96]=Ot(N,U,W),m[x+1+32]=m[x+2+96]=Ot(U,W,V),m[x+2+32]=m[x+3+96]=Ot(W,V,Y),m[x+3+32]=Ot(V,Y,ee)}function Hp(m,x){var N=m[x+0-32],T=m[x+1-32],D=m[x+2-32],U=m[x+3-32],W=m[x+4-32],V=m[x+5-32],Y=m[x+6-32],ee=m[x+7-32];m[x+0+0]=N+T+1>>1,m[x+1+0]=m[x+0+64]=T+D+1>>1,m[x+2+0]=m[x+1+64]=D+U+1>>1,m[x+3+0]=m[x+2+64]=U+W+1>>1,m[x+0+32]=Ot(N,T,D),m[x+1+32]=m[x+0+96]=Ot(T,D,U),m[x+2+32]=m[x+1+96]=Ot(D,U,W),m[x+3+32]=m[x+2+96]=Ot(U,W,V),m[x+3+64]=Ot(W,V,Y),m[x+3+96]=Ot(V,Y,ee)}function Gp(m,x){var N=m[x-1+0],T=m[x-1+32],D=m[x-1+64],U=m[x-1+96];m[x+0+0]=N+T+1>>1,m[x+2+0]=m[x+0+32]=T+D+1>>1,m[x+2+32]=m[x+0+64]=D+U+1>>1,m[x+1+0]=Ot(N,T,D),m[x+3+0]=m[x+1+32]=Ot(T,D,U),m[x+3+32]=m[x+1+64]=Ot(D,U,U),m[x+3+64]=m[x+2+64]=m[x+0+96]=m[x+1+96]=m[x+2+96]=m[x+3+96]=U}function Ul(m,x){var N=m[x-1+0],T=m[x-1+32],D=m[x-1+64],U=m[x-1+96],W=m[x-1-32],V=m[x+0-32],Y=m[x+1-32],ee=m[x+2-32];m[x+0+0]=m[x+2+32]=N+W+1>>1,m[x+0+32]=m[x+2+64]=T+N+1>>1,m[x+0+64]=m[x+2+96]=D+T+1>>1,m[x+0+96]=U+D+1>>1,m[x+3+0]=Ot(V,Y,ee),m[x+2+0]=Ot(W,V,Y),m[x+1+0]=m[x+3+32]=Ot(N,W,V),m[x+1+32]=m[x+3+64]=Ot(T,N,W),m[x+1+64]=m[x+3+96]=Ot(D,T,N),m[x+1+96]=Ot(U,D,T)}function mu(m,x){var N;for(N=0;8>N;++N)n(m,x+32*N,m,x-32,8)}function Uo(m,x){var N;for(N=0;8>N;++N)i(m,x,m[x-1],8),x+=32}function $l(m,x,N){var T;for(T=0;8>T;++T)i(x,N+32*T,m,8)}function zl(m,x){var N,T=8;for(N=0;8>N;++N)T+=m[x+N-32]+m[x-1+32*N];$l(T>>4,m,x)}function Vp(m,x){var N,T=4;for(N=0;8>N;++N)T+=m[x+N-32];$l(T>>3,m,x)}function gu(m,x){var N,T=4;for(N=0;8>N;++N)T+=m[x-1+32*N];$l(T>>3,m,x)}function vu(m,x){$l(128,m,x)}function $o(m,x,N){var T=m[x-N],D=m[x+0],U=3*(D-T)+Xp[1020+m[x-2*N]-m[x+N]],W=_0[112+(U+4>>3)];m[x-N]=Ni[255+T+_0[112+(U+3>>3)]],m[x+0]=Ni[255+D-W]}function zo(m,x,N,T){var D=m[x+0],U=m[x+N];return Xi[255+m[x-2*N]-m[x-N]]>T||Xi[255+U-D]>T}function xu(m,x,N,T){return 4*Xi[255+m[x-N]-m[x+0]]+Xi[255+m[x-2*N]-m[x+N]]<=T}function Wl(m,x,N,T,D){var U=m[x-3*N],W=m[x-2*N],V=m[x-N],Y=m[x+0],ee=m[x+N],de=m[x+2*N],Te=m[x+3*N];return 4*Xi[255+V-Y]+Xi[255+W-ee]>T?0:Xi[255+m[x-4*N]-U]<=D&&Xi[255+U-W]<=D&&Xi[255+W-V]<=D&&Xi[255+Te-de]<=D&&Xi[255+de-ee]<=D&&Xi[255+ee-Y]<=D}function yu(m,x,N,T){var D=2*T+1;for(T=0;16>T;++T)xu(m,x+T,N,D)&&$o(m,x+T,N)}function Wo(m,x,N,T){var D=2*T+1;for(T=0;16>T;++T)xu(m,x+T*N,1,D)&&$o(m,x+T*N,1)}function bu(m,x,N,T){var D;for(D=3;0<D;--D)yu(m,x+=4*N,N,T)}function wu(m,x,N,T){var D;for(D=3;0<D;--D)Wo(m,x+=4,N,T)}function wi(m,x,N,T,D,U,W,V){for(U=2*U+1;0<D--;){if(Wl(m,x,N,U,W))if(zo(m,x,N,V))$o(m,x,N);else{var Y=m,ee=x,de=N,Te=Y[ee-2*de],te=Y[ee-de],xe=Y[ee+0],_e=Y[ee+de],Le=Y[ee+2*de],Ee=27*(Me=Xp[1020+3*(xe-te)+Xp[1020+Te-_e]])+63>>7,De=18*Me+63>>7,Me=9*Me+63>>7;Y[ee-3*de]=Ni[255+Y[ee-3*de]+Me],Y[ee-2*de]=Ni[255+Te+De],Y[ee-de]=Ni[255+te+Ee],Y[ee+0]=Ni[255+xe-Ee],Y[ee+de]=Ni[255+_e-De],Y[ee+2*de]=Ni[255+Le-Me]}x+=T}}function Ua(m,x,N,T,D,U,W,V){for(U=2*U+1;0<D--;){if(Wl(m,x,N,U,W))if(zo(m,x,N,V))$o(m,x,N);else{var Y=m,ee=x,de=N,Te=Y[ee-de],te=Y[ee+0],xe=Y[ee+de],_e=_0[112+(4+(Le=3*(te-Te))>>3)],Le=_0[112+(Le+3>>3)],Ee=_e+1>>1;Y[ee-2*de]=Ni[255+Y[ee-2*de]+Ee],Y[ee-de]=Ni[255+Te+Le],Y[ee+0]=Ni[255+te-_e],Y[ee+de]=Ni[255+xe-Ee]}x+=T}}function w(m,x,N,T,D,U){wi(m,x,N,1,16,T,D,U)}function I(m,x,N,T,D,U){wi(m,x,1,N,16,T,D,U)}function ie(m,x,N,T,D,U){var W;for(W=3;0<W;--W)Ua(m,x+=4*N,N,1,16,T,D,U)}function he(m,x,N,T,D,U){var W;for(W=3;0<W;--W)Ua(m,x+=4,1,N,16,T,D,U)}function we(m,x,N,T,D,U,W,V){wi(m,x,D,1,8,U,W,V),wi(N,T,D,1,8,U,W,V)}function Ie(m,x,N,T,D,U,W,V){wi(m,x,1,D,8,U,W,V),wi(N,T,1,D,8,U,W,V)}function qe(m,x,N,T,D,U,W,V){Ua(m,x+4*D,D,1,8,U,W,V),Ua(N,T+4*D,D,1,8,U,W,V)}function dt(m,x,N,T,D,U,W,V){Ua(m,x+4,1,D,8,U,W,V),Ua(N,T+4,1,D,8,U,W,V)}function xt(){this.ba=new zt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new $t,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function jt(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function It(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function er(){this.ua=0,this.Wa=new Re,this.vb=new Re,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new ce,this.yc=new H}function Dr(){this.xb=this.a=0,this.l=new zn,this.ca=new zt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new F,this.Pb=0,this.wd=new F,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new er,this.ab=0,this.gc=s(4,It),this.Oc=0}function tn(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new zn,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function mr(m,x,N,T,D,U,W){for(m=m==null?0:m[x+0],x=0;x<W;++x)D[U+x]=m+N[T+x]&255,m=D[U+x]}function cn(m,x,N,T,D,U,W){var V;if(m==null)mr(null,null,N,T,D,U,W);else for(V=0;V<W;++V)D[U+V]=m[x+V]+N[T+V]&255}function rn(m,x,N,T,D,U,W){if(m==null)mr(null,null,N,T,D,U,W);else{var V,Y=m[x+0],ee=Y,de=Y;for(V=0;V<W;++V)ee=de+(Y=m[x+V])-ee,de=N[T+V]+(-256&ee?0>ee?0:255:ee)&255,ee=Y,D[U+V]=de}}function Pn(m,x,N,T){var D=x.width,U=x.o;if(t(m!=null&&x!=null),0>N||0>=T||N+T>U)return null;if(!m.Cc){if(m.ga==null){var W;if(m.ga=new tn,(W=m.ga==null)||(W=x.width*x.o,t(m.Gb.length==0),m.Gb=a(W),m.Uc=0,m.Gb==null?W=0:(m.mb=m.Gb,m.nb=m.Uc,m.rc=null,W=1),W=!W),!W){W=m.ga;var V=m.Fa,Y=m.P,ee=m.qc,de=m.mb,Te=m.nb,te=Y+1,xe=ee-1,_e=W.l;if(t(V!=null&&de!=null&&x!=null),eo[0]=null,eo[1]=mr,eo[2]=cn,eo[3]=rn,W.ca=de,W.tb=Te,W.c=x.width,W.i=x.height,t(0<W.c&&0<W.i),1>=ee)x=0;else if(W.$a=3&V[Y+0],W.Z=V[Y+0]>>2&3,W.Lc=V[Y+0]>>4&3,Y=V[Y+0]>>6&3,0>W.$a||1<W.$a||4<=W.Z||1<W.Lc||Y)x=0;else if(_e.put=Nt,_e.ac=Vi,_e.bc=pa,_e.ma=W,_e.width=x.width,_e.height=x.height,_e.Da=x.Da,_e.v=x.v,_e.va=x.va,_e.j=x.j,_e.o=x.o,W.$a)e:{t(W.$a==1),x=Se();t:for(;;){if(x==null){x=0;break e}if(t(W!=null),W.mc=x,x.c=W.c,x.i=W.i,x.l=W.l,x.l.ma=W,x.l.width=W.c,x.l.height=W.i,x.a=0,be(x.m,V,te,xe),!Ae(W.c,W.i,1,x,null)||(x.ab==1&&x.gc[0].hc==3&&Z(x.s)?(W.ic=1,V=x.c*x.i,x.Ta=null,x.Ua=0,x.V=a(V),x.Ba=0,x.V==null?(x.a=1,x=0):x=1):(W.ic=0,x=Pe(x,W.c)),!x))break t;x=1;break e}W.mc=null,x=0}else x=xe>=W.c*W.i;W=!x}if(W)return null;m.ga.Lc!=1?m.Ga=0:T=U-N}t(m.ga!=null),t(N+T<=U);e:{if(x=(V=m.ga).c,U=V.l.o,V.$a==0){if(te=m.rc,xe=m.Vc,_e=m.Fa,Y=m.P+1+N*x,ee=m.mb,de=m.nb+N*x,t(Y<=m.P+m.qc),V.Z!=0)for(t(eo[V.Z]!=null),W=0;W<T;++W)eo[V.Z](te,xe,_e,Y,ee,de,x),te=ee,xe=de,de+=x,Y+=x;else for(W=0;W<T;++W)n(ee,de,_e,Y,x),te=ee,xe=de,de+=x,Y+=x;m.rc=te,m.Vc=xe}else{if(t(V.mc!=null),x=N+T,t((W=V.mc)!=null),t(x<=W.i),W.C>=x)x=1;else if(V.ic||qo(),V.ic){V=W.V,te=W.Ba,xe=W.c;var Le=W.i,Ee=(_e=1,Y=W.$/xe,ee=W.$%xe,de=W.m,Te=W.s,W.$),De=xe*Le,Me=xe*x,Ge=Te.wc,ze=Ee<Me?B(Te,ee,Y):null;t(Ee<=De),t(x<=Le),t(Z(Te));t:for(;;){for(;!de.h&&Ee<Me;){if(ee&Ge||(ze=B(Te,ee,Y)),t(ze!=null),fe(de),256>(Le=kr(ze.G[0],ze.H[0],de)))V[te+Ee]=Le,++Ee,++ee>=xe&&(ee=0,++Y<=x&&!(Y%16)&&se(W,Y));else{if(!(280>Le)){_e=0;break t}Le=$n(Le-256,de);var bt,ct=kr(ze.G[4],ze.H[4],de);if(fe(de),!(Ee>=(ct=li(xe,ct=$n(ct,de)))&&De-Ee>=Le)){_e=0;break t}for(bt=0;bt<Le;++bt)V[te+Ee+bt]=V[te+Ee+bt-ct];for(Ee+=Le,ee+=Le;ee>=xe;)ee-=xe,++Y<=x&&!(Y%16)&&se(W,Y);Ee<Me&&ee&Ge&&(ze=B(Te,ee,Y))}t(de.h==M(de))}se(W,Y>x?x:Y);break t}!_e||de.h&&Ee<De?(_e=0,W.a=de.h?5:3):W.$=Ee,x=_e}else x=Ne(W,W.V,W.Ba,W.c,W.i,x,He);if(!x){T=0;break e}}N+T>=U&&(m.Cc=1),T=1}if(!T)return null;if(m.Cc&&((T=m.ga)!=null&&(T.mc=null),m.ga=null,0<m.Ga))return alert("todo:WebPDequantizeLevels"),null}return m.nb+N*D}function us(m,x,N,T,D,U){for(;0<D--;){var W,V=m,Y=x+(N?1:0),ee=m,de=x+(N?0:3);for(W=0;W<T;++W){var Te=ee[de+4*W];Te!=255&&(Te*=32897,V[Y+4*W+0]=V[Y+4*W+0]*Te>>23,V[Y+4*W+1]=V[Y+4*W+1]*Te>>23,V[Y+4*W+2]=V[Y+4*W+2]*Te>>23)}x+=U}}function Ks(m,x,N,T,D){for(;0<T--;){var U;for(U=0;U<N;++U){var W=m[x+2*U+0],V=15&(ee=m[x+2*U+1]),Y=4369*V,ee=(240&ee|ee>>4)*Y>>16;m[x+2*U+0]=(240&W|W>>4)*Y>>16&240|(15&W|W<<4)*Y>>16>>4&15,m[x+2*U+1]=240&ee|V}x+=D}}function Kp(m,x,N,T,D,U,W,V){var Y,ee,de=255;for(ee=0;ee<D;++ee){for(Y=0;Y<T;++Y){var Te=m[x+Y];U[W+4*Y]=Te,de&=Te}x+=N,W+=V}return de!=255}function y0(m,x,N,T,D){var U;for(U=0;U<D;++U)N[T+U]=m[x+U]>>8}function qo(){ku=us,yx=Ks,bx=Kp,wx=y0}function xa(m,x,N){k[m]=function(T,D,U,W,V,Y,ee,de,Te,te,xe,_e,Le,Ee,De,Me,Ge){var ze,bt=Ge-1>>1,ct=V[Y+0]|ee[de+0]<<16,Mt=Te[te+0]|xe[_e+0]<<16;t(T!=null);var gt=3*ct+Mt+131074>>2;for(x(T[D+0],255&gt,gt>>16,Le,Ee),U!=null&&(gt=3*Mt+ct+131074>>2,x(U[W+0],255&gt,gt>>16,De,Me)),ze=1;ze<=bt;++ze){var Ht=V[Y+ze]|ee[de+ze]<<16,fn=Te[te+ze]|xe[_e+ze]<<16,Rt=ct+Ht+Mt+fn+524296,vt=Rt+2*(Ht+Mt)>>3;gt=vt+ct>>1,ct=(Rt=Rt+2*(ct+fn)>>3)+Ht>>1,x(T[D+2*ze-1],255&gt,gt>>16,Le,Ee+(2*ze-1)*N),x(T[D+2*ze-0],255&ct,ct>>16,Le,Ee+(2*ze-0)*N),U!=null&&(gt=Rt+Mt>>1,ct=vt+fn>>1,x(U[W+2*ze-1],255&gt,gt>>16,De,Me+(2*ze-1)*N),x(U[W+2*ze+0],255&ct,ct>>16,De,Me+(2*ze+0)*N)),ct=Ht,Mt=fn}1&Ge||(gt=3*ct+Mt+131074>>2,x(T[D+Ge-1],255&gt,gt>>16,Le,Ee+(Ge-1)*N),U!=null&&(gt=3*Mt+ct+131074>>2,x(U[W+Ge-1],255&gt,gt>>16,De,Me+(Ge-1)*N)))}}function _u(){Zi[N0]=OT,Zi[S0]=Ox,Zi[Tx]=LT,Zi[A0]=Lx,Zi[E0]=Fx,Zi[Zp]=Dx,Zi[Px]=FT,Zi[Jp]=Ox,Zi[Qp]=Lx,Zi[T0]=Fx,Zi[e1]=Dx}function ql(m){return m&~DT?0>m?0:255:m>>Ix}function Ys(m,x){return ql((19077*m>>8)+(26149*x>>8)-14234)}function xn(m,x,N){return ql((19077*m>>8)-(6419*x>>8)-(13320*N>>8)+8708)}function fs(m,x){return ql((19077*m>>8)+(33050*x>>8)-17685)}function hs(m,x,N,T,D){T[D+0]=Ys(m,N),T[D+1]=xn(m,x,N),T[D+2]=fs(m,x)}function Hl(m,x,N,T,D){T[D+0]=fs(m,x),T[D+1]=xn(m,x,N),T[D+2]=Ys(m,N)}function Nu(m,x,N,T,D){var U=xn(m,x,N);x=U<<3&224|fs(m,x)>>3,T[D+0]=248&Ys(m,N)|U>>5,T[D+1]=x}function Qn(m,x,N,T,D){var U=240&fs(m,x)|15;T[D+0]=240&Ys(m,N)|xn(m,x,N)>>4,T[D+1]=U}function b0(m,x,N,T,D){T[D+0]=255,hs(m,x,N,T,D+1)}function Gl(m,x,N,T,D){Hl(m,x,N,T,D),T[D+3]=255}function w0(m,x,N,T,D){hs(m,x,N,T,D),T[D+3]=255}function un(m,x){return 0>m?0:m>x?x:m}function Yi(m,x,N){k[m]=function(T,D,U,W,V,Y,ee,de,Te){for(var te=de+(-2&Te)*N;de!=te;)x(T[D+0],U[W+0],V[Y+0],ee,de),x(T[D+1],U[W+0],V[Y+0],ee,de+N),D+=2,++W,++Y,de+=2*N;1&Te&&x(T[D+0],U[W+0],V[Y+0],ee,de)}}function Su(m,x,N){return N==0?m==0?x==0?6:5:x==0?4:0:N}function Au(m,x,N,T,D){switch(m>>>30){case 3:Gr(x,N,T,D,0);break;case 2:ps(x,N,T,D);break;case 1:Ha(x,N,T,D)}}function Xs(m,x){var N,T,D=x.M,U=x.Nb,W=m.oc,V=m.pc+40,Y=m.oc,ee=m.pc+584,de=m.oc,Te=m.pc+600;for(N=0;16>N;++N)W[V+32*N-1]=129;for(N=0;8>N;++N)Y[ee+32*N-1]=129,de[Te+32*N-1]=129;for(0<D?W[V-1-32]=Y[ee-1-32]=de[Te-1-32]=129:(i(W,V-32-1,127,21),i(Y,ee-32-1,127,9),i(de,Te-32-1,127,9)),T=0;T<m.za;++T){var te=x.ya[x.aa+T];if(0<T){for(N=-1;16>N;++N)n(W,V+32*N-4,W,V+32*N+12,4);for(N=-1;8>N;++N)n(Y,ee+32*N-4,Y,ee+32*N+4,4),n(de,Te+32*N-4,de,Te+32*N+4,4)}var xe=m.Gd,_e=m.Hd+T,Le=te.ad,Ee=te.Hc;if(0<D&&(n(W,V-32,xe[_e].y,0,16),n(Y,ee-32,xe[_e].f,0,8),n(de,Te-32,xe[_e].ea,0,8)),te.Za){var De=W,Me=V-32+16;for(0<D&&(T>=m.za-1?i(De,Me,xe[_e].y[15],4):n(De,Me,xe[_e+1].y,0,4)),N=0;4>N;N++)De[Me+128+N]=De[Me+256+N]=De[Me+384+N]=De[Me+0+N];for(N=0;16>N;++N,Ee<<=2)De=W,Me=V+Rx[N],ya[te.Ob[N]](De,Me),Au(Ee,Le,16*+N,De,Me)}else if(De=Su(T,D,te.Ob[0]),Qs[De](W,V),Ee!=0)for(N=0;16>N;++N,Ee<<=2)Au(Ee,Le,16*+N,W,V+Rx[N]);for(N=te.Gc,De=Su(T,D,te.Dd),ms[De](Y,ee),ms[De](de,Te),Ee=Le,De=Y,Me=ee,255&(te=0|N)&&(170&te?Zl(Ee,256,De,Me):ju(Ee,256,De,Me)),te=de,Ee=Te,255&(N>>=8)&&(170&N?Zl(Le,320,te,Ee):ju(Le,320,te,Ee)),D<m.Ub-1&&(n(xe[_e].y,0,W,V+480,16),n(xe[_e].f,0,Y,ee+224,8),n(xe[_e].ea,0,de,Te+224,8)),N=8*U*m.B,xe=m.sa,_e=m.ta+16*T+16*U*m.R,Le=m.qa,te=m.ra+8*T+N,Ee=m.Ha,De=m.Ia+8*T+N,N=0;16>N;++N)n(xe,_e+N*m.R,W,V+32*N,16);for(N=0;8>N;++N)n(Le,te+N*m.B,Y,ee+32*N,8),n(Ee,De+N*m.B,de,Te+32*N,8)}}function Vl(m,x,N,T,D,U,W,V,Y){var ee=[0],de=[0],Te=0,te=Y!=null?Y.kd:0,xe=Y??new jt;if(m==null||12>N)return 7;xe.data=m,xe.w=x,xe.ha=N,x=[x],N=[N],xe.gb=[xe.gb];e:{var _e=x,Le=N,Ee=xe.gb;if(t(m!=null),t(Le!=null),t(Ee!=null),Ee[0]=0,12<=Le[0]&&!r(m,_e[0],"RIFF")){if(r(m,_e[0]+8,"WEBP")){Ee=3;break e}var De=ge(m,_e[0]+4);if(12>De||4294967286<De){Ee=3;break e}if(te&&De>Le[0]-8){Ee=7;break e}Ee[0]=De,_e[0]+=12,Le[0]-=12}Ee=0}if(Ee!=0)return Ee;for(De=0<xe.gb[0],N=N[0];;){e:{var Me=m;Le=x,Ee=N;var Ge=ee,ze=de,bt=_e=[0];if((gt=Te=[Te])[0]=0,8>Ee[0])Ee=7;else{if(!r(Me,Le[0],"VP8X")){if(ge(Me,Le[0]+4)!=10){Ee=3;break e}if(18>Ee[0]){Ee=7;break e}var ct=ge(Me,Le[0]+8),Mt=1+Be(Me,Le[0]+12);if(2147483648<=Mt*(Me=1+Be(Me,Le[0]+15))){Ee=3;break e}bt!=null&&(bt[0]=ct),Ge!=null&&(Ge[0]=Mt),ze!=null&&(ze[0]=Me),Le[0]+=18,Ee[0]-=18,gt[0]=1}Ee=0}}if(Te=Te[0],_e=_e[0],Ee!=0)return Ee;if(Le=!!(2&_e),!De&&Te)return 3;if(U!=null&&(U[0]=!!(16&_e)),W!=null&&(W[0]=Le),V!=null&&(V[0]=0),W=ee[0],_e=de[0],Te&&Le&&Y==null){Ee=0;break}if(4>N){Ee=7;break}if(De&&Te||!De&&!Te&&!r(m,x[0],"ALPH")){N=[N],xe.na=[xe.na],xe.P=[xe.P],xe.Sa=[xe.Sa];e:{ct=m,Ee=x,De=N;var gt=xe.gb;Ge=xe.na,ze=xe.P,bt=xe.Sa,Mt=22,t(ct!=null),t(De!=null),Me=Ee[0];var Ht=De[0];for(t(Ge!=null),t(bt!=null),Ge[0]=null,ze[0]=null,bt[0]=0;;){if(Ee[0]=Me,De[0]=Ht,8>Ht){Ee=7;break e}var fn=ge(ct,Me+4);if(4294967286<fn){Ee=3;break e}var Rt=8+fn+1&-2;if(Mt+=Rt,0<gt&&Mt>gt){Ee=3;break e}if(!r(ct,Me,"VP8 ")||!r(ct,Me,"VP8L")){Ee=0;break e}if(Ht[0]<Rt){Ee=7;break e}r(ct,Me,"ALPH")||(Ge[0]=ct,ze[0]=Me+8,bt[0]=fn),Me+=Rt,Ht-=Rt}}if(N=N[0],xe.na=xe.na[0],xe.P=xe.P[0],xe.Sa=xe.Sa[0],Ee!=0)break}N=[N],xe.Ja=[xe.Ja],xe.xa=[xe.xa];e:if(gt=m,Ee=x,De=N,Ge=xe.gb[0],ze=xe.Ja,bt=xe.xa,ct=Ee[0],Me=!r(gt,ct,"VP8 "),Mt=!r(gt,ct,"VP8L"),t(gt!=null),t(De!=null),t(ze!=null),t(bt!=null),8>De[0])Ee=7;else{if(Me||Mt){if(gt=ge(gt,ct+4),12<=Ge&&gt>Ge-12){Ee=3;break e}if(te&&gt>De[0]-8){Ee=7;break e}ze[0]=gt,Ee[0]+=8,De[0]-=8,bt[0]=Mt}else bt[0]=5<=De[0]&&gt[ct+0]==47&&!(gt[ct+4]>>5),ze[0]=De[0];Ee=0}if(N=N[0],xe.Ja=xe.Ja[0],xe.xa=xe.xa[0],x=x[0],Ee!=0)break;if(4294967286<xe.Ja)return 3;if(V==null||Le||(V[0]=xe.xa?2:1),W=[W],_e=[_e],xe.xa){if(5>N){Ee=7;break}V=W,te=_e,Le=U,m==null||5>N?m=0:5<=N&&m[x+0]==47&&!(m[x+4]>>5)?(De=[0],gt=[0],Ge=[0],be(ze=new F,m,x,N),ma(ze,De,gt,Ge)?(V!=null&&(V[0]=De[0]),te!=null&&(te[0]=gt[0]),Le!=null&&(Le[0]=Ge[0]),m=1):m=0):m=0}else{if(10>N){Ee=7;break}V=_e,m==null||10>N||!m0(m,x+3,N-3)?m=0:(te=m[x+0]|m[x+1]<<8|m[x+2]<<16,Le=16383&(m[x+7]<<8|m[x+6]),m=16383&(m[x+9]<<8|m[x+8]),1&te||3<(te>>1&7)||!(te>>4&1)||te>>5>=xe.Ja||!Le||!m?m=0:(W&&(W[0]=Le),V&&(V[0]=m),m=1))}if(!m||(W=W[0],_e=_e[0],Te&&(ee[0]!=W||de[0]!=_e)))return 3;Y!=null&&(Y[0]=xe,Y.offset=x-Y.w,t(4294967286>x-Y.w),t(Y.offset==Y.ha-N));break}return Ee==0||Ee==7&&Te&&Y==null?(U!=null&&(U[0]|=xe.na!=null&&0<xe.na.length),T!=null&&(T[0]=W),D!=null&&(D[0]=_e),0):Ee}function ci(m,x,N){var T=x.width,D=x.height,U=0,W=0,V=T,Y=D;if(x.Da=m!=null&&0<m.Da,x.Da&&(V=m.cd,Y=m.bd,U=m.v,W=m.j,11>N||(U&=-2,W&=-2),0>U||0>W||0>=V||0>=Y||U+V>T||W+Y>D))return 0;if(x.v=U,x.j=W,x.va=U+V,x.o=W+Y,x.U=V,x.T=Y,x.da=m!=null&&0<m.da,x.da){if(!it(V,Y,N=[m.ib],U=[m.hb]))return 0;x.ib=N[0],x.hb=U[0]}return x.ob=m!=null&&m.ob,x.Kb=m==null||!m.Sd,x.da&&(x.ob=x.ib<3*T/4&&x.hb<3*D/4,x.Kb=0),1}function ui(m){if(m==null)return 2;if(11>m.S){var x=m.f.RGBA;x.fb+=(m.height-1)*x.A,x.A=-x.A}else x=m.f.kb,m=m.height,x.O+=(m-1)*x.fa,x.fa=-x.fa,x.N+=(m-1>>1)*x.Ab,x.Ab=-x.Ab,x.W+=(m-1>>1)*x.Db,x.Db=-x.Db,x.F!=null&&(x.J+=(m-1)*x.lb,x.lb=-x.lb);return 0}function Ho(m,x,N,T){if(T==null||0>=m||0>=x)return 2;if(N!=null){if(N.Da){var D=N.cd,U=N.bd,W=-2&N.v,V=-2&N.j;if(0>W||0>V||0>=D||0>=U||W+D>m||V+U>x)return 2;m=D,x=U}if(N.da){if(!it(m,x,D=[N.ib],U=[N.hb]))return 2;m=D[0],x=U[0]}}T.width=m,T.height=x;e:{var Y=T.width,ee=T.height;if(m=T.S,0>=Y||0>=ee||!(m>=N0&&13>m))m=2;else{if(0>=T.Rd&&T.sd==null){W=U=D=x=0;var de=(V=Y*Bx[m])*ee;if(11>m||(U=(ee+1)/2*(x=(Y+1)/2),m==12&&(W=(D=Y)*ee)),(ee=a(de+2*U+W))==null){m=1;break e}T.sd=ee,11>m?((Y=T.f.RGBA).eb=ee,Y.fb=0,Y.A=V,Y.size=de):((Y=T.f.kb).y=ee,Y.O=0,Y.fa=V,Y.Fd=de,Y.f=ee,Y.N=0+de,Y.Ab=x,Y.Cd=U,Y.ea=ee,Y.W=0+de+U,Y.Db=x,Y.Ed=U,m==12&&(Y.F=ee,Y.J=0+de+2*U),Y.Tc=W,Y.lb=D)}if(x=1,D=T.S,U=T.width,W=T.height,D>=N0&&13>D)if(11>D)m=T.f.RGBA,x&=(V=Math.abs(m.A))*(W-1)+U<=m.size,x&=V>=U*Bx[D],x&=m.eb!=null;else{m=T.f.kb,V=(U+1)/2,de=(W+1)/2,Y=Math.abs(m.fa),ee=Math.abs(m.Ab);var Te=Math.abs(m.Db),te=Math.abs(m.lb),xe=te*(W-1)+U;x&=Y*(W-1)+U<=m.Fd,x&=ee*(de-1)+V<=m.Cd,x=(x&=Te*(de-1)+V<=m.Ed)&Y>=U&ee>=V&Te>=V,x&=m.y!=null,x&=m.f!=null,x&=m.ea!=null,D==12&&(x&=te>=U,x&=xe<=m.Tc,x&=m.F!=null)}else x=0;m=x?0:2}}return m!=0||N!=null&&N.fd&&(m=ui(T)),m}var $a=64,Zs=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Eu=24,Js=32,qr=8,Yp=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ze("Predictor0","PredictorAdd0"),k.Predictor0=function(){return 4278190080},k.Predictor1=function(m){return m},k.Predictor2=function(m,x,N){return x[N+0]},k.Predictor3=function(m,x,N){return x[N+1]},k.Predictor4=function(m,x,N){return x[N-1]},k.Predictor5=function(m,x,N){return ft(ft(m,x[N+1]),x[N+0])},k.Predictor6=function(m,x,N){return ft(m,x[N-1])},k.Predictor7=function(m,x,N){return ft(m,x[N+0])},k.Predictor8=function(m,x,N){return ft(x[N-1],x[N+0])},k.Predictor9=function(m,x,N){return ft(x[N+0],x[N+1])},k.Predictor10=function(m,x,N){return ft(ft(m,x[N-1]),ft(x[N+0],x[N+1]))},k.Predictor11=function(m,x,N){var T=x[N+0];return 0>=Et(T>>24&255,m>>24&255,(x=x[N-1])>>24&255)+Et(T>>16&255,m>>16&255,x>>16&255)+Et(T>>8&255,m>>8&255,x>>8&255)+Et(255&T,255&m,255&x)?T:m},k.Predictor12=function(m,x,N){var T=x[N+0];return(Lt((m>>24&255)+(T>>24&255)-((x=x[N-1])>>24&255))<<24|Lt((m>>16&255)+(T>>16&255)-(x>>16&255))<<16|Lt((m>>8&255)+(T>>8&255)-(x>>8&255))<<8|Lt((255&m)+(255&T)-(255&x)))>>>0},k.Predictor13=function(m,x,N){var T=x[N-1];return(At((m=ft(m,x[N+0]))>>24&255,T>>24&255)<<24|At(m>>16&255,T>>16&255)<<16|At(m>>8&255,T>>8&255)<<8|At(255&m,255&T))>>>0};var za=k.PredictorAdd0;k.PredictorAdd1=Kt,Ze("Predictor2","PredictorAdd2"),Ze("Predictor3","PredictorAdd3"),Ze("Predictor4","PredictorAdd4"),Ze("Predictor5","PredictorAdd5"),Ze("Predictor6","PredictorAdd6"),Ze("Predictor7","PredictorAdd7"),Ze("Predictor8","PredictorAdd8"),Ze("Predictor9","PredictorAdd9"),Ze("Predictor10","PredictorAdd10"),Ze("Predictor11","PredictorAdd11"),Ze("Predictor12","PredictorAdd12"),Ze("Predictor13","PredictorAdd13");var Wa=k.PredictorAdd2;mt("ColorIndexInverseTransform","MapARGB","32b",function(m){return m>>8&255},function(m){return m}),mt("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(m){return m},function(m){return m>>8&255});var Kl,Tu=k.ColorIndexInverseTransform,Yl=k.MapARGB,Xl=k.VP8LColorIndexInverseTransformAlpha,Go=k.MapAlpha,Vo=k.VP8LPredictorsAdd=[];Vo.length=16,(k.VP8LPredictors=[]).length=16,(k.VP8LPredictorsAdd_C=[]).length=16,(k.VP8LPredictors_C=[]).length=16;var ds,Pu,_i,qa,wr,_r,Hr,Gr,ps,Zl,Ha,ju,ox,lx,cx,ux,fx,hx,dx,px,mx,gx,vx,xx,ku,yx,bx,wx,_x=a(511),Nx=a(2041),Sx=a(225),Ax=a(767),Ex=0,Xp=Nx,_0=Sx,Ni=Ax,Xi=_x,N0=0,S0=1,Tx=2,A0=3,E0=4,Zp=5,Px=6,Jp=7,Qp=8,T0=9,e1=10,xT=[2,3,7],yT=[3,3,11],jx=[280,256,256,256,40],bT=[0,1,1,1,0],wT=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],_T=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],NT=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],ST=8,t1=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],r1=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Cu=null,AT=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],ET=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],kx=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],TT=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],PT=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],jT=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],kT=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Qs=[],ya=[],ms=[],CT=1,Cx=2,eo=[],Zi=[];xa("UpsampleRgbLinePair",hs,3),xa("UpsampleBgrLinePair",Hl,3),xa("UpsampleRgbaLinePair",w0,4),xa("UpsampleBgraLinePair",Gl,4),xa("UpsampleArgbLinePair",b0,4),xa("UpsampleRgba4444LinePair",Qn,2),xa("UpsampleRgb565LinePair",Nu,2);var OT=k.UpsampleRgbLinePair,LT=k.UpsampleBgrLinePair,Ox=k.UpsampleRgbaLinePair,Lx=k.UpsampleBgraLinePair,Fx=k.UpsampleArgbLinePair,Dx=k.UpsampleRgba4444LinePair,FT=k.UpsampleRgb565LinePair,P0=16,j0=1<<P0-1,Ou=-227,n1=482,Ix=6,DT=(256<<Ix)-1,Mx=0,IT=a(256),MT=a(256),RT=a(256),BT=a(256),UT=a(n1-Ou),$T=a(n1-Ou);Yi("YuvToRgbRow",hs,3),Yi("YuvToBgrRow",Hl,3),Yi("YuvToRgbaRow",w0,4),Yi("YuvToBgraRow",Gl,4),Yi("YuvToArgbRow",b0,4),Yi("YuvToRgba4444Row",Qn,2),Yi("YuvToRgb565Row",Nu,2);var Rx=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],k0=[0,2,8],zT=[8,7,6,4,4,2,2,2,1,1,1,1],WT=1;this.WebPDecodeRGBA=function(m,x,N,T,D){var U=S0,W=new xt,V=new zt;W.ba=V,V.S=U,V.width=[V.width],V.height=[V.height];var Y=V.width,ee=V.height,de=new at;if(de==null||m==null)var Te=2;else t(de!=null),Te=Vl(m,x,N,de.width,de.height,de.Pd,de.Qd,de.format,null);if(Te!=0?Y=0:(Y!=null&&(Y[0]=de.width[0]),ee!=null&&(ee[0]=de.height[0]),Y=1),Y){V.width=V.width[0],V.height=V.height[0],T!=null&&(T[0]=V.width),D!=null&&(D[0]=V.height);e:{if(T=new zn,(D=new jt).data=m,D.w=x,D.ha=N,D.kd=1,x=[0],t(D!=null),((m=Vl(D.data,D.w,D.ha,null,null,null,x,null,D))==0||m==7)&&x[0]&&(m=4),(x=m)==0){if(t(W!=null),T.data=D.data,T.w=D.w+D.offset,T.ha=D.ha-D.offset,T.put=Nt,T.ac=Vi,T.bc=pa,T.ma=W,D.xa){if((m=Se())==null){W=1;break e}if(function(te,xe){var _e=[0],Le=[0],Ee=[0];t:for(;;){if(te==null)return 0;if(xe==null)return te.a=2,0;if(te.l=xe,te.a=0,be(te.m,xe.data,xe.w,xe.ha),!ma(te.m,_e,Le,Ee)){te.a=3;break t}if(te.xb=Cx,xe.width=_e[0],xe.height=Le[0],!Ae(_e[0],Le[0],1,te,null))break t;return 1}return t(te.a!=0),0}(m,T)){if(T=(x=Ho(T.width,T.height,W.Oa,W.ba))==0){t:{T=m;r:for(;;){if(T==null){T=0;break t}if(t(T.s.yc!=null),t(T.s.Ya!=null),t(0<T.s.Wb),t((N=T.l)!=null),t((D=N.ma)!=null),T.xb!=0){if(T.ca=D.ba,T.tb=D.tb,t(T.ca!=null),!ci(D.Oa,N,A0)){T.a=2;break r}if(!Pe(T,N.width)||N.da)break r;if((N.da||St(T.ca.S))&&qo(),11>T.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),T.ca.f.kb.F!=null&&qo()),T.Pb&&0<T.s.ua&&T.s.vb.X==null&&!Q(T.s.vb,T.s.Wa.Xa)){T.a=1;break r}T.xb=0}if(!Ne(T,T.V,T.Ba,T.c,T.i,N.o,K))break r;D.Dc=T.Ma,T=1;break t}t(T.a!=0),T=0}T=!T}T&&(x=m.a)}else x=m.a}else{if((m=new Lp)==null){W=1;break e}if(m.Fa=D.na,m.P=D.P,m.qc=D.Sa,g0(m,T)){if((x=Ho(T.width,T.height,W.Oa,W.ba))==0){if(m.Aa=0,N=W.Oa,t((D=m)!=null),N!=null){if(0<(Y=0>(Y=N.Md)?0:100<Y?255:255*Y/100)){for(ee=de=0;4>ee;++ee)12>(Te=D.pb[ee]).lc&&(Te.ia=Y*zT[0>Te.lc?0:Te.lc]>>3),de|=Te.ia;de&&(alert("todo:VP8InitRandom"),D.ia=1)}D.Ga=N.Id,100<D.Ga?D.Ga=100:0>D.Ga&&(D.Ga=0)}(function(te,xe){if(te==null)return 0;if(xe==null)return en(te,2,"NULL VP8Io parameter in VP8Decode().");if(!te.cb&&!g0(te,xe))return 0;if(t(te.cb),xe.ac==null||xe.ac(xe)){xe.ob&&(te.L=0);var _e=k0[te.L];if(te.L==2?(te.yb=0,te.zb=0):(te.yb=xe.v-_e>>4,te.zb=xe.j-_e>>4,0>te.yb&&(te.yb=0),0>te.zb&&(te.zb=0)),te.Va=xe.o+15+_e>>4,te.Hb=xe.va+15+_e>>4,te.Hb>te.za&&(te.Hb=te.za),te.Va>te.Ub&&(te.Va=te.Ub),0<te.L){var Le=te.ed;for(_e=0;4>_e;++_e){var Ee;if(te.Qa.Cb){var De=te.Qa.Lb[_e];te.Qa.Fb||(De+=Le.Tb)}else De=Le.Tb;for(Ee=0;1>=Ee;++Ee){var Me=te.gd[_e][Ee],Ge=De;if(Le.Pc&&(Ge+=Le.vd[0],Ee&&(Ge+=Le.od[0])),0<(Ge=0>Ge?0:63<Ge?63:Ge)){var ze=Ge;0<Le.wb&&(ze=4<Le.wb?ze>>2:ze>>1)>9-Le.wb&&(ze=9-Le.wb),1>ze&&(ze=1),Me.dd=ze,Me.tc=2*Ge+ze,Me.ld=40<=Ge?2:15<=Ge?1:0}else Me.tc=0;Me.La=Ee}}}_e=0}else en(te,6,"Frame setup failed"),_e=te.a;if(_e=_e==0){if(_e){te.$c=0,0<te.Aa||(te.Ic=WT);t:{_e=te.Ic,Le=4*(ze=te.za);var bt=32*ze,ct=ze+1,Mt=0<te.L?ze*(0<te.Aa?2:1):0,gt=(te.Aa==2?2:1)*ze;if((Me=Le+832+(Ee=3*(16*_e+k0[te.L])/2*bt)+(De=te.Fa!=null&&0<te.Fa.length?te.Kc.c*te.Kc.i:0))!=Me)_e=0;else{if(Me>te.Vb){if(te.Vb=0,te.Ec=a(Me),te.Fc=0,te.Ec==null){_e=en(te,1,"no memory during frame initialization.");break t}te.Vb=Me}Me=te.Ec,Ge=te.Fc,te.Ac=Me,te.Bc=Ge,Ge+=Le,te.Gd=s(bt,Ki),te.Hd=0,te.rb=s(ct+1,Ir),te.sb=1,te.wa=Mt?s(Mt,Wt):null,te.Y=0,te.D.Nb=0,te.D.wa=te.wa,te.D.Y=te.Y,0<te.Aa&&(te.D.Y+=ze),t(!0),te.oc=Me,te.pc=Ge,Ge+=832,te.ya=s(gt,ga),te.aa=0,te.D.ya=te.ya,te.D.aa=te.aa,te.Aa==2&&(te.D.aa+=ze),te.R=16*ze,te.B=8*ze,ze=(bt=k0[te.L])*te.R,bt=bt/2*te.B,te.sa=Me,te.ta=Ge+ze,te.qa=te.sa,te.ra=te.ta+16*_e*te.R+bt,te.Ha=te.qa,te.Ia=te.ra+8*_e*te.B+bt,te.$c=0,Ge+=Ee,te.mb=De?Me:null,te.nb=De?Ge:null,t(Ge+De<=te.Fc+te.Vb),Io(te),i(te.Ac,te.Bc,0,Le),_e=1}}if(_e){if(xe.ka=0,xe.y=te.sa,xe.O=te.ta,xe.f=te.qa,xe.N=te.ra,xe.ea=te.Ha,xe.Vd=te.Ia,xe.fa=te.R,xe.Rc=te.B,xe.F=null,xe.J=0,!Ex){for(_e=-255;255>=_e;++_e)_x[255+_e]=0>_e?-_e:_e;for(_e=-1020;1020>=_e;++_e)Nx[1020+_e]=-128>_e?-128:127<_e?127:_e;for(_e=-112;112>=_e;++_e)Sx[112+_e]=-16>_e?-16:15<_e?15:_e;for(_e=-255;510>=_e;++_e)Ax[255+_e]=0>_e?0:255<_e?255:_e;Ex=1}Hr=x0,Gr=Dp,Zl=Ip,Ha=Ba,ju=v0,ps=Fp,ox=w,lx=I,cx=we,ux=Ie,fx=ie,hx=he,dx=qe,px=dt,mx=yu,gx=Wo,vx=bu,xx=wu,ya[0]=Wp,ya[1]=hu,ya[2]=$p,ya[3]=zp,ya[4]=qp,ya[5]=cs,ya[6]=ls,ya[7]=Hp,ya[8]=Ul,ya[9]=Gp,Qs[0]=Vs,Qs[1]=Rp,Qs[2]=Bp,Qs[3]=du,Qs[4]=Up,Qs[5]=Bo,Qs[6]=pu,ms[0]=zl,ms[1]=Mp,ms[2]=mu,ms[3]=Uo,ms[4]=gu,ms[5]=Vp,ms[6]=vu,_e=1}else _e=0}_e&&(_e=function(Ht,fn){for(Ht.M=0;Ht.M<Ht.Va;++Ht.M){var Rt,vt=Ht.Jc[Ht.M&Ht.Xb],Je=Ht.m,Vr=Ht;for(Rt=0;Rt<Vr.za;++Rt){var Dt=Je,Yt=Vr,Er=Yt.Ac,jn=Yt.Bc+4*Rt,ei=Yt.zc,Mr=Yt.ya[Yt.aa+Rt];if(Yt.Qa.Bb?Mr.$b=ue(Dt,Yt.Pa.jb[0])?2+ue(Dt,Yt.Pa.jb[2]):ue(Dt,Yt.Pa.jb[1]):Mr.$b=0,Yt.kc&&(Mr.Ad=ue(Dt,Yt.Bd)),Mr.Za=!ue(Dt,145)+0,Mr.Za){var Wn=Mr.Ob,ti=0;for(Yt=0;4>Yt;++Yt){var hn,Xt=ei[0+Yt];for(hn=0;4>hn;++hn){Xt=PT[Er[jn+hn]][Xt];for(var sr=kx[ue(Dt,Xt[0])];0<sr;)sr=kx[2*sr+ue(Dt,Xt[sr])];Xt=-sr,Er[jn+hn]=Xt}n(Wn,ti,Er,jn,4),ti+=4,ei[0+Yt]=Xt}}else Xt=ue(Dt,156)?ue(Dt,128)?1:3:ue(Dt,163)?2:0,Mr.Ob[0]=Xt,i(Er,jn,Xt,4),i(ei,0,Xt,4);Mr.Dd=ue(Dt,142)?ue(Dt,114)?ue(Dt,183)?1:3:2:0}if(Vr.m.Ka)return en(Ht,7,"Premature end-of-partition0 encountered.");for(;Ht.ja<Ht.za;++Ht.ja){if(Vr=vt,Dt=(Je=Ht).rb[Je.sb-1],Er=Je.rb[Je.sb+Je.ja],Rt=Je.ya[Je.aa+Je.ja],jn=Je.kc?Rt.Ad:0)Dt.la=Er.la=0,Rt.Za||(Dt.Na=Er.Na=0),Rt.Hc=0,Rt.Gc=0,Rt.ia=0;else{var Rr,or;if(Dt=Er,Er=Vr,jn=Je.Pa.Xc,ei=Je.ya[Je.aa+Je.ja],Mr=Je.pb[ei.$b],Yt=ei.ad,Wn=0,ti=Je.rb[Je.sb-1],Xt=hn=0,i(Yt,Wn,0,384),ei.Za)var kn=0,ba=jn[3];else{sr=a(16);var Kr=Dt.Na+ti.Na;if(Kr=Cu(Er,jn[1],Kr,Mr.Eb,0,sr,0),Dt.Na=ti.Na=(0<Kr)+0,1<Kr)Hr(sr,0,Yt,Wn);else{var fi=sr[0]+3>>3;for(sr=0;256>sr;sr+=16)Yt[Wn+sr]=fi}kn=1,ba=jn[0]}var vr=15&Dt.la,dn=15&ti.la;for(sr=0;4>sr;++sr){var Si=1&dn;for(fi=or=0;4>fi;++fi)vr=vr>>1|(Si=(Kr=Cu(Er,ba,Kr=Si+(1&vr),Mr.Sc,kn,Yt,Wn))>kn)<<7,or=or<<2|(3<Kr?3:1<Kr?2:Yt[Wn+0]!=0),Wn+=16;vr>>=4,dn=dn>>1|Si<<7,hn=(hn<<8|or)>>>0}for(ba=vr,kn=dn>>4,Rr=0;4>Rr;Rr+=2){for(or=0,vr=Dt.la>>4+Rr,dn=ti.la>>4+Rr,sr=0;2>sr;++sr){for(Si=1&dn,fi=0;2>fi;++fi)Kr=Si+(1&vr),vr=vr>>1|(Si=0<(Kr=Cu(Er,jn[2],Kr,Mr.Qc,0,Yt,Wn)))<<3,or=or<<2|(3<Kr?3:1<Kr?2:Yt[Wn+0]!=0),Wn+=16;vr>>=2,dn=dn>>1|Si<<5}Xt|=or<<4*Rr,ba|=vr<<4<<Rr,kn|=(240&dn)<<Rr}Dt.la=ba,ti.la=kn,ei.Hc=hn,ei.Gc=Xt,ei.ia=43690&Xt?0:Mr.ia,jn=!(hn|Xt)}if(0<Je.L&&(Je.wa[Je.Y+Je.ja]=Je.gd[Rt.$b][Rt.Za],Je.wa[Je.Y+Je.ja].La|=!jn),Vr.Ka)return en(Ht,7,"Premature end-of-file encountered.")}if(Io(Ht),Je=fn,Vr=1,Rt=(vt=Ht).D,Dt=0<vt.L&&vt.M>=vt.zb&&vt.M<=vt.Va,vt.Aa==0)t:{if(Rt.M=vt.M,Rt.uc=Dt,Xs(vt,Rt),Vr=1,Rt=(or=vt.D).Nb,Dt=(Xt=k0[vt.L])*vt.R,Er=Xt/2*vt.B,sr=16*Rt*vt.R,fi=8*Rt*vt.B,jn=vt.sa,ei=vt.ta-Dt+sr,Mr=vt.qa,Yt=vt.ra-Er+fi,Wn=vt.Ha,ti=vt.Ia-Er+fi,dn=(vr=or.M)==0,hn=vr>=vt.Va-1,vt.Aa==2&&Xs(vt,or),or.uc)for(Si=(Kr=vt).D.M,t(Kr.D.uc),or=Kr.yb;or<Kr.Hb;++or){kn=or,ba=Si;var ri=(Ai=(Cn=Kr).D).Nb;Rr=Cn.R;var Ai=Ai.wa[Ai.Y+kn],Ei=Cn.sa,hi=Cn.ta+16*ri*Rr+16*kn,Ti=Ai.dd,Nr=Ai.tc;if(Nr!=0)if(t(3<=Nr),Cn.L==1)0<kn&&gx(Ei,hi,Rr,Nr+4),Ai.La&&xx(Ei,hi,Rr,Nr),0<ba&&mx(Ei,hi,Rr,Nr+4),Ai.La&&vx(Ei,hi,Rr,Nr);else{var Pi=Cn.B,wa=Cn.qa,Ko=Cn.ra+8*ri*Pi+8*kn,gs=Cn.Ha,Cn=Cn.Ia+8*ri*Pi+8*kn;ri=Ai.ld,0<kn&&(lx(Ei,hi,Rr,Nr+4,Ti,ri),ux(wa,Ko,gs,Cn,Pi,Nr+4,Ti,ri)),Ai.La&&(hx(Ei,hi,Rr,Nr,Ti,ri),px(wa,Ko,gs,Cn,Pi,Nr,Ti,ri)),0<ba&&(ox(Ei,hi,Rr,Nr+4,Ti,ri),cx(wa,Ko,gs,Cn,Pi,Nr+4,Ti,ri)),Ai.La&&(fx(Ei,hi,Rr,Nr,Ti,ri),dx(wa,Ko,gs,Cn,Pi,Nr,Ti,ri))}}if(vt.ia&&alert("todo:DitherRow"),Je.put!=null){if(or=16*vr,vr=16*(vr+1),dn?(Je.y=vt.sa,Je.O=vt.ta+sr,Je.f=vt.qa,Je.N=vt.ra+fi,Je.ea=vt.Ha,Je.W=vt.Ia+fi):(or-=Xt,Je.y=jn,Je.O=ei,Je.f=Mr,Je.N=Yt,Je.ea=Wn,Je.W=ti),hn||(vr-=Xt),vr>Je.o&&(vr=Je.o),Je.F=null,Je.J=null,vt.Fa!=null&&0<vt.Fa.length&&or<vr&&(Je.J=Pn(vt,Je,or,vr-or),Je.F=vt.mb,Je.F==null&&Je.F.length==0)){Vr=en(vt,3,"Could not decode alpha data.");break t}or<Je.j&&(Xt=Je.j-or,or=Je.j,t(!(1&Xt)),Je.O+=vt.R*Xt,Je.N+=vt.B*(Xt>>1),Je.W+=vt.B*(Xt>>1),Je.F!=null&&(Je.J+=Je.width*Xt)),or<vr&&(Je.O+=Je.v,Je.N+=Je.v>>1,Je.W+=Je.v>>1,Je.F!=null&&(Je.J+=Je.v),Je.ka=or-Je.j,Je.U=Je.va-Je.v,Je.T=vr-or,Vr=Je.put(Je))}Rt+1!=vt.Ic||hn||(n(vt.sa,vt.ta-Dt,jn,ei+16*vt.R,Dt),n(vt.qa,vt.ra-Er,Mr,Yt+8*vt.B,Er),n(vt.Ha,vt.Ia-Er,Wn,ti+8*vt.B,Er))}if(!Vr)return en(Ht,6,"Output aborted.")}return 1}(te,xe)),xe.bc!=null&&xe.bc(xe),_e&=1}return _e?(te.cb=0,_e):0})(m,T)||(x=m.a)}}else x=m.a}x==0&&W.Oa!=null&&W.Oa.fd&&(x=ui(W.ba))}W=x}U=W!=0?null:11>U?V.f.RGBA.eb:V.f.kb.y}else U=null;return U};var Bx=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function c(k,G){for(var _="",j=0;j<4;j++)_+=String.fromCharCode(k[G++]);return _}function u(k,G){return k[G+0]|k[G+1]<<8}function h(k,G){return(k[G+0]|k[G+1]<<8|k[G+2]<<16)>>>0}function p(k,G){return(k[G+0]|k[G+1]<<8|k[G+2]<<16|k[G+3]<<24)>>>0}new l;var d=[0],v=[0],g=[],y=new l,b=e,E=function(k,G){var _={},j=0,H=!1,X=0,ce=0;if(_.frames=[],!function(A,F){for(var O=0;O<4;O++)if(A[F+O]!="RIFF".charCodeAt(O))return!0;return!1}(k,G)){for(p(k,G+=4),G+=8;G<k.length;){var pe=c(k,G),ye=p(k,G+=4);G+=4;var me=ye+(1&ye);switch(pe){case"VP8 ":case"VP8L":_.frames[j]===void 0&&(_.frames[j]={}),(Fe=_.frames[j]).src_off=H?ce:G-8,Fe.src_size=X+ye+8,j++,H&&(H=!1,X=0,ce=0);break;case"VP8X":(Fe=_.header={}).feature_flags=k[G];var be=G+4;Fe.canvas_width=1+h(k,be),be+=3,Fe.canvas_height=1+h(k,be),be+=3;break;case"ALPH":H=!0,X=me+8,ce=G-8;break;case"ANIM":(Fe=_.header).bgcolor=p(k,G),be=G+4,Fe.loop_count=u(k,be),be+=2;break;case"ANMF":var Ue,Fe;(Fe=_.frames[j]={}).offset_x=2*h(k,G),G+=3,Fe.offset_y=2*h(k,G),G+=3,Fe.width=1+h(k,G),G+=3,Fe.height=1+h(k,G),G+=3,Fe.duration=h(k,G),G+=3,Ue=k[G++],Fe.dispose=1&Ue,Fe.blend=Ue>>1&1}pe!="ANMF"&&(G+=me)}return _}}(b,0);E.response=b,E.rgbaoutput=!0,E.dataurl=!1;var S=E.header?E.header:null,P=E.frames?E.frames:null;if(S){S.loop_counter=S.loop_count,d=[S.canvas_height],v=[S.canvas_width];for(var L=0;L<P.length&&P[L].blend!=0;L++);}var q=P[0],C=y.WebPDecodeRGBA(b,q.src_off,q.src_size,v,d);q.rgba=C,q.imgwidth=v[0],q.imgheight=d[0];for(var R=0;R<v[0]*d[0]*4;R++)g[R]=C[R];return this.width=v,this.height=d,this.data=g,this}(function(e){var t,r,n,i,a,s,o,l,c,u=function(A){return A=A||{},this.isStrokeTransparent=A.isStrokeTransparent||!1,this.strokeOpacity=A.strokeOpacity||1,this.strokeStyle=A.strokeStyle||"#000000",this.fillStyle=A.fillStyle||"#000000",this.isFillTransparent=A.isFillTransparent||!1,this.fillOpacity=A.fillOpacity||1,this.font=A.font||"10px sans-serif",this.textBaseline=A.textBaseline||"alphabetic",this.textAlign=A.textAlign||"left",this.lineWidth=A.lineWidth||1,this.lineJoin=A.lineJoin||"miter",this.lineCap=A.lineCap||"butt",this.path=A.path||[],this.transform=A.transform!==void 0?A.transform.clone():new l,this.globalCompositeOperation=A.globalCompositeOperation||"normal",this.globalAlpha=A.globalAlpha||1,this.clip_path=A.clip_path||[],this.currentPoint=A.currentPoint||new s,this.miterLimit=A.miterLimit||10,this.lastPoint=A.lastPoint||new s,this.lineDashOffset=A.lineDashOffset||0,this.lineDash=A.lineDash||[],this.margin=A.margin||[0,0,0,0],this.prevPageLastElemOffset=A.prevPageLastElemOffset||0,this.ignoreClearRect=typeof A.ignoreClearRect!="boolean"||A.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new h(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,i=this.internal.getHorizontalCoordinate,a=this.internal.getVerticalCoordinate,s=this.internal.Point,o=this.internal.Rectangle,l=this.internal.Matrix,c=new u}]);var h=function(A){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var F=A;Object.defineProperty(this,"pdf",{get:function(){return F}});var O=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return O},set:function(ge){O=!!ge}});var M=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return M},set:function(ge){M=!!ge}});var J=0;Object.defineProperty(this,"posX",{get:function(){return J},set:function(ge){isNaN(ge)||(J=ge)}});var fe=0;Object.defineProperty(this,"posY",{get:function(){return fe},set:function(ge){isNaN(ge)||(fe=ge)}}),Object.defineProperty(this,"margin",{get:function(){return c.margin},set:function(ge){var Q;typeof ge=="number"?Q=[ge,ge,ge,ge]:((Q=new Array(4))[0]=ge[0],Q[1]=ge.length>=2?ge[1]:Q[0],Q[2]=ge.length>=3?ge[2]:Q[0],Q[3]=ge.length>=4?ge[3]:Q[1]),c.margin=Q}});var ve=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ve},set:function(ge){ve=ge}});var ae=0;Object.defineProperty(this,"lastBreak",{get:function(){return ae},set:function(ge){ae=ge}});var ue=[];Object.defineProperty(this,"pageBreaks",{get:function(){return ue},set:function(ge){ue=ge}}),Object.defineProperty(this,"ctx",{get:function(){return c},set:function(ge){ge instanceof u&&(c=ge)}}),Object.defineProperty(this,"path",{get:function(){return c.path},set:function(ge){c.path=ge}});var oe=[];Object.defineProperty(this,"ctxStack",{get:function(){return oe},set:function(ge){oe=ge}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(ge){var Q;Q=p(ge),this.ctx.fillStyle=Q.style,this.ctx.isFillTransparent=Q.a===0,this.ctx.fillOpacity=Q.a,this.pdf.setFillColor(Q.r,Q.g,Q.b,{a:Q.a}),this.pdf.setTextColor(Q.r,Q.g,Q.b,{a:Q.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(ge){var Q=p(ge);this.ctx.strokeStyle=Q.style,this.ctx.isStrokeTransparent=Q.a===0,this.ctx.strokeOpacity=Q.a,Q.a===0?this.pdf.setDrawColor(255,255,255):(Q.a,this.pdf.setDrawColor(Q.r,Q.g,Q.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(ge){["butt","round","square"].indexOf(ge)!==-1&&(this.ctx.lineCap=ge,this.pdf.setLineCap(ge))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(ge){isNaN(ge)||(this.ctx.lineWidth=ge,this.pdf.setLineWidth(ge))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(ge){["bevel","round","miter"].indexOf(ge)!==-1&&(this.ctx.lineJoin=ge,this.pdf.setLineJoin(ge))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(ge){isNaN(ge)||(this.ctx.miterLimit=ge,this.pdf.setMiterLimit(ge))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(ge){this.ctx.textBaseline=ge}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(ge){["right","end","center","left","start"].indexOf(ge)!==-1&&(this.ctx.textAlign=ge)}});var le=null,Be=null;Object.defineProperty(this,"fontFaces",{get:function(){return Be},set:function(ge){le=null,Be=ge}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(ge){var Q;if(this.ctx.font=ge,(Q=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(ge))!==null){var tt=Q[1];Q[2];var Re=Q[3],it=Q[4];Q[5];var We=Q[6],st=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(it)[2];it=Math.floor(st==="px"?parseFloat(it)*this.pdf.internal.scaleFactor:st==="em"?parseFloat(it)*this.pdf.getFontSize():parseFloat(it)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(it);var Ze=function(_t){var mt,Qt,Ut=[],ht=_t.trim();if(ht==="")return bm;if(ht in N_)return[N_[ht]];for(;ht!=="";){switch(Qt=null,mt=(ht=A_(ht)).charAt(0)){case'"':case"'":Qt=CZ(ht.substring(1),mt);break;default:Qt=OZ(ht)}if(Qt===null||(Ut.push(Qt[0]),(ht=A_(Qt[1]))!==""&&ht.charAt(0)!==","))return bm;ht=ht.replace(/^,/,"")}return Ut}(We);if(this.fontFaces){var Pt=function(_t,mt){if(le===null){var Qt=function(Ut){var ht=[];return Object.keys(Ut).forEach(function(je){Ut[je].forEach(function(nt){var ot=null;switch(nt){case"bold":ot={family:je,weight:"bold"};break;case"italic":ot={family:je,style:"italic"};break;case"bolditalic":ot={family:je,weight:"bold",style:"italic"};break;case"":case"normal":ot={family:je}}ot!==null&&(ot.ref={name:je,style:nt},ht.push(ot))})}),ht}(_t.getFontList());le=function(Ut){for(var ht={},je=0;je<Ut.length;++je){var nt=ym(Ut[je]),ot=nt.family,Ct=nt.stretch,St=nt.style,ir=nt.weight;ht[ot]=ht[ot]||{},ht[ot][Ct]=ht[ot][Ct]||{},ht[ot][Ct][St]=ht[ot][Ct][St]||{},ht[ot][Ct][St][ir]=nt}return ht}(Qt.concat(mt))}return le}(this.pdf,this.fontFaces),ft=Ze.map(function(_t){return{family:_t,stretch:"normal",weight:Re,style:tt}}),Lt=function(_t,mt,Qt){for(var Ut=(Qt=Qt||{}).defaultFontFamily||"times",ht=Object.assign({},kZ,Qt.genericFontFamilies||{}),je=null,nt=null,ot=0;ot<mt.length;++ot)if(ht[(je=ym(mt[ot])).family]&&(je.family=ht[je.family]),_t.hasOwnProperty(je.family)){nt=_t[je.family];break}if(!(nt=nt||_t[Ut]))throw new Error("Could not find a font-family for the rule '"+S_(je)+"' and default family '"+Ut+"'.");if(nt=function(Ct,St){if(St[Ct])return St[Ct];var ir=Dg[Ct],ar=ir<=Dg.normal?-1:1,zt=__(St,hT,ir,ar);if(!zt)throw new Error("Could not find a matching font-stretch value for "+Ct);return zt}(je.stretch,nt),nt=function(Ct,St){if(St[Ct])return St[Ct];for(var ir=fT[Ct],ar=0;ar<ir.length;++ar)if(St[ir[ar]])return St[ir[ar]];throw new Error("Could not find a matching font-style for "+Ct)}(je.style,nt),!(nt=function(Ct,St){if(St[Ct])return St[Ct];if(Ct===400&&St[500])return St[500];if(Ct===500&&St[400])return St[400];var ir=jZ[Ct],ar=__(St,dT,ir,Ct<400?-1:1);if(!ar)throw new Error("Could not find a matching font-weight for value "+Ct);return ar}(je.weight,nt)))throw new Error("Failed to resolve a font for the rule '"+S_(je)+"'.");return nt}(Pt,ft);this.pdf.setFont(Lt.ref.name,Lt.ref.style)}else{var At="";(Re==="bold"||parseInt(Re,10)>=700||tt==="bold")&&(At="bold"),tt==="italic"&&(At+="italic"),At.length===0&&(At="normal");for(var Et="",Kt={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},yt=0;yt<Ze.length;yt++){if(this.pdf.internal.getFont(Ze[yt],At,{noFallback:!0,disableWarning:!0})!==void 0){Et=Ze[yt];break}if(At==="bolditalic"&&this.pdf.internal.getFont(Ze[yt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Et=Ze[yt],At="bold";else if(this.pdf.internal.getFont(Ze[yt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Et=Ze[yt],At="normal";break}}if(Et===""){for(var pt=0;pt<Ze.length;pt++)if(Kt[Ze[pt]]){Et=Kt[Ze[pt]];break}}Et=Et===""?"Times":Et,this.pdf.setFont(Et,At)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(ge){this.ctx.globalCompositeOperation=ge}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(ge){this.ctx.globalAlpha=ge}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(ge){this.ctx.lineDashOffset=ge,Fe.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(ge){this.ctx.lineDash=ge,Fe.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(ge){this.ctx.ignoreClearRect=!!ge}})};h.prototype.setLineDash=function(A){this.lineDash=A},h.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},h.prototype.fill=function(){P.call(this,"fill",!1)},h.prototype.stroke=function(){P.call(this,"stroke",!1)},h.prototype.beginPath=function(){this.path=[{type:"begin"}]},h.prototype.moveTo=function(A,F){if(isNaN(A)||isNaN(F))throw xr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var O=this.ctx.transform.applyToPoint(new s(A,F));this.path.push({type:"mt",x:O.x,y:O.y}),this.ctx.lastPoint=new s(A,F)},h.prototype.closePath=function(){var A=new s(0,0),F=0;for(F=this.path.length-1;F!==-1;F--)if(this.path[F].type==="begin"&&fr(this.path[F+1])==="object"&&typeof this.path[F+1].x=="number"){A=new s(this.path[F+1].x,this.path[F+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new s(A.x,A.y)},h.prototype.lineTo=function(A,F){if(isNaN(A)||isNaN(F))throw xr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var O=this.ctx.transform.applyToPoint(new s(A,F));this.path.push({type:"lt",x:O.x,y:O.y}),this.ctx.lastPoint=new s(O.x,O.y)},h.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),P.call(this,null,!0)},h.prototype.quadraticCurveTo=function(A,F,O,M){if(isNaN(O)||isNaN(M)||isNaN(A)||isNaN(F))throw xr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var J=this.ctx.transform.applyToPoint(new s(O,M)),fe=this.ctx.transform.applyToPoint(new s(A,F));this.path.push({type:"qct",x1:fe.x,y1:fe.y,x:J.x,y:J.y}),this.ctx.lastPoint=new s(J.x,J.y)},h.prototype.bezierCurveTo=function(A,F,O,M,J,fe){if(isNaN(J)||isNaN(fe)||isNaN(A)||isNaN(F)||isNaN(O)||isNaN(M))throw xr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ve=this.ctx.transform.applyToPoint(new s(J,fe)),ae=this.ctx.transform.applyToPoint(new s(A,F)),ue=this.ctx.transform.applyToPoint(new s(O,M));this.path.push({type:"bct",x1:ae.x,y1:ae.y,x2:ue.x,y2:ue.y,x:ve.x,y:ve.y}),this.ctx.lastPoint=new s(ve.x,ve.y)},h.prototype.arc=function(A,F,O,M,J,fe){if(isNaN(A)||isNaN(F)||isNaN(O)||isNaN(M)||isNaN(J))throw xr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(fe=!!fe,!this.ctx.transform.isIdentity){var ve=this.ctx.transform.applyToPoint(new s(A,F));A=ve.x,F=ve.y;var ae=this.ctx.transform.applyToPoint(new s(0,O)),ue=this.ctx.transform.applyToPoint(new s(0,0));O=Math.sqrt(Math.pow(ae.x-ue.x,2)+Math.pow(ae.y-ue.y,2))}Math.abs(J-M)>=2*Math.PI&&(M=0,J=2*Math.PI),this.path.push({type:"arc",x:A,y:F,radius:O,startAngle:M,endAngle:J,counterclockwise:fe})},h.prototype.arcTo=function(A,F,O,M,J){throw new Error("arcTo not implemented.")},h.prototype.rect=function(A,F,O,M){if(isNaN(A)||isNaN(F)||isNaN(O)||isNaN(M))throw xr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(A,F),this.lineTo(A+O,F),this.lineTo(A+O,F+M),this.lineTo(A,F+M),this.lineTo(A,F),this.lineTo(A+O,F),this.lineTo(A,F)},h.prototype.fillRect=function(A,F,O,M){if(isNaN(A)||isNaN(F)||isNaN(O)||isNaN(M))throw xr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!d.call(this)){var J={};this.lineCap!=="butt"&&(J.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(J.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(A,F,O,M),this.fill(),J.hasOwnProperty("lineCap")&&(this.lineCap=J.lineCap),J.hasOwnProperty("lineJoin")&&(this.lineJoin=J.lineJoin)}},h.prototype.strokeRect=function(A,F,O,M){if(isNaN(A)||isNaN(F)||isNaN(O)||isNaN(M))throw xr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");v.call(this)||(this.beginPath(),this.rect(A,F,O,M),this.stroke())},h.prototype.clearRect=function(A,F,O,M){if(isNaN(A)||isNaN(F)||isNaN(O)||isNaN(M))throw xr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(A,F,O,M))},h.prototype.save=function(A){A=typeof A!="boolean"||A;for(var F=this.pdf.internal.getCurrentPageInfo().pageNumber,O=0;O<this.pdf.internal.getNumberOfPages();O++)this.pdf.setPage(O+1),this.pdf.internal.out("q");if(this.pdf.setPage(F),A){this.ctx.fontSize=this.pdf.internal.getFontSize();var M=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=M}},h.prototype.restore=function(A){A=typeof A!="boolean"||A;for(var F=this.pdf.internal.getCurrentPageInfo().pageNumber,O=0;O<this.pdf.internal.getNumberOfPages();O++)this.pdf.setPage(O+1),this.pdf.internal.out("Q");this.pdf.setPage(F),A&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},h.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var p=function(A){var F,O,M,J;if(A.isCanvasGradient===!0&&(A=A.getColor()),!A)return{r:0,g:0,b:0,a:0,style:A};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(A))F=0,O=0,M=0,J=0;else{var fe=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(A);if(fe!==null)F=parseInt(fe[1]),O=parseInt(fe[2]),M=parseInt(fe[3]),J=1;else if((fe=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(A))!==null)F=parseInt(fe[1]),O=parseInt(fe[2]),M=parseInt(fe[3]),J=parseFloat(fe[4]);else{if(J=1,typeof A=="string"&&A.charAt(0)!=="#"){var ve=new iT(A);A=ve.ok?ve.toHex():"#000000"}A.length===4?(F=A.substring(1,2),F+=F,O=A.substring(2,3),O+=O,M=A.substring(3,4),M+=M):(F=A.substring(1,3),O=A.substring(3,5),M=A.substring(5,7)),F=parseInt(F,16),O=parseInt(O,16),M=parseInt(M,16)}}return{r:F,g:O,b:M,a:J,style:A}},d=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},v=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};h.prototype.fillText=function(A,F,O,M){if(isNaN(F)||isNaN(O)||typeof A!="string")throw xr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(M=isNaN(M)?void 0:M,!d.call(this)){var J=me(this.ctx.transform.rotation),fe=this.ctx.transform.scaleX;j.call(this,{text:A,x:F,y:O,scale:fe,angle:J,align:this.textAlign,maxWidth:M})}},h.prototype.strokeText=function(A,F,O,M){if(isNaN(F)||isNaN(O)||typeof A!="string")throw xr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!v.call(this)){M=isNaN(M)?void 0:M;var J=me(this.ctx.transform.rotation),fe=this.ctx.transform.scaleX;j.call(this,{text:A,x:F,y:O,scale:fe,renderingMode:"stroke",angle:J,align:this.textAlign,maxWidth:M})}},h.prototype.measureText=function(A){if(typeof A!="string")throw xr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var F=this.pdf,O=this.pdf.internal.scaleFactor,M=F.internal.getFontSize(),J=F.getStringUnitWidth(A)*M/F.internal.scaleFactor;return new function(fe){var ve=(fe=fe||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ve}}),this}({width:J*=Math.round(96*O/72*1e4)/1e4})},h.prototype.scale=function(A,F){if(isNaN(A)||isNaN(F))throw xr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var O=new l(A,0,0,F,0,0);this.ctx.transform=this.ctx.transform.multiply(O)},h.prototype.rotate=function(A){if(isNaN(A))throw xr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var F=new l(Math.cos(A),Math.sin(A),-Math.sin(A),Math.cos(A),0,0);this.ctx.transform=this.ctx.transform.multiply(F)},h.prototype.translate=function(A,F){if(isNaN(A)||isNaN(F))throw xr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var O=new l(1,0,0,1,A,F);this.ctx.transform=this.ctx.transform.multiply(O)},h.prototype.transform=function(A,F,O,M,J,fe){if(isNaN(A)||isNaN(F)||isNaN(O)||isNaN(M)||isNaN(J)||isNaN(fe))throw xr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ve=new l(A,F,O,M,J,fe);this.ctx.transform=this.ctx.transform.multiply(ve)},h.prototype.setTransform=function(A,F,O,M,J,fe){A=isNaN(A)?1:A,F=isNaN(F)?0:F,O=isNaN(O)?0:O,M=isNaN(M)?1:M,J=isNaN(J)?0:J,fe=isNaN(fe)?0:fe,this.ctx.transform=new l(A,F,O,M,J,fe)};var g=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};h.prototype.drawImage=function(A,F,O,M,J,fe,ve,ae,ue){var oe=this.pdf.getImageProperties(A),le=1,Be=1,ge=1,Q=1;M!==void 0&&ae!==void 0&&(ge=ae/M,Q=ue/J,le=oe.width/M*ae/M,Be=oe.height/J*ue/J),fe===void 0&&(fe=F,ve=O,F=0,O=0),M!==void 0&&ae===void 0&&(ae=M,ue=J),M===void 0&&ae===void 0&&(ae=oe.width,ue=oe.height);for(var tt,Re=this.ctx.transform.decompose(),it=me(Re.rotate.shx),We=new l,st=(We=(We=(We=We.multiply(Re.translate)).multiply(Re.skew)).multiply(Re.scale)).applyToRectangle(new o(fe-F*ge,ve-O*Q,M*le,J*Be)),Ze=y.call(this,st),Pt=[],ft=0;ft<Ze.length;ft+=1)Pt.indexOf(Ze[ft])===-1&&Pt.push(Ze[ft]);if(S(Pt),this.autoPaging)for(var Lt=Pt[0],At=Pt[Pt.length-1],Et=Lt;Et<At+1;Et++){this.pdf.setPage(Et);var Kt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],yt=Et===1?this.posY+this.margin[0]:this.margin[0],pt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],_t=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],mt=Et===1?0:pt+(Et-2)*_t;if(this.ctx.clip_path.length!==0){var Qt=this.path;tt=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=E(tt,this.posX+this.margin[3],-mt+yt+this.ctx.prevPageLastElemOffset),L.call(this,"fill",!0),this.path=Qt}var Ut=JSON.parse(JSON.stringify(st));Ut=E([Ut],this.posX+this.margin[3],-mt+yt+this.ctx.prevPageLastElemOffset)[0];var ht=(Et>Lt||Et<At)&&g.call(this);ht&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Kt,_t,null).clip().discardPath()),this.pdf.addImage(A,"JPEG",Ut.x,Ut.y,Ut.w,Ut.h,null,null,it),ht&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(A,"JPEG",st.x,st.y,st.w,st.h,null,null,it)};var y=function(A,F,O){var M=[];F=F||this.pdf.internal.pageSize.width,O=O||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var J=this.posY+this.ctx.prevPageLastElemOffset;switch(A.type){default:case"mt":case"lt":M.push(Math.floor((A.y+J)/O)+1);break;case"arc":M.push(Math.floor((A.y+J-A.radius)/O)+1),M.push(Math.floor((A.y+J+A.radius)/O)+1);break;case"qct":var fe=be(this.ctx.lastPoint.x,this.ctx.lastPoint.y,A.x1,A.y1,A.x,A.y);M.push(Math.floor((fe.y+J)/O)+1),M.push(Math.floor((fe.y+fe.h+J)/O)+1);break;case"bct":var ve=Ue(this.ctx.lastPoint.x,this.ctx.lastPoint.y,A.x1,A.y1,A.x2,A.y2,A.x,A.y);M.push(Math.floor((ve.y+J)/O)+1),M.push(Math.floor((ve.y+ve.h+J)/O)+1);break;case"rect":M.push(Math.floor((A.y+J)/O)+1),M.push(Math.floor((A.y+A.h+J)/O)+1)}for(var ae=0;ae<M.length;ae+=1)for(;this.pdf.internal.getNumberOfPages()<M[ae];)b.call(this);return M},b=function(){var A=this.fillStyle,F=this.strokeStyle,O=this.font,M=this.lineCap,J=this.lineWidth,fe=this.lineJoin;this.pdf.addPage(),this.fillStyle=A,this.strokeStyle=F,this.font=O,this.lineCap=M,this.lineWidth=J,this.lineJoin=fe},E=function(A,F,O){for(var M=0;M<A.length;M++)switch(A[M].type){case"bct":A[M].x2+=F,A[M].y2+=O;case"qct":A[M].x1+=F,A[M].y1+=O;default:A[M].x+=F,A[M].y+=O}return A},S=function(A){return A.sort(function(F,O){return F-O})},P=function(A,F){for(var O,M,J=this.fillStyle,fe=this.strokeStyle,ve=this.lineCap,ae=this.lineWidth,ue=Math.abs(ae*this.ctx.transform.scaleX),oe=this.lineJoin,le=JSON.parse(JSON.stringify(this.path)),Be=JSON.parse(JSON.stringify(this.path)),ge=[],Q=0;Q<Be.length;Q++)if(Be[Q].x!==void 0)for(var tt=y.call(this,Be[Q]),Re=0;Re<tt.length;Re+=1)ge.indexOf(tt[Re])===-1&&ge.push(tt[Re]);for(var it=0;it<ge.length;it++)for(;this.pdf.internal.getNumberOfPages()<ge[it];)b.call(this);if(S(ge),this.autoPaging)for(var We=ge[0],st=ge[ge.length-1],Ze=We;Ze<st+1;Ze++){this.pdf.setPage(Ze),this.fillStyle=J,this.strokeStyle=fe,this.lineCap=ve,this.lineWidth=ue,this.lineJoin=oe;var Pt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],ft=Ze===1?this.posY+this.margin[0]:this.margin[0],Lt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],At=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Et=Ze===1?0:Lt+(Ze-2)*At;if(this.ctx.clip_path.length!==0){var Kt=this.path;O=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=E(O,this.posX+this.margin[3],-Et+ft+this.ctx.prevPageLastElemOffset),L.call(this,A,!0),this.path=Kt}if(M=JSON.parse(JSON.stringify(le)),this.path=E(M,this.posX+this.margin[3],-Et+ft+this.ctx.prevPageLastElemOffset),F===!1||Ze===0){var yt=(Ze>We||Ze<st)&&g.call(this);yt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Pt,At,null).clip().discardPath()),L.call(this,A,F),yt&&this.pdf.restoreGraphicsState()}this.lineWidth=ae}else this.lineWidth=ue,L.call(this,A,F),this.lineWidth=ae;this.path=le},L=function(A,F){if((A!=="stroke"||F||!v.call(this))&&(A==="stroke"||F||!d.call(this))){for(var O,M,J=[],fe=this.path,ve=0;ve<fe.length;ve++){var ae=fe[ve];switch(ae.type){case"begin":J.push({begin:!0});break;case"close":J.push({close:!0});break;case"mt":J.push({start:ae,deltas:[],abs:[]});break;case"lt":var ue=J.length;if(fe[ve-1]&&!isNaN(fe[ve-1].x)&&(O=[ae.x-fe[ve-1].x,ae.y-fe[ve-1].y],ue>0)){for(;ue>=0;ue--)if(J[ue-1].close!==!0&&J[ue-1].begin!==!0){J[ue-1].deltas.push(O),J[ue-1].abs.push(ae);break}}break;case"bct":O=[ae.x1-fe[ve-1].x,ae.y1-fe[ve-1].y,ae.x2-fe[ve-1].x,ae.y2-fe[ve-1].y,ae.x-fe[ve-1].x,ae.y-fe[ve-1].y],J[J.length-1].deltas.push(O);break;case"qct":var oe=fe[ve-1].x+2/3*(ae.x1-fe[ve-1].x),le=fe[ve-1].y+2/3*(ae.y1-fe[ve-1].y),Be=ae.x+2/3*(ae.x1-ae.x),ge=ae.y+2/3*(ae.y1-ae.y),Q=ae.x,tt=ae.y;O=[oe-fe[ve-1].x,le-fe[ve-1].y,Be-fe[ve-1].x,ge-fe[ve-1].y,Q-fe[ve-1].x,tt-fe[ve-1].y],J[J.length-1].deltas.push(O);break;case"arc":J.push({deltas:[],abs:[],arc:!0}),Array.isArray(J[J.length-1].abs)&&J[J.length-1].abs.push(ae)}}M=F?null:A==="stroke"?"stroke":"fill";for(var Re=!1,it=0;it<J.length;it++)if(J[it].arc)for(var We=J[it].abs,st=0;st<We.length;st++){var Ze=We[st];Ze.type==="arc"?R.call(this,Ze.x,Ze.y,Ze.radius,Ze.startAngle,Ze.endAngle,Ze.counterclockwise,void 0,F,!Re):H.call(this,Ze.x,Ze.y),Re=!0}else if(J[it].close===!0)this.pdf.internal.out("h"),Re=!1;else if(J[it].begin!==!0){var Pt=J[it].start.x,ft=J[it].start.y;X.call(this,J[it].deltas,Pt,ft),Re=!0}M&&k.call(this,M),F&&G.call(this)}},q=function(A){var F=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,O=F*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return A-O;case"top":return A+F-O;case"hanging":return A+F-2*O;case"middle":return A+F/2-O;default:return A}},C=function(A){return A+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};h.prototype.createLinearGradient=function(){var A=function(){};return A.colorStops=[],A.addColorStop=function(F,O){this.colorStops.push([F,O])},A.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},A.isCanvasGradient=!0,A},h.prototype.createPattern=function(){return this.createLinearGradient()},h.prototype.createRadialGradient=function(){return this.createLinearGradient()};var R=function(A,F,O,M,J,fe,ve,ae,ue){for(var oe=pe.call(this,O,M,J,fe),le=0;le<oe.length;le++){var Be=oe[le];le===0&&(ue?_.call(this,Be.x1+A,Be.y1+F):H.call(this,Be.x1+A,Be.y1+F)),ce.call(this,A,F,Be.x2,Be.y2,Be.x3,Be.y3,Be.x4,Be.y4)}ae?G.call(this):k.call(this,ve)},k=function(A){switch(A){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},G=function(){this.pdf.clip(),this.pdf.discardPath()},_=function(A,F){this.pdf.internal.out(r(A)+" "+n(F)+" m")},j=function(A){var F;switch(A.align){case"right":case"end":F="right";break;case"center":F="center";break;default:F="left"}var O=this.pdf.getTextDimensions(A.text),M=q.call(this,A.y),J=C.call(this,M)-O.h,fe=this.ctx.transform.applyToPoint(new s(A.x,M)),ve=this.ctx.transform.decompose(),ae=new l;ae=(ae=(ae=ae.multiply(ve.translate)).multiply(ve.skew)).multiply(ve.scale);for(var ue,oe,le,Be=this.ctx.transform.applyToRectangle(new o(A.x,M,O.w,O.h)),ge=ae.applyToRectangle(new o(A.x,J,O.w,O.h)),Q=y.call(this,ge),tt=[],Re=0;Re<Q.length;Re+=1)tt.indexOf(Q[Re])===-1&&tt.push(Q[Re]);if(S(tt),this.autoPaging)for(var it=tt[0],We=tt[tt.length-1],st=it;st<We+1;st++){this.pdf.setPage(st);var Ze=st===1?this.posY+this.margin[0]:this.margin[0],Pt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ft=this.pdf.internal.pageSize.height-this.margin[2],Lt=ft-this.margin[0],At=this.pdf.internal.pageSize.width-this.margin[1],Et=At-this.margin[3],Kt=st===1?0:Pt+(st-2)*Lt;if(this.ctx.clip_path.length!==0){var yt=this.path;ue=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=E(ue,this.posX+this.margin[3],-1*Kt+Ze),L.call(this,"fill",!0),this.path=yt}var pt=E([JSON.parse(JSON.stringify(ge))],this.posX+this.margin[3],-Kt+Ze+this.ctx.prevPageLastElemOffset)[0];A.scale>=.01&&(oe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(oe*A.scale),le=this.lineWidth,this.lineWidth=le*A.scale);var _t=this.autoPaging!=="text";if(_t||pt.y+pt.h<=ft){if(_t||pt.y>=Ze&&pt.x<=At){var mt=_t?A.text:this.pdf.splitTextToSize(A.text,A.maxWidth||At-pt.x)[0],Qt=E([JSON.parse(JSON.stringify(Be))],this.posX+this.margin[3],-Kt+Ze+this.ctx.prevPageLastElemOffset)[0],Ut=_t&&(st>it||st<We)&&g.call(this);Ut&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Et,Lt,null).clip().discardPath()),this.pdf.text(mt,Qt.x,Qt.y,{angle:A.angle,align:F,renderingMode:A.renderingMode}),Ut&&this.pdf.restoreGraphicsState()}}else pt.y<ft&&(this.ctx.prevPageLastElemOffset+=ft-pt.y);A.scale>=.01&&(this.pdf.setFontSize(oe),this.lineWidth=le)}else A.scale>=.01&&(oe=this.pdf.internal.getFontSize(),this.pdf.setFontSize(oe*A.scale),le=this.lineWidth,this.lineWidth=le*A.scale),this.pdf.text(A.text,fe.x+this.posX,fe.y+this.posY,{angle:A.angle,align:F,renderingMode:A.renderingMode,maxWidth:A.maxWidth}),A.scale>=.01&&(this.pdf.setFontSize(oe),this.lineWidth=le)},H=function(A,F,O,M){O=O||0,M=M||0,this.pdf.internal.out(r(A+O)+" "+n(F+M)+" l")},X=function(A,F,O){return this.pdf.lines(A,F,O,null,null)},ce=function(A,F,O,M,J,fe,ve,ae){this.pdf.internal.out([t(i(O+A)),t(a(M+F)),t(i(J+A)),t(a(fe+F)),t(i(ve+A)),t(a(ae+F)),"c"].join(" "))},pe=function(A,F,O,M){for(var J=2*Math.PI,fe=Math.PI/2;F>O;)F-=J;var ve=Math.abs(O-F);ve<J&&M&&(ve=J-ve);for(var ae=[],ue=M?-1:1,oe=F;ve>1e-5;){var le=oe+ue*Math.min(ve,fe);ae.push(ye.call(this,A,oe,le)),ve-=Math.abs(le-oe),oe=le}return ae},ye=function(A,F,O){var M=(O-F)/2,J=A*Math.cos(M),fe=A*Math.sin(M),ve=J,ae=-fe,ue=ve*ve+ae*ae,oe=ue+ve*J+ae*fe,le=4/3*(Math.sqrt(2*ue*oe)-oe)/(ve*fe-ae*J),Be=ve-le*ae,ge=ae+le*ve,Q=Be,tt=-ge,Re=M+F,it=Math.cos(Re),We=Math.sin(Re);return{x1:A*Math.cos(F),y1:A*Math.sin(F),x2:Be*it-ge*We,y2:Be*We+ge*it,x3:Q*it-tt*We,y3:Q*We+tt*it,x4:A*Math.cos(O),y4:A*Math.sin(O)}},me=function(A){return 180*A/Math.PI},be=function(A,F,O,M,J,fe){var ve=A+.5*(O-A),ae=F+.5*(M-F),ue=J+.5*(O-J),oe=fe+.5*(M-fe),le=Math.min(A,J,ve,ue),Be=Math.max(A,J,ve,ue),ge=Math.min(F,fe,ae,oe),Q=Math.max(F,fe,ae,oe);return new o(le,ge,Be-le,Q-ge)},Ue=function(A,F,O,M,J,fe,ve,ae){var ue,oe,le,Be,ge,Q,tt,Re,it,We,st,Ze,Pt,ft,Lt=O-A,At=M-F,Et=J-O,Kt=fe-M,yt=ve-J,pt=ae-fe;for(oe=0;oe<41;oe++)it=(tt=(le=A+(ue=oe/40)*Lt)+ue*((ge=O+ue*Et)-le))+ue*(ge+ue*(J+ue*yt-ge)-tt),We=(Re=(Be=F+ue*At)+ue*((Q=M+ue*Kt)-Be))+ue*(Q+ue*(fe+ue*pt-Q)-Re),oe==0?(st=it,Ze=We,Pt=it,ft=We):(st=Math.min(st,it),Ze=Math.min(Ze,We),Pt=Math.max(Pt,it),ft=Math.max(ft,We));return new o(Math.round(st),Math.round(Ze),Math.round(Pt-st),Math.round(ft-Ze))},Fe=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var A,F,O=(A=this.ctx.lineDash,F=this.ctx.lineDashOffset,JSON.stringify({lineDash:A,lineDashOffset:F}));this.prevLineDash!==O&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=O)}}})(wt.API),function(e){var t=function(s){var o,l,c,u,h,p,d,v,g,y;for(l=[],c=0,u=(s+=o="\0\0\0\0".slice(s.length%4||4)).length;u>c;c+=4)(h=(s.charCodeAt(c)<<24)+(s.charCodeAt(c+1)<<16)+(s.charCodeAt(c+2)<<8)+s.charCodeAt(c+3))!==0?(p=(h=((h=((h=((h=(h-(y=h%85))/85)-(g=h%85))/85)-(v=h%85))/85)-(d=h%85))/85)%85,l.push(p+33,d+33,v+33,g+33,y+33)):l.push(122);return function(b,E){for(var S=E;S>0;S--)b.pop()}(l,o.length),String.fromCharCode.apply(String,l)+"~>"},r=function(s){var o,l,c,u,h,p=String,d="length",v=255,g="charCodeAt",y="slice",b="replace";for(s[y](-2),s=s[y](0,-2)[b](/\s/g,"")[b]("z","!!!!!"),c=[],u=0,h=(s+=o="uuuuu"[y](s[d]%5||5))[d];h>u;u+=5)l=52200625*(s[g](u)-33)+614125*(s[g](u+1)-33)+7225*(s[g](u+2)-33)+85*(s[g](u+3)-33)+(s[g](u+4)-33),c.push(v&l>>24,v&l>>16,v&l>>8,v&l);return function(E,S){for(var P=S;P>0;P--)E.pop()}(c,o[d]),p.fromCharCode.apply(p,c)},n=function(s){return s.split("").map(function(o){return("0"+o.charCodeAt().toString(16)).slice(-2)}).join("")+">"},i=function(s){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((s=s.replace(/\s/g,"")).indexOf(">")!==-1&&(s=s.substr(0,s.indexOf(">"))),s.length%2&&(s+="0"),o.test(s)===!1)return"";for(var l="",c=0;c<s.length;c+=2)l+=String.fromCharCode("0x"+(s[c]+s[c+1]));return l},a=function(s){for(var o=new Uint8Array(s.length),l=s.length;l--;)o[l]=s.charCodeAt(l);return(o=_g(o)).reduce(function(c,u){return c+String.fromCharCode(u)},"")};e.processDataByFilters=function(s,o){var l=0,c=s||"",u=[];for(typeof(o=o||[])=="string"&&(o=[o]),l=0;l<o.length;l+=1)switch(o[l]){case"ASCII85Decode":case"/ASCII85Decode":c=r(c),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":c=t(c),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":c=i(c),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":c=n(c),u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":c=a(c),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[l]+'" is not implemented')}return{data:c,reverseChain:u.reverse().join(" ")}}}(wt.API),function(e){e.loadFile=function(t,r,n){return function(i,a,s){a=a!==!1,s=typeof s=="function"?s:function(){};var o=void 0;try{o=function(l,c,u){var h=new XMLHttpRequest,p=0,d=function(v){var g=v.length,y=[],b=String.fromCharCode;for(p=0;p<g;p+=1)y.push(b(255&v.charCodeAt(p)));return y.join("")};if(h.open("GET",l,!c),h.overrideMimeType("text/plain; charset=x-user-defined"),c===!1&&(h.onload=function(){h.status===200?u(d(this.responseText)):u(void 0)}),h.send(null),c&&h.status===200)return d(h.responseText)}(i,a,s)}catch{}return o}(t,r,n)},e.loadImageFile=e.loadFile}(wt.API),function(e){function t(){return(kt.html2canvas?Promise.resolve(kt.html2canvas):h1(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function r(){return(kt.DOMPurify?Promise.resolve(kt.DOMPurify):h1(()=>import("./purify.es-BFmuJLeH.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var n=function(o){var l=fr(o);return l==="undefined"?"undefined":l==="string"||o instanceof String?"string":l==="number"||o instanceof Number?"number":l==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":l==="object"?"object":"unknown"},i=function(o,l){var c=document.createElement(o);for(var u in l.className&&(c.className=l.className),l.innerHTML&&l.dompurify&&(c.innerHTML=l.dompurify.sanitize(l.innerHTML)),l.style)c.style[u]=l.style[u];return c},a=function o(l,c){for(var u=l.nodeType===3?document.createTextNode(l.nodeValue):l.cloneNode(!1),h=l.firstChild;h;h=h.nextSibling)c!==!0&&h.nodeType===1&&h.nodeName==="SCRIPT"||u.appendChild(o(h,c));return l.nodeType===1&&(l.nodeName==="CANVAS"?(u.width=l.width,u.height=l.height,u.getContext("2d").drawImage(l,0,0)):l.nodeName!=="TEXTAREA"&&l.nodeName!=="SELECT"||(u.value=l.value),u.addEventListener("load",function(){u.scrollTop=l.scrollTop,u.scrollLeft=l.scrollLeft},!0)),u},s=function o(l){var c=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),u=o.convert(Promise.resolve(),c);return(u=u.setProgress(1,o,1,[o])).set(l)};(s.prototype=Object.create(Promise.prototype)).constructor=s,s.convert=function(o,l){return o.__proto__=l||s.prototype,o},s.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},s.prototype.from=function(o,l){return this.then(function(){switch(l=l||function(c){switch(n(c)){case"string":return"string";case"element":return c.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(o),l){case"string":return this.then(r).then(function(c){return this.set({src:i("div",{innerHTML:o,dompurify:c})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},s.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},s.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},l=a(this.prop.src,this.opt.html2canvas.javascriptEnabled);l.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=i("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=i("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(l),this.prop.container.firstChild.appendChild(i("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},s.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(l){var c=Object.assign({},this.opt.html2canvas);return delete c.onrendered,l(this.prop.container,c)}).then(function(l){(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},s.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(l){var c=this.opt.jsPDF,u=this.opt.fontFaces,h=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,p=Object.assign({async:!0,allowTaint:!0,scale:h,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete p.onrendered,c.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,c.context2d.posX=this.opt.x,c.context2d.posY=this.opt.y,c.context2d.margin=this.opt.margin,c.context2d.fontFaces=u,u)for(var d=0;d<u.length;++d){var v=u[d],g=v.src.find(function(y){return y.format==="truetype"});g&&c.addFont(g.url,v.ref.name,v.ref.style)}return p.windowHeight=p.windowHeight||0,p.windowHeight=p.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):p.windowHeight,c.context2d.save(!0),l(this.prop.container,p)}).then(function(l){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(l),this.prop.canvas=l,document.body.removeChild(this.prop.overlay)})},s.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},s.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},s.prototype.output=function(o,l,c){return(c=c||"pdf").toLowerCase()==="img"||c.toLowerCase()==="image"?this.outputImg(o,l):this.outputPdf(o,l)},s.prototype.outputPdf=function(o,l){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,l)})},s.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},s.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},s.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},s.prototype.set=function(o){if(n(o)!=="object")return this;var l=Object.keys(o||{}).map(function(c){if(c in s.template.prop)return function(){this.prop[c]=o[c]};switch(c){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[c]=o[c]}}},this);return this.then(function(){return this.thenList(l)})},s.prototype.get=function(o,l){return this.then(function(){var c=o in s.template.prop?this.prop[o]:this.opt[o];return l?l(c):c})},s.prototype.setMargin=function(o){return this.then(function(){switch(n(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},s.prototype.setPageSize=function(o){function l(c,u){return Math.floor(c*u/72*96)}return this.then(function(){(o=o||wt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:l(o.inner.width,o.k),height:l(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},s.prototype.setProgress=function(o,l,c,u){return o!=null&&(this.progress.val=o),l!=null&&(this.progress.state=l),c!=null&&(this.progress.n=c),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},s.prototype.updateProgress=function(o,l,c,u){return this.setProgress(o?this.progress.val+o:null,l||null,c?this.progress.n+c:null,u?this.progress.stack.concat(u):null)},s.prototype.then=function(o,l){var c=this;return this.thenCore(o,l,function(u,h){return c.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(p){return c.updateProgress(null,u),p}).then(u,h).then(function(p){return c.updateProgress(1),p})})},s.prototype.thenCore=function(o,l,c){c=c||Promise.prototype.then;var u=this;o&&(o=o.bind(u)),l&&(l=l.bind(u));var h=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?u:s.convert(Object.assign({},u),Promise.prototype),p=c.call(h,o,l);return s.convert(p,u.__proto__)},s.prototype.thenExternal=function(o,l){return Promise.prototype.then.call(this,o,l)},s.prototype.thenList=function(o){var l=this;return o.forEach(function(c){l=l.thenCore(c)}),l},s.prototype.catch=function(o){o&&(o=o.bind(this));var l=Promise.prototype.catch.call(this,o);return s.convert(l,this)},s.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},s.prototype.error=function(o){return this.then(function(){throw new Error(o)})},s.prototype.using=s.prototype.set,s.prototype.saveAs=s.prototype.save,s.prototype.export=s.prototype.output,s.prototype.run=s.prototype.then,wt.getPageSize=function(o,l,c){if(fr(o)==="object"){var u=o;o=u.orientation,l=u.unit||l,c=u.format||c}l=l||"mm",c=c||"a4",o=(""+(o||"P")).toLowerCase();var h,p=(""+c).toLowerCase(),d={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(l){case"pt":h=1;break;case"mm":h=72/25.4;break;case"cm":h=72/2.54;break;case"in":h=72;break;case"px":h=.75;break;case"pc":case"em":h=12;break;case"ex":h=6;break;default:throw"Invalid unit: "+l}var v,g=0,y=0;if(d.hasOwnProperty(p))g=d[p][1]/h,y=d[p][0]/h;else try{g=c[1],y=c[0]}catch{throw new Error("Invalid format: "+c)}if(o==="p"||o==="portrait")o="p",y>g&&(v=y,y=g,g=v);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",g>y&&(v=y,y=g,g=v)}return{width:y,height:g,unit:l,k:h,orientation:o}},e.html=function(o,l){(l=l||{}).callback=l.callback||function(){},l.html2canvas=l.html2canvas||{},l.html2canvas.canvas=l.html2canvas.canvas||this.canvas,l.jsPDF=l.jsPDF||this,l.fontFaces=l.fontFaces?l.fontFaces.map(ym):null;var c=new s(l);return l.worker?c:c.from(o).doCallback()}}(wt.API),wt.API.addJS=function(e){return T_=e,this.internal.events.subscribe("postPutResources",function(){ph=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(ph+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),E_=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+T_+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){ph!==void 0&&E_!==void 0&&this.internal.out("/Names <</JavaScript "+ph+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var i=r.outline.render().split(/\r\n/),a=0;a<i.length;a++){var s=i[a],o=n.exec(s);if(o!=null){var l=o[1];r.internal.newObjectDeferredBegin(l,!1)}r.internal.write(s)}if(this.outline.createNamedDestinations){var c=this.internal.pages.length,u=[];for(a=0;a<c;a++){var h=r.internal.newObject();u.push(h);var p=r.internal.getPageInfo(a+1);r.internal.write("<< /D["+p.objId+" 0 R /XYZ null null null]>> endobj")}var d=r.internal.newObject();for(r.internal.write("<< /Names [ "),a=0;a<u.length;a++)r.internal.write("(page_"+(a+1)+")"+u[a]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+d+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,i,a){var s={title:i,options:a,children:[]};return n==null&&(n=this.root),n.children.push(s),s},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var i=0;i<n.children.length;i++)this.genIds_r(n.children[i])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var i=this.ctx.pdf.internal.getVerticalCoordinateString,a=0;a<n.children.length;a++){var s=n.children[a];this.objStart(s),this.line("/Title "+this.makeString(s.title)),this.line("/Parent "+this.makeRef(n)),a>0&&this.line("/Prev "+this.makeRef(n.children[a-1])),a<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[a+1])),s.children.length>0&&(this.line("/First "+this.makeRef(s.children[0])),this.line("/Last "+this.makeRef(s.children[s.children.length-1])));var o=this.count=this.count_r({count:0},s);if(o>0&&this.line("/Count "+o),s.options&&s.options.pageNumber){var l=r.internal.getPageInfo(s.options.pageNumber);this.line("/Dest ["+l.objId+" 0 R /XYZ 0 "+i(0)+" 0]")}this.objEnd()}for(var c=0;c<n.children.length;c++)this.renderItems(n.children[c])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,i){for(var a=0;a<i.children.length;a++)n.count++,this.count_r(n,i.children[a]);return n.count}}])}(wt.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,i,a,s,o){var l,c=this.decode.DCT_DECODE,u=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=s||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,l=function(h){for(var p,d=256*h.charCodeAt(4)+h.charCodeAt(5),v=h.length,g={width:0,height:0,numcomponents:1},y=4;y<v;y+=2){if(y+=d,t.indexOf(h.charCodeAt(y+1))!==-1){p=256*h.charCodeAt(y+5)+h.charCodeAt(y+6),g={width:256*h.charCodeAt(y+7)+h.charCodeAt(y+8),height:p,numcomponents:h.charCodeAt(y+9)};break}d=256*h.charCodeAt(y+2)+h.charCodeAt(y+3)}return g}(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),l.numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}u={data:r,width:l.width,height:l.height,colorSpace:o,bitsPerComponent:8,filter:c,index:n,alias:i}}return u}}(wt.API),wt.API.processPNG=function(e,t,r,n){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var i,a=mZ(e,{checkCrc:!0}),s=a.width,o=a.height,l=a.channels,c=a.palette,u=a.depth;i=c&&l===1?function(C){for(var R=C.width,k=C.height,G=C.data,_=C.palette,j=C.depth,H=!1,X=[],ce=[],pe=void 0,ye=!1,me=0,be=0;be<_.length;be++){var Ue=ww(_[be],4),Fe=Ue[0],A=Ue[1],F=Ue[2],O=Ue[3];X.push(Fe,A,F),O!=null&&(O===0?(me++,ce.length<1&&ce.push(be)):O<255&&(ye=!0))}if(ye||me>1){H=!0,ce=void 0;var M=R*k;pe=new Uint8Array(M);for(var J=new DataView(G.buffer),fe=0;fe<M;fe++){var ve=wm(J,fe,j),ae=ww(_[ve],4)[3];pe[fe]=ae}}return{colorSpace:"Indexed",colorsPerPixel:1,colorBytes:G,alphaBytes:pe,needSMask:H,palette:X,mask:ce}}(a):l===2||l===4?function(C){for(var R=C.data,k=C.width,G=C.height,_=C.channels,j=C.depth,H=_===2?"DeviceGray":"DeviceRGB",X=_-1,ce=k*G,pe=X,ye=ce*pe,me=1*ce,be=Math.ceil(ye*j/8),Ue=Math.ceil(me*j/8),Fe=new Uint8Array(be),A=new Uint8Array(Ue),F=new DataView(R.buffer),O=new DataView(Fe.buffer),M=new DataView(A.buffer),J=!1,fe=0;fe<ce;fe++){for(var ve=fe*_,ae=0;ae<pe;ae++)I_(O,wm(F,ve+ae,j),fe*pe+ae,j);var ue=wm(F,ve+pe,j);ue<(1<<j)-1&&(J=!0),I_(M,ue,1*fe,j)}return{colorSpace:H,colorsPerPixel:X,colorBytes:Fe,alphaBytes:A,needSMask:J}}(a):function(C){var R=C.data,k=C.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:k,colorsPerPixel:k==="DeviceGray"?1:3,colorBytes:R instanceof Uint8Array?R:new Uint8Array(R.buffer),needSMask:!1}}(a);var h,p,d,v=i,g=v.colorSpace,y=v.colorsPerPixel,b=v.colorBytes,E=v.alphaBytes,S=v.needSMask,P=v.palette,L=v.mask,q=null;return n!==wt.API.image_compression.NONE&&typeof _g=="function"?(q=function(C){var R;switch(C){case wt.API.image_compression.FAST:R=11;break;case wt.API.image_compression.MEDIUM:R=13;break;case wt.API.image_compression.SLOW:R=14;break;default:R=12}return R}(n),h=this.decode.FLATE_DECODE,p="/Predictor ".concat(q," "),e=C_(b,s*y,y,n),S&&(d=C_(E,s,1,n))):(h=void 0,p="",e=b,S&&(d=E)),p+="/Colors ".concat(y," /BitsPerComponent ").concat(u," /Columns ").concat(s),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(d&&this.__addimage__.isArrayBuffer(d)||this.__addimage__.isArrayBufferView(d))&&(d=this.__addimage__.arrayBufferToBinaryString(d)),{alias:r,data:e,index:t,filter:h,decodeParameters:p,transparency:L,palette:P,sMask:d,predictor:q,width:s,height:o,bitsPerComponent:u,colorSpace:g}}},function(e){e.processGIF89A=function(t,r,n,i){var a=new IZ(t),s=a.width,o=a.height,l=[];a.decodeAndBlitFrameRGBA(0,l);var c={data:l,width:s,height:o},u=new _m(100).encode(c,100);return e.processJPEG.call(this,u,r,n,i)},e.processGIF87A=e.processGIF89A}(wt.API),Sa.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:i,green:n,blue:r,quad:a}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Sa.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){xr.log("bit decode error:"+r)}},Sa.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,i=0;i<t;i++)for(var a=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+8*i*4,o=0;o<8&&8*i+o<this.width;o++){var l=this.palette[a>>7-o&1];this.data[s+4*o]=l.blue,this.data[s+4*o+1]=l.green,this.data[s+4*o+2]=l.red,this.data[s+4*o+3]=255}r!==0&&(this.pos+=4-r)}},Sa.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<e;i++){var a=this.datav.getUint8(this.pos++,!0),s=n*this.width*4+2*i*4,o=a>>4,l=15&a,c=this.palette[o];if(this.data[s]=c.blue,this.data[s+1]=c.green,this.data[s+2]=c.red,this.data[s+3]=255,2*i+1>=this.width)break;c=this.palette[l],this.data[s+4]=c.blue,this.data[s+4+1]=c.green,this.data[s+4+2]=c.red,this.data[s+4+3]=255}t!==0&&(this.pos+=4-t)}},Sa.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var i=this.datav.getUint8(this.pos++,!0),a=r*this.width*4+4*n;if(i<this.palette.length){var s=this.palette[i];this.data[a]=s.red,this.data[a+1]=s.green,this.data[a+2]=s.blue,this.data[a+3]=255}else this.data[a]=255,this.data[a+1]=255,this.data[a+2]=255,this.data[a+3]=255}e!==0&&(this.pos+=4-e)}},Sa.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var a=this.datav.getUint16(this.pos,!0);this.pos+=2;var s=(a&t)/t*255|0,o=(a>>5&t)/t*255|0,l=(a>>10&t)/t*255|0,c=a>>15?255:0,u=n*this.width*4+4*i;this.data[u]=l,this.data[u+1]=o,this.data[u+2]=s,this.data[u+3]=c}this.pos+=e}},Sa.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var i=this.bottom_up?n:this.height-1-n,a=0;a<this.width;a++){var s=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(s&t)/t*255|0,l=(s>>5&r)/r*255|0,c=(s>>11)/t*255|0,u=i*this.width*4+4*a;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=o,this.data[u+3]=255}this.pos+=e}},Sa.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=t*this.width*4+4*r;this.data[s]=a,this.data[s+1]=i,this.data[s+2]=n,this.data[s+3]=255}this.pos+=this.width%4}},Sa.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),a=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*r;this.data[o]=a,this.data[o+1]=i,this.data[o+2]=n,this.data[o+3]=s}},Sa.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,r,n,i){var a=new Sa(t,!1),s=a.width,o=a.height,l={data:a.getData(),width:s,height:o},c=new _m(100).encode(l,100);return e.processJPEG.call(this,c,r,n,i)}}(wt.API),R_.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,r,n,i){var a=new R_(t),s=a.width,o=a.height,l={data:a.getData(),width:s,height:o},c=new _m(100).encode(l,100);return e.processJPEG.call(this,c,r,n,i)}}(wt.API),wt.API.processRGBA=function(e,t,r){for(var n=e.data,i=n.length,a=new Uint8Array(i/4*3),s=new Uint8Array(i/4),o=0,l=0,c=0;c<i;c+=4){var u=n[c],h=n[c+1],p=n[c+2],d=n[c+3];a[o++]=u,a[o++]=h,a[o++]=p,s[l++]=d}var v=this.__addimage__.arrayBufferToBinaryString(a);return{alpha:this.__addimage__.arrayBufferToBinaryString(s),data:v,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},wt.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},sc=wt.API,mh=sc.getCharWidthsArray=function(e,t){var r,n,i=(t=t||{}).font||this.internal.getFont(),a=t.fontSize||this.internal.getFontSize(),s=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:i.metadata.Unicode.widths,l=o.fof?o.fof:1,c=t.kerning?t.kerning:i.metadata.Unicode.kerning,u=c.fof?c.fof:1,h=t.doKerning!==!1,p=0,d=e.length,v=0,g=o[0]||l,y=[];for(r=0;r<d;r++)n=e.charCodeAt(r),typeof i.metadata.widthOfString=="function"?y.push((i.metadata.widthOfGlyph(i.metadata.characterToGlyph(n))+s*(1e3/a)||0)/1e3):(p=h&&fr(c[n])==="object"&&!isNaN(parseInt(c[n][v],10))?c[n][v]/u:0,y.push((o[n]||g)/l+p)),v=n;return y},P_=sc.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),i=t.charSpace||this.internal.getCharSpace();return sc.processArabic&&(e=sc.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,i)/r:mh.apply(this,arguments).reduce(function(a,s){return a+s},0)},j_=function(e,t,r,n){for(var i=[],a=0,s=e.length,o=0;a!==s&&o+t[a]<r;)o+=t[a],a++;i.push(e.slice(0,a));var l=a;for(o=0;a!==s;)o+t[a]>n&&(i.push(e.slice(l,a)),o=0,l=a),o+=t[a],a++;return l!==a&&i.push(e.slice(l,a)),i},k_=function(e,t,r){r||(r={});var n,i,a,s,o,l,c,u=[],h=[u],p=r.textIndent||0,d=0,v=0,g=e.split(" "),y=mh.apply(this,[" ",r])[0];if(l=r.lineIndent===-1?g[0].length+2:r.lineIndent||0){var b=Array(l).join(" "),E=[];g.map(function(P){(P=P.split(/\s*\n/)).length>1?E=E.concat(P.map(function(L,q){return(q&&L.length?`
`:"")+L})):E.push(P[0])}),g=E,l=P_.apply(this,[b,r])}for(a=0,s=g.length;a<s;a++){var S=0;if(n=g[a],l&&n[0]==`
`&&(n=n.substr(1),S=1),p+d+(v=(i=mh.apply(this,[n,r])).reduce(function(P,L){return P+L},0))>t||S){if(v>t){for(o=j_.apply(this,[n,i,t-(p+d),t]),u.push(o.shift()),u=[o.pop()];o.length;)h.push([o.shift()]);v=i.slice(n.length-(u[0]?u[0].length:0)).reduce(function(P,L){return P+L},0)}else u=[n];h.push(u),p=v+l,d=y}else u.push(n),p+=d+v,d=y}return c=l?function(P,L){return(L?b:"")+P.join(" ")}:function(P){return P.join(" ")},h.map(c)},sc.splitTextToSize=function(e,t,r){var n,i=(r=r||{}).fontSize||this.internal.getFontSize(),a=(function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var h=this.internal.getFont(u.fontName,u.fontStyle),p="Unicode";return h.metadata[p]?{widths:h.metadata[p].widths||{0:1},kerning:h.metadata[p].kerning||{}}:{font:h.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var s=1*this.internal.scaleFactor*t/i;a.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/i:0,a.lineIndent=r.lineIndent;var o,l,c=[];for(o=0,l=n.length;o<l;o++)c=c.concat(k_.apply(this,[n[o],s,a]));return c},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",n={},i={},a=0;a<16;a++)n[r[a]]=t[a],i[t[a]]=r[a];var s=function(p){return"0x"+parseInt(p,10).toString(16)},o=e.__fontmetrics__.compress=function(p){var d,v,g,y,b=["{"];for(var E in p){if(d=p[E],isNaN(parseInt(E,10))?v="'"+E+"'":(E=parseInt(E,10),v=(v=s(E).slice(2)).slice(0,-1)+i[v.slice(-1)]),typeof d=="number")d<0?(g=s(d).slice(3),y="-"):(g=s(d).slice(2),y=""),g=y+g.slice(0,-1)+i[g.slice(-1)];else{if(fr(d)!=="object")throw new Error("Don't know what to do with value type "+fr(d)+".");g=o(d)}b.push(v+g)}return b.push("}"),b.join("")},l=e.__fontmetrics__.uncompress=function(p){if(typeof p!="string")throw new Error("Invalid argument passed to uncompress.");for(var d,v,g,y,b={},E=1,S=b,P=[],L="",q="",C=p.length-1,R=1;R<C;R+=1)(y=p[R])=="'"?d?(g=d.join(""),d=void 0):d=[]:d?d.push(y):y=="{"?(P.push([S,g]),S={},g=void 0):y=="}"?((v=P.pop())[0][v[1]]=S,g=void 0,S=v[0]):y=="-"?E=-1:g===void 0?n.hasOwnProperty(y)?(L+=n[y],g=parseInt(L,16)*E,E=1,L=""):L+=y:n.hasOwnProperty(y)?(q+=n[y],S[g]=parseInt(q,16)*E,E=1,g=void 0,q=""):q+=y;return b},c={codePages:["WinAnsiEncoding"],WinAnsiEncoding:l("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:c,"Courier-Bold":c,"Courier-BoldOblique":c,"Courier-Oblique":c,Helvetica:c,"Helvetica-Bold":c,"Helvetica-BoldOblique":c,"Helvetica-Oblique":c,"Times-Roman":c,"Times-Bold":c,"Times-BoldItalic":c,"Times-Italic":c}},h={Unicode:{"Courier-Oblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":l("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":l("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:l("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":l("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:l("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":l("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":l("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":l("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":l("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(p){var d=p.font,v=h.Unicode[d.postScriptName];v&&(d.metadata.Unicode={},d.metadata.Unicode.widths=v.widths,d.metadata.Unicode.kerning=v.kerning);var g=u.Unicode[d.postScriptName];g&&(d.metadata.Unicode.encoding=g,d.encoding=g.codePages[0])}])}(wt.API),function(e){var t=function(r){for(var n=r.length,i=new Uint8Array(n),a=0;a<n;a++)i[a]=r.charCodeAt(a);return i};e.API.events.push(["addFont",function(r){var n=void 0,i=r.font,a=r.instance;if(!i.isStandardFont){if(a===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");if(typeof(n=a.existsFileInVFS(i.postScriptName)===!1?a.loadFile(i.postScriptName):a.getFileFromVFS(i.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+i.postScriptName+"').");(function(s,o){o=/^\x00\x01\x00\x00/.test(o)?t(o):t(wh(o)),s.metadata=e.API.TTFFont.open(o),s.metadata.Unicode=s.metadata.Unicode||{encoding:{},kerning:{},widths:[]},s.metadata.glyIdsUsed=[0]})(i,n)}}])}(wt),wt.API.addSvgAsImage=function(e,t,r,n,i,a,s,o){if(isNaN(t)||isNaN(r))throw xr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(i))throw xr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var l=document.createElement("canvas");l.width=n,l.height=i;var c=l.getContext("2d");c.fillStyle="#fff",c.fillRect(0,0,l.width,l.height);var u={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},h=this;return(kt.canvg?Promise.resolve(kt.canvg):h1(()=>import("./index.es-DaCNQBnt.js"),__vite__mapDeps([0,1,2,3]))).catch(function(p){return Promise.reject(new Error("Could not load canvg: "+p))}).then(function(p){return p.default?p.default:p}).then(function(p){return p.fromString(c,e,u)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(p){return p.render(u)}).then(function(){h.addImage(l.toDataURL("image/jpeg",1),t,r,n,i,s,o)})},wt.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var i=0;i<this.internal.pages[n].length;i++)this.internal.pages[n][i]=this.internal.pages[n][i].replace(t,r);return this},wt.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,i,a,s={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(s),l=[],c=0,u=0,h=0;function p(v,g){var y,b=!1;for(y=0;y<v.length;y+=1)v[y]===g&&(b=!0);return b}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(s)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var d=o.length;for(h=0;h<d;h+=1)r[o[h]].value=r[o[h]].defaultValue,r[o[h]].explicitSet=!1}if(fr(e)==="object"){for(i in e)if(a=e[i],p(o,i)&&a!==void 0){if(r[i].type==="boolean"&&typeof a=="boolean")r[i].value=a;else if(r[i].type==="name"&&p(r[i].valueSet,a))r[i].value=a;else if(r[i].type==="integer"&&Number.isInteger(a))r[i].value=a;else if(r[i].type==="array"){for(c=0;c<a.length;c+=1)if(n=!0,a[c].length===1&&typeof a[c][0]=="number")l.push(String(a[c]-1));else if(a[c].length>1){for(u=0;u<a[c].length;u+=1)typeof a[c][u]!="number"&&(n=!1);n===!0&&l.push([a[c][0]-1,a[c][1]-1].join(" "))}r[i].value="["+l.join(" ")+"]"}else r[i].value=r[i].defaultValue;r[i].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var v,g=[];for(v in r)r[v].explicitSet===!0&&(r[v].type==="name"?g.push("/"+v+" /"+r[v].value):g.push("/"+v+" "+r[v].value));g.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+g.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',i=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),a=unescape(encodeURIComponent(n)),s=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),l=unescape(encodeURIComponent("</x:xmpmeta>")),c=a.length+s.length+o.length+i.length+l.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+c+" >>"),this.internal.write("stream"),this.internal.write(i+a+s+o+l),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,i){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:i||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}}(wt.API),function(e){var t=e.API,r=t.pdfEscape16=function(a,s){for(var o,l=s.metadata.Unicode.widths,c=["","0","00","000","0000"],u=[""],h=0,p=a.length;h<p;++h){if(o=s.metadata.characterToGlyph(a.charCodeAt(h)),s.metadata.glyIdsUsed.push(o),s.metadata.toUnicode[o]=a.charCodeAt(h),l.indexOf(o)==-1&&(l.push(o),l.push([parseInt(s.metadata.widthOfGlyph(o),10)])),o=="0")return u.join("");o=o.toString(16),u.push(c[4-o.length],o)}return u.join("")},n=function(a){var s,o,l,c,u,h,p;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,l=[],h=0,p=(o=Object.keys(a).sort(function(d,v){return d-v})).length;h<p;h++)s=o[h],l.length>=100&&(u+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar`,l=[]),a[s]!==void 0&&a[s]!==null&&typeof a[s].toString=="function"&&(c=("0000"+a[s].toString(16)).slice(-4),s=("0000"+(+s).toString(16)).slice(-4),l.push("<"+s+"><"+c+">"));return l.length&&(u+=`
`+l.length+` beginbfchar
`+l.join(`
`)+`
endbfchar
`),u+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(a){(function(s){var o=s.font,l=s.out,c=s.newObject,u=s.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="Identity-H"){for(var h=o.metadata.Unicode.widths,p=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),d="",v=0;v<p.length;v++)d+=String.fromCharCode(p[v]);var g=c();u({data:d,addLength1:!0,objectId:g}),l("endobj");var y=c();u({data:n(o.metadata.toUnicode),addLength1:!0,objectId:y}),l("endobj");var b=c();l("<<"),l("/Type /FontDescriptor"),l("/FontName /"+cc(o.fontName)),l("/FontFile2 "+g+" 0 R"),l("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),l("/Flags "+o.metadata.flags),l("/StemV "+o.metadata.stemV),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l(">>"),l("endobj");var E=c();l("<<"),l("/Type /Font"),l("/BaseFont /"+cc(o.fontName)),l("/FontDescriptor "+b+" 0 R"),l("/W "+e.API.PDFObject.convert(h)),l("/CIDToGIDMap /Identity"),l("/DW 1000"),l("/Subtype /CIDFontType2"),l("/CIDSystemInfo"),l("<<"),l("/Supplement 0"),l("/Registry (Adobe)"),l("/Ordering ("+o.encoding+")"),l(">>"),l(">>"),l("endobj"),o.objectNumber=c(),l("<<"),l("/Type /Font"),l("/Subtype /Type0"),l("/ToUnicode "+y+" 0 R"),l("/BaseFont /"+cc(o.fontName)),l("/Encoding /"+o.encoding),l("/DescendantFonts ["+E+" 0 R]"),l(">>"),l("endobj"),o.isAlreadyPutted=!0}})(a)}]),t.events.push(["putFont",function(a){(function(s){var o=s.font,l=s.out,c=s.newObject,u=s.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var h=o.metadata.rawData,p="",d=0;d<h.length;d++)p+=String.fromCharCode(h[d]);var v=c();u({data:p,addLength1:!0,objectId:v}),l("endobj");var g=c();u({data:n(o.metadata.toUnicode),addLength1:!0,objectId:g}),l("endobj");var y=c();l("<<"),l("/Descent "+o.metadata.decender),l("/CapHeight "+o.metadata.capHeight),l("/StemV "+o.metadata.stemV),l("/Type /FontDescriptor"),l("/FontFile2 "+v+" 0 R"),l("/Flags 96"),l("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),l("/FontName /"+cc(o.fontName)),l("/ItalicAngle "+o.metadata.italicAngle),l("/Ascent "+o.metadata.ascender),l(">>"),l("endobj"),o.objectNumber=c();for(var b=0;b<o.metadata.hmtx.widths.length;b++)o.metadata.hmtx.widths[b]=parseInt(o.metadata.hmtx.widths[b]*(1e3/o.metadata.head.unitsPerEm));l("<</Subtype/TrueType/Type/Font/ToUnicode "+g+" 0 R/BaseFont/"+cc(o.fontName)+"/FontDescriptor "+y+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),l("endobj"),o.isAlreadyPutted=!0}})(a)}]);var i=function(a){var s,o=a.text||"",l=a.x,c=a.y,u=a.options||{},h=a.mutex||{},p=h.pdfEscape,d=h.activeFontKey,v=h.fonts,g=d,y="",b=0,E="",S=v[g].encoding;if(v[g].encoding!=="Identity-H")return{text:o,x:l,y:c,options:u,mutex:h};for(E=o,g=d,Array.isArray(o)&&(E=o[0]),b=0;b<E.length;b+=1)v[g].metadata.hasOwnProperty("cmap")&&(s=v[g].metadata.cmap.unicode.codeMap[E[b].charCodeAt(0)]),s||E[b].charCodeAt(0)<256&&v[g].metadata.hasOwnProperty("Unicode")?y+=E[b]:y+="";var P="";return parseInt(g.slice(1))<14||S==="WinAnsiEncoding"?P=p(y,g).split("").map(function(L){return L.charCodeAt(0).toString(16)}).join(""):S==="Identity-H"&&(P=r(y,v[g])),h.isHex=!0,{text:P,x:l,y:c,options:u,mutex:h}};t.events.push(["postProcessText",function(a){var s=a.text||"",o=[],l={text:s,x:a.x,y:a.y,options:a.options,mutex:a.mutex};if(Array.isArray(s)){var c=0;for(c=0;c<s.length;c+=1)Array.isArray(s[c])&&s[c].length===3?o.push([i(Object.assign({},l,{text:s[c][0]})).text,s[c][1],s[c][2]]):o.push(i(Object.assign({},l,{text:s[c]})).text);a.text=o}else a.text=i(Object.assign({},l,{text:s})).text}])}(wt),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}}(wt.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var i,a,s,o,l,c,u,h=t,p=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],d=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],v={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},g={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},y=["(",")","(","<",">","<","[","]","[","{","}","{","¬´","¬ª","¬´","‚Äπ","‚Ä∫","‚Äπ","‚ÅÖ","‚ÅÜ","‚ÅÖ","‚ÅΩ","‚Åæ","‚ÅΩ","‚Çç","‚Çé","‚Çç","‚â§","‚â•","‚â§","‚å©","‚å™","‚å©","Ôπô","Ôπö","Ôπô","Ôπõ","Ôπú","Ôπõ","Ôπù","Ôπû","Ôπù","Ôπ§","Ôπ•","Ôπ§"],b=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),E=!1,S=0;this.__bidiEngine__={};var P=function(_){var j=_.charCodeAt(),H=j>>8,X=g[H];return X!==void 0?h[256*X+(255&j)]:H===252||H===253?"AL":b.test(H)?"L":H===8?"R":"N"},L=function(_){for(var j,H=0;H<_.length;H++){if((j=P(_.charAt(H)))==="L")return!1;if(j==="R")return!0}return!1},q=function(_,j,H,X){var ce,pe,ye,me,be=j[X];switch(be){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":E=!1;break;case"N":case"AN":break;case"EN":E&&(be="AN");break;case"AL":E=!0,be="R";break;case"WS":case"BN":be="N";break;case"CS":X<1||X+1>=j.length||(ce=H[X-1])!=="EN"&&ce!=="AN"||(pe=j[X+1])!=="EN"&&pe!=="AN"?be="N":E&&(pe="AN"),be=pe===ce?pe:"N";break;case"ES":be=(ce=X>0?H[X-1]:"B")==="EN"&&X+1<j.length&&j[X+1]==="EN"?"EN":"N";break;case"ET":if(X>0&&H[X-1]==="EN"){be="EN";break}if(E){be="N";break}for(ye=X+1,me=j.length;ye<me&&j[ye]==="ET";)ye++;be=ye<me&&j[ye]==="EN"?"EN":"N";break;case"NSM":if(s&&!o){for(me=j.length,ye=X+1;ye<me&&j[ye]==="NSM";)ye++;if(ye<me){var Ue=_[X],Fe=Ue>=1425&&Ue<=2303||Ue===64286;if(ce=j[ye],Fe&&(ce==="R"||ce==="AL")){be="R";break}}}be=X<1||(ce=j[X-1])==="B"?"N":H[X-1];break;case"B":E=!1,i=!0,be=S;break;case"S":a=!0,be="N"}return be},C=function(_,j,H){var X=_.split("");return H&&R(X,H,{hiLevel:S}),X.reverse(),j&&j.reverse(),X.join("")},R=function(_,j,H){var X,ce,pe,ye,me,be=-1,Ue=_.length,Fe=0,A=[],F=S?d:p,O=[];for(E=!1,i=!1,a=!1,ce=0;ce<Ue;ce++)O[ce]=P(_[ce]);for(pe=0;pe<Ue;pe++){if(me=Fe,A[pe]=q(_,O,A,pe),X=240&(Fe=F[me][v[A[pe]]]),Fe&=15,j[pe]=ye=F[Fe][5],X>0)if(X===16){for(ce=be;ce<pe;ce++)j[ce]=1;be=-1}else be=-1;if(F[Fe][6])be===-1&&(be=pe);else if(be>-1){for(ce=be;ce<pe;ce++)j[ce]=ye;be=-1}O[pe]==="B"&&(j[pe]=0),H.hiLevel|=ye}a&&function(M,J,fe){for(var ve=0;ve<fe;ve++)if(M[ve]==="S"){J[ve]=S;for(var ae=ve-1;ae>=0&&M[ae]==="WS";ae--)J[ae]=S}}(O,j,Ue)},k=function(_,j,H,X,ce){if(!(ce.hiLevel<_)){if(_===1&&S===1&&!i)return j.reverse(),void(H&&H.reverse());for(var pe,ye,me,be,Ue=j.length,Fe=0;Fe<Ue;){if(X[Fe]>=_){for(me=Fe+1;me<Ue&&X[me]>=_;)me++;for(be=Fe,ye=me-1;be<ye;be++,ye--)pe=j[be],j[be]=j[ye],j[ye]=pe,H&&(pe=H[be],H[be]=H[ye],H[ye]=pe);Fe=me}Fe++}}},G=function(_,j,H){var X=_.split(""),ce={hiLevel:S};return H||(H=[]),R(X,H,ce),function(pe,ye,me){if(me.hiLevel!==0&&u)for(var be,Ue=0;Ue<pe.length;Ue++)ye[Ue]===1&&(be=y.indexOf(pe[Ue]))>=0&&(pe[Ue]=y[be+1])}(X,H,ce),k(2,X,j,H,ce),k(1,X,j,H,ce),X.join("")};return this.__bidiEngine__.doBidiReorder=function(_,j,H){if(function(ce,pe){if(pe)for(var ye=0;ye<ce.length;ye++)pe[ye]=ye;o===void 0&&(o=L(ce)),c===void 0&&(c=L(ce))}(_,j),s||!l||c)if(s&&l&&o^c)S=o?1:0,_=C(_,j,H);else if(!s&&l&&c)S=o?1:0,_=G(_,j,H),_=C(_,j);else if(!s||o||l||c){if(s&&!l&&o^c)_=C(_,j),o?(S=0,_=G(_,j,H)):(S=1,_=G(_,j,H),_=C(_,j));else if(s&&o&&!l&&c)S=1,_=G(_,j,H),_=C(_,j);else if(!s&&!l&&o^c){var X=u;o?(S=1,_=G(_,j,H),S=0,u=!1,_=G(_,j,H),u=X):(S=0,_=G(_,j,H),_=C(_,j),S=1,u=!1,_=G(_,j,H),u=X,_=C(_,j))}}else S=0,_=G(_,j,H);else S=o?1:0,_=G(_,j,H);return _},this.__bidiEngine__.setOptions=function(_){_&&(s=_.isInputVisual,l=_.isOutputVisual,o=_.isInputRtl,c=_.isOutputRtl,u=_.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var i=n.text;n.x,n.y;var a=n.options||{};n.mutex,a.lang;var s=[];if(a.isInputVisual=typeof a.isInputVisual!="boolean"||a.isInputVisual,r.setOptions(a),Object.prototype.toString.call(i)==="[object Array]"){var o=0;for(s=[],o=0;o<i.length;o+=1)Object.prototype.toString.call(i[o])==="[object Array]"?s.push([r.doBidiReorder(i[o][0]),i[o][1],i[o][2]]):s.push([r.doBidiReorder(i[o])]);n.text=s}else n.text=r.doBidiReorder(i);r.setOptions({isInputVisual:!0})}])}(wt),wt.API.TTFFont=function(){function e(t){var r;if(this.rawData=t,r=this.contents=new jo(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new ZZ(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new MZ(this.contents),this.head=new BZ(this),this.name=new qZ(this),this.cmap=new mT(this),this.toUnicode={},this.hhea=new UZ(this),this.maxp=new HZ(this),this.hmtx=new GZ(this),this.post=new zZ(this),this.os2=new $Z(this),this.loca=new XZ(this),this.glyf=new VZ(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,i,a;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var s,o,l,c;for(c=[],s=0,o=(l=this.bbox).length;s<o;s++)t=l[s],c.push(Math.round(t*this.scaleFactor));return c}).call(this),this.stemV=0,this.post.exists?(n=255&(i=this.post.italic_angle),32768&(r=i>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(a=this.familyClass)===1||a===2||a===3||a===4||a===5||a===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var i,a,s,o;for(s=0,a=0,o=(t=""+t).length;0<=o?a<o:a>o;a=0<=o?++a:--a)i=t.charCodeAt(a),s+=this.widthOfGlyph(this.characterToGlyph(i))+n*(1e3/r)||0;return s*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e}();var Ia,jo=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,i;for(i=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)i.push(this.writeByte(t.charCodeAt(r)));return i},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,i,a,s,o,l;return t=this.readByte(),r=this.readByte(),n=this.readByte(),i=this.readByte(),a=this.readByte(),s=this.readByte(),o=this.readByte(),l=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^i)+16777216*(255^a)+65536*(255^s)+256*(255^o)+(255^l)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*i+16777216*a+65536*s+256*o+l},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,i,a;for(a=[],n=0,i=t.length;n<i;n++)r=t[n],a.push(this.writeByte(r));return a},e}(),MZ=function(){var e;function t(r){var n,i,a;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},i=0,a=this.tableCount;0<=a?i<a:i>a;i=0<=a?++i:--i)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,i,a,s,o,l,c,u,h,p,d,v,g;for(g in d=Object.keys(r).length,l=Math.log(2),h=16*Math.floor(Math.log(d)/l),s=Math.floor(h/l),u=16*d-h,(i=new jo).writeInt(this.scalarType),i.writeShort(d),i.writeShort(h),i.writeShort(s),i.writeShort(u),a=16*d,c=i.pos+a,o=null,v=[],r)for(p=r[g],i.writeString(g),i.writeInt(e(p)),i.writeInt(c),i.writeInt(p.length),v=v.concat(p),g==="head"&&(o=c),c+=p.length;c%4;)v.push(0),c++;return i.write(v),n=2981146554-e(i.data),i.pos=o+8,i.writeUInt32(n),i.data},e=function(r){var n,i,a,s;for(r=gT.call(r);r.length%4;)r.push(0);for(a=new jo(r),i=0,n=0,s=r.length;n<s;n=n+=4)i+=a.readUInt32();return 4294967295&i},t}(),RZ={}.hasOwnProperty,ss=function(e,t){for(var r in t)RZ.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};Ia=function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var BZ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ss(e,Ia),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new jo).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e}(),B_=function(){function e(t,r){var n,i,a,s,o,l,c,u,h,p,d,v,g,y,b,E,S;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),h=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(l=0;l<256;++l)this.codeMap[l]=t.readByte();break;case 4:for(d=t.readUInt16(),p=d/2,t.pos+=6,a=function(){var P,L;for(L=[],l=P=0;0<=p?P<p:P>p;l=0<=p?++P:--P)L.push(t.readUInt16());return L}(),t.pos+=2,g=function(){var P,L;for(L=[],l=P=0;0<=p?P<p:P>p;l=0<=p?++P:--P)L.push(t.readUInt16());return L}(),c=function(){var P,L;for(L=[],l=P=0;0<=p?P<p:P>p;l=0<=p?++P:--P)L.push(t.readUInt16());return L}(),u=function(){var P,L;for(L=[],l=P=0;0<=p?P<p:P>p;l=0<=p?++P:--P)L.push(t.readUInt16());return L}(),i=(this.length-t.pos+this.offset)/2,o=function(){var P,L;for(L=[],l=P=0;0<=i?P<i:P>i;l=0<=i?++P:--P)L.push(t.readUInt16());return L}(),l=b=0,S=a.length;b<S;l=++b)for(y=a[l],n=E=v=g[l];v<=y?E<=y:E>=y;n=v<=y?++E:--E)u[l]===0?s=n+c[l]:(s=o[u[l]/2+(n-v)-(p-l)]||0)!==0&&(s+=c[l]),this.codeMap[n]=65535&s}t.pos=h}return e.encode=function(t,r){var n,i,a,s,o,l,c,u,h,p,d,v,g,y,b,E,S,P,L,q,C,R,k,G,_,j,H,X,ce,pe,ye,me,be,Ue,Fe,A,F,O,M,J,fe,ve,ae,ue,oe,le;switch(X=new jo,s=Object.keys(t).sort(function(Be,ge){return Be-ge}),r){case"macroman":for(g=0,y=function(){var Be=[];for(v=0;v<256;++v)Be.push(0);return Be}(),E={0:0},a={},ce=0,be=s.length;ce<be;ce++)E[ae=t[i=s[ce]]]==null&&(E[ae]=++g),a[i]={old:t[i],new:E[t[i]]},y[i]=E[t[i]];return X.writeUInt16(1),X.writeUInt16(0),X.writeUInt32(12),X.writeUInt16(0),X.writeUInt16(262),X.writeUInt16(0),X.write(y),{charMap:a,subtable:X.data,maxGlyphID:g+1};case"unicode":for(j=[],h=[],S=0,E={},n={},b=c=null,pe=0,Ue=s.length;pe<Ue;pe++)E[L=t[i=s[pe]]]==null&&(E[L]=++S),n[i]={old:L,new:E[L]},o=E[L]-i,b!=null&&o===c||(b&&h.push(b),j.push(i),c=o),b=i;for(b&&h.push(b),h.push(65535),j.push(65535),G=2*(k=j.length),R=2*Math.pow(Math.log(k)/Math.LN2,2),p=Math.log(R/2)/Math.LN2,C=2*k-R,l=[],q=[],d=[],v=ye=0,Fe=j.length;ye<Fe;v=++ye){if(_=j[v],u=h[v],_===65535){l.push(0),q.push(0);break}if(_-(H=n[_].new)>=32768)for(l.push(0),q.push(2*(d.length+k-v)),i=me=_;_<=u?me<=u:me>=u;i=_<=u?++me:--me)d.push(n[i].new);else l.push(H-_),q.push(0)}for(X.writeUInt16(3),X.writeUInt16(1),X.writeUInt32(12),X.writeUInt16(4),X.writeUInt16(16+8*k+2*d.length),X.writeUInt16(0),X.writeUInt16(G),X.writeUInt16(R),X.writeUInt16(p),X.writeUInt16(C),fe=0,A=h.length;fe<A;fe++)i=h[fe],X.writeUInt16(i);for(X.writeUInt16(0),ve=0,F=j.length;ve<F;ve++)i=j[ve],X.writeUInt16(i);for(ue=0,O=l.length;ue<O;ue++)o=l[ue],X.writeUInt16(o);for(oe=0,M=q.length;oe<M;oe++)P=q[oe],X.writeUInt16(P);for(le=0,J=d.length;le<J;le++)g=d[le],X.writeUInt16(g);return{charMap:n,subtable:X.data,maxGlyphID:S+1}}},e}(),mT=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ss(e,Ia),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,n,i;for(t.pos=this.offset,this.version=t.readUInt16(),i=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=i?n<i:n>i;n=0<=i?++n:--n)r=new B_(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var n,i;return r==null&&(r="macroman"),n=B_.encode(t,r),(i=new jo).writeUInt16(0),i.writeUInt16(1),n.table=i.data.concat(n.subtable),n},e}(),UZ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ss(e,Ia),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),$Z=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ss(e,Ia),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var r,n;for(n=[],r=0;r<10;++r)n.push(t.readByte());return n}(),this.charRange=function(){var r,n;for(n=[],r=0;r<4;++r)n.push(t.readInt());return n}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(t.readInt());return n}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),zZ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ss(e,Ia),e.prototype.tag="post",e.prototype.parse=function(t){var r,n,i;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var a;for(n=t.readUInt16(),this.glyphNameIndex=[],a=0;0<=n?a<n:a>n;a=0<=n?++a:--a)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],i=[];t.pos<this.offset+this.length;)r=t.readByte(),i.push(this.names.push(t.readString(r)));return i;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 262144:return this.map=(function(){var s,o,l;for(l=[],a=s=0,o=this.file.maxp.numGlyphs;0<=o?s<o:s>o;a=0<=o?++s:--s)l.push(t.readUInt32());return l}).call(this)}},e}(),WZ=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},qZ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ss(e,Ia),e.prototype.tag="name",e.prototype.parse=function(t){var r,n,i,a,s,o,l,c,u,h,p;for(t.pos=this.offset,t.readShort(),r=t.readShort(),o=t.readShort(),n=[],a=0;0<=r?a<r:a>r;a=0<=r?++a:--a)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+o+t.readShort()});for(l={},a=u=0,h=n.length;u<h;a=++u)i=n[a],t.pos=i.offset,c=t.readString(i.length),s=new WZ(c,i),l[p=i.nameID]==null&&(l[p]=[]),l[i.nameID].push(s);this.strings=l,this.copyright=l[0],this.fontFamily=l[1],this.fontSubfamily=l[2],this.uniqueSubfamily=l[3],this.fontName=l[4],this.version=l[5];try{this.postscriptName=l[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=l[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=l[7],this.manufacturer=l[8],this.designer=l[9],this.description=l[10],this.vendorUrl=l[11],this.designerUrl=l[12],this.license=l[13],this.licenseUrl=l[14],this.preferredFamily=l[15],this.preferredSubfamily=l[17],this.compatibleFull=l[18],this.sampleText=l[19]},e}(),HZ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ss(e,Ia),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),GZ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ss(e,Ia),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,n,i,a,s,o,l;for(t.pos=this.offset,this.metrics=[],r=0,o=this.file.hhea.numberOfMetrics;0<=o?r<o:r>o;r=0<=o?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(i=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var c,u;for(u=[],r=c=0;0<=i?c<i:c>i;r=0<=i?++c:--c)u.push(t.readInt16());return u}(),this.widths=(function(){var c,u,h,p;for(p=[],c=0,u=(h=this.metrics).length;c<u;c++)a=h[c],p.push(a.advance);return p}).call(this),n=this.widths[this.widths.length-1],l=[],r=s=0;0<=i?s<i:s>i;r=0<=i?++s:--s)l.push(this.widths.push(n));return l},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),gT=[].slice,VZ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ss(e,Ia),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,n,i,a,s,o,l,c,u,h;return t in this.cache?this.cache[t]:(a=this.file.loca,r=this.file.contents,n=a.indexOf(t),(i=a.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+n,s=(o=new jo(r.read(i))).readShort(),c=o.readShort(),h=o.readShort(),l=o.readShort(),u=o.readShort(),this.cache[t]=s===-1?new YZ(o,c,h,l,u):new KZ(o,s,c,h,l,u),this.cache[t]))},e.prototype.encode=function(t,r,n){var i,a,s,o,l;for(s=[],a=[],o=0,l=r.length;o<l;o++)i=t[r[o]],a.push(s.length),i&&(s=s.concat(i.encode(n)));return a.push(s.length),{table:s,offsets:a}},e}(),KZ=function(){function e(t,r,n,i,a,s){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=i,this.xMax=a,this.yMax=s,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),YZ=function(){function e(t,r,n,i,a){var s,o;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=i,this.yMax=a,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],s=this.raw;o=s.readShort(),this.glyphOffsets.push(s.pos),this.glyphIDs.push(s.readUInt16()),32&o;)s.pos+=1&o?4:2,128&o?s.pos+=8:64&o?s.pos+=4:8&o&&(s.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new jo(gT.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e}(),XZ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ss(e,Ia),e.prototype.tag="loca",e.prototype.parse=function(t){var r,n;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?(function(){var i,a;for(a=[],n=0,i=this.length;n<i;n+=2)a.push(2*t.readUInt16());return a}).call(this):(function(){var i,a;for(a=[],n=0,i=this.length;n<i;n+=4)a.push(t.readUInt32());return a}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var n=new Uint32Array(this.offsets.length),i=0,a=0,s=0;s<n.length;++s)if(n[s]=i,a<r.length&&r[a]==s){++a,n[s]=i;var o=this.offsets[s],l=this.offsets[s+1]-o;l>0&&(i+=l)}for(var c=new Array(4*n.length),u=0;u<n.length;++u)c[4*u+3]=255&n[u],c[4*u+2]=(65280&n[u])>>8,c[4*u+1]=(16711680&n[u])>>16,c[4*u]=(4278190080&n[u])>>24;return c},e}(),ZZ=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,i,a;for(r in i=this.font.cmap.tables[0].codeMap,t={},a=this.subset)n=a[r],t[r]=i[n];return t},e.prototype.glyphsFor=function(t){var r,n,i,a,s,o,l;for(i={},s=0,o=t.length;s<o;s++)i[a=t[s]]=this.font.glyf.glyphFor(a);for(a in r=[],i)(n=i[a])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(a in l=this.glyphsFor(r))n=l[a],i[a]=n;return i},e.prototype.encode=function(t,r){var n,i,a,s,o,l,c,u,h,p,d,v,g,y,b;for(i in n=mT.encode(this.generateCmap(),"unicode"),s=this.glyphsFor(t),d={0:0},b=n.charMap)d[(l=b[i]).old]=l.new;for(v in p=n.maxGlyphID,s)v in d||(d[v]=p++);return u=function(E){var S,P;for(S in P={},E)P[E[S]]=S;return P}(d),h=Object.keys(u).sort(function(E,S){return E-S}),g=function(){var E,S,P;for(P=[],E=0,S=h.length;E<S;E++)o=h[E],P.push(u[o]);return P}(),a=this.font.glyf.encode(s,g,d),c=this.font.loca.encode(a.offsets,g),y={cmap:this.font.cmap.raw(),glyf:a.table,loca:c,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&(y["OS/2"]=this.font.os2.raw()),this.font.directory.encode(y)},e}();wt.API.PDFObject=function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,i,a,s;if(Array.isArray(r))return"["+function(){var o,l,c;for(c=[],o=0,l=r.length;o<l;o++)n=r[o],c.push(t.convert(n));return c}().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r!=null&&r.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(i in a=["<<"],r)s=r[i],a.push("/"+i+" "+t.convert(s));return a.push(">>"),a.join(`
`)}return""+r},t}();const JZ=()=>{const{user:e}=Hi(),[t,r]=z.useState({totalPurchases:0,totalPayments:0,netOutstanding:0,supplierBreakdown:[],pieChartData:[]}),[n,i]=z.useState([]),[a,s]=z.useState(!0),[o,l]=z.useState(""),[c,u]=z.useState(""),[h,p]=z.useState(!1);z.useEffect(()=>{const S=new Date,P=new Date(S);P.setDate(S.getDate()-30),l(P.toISOString().split("T")[0]),u(S.toISOString().split("T")[0])},[]),z.useEffect(()=>{o&&c&&d()},[e,o,c]),z.useEffect(()=>{const S=()=>{h&&p(!1)};return document.addEventListener("mousedown",S),()=>{document.removeEventListener("mousedown",S)}},[h]);const d=async()=>{if(e)try{s(!0);const{data:S,error:P}=await et.from("transactions").select(`
          *,
          supplier:suppliers(name)
        `).eq("user_id",e.id).gte("created_at",o).lte("created_at",c+"T23:59:59").order("created_at",{ascending:!1});if(P)throw P;i(S||[]);const L=new Map;let q=0,C=0;S==null||S.forEach(j=>{var pe;const H=((pe=j.supplier)==null?void 0:pe.name)||"Unknown",X=parseFloat(j.amount.toString());L.has(H)||L.set(H,{supplier:H,purchases:0,payments:0,outstanding:0});const ce=L.get(H);j.type==="new_purchase"?(ce.purchases+=X,q+=X,j.is_paid||(ce.outstanding+=X)):(j.type==="pay_due"||j.type==="settle_bill")&&(ce.payments+=X,C+=X,ce.outstanding-=X),L.set(H,ce)});const R=Array.from(L.values()).sort((j,H)=>H.purchases-j.purchases),k=R.reduce((j,H)=>j+H.outstanding,0),G=["#3B82F6","#EF4444","#10B981","#F59E0B","#8B5CF6","#EC4899","#14B8A6","#F97316","#6366F1","#84CC16"],_=R.filter(j=>j.purchases>0).slice(0,10).map((j,H)=>({name:j.supplier,value:j.purchases,color:G[H%G.length]}));r({totalPurchases:q,totalPayments:C,netOutstanding:Math.max(0,k),supplierBreakdown:R,pieChartData:_})}catch(S){console.error("Error fetching report data:",S)}finally{s(!1)}},v=()=>{const S=["Date","Supplier","Type","Description","Amount","Status","Due Date"],P=n.map(k=>{var G;return[new Date(k.created_at).toLocaleDateString("en-IN"),((G=k.supplier)==null?void 0:G.name)||"Unknown",b(k.type),k.description,parseFloat(k.amount.toString()),k.is_paid?"Paid":"Unpaid",k.due_date?new Date(k.due_date).toLocaleDateString("en-IN"):""]}),L=[S.join(","),...P.map(k=>k.map(G=>`"${G}"`).join(","))].join(`
`),q=new Blob([L],{type:"text/csv;charset=utf-8;"}),C=document.createElement("a"),R=URL.createObjectURL(q);C.setAttribute("href",R),C.setAttribute("download",`transactions-report-${o}-to-${c}.csv`),C.style.visibility="hidden",document.body.appendChild(C),C.click(),document.body.removeChild(C)},g=()=>{const S=Gu.json_to_sheet(n.map(C=>{var R;return{Date:new Date(C.created_at).toLocaleDateString("en-IN"),Supplier:((R=C.supplier)==null?void 0:R.name)||"Unknown",Type:b(C.type),Description:C.description,Amount:parseFloat(C.amount.toString()),Status:C.is_paid?"Paid":"Unpaid","Due Date":C.due_date?new Date(C.due_date).toLocaleDateString("en-IN"):""}})),P=Gu.book_new();Gu.book_append_sheet(P,S,"Transactions");const L=[{Metric:"Total Purchases",Value:t.totalPurchases},{Metric:"Total Payments",Value:t.totalPayments},{Metric:"Net Outstanding",Value:t.netOutstanding}],q=Gu.json_to_sheet(L);Gu.book_append_sheet(P,q,"Summary"),RV(P,`transactions-report-${o}-to-${c}.xlsx`)},y=()=>{const S=new wt;S.setFontSize(20),S.text("Transaction Report",20,20),S.setFontSize(12),S.text(`Period: ${o} to ${c}`,20,35),S.setFontSize(14),S.text("Summary",20,55),S.setFontSize(10),S.text(`Total Purchases: ‚Çπ${t.totalPurchases.toLocaleString()}`,20,70),S.text(`Total Payments: ‚Çπ${t.totalPayments.toLocaleString()}`,20,80),S.text(`Net Outstanding: ‚Çπ${t.netOutstanding.toLocaleString()}`,20,90),S.setFontSize(14),S.text("Top Suppliers by Purchases",20,110),S.setFontSize(10);let P=125;t.supplierBreakdown.slice(0,15).forEach((L,q)=>{P>270&&(S.addPage(),P=20),S.text(`${q+1}. ${L.supplier}: ‚Çπ${L.purchases.toLocaleString()}`,20,P),P+=10}),S.save(`transactions-report-${o}-to-${c}.pdf`)},b=S=>{switch(S){case"new_purchase":return"New Purchase";case"pay_due":return"Payment";case"settle_bill":return"Settlement";default:return S}},E=S=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(S);return f.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[f.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-4",children:[f.jsxs("div",{children:[f.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-900",children:"Reports"}),f.jsx("p",{className:"text-gray-600 mt-1",children:"Analyze your supplier transactions and purchases"})]}),f.jsxs("div",{className:"relative export-dropdown",children:[f.jsxs("button",{onClick:()=>p(!h),disabled:n.length===0,className:"w-full sm:w-auto bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center disabled:opacity-50 disabled:cursor-not-allowed",children:[f.jsx(jc,{className:"h-4 w-4 mr-2"}),"Export"]}),h&&f.jsx("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-20",children:f.jsxs("div",{className:"py-2",children:[f.jsxs("button",{onClick:()=>{v(),p(!1)},className:"w-full text-left px-4 py-2 hover:bg-gray-50 flex items-center text-gray-700",children:[f.jsx(vf,{className:"h-4 w-4 mr-3 text-green-600"}),"Export as CSV"]}),f.jsxs("button",{onClick:()=>{g(),p(!1)},className:"w-full text-left px-4 py-2 hover:bg-gray-50 flex items-center text-gray-700",children:[f.jsx(m8,{className:"h-4 w-4 mr-3 text-blue-600"}),"Export as Excel"]}),f.jsxs("button",{onClick:()=>{y(),p(!1)},className:"w-full text-left px-4 py-2 hover:bg-gray-50 flex items-center text-gray-700",children:[f.jsx(jc,{className:"h-4 w-4 mr-3 text-red-600"}),"Export as PDF"]})]})})]})]}),f.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:f.jsxs("div",{className:"flex flex-col space-y-4 sm:flex-row sm:items-center sm:space-y-0 sm:space-x-4",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(Rg,{className:"h-5 w-5 text-gray-400"}),f.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Date Filter"})]}),f.jsxs("div",{className:"flex flex-col space-y-3 sm:flex-row sm:items-center sm:space-y-0 sm:space-x-4 sm:ml-auto",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(mc,{className:"h-4 w-4 text-gray-400"}),f.jsx("label",{className:"text-sm font-medium text-gray-700 min-w-max",children:"From:"}),f.jsx("input",{type:"date",value:o,onChange:S=>l(S.target.value),className:"flex-1 border border-gray-300 rounded-lg px-3 py-1.5 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("label",{className:"text-sm font-medium text-gray-700 min-w-max",children:"To:"}),f.jsx("input",{type:"date",value:c,onChange:S=>u(S.target.value),className:"flex-1 border border-gray-300 rounded-lg px-3 py-1.5 text-sm focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]})]})]})}),a?f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:[f.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:f.jsxs("div",{className:"flex items-center",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Purchases"}),f.jsx("p",{className:"text-xl sm:text-2xl font-bold text-blue-600",children:E(t.totalPurchases)})]}),f.jsx(K_,{className:"h-6 w-6 sm:h-8 sm:w-8 text-blue-600"})]})}),f.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:f.jsxs("div",{className:"flex items-center",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Payments"}),f.jsx("p",{className:"text-xl sm:text-2xl font-bold text-green-600",children:E(t.totalPayments)})]}),f.jsx(g8,{className:"h-6 w-6 sm:h-8 sm:w-8 text-green-600"})]})}),f.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6 sm:col-span-2 lg:col-span-1",children:f.jsxs("div",{className:"flex items-center",children:[f.jsxs("div",{className:"flex-1",children:[f.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Outstanding Due"}),f.jsx("p",{className:"text-xl sm:text-2xl font-bold text-red-600",children:E(t.netOutstanding)})]}),f.jsx(af,{className:"h-6 w-6 sm:h-8 sm:w-8 text-red-600"})]})})]}),f.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:[f.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-4 sm:mb-6",children:[f.jsxs("div",{children:[f.jsx("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:"Purchase Distribution by Suppliers"}),f.jsx("p",{className:"text-gray-600 mt-1 text-sm sm:text-base",children:"Shows purchase amounts from each supplier"})]}),f.jsx(ey,{className:"h-6 w-6 text-gray-400 mt-2 sm:mt-0"})]}),t.pieChartData.length>0?f.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-4 sm:gap-6",children:[f.jsx("div",{className:"h-64 sm:h-80",children:f.jsx(KM,{width:"100%",height:"100%",children:f.jsxs(oU,{children:[f.jsx(vA,{data:t.pieChartData,cx:"50%",cy:"50%",outerRadius:80,fill:"#8884d8",dataKey:"value",children:t.pieChartData.map((S,P)=>f.jsx(bp,{fill:S.color},`cell-${P}`))}),f.jsx(zM,{formatter:S=>[E(Number(S)),"Purchases"],labelFormatter:S=>`${S}`})]})})}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top Suppliers"}),f.jsx("div",{className:"space-y-3",children:t.pieChartData.slice(0,8).map(S=>f.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx("div",{className:"w-4 h-4 rounded-full mr-3",style:{backgroundColor:S.color}}),f.jsx("span",{className:"font-medium text-gray-900",children:S.name})]}),f.jsx("span",{className:"text-gray-600 font-semibold",children:E(S.value)})]},S.name))})]})]}):f.jsxs("div",{className:"text-center py-12",children:[f.jsx(ey,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),f.jsx("p",{className:"text-gray-500",children:"No purchase data available for the selected period"})]})]}),f.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 sm:p-6",children:[f.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-4 sm:mb-6",children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Detailed Supplier Breakdown"}),f.jsx(af,{className:"h-5 w-5 text-gray-400 mt-2 sm:mt-0"})]}),t.supplierBreakdown.length>0?f.jsx("div",{className:"space-y-3 sm:space-y-4",children:t.supplierBreakdown.map((S,P)=>f.jsxs("div",{className:"border border-gray-200 rounded-lg p-3 sm:p-4",children:[f.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-3",children:[f.jsx("h3",{className:"font-medium text-gray-900 text-sm sm:text-base",children:S.supplier}),f.jsxs("span",{className:"text-xs sm:text-sm font-medium text-blue-600 mt-1 sm:mt-0",children:["Outstanding: ",E(S.outstanding)]})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-3 sm:gap-4 text-xs sm:text-sm",children:[f.jsxs("div",{children:[f.jsx("p",{className:"text-gray-600",children:"Total Purchases"}),f.jsx("p",{className:"font-medium text-red-600",children:E(S.purchases)})]}),f.jsxs("div",{children:[f.jsx("p",{className:"text-gray-600",children:"Total Payments"}),f.jsx("p",{className:"font-medium text-green-600",children:E(S.payments)})]})]})]},P))}):f.jsxs("div",{className:"text-center py-6 sm:py-8",children:[f.jsx(af,{className:"h-10 w-10 sm:h-12 sm:w-12 text-gray-400 mx-auto mb-4"}),f.jsx("p",{className:"text-gray-500 text-sm sm:text-base",children:"No data available for the selected period"})]})]})]})]})};class cl{constructor(){this.isAuthenticated=!1,this.userEmail=""}static getInstance(){return cl.instance||(cl.instance=new cl),cl.instance}async initializeGoogleDrive(){console.log("Initializing Google Drive API...")}async authenticate(){try{return new Promise(t=>{setTimeout(()=>{this.isAuthenticated=!0,this.userEmail="user@gmail.com",t({success:!0,userEmail:this.userEmail})},2e3)})}catch(t){return console.error("Google Drive authentication failed:",t),{success:!1,userEmail:""}}}isConnected(){return this.isAuthenticated}getConnectedEmail(){return this.userEmail}async createBackup(t){try{return console.log("Creating backup on Google Drive...",t),new Promise(r=>{setTimeout(()=>{r({success:!0,fileId:`shopsynk-backup-${Date.now()}`})},3e3)})}catch(r){return console.error("Backup creation failed:",r),{success:!1}}}async scheduleAutoBackup(t){console.log("Auto backup scheduled for midnight daily");const r=new Date,n=new Date;n.setHours(24,0,0,0);const i=n.getTime()-r.getTime();setTimeout(()=>{t(),setInterval(t,24*60*60*1e3)},i)}disconnect(){this.isAuthenticated=!1,this.userEmail=""}}class ul{constructor(){this.googleDriveService=cl.getInstance()}static getInstance(){return ul.instance||(ul.instance=new ul),ul.instance}async exportUserData(t,r){try{const{data:n,error:i}=await et.from("suppliers").select("*").eq("user_id",t);if(i)throw i;const{data:a,error:s}=await et.from("transactions").select(`
          *,
          supplier:suppliers(name, contact_person, phone, email)
        `).eq("user_id",t);if(s)throw s;return{suppliers:n||[],transactions:a||[],exportDate:new Date().toISOString(),userEmail:r}}catch(n){return console.error("Error exporting user data:",n),null}}async createBackup(t,r){try{if(!this.googleDriveService.isConnected())return{success:!1,message:"Google Drive not connected. Please connect first."};const n=await this.exportUserData(t,r);if(!n)return{success:!1,message:"Failed to export user data."};const i=await this.googleDriveService.createBackup(n);return i.success?(await this.recordBackup(t,i.fileId||"",n),{success:!0,message:"Backup created successfully on Google Drive!"}):{success:!1,message:"Failed to upload backup to Google Drive."}}catch(n){return console.error("Backup creation error:",n),{success:!1,message:"An error occurred during backup creation."}}}async recordBackup(t,r,n){try{await et.from("user_backups").insert([{user_id:t,backup_date:new Date().toISOString(),google_drive_file_id:r,suppliers_count:n.suppliers.length,transactions_count:n.transactions.length,backup_size:JSON.stringify(n).length,status:"completed"}])}catch(i){console.error("Error recording backup:",i)}}async setupAutoBackup(t,r){const n=async()=>{console.log("Running automatic backup...");const i=await this.createBackup(t,r);console.log("Auto backup result:",i.message),await this.sendBackupNotification(r,i.success)};await this.googleDriveService.scheduleAutoBackup(n)}async sendBackupNotification(t,r){console.log(`Backup notification sent to ${t}: ${r?"Success":"Failed"}`)}async getBackupHistory(t){try{const{data:r,error:n}=await et.from("user_backups").select("*").eq("user_id",t).order("backup_date",{ascending:!1}).limit(10);if(n)throw n;return r||[]}catch(r){return console.error("Error fetching backup history:",r),[]}}downloadBackupFile(t){const r=JSON.stringify(t,null,2),n=new Blob([r],{type:"application/json"}),i=URL.createObjectURL(n),a=document.createElement("a");a.href=i,a.download=`shopsynk-backup-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(i)}}const QZ=()=>{const{user:e}=Hi(),[t,r]=z.useState(null),[n,i]=z.useState(!0),[a,s]=z.useState("pdf"),[o,l]=z.useState(!1),[c,u]=z.useState(!1),[h,p]=z.useState("");z.useEffect(()=>{d()},[e]);const d=async()=>{if(e)try{i(!0);const{count:L}=await et.from("transactions").select("*",{count:"exact",head:!0}).eq("user_id",e.id),{count:q}=await et.from("suppliers").select("*",{count:"exact",head:!0}).eq("user_id",e.id),{count:C}=await et.from("business_owners").select("*",{count:"exact",head:!0}).eq("user_id",e.id),{data:R}=await et.from("user_backups").select("created_at").eq("user_id",e.id).order("created_at",{ascending:!1}).limit(1).single(),k=.5,G=.3,_=.2,j=.1,H=(L||0)*k,X=(q||0)*G,ce=(C||0)*_,pe=H+X+ce+j;r({totalTransactions:L||0,totalSuppliers:q||0,totalOwners:C||0,estimatedSizeKB:pe,lastBackup:(R==null?void 0:R.created_at)||null,dataBreakdown:{transactions:{count:L||0,sizeKB:H},suppliers:{count:q||0,sizeKB:X},owners:{count:C||0,sizeKB:ce},settings:{count:1,sizeKB:j}}})}catch(L){console.error("Error fetching storage stats:",L)}finally{i(!1)}},v=async L=>{if(e)try{l(!0);const[q,C,R]=await Promise.all([et.from("transactions").select("*, supplier:suppliers(name), owner:business_owners(owner_name)").eq("user_id",e.id).order("created_at",{ascending:!1}),et.from("suppliers").select("*").eq("user_id",e.id).order("name"),et.from("business_owners").select("*").eq("user_id",e.id).order("owner_name")]),k={exportDate:new Date().toISOString(),user:{id:e.id,email:e.email},summary:t,data:{transactions:q.data||[],suppliers:C.data||[],businessOwners:R.data||[]}};L==="json"?g(k):L==="csv"?y(k):L==="pdf"&&b(k)}catch(q){console.error("Error downloading data:",q),alert("Error downloading data. Please try again.")}finally{l(!1)}},g=L=>{const q=new Blob([JSON.stringify(L,null,2)],{type:"application/json"}),C=URL.createObjectURL(q),R=document.createElement("a");R.href=C,R.download=`shopsynk-data-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(R),R.click(),document.body.removeChild(R),URL.revokeObjectURL(C)},y=L=>{let q="Type,Supplier,Amount,Description,Date,Due Date,Status,Handled By\\n";L.data.transactions.forEach(G=>{var _,j;q+=`${G.type},"${((_=G.supplier)==null?void 0:_.name)||"Unknown"}",${G.amount},"${G.description}",${G.created_at},${G.due_date||""},${G.is_paid?"Paid":"Unpaid"},"${((j=G.owner)==null?void 0:j.owner_name)||"Unknown"}"\\n`});const C=new Blob([q],{type:"text/csv"}),R=URL.createObjectURL(C),k=document.createElement("a");k.href=R,k.download=`shopsynk-transactions-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(k),k.click(),document.body.removeChild(k),URL.revokeObjectURL(R)},b=L=>{const q=`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Shopsynk Data Export</title>
        <style>
          body { font-family: Arial, sans-serif; margin: 20px; }
          h1, h2 { color: #2563eb; }
          table { width: 100%; border-collapse: collapse; margin: 20px 0; }
          th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
          th { background-color: #f8f9fa; }
          .summary { background-color: #f0f9ff; padding: 15px; border-radius: 5px; margin: 20px 0; }
        </style>
      </head>
      <body>
        <h1>Shopsynk Data Export</h1>
        <p><strong>Export Date:</strong> ${new Date().toLocaleDateString()}</p>
        <p><strong>User:</strong> ${(e==null?void 0:e.email)||"Unknown"}</p>
        
        <div class="summary">
          <h2>Summary</h2>
          <p><strong>Total Transactions:</strong> ${t==null?void 0:t.totalTransactions}</p>
          <p><strong>Total Suppliers:</strong> ${t==null?void 0:t.totalSuppliers}</p>
          <p><strong>Total Owners:</strong> ${t==null?void 0:t.totalOwners}</p>
          <p><strong>Estimated Size:</strong> ${((t==null?void 0:t.estimatedSizeKB)||0).toFixed(2)} KB</p>
        </div>

        <h2>Recent Transactions</h2>
        <table>
          <tr>
            <th>Date</th>
            <th>Type</th>
            <th>Supplier</th>
            <th>Amount</th>
            <th>Status</th>
            <th>Handled By</th>
          </tr>
          ${L.data.transactions.slice(0,50).map(G=>{var _,j;return`
            <tr>
              <td>${new Date(G.created_at).toLocaleDateString()}</td>
              <td>${G.type}</td>
              <td>${((_=G.supplier)==null?void 0:_.name)||"Unknown"}</td>
              <td>‚Çπ${G.amount}</td>
              <td>${G.is_paid?"Paid":"Unpaid"}</td>
              <td>${((j=G.owner)==null?void 0:j.owner_name)||"Unknown"}</td>
            </tr>
          `}).join("")}
        </table>
      </body>
      </html>
    `,C=new Blob([q],{type:"text/html"}),R=URL.createObjectURL(C),k=document.createElement("a");k.href=R,k.download=`shopsynk-report-${new Date().toISOString().split("T")[0]}.html`,document.body.appendChild(k),k.click(),document.body.removeChild(k),URL.revokeObjectURL(R)},E=async()=>{if(e)try{u(!0),p("Preparing backup...");const L=ul.getInstance();p("Creating backup..."),await L.createBackup(e.id,e.email||"unknown@email.com"),p("Backup completed successfully!"),setTimeout(()=>p(""),3e3),await d()}catch(L){console.error("Error creating manual backup:",L),p("Backup failed. Please try again."),setTimeout(()=>p(""),3e3)}finally{u(!1)}},S=L=>L<1?`${(L*1024).toFixed(0)} bytes`:L<1024?`${L.toFixed(2)} KB`:`${(L/1024).toFixed(2)} MB`,P=L=>L?new Date(L).toLocaleString():"Never";return n?f.jsxs("div",{className:"flex items-center justify-center h-64",children:[f.jsx(_s,{className:"h-8 w-8 animate-spin text-blue-500"}),f.jsx("span",{className:"ml-2 text-gray-600",children:"Loading storage information..."})]}):f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Data Storage & Export"}),f.jsxs("button",{onClick:d,className:"flex items-center px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50",children:[f.jsx(_s,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[f.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:f.jsxs("div",{className:"flex items-center",children:[f.jsx(Sm,{className:"h-8 w-8 text-blue-500"}),f.jsxs("div",{className:"ml-4",children:[f.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Storage"}),f.jsx("p",{className:"text-2xl font-bold text-gray-900",children:S((t==null?void 0:t.estimatedSizeKB)||0)})]})]})}),f.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:f.jsxs("div",{className:"flex items-center",children:[f.jsx(ja,{className:"h-8 w-8 text-green-500"}),f.jsxs("div",{className:"ml-4",children:[f.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Transactions"}),f.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t==null?void 0:t.totalTransactions})]})]})}),f.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:f.jsxs("div",{className:"flex items-center",children:[f.jsx(ty,{className:"h-8 w-8 text-purple-500"}),f.jsxs("div",{className:"ml-4",children:[f.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Suppliers"}),f.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t==null?void 0:t.totalSuppliers})]})]})}),f.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:f.jsxs("div",{className:"flex items-center",children:[f.jsx(Qa,{className:"h-8 w-8 text-orange-500"}),f.jsxs("div",{className:"ml-4",children:[f.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Business Owners"}),f.jsx("p",{className:"text-2xl font-bold text-gray-900",children:t==null?void 0:t.totalOwners})]})]})})]}),f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Storage Breakdown"}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx(ja,{className:"h-5 w-5 text-green-500 mr-3"}),f.jsx("span",{className:"font-medium",children:"Transactions Data"})]}),f.jsxs("div",{className:"text-right",children:[f.jsxs("p",{className:"font-medium",children:[t==null?void 0:t.dataBreakdown.transactions.count," records"]}),f.jsx("p",{className:"text-sm text-gray-500",children:S((t==null?void 0:t.dataBreakdown.transactions.sizeKB)||0)})]})]}),f.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx(ty,{className:"h-5 w-5 text-purple-500 mr-3"}),f.jsx("span",{className:"font-medium",children:"Suppliers Data"})]}),f.jsxs("div",{className:"text-right",children:[f.jsxs("p",{className:"font-medium",children:[t==null?void 0:t.dataBreakdown.suppliers.count," records"]}),f.jsx("p",{className:"text-sm text-gray-500",children:S((t==null?void 0:t.dataBreakdown.suppliers.sizeKB)||0)})]})]}),f.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx(Qa,{className:"h-5 w-5 text-orange-500 mr-3"}),f.jsx("span",{className:"font-medium",children:"Business Owners"})]}),f.jsxs("div",{className:"text-right",children:[f.jsxs("p",{className:"font-medium",children:[t==null?void 0:t.dataBreakdown.owners.count," records"]}),f.jsx("p",{className:"text-sm text-gray-500",children:S((t==null?void 0:t.dataBreakdown.owners.sizeKB)||0)})]})]})]})]}),f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Export Data"}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Export Format"}),f.jsxs("select",{value:a,onChange:L=>s(L.target.value),className:"w-full md:w-64 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[f.jsx("option",{value:"pdf",children:"PDF Report"}),f.jsx("option",{value:"csv",children:"CSV (Spreadsheet)"}),f.jsx("option",{value:"json",children:"JSON (Raw Data)"})]})]}),f.jsx("div",{className:"flex flex-wrap gap-3",children:f.jsxs("button",{onClick:()=>v(a),disabled:o,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[o?f.jsx(_s,{className:"h-4 w-4 mr-2 animate-spin"}):f.jsx(jc,{className:"h-4 w-4 mr-2"}),o?"Preparing...":`Download ${a.toUpperCase()}`]})}),f.jsxs("div",{className:"text-sm text-gray-500",children:[f.jsx("p",{children:"‚Ä¢ PDF: Formatted report with summary and recent transactions"}),f.jsx("p",{children:"‚Ä¢ CSV: Spreadsheet format for analysis and import"}),f.jsx("p",{children:"‚Ä¢ JSON: Complete raw data for technical use"})]})]})]}),f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Backup Management"}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 rounded-lg border border-blue-200",children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx(gc,{className:"h-6 w-6 text-blue-500 mr-3"}),f.jsxs("div",{children:[f.jsx("p",{className:"font-medium text-blue-900",children:"Last Backup"}),f.jsx("p",{className:"text-sm text-blue-700",children:P((t==null?void 0:t.lastBackup)||null)})]})]}),f.jsxs("button",{onClick:E,disabled:c,className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[c?f.jsx(_s,{className:"h-4 w-4 mr-2 animate-spin"}):f.jsx(v8,{className:"h-4 w-4 mr-2"}),c?"Creating Backup...":"Create Backup Now"]})]}),h&&f.jsxs("div",{className:`flex items-center p-3 rounded-lg ${h.includes("failed")?"bg-red-50 border border-red-200 text-red-700":h.includes("success")?"bg-green-50 border border-green-200 text-green-700":"bg-yellow-50 border border-yellow-200 text-yellow-700"}`,children:[h.includes("failed")?f.jsx(Es,{className:"h-5 w-5 mr-2"}):h.includes("success")?f.jsx(pi,{className:"h-5 w-5 mr-2"}):f.jsx(_s,{className:"h-5 w-5 mr-2 animate-spin"}),h]}),f.jsxs("div",{className:"text-sm text-gray-500",children:[f.jsx("p",{children:"‚Ä¢ Automatic backups run daily when configured"}),f.jsx("p",{children:"‚Ä¢ Manual backups are stored in your connected Google Drive"}),f.jsx("p",{children:"‚Ä¢ Configure automatic backups in your Profile settings"})]})]})]})]})},vT=[{id:"v1.2",version:"1.1",name:"The Navigation Update",date:"September 5, 2025",type:"major",color:"purple",current:!0,description:"Complete mobile navigation redesign with enhanced user experience and comprehensive documentation.",features:[{category:"Mobile Navigation",icon:Xu,color:"purple",items:["Complete mobile navigation redesign with bottom navigation bar","Replaced hamburger menu with thumb-friendly bottom navigation","Enhanced touch targets and gesture support","Improved mobile responsiveness across all pages","Optimized PWA experience for mobile devices"]},{category:"Documentation System",icon:X_,color:"blue",items:["Card-based documentation system with dedicated pages","Enhanced mobile experience guide","Comprehensive version history tracking","Interactive documentation navigation","Improved accessibility and user experience"]},{category:"User Experience",icon:sf,color:"green",items:["Mobile-first design philosophy implementation","Improved navigation patterns for better usability","Enhanced visual feedback and transitions","Better content organization and discovery","Responsive design improvements across all components"]}],impact:"This major update transforms Shopsynk into a truly mobile-first application with modern navigation patterns and comprehensive documentation. Users can now enjoy a seamless experience across all devices with improved accessibility and usability.",breaking:!1,migration:[]},{id:"v1.2",version:"1.00",name:"Initial Release",date:"September 1, 2025",type:"major",color:"blue",current:!1,description:"First stable release of Shopsynk with core supplier management functionality.",features:[{category:"Core Features",icon:Q_,color:"blue",items:["Complete supplier management system","Transaction tracking with CRUD operations","Comprehensive reporting and analytics","Data backup and export functionality","PWA support with offline capabilities"]},{category:"User Interface",icon:w8,color:"green",items:["Clean and intuitive dashboard design","Responsive layout for desktop and mobile","Professional business-focused styling","Accessible form controls and navigation","Modern Material Design principles"]},{category:"Technical Foundation",icon:Bg,color:"orange",items:["React + TypeScript architecture","Supabase backend integration","Tailwind CSS styling system","Vite build tooling","Progressive Web App configuration"]}],impact:"Established the foundation for modern supplier management with essential features for tracking suppliers, managing transactions, and generating reports. Set the technical architecture for future enhancements.",breaking:!1,migration:[]},{id:"v0.9",version:"0.9",name:"Beta Release",date:"August 25, 2025",type:"minor",color:"orange",current:!1,description:"Feature-complete beta with testing and optimization focus.",features:[{category:"Testing & Quality",icon:pi,color:"green",items:["Comprehensive testing suite implementation","Performance optimization and profiling","Cross-browser compatibility testing","Security audit and vulnerability fixes","User acceptance testing completion"]},{category:"Documentation",icon:vf,color:"blue",items:["Initial documentation structure","API documentation for developers","User guide and tutorials","Installation and setup instructions","FAQ and troubleshooting guides"]}],impact:"Finalized core functionality and ensured application stability through extensive testing. Prepared the foundation for public release.",breaking:!1,migration:[]},{id:"v0.5",version:"0.5",name:"Alpha Release",date:"August 15, 2025",type:"minor",color:"yellow",current:!1,description:"Initial alpha release with basic supplier management functionality.",features:[{category:"Basic Features",icon:So,color:"blue",items:["Basic supplier CRUD operations","Simple transaction recording","Basic reporting capabilities","User authentication system","Data persistence with Supabase"]},{category:"Development Setup",icon:J_,color:"gray",items:["Initial React application setup","TypeScript configuration","Basic styling with Tailwind CSS","Development tooling configuration","Version control and repository setup"]}],impact:"Established the basic foundation for supplier management with essential CRUD operations and user authentication.",breaking:!0,migration:["Initial setup required","Database schema creation"]}],eJ=({onVersionSelect:e,onBackToMain:t})=>f.jsxs("div",{className:"space-y-8",children:[f.jsxs("div",{className:"mb-8",children:[f.jsxs("button",{onClick:t,className:"flex items-center text-blue-600 hover:text-blue-800 mb-4",children:[f.jsx(fl,{className:"h-4 w-4 mr-2"}),"Back to Documentation"]}),f.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Version History & Updates"}),f.jsx("p",{className:"text-xl text-gray-600",children:"Complete changelog and development timeline"})]}),f.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-green-50 border border-blue-200 rounded-xl p-6 mb-8",children:[f.jsxs("div",{className:"flex items-center mb-3",children:[f.jsx(Y_,{className:"h-6 w-6 text-blue-600 mr-3"}),f.jsxs("span",{className:"text-2xl font-bold text-gray-900",children:["Current Version: ",Oc()]}),f.jsx("span",{className:"ml-3 bg-green-500 text-white text-sm px-3 py-1 rounded-full",children:"LATEST"})]}),f.jsxs("p",{className:"text-gray-700",children:["Welcome to Shopsynk ",Oc()," - ",a4,"! This version introduces enhanced mobile navigation, improved user experience, and comprehensive documentation."]})]}),f.jsx("div",{className:"grid gap-6",children:vT.map(r=>{const n=a=>({purple:"bg-purple-500",blue:"bg-blue-500",orange:"bg-orange-500",yellow:"bg-yellow-500",green:"bg-green-500"})[a]||"bg-gray-500",i=a=>({purple:"border-purple-200 hover:border-purple-300",blue:"border-blue-200 hover:border-blue-300",orange:"border-orange-200 hover:border-orange-300",yellow:"border-yellow-200 hover:border-yellow-300",green:"border-green-200 hover:border-green-300"})[a]||"border-gray-200 hover:border-gray-300";return f.jsxs("div",{onClick:()=>e(r.id),className:`
                bg-white border-2 ${i(r.color)} rounded-xl p-6 
                cursor-pointer transition-all duration-200 hover:shadow-lg transform hover:scale-105
              `,children:[f.jsxs("div",{className:"flex items-center justify-between mb-4",children:[f.jsxs("div",{className:"flex items-center",children:[f.jsxs("div",{className:`${n(r.color)} text-white text-sm font-semibold px-3 py-1 rounded-full mr-3`,children:["v",r.version]}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:r.name}),f.jsx("p",{className:"text-sm text-gray-500",children:r.date})]})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[r.current&&f.jsx("span",{className:"bg-green-500 text-white text-xs px-2 py-1 rounded-full",children:"CURRENT"}),f.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${r.type==="major"?"bg-red-100 text-red-700":"bg-blue-100 text-blue-700"}`,children:r.type.toUpperCase()}),r.breaking&&f.jsx("span",{className:"bg-orange-100 text-orange-700 text-xs px-2 py-1 rounded-full",children:"BREAKING"})]})]}),f.jsx("p",{className:"text-gray-600 mb-4",children:r.description}),f.jsxs("div",{className:"space-y-3",children:[r.features.slice(0,2).map((a,s)=>f.jsxs("div",{className:"flex items-start space-x-3",children:[f.jsx(a.icon,{className:"h-5 w-5 text-gray-500 mt-0.5 flex-shrink-0"}),f.jsxs("div",{children:[f.jsx("h4",{className:"font-semibold text-gray-900 text-sm",children:a.category}),f.jsxs("p",{className:"text-xs text-gray-600",children:[a.items.length," updates"]})]})]},s)),r.features.length>2&&f.jsxs("div",{className:"text-sm text-blue-600 font-medium",children:["+",r.features.length-2," more categories"]})]}),f.jsxs("div",{className:"mt-4 flex items-center text-blue-600 font-semibold",children:[f.jsx("span",{children:"View Details"}),f.jsx(qf,{className:"h-4 w-4 ml-2"})]})]},r.id)})})]}),tJ=({versionId:e,onBack:t})=>{const r=vT.find(i=>i.id===e);if(!r)return f.jsxs("div",{className:"text-center py-12",children:[f.jsxs("button",{onClick:t,className:"flex items-center text-blue-600 hover:text-blue-800 mb-4",children:[f.jsx(fl,{className:"h-4 w-4 mr-2"}),"Back to Version History"]}),f.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Version Not Found"}),f.jsx("p",{className:"text-gray-600",children:"The requested version could not be found."})]});const n=i=>({purple:"bg-purple-500",blue:"bg-blue-500",orange:"bg-orange-500",yellow:"bg-yellow-500",green:"bg-green-500"})[i]||"bg-gray-500";return f.jsxs("div",{className:"space-y-8",children:[f.jsxs("div",{className:"mb-8",children:[f.jsxs("button",{onClick:t,className:"flex items-center text-blue-600 hover:text-blue-800 mb-4",children:[f.jsx(fl,{className:"h-4 w-4 mr-2"}),"Back to Version History"]}),f.jsxs("div",{className:"flex items-center mb-4",children:[f.jsxs("div",{className:`${n(r.color)} text-white text-lg font-bold px-4 py-2 rounded-full mr-4`,children:["v",r.version]}),f.jsxs("div",{children:[f.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:r.name}),f.jsx("p",{className:"text-lg text-gray-600",children:r.date})]}),r.current&&f.jsx("span",{className:"ml-4 bg-green-500 text-white text-sm px-3 py-1 rounded-full",children:"CURRENT"})]}),f.jsx("p",{className:"text-xl text-gray-700 mb-6",children:r.description}),f.jsxs("div",{className:"flex items-center space-x-4",children:[f.jsxs("span",{className:`text-sm px-3 py-1 rounded-full ${r.type==="major"?"bg-red-100 text-red-700":"bg-blue-100 text-blue-700"}`,children:[r.type.toUpperCase()," RELEASE"]}),r.breaking&&f.jsx("span",{className:"bg-orange-100 text-orange-700 text-sm px-3 py-1 rounded-full",children:"BREAKING CHANGES"})]})]}),f.jsxs("div",{className:"space-y-6",children:[f.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"What's New in This Version"}),r.features.map((i,a)=>f.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[f.jsxs("div",{className:"flex items-center mb-4",children:[f.jsx(i.icon,{className:"h-8 w-8 text-blue-600 mr-3"}),f.jsx("h3",{className:"text-xl font-bold text-gray-900",children:i.category})]}),f.jsx("ul",{className:"space-y-2",children:i.items.map((s,o)=>f.jsxs("li",{className:"flex items-start",children:[f.jsx(pi,{className:"h-5 w-5 text-green-500 mr-3 mt-0.5 flex-shrink-0"}),f.jsx("span",{className:"text-gray-700",children:s})]},o))})]},a))]}),f.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-xl p-6",children:[f.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-3 flex items-center",children:[f.jsx(sf,{className:"h-6 w-6 text-blue-600 mr-3"}),"Impact & Benefits"]}),f.jsx("p",{className:"text-gray-700",children:r.impact})]}),r.breaking&&r.migration.length>0&&f.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-6",children:[f.jsxs("h3",{className:"text-xl font-bold text-orange-900 mb-3 flex items-center",children:[f.jsx(Es,{className:"h-6 w-6 text-orange-600 mr-3"}),"Migration Guide"]}),f.jsx("ul",{className:"space-y-2",children:r.migration.map((i,a)=>f.jsxs("li",{className:"flex items-start",children:[f.jsx(qf,{className:"h-5 w-5 text-orange-600 mr-3 mt-0.5 flex-shrink-0"}),f.jsx("span",{className:"text-orange-800",children:i})]},a))})]})]})},rJ=()=>{const[e,t]=z.useState(null),r=[{id:"overview",title:"Getting Started",description:"Learn the basics and get started with Shopsynk",icon:nf,color:"blue",topics:["Introduction","Key Features","System Requirements","Quick Setup"]},{id:"user-guide",title:"User Guide",description:"Complete step-by-step instructions for all features",icon:vf,color:"green",topics:["Dashboard","Suppliers","Transactions","Reports","Data Management"]},{id:"mobile-guide",title:"Mobile Experience",description:"Using Shopsynk on mobile devices and PWA features",icon:Xu,color:"purple",topics:["Mobile Navigation","PWA Installation","Offline Features","Touch Gestures"]},{id:"rules",title:"Policies & Rules",description:"Terms of service, privacy policy, and usage guidelines",icon:Z_,color:"red",topics:["Privacy Policy","Terms of Service","Usage Guidelines","Data Security"]},{id:"contribute",title:"Developer Guide",description:"Contribute to the project and technical documentation",icon:J_,color:"indigo",topics:["Setup Environment","Code Standards","Pull Requests","API Reference"]},{id:"updates",title:"Version History",description:"Complete changelog and update history",icon:xf,color:"orange",topics:["Recent Updates","Version Timeline","Breaking Changes","Migration Guide"]},{id:"about",title:"About & Support",description:"Learn about the developer and get support",icon:So,color:"teal",topics:["Developer Info","Contact Support","Community","Feedback"]}],n=(a,s="light")=>{var l;const o={blue:{light:"bg-blue-50 text-blue-700",dark:"bg-blue-600 text-white",border:"border-blue-200",hover:"hover:bg-blue-100 hover:border-blue-300"},green:{light:"bg-green-50 text-green-700",dark:"bg-green-600 text-white",border:"border-green-200",hover:"hover:bg-green-100 hover:border-green-300"},purple:{light:"bg-purple-50 text-purple-700",dark:"bg-purple-600 text-white",border:"border-purple-200",hover:"hover:bg-purple-100 hover:border-purple-300"},red:{light:"bg-red-50 text-red-700",dark:"bg-red-600 text-white",border:"border-red-200",hover:"hover:bg-red-100 hover:border-red-300"},indigo:{light:"bg-indigo-50 text-indigo-700",dark:"bg-indigo-600 text-white",border:"border-indigo-200",hover:"hover:bg-indigo-100 hover:border-indigo-300"},orange:{light:"bg-orange-50 text-orange-700",dark:"bg-orange-600 text-white",border:"border-orange-200",hover:"hover:bg-orange-100 hover:border-orange-300"},teal:{light:"bg-teal-50 text-teal-700",dark:"bg-teal-600 text-white",border:"border-teal-200",hover:"hover:bg-teal-100 hover:border-teal-300"}};return((l=o[a])==null?void 0:l[s])||o.blue[s]},i=a=>{switch(a){case"overview":return f.jsxs("div",{className:"space-y-8",children:[f.jsxs("div",{className:"mb-8",children:[f.jsxs("button",{onClick:()=>t(null),className:"flex items-center text-blue-600 hover:text-blue-800 mb-4",children:[f.jsx(fl,{className:"h-4 w-4 mr-2"}),"Back to Documentation"]}),f.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Getting Started with Shopsynk"}),f.jsx("p",{className:"text-xl text-gray-600",children:"Welcome to Shopsynk - your comprehensive supplier management solution"})]}),f.jsxs("div",{className:"grid gap-6",children:[f.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border border-blue-200 rounded-xl p-6",children:[f.jsxs("div",{className:"flex items-center mb-4",children:[f.jsx(sf,{className:"h-8 w-8 text-blue-600 mr-3"}),f.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"What is Shopsynk?"})]}),f.jsx("p",{className:"text-gray-700 mb-4",children:"Shopsynk is a modern, comprehensive supplier dues management system designed to help businesses efficiently track, manage, and maintain their supplier relationships and financial obligations. Built with cutting-edge web technologies, it offers a seamless experience across all devices."}),f.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[f.jsxs("div",{className:"bg-white/50 rounded-lg p-4",children:[f.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"üéØ Purpose"}),f.jsx("p",{className:"text-sm text-blue-800",children:"Streamline supplier relationship management and financial tracking"})]}),f.jsxs("div",{className:"bg-white/50 rounded-lg p-4",children:[f.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"‚ö° Performance"}),f.jsx("p",{className:"text-sm text-blue-800",children:"Fast, responsive PWA with offline capabilities"})]})]})]}),f.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-6",children:[f.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-4 flex items-center",children:[f.jsx(Qo,{className:"h-6 w-6 text-yellow-500 mr-3"}),"Key Features"]}),f.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-4",children:[{icon:Q_,title:"Supplier Management",desc:"Complete supplier profiles and contact management"},{icon:K_,title:"Transaction Tracking",desc:"Record and monitor all financial transactions"},{icon:af,title:"Advanced Reports",desc:"Comprehensive analytics and reporting tools"},{icon:gc,title:"Data Backup",desc:"Secure cloud backup and data export options"},{icon:Xu,title:"Mobile PWA",desc:"Full mobile experience with app-like features"},{icon:Bg,title:"Customizable",desc:"Flexible settings and personalization options"}].map((s,o)=>f.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[f.jsx(s.icon,{className:"h-8 w-8 text-blue-600 mb-3"}),f.jsx("h3",{className:"font-semibold text-gray-900 mb-2",children:s.title}),f.jsx("p",{className:"text-sm text-gray-600",children:s.desc})]},o))})]}),f.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-6",children:[f.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-4 flex items-center",children:[f.jsx(pi,{className:"h-6 w-6 text-green-600 mr-3"}),"System Requirements"]}),f.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold text-green-900 mb-3",children:"Minimum Requirements"}),f.jsxs("ul",{className:"space-y-2 text-green-800",children:[f.jsxs("li",{className:"flex items-center",children:[f.jsx(pi,{className:"h-4 w-4 mr-2"}),"Modern web browser (Chrome 90+, Firefox 88+, Safari 14+)"]}),f.jsxs("li",{className:"flex items-center",children:[f.jsx(pi,{className:"h-4 w-4 mr-2"}),"Internet connection for sync and backup"]}),f.jsxs("li",{className:"flex items-center",children:[f.jsx(pi,{className:"h-4 w-4 mr-2"}),"JavaScript enabled"]}),f.jsxs("li",{className:"flex items-center",children:[f.jsx(pi,{className:"h-4 w-4 mr-2"}),"Local storage support (5MB+)"]})]})]}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold text-green-900 mb-3",children:"Recommended Setup"}),f.jsxs("ul",{className:"space-y-2 text-green-800",children:[f.jsxs("li",{className:"flex items-center",children:[f.jsx(Qo,{className:"h-4 w-4 mr-2"}),"Desktop/laptop for data entry"]}),f.jsxs("li",{className:"flex items-center",children:[f.jsx(Qo,{className:"h-4 w-4 mr-2"}),"Mobile device for PWA installation"]}),f.jsxs("li",{className:"flex items-center",children:[f.jsx(Qo,{className:"h-4 w-4 mr-2"}),"Stable internet for real-time sync"]}),f.jsxs("li",{className:"flex items-center",children:[f.jsx(Qo,{className:"h-4 w-4 mr-2"}),"Regular backup schedule"]})]})]})]})]}),f.jsxs("div",{className:"bg-purple-50 border border-purple-200 rounded-xl p-6",children:[f.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-4 flex items-center",children:[f.jsx(b8,{className:"h-6 w-6 text-purple-600 mr-3"}),"Quick Setup Guide"]}),f.jsx("div",{className:"space-y-4",children:[{step:1,title:"Create Account",desc:"Sign up with your email and create a secure password"},{step:2,title:"Complete Profile",desc:"Fill in your business information and preferences"},{step:3,title:"Add First Supplier",desc:"Create your first supplier profile with contact details"},{step:4,title:"Record Transaction",desc:"Add your first transaction to get familiar with the system"},{step:5,title:"Explore Features",desc:"Browse reports, settings, and advanced features"}].map(s=>f.jsxs("div",{className:"flex items-start space-x-4 bg-white rounded-lg p-4",children:[f.jsx("div",{className:"bg-purple-600 text-white rounded-full w-8 h-8 flex items-center justify-center text-sm font-bold",children:s.step}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold text-gray-900",children:s.title}),f.jsx("p",{className:"text-gray-600 text-sm",children:s.desc})]})]},s.step))})]})]})]});case"mobile-guide":return f.jsxs("div",{className:"space-y-8",children:[f.jsxs("div",{className:"mb-8",children:[f.jsxs("button",{onClick:()=>t(null),className:"flex items-center text-blue-600 hover:text-blue-800 mb-4",children:[f.jsx(fl,{className:"h-4 w-4 mr-2"}),"Back to Documentation"]}),f.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Mobile Experience Guide"}),f.jsx("p",{className:"text-xl text-gray-600",children:"Get the most out of Shopsynk on mobile devices"})]}),f.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-pink-50 border border-purple-200 rounded-xl p-6 mb-6",children:[f.jsxs("div",{className:"flex items-center mb-4",children:[f.jsx(Xu,{className:"h-8 w-8 text-purple-600 mr-3"}),f.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Mobile Navigation v1.2"}),f.jsx("span",{className:"ml-3 bg-purple-500 text-white text-xs px-2 py-1 rounded-full",children:"NEW"})]}),f.jsx("p",{className:"text-gray-700 mb-4",children:"Version 1.1 introduces our completely redesigned mobile navigation system, replacing the traditional hamburger menu with a modern bottom navigation bar for easier thumb-friendly access."}),f.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[f.jsxs("div",{className:"bg-white/50 rounded-lg p-4",children:[f.jsx("h3",{className:"font-semibold text-purple-900 mb-2",children:"üéØ Bottom Navigation"}),f.jsx("p",{className:"text-sm text-purple-800",children:"Quick access to Dashboard, Suppliers, Transactions, and Reports"})]}),f.jsxs("div",{className:"bg-white/50 rounded-lg p-4",children:[f.jsx("h3",{className:"font-semibold text-purple-900 mb-2",children:"üì± Touch Optimized"}),f.jsx("p",{className:"text-sm text-purple-800",children:"Large touch targets and gesture-friendly interface design"})]})]})]}),f.jsxs("div",{className:"grid gap-6",children:[f.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-6",children:[f.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-4 flex items-center",children:[f.jsx(jc,{className:"h-6 w-6 text-blue-600 mr-3"}),"PWA Installation"]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"bg-white rounded-lg p-4",children:[f.jsx("h3",{className:"font-semibold mb-2",children:"üì± iOS Installation"}),f.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-sm text-gray-700",children:[f.jsx("li",{children:"Open Shopsynk in Safari browser"}),f.jsx("li",{children:"Tap the Share button (square with arrow)"}),f.jsx("li",{children:'Scroll down and tap "Add to Home Screen"'}),f.jsx("li",{children:'Customize the name and tap "Add"'})]})]}),f.jsxs("div",{className:"bg-white rounded-lg p-4",children:[f.jsx("h3",{className:"font-semibold mb-2",children:"ü§ñ Android Installation"}),f.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-sm text-gray-700",children:[f.jsx("li",{children:"Open Shopsynk in Chrome browser"}),f.jsx("li",{children:"Tap the menu (three dots) in the top right"}),f.jsx("li",{children:'Select "Add to Home screen"'}),f.jsx("li",{children:"Confirm the installation"})]})]})]})]}),f.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-6",children:[f.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-4 flex items-center",children:[f.jsx(x8,{className:"h-6 w-6 text-green-600 mr-3"}),"Offline Features"]}),f.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold text-green-900 mb-3",children:"Available Offline"}),f.jsxs("ul",{className:"space-y-2 text-green-800",children:[f.jsxs("li",{className:"flex items-center",children:[f.jsx(pi,{className:"h-4 w-4 mr-2"}),"View existing suppliers and transactions"]}),f.jsxs("li",{className:"flex items-center",children:[f.jsx(pi,{className:"h-4 w-4 mr-2"}),"Access cached reports and data"]}),f.jsxs("li",{className:"flex items-center",children:[f.jsx(pi,{className:"h-4 w-4 mr-2"}),"Browse documentation"]})]})]}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold text-green-900 mb-3",children:"Requires Internet"}),f.jsxs("ul",{className:"space-y-2 text-green-800",children:[f.jsxs("li",{className:"flex items-center",children:[f.jsx(Es,{className:"h-4 w-4 mr-2"}),"Adding new data"]}),f.jsxs("li",{className:"flex items-center",children:[f.jsx(Es,{className:"h-4 w-4 mr-2"}),"Real-time sync"]}),f.jsxs("li",{className:"flex items-center",children:[f.jsx(Es,{className:"h-4 w-4 mr-2"}),"Data backup"]})]})]})]})]}),f.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-xl p-6",children:[f.jsxs("h2",{className:"text-2xl font-bold text-gray-900 mb-4 flex items-center",children:[f.jsx(sf,{className:"h-6 w-6 text-orange-600 mr-3"}),"Mobile Best Practices"]}),f.jsx("div",{className:"space-y-4",children:[{title:"Portrait Mode",tip:"Use portrait orientation for optimal experience"},{title:"Touch Gestures",tip:"Swipe left/right to navigate between sections"},{title:"Quick Actions",tip:"Long press on items for context menus"},{title:"Voice Input",tip:"Use voice input for faster data entry"},{title:"Auto-Save",tip:"Data is automatically saved as you type"}].map((s,o)=>f.jsxs("div",{className:"bg-white rounded-lg p-4 flex items-start space-x-3",children:[f.jsx(y8,{className:"h-5 w-5 text-orange-600 mt-0.5 flex-shrink-0"}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold text-orange-900",children:s.title}),f.jsx("p",{className:"text-sm text-orange-800",children:s.tip})]})]},o))})]})]})]});case"updates":return f.jsx(eJ,{onVersionSelect:s=>t(`version-detail-${s}`),onBackToMain:()=>t(null)});default:if(e&&e.startsWith("version-detail-")){const s=e.split("-")[2];return f.jsx(tJ,{versionId:s,onBack:()=>t("updates")})}return f.jsxs("div",{className:"text-center py-12",children:[f.jsx("div",{className:"mb-8",children:f.jsxs("button",{onClick:()=>t(null),className:"flex items-center text-blue-600 hover:text-blue-800 mb-4",children:[f.jsx(fl,{className:"h-4 w-4 mr-2"}),"Back to Documentation"]})}),f.jsx(nf,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),f.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Coming Soon"}),f.jsx("p",{className:"text-gray-600",children:"This section is under development."})]})}};return e?f.jsx("div",{className:"min-h-screen bg-gray-50 pb-20 md:pb-8",children:f.jsx("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:i(e)})}):f.jsx("div",{className:"min-h-screen bg-gray-50 pb-20 md:pb-8",children:f.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[f.jsxs("div",{className:"text-center mb-12",children:[f.jsxs("div",{className:"flex items-center justify-center mb-6",children:[f.jsx(nf,{className:"h-12 w-12 text-blue-600 mr-4"}),f.jsxs("div",{children:[f.jsx("h1",{className:"text-4xl font-bold text-gray-900",children:"Shopsynk Documentation"}),f.jsxs("p",{className:"text-xl text-gray-600 mt-2",children:["Complete guide for Shopsynk ",Oc()," - ",a4]})]})]}),f.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200 rounded-xl p-6 mb-8",children:[f.jsxs("div",{className:"flex items-center justify-center mb-3",children:[f.jsx(Y_,{className:"h-6 w-6 text-blue-600 mr-3"}),f.jsxs("span",{className:"text-2xl font-bold text-gray-900",children:["Version ",Oc()]}),f.jsx("span",{className:"ml-3 bg-green-500 text-white text-sm px-3 py-1 rounded-full",children:"LATEST"})]}),f.jsx("p",{className:"text-gray-700 max-w-3xl mx-auto",children:"Welcome to the comprehensive documentation for Shopsynk, your modern supplier management system. This version introduces enhanced mobile navigation, improved user experience, and complete documentation coverage."})]})]}),f.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-6 mb-12",children:r.map(a=>{const s=a.icon;return f.jsxs("div",{onClick:()=>t(a.id),className:`
                    bg-white border-2 ${n(a.color,"border")} rounded-xl p-6 
                    cursor-pointer transition-all duration-200 transform hover:scale-105 
                    hover:shadow-lg ${n(a.color,"hover")}
                  `,children:[f.jsxs("div",{className:"flex items-center mb-4",children:[f.jsx("div",{className:`${n(a.color,"dark")} rounded-lg p-3 mr-4`,children:f.jsx(s,{className:"h-6 w-6"})}),f.jsx("h3",{className:"text-xl font-bold text-gray-900",children:a.title})]}),f.jsx("p",{className:"text-gray-600 mb-4",children:a.description}),f.jsx("div",{className:"space-y-2",children:a.topics.map((o,l)=>f.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[f.jsx("div",{className:"w-1.5 h-1.5 bg-gray-400 rounded-full mr-3"}),o]},l))}),f.jsxs("div",{className:"mt-4 flex items-center text-blue-600 font-semibold",children:[f.jsx("span",{children:"Explore"}),f.jsx(qf,{className:"h-4 w-4 ml-2"})]})]},a.id)})}),f.jsxs("div",{className:"bg-white border border-gray-200 rounded-xl p-8",children:[f.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6 text-center",children:"Documentation Overview"}),f.jsxs("div",{className:"grid md:grid-cols-4 gap-6",children:[f.jsxs("div",{className:"text-center",children:[f.jsx(X_,{className:"h-8 w-8 text-blue-600 mx-auto mb-2"}),f.jsx("div",{className:"text-2xl font-bold text-gray-900",children:"7"}),f.jsx("div",{className:"text-sm text-gray-600",children:"Documentation Sections"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx(sf,{className:"h-8 w-8 text-green-600 mx-auto mb-2"}),f.jsx("div",{className:"text-2xl font-bold text-gray-900",children:"25+"}),f.jsx("div",{className:"text-sm text-gray-600",children:"Topics Covered"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx(Xu,{className:"h-8 w-8 text-purple-600 mx-auto mb-2"}),f.jsx("div",{className:"text-2xl font-bold text-gray-900",children:"NEW"}),f.jsx("div",{className:"text-sm text-gray-600",children:"Mobile Navigation"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx(xf,{className:"h-8 w-8 text-orange-600 mx-auto mb-2"}),f.jsx("div",{className:"text-2xl font-bold text-gray-900",children:"v1.2"}),f.jsx("div",{className:"text-sm text-gray-600",children:"Current Version"})]})]})]})]})})},nJ=()=>{const[e,t]=z.useState({total:0,read:0,unread:0,readPercentage:0}),[r,n]=z.useState(!1),[i,a]=z.useState(null);z.useEffect(()=>{s();const h=localStorage.getItem("last_notification_cleanup");h&&a(h)},[]);const s=async()=>{const h=await vc.getNotificationStats();t(h)},o=async()=>{n(!0);try{await vc.performFullCleanup();const h=new Date().toLocaleString();localStorage.setItem("last_notification_cleanup",h),a(h),setTimeout(s,1e3),alert("‚úÖ Database cleanup completed successfully!")}catch(h){console.error("Cleanup error:",h),alert("‚ùå Cleanup failed. Please try again.")}finally{n(!1)}},l=async()=>{n(!0);try{await vc.cleanupReadNotifications(),setTimeout(s,1e3),alert("‚úÖ Quick cleanup completed!")}catch(h){console.error("Quick cleanup error:",h),alert("‚ùå Quick cleanup failed.")}finally{n(!1)}},u=e.total>500?{level:"high",message:"High storage usage detected. Recommend immediate cleanup.",color:"text-red-600 bg-red-50 border-red-200"}:e.total>200?{level:"medium",message:"Moderate storage usage. Consider cleanup.",color:"text-yellow-600 bg-yellow-50 border-yellow-200"}:{level:"low",message:"Storage usage is optimal.",color:"text-green-600 bg-green-50 border-green-200"};return f.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[f.jsxs("div",{className:"flex items-center justify-between mb-6",children:[f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:f.jsx(gc,{className:"w-5 h-5 text-blue-600"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Notification Storage"}),f.jsx("p",{className:"text-sm text-gray-500",children:"Manage database efficiency"})]})]}),f.jsx("button",{onClick:s,className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100 transition-colors",title:"Refresh stats",children:f.jsx(_s,{className:"w-4 h-4"})})]}),f.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[f.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(af,{className:"w-4 h-4 text-gray-500"}),f.jsx("span",{className:"text-sm text-gray-500",children:"Total"})]}),f.jsx("div",{className:"text-2xl font-bold text-gray-900 mt-1",children:e.total})]}),f.jsxs("div",{className:"bg-blue-50 rounded-lg p-4",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),f.jsx("span",{className:"text-sm text-blue-600",children:"Unread"})]}),f.jsx("div",{className:"text-2xl font-bold text-blue-700 mt-1",children:e.unread})]}),f.jsxs("div",{className:"bg-green-50 rounded-lg p-4",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),f.jsx("span",{className:"text-sm text-green-600",children:"Read"})]}),f.jsx("div",{className:"text-2xl font-bold text-green-700 mt-1",children:e.read})]}),f.jsxs("div",{className:"bg-purple-50 rounded-lg p-4",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),f.jsx("span",{className:"text-sm text-purple-600",children:"Read %"})]}),f.jsxs("div",{className:"text-2xl font-bold text-purple-700 mt-1",children:[e.readPercentage,"%"]})]})]}),f.jsxs("div",{className:`rounded-lg border p-4 mb-6 ${u.color}`,children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("div",{className:"w-2 h-2 rounded-full bg-current"}),f.jsx("span",{className:"font-medium",children:"Storage Status"})]}),f.jsx("p",{className:"text-sm mt-1",children:u.message})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("h4",{className:"font-medium text-gray-900",children:"Full Cleanup"}),f.jsx("p",{className:"text-sm text-gray-500",children:"Remove old notifications, keep latest 100 per user"})]}),f.jsxs("button",{onClick:o,disabled:r,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2 transition-colors",children:[f.jsx(kc,{className:"w-4 h-4"}),f.jsx("span",{children:r?"Cleaning...":"Full Cleanup"})]})]}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("h4",{className:"font-medium text-gray-900",children:"Quick Cleanup"}),f.jsx("p",{className:"text-sm text-gray-500",children:"Remove only read notifications older than 3 days"})]}),f.jsxs("button",{onClick:l,disabled:r,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2 transition-colors",children:[f.jsx(xf,{className:"w-4 h-4"}),f.jsx("span",{children:r?"Cleaning...":"Quick Cleanup"})]})]})]}),i&&f.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:f.jsxs("p",{className:"text-xs text-gray-500",children:["Last cleanup: ",i]})}),f.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),f.jsx("span",{className:"text-sm text-gray-600",children:"Auto-cleanup active"})]}),f.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["‚Ä¢ Read notifications auto-deleted after 5 seconds",f.jsx("br",{}),"‚Ä¢ User notifications limited to 50 per user",f.jsx("br",{}),"‚Ä¢ Cleanup runs every 30 minutes"]})]})]})},iJ=({className:e=""})=>{const{user:t}=Hi(),[r,n]=z.useState({supported:!1,permission:"default",subscribed:!1}),[i,a]=z.useState(!1);z.useEffect(()=>{s()},[]);const s=async()=>{const c=await fo.getSubscriptionStatus();n(c)},o=async()=>{if(t!=null&&t.id){a(!0);try{if(!await fo.initialize())throw new Error("Push notifications not supported");if(!await fo.requestPermission())throw new Error("Permission denied");if(!await fo.subscribe(t.id))throw new Error("Failed to subscribe");await s()}catch(c){console.error("Failed to enable push notifications:",c),alert("Failed to enable push notifications. Please try again.")}a(!1)}},l=async()=>{if(t!=null&&t.id){a(!0);try{if(!await fo.unsubscribe(t.id))throw new Error("Failed to unsubscribe");await s()}catch(c){console.error("Failed to disable push notifications:",c),alert("Failed to disable push notifications. Please try again.")}a(!1)}};return r.supported?f.jsxs("div",{className:`bg-white border border-gray-200 rounded-lg p-4 ${e}`,children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center",children:[f.jsx("div",{className:"flex-shrink-0",children:r.subscribed?f.jsx("div",{className:"w-8 h-8 bg-green-100 rounded-full flex items-center justify-center",children:f.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{d:"M10 2a6 6 0 00-6 6v3.586l-.707.707A1 1 0 004 14h12a1 1 0 00.707-1.707L16 11.586V8a6 6 0 00-6-6zM10 18a3 3 0 01-3-3h6a3 3 0 01-3 3z"})})}):f.jsx("div",{className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center",children:f.jsxs("svg",{className:"w-5 h-5 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:[f.jsx("path",{fillRule:"evenodd",d:"M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM15.657 6.343a1 1 0 011.414 0A9.972 9.972 0 0119 12a9.972 9.972 0 01-1.929 5.657 1 1 0 11-1.414-1.414A7.971 7.971 0 0017 12a7.971 7.971 0 00-1.343-4.243 1 1 0 010-1.414z",clipRule:"evenodd"}),f.jsx("path",{fillRule:"evenodd",d:"M13.828 8.172a1 1 0 011.414 0A5.983 5.983 0 0117 12a5.983 5.983 0 01-1.758 3.828 1 1 0 11-1.414-1.414A3.987 3.987 0 0015 12a3.987 3.987 0 00-1.172-2.828 1 1 0 010-1.414z",clipRule:"evenodd"})]})})}),f.jsxs("div",{className:"ml-3",children:[f.jsx("h3",{className:"text-sm font-medium text-gray-900",children:"Push Notifications"}),f.jsx("p",{className:"text-sm text-gray-600",children:r.subscribed?"Get notified even when the app is closed":"Enable to receive notifications when app is closed"}),f.jsxs("div",{className:"mt-1 flex items-center space-x-4 text-xs text-gray-500",children:[f.jsxs("span",{children:["Permission: ",r.permission]}),f.jsxs("span",{children:["Status: ",r.subscribed?"Active":"Inactive"]})]})]})]}),f.jsx("div",{className:"flex-shrink-0",children:r.permission==="denied"?f.jsxs("div",{className:"text-xs text-red-600 text-right",children:[f.jsx("p",{children:"Permission denied."}),f.jsx("p",{children:"Please enable in browser settings."})]}):f.jsxs("button",{onClick:r.subscribed?l:o,disabled:i,className:`inline-flex items-center px-3 py-2 border border-transparent text-sm leading-4 font-medium rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 ${r.subscribed?"text-red-700 bg-red-100 hover:bg-red-200 focus:ring-red-500":"text-white bg-amber-600 hover:bg-amber-700 focus:ring-amber-500"} disabled:opacity-50 disabled:cursor-not-allowed transition-colors`,children:[i?f.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-current",fill:"none",viewBox:"0 0 24 24",children:[f.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),f.jsx("path",{className:"opacity-75",fill:"currentColor",d:"m4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):null,r.subscribed?"Disable":"Enable"]})})]}),r.subscribed&&f.jsx("div",{className:"mt-4 p-3 bg-green-50 border border-green-200 rounded-md",children:f.jsxs("div",{className:"flex",children:[f.jsx("div",{className:"flex-shrink-0",children:f.jsx("svg",{className:"h-5 w-5 text-green-400",fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),f.jsx("div",{className:"ml-3",children:f.jsx("p",{className:"text-sm text-green-800",children:"‚ú® You'll receive notifications for new transactions, payments, and supplier updates even when the app is closed!"})})]})})]}):f.jsx("div",{className:`bg-gray-50 border border-gray-200 rounded-lg p-4 ${e}`,children:f.jsxs("div",{className:"flex items-center",children:[f.jsx("div",{className:"flex-shrink-0",children:f.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"currentColor",viewBox:"0 0 20 20",children:f.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),f.jsxs("div",{className:"ml-3",children:[f.jsx("h3",{className:"text-sm font-medium text-gray-800",children:"Push notifications not supported"}),f.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Your browser doesn't support push notifications."})]})]})})},aJ=()=>{const{user:e}=Hi(),[t,r]=z.useState({suppliersCount:0,transactionsCount:0,totalOutstanding:0,lastLogin:""}),[n,i]=z.useState(!0),[a,s]=z.useState({isConnected:!1,userEmail:"",lastBackup:"",autoBackupEnabled:!0}),[o,l]=z.useState([]),[c,u]=z.useState(!1),[h,p]=z.useState(!1),[d,v]=z.useState(""),g=ul.getInstance(),y=cl.getInstance(),b=mo.getInstance(),[E,S]=z.useState([]),[P,L]=z.useState([]),[q,C]=z.useState(!1),[R,k]=z.useState(null),[G,_]=z.useState({owner_name:"",role:"Owner"}),[j,H]=z.useState("");z.useEffect(()=>{ve(),ce(),pe(),X()},[e]);const X=async()=>{var oe;if(e)try{await b.ensurePrimaryOwner(e.id,e.email,(oe=e.user_metadata)==null?void 0:oe.full_name);const le=await b.getBusinessOwners(e.id);S(le);const Be=await b.getOwnerStats(e.id);L(Be)}catch(le){console.error("Error loading business owners:",le),H("Error loading business owners.")}},ce=async()=>{if(e)try{const{data:oe,error:le}=await et.from("user_settings").select("*").eq("user_id",e.id).single();if(le&&le.code!=="PGRST116")throw le;oe&&s({isConnected:oe.google_drive_connected||!1,userEmail:oe.google_drive_email||"",lastBackup:oe.last_backup_date||"",autoBackupEnabled:oe.auto_backup_enabled||!0})}catch(oe){console.error("Error loading Google Drive settings:",oe)}},pe=async()=>{if(e)try{const oe=await g.getBackupHistory(e.id);l(oe)}catch(oe){console.error("Error loading backup history:",oe)}},ye=async()=>{u(!0),v("");try{const oe=await y.authenticate();oe.success?(await et.from("user_settings").upsert({user_id:e==null?void 0:e.id,google_drive_connected:!0,google_drive_email:oe.userEmail,updated_at:new Date().toISOString()}),s(le=>({...le,isConnected:!0,userEmail:oe.userEmail})),v("Successfully connected to Google Drive!"),await g.setupAutoBackup(e.id,e.email)):v("Failed to connect to Google Drive. Please try again.")}catch(oe){console.error("Google Drive connection error:",oe),v("An error occurred while connecting to Google Drive.")}finally{u(!1)}},me=async()=>{try{y.disconnect(),await et.from("user_settings").upsert({user_id:e==null?void 0:e.id,google_drive_connected:!1,google_drive_email:null,updated_at:new Date().toISOString()}),s(oe=>({...oe,isConnected:!1,userEmail:""})),v("Disconnected from Google Drive.")}catch(oe){console.error("Error disconnecting Google Drive:",oe),v("Error disconnecting from Google Drive.")}},be=async()=>{if(e){p(!0),v("");try{const oe=await g.createBackup(e.id,e.email);v(oe.message),oe.success&&(await pe(),await ce())}catch(oe){console.error("Manual backup error:",oe),v("An error occurred during backup.")}finally{p(!1)}}},Ue=async()=>{if(e)try{const oe=await g.exportUserData(e.id,e.email);oe?(g.downloadBackupFile(oe),v("Backup file downloaded successfully!")):v("Failed to create backup file.")}catch(oe){console.error("Download backup error:",oe),v("Error creating backup file.")}},Fe=async()=>{if(e)try{const oe=!a.autoBackupEnabled;await et.from("user_settings").upsert({user_id:e.id,auto_backup_enabled:oe,updated_at:new Date().toISOString()}),s(le=>({...le,autoBackupEnabled:oe})),v(`Auto backup ${oe?"enabled":"disabled"}.`)}catch(oe){console.error("Error toggling auto backup:",oe),v("Error updating auto backup setting.")}},A=async oe=>{if(oe.preventDefault(),!!e)try{const le=await b.createBusinessOwner(e.id,G);le.success?(H("Owner added successfully!"),await X(),J()):H(`Error: ${le.error}`)}catch(le){console.error("Error adding owner:",le),H("An error occurred while adding the owner.")}},F=oe=>{k(oe),_({owner_name:oe.owner_name,role:oe.role}),C(!0)},O=async oe=>{if(oe.preventDefault(),!!R)try{const le=await b.updateBusinessOwner(R.id,G);le.success?(H("Owner updated successfully!"),await X(),J()):H(`Error: ${le.error}`)}catch(le){console.error("Error updating owner:",le),H("An error occurred while updating the owner.")}},M=async oe=>{if(confirm("Are you sure you want to remove this owner? This action cannot be undone."))try{const le=await b.deactivateBusinessOwner(oe);le.success?(H("Owner removed successfully."),await X()):H(`Error: ${le.error}`)}catch(le){console.error("Error removing owner:",le),H("An error occurred while removing the owner.")}},J=()=>{_({owner_name:"",role:"Owner"}),k(null),C(!1)},fe=oe=>P.find(le=>le.owner_id===oe)||{total_transactions:0,total_purchases:0,total_payments:0,total_purchase_amount:0,total_payment_amount:0},ve=async()=>{if(e)try{const{count:oe}=await et.from("suppliers").select("*",{count:"exact",head:!0}).eq("user_id",e.id),{count:le}=await et.from("transactions").select("*",{count:"exact",head:!0}).eq("user_id",e.id),{data:Be}=await et.from("transactions").select("type, amount, is_paid").eq("user_id",e.id);let ge=0;Be==null||Be.forEach(Q=>{Q.type==="new_purchase"&&!Q.is_paid?ge+=parseFloat(Q.amount.toString()):(Q.type==="pay_due"||Q.type==="settle_bill")&&(ge-=parseFloat(Q.amount.toString()))}),r({suppliersCount:oe||0,transactionsCount:le||0,totalOutstanding:Math.max(0,ge),lastLogin:e.last_sign_in_at||e.created_at||""})}catch(oe){console.error("Error fetching user stats:",oe)}finally{i(!1)}},ae=oe=>new Intl.NumberFormat("en-IN",{style:"currency",currency:"INR",minimumFractionDigits:0,maximumFractionDigits:0}).format(oe),ue=oe=>new Date(oe).toLocaleDateString("en-IN",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"});return n?f.jsx("div",{className:"flex items-center justify-center h-64",children:f.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Profile"}),f.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your account settings and view activity"})]}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[f.jsxs("div",{className:"flex items-center justify-between mb-6",children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Account Information"}),f.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:f.jsx(So,{className:"h-6 w-6 text-blue-600"})})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[f.jsx(Cc,{className:"h-5 w-5 text-gray-400"}),f.jsxs("div",{children:[f.jsx("p",{className:"text-sm text-gray-600",children:"Email Address"}),f.jsx("p",{className:"font-medium text-gray-900",children:e==null?void 0:e.email})]})]}),f.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[f.jsx(Z_,{className:"h-5 w-5 text-gray-400"}),f.jsxs("div",{children:[f.jsx("p",{className:"text-sm text-gray-600",children:"Account Status"}),f.jsx("p",{className:"font-medium text-green-600",children:"Active"})]})]}),f.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[f.jsx(mc,{className:"h-5 w-5 text-gray-400"}),f.jsxs("div",{children:[f.jsx("p",{className:"text-sm text-gray-600",children:"Account Created"}),f.jsx("p",{className:"font-medium text-gray-900",children:e!=null&&e.created_at?ue(e.created_at):"N/A"})]})]}),t.lastLogin&&f.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[f.jsx(mc,{className:"h-5 w-5 text-gray-400"}),f.jsxs("div",{children:[f.jsx("p",{className:"text-sm text-gray-600",children:"Last Sign In"}),f.jsx("p",{className:"font-medium text-gray-900",children:ue(t.lastLogin)})]})]})]})]}),f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[f.jsxs("div",{className:"flex items-center justify-between mb-6",children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Activity Summary"}),f.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:f.jsx(gc,{className:"h-6 w-6 text-green-600"})})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:f.jsxs("div",{children:[f.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"Total Suppliers"}),f.jsx("p",{className:"text-2xl font-bold text-blue-700",children:t.suppliersCount})]})}),f.jsx("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:f.jsxs("div",{children:[f.jsx("p",{className:"text-sm text-green-600 font-medium",children:"Total Transactions"}),f.jsx("p",{className:"text-2xl font-bold text-green-700",children:t.transactionsCount})]})}),f.jsx("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-lg",children:f.jsxs("div",{children:[f.jsx("p",{className:"text-sm text-red-600 font-medium",children:"Outstanding Amount"}),f.jsx("p",{className:"text-2xl font-bold text-red-700",children:ae(t.totalOutstanding)})]})})]})]})]}),f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[f.jsxs("div",{className:"flex items-center justify-between mb-6",children:[f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-xl flex items-center justify-center",children:f.jsx(Qa,{className:"h-6 w-6 text-purple-600"})}),f.jsxs("div",{children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Business Owners"}),f.jsx("p",{className:"text-sm text-gray-600",children:"Manage owners and track their activities"})]})]}),f.jsxs("button",{onClick:()=>C(!0),className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors flex items-center",children:[f.jsx(_8,{className:"h-4 w-4 mr-2"}),"Add Owner"]})]}),f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:E.map(oe=>{const le=fe(oe.id);return f.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:[f.jsxs("div",{className:"flex items-start justify-between mb-3",children:[f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("div",{className:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center",children:oe.is_primary?f.jsx(Qo,{className:"h-5 w-5 text-yellow-500"}):f.jsx(So,{className:"h-5 w-5 text-purple-600"})}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-semibold text-gray-900",children:oe.owner_name}),f.jsx("p",{className:"text-sm text-gray-600",children:oe.role}),oe.is_primary&&f.jsx("span",{className:"text-xs bg-yellow-100 text-yellow-700 px-2 py-1 rounded-full",children:"Primary"})]})]}),!oe.is_primary&&f.jsxs("div",{className:"flex space-x-1",children:[f.jsx("button",{onClick:()=>F(oe),className:"p-1 text-gray-400 hover:text-blue-600 rounded",title:"Edit owner",children:f.jsx(V_,{className:"h-4 w-4"})}),f.jsx("button",{onClick:()=>M(oe.id),className:"p-1 text-gray-400 hover:text-red-600 rounded",title:"Remove owner",children:f.jsx(kc,{className:"h-4 w-4"})})]})]}),f.jsx("div",{className:"mt-4 pt-3 border-t border-gray-200",children:f.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[f.jsxs("div",{className:"text-center",children:[f.jsx("p",{className:"text-blue-600 font-medium",children:le.total_purchases}),f.jsx("p",{className:"text-gray-500",children:"Purchases"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("p",{className:"text-green-600 font-medium",children:le.total_payments}),f.jsx("p",{className:"text-gray-500",children:"Payments"})]}),f.jsxs("div",{className:"col-span-2 text-center",children:[f.jsx("p",{className:"text-purple-600 font-medium",children:ae(le.total_purchase_amount-le.total_payment_amount)}),f.jsx("p",{className:"text-gray-500",children:"Net Activity"})]})]})})]},oe.id)})}),E.length===0&&f.jsxs("div",{className:"text-center py-8",children:[f.jsx(Qa,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),f.jsx("p",{className:"text-gray-500",children:"No business owners found"}),f.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Add owners to track who handles transactions"})]})]}),f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[f.jsxs("div",{className:"flex items-center justify-between mb-6",children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Google Drive Backup"}),f.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-xl flex items-center justify-center",children:f.jsx(ry,{className:"h-6 w-6 text-blue-600"})})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[a.isConnected?f.jsx(pi,{className:"h-5 w-5 text-green-500"}):f.jsx(p1,{className:"h-5 w-5 text-red-500"}),f.jsxs("div",{children:[f.jsx("p",{className:"text-sm text-gray-600",children:"Connection Status"}),f.jsx("p",{className:`font-medium ${a.isConnected?"text-green-600":"text-red-600"}`,children:a.isConnected?"Connected":"Not Connected"}),a.isConnected&&a.userEmail&&f.jsx("p",{className:"text-xs text-gray-500",children:a.userEmail})]})]}),a.isConnected&&f.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx(xf,{className:"h-5 w-5 text-gray-400"}),f.jsxs("div",{children:[f.jsx("p",{className:"text-sm text-gray-600",children:"Auto Backup"}),f.jsx("p",{className:"text-xs text-gray-500",children:"Daily at midnight"})]})]}),f.jsx("button",{onClick:Fe,className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${a.autoBackupEnabled?"bg-blue-600":"bg-gray-200"}`,children:f.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${a.autoBackupEnabled?"translate-x-6":"translate-x-1"}`})})]}),a.lastBackup&&f.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[f.jsx(mc,{className:"h-5 w-5 text-gray-400"}),f.jsxs("div",{children:[f.jsx("p",{className:"text-sm text-gray-600",children:"Last Backup"}),f.jsx("p",{className:"font-medium text-gray-900",children:ue(a.lastBackup)})]})]}),f.jsx("div",{className:"flex space-x-3",children:a.isConnected?f.jsxs(f.Fragment,{children:[f.jsx("button",{onClick:be,disabled:h,className:"flex-1 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors disabled:bg-green-400 flex items-center justify-center",children:h?f.jsxs(f.Fragment,{children:[f.jsx(_s,{className:"h-4 w-4 mr-2 animate-spin"}),"Backing up..."]}):f.jsxs(f.Fragment,{children:[f.jsx(gc,{className:"h-4 w-4 mr-2"}),"Backup Now"]})}),f.jsx("button",{onClick:me,className:"px-4 py-2 border border-red-300 text-red-600 rounded-lg hover:bg-red-50 transition-colors",children:"Disconnect"})]}):f.jsx("button",{onClick:ye,disabled:c,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors disabled:bg-blue-400 flex items-center justify-center",children:c?f.jsxs(f.Fragment,{children:[f.jsx(_s,{className:"h-4 w-4 mr-2 animate-spin"}),"Connecting..."]}):f.jsxs(f.Fragment,{children:[f.jsx(ry,{className:"h-4 w-4 mr-2"}),"Connect Google Drive"]})})}),f.jsxs("button",{onClick:Ue,className:"w-full bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 transition-colors flex items-center justify-center",children:[f.jsx(jc,{className:"h-4 w-4 mr-2"}),"Download Local Backup"]})]})]}),f.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[f.jsxs("div",{className:"flex items-center justify-between mb-6",children:[f.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Backup History"}),f.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-xl flex items-center justify-center",children:f.jsx(Bg,{className:"h-6 w-6 text-green-600"})})]}),f.jsx("div",{className:"space-y-3",children:o.length>0?o.slice(0,5).map(oe=>f.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("div",{className:`w-3 h-3 rounded-full ${oe.status==="completed"?"bg-green-500":oe.status==="failed"?"bg-red-500":"bg-yellow-500"}`}),f.jsxs("div",{children:[f.jsx("p",{className:"text-sm font-medium text-gray-900",children:ue(oe.backup_date)}),f.jsxs("p",{className:"text-xs text-gray-500",children:[oe.suppliers_count," suppliers, ",oe.transactions_count," transactions"]})]})]}),f.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${oe.status==="completed"?"bg-green-100 text-green-700":oe.status==="failed"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700"}`,children:oe.status})]},oe.id)):f.jsxs("div",{className:"text-center py-8",children:[f.jsx(gc,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),f.jsx("p",{className:"text-gray-500",children:"No backups yet"}),f.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Connect Google Drive to start automatic backups"})]})})]})]}),d&&f.jsx("div",{className:`border rounded-lg p-4 ${d.includes("Success")||d.includes("successfully")?"bg-green-50 border-green-200":d.includes("Error")||d.includes("Failed")?"bg-red-50 border-red-200":"bg-blue-50 border-blue-200"}`,children:f.jsxs("div",{className:"flex items-start space-x-3",children:[d.includes("Success")||d.includes("successfully")?f.jsx(pi,{className:"h-5 w-5 text-green-600 mt-0.5"}):d.includes("Error")||d.includes("Failed")?f.jsx(p1,{className:"h-5 w-5 text-red-600 mt-0.5"}):f.jsx(Es,{className:"h-5 w-5 text-blue-600 mt-0.5"}),f.jsx("div",{children:f.jsx("p",{className:`text-sm font-medium ${d.includes("Success")||d.includes("successfully")?"text-green-800":d.includes("Error")||d.includes("Failed")?"text-red-800":"text-blue-800"}`,children:d})})]})}),j&&f.jsx("div",{className:`border rounded-lg p-4 ${j.includes("Success")||j.includes("successfully")?"bg-green-50 border-green-200":j.includes("Error")||j.includes("Failed")?"bg-red-50 border-red-200":"bg-blue-50 border-blue-200"}`,children:f.jsxs("div",{className:"flex items-start space-x-3",children:[j.includes("Success")||j.includes("successfully")?f.jsx(pi,{className:"h-5 w-5 text-green-600 mt-0.5"}):j.includes("Error")||j.includes("Failed")?f.jsx(p1,{className:"h-5 w-5 text-red-600 mt-0.5"}):f.jsx(Es,{className:"h-5 w-5 text-blue-600 mt-0.5"}),f.jsx("div",{children:f.jsx("p",{className:`text-sm font-medium ${j.includes("Success")||j.includes("successfully")?"text-green-800":j.includes("Error")||j.includes("Failed")?"text-red-800":"text-blue-800"}`,children:j})})]})}),q&&f.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:f.jsxs("div",{className:"bg-white rounded-xl max-w-md w-full p-6",children:[f.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-6",children:R?"Edit Owner":"Add New Owner"}),f.jsxs("form",{onSubmit:R?O:A,className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Owner Name *"}),f.jsx("input",{type:"text",required:!0,value:G.owner_name,onChange:oe=>_({...G,owner_name:oe.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",placeholder:"Enter owner's full name"})]}),f.jsxs("div",{children:[f.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role/Title"}),f.jsx("input",{type:"text",value:G.role,onChange:oe=>_({...G,role:oe.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500",placeholder:"e.g., Owner, Partner, Manager"})]}),f.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[f.jsx("button",{type:"button",onClick:J,className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancel"}),f.jsx("button",{type:"submit",className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors",children:R?"Update Owner":"Add Owner"})]})]})]})}),f.jsxs("div",{className:"grid grid-cols-1 gap-6",children:[f.jsxs("div",{children:[f.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center",children:[f.jsx(Nm,{className:"h-5 w-5 mr-2 text-amber-600"}),"Push Notifications"]}),f.jsx(iJ,{})]}),f.jsx(nJ,{})]}),f.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:f.jsxs("div",{className:"flex items-start space-x-3",children:[f.jsx(Es,{className:"h-5 w-5 text-yellow-600 mt-0.5"}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-sm font-medium text-yellow-800",children:"Security Notice"}),f.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:"Your data is securely stored and encrypted. Always sign out when using shared devices. If you notice any unusual activity, please contact support immediately."})]})]})})]})};function sJ(){const[e,t]=z.useState(!1);return z.useEffect(()=>{(window.matchMedia("(display-mode: standalone)").matches||window.navigator.standalone===!0||document.referrer.includes("android-app://")||window.location.search.includes("utm_source=pwa")||localStorage.getItem("shopsynk_first_launch")===null||window.location.search.includes("show_splash=true"))&&(t(!0),localStorage.setItem("shopsynk_first_launch","false")),jm.requestNotificationPermission()},[]),e?f.jsx(CP,{onComplete:()=>t(!1)}):f.jsx(C8,{children:f.jsx(L8,{children:f.jsx(a8,{children:f.jsxs("div",{className:"App",children:[f.jsx(OP,{}),f.jsxs(Zx,{children:[f.jsx(Ji,{path:"/login",element:f.jsx(LP,{})}),f.jsx(Ji,{path:"/register",element:f.jsx(FP,{})}),f.jsx(Ji,{path:"/*",element:f.jsx(F8,{children:f.jsx(kP,{children:f.jsxs(Zx,{children:[f.jsx(Ji,{path:"/",element:f.jsx(DP,{})}),f.jsx(Ji,{path:"/suppliers",element:f.jsx(IP,{})}),f.jsx(Ji,{path:"/suppliers/:id",element:f.jsx(MP,{})}),f.jsx(Ji,{path:"/transactions",element:f.jsx(BP,{})}),f.jsx(Ji,{path:"/reports",element:f.jsx(JZ,{})}),f.jsx(Ji,{path:"/data-storage",element:f.jsx(QZ,{})}),f.jsx(Ji,{path:"/documentation",element:f.jsx(rJ,{})}),f.jsx(Ji,{path:"/profile",element:f.jsx(aJ,{})}),f.jsx(Ji,{path:"*",element:f.jsx($_,{to:"/",replace:!0})})]})})})})]})]})})})})}r4(document.getElementById("root")).render(f.jsx(z.StrictMode,{children:f.jsx(sJ,{})}));export{fr as _};
